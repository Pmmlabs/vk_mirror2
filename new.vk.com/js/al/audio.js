function AudioPage(e,i,t,o){function a(){r.options.isLayer||(nav.curLoc&&nav.setLoc(nav.fromStr(nav.curLoc)),nav.objLoc.q&&r.onSearchFiltersChanged(nav.objLoc))}if(!(this instanceof AudioPage)){var s=gpeByClass("_audio_layout",e);return s?data(s,"audioPage"):!1}addTemplates({audio_row:t.audioRowTpl}),this.options=t,this._container=ge(e),this._onSilentLoaded={},this._restores={},this._added={},this._readyAudio=o,cur.canAudioAddToGroup=this.options.canAudioAddToGroup,this.ap=getAudioPlayer(),ap.langs=t.langs,extend(cur.lang||{},t.langs),i.type?(i=new AudioPlaylist(i),i.loadSilent()):i=this.ap.getCurrentPlaylist(),this._updateAdditionalBlocksAndRightMenu(i),this._initSearch(),this._initScroll(),this.ap.setStatusExportInfo(t.exp),this.onShow(i),data(e,"audioPage",this);var r=this;this.isLayer()||cur.destroy.push(function(){ap.off(r),delete r}),this.ap.on(this,AudioPlayer.EVENT_PLAY,function(e,i,t){var o=this.getCurrentPlaylist(),a=!this.isLayer()&&this.ap.layer&&this.ap.layer.isShown();i&&0!=t&&o.indexOfAudio(e)>=0&&(a||this.scrollToTrack())}.bind(this)),a(),setTimeout(function(){r._initAlbumsSort()},100)}AudioPage.address="audio",AudioPage.onSearchFocused=function(e){var i=geByClass1("_audio_playlist",gpeByClass("_audio_layout",this));toggleClass(i,"audio_search_focused","focus"==e.type)},AudioPage.prototype.updateStatusExportControls=function(){var e=this.ap.getStatusExportInfo();each(geByClass("_audio_export_status"),function(){toggleClass(this,"on",!!e[domData(this,"oid")])});var i=this.ap.hasStatusExport();return each(geByClass("_audio_page_player_status"),function(){toggleClass(this,"audio_page_player_btn_enabled",i)}),!1},AudioPage.prototype.updateStatusExport=function(e,i){e&&checkbox(e);var t,o,i=intval(i),a=this.ap.getStatusExportInfo();if(i)a[i]?(delete a[i],t=!1):(a[i]=1,t=!0);else if(this.ap.hasStatusExport()){for(var s in a)delete a[s];t=!1}else i=vk.id,a[i]=1,t=!0;this.ap.setStatusExportInfo(a);var r=vk.audioParams.addHash;if(r){i!=vk.id&&i||checkbox("currinfo_audio",this.ap.hasStatusExport()),this.updateStatusExportControls();var n=this.ap.getCurrentAudio();n&&(o=AudioUtils.asObject(n).fullId);var l=(this.ap.getCurrentPlaylist(),null);ajax.post("al_audio.php",{act:"toggle_status",exp:intval(t),oid:i,hash:r,id:o,top:intval(l&&(l.top_audio||l.top))})}},AudioPage.prototype.playStatusAudio=function(e,i,t){var o=gpeByClass("_audio_friend",t);this.ap.playLive(e,{showProgress:showProgress.pbind(o),hideProgress:hideProgress.pbind(o)}),cancelEvent(i)},AudioPage.prototype._initAlbumsSort=function(){if(this.options.albumsReorderHash&&!this.options.isLayer){var e=geByClass1("_audio_albums_wrap",this._container);if(!e){var i=geByClass("_audio_album_item",this._container);i.length&&(e=se('<div class="_audio_albums_wrap audio_albums_wrap"></div>'),domInsertBefore(e,i[0]),each(i,function(){e.appendChild(this)}))}this._albumsSorter&&this._albumsSorter.destroy();var t=this;this._albumsSorter=new GridSorter(e,!1,{limitBottomMove:!0,noPosTransform:!0,onReorder:function(e,i){var o=e.id.split("_").pop(),a=i?i.id.split("_").pop():0;ajax.post("al_audio.php",{act:"reorder_albums",aid:o,before:a,hash:t.options.albumsReorderHash,oid:t.options.oid},{onDone:function(){}})}})}},AudioPage.deleteAlbum=function(e,i){var t=cur.audioPage.options.oid,o=showFastBox({title:AudioPlayer.getLang("audio_delete_album_title"),dark:1},AudioPlayer.getLang("audio_delete_album_are_you_sure"),AudioPlayer.getLang("audio_delete_album_button"),function(a){ajax.post("al_audio.php",{act:"delete_album",album_id:e,hash:i,gid:0>t?-t:!1},{showProgress:lockButton.pbind(a),hideProgress:unlockButton.pbind(a),onDone:function(i,o){try{boxQueue.hideAll(),re(geByClass1("_ui_item_audio_album_"+t+"_"+e)),nav.go("/audios"+t)}catch(a){}},onFail:function(){o.hide(200)}})},getLang("global_cancel"))},AudioPage.saveAlbum=function(e,i,t){var o=val("album_name");if(!o)return notaBene("album_name"),!1;var a=curBox(),s=cur.audioPage.options.oid,r=!t,n={act:"save_album",album_id:t,name:o,gid:0>s?-s:0,Audios:e.join(","),hash:cur.audioPage.options.saveAlbumHash};return ajax.post("al_audio.php",n,{showProgress:lockButton.pbind(i),hideProgress:unlockButton.pbind(i),onFail:a.hide,onDone:function(i,t,o,a){var n=getAudioPlayer(),l=n.getPlaylist(AudioPlaylist.TYPE_ALBUM,s,i);if(l.clean(),l.mergeWith({list:a,hasMore:!1}),n.deletePlaylist(n.getPlaylist(AudioPlaylist.TYPE_RECOM,s,"album"+i)),each(e,function(e,i){var t={};t[AudioUtils.AUDIO_ITEM_INDEX_ALBUM_ID]=i,n.updateAudio(s+"_"+i,t)}),each(n.getPlaylists(),function(e,i){i.getType()==AudioPlaylist.TYPE_ALBUM&&i.getOwnerId()==s&&i.clean()}),r){var d=geByClass1("ui_rmenu",cur.audioPage._container),u=domPN(d);u.replaceChild(se(o),d),cur.audioPage._initAlbumsSort()}curBox().hide(),setTimeout(function(){if(r)nav.go("/audios"+s+"?album_id="+i);else if(cur.audioPage){var e=cur.audioPage.getCurrentPlaylist();e.getType()==AudioPlaylist.TYPE_ALBUM&&e.getOwnerId()==s&&cur.audioPage.switchToSection(e)}},200)}}),!1},AudioPage.filterByAlbum=function(e,i){for(var t=e.length,o=[],a=0;t>a;a++){var s=e[a];i==s[AudioUtils.AUDIO_ITEM_INDEX_ALBUM_ID]&&o.push(s)}return o},AudioPage.showActionTooltip=function(e,i){showTooltip(e,{text:i,black:1,shift:[8,5,0],appendParentCls:"_audio_page_player"})},AudioPage.prototype.createAlbum=function(e){return this.editAlbum(0)},AudioPage.prototype.editAlbum=function(e,i,t){var o=this.ap.getPlaylist(AudioPlaylist.TYPE_ALBUM,this.options.oid,AudioUtils.AUDIO_ALBUM_ID_ALL),a=this,s=i?gpeByClass("_audio_album_btns",i):null;s&&(addClass(s,"in_progress"),showProgress(s)),o.loadSilent(function(i){s&&(removeClass(s,"in_progress"),hideProgress(s));showTabbedBox("al_audio.php",{act:"edit_album_box",album_id:e||0,oid:a.options.oid},{stat:["privacy.js","privacy.css","ui_controls.js","ui_controls.css","indexer.js"],dark:1})}),cancelEvent(t)},AudioPage.prototype.onHide=function(){var e=this;cur.nav=cur.nav.filter(function(i){return e._nav_func!=i})},AudioPage.prototype.showRecoms=function(e,i,t){if(!i){var o=this.readyAudio?this.readyAudio:this.ap.getCurrentAudio();i=AudioUtils.asObject(o).fullId}return nav.go({0:nav.objLoc[0],section:"recoms",audio_id:i}),cancelEvent(t)},AudioPage.prototype.showAlbumRecoms=function(e,i,t,o){return nav.go({0:nav.objLoc[0],section:"recoms",album_id:o}),cancelEvent(i)},AudioPage.prototype.onShow=function(e){this._initNavigation(),val(this.searchInputEl,""),uiSearch.removeAllFilters(this.searchInputEl),setTimeout(elfocus.pbind(this.searchInputEl),10),e=e||this.ap.getCurrentPlaylist()||this.getCurrentPlaylist(),this.switchToSection(e),this._initPlayer(),this.isLayer()&&setTimeout(function(){var e=geByClass1("_audio_rows_header",this._container);setStyle(e,"width",getSize(geByClass1("_audio_rows",this._container))[0]-1),this.getLayer().sb.widthUpdated()}.bind(this)),this.updateStatusExportControls(),this.scrollToTrack()},AudioPage.prototype.onAudioUploaded=function(e,i){if(i){var t=this.ap.getPlaylist(AudioPlaylist.TYPE_ALBUM,this.options.oid,AudioUtils.AUDIO_ALBUM_ID_ALL);t.addAudio(i);var o=this.ap.getCurrentPlaylist();o&&o.getSelf()==t&&o.addAudio(i);var a=this.getCurrentPlaylist();a==t&&this.switchToSection(a)}},AudioPage.prototype.uploadAudio=function(e){return this.options.uploadBanned?void setTimeout(showFastBox({title:AudioPlayer.getLang("audio_no_upload_title"),bodyStyle:"padding: 20px; line-height: 160%;",dark:1},AudioPlayer.getLang("audio_claims_no_upload")).hide,5e3):void showBox("al_audio.php",extend(e||{},{act:"new_audio",gid:this.options.oid<0?-this.options.oid:0}),{params:{width:"450px",bodyStyle:"padding: 0px; position: relative;"},dark:1})},AudioPage.prototype.editAudio=function(e,i,t){return showBox("al_audio.php",{act:"edit_audio_box",aid:i},{params:{width:"456px",bodyStyle:"padding: 20px; background-color: #F7F7F7;",hideButtons:1},dark:1}),t&&cancelEvent(t),!1},AudioPage.prototype.showActionTooltip=function(e,i,t){if(!this._addRestoreInProgress){switch(t){case"delete":var o=this._restores[i];t=o&&o.deleteAll?o.deleteAll.text:AudioPlayer.getLang("audio_delete_audio");break;case"add":var o=this._restores[i];t=o?AudioPlayer.getLang("audio_restore_audio"):this.options.oid<0&&this.options.canAddToGroup?AudioPlayer.getLang("audio_add_to_group"):AudioPlayer.getLang("audio_add_to_audio");break;case"edit":t=AudioPlayer.getLang("audio_edit_audio")}showTooltip(e,{text:function(){return t},black:1,shift:[15,10,0]})}},AudioPage.prototype.hideRecommendation=function(e){var i=AudioUtils.getAudioFromEl(e,!0),t=AudioUtils.asObject(this.ap.getCurrentAudio());t&&t.fullId==i.fullId&&this.ap.playNext();var o=AudioUtils.getAudioExtra(i).recom,a={act:"hide_recommendation",q:o.q,hash:o.hash};nav.objLoc.audio_id&&(a.recommendation_type="query"),nav.objLoc.album_id&&(a.recommendation_type="album"),ajax.post("al_audio.php",a),cur._audioAddRestoreInfo[i.fullId]={state:"recom_hidden"}},AudioPage.prototype.restoreRecommendation=function(e){var i=AudioUtils.getAudioFromEl(e,!0),t=AudioUtils.getAudioExtra(i).recom,o={act:"restore_recommendation",q:t.q,hash:t.hash,aid:i.fullId};nav.objLoc.audio_id&&(o.recommendation_type="query"),nav.objLoc.album_id&&(o.recommendation_type="album"),ajax.post("al_audio.php",o),removeClass(e,"audio_deleted"),delete cur._audioAddRestoreInfo[i.fullId]},AudioPage.prototype.deleteAudio=function(e,i,t){function o(){return intval(domData(s,"in-progress"))}function a(e){return domData(s,"in-progress",intval(e))}var s=gpeByClass("_audio_row",e);if(!o()){a(!0),window.tooltips&&tooltips.hideAll();var r=AudioUtils.getAudioFromEl(s,!0),n=vk.audioParams.deleteHash;return cur._audioAddRestoreInfo=cur._audioAddRestoreInfo||{},AudioUtils.isRecomAudio(r)?(addClass(s,"audio_deleted"),this.hideRecommendation(s),a(!1),cancelEvent(t)):(addClass(s,"audio_deleted"),addClass(s,"canadd"),removeClass(s,"canedit"),ajax.post("al_audio.php",{act:"delete_audio",oid:r.ownerId,aid:r.id,hash:n,restore:1},{onDone:function(e,i){a(!1),cur._audioAddRestoreInfo[r.fullId]={state:"deleted",deleteAll:e,deleteConfirmMsg:i}}}),cancelEvent(t))}},AudioPage.prototype.toggleAudioDurationType=function(){this.ap.toggleDurationType()},AudioPage.prototype._updateShuffleButton=function(e){toggleClass(geByClass1("_audio_shuffle_btn",this._container),"audio_page_player_btn_enabled",!!e.shuffle)},AudioPage.prototype.toggleRepeat=function(e){var i=toggleClass(e,"audio_page_player_btn_enabled");this.ap.toggleRepeatCurrentAudio(i)},AudioPage.prototype.toggleShuffle=function(e){var i=this.getCurrentPlaylist();i.isShuffled()?(removeClass(e,"audio_page_player_btn_enabled"),i.shuffle(0)):(addClass(e,"audio_page_player_btn_enabled"),i.shuffle(irand(1,999999))),this.switchToSection(i)},AudioPage.onFilterRemoved=function(e,i){var t=AudioPage(i);switch(e){case"performer":var o="audio_search_type_"+intval(t.options.isLayer),a=window.radioBtns[o];radiobtn(a.els[0],0,o);break;case"sort":var s=t._searchSortFilter.options.defaultItems[0][0];t._searchSortFilter.selectItem(s,!1);break;case"lyrics":removeClass(geByClass1("_audio_fltr_with_lyrics",t._container),"on")}t.onSearchFiltersChanged()},AudioPage.prototype.syncFilters=function(e){var i="audio_search_type_"+intval(this.options.isLayer),t=window.radioBtns[i];radiobtn(t.els[e.performer?1:0],!!e.performer,i);var o=e.sort;o||(o=this._searchSortFilter.options.defaultItems[0][0]),toggleClass(geByClass1("_audio_fltr_with_lyrics",this._container),"on",!!e.lyrics);var a={performer:AudioPlayer.getLang("audio_performers_only"),lyrics:AudioPlayer.getLang("audio_search_with_text"),sort:AudioPlayer.getLang("audio_search_by_length")};this._muteFilterEvent=!0;var s=this;each(["performer","lyrics","sort"],function(i,t){uiSearch.toggleFilter(s.searchInputEl,t,a[t],!!e[t])}),this._muteFilterEvent=!1},AudioPage.prototype.onSearchFiltersChanged=function(e){if(!this._muteFilterEvent){var i=window.radioBtns["audio_search_type_"+intval(this.options.isLayer)],t=intval(this._searchSortFilter.selectedItems()[0][0]),o={performer:i.val?1:null,lyrics:hasClass(geByClass1("_audio_fltr_with_lyrics",this._container),"on")?1:null,sort:t?1:null};nav.change(e&&isObject(e)?e:o,!1,{fromSearch:!0,filtersChanged:!0})}},AudioPage.prototype._initSearch=function(){var e=geByClass1("_audio_search_input",this._container);this.searchInputEl=geByClass1("_field",e),uiSearch.init(e),window.radioBtns["audio_search_type_"+intval(this.options.isLayer)]={els:geByClass("_audio_search_type",this._container),keep:!0},this._searchSortFilter=new Dropdown(geByClass1("_audio_fltr_sort",this._container),this.options.sortFilters,{big:1,zeroPlaceholder:!0,onChange:this.onSearchFiltersChanged.bind(this)});var i=this;new Suggester(this.searchInputEl,{section:"audio",sidePadding:"47px",onSelect:function(e){val(i.searchInputEl,e[3])},onChoose:function(e){val(i.searchInputEl,e[3]),i.searchAudios(e[3])}}),this.toggleSearchProgress=debounce(this.toggleSearchProgress,100).bind(this)},AudioPage.searchAudios=function(e){AudioPage(this).searchAudios(e)},AudioPage.prototype.searchAudios=function(e){e=trim(e),nav.change(extend({q:e?e:!1}),!1,{fromSearch:!0,q:e})},AudioPage.searchMoreFriends=function(e){AudioPage(this).searchMoreFriends(e)},AudioPage.prototype._updateFriendsList=function(e,i,t){if(e=trim(e)){var o=this,a=geByClass1("_audio_friends_list",this._container),s=(getSize(a)[1],se('<div class="audio_friends_list _audio_friends_list" style="opacity: 0; position: absolute; top: 0;">'+e+"</div>"));t&&(this._shownFriends=[]),domPN(a).appendChild(s),setTimeout(function(){setStyle(s,{opacity:1})}),setTimeout(function(){re(a),setStyle(s,{position:"relative"}),o._friendSearchInProgress=!1},160)}},AudioPage.prototype.searchMoreFriends=function(e){this._friendSearchInProgress||(this._friendSearchInProgress=!0,ajax.post("al_audio.php",{act:"search_friends",str:e},{onDone:this._updateFriendsList.bind(this)}))},AudioPage.prototype.showMoreFriends=function(e,i){if(!this._friendSearchInProgress){this._friendSearchInProgress=!0,this._shownFriends=this._shownFriends||[];var t=this;each(geByClass("_audio_friend",this._container),function(){t._shownFriends.push(domData(this,"id"))}),ajax.post("al_audio.php",{act:"more_friends",exclude:i?!1:this._shownFriends.join(","),owner:i},{showProgress:e?lockButton.pbind(e):!1,hideProgress:e?unlockButton.pbind(e):!1,onDone:this._updateFriendsList.bind(this)})}},AudioPage.prototype.catalogShowMorePerformers=function(e){var i=[],t=geByClass1("_audio_catalog_performers",gpeByClass("_audio_additional_block",e)),o=domData(t,"genre");each(geByClass("_audio_catalog_performer",t),function(){i.push(domData(this,"performer-id"))}),ajax.post("al_audio.php",{act:"get_more_performers",offset:4,exclude:i.join(","),genre:o},{onDone:function(i){t.appendChild(se("<div>"+i+"</div>")),re(e)},showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)})},AudioPage.prototype.showStatusTooltip=function(e){this.statusTT||(this.statusTT=!0,ajax.post("al_audio.php",{act:"status_tt"},{onDone:function(i,t){this.statusTT=new ElementTooltip(e,{offset:[0,3],content:t,showImmediate:!!cur._onStatusExportBtn,width:300,offset:[-5,0],elClassWhenTooltip:"audio_status_tt_shown",id:"audio_status_tt",onFirstTimeShow:function(e){this.sb=new Scrollbar(geByClass1("audio_status_wrap",e),{top:0,global:!0,nokeys:!0})}})}.bind(this)}))},AudioPage.prototype.isLayer=function(){return!!this.getLayer()},AudioPage.prototype.getLayer=function(){return this.options.layer},AudioPage.prototype._initSorter=function(e){function i(i,t,o){var s=domData(i,"full-id"),r=domData(t,"full-id"),n=domData(o,"full-id"),l=e.indexOfAudio(s),d=e.indexOfAudio(r),u=e.indexOfAudio(n);r?e.moveAudio(l,d):n&&e.moveAudio(l,u+1),a.isLayer()||(s=s.split("_")[1],r=r?r.split("_")[1]:"",n=n?n.split("_")[1]:"",ajax.post("al_audio.php",{act:"reorder_audios",oid:a.options.oid,aid:intval(s),before:intval(r),after:intval(n),hash:a.options.reorderHash}))}function t(e){var i=e.id.split("_");return i[i.length-1]}var o=geByClass1("_audio_playlist",this._container);this._sorter&&!this._sorter.isCurrentlyDragging()&&(this._sorter.destroy(),this._sorter=!1);var a=this,s=!1,r=this.getCurrentPlaylist();if(s=this.isLayer()?r==this.ap.getCurrentPlaylist():this.options.reorderHash&&e.getType()==AudioPlaylist.TYPE_ALBUM,s&&!this._sorter){var n=this.isLayer()?{}:{onDragOverElClass:"_audio_album_item",onDragEnter:function(i,o){var a=t(i);a!=e.getAlbumId()&&(addClass(o,"audio_item_drag_over_album"),addClass(i,"audio_album_drop"))},onDragLeave:function(e,i){removeClass(i,"audio_item_drag_over_album"),removeClass(e,"audio_album_drop")},onDragDrop:function(i,o){removeClass(o,"audio_item_drag_over_album"),removeClass(i,"audio_album_drop");var s=t(i),r=domData(o,"full-id");if(s==e.getAlbumId())return!0;ajax.post("al_audio.php",{act:"a_move_to_album",album_id:s,audio_id:r.split("_")[1],hash:a.options.moveHash,gid:a.options.oid<0?-a.options.oid:null});var n=a.getCurrentPlaylist(),l=n.indexOfAudio(r);if(n.getAlbumId()!=AudioUtils.AUDIO_ALBUM_ID_ALL&&l>=0)n.removeAudio(r),a.switchToSection(n);else{var d=a.ap.getPlaylist(AudioPlaylist.TYPE_ALBUM,a.options.oid,s);d.clean()}var u={};return u[AudioUtils.AUDIO_ITEM_INDEX_ALBUM_ID]=s,a.ap.updateAudio(r,u),!0}};this._sorter=new GridSorter(o,extend({onReorder:i,wrapNode:this.isLayer()?geByClass1("audio_layer_rows_wrap",this._container):!1,dragCls:"audio_item_drag",limitBottomMove:!0},n))}},AudioPage.prototype._initAutoList=function(e,i,t){var o=geByClass1("_audio_playlist",this._container),a=geByClass1("_ui_audio_load_more",this._container),s=this,r=50;this._autoList&&this._autoList.destroy();var n=0;this._autoList=new AutoList(o,{isLayer:this.isLayer(),scrollNode:this.isLayer()?geByClass1("audio_layer_rows_wrap",this._container):window,renderImmediate:!0,rowClass:"_audio_row audio_feed_post",onNoMore:function(){hide(a),s._updateEmptyPlaceholder(e)},onHasMore:function(){s._updateEmptyPlaceholder(e)},onRendered:function(){t(!1),s.isLayer()&&s.getLayer().sb.update(),s.ap.updateCurrentPlaying()},onNeedRows:function(l,d,u,_){function h(e){if(e){0==d&&(o.innerHTML="");var t=!1,a=!1;if(e.getType()==AudioPlaylist.TYPE_FEED&&e!=ap.getCurrentPlaylist())p=e.getItemsList().slice(d,d+r);else{c=e.getAudiosList().slice(d,d+r);var t=e.getType()==AudioPlaylist.TYPE_SEARCH,n=!1;if(t){var u=e.getSearchParams().q;u+=" "+(parseLatin(u)||""),u=trim(u.replace(/\)/g,"").replace(/&/,"&amp;")),n=new RegExp("(\\s|^)("+u.replace(vkIndexer.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi")}each(c,function(i,o){t&&d+i==e.getLocalFoundCount()&&p.push("<h3>"+langNumeric(e.getTotalCount(),ap.langs.audio_global_search_found,!0)+"</h3>"),o=clone(o),o[AudioUtils.AUDIO_ITEM_INDEX_TITLE]=o[AudioUtils.AUDIO_ITEM_INDEX_TITLE].replace(n,"$1<em>$2</em>"),o[AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]=o[AudioUtils.AUDIO_ITEM_INDEX_PERFORMER].replace(n,"$1<em>$2</em>"),p.push(AudioUtils.drawAudio(o))}),a&&(i.innerHTML="",a=!1)}if(l(p),!d&&!s.options.isLayer){var _=e.getTitle()||document.title;document.title=replaceEntities(_.replace(/(<em>|<\/em>|<strong>|<\/strong>)/g,""))}}}var c,p=[];n=d,_||t(!0),d>0&&(show(a),lockButton(a)),e.load(d,function(e){h(e)})}}),cur.destroy.push(function(){this._autoList&&this._autoList.destroy()}.bind(this))},AudioPage.prototype.destroy=function(){this._trackSlider.destroy(),this._volumeSlider.destroy(),removeEvent(window,"scroll",this._ev_onScroll)},AudioPage.prototype.getCurrentPlaylist=function(){var e=geByClass1("_audio_playlist",this._container);return data(e,"playlist")},AudioPage.prototype._loadSilent=function(e,i){var e=isObject(e)?e:this.ap.getPlaylist(e),t=this,o=this.getCurrentPlaylist();if(AudioUtils.getPlaylistType(e)==AudioUtils.AUDIO_PLAYLIST_TYPE_CURRENT)return void AudioUtils.indexPlaylist(e,function(){t._callOnSilentLoaded(e)});if(e.has_more){if((i||AudioUtils.getPlaylistType(o)==AudioUtils.AUDIO_PLAYLIST_TYPE_SEARCH)&&this.toggleSearchProgress(!0),this._silentLoading=this._silentLoading||{},this._silentLoading[e.id])return;this._silentLoading[e.id]=!0,ajax.post("al_audio.php",{act:"a_load_silent",playlist:e.id,offset:e.list.length,pop_band:intval(e.pop_band)},{onDone:function(i){t.toggleSearchProgress(!1),t._silentLoading[e.id]=!1,e=AudioUtils.mergePlaylist(e.id,i),e.shuffle&&t.ap.shufflePlaylist(e),AudioUtils.indexPlaylist(e,function(){t._callOnSilentLoaded(e)})}})}},AudioPage.prototype._addOnSilentLoaded=function(e,i){var t=this.ap.getPlaylist(e);if(!t.has_more)return void i(t);var o=""+i;this._onSilentLoaded[t.id]=(this._onSilentLoaded[t.id]||[]).filter(function(e){return""+e!=o}),this._onSilentLoaded[t.id].push(i)},AudioPage.prototype._callOnSilentLoaded=function(){var e=Array.prototype.slice.call(arguments),i=e[0];if(this._onSilentLoaded&&this._onSilentLoaded[i.id]){var t=this._onSilentLoaded[i.id]||[];this._onSilentLoaded[i.id]=[];var o=this;each(t,function(i,t){t.apply(o,e)})}},AudioPage.prototype._initScroll=function(){if(this.isLayer()){var e=geByClass1("audio_layer_menu_wrap",this._container),i=geByClass1("audio_layer_rows_wrap",this._container),t=geByClass1("audio_rows_header",this._container),o=i.scrollTop,a=0,s=getSize(t),r=this;return setStyle(t,{width:s[0]}),void addEvent(i,"scroll",this._ev_onScroll=function(n){var l=(getSize(e)[1],getSize(i)[1],i.scrollTop-o);o=i.scrollTop,a-=l,a=Math.max(getSize(i)[1]-getSize(e)[1],a),a=Math.min(0,a),setStyle(e,"top",a);var d=geByClass1("_audio_padding_cont",r._container);i.scrollTop>0?(setStyle(d,{"padding-top":s[1]}),addClass(t,"fixed")):(setStyle(d,{"padding-top":null}),removeClass(t,"fixed"))})}var r=this,n=geByClass1("_audio_rows_header",this._container),l=getSize(n)[1],d=domPN(n),u=getSize(d)[0],_=getSize(ge("page_header_cont"))[1];setStyle(n,{width:u,top:_});var h=getXY(d)[1];addEvent(window,"scroll",this._ev_onScroll=function(){scrollGetY()>=h-_?(addClass(n,"fixed"),setStyle(d,{"padding-top":l,"z-index":2})):(removeClass(n,"fixed"),setStyle(d,{"padding-top":null}))}),this.options.isLayer||cur.destroy.push(function(){removeEvent(window,"scroll",r._ev_onScroll)})},AudioPage.prototype._updateRowsList=function(e,i){if(e){var t=geByClass1("_audio_playlist",this._container);geByClass1("_ui_load_more_btn",this._container);this._initAutoList(e,t,function(o){o||data(t,"playlist",e),i&&i(o)}),this._updateLayerBottom(),this.options.isLayer||scrollToTop(0)}},AudioPage.prototype.toggleSearchProgress=function(e){var i=geByClass1("ui_search_fltr_control",this._container),t=geByClass1("ui_search_fltr",t);hideProgress(t),e&&showProgress(t),hasClass(i,"shown")||toggleClass(gpeByClass("_wrap",this.searchInputEl),"ui_search_loading",e)},AudioPage.prototype.subscribeToOwner=function(e,i,t){ajax.post("al_audio.php",{act:"subscribe_to_owner",hash:t,owner_id:i},{showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e),onDone:function(i){val(e,i),addClass(e,"secondary"),addClass(e,"no_events")}})},AudioPage.prototype._normalizePlaylistId=function(e){var i=(e.getAlbumId()+"").replace(/^[a-z]*/,"");return e.getType()+"_"+e.getOwnerId()+"_"+parseInt(i)},AudioPage.prototype.switchToSection=function(e,i){var t=this,o=geByClass1("_audio_playlist",this._container);this._initAutoList(e,o,function(a){if(a){var s=geByClass1("_ui_item_audio_"+e.getId(),t._getMenuEl());if(!s)switch(e.getType()){case AudioPlaylist.TYPE_POPULAR:s=geByClass1("_ui_item_audio_popular_"+t.options.oid,t._getMenuEl());break;case AudioPlaylist.TYPE_RECOM:s=geByClass1("_ui_item_audio_recoms_"+t.options.oid,t._getMenuEl());break;case AudioPlaylist.TYPE_FEED:s=geByClass1("_ui_item_audio_feed_"+t.options.oid,t._getMenuEl())}if(s&&isVisible(s)?(uiRightMenu.switchMenu(s),uiRightMenu.showProgress(s)):t._hideMenuItemProgress(),!s&&e.getType()==AudioPlaylist.TYPE_ALBUM&&e.getOwnerId()!=vk.id){var r=geByClass1("_audio_friend_"+e.getOwnerId(),t._container);r&&showProgress(r)}e.getType()==AudioPlaylist.TYPE_SEARCH&&uiSearch.showProgress(t.searchInputEl)}else data(o,"playlist",e),unlockButton(geByClass1("audio_more_friends_btn")),t._hideMenuItemProgress(),t._updateAdditionalBlocksAndRightMenu(e,i),t._updateEmptyPlaceholder(e),uiSearch.hideProgress(t.searchInputEl),t._initSorter(e)}),this.options.isLayer&&toggleClass(uiSearch.getWrapEl(this.searchInputEl),"ui_search_field_empty",!val(this.searchInputEl))},AudioPage.prototype._getForeignTogglerEl=function(){return geByClass1("_ui_toggler",geByClass1("_audio_foreign_filter_block",this._getMenuEl()))},AudioPage.prototype.toggleForeign=function(){var e=this._getForeignTogglerEl(),i=toggleClass(e,"on"),t=this.getCurrentPlaylist(),o=(t.getAlbumId()+"").replace(/[a-z]*/,""),a=this.ap.getPlaylist(AudioPlaylist.TYPE_POPULAR,vk.id,(i?"foreign":"")+o);this.switchToSection(a)},AudioPage.prototype._updateEmptyPlaceholder=function(e){var i=geByClass1("_audio_empty_placeholder ",this._container);if(e.getAudiosCount())hide(i);else{show(i);var t="",o=e.getType();t=o==AudioPlaylist.TYPE_ALBUM?AudioPlayer.getLang("audio_no_rec_load_msg"):o==AudioPlaylist.TYPE_SEARCH?AudioPlayer.getLang("audio_no_audios_found").replace("{query}",clean(e.getSearchParams().q)):o==AudioPlaylist.TYPE_RECOM?0==e.getAlbumId().indexOf("album")?AudioPlayer.getLang("audio_no_recs_found"):AudioPlayer.getLang("audio_no_audio_recs_found"):AudioPlayer.getLang("audio_album_no_recs"),val(i,t)}},AudioPage.prototype._updateAdditionalBlocksAndRightMenu=function(e,i){var t=this,o=this._getMenuEl(),a=null;if(e==this.ap.getCurrentPlaylist())a=geByClass1("_ui_item_audio_current",o);else switch(e.getType()){case AudioPlaylist.TYPE_RECOM:a=geByClass1("_ui_item_audio_recoms_"+e.getOwnerId(),o);break;case AudioPlaylist.TYPE_FEED:a=geByClass1("_ui_item_audio_feed_"+vk.id,o);break;case AudioPlaylist.TYPE_ALBUM:a=geByClass1("_ui_item_audio_"+e.getId(),o);break;case AudioPlaylist.TYPE_POPULAR:var s=this._normalizePlaylistId(e);a=geByClass1("_ui_item_audio_"+s,o)}a?(this._unselectFriends(),removeClass(a,"unshown"),uiRightMenu.switchMenu(a)):uiRightMenu.unselectAll(this._getMenuEl());var r=e.getBlocks(),n="_ui_item_audio_"+AudioPlaylist.TYPE_POPULAR+"_"+this.options.oid+"_0",l=geByClass1(n,this._getMenuEl()),d=geByClass1("_ui_item_audio_popular_"+this.options.oid,this._getMenuEl());if(r.submenu&&!l){var u=se(r.submenu);domInsertAfter(u.children[1],d),domInsertAfter(u.children[0],d),l=geByClass1(n,this._getMenuEl()),uiRightMenu.switchMenu(l)}var _=geByClass1("_ui_item_audio_genres",this._getMenuEl());isVisible(d);if(e.getType()==AudioPlaylist.TYPE_POPULAR){show(_),show(domNS(_)),hide(d),uiRightMenu.hideSliding(this._getMenuEl());var h=geByClass1("_ui_rmenu_audio_albums_toggle",this._getMenuEl());hasClass(h,"ui_rmenu_item_expanded")&&uiRightMenu.toggleSubmenu("audio_albums",this)}else hide(_),hide(domNS(_)),show(d);var c=geByClass1("_audio_foreign_filter_block",this._container);toggle(c,e.getType()==AudioPlaylist.TYPE_POPULAR),setTimeout(function(){uiRightMenu.hideSliding(t._getMenuEl())},150),each(geByClass("_audio_additional_block",this._container),hide),each(geByClass("_audio_additional_blocks_wrap",this._container),hide),this._blocks=this._blocks||{},e.getType()==AudioPlaylist.TYPE_SEARCH&&r.search&&(this._blocks[e.getId()]=r.search),each(r,function(e,i){t._blocks[e]=t._blocks[e]||i});var p=[];switch(e.getType()){case AudioPlaylist.TYPE_ALBUM:case AudioPlaylist.TYPE_TEMP:case AudioPlaylist.TYPE_FEED:var g=e.getOwnerId();e.getType()==AudioUtils.AUDIO_PLAYLIST_TYPE_ALBUM&&e.isPopBand()?p.push("pop_band_"+g):0>g?p.push(this._prevSearchPlaylistId):p.push("friends");break;case AudioPlaylist.TYPE_RECOM:p.push("recoms");break;case AudioPlaylist.TYPE_POPULAR:case AudioPlaylist.TYPE_SEARCH:p.push(e.getId())}each(p,function(e,i){if(i){var o="right";0==i.indexOf("popular_")&&(o="top");var a=geByClass1("_audio_additional_blocks_wrap_"+o,t._container),s=geByClass1("_audio_additional_block_"+i,t._container);!s&&t._blocks[i]&&(s=se(rs(t.options.additionalBlockSectionTpl,{block_id:i})),val(s,t._blocks[i]),a.appendChild(s)),show(s),show(a)}}),uiSearch.init("audio_friends_search")},AudioPage.prototype._updateLayerBottom=function(){return},AudioPage.prototype._loadMorePaginatedPlaylist=function(e,i,t){if("string"==typeof e&&(e=this.ap.getPlaylist(e)),!e.has_more)return t&&t(e);if(i*this.options.audioRowsPerPage<e.next_offset)return t&&t(e);if(AudioUtils.getPlaylistType(e)==AudioUtils.AUDIO_PLAYLIST_TYPE_CURRENT)return t&&t(e);if(AudioUtils.getPlaylistType(e)==AudioUtils.AUDIO_PLAYLIST_TYPE_SEARCH&&0==i&&e.list.length)return e.has_more=e.list.length<AudioUtils.AUDIO_ENOUGH_LOCAL_SEARCH_RESULTS,t&&t(e);var o=e.id,a=o+(e.shuffle?"_"+intval(e.shuffle):""),s=this;if(cur._playlistLoadingLock=cur._playlistLoadingLock||{},!cur._playlistLoadingLock[a]){cur._playlistLoadingLock[a]=!0,AudioUtils.getPlaylistType(e)==AudioUtils.AUDIO_PLAYLIST_TYPE_SEARCH&&(e.list.length&&1==i||!e.list.length&&0==i)&&this.toggleSearchProgress(!0);var r={act:"a_load_section",section:e.id,offset:e.next_offset};AudioUtils.getPlaylistType(e)==AudioUtils.AUDIO_PLAYLIST_TYPE_SEARCH&&extend(r,{q:e.searchParams.q,lyrics:e.searchParams.lyrics,performer:e.searchParams.performer,sort:e.searchParams.sort}),AudioUtils.getPlaylistType(e)==AudioUtils.AUDIO_PLAYLIST_TYPE_FEED&&extend(r,{feed_from:e.feed_from,feed_offset:e.feed_offset}),e.shuffle&&(r.shuffle=intval(e.shuffle)),this._lastRequestedPlaylistId=o,ajax.post("/al_audio.php",r,{onDone:function(i){if(cur._playlistLoadingLock[a]=!1,s.toggleSearchProgress(!1),s._lastRequestedPlaylistId!=o)return t&&t(!1);i&&(e=AudioUtils.mergePlaylist(o,i));var r=s.ap.getCurrentPlaylist();r&&e.id==r.id&&this.ap.moveCurrentPlayingAtFirstPos(e),t&&t(e)}})}},AudioPage.prototype._hideMenuItemProgress=function(){uiRightMenu.hideProgress(this._getMenuEl()),hideProgress(geByClass1("audio_friends_list",this._container)),each(geByClass("audio_owners_wrap",this._container),function(){hideProgress(this)})},AudioPage.prototype._getMenuEl=function(){return geByClass1("ui_rmenu",this._container)},AudioPage.prototype._hideMenuSelectedItem=function(){removeClass(geByClass1("ui_rmenu",this._container),"ui_rmenu_item_sel")},AudioPage.prototype._unselectFriends=function(){hideProgress(geByClass1("_audio_friends_list",this._container)),each(geByClass("_audio_friend",this._container),function(){removeClass(this,"audio_friend_selected")}),unlockButton(geByClass1("audio_more_friends_btn"))},AudioPage.prototype._initNavigation=function(){var e=!1;this._prevSearchPlaylistId=null,cur.nav.push(this._nav_func=function(i,t,o,a){var s=!!i[0],r=t.q&&!o.q&&t[0].indexOf("audio")>=0;if(each(cur._audioAddRestoreInfo||{},function(e,i){("deleted"==i.state||"recom_hidden"==i.state)&&getAudioPlayer().deleteAudioFromAllPlaylists(e)}),s){var n=this.options.oid;if(n!=vk.id&&!inArray(i[0],["audios"+n]))return!0;if(n==vk.id&&!inArray(i[0],["audios"+n,"audio"]))return!0}if(this.options.isLayer&&(a.hist||a.back||i[0]&&0!=i[0].indexOf("audio")))return this.options.eltt.hide(),!0;if(0==Object.keys(i).length&&!a.fromSearch&&!a.fromMenu&&!a.friendEl)return!1;r&&this._prevSearchLoc&&a.fromSearch&&(o=this._prevSearchLoc);var l;if(this._unselectFriends(),o.q){var d=trim(val(this.searchInputEl));d!=o.q&&val(this.searchInputEl,replaceEntities(o.q));var u=replaceEntities(o.q),_={q:o.q};each(["performer","lyrics","sort"],function(e,i){_[i]=intval(o[i]),u+=_[i]}),u=hashCode(u),l=this.ap.getPlaylist(AudioPlaylist.TYPE_SEARCH,this.options.oid,u),l.mergeWith({searchParams:_}),removeClass(uiSearch.getWrapEl(this.searchInputEl),"ui_search_field_empty"),this._prevSearchLoc||nav.objLoc.q||(this._prevSearchLoc=nav.objLoc),delete o.section}else if(o.section==AudioPlaylist.TYPE_POPULAR){var h=hasClass(this._getForeignTogglerEl(),"on")?"foreign":"";l=this.ap.getPlaylist(AudioPlaylist.TYPE_POPULAR,vk.id,h+intval(o.genre))}else if(o.friend){var c=intval(o.friend),p=geByClass1("_audio_friend_"+c,this._container);addClass(p,"audio_friend_selected"),l=this.ap.getPlaylist(AudioPlaylist.TYPE_ALBUM,c,AudioUtils.AUDIO_ALBUM_ID_ALL),geByClass1("_audio_friend_"+c)||this.showMoreFriends(!1,c)}else if(o.section==AudioPlaylist.TYPE_RECOM){var g=AudioUtils.AUDIO_ALBUM_ID_ALL;o.audio_id?g="audio"+o.audio_id:o.album_id&&(g="album"+o.album_id),
l=this.ap.getPlaylist(AudioPlaylist.TYPE_RECOM,this.options.oid,g)}else o.section==AudioPlaylist.TYPE_FEED?l=this.ap.getPlaylist(AudioPlaylist.TYPE_FEED,vk.id,0):o.section==AudioPlaylist.TYPE_CURRENT?l=this.ap.getCurrentPlaylist():o.band?(l=this.ap.getPlaylist(AudioPlaylist.TYPE_ALBUM,intval(o.band),AudioUtils.AUDIO_ALBUM_ID_ALL),l.mergeWith({band:1})):o.album_id?l=this.ap.getPlaylist(AudioPlaylist.TYPE_ALBUM,this.options.oid,o.album_id):(l=this.ap.getPlaylist(AudioPlaylist.TYPE_ALBUM,this.options.oid,AudioUtils.AUDIO_ALBUM_ID_ALL),addClass(uiSearch.getWrapEl(this.searchInputEl),"ui_search_field_empty"));return o.section!=AudioUtils.AUDIO_PLAYLIST_TYPE_RECOMS&&(delete o.audio_id,o.section&&delete o.album_id),r&&(this._prevRenderedPlaylistId=!1,val(this.searchInputEl,""),this._muteFilterEvent=!0,uiSearch.removeAllFilters(this.searchInputEl),delete o.performer,delete o.lyrics,delete o.sort,this._muteFilterEvent=!1),this.options.isLayer?e=o:nav.setLoc(o),this.syncFilters(o),this.switchToSection(l,!0),!1}.bind(this))},AudioPage.prototype.deleteCurrentPlaylist=function(e){this.ap.deleteCurrentPlaylist();var i=this.ap.getPlaylist(AudioPlaylist.TYPE_ALBUM,vk.id,AudioUtils.AUDIO_ALBUM_ID_ALL);this.switchToSection(i),re(geByClass1("_ui_item_audio_current",this._getMenuEl())),window.tooltips&&tooltips.hideAll(),this.ap.updateCurrentPlaying(),cancelEvent(e)},AudioPage.prototype.setTooltipTitle=function(e){if(!e.titleSet){var i=geByClass1("audio_page_player_title_performer",e),t=geByClass1("audio_page_player_title_song",e);(i.scrollWidth>i.clientWidth||t.scrollWidth>t.clientWidth)&&e.setAttribute("title",e.innerText),e.titleSet=!0}},AudioPage.prototype._initPlayer=function(){function e(e){e=AudioUtils.asObject(e),l.innerHTML=e.performer,d.innerHTML="&ndash; "+e.title}function i(e,i){e=AudioUtils.asObject(e);var t,o=a.getDurationType(),s=intval(e.duration);return t=o?"-"+formatTime(Math.round(s-i*s)):formatTime(Math.round(i*s))}function t(){if(o._trackSlider){var e=AudioUtils.asObject(o._readyAudio||a.getCurrentAudio()),i=e.ownerId!=vk.id;if(p!==i){toggle(c,i);var t=geByClass1("audio_page_player_track_wrap"),s=window.getComputedStyle(t);o._trackSlider.updateSize(getSize(t)[0]-parseInt(s.paddingLeft)-parseInt(s.paddingRight)),p=i}cur._audioAddRestoreInfo=cur._audioAddRestoreInfo||{};var r=cur._audioAddRestoreInfo[e.fullId];addClass(c,"no_transition"),toggleClass(c,"audio_player_btn_added",!(!r||"added"!=r.state)),removeClassDelayed(c,"no_transition"),toggleClass(h,"audio_page_player_btn_enabled",o.ap.isRepeatCurrentAudio())}}var o=this,a=getAudioPlayer(),s=this._container,r=geByClass1("_audio_page_player",s),n=geByClass1("audio_page_player_title",r),l=geByClass1("audio_page_player_title_performer",r),d=geByClass1("audio_page_player_title_song",r),u=geByClass1("audio_page_player_duration",r),_=geByClass1("_audio_page_player_play",r),h=geByClass1("_audio_page_player_repeat",r),c=geByClass1("_audio_page_player_add",r),p=void 0;t(),this._trackSlider=new Slider(geByClass1("audio_page_player_track_slider",r),{value:a.getCurrentProgress(),backValue:a.getCurrentBuffered(),size:1,hintClass:"audio_player_hint",withBackLine:!0,formatHint:function(e){var i=a.getCurrentAudio()||o._readyAudio;return i=AudioUtils.asObject(i),formatTime(Math.round(e*i.duration))},onEndDragging:function(e){a.seek(e)}}),this._volumeSlider=new Slider(geByClass1("audio_page_player_volume_slider",r),{value:a.getVolume(),size:1,hintClass:"audio_player_hint",formatHint:function(e){return Math.round(100*e)+"%"},onChange:function(e){a.setVolume(e)}}),this.ap.on(this,AudioPlayer.EVENT_ADDED,function(e,i){e=AudioUtils.asObject(e),e&&e.fullId==i&&addClass(c,"audio_player_btn_added")}),this.ap.on(this,AudioPlayer.EVENT_REMOVED,function(e,i){e=AudioUtils.asObject(e),e&&e.fullId==i&&removeClass(c,"audio_player_btn_added")}),this.ap.on(this,AudioPlayer.EVENT_PLAY,function(a,s,l){delete o._readyAudio,domData(r,"audio",JSON.stringify(a)),t(),e(a),addClass(_,"audio_playing"),s&&(o._trackSlider.setBackValue(0),o._trackSlider.setValue(0),u.innerHTML=i(a,0),n.setAttribute("title",""),n.titleSet=!1)}),this.ap.on(this,AudioPlayer.EVENT_PAUSE,function(e){removeClass(_,"audio_playing")}),this.ap.on(this,AudioPlayer.EVENT_BUFFERED,function(e,i){o._trackSlider.setBackValue(i)}),this.ap.on(this,AudioPlayer.EVENT_VOLUME,function(e,i){o._volumeSlider.setValue(i)}),this.ap.on(this,AudioPlayer.EVENT_UPDATE,function(e,t){e&&t&&(u.innerHTML=i(e,t))}),this.ap.on(this,AudioPlayer.EVENT_PROGRESS,function(e,t){o._trackSlider.setValue(t),u.innerHTML=i(e,t)});var g=this.ap.getCurrentAudio()||this._readyAudio;g&&(domData(r,"audio",JSON.stringify(g)),e(g)),t()},AudioPage.prototype.scrollToTrack=function(){var e=this,i=this.getCurrentPlaylist(),t=this.ap.getCurrentAudio();if((!this.isLayer()||this.getLayer().isShown())&&i&&-1!=i.indexOfAudio(t)){this.ap.updateCurrentPlaying();var o=geByClass1(AudioUtils.AUDIO_PLAYING_CLS,this._container);if(!o&&this.isLayer()){t=AudioUtils.asObject(t);for(var a=100;a--&&(this._autoList.drawMore(),o=geByClass1("_audio_row_"+t.fullId,this._container),!(o||this._autoList.isPendingRows()||this._autoList.isDone())););}if(o){var s=this.isLayer()?geByClass1("audio_layer_rows_wrap",this._container):bodyNode,r=this.isLayer()?s.scrollTop:0,n=this.isLayer()?getSize(s)[1]:clientHeight(),l=this.isLayer()?getXY(s)[1]:0,d=getXY(o)[1]-l+r,u=getSize(o)[1],_=d-n/2+u/2;e.isLayer()?(s.scrollTop=_,setTimeout(function(){s.scrollTop=_,e.getLayer().sb.update()})):scrollToY(_,400)}}},AudioPage.prototype.togglePlayerPlay=function(e){if(this.ap.isPlaying())this.ap.pause();else{var i,t=this.getCurrentPlaylist(),o=this.ap.getCurrentPlaylist(),a=this._readyAudio?this._readyAudio:t.getAudioAt(0);-1!=t.indexOfAudio(a)?i=t:o&&-1!=o.indexOfAudio(a)?i=o:(i=new AudioPlaylist(AudioPlaylist.TYPE_TEMP,vk.id),i.addAudio(a)),delete this._readyAudio,this.ap.play(a,i)}};try{stManager.done("audio.js")}catch(e){}