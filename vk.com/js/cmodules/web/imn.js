! function(e) {
    var t = {};

    function n(r) {
        if (t[r]) return t[r].exports;
        var i = t[r] = {
            i: r,
            l: !1,
            exports: {}
        };
        return e[r].call(i.exports, i, i.exports, n), i.l = !0, i.exports
    }
    n.m = e, n.c = t, n.d = function(e, t, r) {
        n.o(e, t) || Object.defineProperty(e, t, {
            enumerable: !0,
            get: r
        })
    }, n.r = function(e) {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
            value: "Module"
        }), Object.defineProperty(e, "__esModule", {
            value: !0
        })
    }, n.t = function(e, t) {
        if (1 & t && (e = n(e)), 8 & t) return e;
        if (4 & t && "object" == typeof e && e && e.__esModule) return e;
        var r = Object.create(null);
        if (n.r(r), Object.defineProperty(r, "default", {
                enumerable: !0,
                value: e
            }), 2 & t && "string" != typeof e)
            for (var i in e) n.d(r, i, function(t) {
                return e[t]
            }.bind(null, i));
        return r
    }, n.n = function(e) {
        var t = e && e.__esModule ? function() {
            return e.default
        } : function() {
            return e
        };
        return n.d(t, "a", t), t
    }, n.o = function(e, t) {
        return Object.prototype.hasOwnProperty.call(e, t)
    }, n.p = "", n(n.s = 126)
}([function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return p
    });
    var r = n(146),
        i = n(176),
        o = n(54),
        a = n(102),
        s = n(18),
        c = n(194),
        u = n(128);

    function l(e) {
        var t = e.get().tabbedPeers.map(function(t) {
            return e.get().tabs[t.peer] || e.get().mapped_index && e.get().mapped_index[t.peer]
        }).filter(function(e) {
            return e
        }).filter(function(e) {
            return !e.deletedDialog
        }).map(function(e) {
            return {
                type: "peer",
                peer: e.peerId
            }
        });
        return t.length > 0 && (t = [{
            type: "sep"
        }].concat(t)), t
    }

    function d(e, t) {
        return e.pipeReplace(Promise.resolve(l(t)))
    }

    function f(e, t, n, r) {
        return {
            updateMenu: function(t) {
                ! function(e, t) {
                    geByClass("_im_peer_tab", e).forEach(function(e) {
                        var n = q2ajx(attr(e, "href").split("?")[1]);
                        n.tab !== t.get().active_tab && attr(e, "href", Object(o.getBaseLink)(t) + "?sel=" + n.sel + "&tab=" + t.get().active_tab)
                    })
                }(e, t);
                var r = gpeByClass("_im_right_menu", e);
                d(n, t).then(function() {
                    var e = void 0;
                    (e = t.get().peer ? ge("ui_rmenu_peer_" + t.get().peer) : ge("ui_rmenu_" + t.get().active_tab)) && uiRightMenu.switchMenu(e, !0), uiRightMenu.hideProgress(r)
                })
            },
            updateName: function(e, t) {
                var n = ge("ui_rmenu_peer_" + e);
                if (n) {
                    var r = geByClass1("_im_r_tx", n),
                        i = t.get().tabs[e].tab;
                    val(r, i)
                }
            },
            updateCounter: function(e, t) {
                var n = ge("ui_rmenu_peer_" + t);
                if (n) {
                    var r = geByClass1("_im_r_ct", n),
                        i = e.get().tabs[t].unread;
                    val(r, i > 0 ? i : ""), toggleClass(n, "im-right-menu--unread", i > 0)
                }
            },
            unmount: function() {
                Object(c.destroyModule)(r), n.unmount()
            }
        }
    }

    function p(e, t, n) {
        var p = Object(r.mount)(e, Object(i.default)({
                limit: 50,
                offset: 0,
                noScroll: !0,
                elements: l(t)
            }), function() {
                return {
                    idFn: function(e) {
                        return e.peer || "000"
                    },
                    renderFn: function(e, t) {
                        if ("sep" === t.type) return getTemplate("im_right_menu_sep", {});
                        var n = Object(o.getBaseLink)(e) + "?sel=" + t.peer + "&tab=" + e.get().active_tab,
                            r = Object(o.getBareTab)(t.peer, e),
                            i = r.tab;
                        return i = getTemplate("im_right_menu_ct", {
                            name: i,
                            count: r.unread > 0 ? r.unread : ""
                        }), getTemplate("im_right_menu_tpl", {
                            href: n,
                            label: i,
                            peer: t.peer,
                            attrs: 'title="' + stripHTML(r.tab) + '"',
                            cls: r.unread > 0 ? "im-right-menu--unread" : ""
                        })
                    }.bind(null, t)
                }
            }),
            m = function(e, t, n, r) {
                var i = gpeByClass("_im_peer_tab", r),
                    o = intval(domData(i, "list-id")),
                    c = e.get().tabbedPeers.filter(function(e) {
                        return e.peer !== o
                    });
                return e.set(a.updateTabbedPeers.bind(null, c, !0)).then(function() {
                    if (d(t, e), o === e.get().peer) e.get().longpoll.push([Object(s.resetPeer)()]);
                    else if (0 !== e.get().peer) {
                        var n = gpeByClass("_im_right_menu", r);
                        uiRightMenu.hideSliding(n)
                    }
                }), cancelEvent(n), !1
            }.bind(null, t, p),
            g = Object(c.createModule)({
                handlers: function(n, r) {
                    r(e, "click", "_im_r_cl", m), r(e, "click", "_im_peer_tab", function(e, n) {
                        if (!checkEvent(e)) {
                            var r = intval(domData(n, "list-id"));
                            t.get().longpoll.push([Object(s.changePeer)(r, !1, !0, !0)]), cancelEvent(e)
                        }
                    }), u.FOLDERS.forEach(function(r) {
                        n(geByClass1("_ui_item_" + r, e.parentNode), "mousedown", function(e, t, n) {
                            1 === n.which && (e.get().peer && e.get().longpoll.push([Object(s.resetPeer)()]), e.get().longpoll.push([Object(s.changeTab)(t)]), cancelEvent(n))
                        }.bind(null, t, r))
                    })
                }
            });
        return f(e, 0, p, g)
    }
}, function(e, t, n) {
    "use strict";
    var r = Object.getOwnPropertySymbols,
        i = Object.prototype.hasOwnProperty,
        o = Object.prototype.propertyIsEnumerable;
    e.exports = function() {
        try {
            if (!Object.assign) return !1;
            var e = new String("abc");
            if (e[5] = "de", "5" === Object.getOwnPropertyNames(e)[0]) return !1;
            for (var t = {}, n = 0; n < 10; n++) t["_" + String.fromCharCode(n)] = n;
            if ("0123456789" !== Object.getOwnPropertyNames(t).map(function(e) {
                    return t[e]
                }).join("")) return !1;
            var r = {};
            return "abcdefghijklmnopqrst".split("").forEach(function(e) {
                r[e] = e
            }), "abcdefghijklmnopqrst" === Object.keys(Object.assign({}, r)).join("")
        } catch (e) {
            return !1
        }
    }() ? Object.assign : function(e, t) {
        for (var n, a, s = function(e) {
                if (null === e || void 0 === e) throw new TypeError("Object.assign cannot be called with null or undefined");
                return Object(e)
            }(e), c = 1; c < arguments.length; c++) {
            for (var u in n = Object(arguments[c])) i.call(n, u) && (s[u] = n[u]);
            if (r) {
                a = r(n);
                for (var l = 0; l < a.length; l++) o.call(n, a[l]) && (s[a[l]] = n[a[l]])
            }
        }
        return s
    }
}, function(e, t) {
    e.exports = function(e) {
        if ("function" != typeof e) throw TypeError(e + " is not a function!");
        return e
    }
}, function(e, t, n) {
    n(106), n(16), n(200), n(190), e.exports = n(184).Map
}, function(e, t, n) {
    var r = n(35);
    e.exports = function(e) {
        if (!r(e)) throw TypeError(e + " is not an object!");
        return e
    }
}, function(e, t, n) {
    var r = n(170)("keys"),
        i = n(51);
    e.exports = function(e) {
        return r[e] || (r[e] = i(e))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151)),
        o = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.onTransitionEnd = function(e) {
                r.state.shown && "opacity" === e.propertyName && (r.timeout = setTimeout(function() {
                    r.setState({
                        shown: !1
                    }), r.props.callback()
                }, r.props.duration))
            }, r.state = {
                shown: n.shown
            }, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentWillReceiveProps = function(e) {
            !this.props.shown && e.shown && this.setState({
                shown: !0
            })
        }, t.prototype.componentWillUnmount = function() {
            this.timeout && clearTimeout(this.timeout)
        }, t.prototype.render = function() {
            var e = this.props,
                t = (e.shown, e.callback, e.duration, e.className),
                n = e.children,
                a = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["shown", "callback", "duration", "className", "children"]),
                s = Object(i.classNames)("BlinkText", {
                    "BlinkText--shown": this.state.shown
                }, t);
            return r.createElement("span", o({}, a, {
                className: s,
                onTransitionEnd: this.onTransitionEnd,
                "aria-hidden": !0
            }), n)
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        duration: 2e3
    }
}, function(e, t, n) {
    "use strict";

    function r(e, t) {
        var n = [],
            r = 0;
        return function(i) {
            n.push(i), r || (r = setTimeout(function() {
                r = !1, e(n), n = []
            }, t))
        }
    }

    function i(e) {
        return e.length > 0 && e.pop().func(), e
    }

    function o(e, t) {
        var n = void 0,
            r = void 0;
        if (window.__debugMode) {
            switch (t) {
                case "error":
                    n = "color: red", r = "background: red; color: white";
                    break;
                case "success":
                    n = "color: green", r = "background: green; color: white";
                    break;
                default:
                    n = "color: blue;", r = "background: #000; color: #fff;"
            }
            try {
                var i = new Date;
                console.debug("%cLP:[" + i.getHours() + ":" + i.getMinutes() + ":" + i.getSeconds() + ":" + i.getMilliseconds() + "]%c " + e, r, n)
            } catch (e) {}
        }
    }

    function a(e) {
        var t = [];
        if (void 0 === e.length) return Object.keys(e).map(function(t) {
            return e[t]
        });
        for (var n = 0; n < e.length; n++) t.push(e[n]);
        return t
    }

    function s(e) {
        for (var t = {}, n = [], r = 0; r < e.length; r++) t[e[r]] || (n.push(e[r]), t[n[r]] = 1);
        return n
    }

    function c(e) {
        for (var t = (e + "=".repeat((4 - e.length % 4) % 4)).replace(/\-/g, "+").replace(/_/g, "/"), n = window.atob(t), r = new Uint8Array(n.length), i = 0; i < n.length; ++i) r[i] = n.charCodeAt(i);
        return r
    }

    function u(e) {
        return e.get ? e.get() : e
    }
    n.r(t), n.d(t, "throttleAccumulate", function() {
        return r
    }), n.d(t, "executionStackPop", function() {
        return i
    }), n.d(t, "lplog", function() {
        return o
    }), n.d(t, "toArray", function() {
        return a
    }), n.d(t, "arrayUnique", function() {
        return s
    }), n.d(t, "urlBase64ToUint8Array", function() {
        return c
    }), n.d(t, "unpackStore", function() {
        return u
    })
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(65),
        o = (n(195), n(151)),
        a = n(189);
    var s = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var i = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return i.onMouseEnter = function(e) {
                if (i.el) {
                    var t = i.props,
                        n = t.text,
                        r = t.position,
                        o = t.align,
                        s = t.marginTop,
                        c = t.marginLeft,
                        u = Object(a.default)(i.el);
                    i.update({
                        text: n,
                        position: r,
                        align: o,
                        rect: u,
                        marginTop: s,
                        marginLeft: c
                    })
                }
            }, i.onMouseLeave = function(e) {
                return i.update()
            }, i.onTransitionEnd = function(e) {
                "visibility" === e.propertyName && i.state.tooltip && i.setState({
                    tooltip: void 0
                })
            }, i.renderTooltip = function() {
                if (!i.state.tooltip) return null;
                var e, t, n, a = i.state.tooltip,
                    s = a.x,
                    c = a.y,
                    u = a.position,
                    l = a.align,
                    d = a.text,
                    f = a.removed,
                    p = Object(o.classNames)("Tooltip", "Tooltip--" + u, (e = {
                        "Tooltip--removed": !!f
                    }, t = "Tooltip--align-" + l, n = "t" === u || "b" === u, t in e ? Object.defineProperty(e, t, {
                        value: n,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : e[t] = n, e));
                return r.createElement("div", {
                    className: p,
                    style: {
                        top: c,
                        left: s
                    },
                    onTransitionEnd: i.onTransitionEnd
                }, r.createElement("div", {
                    className: "Tooltip__in",
                    dangerouslySetInnerHTML: {
                        __html: d
                    }
                }))
            }, i.state = {}, i
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentDidMount = function() {
            this.el = i.findDOMNode(this), this.el.addEventListener("mouseenter", this.onMouseEnter), this.el.addEventListener("mouseleave", this.onMouseLeave)
        }, t.prototype.componentWillUnmount = function() {
            this.el.removeEventListener("mouseenter", this.onMouseEnter), this.el.removeEventListener("mouseleave", this.onMouseLeave)
        }, t.prototype.update = function(e) {
            if (!e) return this.setState({
                tooltip: Object.assign({}, this.state.tooltip, {
                    removed: !0
                })
            });
            var t = e.position,
                n = e.align,
                r = e.text,
                i = e.rect,
                o = e.marginTop,
                a = e.marginLeft,
                s = i.left,
                c = i.top;
            switch (t) {
                case "t":
                    s += .5 * i.width;
                    break;
                case "r":
                    s += i.width, c += .5 * i.height;
                    break;
                case "b":
                    s += .5 * i.width, c += i.height;
                    break;
                case "l":
                    c += .5 * i.height
            }
            s = Math.round(s + a), c = Math.round(c + o), this.setState({
                tooltip: {
                    position: t,
                    align: n,
                    text: r,
                    x: s,
                    y: c
                }
            })
        }, t.prototype.render = function() {
            var e = this.renderTooltip();
            return e ? (this.defaultNode || "undefined" == typeof window || (this.defaultNode = document.createElement("div"), document.body.appendChild(this.defaultNode)), r.createElement(r.Fragment, null, this.props.children, i.createPortal(e, this.defaultNode))) : this.props.children
        }, t
    }(r.Component);
    t.default = s, s.defaultProps = {
        position: "b",
        align: "center",
        marginTop: 0,
        marginLeft: 0
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(151),
        o = n(109),
        a = n(8),
        s = n(19),
        c = n(187),
        u = n(102),
        l = n(50);
    var d = window.unclean,
        f = o.default.getLang,
        p = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onSaveTitle = function(e) {
                    var t = r.props.store,
                        n = t.get(),
                        i = e.value.trim().replace("\n", "");
                    i && i !== d(r.props.title) && (r.setState({
                        titleChanged: !1
                    }), t.set(u.updateChatTopic.bind(null, n.peer, i)))
                }, r.onChangeTitle = function(e) {
                    if (r.state.title !== e.target.value) {
                        var t = e.target.value.replace("\n", "");
                        r.setState({
                            title: t,
                            titleChanged: d(r.props.title) !== t
                        })
                    }
                }, r.onValidateTitle = function(e) {
                    return !!e.trim().replace("\n", "")
                }, r.onCancelTitle = function() {
                    r.setState({
                        title: d(r.props.title),
                        titleChanged: !1
                    })
                }, r.onSaveDescription = function(e) {}, r.onPhotoUpload = function() {
                    var e = r.props.store,
                        t = e.get().peer;
                    Object(c.canChangeTitle)(e) && (cur.recieveCropResult = void 0, Page.ownerPhoto(t, {
                        gid: e.get().gid
                    }))
                }, r.onPhotoRemove = function() {
                    var e = r.props.store,
                        t = e.get().peer;
                    Object(c.canChangeTitle)(e) && e.set(u.removeChatPhoto.bind(null, t)).then(function() {
                        return e.set(u.getChatDetails.bind(null, t))
                    }).catch(function(e) {
                        return Object(l.imWeirdCatch)("onPhotoRemove", e)
                    })
                }, r.state = {
                    title: d(n.title),
                    titleChanged: !1
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.store,
                    n = e.photo,
                    o = e.title,
                    u = e.description,
                    l = e.grid,
                    p = e.meta,
                    m = d(o),
                    g = Object(c.canChangeTitle)(t),
                    h = Object(i.classNames)("ChatSettingsInfo", {
                        "ChatSettingsInfo--editable": g
                    }),
                    _ = Object(i.classNames)("ChatSettingsInfo__title", {
                        "ChatSettingsInfo__title-service": 64 & this.props.flags
                    });
                return r.createElement("div", {
                    className: h
                }, r.createElement("header", {
                    className: "ChatSettingsInfo__header"
                }, r.createElement("div", {
                    className: "ChatSettingsInfo__photo"
                }, r.createElement("div", {
                    className: "ChatSettingsInfo__attach nim-peer nim-peer_larger",
                    "data-tip": f("mail_settings_photo"),
                    onClick: this.onPhotoUpload
                }, n ? r.createElement("img", {
                    src: n,
                    width: "80",
                    height: "80",
                    alt: m,
                    className: "ChatSettingsInfo__photoSelf"
                }) : r.createElement("div", {
                    className: "nim-peer--photo-w"
                }, r.createElement("div", {
                    className: "ChatSettingsInfo__photoGrid nim-peer--photo",
                    dangerouslySetInnerHTML: {
                        __html: l
                    }
                }))), n && g && r.createElement(a.default, {
                    text: f("mail_settings_remove_photo"),
                    position: "t",
                    align: "left"
                }, r.createElement("button", {
                    onClick: this.onPhotoRemove,
                    className: "ChatSettingsInfo__photoRemove"
                }))), r.createElement("h3", {
                    className: _
                }, g ? r.createElement(s.default, {
                    value: this.state.title,
                    changed: this.state.titleChanged,
                    useEnter: !0,
                    onSave: this.onSaveTitle,
                    onChange: this.onChangeTitle,
                    onCancel: this.onCancelTitle,
                    validate: this.onValidateTitle
                }) : m), r.createElement("div", {
                    className: "ChatSettingsInfo__meta"
                }, p)), u && r.createElement("div", {
                    className: "ChatSettingsInfo__description"
                }, g ? r.createElement(s.default, {
                    value: u,
                    onSave: this.onSaveDescription
                }) : u))
            }, t
        }(r.PureComponent);
    t.default = p
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createLongpollEventsQueue", function() {
        return a
    });
    var r = n(13),
        i = n(143);

    function o(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
            return n
        }
        return Array.from(e)
    }

    function a(e, t) {
        var n = 0,
            a = e,
            s = [],
            c = !1;

        function u() {
            !s.length || n > 0 || c || (t(s), s = [])
        }
        return {
            pause: function() {
                n++
            },
            resume: function() {
                n > 0 && (n--, u())
            },
            onLp: function(e, t, n) {
                var l;
                c || (a >= e ? (a = t, (l = s).push.apply(l, o(n)), u()) : function() {
                    var e = window.extend({}, window.lpConnect.options, {
                        ts: a
                    });
                    Object(i.lpLogFc)("orange", "createLongPoll to load from", a), c = !0;
                    var t = Object(r.createLongPoll)(e, function(e, n, r) {
                        var l;
                        Object(i.lpLogFc)("orange", "Loaded [" + e + "," + n + ")"), t.stopConnection(), a = n, c = !1, (l = s).push.apply(l, o(r)), u()
                    })
                }())
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "oCacheExists", function() {
        return i
    }), n.d(t, "oCacheGet", function() {
        return o
    }), n.d(t, "oCacheAdd", function() {
        return a
    });
    var r = n(7);

    function i(e, t) {
        return t in Object(r.unpackStore)(e).oCache
    }

    function o(e, t) {
        var n = Object(r.unpackStore)(e).oCache[t];
        return n && !n._n && (! function(e) {
            if (!e.first_name) {
                var t = e.name.split(" ", 2);
                e.first_name = t[0], e.short_name = t[1] ? t[0] + " " + t[1].substr(0, 1) + "." : t[0]
            }
            e.inv_name || (e.inv_name = e.name), e.kick_name || (e.kick_name = e.inv_name)
        }(n), n._n = 1), n
    }

    function a(e, t) {
        var n = Object(r.unpackStore)(e);
        n.oCache || (n.oCache = {}), t.id && (n.oCache[t.id] = t)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return re
    });
    var r = n(156),
        i = n(110),
        o = n(153),
        a = n(84),
        s = n(53),
        c = n(100),
        u = n(204),
        l = n(69),
        d = n(194),
        f = n(157),
        p = n(113),
        m = n(18),
        g = n(208),
        h = n(171),
        _ = n(0),
        v = n(63),
        b = n(76),
        y = n(7),
        w = n(148),
        O = n(26),
        C = n(102),
        k = n(54),
        E = n(128),
        j = n(142),
        S = n(119),
        T = n(11),
        I = n(50),
        P = n(79),
        M = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function x(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    var L = 30,
        A = 400,
        N = 250,
        D = 32,
        R = 5 * D + 24 + 52,
        F = 3 * D + 24,
        B = 10,
        H = "._im_aside_notice";

    function U(e, t) {
        "spam" === t ? Object(k.showSpamLayer)(e, h.mount, {}) : "fav" === t && Object(k.showFavvedBox)(e, {}, j.mount, {})
    }

    function z(e, t) {
        if (e.get().gid) {
            var n = t.parentNode,
                r = geByClass("_im_right_menu_counter", n),
                i = e.get().dialog_tab_cts;
            r.forEach(function(e) {
                var t = domData(e, "tab");
                val(e, i[t] || "")
            })
        }
    }

    function G(e, t, n, r, i) {
        e.forEach(function(e) {
            switch (e.kludges.source_act) {
                case k.CHAT_PHOTO_REMOVE:
                case k.CHAT_PHOTO_UPDATE:
                    ! function(e, t, n, r) {
                        t.set(C.updateChatPhoto.bind(null, e)).then(function() {
                            var i = e.kludges.source_act;
                            n.updateDialog(e.peerId, t), r.updateChatPhoto(e, i, t)
                        })
                    }(e, t, n, r)
            }
        })
    }

    function W(e, t) {
        var n = e.get().longpoll.push.bind(null, [m.resetPeer()]);
        cancelStackPush("im_peer", function r() {
            var i = e.get().selectedMessages;
            i && i.length ? (e.setState({
                selectedMessages: []
            }).then(function() {
                t.changedMessageSelection(e), t.cleanSelection(i)
            }), setTimeout(function() {
                return cancelStackPush("im_peer", r)
            }, 0)) : n()
        })
    }

    function V(e) {
        var t = e.attaches.filter(function(e) {
            return "sticker" !== e.type
        });
        return Object(O.isServiceMsg)(e) || 0 === t.length
    }

    function K(e, t, n) {
        addClass(n, "im-page_history-show"), t.loadingPeer(e)
    }

    function q(e, t) {
        var n = function(e, t) {
            var n = document.querySelector(H),
                r = Object(k.isCommunityInterface)(e) ? R : F,
                i = n ? n.offsetHeight : 0;
            return r += B, r += i, Math.floor((t.offsetHeight - r) / D)
        }(e, t);
        if (e.get().tabbedPeers.length > n) {
            var r = e.get().tabbedPeers.filter(function(t) {
                    var n = t.peer;
                    return intval(n) !== e.get().peer
                }).map(function(t) {
                    var n = t.peer;
                    return e.get().tabs[n]
                }).sort(function(e, t) {
                    return t.last_touched - e.last_touched
                }),
                i = [];
            0 !== e.get().peer && i.push(e.get().tabs[e.get().peer]);
            var o = i.concat(r).slice(n).map(function(e) {
                    return e.peerId
                }),
                a = e.get().tabbedPeers.filter(function(e) {
                    return !inArray(e.peer, o)
                });
            return e.set(C.updateTabbedPeers.bind(null, a, !0))
        }
        return Promise.resolve(e)
    }

    function Q() {
        for (var e = curBox(); e;) e.hide(), e = curBox()
    }

    function $(e, t, n, r, i, o, a, s, c) {
        e.get().audio_msg.isRecording && e.set(C.cancelRecording).then(function() {
            r.cancelRecording()
        }), AudioMessagePlayer.detachPlayer(), t.forward && r.hideFwd(e), Object(w.isAnyMessageBeingEdited)(e) && r.cancelEditing(), Object(w.isSearching)(e) && t.cancelSearch && (i.clearSearch(e), n.restoreDialogs(e), c().toggleSettingsButton(e, !1)), Y(e, s, c), K(e, r, o);
        var u = e.get().peer;
        Object(C.updateMentions)(e.get()), Object(C.videoAutoPlayHandler)(), Object(k.isFullyLoadedTab)(e, t.peerId) && (t.msgid && !Object(w.getMessage)(e, t.peerId, t.msgid) || !t.msgid && !Object(w.getMessage)(e, t.peerId, Object(w.getTab)(e, t.peerId).lastmsg) || Object(w.getTab)(e, t.peerId).skipped) && e.mutate(function(e) {
            return Object(w.makeTabNotFullyLoaded)(e, t.peerId)
        });
        var l = e.set(C.changePeer.bind(null, t.peerId, t.msgid, t.entryPoint)).then(function(e) {
            var n = e.get(),
                r = C.loadPeer.bind(null, t.peerId, !1, t.msgid, !1, n);
            return n.tabs[t.peerId] ? Promise.resolve(n) : e.set(r)
        }).then(function() {
            n.selectPeer(t.msgid, e),
                function(e, t) {
                    Object(k.isPendingForward)(e) && (cancelStackFilter("forward"), e.set(C.forwardMessages.bind(null, e.get().pendingForward, Object(w.getTabDraft)(Object(w.getTab)(e, t)))))
                }(e, e.get().peer), window.tooltips && tooltips.hideAll(), Q(), r.preparePeer(e), W(e, r), Object(k.isClassicInterface)(e) && (n.deactivate(), q(e, o).then(function() {
                    return a.updateMenu(e)
                }))
        });
        return (l = t.msgid ? l.then(function() {
            return e.set(C.selectPeerOnMessage.bind(null, t.peerId === u, u))
        }) : l.then(function() {
            return e.set(C.selectPeer.bind(null, !0))
        })).then(function() {
            if (e.get().peer === t.peerId) {
                if (t.forward) {
                    var n = e.get().tabs[e.get().peer];
                    !n.scrollBottom && n.unread && e.set(C.readLastMessages.bind(null, e.get().peer))
                }
                Object(k.isClassicInterface)(e) && a.updateMenu(e), r.changePeer(e, !1), r.updateTyping(t.peerId, e), Object(C.updateMentions)(e.get())
            }
        }).catch(function(e) {
            return Object(I.imWeirdCatch)("applyNewPeer", e)
        })
    }

    function Y(e, t, n) {
        t && e.get().shown && (t.hide(e), n().createCanceled(e))
    }

    function X(e, t, n) {
        Object(w.isSearching)(e) && (t.clearSearch(e), n.restoreDialogs(e))
    }

    function Z(e, t, n, r, i, o, a) {
        Object(k.isClassicInterface)(e) && (i.saveScroll(e), o.saveScroll(e)), r.rotateCross(e), addClass(a, "im-page_creating"), e.setState({
            isCreating: !0
        }), n && n.show(e, t), Object(k.isClassicInterface)(e) && (setStyle(a, {
            height: ee(a, e).page
        }), setTimeout(function() {
            addClass(a, "im-page_cropped")
        }, 200)), Object(C.toggleConversation)(!0)
    }

    function J(e, t, n, r, i, o, a, s, c, u, f, p, g, h, _, v, b, y, j, S, I) {
        return {
            changePeer: function(e, n) {
                t.selectPeer(e, n)
            },
            cancelSearch: function(e) {
                X(e, r, t)
            },
            loadingPeer: function(e) {
                K(e, n, i)
            },
            restoreDialogs: function(e, n, r) {
                t.restoreDialogs(e, n, r)
            },
            toggleSettingsButton: function(e, t) {
                f.toggleButton(e, t)
            },
            focusSearch: function(e) {
                r.focusInput(e)
            },
            appendSearch: function(e, n, r, i) {
                t.appendSearch(e, n, r, i)
            },
            appendDialogs: function(e, n) {
                t.appendDialogs(e, n)
            },
            showCreation: function(e, o) {
                Z(e, o, u, r, t, n, i)
            },
            updateState: function(e, r) {
                t.updateDialog(e, r), r.get().peer === e && n.updateChat(r, e)
            },
            appendFastDialogs: function(e, n) {
                t.appendFastDialogs(e, n, !0)
            },
            createCanceled: function(e, o) {
                r.createCanceled(e, o), Object(k.isClassicInterface)(e) ? (setStyle(i, {
                    height: "auto"
                }), removeClass(i, "im-page_cropped"), setTimeout(function() {
                    return r.focusInput(e)
                }, 0), 0 === e.get().peer ? t.restoreScroll(e) : n.restoreScroll(e, e.get().peer)) : setTimeout(function() {
                    0 === e.get().peer ? r.focusInput(e) : n.focustTxt(e)
                }, 0), removeClass(i, "im-page_creating"), e.setState({
                    isCreating: !1
                })
            },
            updateMenu: function(e) {
                v && v.updateMenu(e)
            },
            hideFwd: function(e) {
                n.hideFwd(e)
            },
            goToHistoryEnd: function() {
                n.goToEnd()
            },
            updateDialog: function(e, n) {
                t.updateDialog(e, n)
            },
            focusTxt: function(e) {
                n.focustTxt(e)
            },
            resync: function(e) {
                Object(w.isSearching)(e) && r.clearSearch(e), t.restoreDialogs(e, !0, !0), t.focusOnSelected(e), u && u.hide(e), Object(k.isCommunityInterface)(e) && z(e, i), Object(k.isClassicInterface)(e) && e.get().tabbedPeers.forEach(function(t) {
                    var n = t.peer;
                    v.updateCounter(e, n), v.updateName(n, e)
                }), n.cleanSelection(e.get().selectedMessages || []), n.cancelSearch(e, !0), Object(k.isReservedPeer)(e.get().peer) || n.changePeer(e, !1);
                var o = e.get().gid ? "l_mgid" + e.get().gid : "msg";
                handlePageCount(o, e.get().unread_cnt)
            },
            toggleSettingsLoader: function(e, t) {
                f.toggleLoader(e, t)
            },
            onUserActions: function(e, t) {
                if (!Object(C.isSearchingInplace)(e.get().peer, e.get())) {
                    var r = e.get(),
                        i = r.peer;
                    if (Object(k.isFullyLoadedTab)(r, i))
                        if (!o.is_idle)
                            if (Object(w.countUnread)(e.get().peer, e.get()) > 0) !r.tabs[i].skipped && n.isNewMessagesVisible(e) && (n.hideGoToEnd(!0), e.set(C.readLastMessages.bind(null, i)))
                }
            },
            removeSelection: function(e) {
                t.removeSelection(e), r.focusInput(e)
            },
            route: function(e, o, a, s) {
                if (void 0 !== e[0]) return !0;
                e.box && (e = {
                    box: e.box
                });
                var l = !1;
                return !(!e.invite_chat_id || !a.invite_hash) || (s && s.params && "left_nav" === s.params._ref && void 0 === e.sel && t.scrollUp(!0, !0), Object.keys(e).sort().forEach(function(e) {
                    switch (e) {
                        case "sel":
                            a.q || (l = !0);
                            var d = a.sel ? Object(k.unUrlPeer)(a.sel) : 0,
                                f = s.back;
                            0 === d ? p.get().longpoll.push([m.resetPeer(!1, f)]) : d !== p.get().peer && p.get().longpoll.push([m.changePeer(d, a.msgid || !1)]);
                            break;
                        case "invite_chat_id":
                        case "invite_hash":
                            ! function(e) {
                                e.set(C.leaveInvitation)
                            }(p);
                            break;
                        case "tab":
                            Y(p, u, c), l = !0;
                            var g = a.tab || E.FOLDER_ALL;
                            p.get().longpoll.push([m.changeTab(g)]);
                            break;
                        case "act":
                            a.act && "create" === a.act ? Z(p, [], u, r, t, n, i) : function(e, t, n, r) {
                                n && n.hide(e, t)
                            }(p, [], u);
                            break;
                        case "st":
                            a.st && a.sel ? (curBox() && curBox().hide(), p.mutate(C.setInplaceSearch.bind(null, unescape(a.st), a.sel)), n.startSearch(p)) : (p.mutate(C.cancelSearch.bind(null, o.sel)), n.cancelSearch(p, !0));
                            break;
                        case "q":
                            a.q ? (curBox() && curBox().hide(), r.setSearch(p, a.q, !0)) : r.clearSearch(p);
                            break;
                        case "box":
                            U(p, a.box)
                    }
                }), Object(k.isClassicInterface)(p) && void 0 === e.sel && v.updateMenu(p), l && X(p, r, t), !1)
            },
            updateDialogFilters: function(e) {
                Object(w.isSearching)(e) || t.restoreDialogs(e), f.updateFilter(e)
            },
            removePeer: function(e, n) {
                t.removeDialog(e, n), t.saveScroll(e), e.get().peer === n && e.get().longpoll.push([m.resetPeer()]), Object(k.isClassicInterface)(e) && v.updateMenu(e)
            },
            newMessage: function(e) {
                Object(k.isClassicInterface)(e) || t.scrollUp(!0)
            },
            onEvents: function(e, o) {
                var d = function(e) {
                        for (var t = !1, n = e.length - 1; n >= 0; n--) e[n].type !== m.UNREAD_COUNT || t ? e[n].type === m.UNREAD_COUNT && e.splice(n, 1) : t = !0;
                        return e
                    }(o.filter(function(e) {
                        return e.type !== m.ADD_MESSAGE || !(e.flags & m.FLAG_STEALTH)
                    })),
                    p = o.filter(O.isServiceMsg),
                    h = o.filter(function(e) {
                        return e.type === m.ADD_MESSAGE
                    });
                G(p, e, t, n);
                var _ = Object(C.checkNewPeople)(p, h, e),
                    b = Promise.resolve();
                _.shouldLoad && (b = e.set(C.loadNewPeople.bind(null, _, a))), b.then(function() {
                    d.forEach(function(o) {
                        switch (o.type) {
                            case m.ADD_MESSAGE:
                                var a = Object(w.getTab)(e, o.peerId),
                                    d = !a || !a.msgs || 0 == a.msgs.length,
                                    p = Object(k.isDuplicate)(o, e.get()),
                                    h = Object(w.isCommunityBlocked)(e, o.peerId),
                                    _ = null;
                                if (o.kludges.keyboard) {
                                    var b = Object.assign(o.kludges.keyboard, {
                                        author_id: o.userId
                                    });
                                    _ = e.set(C.setKeyboard.bind(null, o.peerId, b))
                                } else {
                                    var y = Object(w.getKeyboard)(e, o.peerId);
                                    y && y.one_time && y.author_id !== Object(O.getAuthorId)(e, o) && (_ = e.set(C.deleteKeyboard.bind(null, o.peerId)))
                                }
                                if (o.peerId === Object(w.getPeer)(e) && _ && _.then(function() {
                                        return n.fixKeyboard()
                                    }), 0 === p) o.flags & m.FLAG_OUTBOUND || e.set(C.updateFavAndTitle.bind(null, o.peerId, !0)), e.set(C.addMessage.bind(null, o)), q(e, i),
                                    function(e, t) {
                                        var n = e.get().tabs[t.peerId],
                                            r = e.get().active_tab;
                                        return r === E.FOLDER_ALL || Object(C.filterFromTab)(r)(n)
                                    }(e, o) && (! function(e, t) {
                                        var n = t.flags & m.FLAG_OUTBOUND,
                                            r = inArray(t.peerId, e.get().mutedPeers),
                                            i = t.flags & m.FLAG_DELETED,
                                            o = e.get().gid;
                                        if (!n && !r && !i) {
                                            var a = function(e, t) {
                                                    return t < 2e9 && e && !e.match(/^\s*(Re(\(\d*\))?\:)?\s*\.\.\.\s*$/)
                                                }(t.subject, t.peerId) || "",
                                                s = (a ? a + " " : "") + t.text || "",
                                                c = t.userId,
                                                u = t.peerId,
                                                d = void 0,
                                                f = void 0,
                                                p = e.get().tabs[u];
                                            if (t.kludges && t.kludges.source_act && (s = stripHTML(Object(k.renderServiceMsg)(e, t, p, !1))), (!e.get().notify_msg && !Object(k.isChatPeer)(u) || o && !e.get().mute) && window.Notifier && Notifier.playSound({
                                                    author_id: u
                                                }), !Object(k.isChatPeer)(u)) return;
                                            s = trim(replaceEntities(stripHTML(s.replace(/<br>/g, "\n").replace(/<\*>.*$/, "")))), s = Object(l.replaceMentions)(s, function(e, t, n, r, i) {
                                                return i
                                            }), Object(k.isChatPeer)(u) ? (d = Object(T.oCacheGet)(e, c).name, p.tab && (d += " » " + p.tab), f = Object(T.oCacheGet)(e, c).photo) : (d = p.tab, f = p.photo);
                                            var g = t.attaches[0];
                                            if (g && "mail" === g.type) s += "\n[" + getLang("mail_added_msgs") + "]";
                                            else if (g) {
                                                var h = "doc" === g.type && "graffiti" === g.kind ? "graffiti" : g.type;
                                                s += "\n[" + getLang("mail_added_" + h) + "]"
                                            }
                                            d = trim(replaceEntities(stripHTML((d || "").replace("&nbsp;", " ")))), window.Notifier && Notifier.proxyIm({
                                                id: t.messageId,
                                                text: s,
                                                author_id: u,
                                                title: d,
                                                author_photo: f
                                            })
                                        }
                                    }(e, o), t.updateTyping(o.peerId, e), Object(w.isSearching)(e) ? t.updateDialog(o.peerId, e) : t.promoteDialog(e, o.peerId)), !1 === Object(w.isCommunityBlocked)(e, o.peerId) && !0 === h && n.updateActions(e), Object(k.isClassicInterface)(e) && (v.updateCounter(e, o.peerId), v.updateMenu(e)), n.updateTyping(o.peerId, e), n.addMessage(e, o), Object(k.isClassicInterface)(e) || f.updateFilter(e), V(o) || !Object(k.isFullyLoadedTab)(e, o.peerId) || o.local || e.set(C.loadMedia.bind(null, o)).then(function(e) {
                                        n.replaceAttachmentPlaceholders(e, o), Object(C.videoAutoPlayHandler)()
                                    });
                                else 2 === p ? (V(o) || e.set(C.loadMedia.bind(null, o)).then(function(e) {
                                    n.replaceAttachmentPlaceholders(e, o)
                                }), e.set(C.replaceMessage.bind(null, o)), n.replaceMessageAttrs(o, e), t.updateDialog(o.peerId, e)) : Object(w.isSearching)(e) || t.promoteDialog(e, o.peerId);
                                a && d && a.peerId === Object(w.getPeer)(e) && S();
                                break;
                            case m.EDIT_MESSAGE:
                            case m.REPLACE_MESSAGE:
                                e.set(C.editMessage.bind(null, o)).then(function(e) {
                                    t.updateDialog(o.peerId, e), n.updateTyping(o.peerId, e), n.editMessage(e, o), V(o) || !Object(k.isFullyLoadedTab)(e, o.peerId) || o.local || e.set(C.loadMedia.bind(null, o)).then(function(e) {
                                        n.replaceAttachmentPlaceholders(e, o)
                                    })
                                });
                                break;
                            case m.READ_INBOUND:
                                e.set(C.markInboundMessagesAsRead.bind(null, o)).then(function(e) {
                                    t.updateCounter(e, o.peerId), n.updateGoToEnd(e, !0), Object(k.isClassicInterface)(e) && v.updateCounter(e, o.peerId), Object(w.isSearching)(e) || t.restoreDialogs(e), f.updateFilter(e)
                                });
                                break;
                            case m.READ_OUTBOUND:
                                e.set(C.markOutboundMessagesAsRead.bind(null, o)).then(function(e) {
                                    t.updateCounter(e, o.peerId), n.markMessagesAsRead(e, o)
                                });
                                break;
                            case m.UNREAD_COUNT:
                                e.set(C.updateUnreadCount.bind(null, o.count)).then(function() {
                                    var t = e.get().gid ? "l_mgid" + e.get().gid : "msg";
                                    handlePageCount(t, o.count), f.updateFilter(e), Object(k.isClassicInterface)(e) && z(e, i)
                                });
                                break;
                            case m.GOT_ONLINE:
                            case m.GOT_OFFLINE:
                                var j = o.type === m.GOT_ONLINE;
                                e.set(C.updateOnline.bind(null, o.userId, !!j && o.platform, o.lastSeenTs)).then(function(e) {
                                    Object(k.isTabLoaded)(e.get(), o.userId) && (t.updateOnline(o.userId, e), n.updateOnline(o.userId, e))
                                });
                                break;
                            case m.SET_FLAGS:
                            case m.RESET_FLAGS:
                                if (o.flags & m.FLAG_DELETED && o.type === m.SET_FLAGS && !Object(k.isAlreadyDeleted)(e, o.peerId, o.messageId) && !e.get().blockedFlagUpdates[o.peerId] && s(o), o.flags === m.FLAG_IMPORTANT) {
                                    var I = o.type === m.SET_FLAGS;
                                    e.set(C.updateImportant.bind(null, I ? 1 : -1, o.messageId)).then(function() {
                                        Object(k.isClassicInterface)(e) || r.updateImportantCnt(e)
                                    }), e.set(C.updateFavMessage.bind(null, [o.messageId], o.peerId, I)).then(function(t) {
                                        n.markImportant(o.messageId, I, e)
                                    })
                                }
                                break;
                            case m.TYPING:
                                Object(k.isSelfMessage)(o.peerId, e.get().gid) || (e.set(C.setTyping.bind(null, o)).then(function(e) {
                                    Object(k.isTabLoaded)(e.get(), o.peerId) && (n.updateTyping(o.peerId, e), t.updateTyping(o.peerId, e))
                                }), e.set(C.waitTyping.bind(null, o.peerId)).then(function(e) {
                                    Object(k.isTabLoaded)(e.get(), o.peerId) && (n.updateTyping(o.peerId, e), t.updateTyping(o.peerId, e))
                                }));
                                break;
                            case m.NOTIFY_SETTINGS_CHANGED:
                                ! function(e, t, n, r) {
                                    e.set(C.setMutedPeer.bind(null, n, r)).then(t().updateState.bind(null, n))
                                }(e, c, o.peerId, 0 !== o.disabledUntil);
                                break;
                            case m.RESYNC:
                                e.get().longpoll.pause(), e.set(C.resync).then(c().resync).then(function() {
                                    return e.get().longpoll.resume()
                                });
                                break;
                            case m.TRANSITION:
                                g.transition(o.state);
                                break;
                            case m.RESET_PEER:
                                if (o.removeActivePeer) {
                                    var M = e.get().tabbedPeers.filter(function(t) {
                                        var n = t.peer,
                                            r = t.type;
                                        return n !== e.get().peer && "perm" === r
                                    });
                                    e.setState({
                                        tabbedPeers: M
                                    })
                                }! function(e, t, n, r) {
                                    e.set(C.cancelRecording).then(function() {
                                        n.cancelRecording()
                                    }), AudioMessagePlayer.detachPlayer(), t.removeSelection(e), removeClass(r, "im-page_history-show"), n.stopLoading(), Object(w.isAnyMessageBeingEdited)(e) && n.cancelEditing();
                                    var i = e.get().peer;
                                    e.set(C.changePeer.bind(null, 0, !1, !1)).then(function() {
                                        window.tooltips && window.tooltips.hideAll(), Q(), Object(k.isClassicInterface)(e) && t.activate(), n.changePeer(e), Object(k.isClassicInterface)(e) && t.restoreScroll(e), setTimeout(function() {
                                            e.get().longpoll.push([m.transitionEvent("search")])
                                        }, 13), Object(k.isLocksAvailable)(e) && Object(k.isPeerBlockedByMe)(i, e) && e.set(C.releaseBlock.bind(null, i))
                                    })
                                }(e, t, n, i), o.cancelSearch && X(e, r, t), Object(k.isClassicInterface)(e) && v.updateMenu(e), r.focusInput(e);
                                break;
                            case m.CHANGE_TAB:
                                Object(k.changeTab)(o.tab, e, c, C.changeDialogsTab).then(function(e) {
                                    f.updateFilter(e)
                                });
                                break;
                            case m.RESET_DIRECTORIES:
                            case m.SET_DIRECTORIES:
                            case m.REPLACE_DIRECTORIES:
                                if (o.mask === m.FOLDER_HAS_BANNER) break;
                                e.set(C.updateFolderState.bind(null, o.peerId, o.mask, o.type, o.local)).then(function(e) {
                                    Object(w.isSearching)(e) || o.type === m.RESET_DIRECTORIES && o.mask === m.FOLDER_IMPORTANT || o.type === m.REPLACE_DIRECTORIES || t.restoreDialogs(e), t.updateDialog(o.peerId, e), z(e, i), e.get().peer === o.peerId && n.changedMessageSelection(e)
                                });
                                break;
                            case m.DELETE_DIALOG:
                                e.set(C.deletedDialog.bind(null, o.peerId, Promise.resolve([]))).then(function() {
                                    c().removePeer(e, o.peerId), c().updateDialogFilters(e)
                                });
                                break;
                            case m.CHANGE_PEER:
                                $(e, o, t, n, r, i, v, u, c);
                                break;
                            case m.MUTEX:
                                var L = x({}, o.peerId, o),
                                    A = Object(k.isPeerBlocked)(o.peerId, e);
                                e.set(C.updateBlockStates.bind(null, L)).then(function() {
                                    t.updateDialog(o.peerId, e);
                                    var r = Object(k.isPeerBlocked)(o.peerId, e);
                                    Object(k.isFullyLoadedTab)(e.get(), o.peerId) && A !== r && n.updateChat(e, o.peerId)
                                });
                                break;
                            case m.FAILED_MESSAGE:
                                e.set(C.setMessageErrored.bind(null, o.peer, o.message)).then(function() {
                                    n.setMessageErrored(o.peer, o.message, o.error, e), t.setDialogFailed(o.peer, o.message.messageId, e)
                                });
                                break;
                            case m.RESEND:
                                var N = o.message.messageId;
                                e.set(C.resendMessage.bind(null, o.peerId, N, o.message)).then(function() {
                                    n.resendMessage(o.peerId, N), t.promoteDialog(e, o.peerId)
                                });
                                break;
                            case m.CONVERSATION_UPDATED:
                                if (Object(k.isTabLoaded)(e.get(), o.peerId)) Object(P.handleEventChatUpdated)(e, o.peerId, o.updateType, o.updateArg, n, t) || c().reloadChatInfo(o.peerId)
                        }
                    })
                })
            },
            updateHistory: function(e) {
                return n.updateHistory(e)
            },
            reloadChatInfo: function(e) {
                Object(k.isTabLoaded)(p.get(), e) && p.set(C.loadChatInfo.bind(null, e)).then(function() {
                    return function(e, t, n, r, i) {
                        r.updateChatTopic(t, e), Object(k.isClassicInterface)(e) && i.updateName(t, e), e.get().peer == t && (Object(C.setActions)(e.get()), r.updateActions(e))
                    }(p, e, 0, n, v)
                })
            },
            cancelRecording: function() {
                return p.set(C.cancelRecording).then(function() {
                    return n.cancelRecording()
                })
            },
            fixHeight: function() {
                S()
            },
            unmount: function() {
                Object(d.destroyModule)(e), clearInterval(p.get().update_title_to), o.stop(), I(), t.unmount();
                var i = window.devicePixelRatio >= 2 ? "_2x" : "";
                setFavIcon("/images/icons/favicons/fav_logo" + i + ".ico"), n.unmount(), r.unmount(), cancelStackFilter("im_peer"), f.unmount(), u && u.unmount(), v && v.unmount(), b && b(), h && h(), Object(k.isLocksAvailable)(p) && p.get().peer && p.set(C.releaseBlock.bind(null, p.get().peer)), y.unmount(), v && v.unmount(), j.unmount(), clearInterval(_), cur.imDb.unmount(), cur.imDb = !1
            }
        }
    }

    function ee(e, t) {
        var n = ge("page_header"),
            r = geByClass1("_im_page_history", e),
            i = window.clientHeight() - n.offsetHeight - L - 2,
            o = Object(k.isClassicInterface)(t) ? N : A,
            a = {
                page: Math.max(i, o)
            };
        if (Object(k.isClassicInterface)(t)) {
            var s = Object(k.getClassicChatHeight)();
            s = s > 0 ? Math.min(s - n.offsetHeight - L - 2, i) : i;
            var c = hasClass(r, "im-page--history_empty-hist") ? s : i;
            a.history = Math.max(s, o), a.chat = Math.max(c, o)
        }
        return a
    }

    function te(e, t, n, r, i) {
        var o = !(arguments.length > 5 && void 0 !== arguments[5]) || arguments[5],
            a = arguments.length > 6 && void 0 !== arguments[6] && arguments[6];
        if (!isFullScreen()) {
            var s = ee(e, t);
            if (setStyle(e, {
                    minHeight: s.page
                }), Object(k.isClassicInterface)(t) && (void 0 === t.get().chatResizeInitialized && t.set(C.initializeChatResize), setStyle(e, {
                    height: t.get().isCreating ? s.page : "auto"
                }), setStyle(geByClass1("_im_page_dialogs", e), {
                    minHeight: s.page,
                    position: "static",
                    top: 0
                }), setStyle(geByClass1("_im_page_history", e), {
                    minHeight: s.history,
                    position: "relative",
                    top: 0
                }), setStyle(geByClass1("_im_chat_body_abs", e), {
                    minHeight: s.chat,
                    height: s.chat,
                    position: "relative",
                    top: 0
                })), browser.safari && a && "function" == typeof a && a(), r && r.updateScroll(), i && i.updateScroll(), n) {
                var c = n.updateScroll();
                n.scrollFix(t, t.get().peer, c)
            }
            o && setTimeout(function() {
                return te(e, t, n, r, i, !1)
            }, 100)
        }
    }

    function ne() {
        ! function(e) {
            var t = "safari-repaint";
            e.forEach(function(e) {
                hasClass(e, t) && removeClass(e, t), addClass(e, t)
            }), setTimeout(function() {
                e.forEach(function(e) {
                    removeClass(e, t)
                })
            }, 100)
        }([geByClass1("_im_dialog_actions"), geByClass1("_im_chat_input_w"), ge("side_bar"), geByClass1("_im_right_menu"), geByClass1("_im_dialogs_settings"), geByClass1("_im_dialogs_search")])
    }

    function re(e, t) {
        var n = t.get(),
            l = void 0,
            h = window.devicePixelRatio >= 2 ? "_2x" : "";
        setFavIcon("/images/icons/favicons/fav_im" + h + ".ico"), te(e, t, !1, !1, !1, !0), show(e);
        var O = Object(d.createMutations)(J),
            E = O.callMutations,
            j = O.bindMutations,
            T = n.useFcLongpoll && vk.lpConfig.enabled && Notifier.getLpInstance && Notifier.getLpInstance(),
            P = T ? Notifier.getLpInstance() : t.get().gid ? Object(p.startLongPollForGroup)(n.lpConfig) : Object(p.startLongPoll)(n);

        function L() {
            for (var e = arguments.length, n = Array(e), r = 0; r < e; r++) n[r] = arguments[r];
            E().onEvents(t, n)
        }
        P.onData(L), T && Object(I.imWeirdLog)("im_use_fc_longpoll", {}, !1);
        var A = geByClass1("_im_dialogs_search", e),
            N = geByClass1("_im_dialogs_settings", e),
            D = Object(r.mount)(geByClass1("_im_page_dcontent", e), t, E),
            R = Object(i.mount)(geByClass1("_im_page_history", e), t, E),
            F = Object(o.mount)(A, t, E),
            B = Object(a.mount)(N, t, E),
            H = Object(v.mount)(t);
        cur.imDb = Object(b.mount)(t.get().gid ? -t.get().gid : vk.id), t.set(C.preloadSearchIndex.bind(null, cur.imDb)), Object(k.isClassicInterface)(t) && B.updateSettings(t);
        var z = void 0,
            G = void 0;
        if (Object(k.isClassicInterface)(t)) {
            var V = geByClass1("_im_ui_peers_list", e.parentNode);
            z = Object(_.mount)(V, t, E), G = function(e, t, n, r) {
                if (browser.mobile) return !1;
                var i = [t, n, geByClass1("_im_chat_input_w", r), geByClass1("_im_dialog_actions", r)],
                    o = null,
                    a = hasClass(e, "im-page--header_static"),
                    s = ge("im-group-online-disabled-notice");

                function c() {
                    var t = Object(u.getNativeOption)("scrollLeft"),
                        n = hasClass(e, "im-page--header_static"),
                        r = [];
                    o !== t ? r = i.slice().concat([e]) : n !== a && (r = [e]), o = t, a = n, r.length > 0 && r.forEach(function(r) {
                        var i = e === r && n ? 0 : -t;
                        setStyle(r, x({}, cssTransformProp, 0 === i ? "unset" : "translateX(" + i + "px)"))
                    })
                }
                return s && i.push(s), i = i.concat(geByClass("_im_aside_notice"), geByClass("_im_aside_promo_block")), addEvent(window, "scroll", c), c(),
                    function() {
                        removeEvent(window, "scroll", c)
                    }
            }(A, N, geByClass1("_im_right_menu", e.parentNode), e)
        }
        Object(k.isClassicInterface)(t) && n.peer && D.deactivate(), n.gid || (l = Object(s.mount)(geByClass1("_im_dialogs_creation", e), t, E));
        var K = n.isCreating,
            q = K ? "create" : 0 === n.peer ? "search" : "default";
        K && l.show(t, []);
        var Q = Object(f.create)(t, q, D, R, F, l),
            $ = Object(S.mount)(t, Q);
        R.updateScroll();
        var Y = function(e, t, n, r) {
            var i = t.get();
            Object(k.isReservedPeer)(i.peer) || e().onUserActions(t, r), i.update_old_title && t.set(C.updateFavAndTitle.bind(null, !1, !1))
        }.bind(null, E, t, Q);
        Object(k.isReservedPeer)(n.peer) || setTimeout(function() {
            return W(t, R)
        }, 10);
        var X = new IdleManager({
                id: "im",
                element: document,
                focusElement: window,
                triggerEvents: "mouseover mousedown keypress"
            }),
            Z = debounce(ne, 300),
            ee = te.bind(null, e, t, R, D, l, !1, Z);
        t.setState({
            longpoll: P
        }), t.set(C.setExecStack.bind(null, [])), X.on("unidle", function() {
            P.abortWaiting(), Y()
        }), X.start(), nav.objLoc.box && (U(t, nav.objLoc.box), Object(c.updateLocation)({
            box: null
        }));
        var re = function(e) {
                var t = e.get();
                return Object(k.isLocksAvailable)(e) ? Object(g.createWorker)(t.mutex_key, function(e) {
                    t.longpoll.push([m.mutexEvent(e)])
                }, function(e, n) {
                    return Object(C.getMutexQueue)(t.gid).then(function(e) {
                        return M(e, 1)[0]
                    })
                }).stop : null
            }(t),
            ie = void 0;
        Object(k.isLocksAvailable)(t) && (ie = setInterval(k.blockLatencyCompensation.bind(null, t, n.longpoll), 2e3)), t.get().invitation && Object(k.showInvitationBox)(t, t.get().invitation, C.leaveInvitation);
        var oe = Object(y.throttleAccumulate)(function(e, t, n, r, i) {
                var o = i.reduce(function(e, t) {
                    return e[t.peerId] || (e[t.peerId] = []), e[t.peerId].push(t.messageId), e
                }, {});
                Object.keys(o).forEach(function(i) {
                    var a = o[i];
                    e.set(C.removeMessages.bind(null, a, i)).then(function() {
                        return e.set(C.removeMessagesMarkDeleted.bind(null, a, i))
                    }).then(function() {
                        return t.removeMessages(a, +i, e)
                    }).then(function() {
                        var o = Object(w.getTab)(e, i);
                        o && a.some(function(e) {
                            return e >= o.lastmsg
                        }) && Object(C.loadActualLastMessage)(e, i).then(function() {
                            n.promoteDialog(e, i), r.updateCounter(e, i), t.updateGoToEnd(e, !0)
                        })
                    })
                })
            }.bind(null, t, R, D, z), 200),
            ae = k.hideTopNotice.bind(null, t),
            se = k.hideAsideNotice.bind(null, t);
        return j(Object(d.createModule)({
            handlers: function(t, n) {
                t(document, "mousemove mousedown keypress", Y), t(window, "resize", ee), n(e, "click", k.HIDE_TOP_NOTICE_CLASS, ae), n(gpeByClass("_im-page-wrap", e), "click", k.HIDE_ASIDE_NOTICE_CLASS, se), n(gpeByClass("_im-page-wrap", e), "click", k.HIDE_ASIDE_PROMO_BLOCK_CLASS, k.hideAsidePromoBlock), n(gpeByClass("_im-page-wrap", e), "click", k.INSTALL_VKADMIN_LINK, k.installVKAdminApp), browser.safari && t(document, "visibilitychange", ne)
            }
        }), D, R, F, e, X, P, oe, E, l, B, t, Q, re, ie, z, G, H, $, ee, function() {
            T ? P.offData(L) : P.stop()
        })
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createLongPoll", function() {
        return y
    });
    var r = n(30),
        i = n(70),
        o = n(18),
        a = n(143),
        s = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        c = window.statlogsValueEvent,
        u = 202,
        l = 5,
        d = 4,
        f = 3e4,
        p = {},
        m = Date.now();

    function g(e, t) {
        if (t && t.status && e.lpstat) {
            var n = Math.floor(t.status / 100);
            t.status >= 500 && t.status < 600 && c("fc_longpoll", 1, n + "0x", t.getResponseHeader("x-frontend")), p[n] = n in p ? p[n] + 1 : 1, Date.now() - m >= f && (Object.keys(p).forEach(function(e) {
                c("fc_longpoll", p[e], e + "0x", t.getResponseHeader("x-frontend"))
            }), p = {}, m = Date.now())
        }
    }

    function h(e, t) {
        e.waitAbortFns.push(t)
    }

    function _(e, t) {
        var n = t.failed ? Object(r.abortablePause)(d, null) : {},
            o = n.abort,
            c = n.pause;
        switch (t.failed) {
            case 1:
                return Object(a.lpLogFc)("red", "LP failed: old timestamp; resync, next ts", t.ts), e.onResult({
                    ts: t.ts,
                    updates: [
                        [-1]
                    ]
                }), h(e, o), c().then(function() {
                    return v(e)
                });
            case 2:
                return Object(a.lpLogFc)("red", "LP failed: key is incorrect; refresh key"), h(e, o),
                    function(e) {
                        return Object(i.post)(i.CONTROLLER, {
                            act: "a_get_key",
                            uid: e.id,
                            gid: e.id < 0 ? -e.id : 0
                        })
                    }(e).then(function(t) {
                        var n = s(t, 4),
                            r = n[0],
                            i = n[1],
                            o = n[2],
                            a = n[3];
                        return e.onResult({
                            ts: +a,
                            updates: [
                                [-2, r, i + "/" + o],
                                [-1]
                            ]
                        })
                    }).then(c).then(function() {
                        return v(e)
                    });
            case 3:
                throw window.nav.reload({
                    force: !0
                }), new Error("ts is very wrong");
            default:
                return t
        }
    }

    function v(e) {
        if (e.isStoppedFn()) return Promise.resolve({
            ts: 0,
            updates: []
        });
        var t = Object(i.plaingetCancelable)(e.url, {
                act: "a_check",
                key: e.key,
                version: e.version,
                ts: e.ts,
                wait: 25,
                mode: e.mode
            }),
            n = t.request,
            r = t.cancel;
        return e.stopFn = r, n.then(function(t) {
            var n = s(t, 2),
                r = n[0],
                i = n[1];
            return g(e, i), e.waitTimeout = 2, JSON.parse(r)
        }).catch(function(t) {
            var n = s(t, 2),
                r = n[0],
                i = n[1];
            throw g(e, i), r
        }).then(function(t) {
            return _(e, t)
        })
    }

    function b(e) {
        e.isStoppedFn() || v(e).then(e.onResult).catch(function(t) {
            return function(e, t) {
                if (e.isStoppedFn()) return;
                window.topError(t), Object(a.lpLogFc)("red", "LP error", t.message || "no message (probably browser reset)"), e.waitTimeout = Math.min(64, 2 * e.waitTimeout);
                var n = Object(r.abortablePause)(e.waitTimeout, null),
                    i = n.abort,
                    o = n.pause;
                return h(e, i), o()
            }(e, t)
        }).then(function() {
            return b(e)
        })
    }

    function y(e, t) {
        var n = !!e.stopped,
            r = {
                id: e.id,
                key: e.key,
                ts: e.ts,
                url: e.url,
                lpstat: e.lpstat || 0,
                version: l,
                mode: u,
                waitTimeout: 2,
                waitAbortFns: [],
                isStoppedFn: function() {
                    return n
                },
                onResult: function(e) {
                    e.ts && i(r.ts, e.ts, e.updates.map(function(e) {
                        switch (e[0]) {
                            case 0:
                                return o.deleteEvent(e);
                            case 1:
                                return o.replaceFlagsEvent(e);
                            case 2:
                                return o.setFlagsEvent(e);
                            case 3:
                                return o.resetFlagsEvent(e);
                            case 4:
                                return o.addMessageEvent(e);
                            case 5:
                                return o.editMessageEvent(e);
                            case 6:
                                return o.readInboundEvent(e);
                            case 7:
                                return o.readOutboundEvent(e);
                            case 8:
                                return o.gotOnlineEvent(e);
                            case 9:
                                return o.gotOfflineEvent(e);
                            case 10:
                                return o.resetDirectoriesEvent(e);
                            case 11:
                                return o.replaceDirectoriesEvent(e);
                            case 12:
                                return o.setDirectoriesEvent(e);
                            case 13:
                                return o.deleteDialogEvent(e);
                            case 18:
                                return o.replaceMessageEvent(e);
                            case 51:
                                return o.chatChangedEvent(e);
                            case 52:
                                return o.chatUpdatedEvent(e);
                            case 63:
                                return o.typingEvent(e);
                            case 70:
                                return o.videoCallEvent(e);
                            case 80:
                                return o.unreadCountEvent(e);
                            case 114:
                                return o.notifySettingsChangedEvent(e);
                            case 116:
                                return o.refreshMessageEvent(e);
                            case -1:
                                return o.resyncEvent();
                            case -2:
                                return o.refreshLpKeyEvent(e);
                            default:
                                return o.emptyEvent(e)
                        }
                    }))
                }
            };

        function i(e, n, i) {
            r.ts = n;
            for (var a = 0; a < i.length; ++a) i[a].type === o.REFRESH_LP_KEY && (r.key = i[a].key, r.url = i[a].url);
            t(e, n, i)
        }
        var a = {
            options: r,
            isStopped: function() {
                return n
            },
            stopConnection: function() {
                n = !0, r.stopFn && r.stopFn(), r.stopFn = void 0, this.abortWaiting()
            },
            reinitConnection: function() {
                this.stopConnection(), n = !1, b(r)
            },
            abortWaiting: function() {
                r.waitAbortFns.forEach(function(e) {
                    return e()
                }), r.waitAbortFns = [], r.waitTimeout = 2
            },
            onLp: i
        };
        return b(r), a
    }
}, function(e, t, n) {
    "use strict";
    var r = n(73),
        i = n(29),
        o = n(107),
        a = n(22);
    e.exports = n(23)(Array, "Array", function(e, t) {
        this._t = a(e), this._i = 0, this._k = t
    }, function() {
        var e = this._t,
            t = this._k,
            n = this._i++;
        return !e || n >= e.length ? (this._t = void 0, i(1)) : i(0, "keys" == t ? n : "values" == t ? e[n] : [n, e[n]])
    }, "values"), o.Arguments = o.Array, r("keys"), r("values"), r("entries")
}, function(e, t, n) {
    var r = n(51)("meta"),
        i = n(35),
        o = n(155),
        a = n(124).f,
        s = 0,
        c = Object.isExtensible || function() {
            return !0
        },
        u = !n(145)(function() {
            return c(Object.preventExtensions({}))
        }),
        l = function(e) {
            a(e, r, {
                value: {
                    i: "O" + ++s,
                    w: {}
                }
            })
        },
        d = e.exports = {
            KEY: r,
            NEED: !1,
            fastKey: function(e, t) {
                if (!i(e)) return "symbol" == typeof e ? e : ("string" == typeof e ? "S" : "P") + e;
                if (!o(e, r)) {
                    if (!c(e)) return "F";
                    if (!t) return "E";
                    l(e)
                }
                return e[r].i
            },
            getWeak: function(e, t) {
                if (!o(e, r)) {
                    if (!c(e)) return !0;
                    if (!t) return !1;
                    l(e)
                }
                return e[r].w
            },
            onFreeze: function(e) {
                return u && d.NEED && c(e) && !o(e, r) && l(e), e
            }
        }
}, function(e, t, n) {
    "use strict";
    var r = n(214)(!0);
    n(23)(String, "String", function(e) {
        this._t = String(e), this._i = 0
    }, function() {
        var e, t = this._t,
            n = this._i;
        return n >= t.length ? {
            value: void 0,
            done: !0
        } : (e = r(t, n), this._i += e.length, {
            value: e,
            done: !1
        })
    })
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "VIDEO_UPLOAD_EXTS", function() {
        return r
    }), n.d(t, "VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB", function() {
        return i
    }), n.d(t, "VIDEO_UPLOAD_CHUNK_SIZE", function() {
        return o
    });
    var r = "avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf".split(" "),
        i = 5,
        o = 4194304
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "DELETE", function() {
        return a
    }), n.d(t, "SET_FLAGS", function() {
        return s
    }), n.d(t, "REPLACE_FLAGS", function() {
        return c
    }), n.d(t, "RESET_FLAGS", function() {
        return u
    }), n.d(t, "ADD_MESSAGE", function() {
        return l
    }), n.d(t, "READ_INBOUND", function() {
        return d
    }), n.d(t, "READ_OUTBOUND", function() {
        return f
    }), n.d(t, "GOT_ONLINE", function() {
        return p
    }), n.d(t, "GOT_OFFLINE", function() {
        return m
    }), n.d(t, "CHAT_CHANGED", function() {
        return g
    }), n.d(t, "CONVERSATION_UPDATED", function() {
        return h
    }), n.d(t, "TYPING", function() {
        return _
    }), n.d(t, "VIDEO_CALL", function() {
        return v
    }), n.d(t, "UNREAD_COUNT", function() {
        return b
    }), n.d(t, "NOTIFY_SETTINGS_CHANGED", function() {
        return y
    }), n.d(t, "EMPTY", function() {
        return w
    }), n.d(t, "RESET_DIRECTORIES", function() {
        return O
    }), n.d(t, "REPLACE_DIRECTORIES", function() {
        return C
    }), n.d(t, "SET_DIRECTORIES", function() {
        return k
    }), n.d(t, "RESYNC", function() {
        return E
    }), n.d(t, "REFRESH_LP_KEY", function() {
        return j
    }), n.d(t, "TRANSITION", function() {
        return S
    }), n.d(t, "RESET_PEER", function() {
        return T
    }), n.d(t, "MUTEX", function() {
        return I
    }), n.d(t, "CHANGE_PEER", function() {
        return P
    }), n.d(t, "CHANGE_TAB", function() {
        return M
    }), n.d(t, "FAILED_MESSAGE", function() {
        return x
    }), n.d(t, "RESEND", function() {
        return L
    }), n.d(t, "DELETE_DIALOG", function() {
        return A
    }), n.d(t, "EDIT_MESSAGE", function() {
        return N
    }), n.d(t, "REPLACE_MESSAGE", function() {
        return D
    }), n.d(t, "FLAG_UNREAD", function() {
        return R
    }), n.d(t, "FLAG_OUTBOUND", function() {
        return F
    }), n.d(t, "FLAG_IMPORTANT", function() {
        return B
    }), n.d(t, "FLAG_CHAT", function() {
        return H
    }), n.d(t, "FLAG_FRIENDS", function() {
        return U
    }), n.d(t, "FLAG_SPAM", function() {
        return z
    }), n.d(t, "FLAG_DELETED", function() {
        return G
    }), n.d(t, "FLAG_MEDIA", function() {
        return W
    }), n.d(t, "FLAG_STEALTH", function() {
        return V
    }), n.d(t, "FOLDER_IMPORTANT", function() {
        return K
    }), n.d(t, "FOLDER_UNRESPOND", function() {
        return q
    }), n.d(t, "FOLDER_HAS_BANNER", function() {
        return Q
    }), n.d(t, "deleteEvent", function() {
        return $
    }), n.d(t, "replaceFlagsEvent", function() {
        return Y
    }), n.d(t, "setFlagsEvent", function() {
        return X
    }), n.d(t, "resetFlagsEvent", function() {
        return Z
    }), n.d(t, "addMessageEvent", function() {
        return J
    }), n.d(t, "editMessageEvent", function() {
        return ee
    }), n.d(t, "replaceMessageEvent", function() {
        return te
    }), n.d(t, "editMessageLocallyEvent", function() {
        return ne
    }), n.d(t, "readInboundEvent", function() {
        return re
    }), n.d(t, "readOutboundEvent", function() {
        return ie
    }), n.d(t, "gotOnlineEvent", function() {
        return oe
    }), n.d(t, "gotOfflineEvent", function() {
        return ae
    }), n.d(t, "resetDirectoriesEvent", function() {
        return se
    }), n.d(t, "replaceDirectoriesEvent", function() {
        return ce
    }), n.d(t, "setDirectoriesEvent", function() {
        return ue
    }), n.d(t, "deleteDialogEvent", function() {
        return le
    }), n.d(t, "chatChangedEvent", function() {
        return de
    }), n.d(t, "chatUpdatedEvent", function() {
        return fe
    }), n.d(t, "typingEvent", function() {
        return pe
    }), n.d(t, "videoCallEvent", function() {
        return me
    }), n.d(t, "unreadCountEvent", function() {
        return ge
    }), n.d(t, "notifySettingsChangedEvent", function() {
        return he
    }), n.d(t, "refreshMessageEvent", function() {
        return _e
    }), n.d(t, "emptyEvent", function() {
        return ve
    }), n.d(t, "transitionEvent", function() {
        return be
    }), n.d(t, "resyncEvent", function() {
        return ye
    }), n.d(t, "refreshLpKeyEvent", function() {
        return we
    }), n.d(t, "resetPeer", function() {
        return Oe
    }), n.d(t, "changePeer", function() {
        return Ce
    }), n.d(t, "changeTab", function() {
        return ke
    }), n.d(t, "failedMessage", function() {
        return Ee
    }), n.d(t, "mutexEvent", function() {
        return je
    }), n.d(t, "resendEvent", function() {
        return Se
    });
    var r = n(54),
        i = n(118),
        o = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        a = "event_delete",
        s = "event_set_flags",
        c = "event_replace_flags",
        u = "event_reset_flags",
        l = "event_add_message",
        d = "event_read_inbound",
        f = "event_read_outbound",
        p = "event_got_online",
        m = "event_got_offline",
        g = "event_chat_changed",
        h = "event_chat_updated",
        _ = "event_typing",
        v = "event_video_call",
        b = "event_unread_count",
        y = "event_notify_settings_changed",
        w = "event_empty",
        O = "event_reset_directories",
        C = "event_replace_directories",
        k = "event_set_directories",
        E = "event_resync",
        j = "event_refresh_lp_key",
        S = "transition_event",
        T = "reset_peer",
        I = "mutex",
        P = "change_peer",
        M = "event_change_tab",
        x = "event_failed_message",
        L = "event_resend",
        A = "event_delete_dialog",
        N = "event_edit_message",
        D = "event_replace_message",
        R = 1,
        F = 2,
        B = 8,
        H = 16,
        U = 32,
        z = 64,
        G = 128,
        W = 512,
        V = 65536,
        K = 1,
        q = 2,
        Q = 8;

    function $(e) {
        var t = o(e, 2)[1];
        return {
            type: a,
            localId: t
        }
    }

    function Y(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: c,
            messageId: n,
            mask: r,
            peerId: i
        }
    }

    function X(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: s,
            messageId: n,
            flags: r,
            peerId: i
        }
    }

    function Z(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: u,
            messageId: n,
            flags: r,
            peerId: i
        }
    }

    function J(e) {
        var t = o(e, 11),
            n = t[1],
            a = t[2],
            s = t[3],
            c = t[4],
            u = t[5],
            d = t[6],
            f = t[7],
            p = t[8],
            m = t[9],
            g = t[10],
            h = extend(d, f || void 0);
        return {
            type: l,
            messageId: intval(n),
            flags: intval(a),
            peerId: intval(s),
            date: intval(c),
            attaches: Object(i.convertKludgesToAttaches)(h, n),
            subject: d.title || "",
            text: u,
            kludges: h,
            randomId: intval(p),
            userId: Object(r.isChatPeer)(s) ? intval(h.from) : intval(s),
            update_time: g,
            chat_local_id: m
        }
    }

    function ee(e) {
        var t = J(e);
        return t.type = N, t
    }

    function te(e) {
        var t = J(e);
        return t.type = D, t
    }

    function ne(e) {
        return extend({}, e, {
            type: N
        })
    }

    function re(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: d,
            peerId: n,
            upToId: r,
            unread: i
        }
    }

    function ie(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: f,
            peerId: n,
            upToId: r,
            unread: i
        }
    }

    function oe(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: p,
            userId: -n,
            platform: r,
            lastSeenTs: i
        }
    }

    function ae(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: m,
            userId: -n,
            reason: r,
            lastSeenTs: i
        }
    }

    function se(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: O,
            peerId: n,
            mask: r,
            local: void 0 !== i && i
        }
    }

    function ce(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: C,
            peerId: n,
            mask: r
        }
    }

    function ue(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: k,
            peerId: n,
            mask: r,
            local: void 0 !== i && i
        }
    }

    function le(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: A,
            peerId: n,
            localId: r
        }
    }

    function de(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: g,
            chatId: n,
            self: r
        }
    }

    function fe(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: h,
            peerId: r,
            updateType: n,
            updateArg: i
        }
    }

    function pe(e) {
        var t = o(e, 5),
            n = t[1],
            r = t[2],
            i = t[3],
            a = t[4];
        return {
            type: _,
            peerId: n,
            userIds: r,
            totalCount: i,
            ts: a
        }
    }

    function me(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: v,
            userId: n,
            callId: r
        }
    }

    function ge(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: b,
            count: n,
            countNotMuted: r,
            showOnlyNotMuted: i
        }
    }

    function he(e) {
        var t = o(e, 2)[1],
            n = void 0 === t ? {} : t;
        return {
            type: y,
            peerId: n.peer_id,
            sound: n.sound,
            disabledUntil: n.disabled_until
        }
    }

    function _e(e) {
        var t = o(e, 2)[1],
            n = void 0 === t ? {} : t,
            r = J([!1, n.id, n.flags, n.peer_id, n.date, n.message, extend(n.kludges, {
                title: n.title || ""
            }), {}, n.random_id, n.chat_local_id, n.update_time]);
        return r.type = N, r
    }

    function ve(e) {
        return {
            type: w,
            params: e
        }
    }

    function be(e) {
        return {
            type: S,
            state: e
        }
    }

    function ye() {
        return {
            type: E
        }
    }

    function we(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: j,
            key: n,
            url: r
        }
    }

    function Oe() {
        var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
            t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
        return {
            type: T,
            cancelSearch: e,
            removeActivePeer: t
        }
    }

    function Ce(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
            n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
            r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
            i = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : "";
        return {
            type: P,
            peerId: e,
            msgid: t,
            forward: n,
            cancelSearch: r,
            entryPoint: i
        }
    }

    function ke(e) {
        return {
            type: M,
            tab: e
        }
    }

    function Ee(e, t, n) {
        return {
            type: x,
            message: t,
            peer: e,
            error: n
        }
    }

    function je(e) {
        var t = o(e, 6),
            n = (t[0], t[1]),
            r = t[2],
            i = t[3],
            a = t[4],
            s = t[5];
        return {
            type: I,
            free: !!intval(n) || intval(a) === vk.id,
            resource: r,
            peerId: intval(i),
            who: intval(a),
            name: s
        }
    }

    function Se(e, t) {
        return {
            type: L,
            message: t,
            peerId: e
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(65),
        o = (n(195), n(151)),
        a = n(182);
    var s = window.elfocus,
        c = {
            height: "auto"
        },
        u = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onChange = function(e) {
                    r.props.onChange ? r.props.onChange(e) : r.setState({
                        value: e.target.value,
                        changed: r.props.value !== r.state.value
                    })
                }, r.onClick = function() {
                    r.setState({
                        editing: !0
                    }, function() {
                        r.textarea && s(r.textarea)
                    })
                }, r.onBlur = function() {
                    r.state.changed || r.setState({
                        editing: !1
                    })
                }, r.onSave = function() {
                    r.props.validate && !r.props.validate(r.state.value) || (r.setState({
                        editing: !1,
                        changed: !1
                    }), r.props.onSave && r.props.onSave({
                        value: r.state.value
                    }))
                }, r.onKeydown = function(e) {
                    r.state.editing && (27 === e.keyCode && (r.props.onCancel && r.props.onCancel(), r.setState({
                        editing: !1,
                        changed: !1,
                        value: r.props.value
                    }), e.preventDefault(), e.stopPropagation()), r.props.useEnter && 13 === e.keyCode && (r.onSave(), e.preventDefault(), e.stopPropagation()))
                }, r.getRef = function(e) {
                    e && e.element && (r.textarea = e.element)
                }, r.state = {
                    value: n.value,
                    editing: !1,
                    changed: !!n.onChange && n.changed
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                this.setState({
                    value: e.value,
                    changed: e.onChange ? e.changed : e.value === this.state.value
                })
            }, t.prototype.componentDidMount = function() {
                this.el = i.findDOMNode(this), this.el.addEventListener("keydown", this.onKeydown)
            }, t.prototype.componentWillUnmount = function() {
                this.el.removeEventListener("keydown", this.onKeydown)
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.className,
                    n = e.validate,
                    i = this.state,
                    s = i.editing,
                    u = i.changed,
                    l = i.value,
                    d = Object(o.classNames)("EditableLabel", {
                        "EditableLabel--editing": s,
                        "EditableLabel--changed": u,
                        "EditableLabel--invalid": n && !n(l)
                    }, t);
                return r.createElement("div", {
                    className: d
                }, s ? r.createElement(r.Fragment, null, r.createElement(a.default, {
                    className: "EditableLabel__textarea",
                    onChange: this.onChange,
                    onInput: this.onChange,
                    onPaste: this.onChange,
                    value: l,
                    onBlur: this.onBlur,
                    style: c,
                    rows: "1",
                    ref: this.getRef
                }), u && r.createElement("button", {
                    className: "EditableLabel__save",
                    onClick: this.onSave
                })) : r.createElement("div", {
                    className: "EditableLabel__text",
                    onClick: this.onClick
                }, l))
            }, t
        }(r.Component);
    t.default = u, u.defaultProps = {
        value: "",
        changed: !1,
        useEnter: !1
    }
}, function(e, t, n) {
    var r = n(91),
        i = n(184),
        o = n(34),
        a = n(61),
        s = n(36),
        c = function(e, t, n) {
            var u, l, d, f, p = e & c.F,
                m = e & c.G,
                g = e & c.S,
                h = e & c.P,
                _ = e & c.B,
                v = m ? r : g ? r[t] || (r[t] = {}) : (r[t] || {}).prototype,
                b = m ? i : i[t] || (i[t] = {}),
                y = b.prototype || (b.prototype = {});
            for (u in m && (n = t), n) d = ((l = !p && v && void 0 !== v[u]) ? v : n)[u], f = _ && l ? s(d, r) : h && "function" == typeof d ? s(Function.call, d) : d, v && a(v, u, d, e & c.U), b[u] != d && o(b, u, f), h && y[u] != d && (y[u] = d)
        };
    r.core = i, c.F = 1, c.G = 2, c.S = 4, c.P = 8, c.B = 16, c.W = 32, c.U = 64, c.R = 128, e.exports = c
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return u
    });
    var r = n(194),
        i = n(54),
        o = n(102),
        a = n(148),
        s = "_im_retry_media";

    function c(e, t, n, r, c) {
        if (!Object(o.isSearchingInplace)(e.get().peer, e.get()) && !(hasClass(c, i.FAILED_CLASS) || hasClass(c, i.SENDING_CLASS) || hasClass(c, "_im_mess_srv") || Object(i.checkSelectClick)(r, c) || Object(a.isAnyMessageBeingEdited)(e) || "A" === r.target.tagName || r.target.classList.contains(s))) {
            var u = intval(domData(c, "msgid")),
                l = e.get().peer;
            if (!Object(i.isAlreadyDeleted)(e, l, u)) {
                var d = void 0,
                    f = void 0;
                d = r.shiftKey ? Object(a.getMessageRangeFromSelection)(e, l, u) : [u], e.set(o.addSelection.bind(null, d)).then(function() {
                    var r = Object(a.getSelectedMessages)(e),
                        i = !1;
                    d.forEach(function(e) {
                        var t = geByClass1("_im_mess_" + e, n);
                        if (t) {
                            var o = inArray(e, r);
                            i |= o, toggleClass(t, "im-mess_selected", o);
                            var a = o ? getLang("mail_deselect_message") : getLang("mail_select_message"),
                                s = geByClass1("_im_mess_blind_label_select", t);
                            attr(s, "aria-label", a)
                        }
                    }), i && (window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty()), t().changedMessageSelection(e)
                }).then(function() {
                    1 !== e.get().selectedMessages.length || f ? f && f.hide() : f = function(e) {
                        var t = e.get();
                        if (t.pinnedMessagesPromo && Object(i.isChatPeer)(t.peer)) {
                            var n = geByClass1("_mess-action-promo"),
                                r = new ElementTooltip(n, {
                                    autoShow: !1,
                                    appendTo: n,
                                    content: getTemplate("im_pinned_messages_promo", {
                                        content: getLang("mail_pinned_messages_promo_tooltip")
                                    }),
                                    forceSide: "bottom",
                                    cls: "feature_intro_tt",
                                    width: 260,
                                    onHide: function() {
                                        e.setState({
                                            pinnedMessagesPromo: !1
                                        }), Object(o.hidePromoTooltip)()
                                    }
                                });
                            return r.show(), r
                        }
                    }(e)
                })
            }
        }
    }

    function u(e, t, n) {
        var i = c.bind(null, t, n, e),
            o = Object(r.createModule)({
                handlers: function(t, n) {
                    n(e, "click", "_im_mess", i)
                }
            });
        return function(e, t) {
            return {
                cleanSelection: function(t) {
                    t.map(function(t) {
                        return geByClass1("_im_mess_" + t, e)
                    }).filter(function(e) {
                        return e
                    }).forEach(function(e) {
                        return removeClass(e, "im-mess_selected")
                    })
                },
                unmount: function() {
                    Object(r.destroyModule)(t)
                }
            }
        }(e, o)
    }
}, function(e, t, n) {
    var r = n(95),
        i = n(180);
    e.exports = function(e) {
        return r(i(e))
    }
}, function(e, t, n) {
    "use strict";
    var r = n(86),
        i = n(20),
        o = n(61),
        a = n(34),
        s = n(155),
        c = n(107),
        u = n(136),
        l = n(41),
        d = n(210),
        f = n(68)("iterator"),
        p = !([].keys && "next" in [].keys()),
        m = function() {
            return this
        };
    e.exports = function(e, t, n, g, h, _, v) {
        u(n, t, g);
        var b, y, w, O = function(e) {
                if (!p && e in j) return j[e];
                switch (e) {
                    case "keys":
                    case "values":
                        return function() {
                            return new n(this, e)
                        }
                }
                return function() {
                    return new n(this, e)
                }
            },
            C = t + " Iterator",
            k = "values" == h,
            E = !1,
            j = e.prototype,
            S = j[f] || j["@@iterator"] || h && j[h],
            T = S || O(h),
            I = h ? k ? O("entries") : T : void 0,
            P = "Array" == t && j.entries || S;
        if (P && (w = d(P.call(new e))) !== Object.prototype && (l(w, C, !0), r || s(w, f) || a(w, f, m)), k && S && "values" !== S.name && (E = !0, T = function() {
                return S.call(this)
            }), r && !v || !p && !E && j[f] || a(j, f, T), c[t] = T, c[C] = m, h)
            if (b = {
                    values: k ? T : O("values"),
                    keys: _ ? T : O("keys"),
                    entries: I
                }, v)
                for (y in b) y in j || o(j, y, b[y]);
            else i(i.P + i.F * (p || E), t, b);
        return b
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(109),
        o = n(151),
        a = n(54),
        s = n(187),
        c = n(43),
        u = n(85),
        l = n(38),
        d = n(178),
        f = n(117),
        p = n(6);
    var m = 50,
        g = {
            appendParentCls: "ChatSettingsWrapper"
        },
        h = window,
        _ = h.langSex,
        v = h.langNumeric,
        b = h.getSmDate,
        y = i.default.getLang,
        w = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                O.call(r);
                var i = n.store.get(),
                    o = r.getMembers(i),
                    a = r.getAdmins(i);
                return r.state = {
                    showSearch: !1,
                    searchQuery: "",
                    current: "all",
                    all: o,
                    allShowMore: o.length > m,
                    admins: a,
                    adminsShowMore: a.length > m
                }, r.membersMap = o.reduce(function(e, t) {
                    return e[t] = !0, e
                }, {}), r.searchIndexPromise = r.getSearchIndex(o).then(function(e) {
                    r.searchIndex = e
                }), r.invitersCache = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                var t = this,
                    n = e.store.get(),
                    r = this.getMembers(n),
                    i = this.getAdmins(n),
                    o = {
                        removes: [],
                        additions: []
                    },
                    a = r.reduce(function(e, t) {
                        return e[t] = !0, e
                    }, {});
                r.forEach(function(e) {
                    t.membersMap[e] || o.additions.push(e)
                }), Object.keys(this.membersMap).forEach(function(e) {
                    a[e] || o.removes.push(e)
                }), (o.removes.length || o.additions.length) && (this.updateSearchIndex(n, o), this.membersMap = a), this.setState({
                    all: r,
                    allShowMore: this.state.allShowMore && r.length > m,
                    admins: i,
                    adminsShowMore: this.state.adminsShowMore && i.length > m
                })
            }, t.prototype.getMembers = function(e) {
                var t = e.peer,
                    n = e.tabs[t],
                    r = -1 !== (n.memberIds || []).indexOf(n.ownerId),
                    i = (n.adminIds || []).reduce(function(e, t) {
                        return e[t] = !0, e
                    }, {});
                return (r ? [n.ownerId] : []).concat((n.adminIds || []).filter(function(e) {
                    return e !== n.ownerId
                }), (n.memberIds || []).filter(function(e) {
                    return e !== n.ownerId && !i[e]
                }))
            }, t.prototype.getAdmins = function(e) {
                var t = e.peer,
                    n = e.tabs[t];
                return (-1 !== (n.memberIds || []).indexOf(n.ownerId) ? [n.ownerId] : []).concat((n.adminIds || []).filter(function(e) {
                    return e !== n.ownerId
                }))
            }, t.prototype.getCurrentList = function() {
                var e = this.props.store,
                    t = this.state,
                    n = t.current,
                    r = t.showSearch,
                    i = t.searchQuery;
                if (r && i && this.searchIndex) return this.searchIndex.search(i);
                var o = this.state[n],
                    s = Object(a.getChatMembersByIds)(e.get(), o);
                return this.state[n + "ShowMore"] ? s.slice(0, m) : s
            }, t.prototype.getSearchIndex = function(e) {
                var t = window.vkIndexer,
                    n = Object(a.getChatMembersByIds)(this.props.store.get(), e);
                return this.membersMap = n.reduce(function(e, t) {
                    return e[t.id] = !0, e
                }, {}), new Promise(function(e, r) {
                    var i = new t(n, function(e) {
                        return e.name
                    }, function() {
                        e(i)
                    })
                })
            }, t.prototype.updateSearchIndex = function(e, t) {
                var n = Object(a.getChatMembersByIds)(e, t.removes),
                    r = Object(a.getChatMembersByIds)(e, t.additions);
                (this.searchIndex ? Promise.resolve(this.searchIndex) : this.searchIndexPromise).then(function(e) {
                    n.forEach(function(t) {
                        e.remove(t)
                    }), r.forEach(function(t) {
                        e.add(t)
                    })
                })
            }, t.prototype.componentDidMount = function() {
                this.searchInput.addEventListener("keydown", this.onKeydown)
            }, t.prototype.componentWillUnmount = function() {
                this.searchInput.removeEventListener("keydown", this.onKeydown)
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.store,
                    i = t.membersCount,
                    s = t.membersAdded,
                    m = t.onHideStatus,
                    h = this.state,
                    _ = h.current,
                    b = h.showSearch,
                    w = h.searchQuery,
                    O = h.allShowMore,
                    C = h.adminsShowMore,
                    k = n.get(),
                    E = k.peer,
                    j = k.tabs[E],
                    S = this.getCurrentList(),
                    T = this.isAddMemberWidgetShown() ? ["add"].concat(S) : S,
                    I = "all" === _ ? O : C,
                    P = j.membersLastSeen,
                    M = {
                        "ChatSettingsMembersWidget--search": !!b
                    },
                    x = j.adminIds.reduce(function(e, t) {
                        return e[t] = !0, e
                    }, {});
                return r.createElement("div", {
                    className: Object(o.classNames)("ChatSettingsMembersWidget", M)
                }, r.createElement("header", {
                    className: "ChatSettingsMembersWidget__header"
                }, r.createElement("input", {
                    placeholder: y("mail_members_search"),
                    className: "ChatSettingsMembersWidget__search",
                    onChange: this.onSearchChange,
                    onInput: this.onSearchChange,
                    onPaste: this.onSearchChange,
                    value: this.state.searchQuery,
                    ref: this.searchInputRef
                }), r.createElement("button", {
                    className: "ChatSettingsMembersWidget__searchIcon",
                    onClick: this.onToggleSearch
                }), r.createElement(c.default, {
                    className: "ChatSettingsMembersWidget__tabs",
                    onTabClick: this.onTabClick
                }, r.createElement("span", {
                    key: "all"
                }, y("mail_settings_everyone") + " ", r.createElement("span", {
                    className: "Tabs__desc"
                }, Object(a.getAliveMembersCount)(j))), j.adminIds.length > 0 && r.createElement("span", {
                    key: "admins"
                }, y("mail_settings_admins") + " ", r.createElement("span", {
                    className: "Tabs__desc"
                }, j.adminIds.length)))), r.createElement("div", {
                    className: "ChatSettingsMembersWidget__list"
                }, r.createElement(u.default, {
                    border: !1
                }, T.length > 0 && T.map(function(t) {
                    if ("add" === t) return r.createElement(l.default, {
                        selectable: !1,
                        border: !1,
                        key: "add",
                        onClick: e.props.showMembersSettings,
                        aside: r.createElement(p.default, {
                            className: "ChatSettingsMembersWidget__blink",
                            shown: s,
                            callback: m
                        }, v(i || 0, y("mail_settings_members_added", "raw")))
                    }, r.createElement("span", {
                        className: "ChatSettingsMembersWidget__add"
                    }, r.createElement("span", null, y("mail_settings_add_members"))));
                    var o = e.getInviter(t.id),
                        c = P && P[t.id] ? Object(a.getLastSeenText)(k, t.id, P[t.id], g) : "";
                    return r.createElement(l.default, {
                        selectable: !1,
                        border: !1,
                        aside: r.createElement(f.default, {
                            adminMap: x,
                            store: n,
                            storeData: k,
                            mid: t.id,
                            onLeave: e.props.onLeave
                        }),
                        key: t.id
                    }, r.createElement(d.default, {
                        photo: t.photo,
                        title: t.name,
                        description: r.createElement("span", {
                            title: o,
                            dangerouslySetInnerHTML: {
                                __html: c
                            }
                        }),
                        href: t.link
                    }))
                }), !T.length && b && w && r.createElement("div", {
                    className: "ChatSettingsMembersWidget__empty"
                }, y("mail_settings_not_found")), !(b && w) && I && r.createElement("div", {
                    className: "ChatSettingsMembersWidget__more",
                    onClick: this.onShowMore
                }, y("mail_settings_show_all_members")))))
            }, t
        }(r.Component),
        O = function() {
            var e = this;
            this.onToggleSearch = function() {
                e.state.showSearch ? e.setState({
                    showSearch: !1,
                    searchQuery: ""
                }) : (e.setState({
                    showSearch: !0
                }), requestAnimationFrame(function() {
                    e.searchInput.focus()
                }))
            }, this.onSearchChange = function(t) {
                t.target.value !== e.state.searchQuery && e.setState({
                    searchQuery: t.target.value
                })
            }, this.onShowMore = function() {
                var t = "all" === e.state.current ? "allShowMore" : "adminsShowMore";
                e.state[t] && e.setState(function(e, t, n) {
                    return t in e ? Object.defineProperty(e, t, {
                        value: n,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : e[t] = n, e
                }({}, t, !1))
            }, this.onTabClick = function(t, n) {
                t.preventDefault(), e.state.current !== n && e.setState({
                    current: n
                })
            }, this.handleDocumentClick = function(t) {
                !e.state.showSearch || e.state.searchQuery || t.target.closest(".ChatSettingsMembersWidget__search") || t.target.closest(".ChatSettingsMembersWidget__searchIcon") || e.setState({
                    showSearch: !1
                })
            }, this.onKeydown = function(t) {
                e.state.showSearch && 27 === t.keyCode && (e.searchInput.blur(), e.setState({
                    showSearch: !1,
                    searchQuery: ""
                }), t.preventDefault(), t.stopPropagation())
            }, this.getInviter = function(t) {
                if (e.invitersCache[t]) return e.invitersCache[t];
                var n = e.props.store.get(),
                    r = n.peer,
                    i = n.tabs[r],
                    o = i.inviters;
                if (!o[t]) return "";
                var c = Object(a.getChatMembersByIds)(n, [o[t][0]])[0],
                    u = b(o[t][2], n.timeshift, !0);
                if (Object(s.isUserOwnerInChat)(i, t)) return e.invitersCache[t] = y("mail_settings_owner"), y("mail_settings_owner");
                if (!c) return e.invitersCache[t] = u, u;
                var l = _(o[t][1], y("mail_chat_member_invited_by_X", "raw")).replace(/{inviter}/, replaceEntities(c.name)) + " " + u;
                return e.invitersCache[t] = l, l
            }, this.isAddMemberWidgetShown = function() {
                var t = window.vk.id,
                    n = e.props.store,
                    r = n.get().peer,
                    i = e.state,
                    o = i.current,
                    a = i.showSearch,
                    c = i.searchQuery;
                return "all" === o && !(a && "" !== c) && Object(s.canInviteUser)(n, r, t)
            }, this.searchInputRef = function(t) {
                e.searchInput = t
            }
        };
    t.default = w
}, function(e, t, n) {
    var r = n(36),
        i = n(88),
        o = n(139),
        a = n(4),
        s = n(81),
        c = n(108);
    e.exports = function(e, t, n, u, l) {
        var d, f, p, m = l ? function() {
                return e
            } : c(e),
            g = r(n, u, t ? 2 : 1),
            h = 0;
        if ("function" != typeof m) throw TypeError(e + " is not iterable!");
        if (o(m))
            for (d = s(e.length); d > h; h++) t ? g(a(f = e[h])[0], f[1]) : g(e[h]);
        else
            for (p = m.call(e); !(f = p.next()).done;) i(p, g, f.value, t)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "isUnread", function() {
        return o
    }), n.d(t, "isServiceMsg", function() {
        return a
    }), n.d(t, "isCallMessage", function() {
        return s
    }), n.d(t, "isOut", function() {
        return c
    }), n.d(t, "isGraffiti", function() {
        return l
    }), n.d(t, "isAudioMsg", function() {
        return d
    }), n.d(t, "isSticker", function() {
        return f
    }), n.d(t, "isGift", function() {
        return p
    }), n.d(t, "isMoney", function() {
        return m
    }), n.d(t, "isMoneyRequest", function() {
        return g
    }), n.d(t, "isMessageWithInviteLink", function() {
        return h
    }), n.d(t, "isVKPay", function() {
        return _
    }), n.d(t, "isImportant", function() {
        return v
    }), n.d(t, "getUserId", function() {
        return b
    }), n.d(t, "getAuthorId", function() {
        return y
    }), n.d(t, "wasEdited", function() {
        return w
    }), n.d(t, "isMessageSelected", function() {
        return O
    });
    var r = n(18),
        i = n(7);

    function o(e, t) {
        return "number" != typeof t.messageId || (c(t) ? t.messageId > e.out_up_to : t.messageId > e.in_up_to)
    }

    function a(e) {
        return e.kludges && void 0 !== e.kludges.source_act
    }

    function s(e) {
        return "call" == e.kludges.attach1_type
    }

    function c(e) {
        return e.flags & r.FLAG_OUTBOUND
    }

    function u(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null,
            r = e.attaches[0];
        return r && (r.type === t || r.type === n)
    }

    function l(e) {
        return u(e, "doc") && "graffiti" === e.attaches[0].kind
    }

    function d(e) {
        return u(e, "doc") && "audiomsg" === e.attaches[0].kind
    }

    function f(e) {
        return u(e, "sticker")
    }

    function p(e) {
        return u(e, "gift")
    }

    function m(e) {
        return u(e, "money_transfer", "money_request")
    }

    function g(e) {
        return u(e, "money_request")
    }

    function h(e) {
        return u(e, "link") && (t = e.kludges.attach1_url, /^https:\/\/(.+\.)?vk\.com\/vk-me\.php\?act=join&(amp;)?link=[\w\/=_]+$/.test(t) || /^https:\/\/vk\.me\/join\/[\w\/=_]+$/.test(t));
        var t
    }

    function _(e) {
        return u(e, "link", "vkpay") && 6217559 == e.kludges.attach1_app_id
    }

    function v(e) {
        return e.flags & r.FLAG_IMPORTANT
    }

    function b(e) {
        return c(e) ? vk.id : e.userId
    }

    function y(e, t) {
        var n = Object(i.unpackStore)(e);
        return c(t) ? n.id : t.userId
    }

    function w(e) {
        return e.update_time > 0
    }

    function O(e, t) {
        return (e.get().selectedMessages || []).indexOf(t) >= 0
    }
}, function(e, t, n) {
    var r = n(155),
        i = n(22),
        o = n(49)(!1),
        a = n(5)("IE_PROTO");
    e.exports = function(e, t) {
        var n, s = i(e),
            c = 0,
            u = [];
        for (n in s) n != a && r(s, n) && u.push(n);
        for (; t.length > c;) r(s, n = t[c++]) && (~o(u, n) || u.push(n));
        return u
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(54),
        o = n(102),
        a = n(18),
        s = n(109),
        c = n(137),
        u = n(33),
        l = n(9),
        d = n(213),
        f = n(197),
        p = n(199),
        m = n(24),
        g = n(75),
        h = n(52),
        _ = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var v = 0,
        b = 2,
        y = 300,
        w = s.default.getLang,
        O = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.showInvitationLink = function() {
                    var e = r.props.store.get(),
                        t = e.peer;
                    return r.setState({
                        invitationLoading: !0
                    }), Object(o.getInviteLink)(t - 2e9, e).then(function(e) {
                        var t = _(e, 1)[0];
                        r.setState({
                            section: b,
                            invitationLoading: !1,
                            invitationLink: t
                        })
                    })
                }, r.onUpdateFlags = function(e) {
                    var t = r.props.store.get(),
                        n = t.peer;
                    return Object(o.updateFlags)(n, e, t)
                }, r.afterUpdateFlags = function() {
                    r.go(v, function() {
                        return r.setBlinkStatus({
                            flagsUpdated: !0
                        })
                    })
                }, r.afterMembersAdded = function(e) {
                    r.go(v, function() {
                        return r.setBlinkStatus({
                            membersAdded: !0,
                            membersCount: e
                        })
                    })
                }, r.setBlinkStatus = function(e) {
                    r.timers.push(setTimeout(function() {
                        return r.setState(e)
                    }, y))
                }, r.onHideStatus = function() {
                    r.setState({
                        membersAdded: !1,
                        flagsUpdated: !1
                    })
                }, r.onLeave = function() {
                    var e = r.props,
                        t = e.store,
                        n = e.closePopup,
                        s = t.get().peer,
                        c = Object(i.isFvkcomgroup)(t, s),
                        u = showFastBox({
                            title: w(c ? "mail_vkcomgroup_leave_title" : "mail_chat_leave_title"),
                            dark: 1
                        }, w(c ? "mail_vkcomgroup_leave_confirm" : "mail_chat_leave_confirm"), w(c ? "mail_leave_vkcomgroup" : "mail_leave_chat"), function() {
                            t.set(o.unpinMessageOptimistic.bind(null, s)), t.set(o.leaveChat.bind(null, s)), u.hide(), n(), t.get().longpoll.push([Object(a.resetPeer)()])
                        }, w("global_cancel"), function() {
                            u.hide()
                        })
                }, r.onResetLink = function() {
                    var e = r.props.store.get(),
                        t = e.peer;
                    return Object(o.resetInviteLink)(t, e).then(function(e) {
                        var t = _(e, 1)[0];
                        r.setState({
                            invitationLink: t,
                            invitationLinkReseted: !0
                        })
                    })
                }, r.onShowAttachments = function() {
                    var e = r.props.store.get().peer;
                    window.showWiki({
                        w: "history" + Object(i.convertPeerToUrl)(e) + "_photo"
                    }, null, {})
                }, r.state = {
                    section: v,
                    invitationLink: null,
                    invitationLinkReseted: !1,
                    membersAdded: !1,
                    flagsUpdated: !1
                }, r.timers = [], r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.go = function(e, t) {
                var n = this;
                this.setState({
                    section: e
                }, function() {
                    n.props.updatePopup(), t && t()
                })
            }, t.prototype.getPopupTitle = function() {
                switch (this.state.section) {
                    case 1:
                        return w("mail_settings_add_members");
                    case b:
                    case 3:
                        return w("mail_chat_invite_link");
                    case 6:
                        return w("mail_settings_options");
                    default:
                        return w("mail_settings_title")
                }
            }, t.prototype.componentWillReceiveProps = function(e) {
                var t = this,
                    n = e.store.get(),
                    r = n.peer,
                    i = n.tabs[r];
                i.photoLarge || i.photoGrid || this.resync || (this.resync = !0, e.store.set(o.getChatDetails.bind(null, r)).then(function() {
                    t.resync = !0
                }))
            }, t.prototype.componentDidMount = function() {
                this.props.updatePopup()
            }, t.prototype.componentWillUnmount = function() {
                this.timers.forEach(clearTimeout)
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.store,
                    o = t.closePopup,
                    a = n.get(),
                    s = a.peer,
                    _ = a.tabs[s],
                    y = Object(i.isFvkcomgroup)(n, s),
                    O = !y || !n.get().gid,
                    C = w(y ? "mail_im_n_vkcomgroup_members" : "mail_im_n_chat_members", Object(i.getAliveMembersCount)(_));
                return r.createElement("section", {
                    className: "ChatSettings"
                }, r.createElement(c.default, {
                    title: this.getPopupTitle(),
                    back: this.state.section !== v ? w("global_back") : void 0,
                    onCloseClick: o,
                    onBackClick: function() {
                        return e.go(v)
                    }
                }), this.state.section === v && r.createElement("div", {
                    className: "ChatSettings__content"
                }, r.createElement(l.default, {
                    store: n,
                    photo: _.photoLarge,
                    grid: _.photoGrid,
                    title: _.name,
                    flags: _.data.flags,
                    meta: C,
                    description: ""
                }), r.createElement(p.default, {
                    store: n,
                    showNotificationSettings: function() {},
                    showMembersSettings: function() {
                        return e.go(1)
                    },
                    showAttachments: this.onShowAttachments,
                    showInvitationLink: this.showInvitationLink,
                    showSettings: function() {
                        return e.go(6)
                    },
                    membersAdded: this.state.membersAdded,
                    membersCount: this.state.membersCount,
                    flagsUpdated: this.state.flagsUpdated,
                    onHideStatus: this.onHideStatus
                }), y ? null : r.createElement("div", {
                    className: "ChatSettings__pane"
                }, r.createElement(m.default, {
                    store: n,
                    onLeave: this.onLeave,
                    showMembersSettings: function() {
                        return e.go(1)
                    },
                    membersAdded: this.state.membersAdded,
                    onHideStatus: this.onHideStatus,
                    membersCount: this.state.membersCount
                })), O && r.createElement("div", {
                    className: "ChatSettings__pane"
                }, r.createElement(u.default, {
                    appearance: "mobile",
                    className: "ChatSettings__leave",
                    onClick: this.onLeave
                }, w(y ? "mail_leave_vkcomgroup" : "mail_settings_leave")))), 1 === this.state.section && r.createElement(g.default, {
                    store: n,
                    afterSave: this.afterMembersAdded
                }), 6 === this.state.section && r.createElement(h.default, {
                    tab: _,
                    back: function() {
                        return e.go(v)
                    },
                    onSave: this.onUpdateFlags,
                    afterSave: this.afterUpdateFlags
                }), this.state.section === b && r.createElement(d.default, {
                    store: n,
                    onReset: function() {
                        return e.go(3)
                    },
                    reseted: this.state.invitationLinkReseted,
                    invitationLink: this.state.invitationLink
                }), 3 === this.state.section && r.createElement(f.default, {
                    onConfirm: this.onResetLink,
                    onCancel: function() {
                        return e.go(b)
                    }
                }))
            }, t
        }(r.Component);
    t.default = O
}, function(e, t) {
    e.exports = function(e, t) {
        return {
            value: t,
            done: !!e
        }
    }
}, function(e, t, n) {
    "use strict";

    function r(e, t) {
        return new Promise(function(n) {
            setTimeout(n.bind(null, t), 1e3 * e)
        })
    }

    function i(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null,
            i = 0;
        return function o() {
            for (var a = arguments.length, s = Array(a), c = 0; c < a; c++) s[c] = arguments[c];
            return Promise.resolve().then(function() {
                return e.apply(void 0, s)
            }).catch(function(e) {
                if (++i <= t) {
                    var a = "function" == typeof n ? n(i) : 0;
                    return 0 === a ? o.apply(void 0, s) : r(a).then(function() {
                        return o.apply(void 0, s)
                    })
                }
                throw e
            })
        }
    }

    function o(e, t, n) {
        var r = void 0,
            i = void 0;
        return function() {
            for (var o = arguments.length, a = Array(o), s = 0; s < o; s++) a[s] = arguments[s];
            return new Promise(function(e, o) {
                var s = n && !r;
                clearTimeout(r), i && i.reject("debounce"), r = setTimeout(function() {
                    r = null, i = null, n || e(a)
                }, t), s ? e(a) : n && o("debounce"), i = {
                    resolve: e,
                    reject: o
                }
            }).then(function(t) {
                return e.apply(void 0, function(e) {
                    if (Array.isArray(e)) {
                        for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                        return n
                    }
                    return Array.from(e)
                }(t))
            })
        }
    }

    function a(e, t) {
        var n = void 0,
            r = new Promise(function(r) {
                n = r, setTimeout(r.bind(null, t), 1e3 * e)
            });
        return {
            pause: function() {
                return r
            },
            abort: function() {
                n(t)
            }
        }
    }
    n.r(t), n.d(t, "pause", function() {
        return r
    }), n.d(t, "retryFn", function() {
        return i
    }), n.d(t, "debouncedPromise", function() {
        return o
    }), n.d(t, "abortablePause", function() {
        return a
    })
}, function(e, t, n) {
    "use strict";
    var r = n(82),
        i = n(174),
        o = n(212);
    e.exports = function() {
        function e(e, t, n, r, a, s) {
            s !== o && i(!1, "Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")
        }

        function t() {
            return e
        }
        e.isRequired = e;
        var n = {
            array: e,
            bool: e,
            func: e,
            number: e,
            object: e,
            string: e,
            symbol: e,
            any: e,
            arrayOf: t,
            element: e,
            instanceOf: t,
            node: e,
            objectOf: t,
            oneOf: t,
            oneOfType: t,
            shape: t,
            exact: t
        };
        return n.checkPropTypes = r, n.PropTypes = n, n
    }
}, function(e, t) {
    e.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151)),
        o = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t() {
            return function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t),
                function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.className,
                n = e.appearance,
                a = e.wide,
                s = e.overflow,
                c = e.size,
                u = (e.children, function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["className", "appearance", "wide", "overflow", "size", "children"])),
                l = Object(i.classNames)("Button", "Button--" + n, "Button--size-" + c, {
                    "Button--wide": !!a,
                    "Button--overflow": !!s,
                    "Button--disabled": !!e.disabled
                }, t);
            return r.createElement("button", o({}, u, {
                className: l
            }), e.children)
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        appearance: "primary",
        size: "m",
        wide: !1
    }
}, function(e, t, n) {
    var r = n(124),
        i = n(98);
    e.exports = n(154) ? function(e, t, n) {
        return r.f(e, t, i(1, n))
    } : function(e, t, n) {
        return e[t] = n, e
    }
}, function(e, t) {
    e.exports = function(e) {
        return "object" == typeof e ? null !== e : "function" == typeof e
    }
}, function(e, t, n) {
    var r = n(2);
    e.exports = function(e, t, n) {
        if (r(e), void 0 === t) return e;
        switch (n) {
            case 1:
                return function(n) {
                    return e.call(t, n)
                };
            case 2:
                return function(n, r) {
                    return e.call(t, n, r)
                };
            case 3:
                return function(n, r, i) {
                    return e.call(t, n, r, i)
                }
        }
        return function() {
            return e.apply(t, arguments)
        }
    }
}, function(e, t) {
    var n, r, i = e.exports = {};

    function o() {
        throw new Error("setTimeout has not been defined")
    }

    function a() {
        throw new Error("clearTimeout has not been defined")
    }

    function s(e) {
        if (n === setTimeout) return setTimeout(e, 0);
        if ((n === o || !n) && setTimeout) return n = setTimeout, setTimeout(e, 0);
        try {
            return n(e, 0)
        } catch (t) {
            try {
                return n.call(null, e, 0)
            } catch (t) {
                return n.call(this, e, 0)
            }
        }
    }! function() {
        try {
            n = "function" == typeof setTimeout ? setTimeout : o
        } catch (e) {
            n = o
        }
        try {
            r = "function" == typeof clearTimeout ? clearTimeout : a
        } catch (e) {
            r = a
        }
    }();
    var c, u = [],
        l = !1,
        d = -1;

    function f() {
        l && c && (l = !1, c.length ? u = c.concat(u) : d = -1, u.length && p())
    }

    function p() {
        if (!l) {
            var e = s(f);
            l = !0;
            for (var t = u.length; t;) {
                for (c = u, u = []; ++d < t;) c && c[d].run();
                d = -1, t = u.length
            }
            c = null, l = !1,
                function(e) {
                    if (r === clearTimeout) return clearTimeout(e);
                    if ((r === a || !r) && clearTimeout) return r = clearTimeout, clearTimeout(e);
                    try {
                        r(e)
                    } catch (t) {
                        try {
                            return r.call(null, e)
                        } catch (t) {
                            return r.call(this, e)
                        }
                    }
                }(e)
        }
    }

    function m(e, t) {
        this.fun = e, this.array = t
    }

    function g() {}
    i.nextTick = function(e) {
        var t = new Array(arguments.length - 1);
        if (arguments.length > 1)
            for (var n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
        u.push(new m(e, t)), 1 !== u.length || l || s(p)
    }, m.prototype.run = function() {
        this.fun.apply(null, this.array)
    }, i.title = "browser", i.browser = !0, i.env = {}, i.argv = [], i.version = "", i.versions = {}, i.on = g, i.addListener = g, i.once = g, i.off = g, i.removeListener = g, i.removeAllListeners = g, i.emit = g, i.prependListener = g, i.prependOnceListener = g, i.listeners = function(e) {
        return []
    }, i.binding = function(e) {
        throw new Error("process.binding is not supported")
    }, i.cwd = function() {
        return "/"
    }, i.chdir = function(e) {
        throw new Error("process.chdir is not supported")
    }, i.umask = function() {
        return 0
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return a
    });
    var r = n(188),
        i = n(151),
        o = (n(195), Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        });

    function a(e) {
        var t = e.icon,
            n = e.aside,
            a = e.chevron,
            s = e.selectable,
            c = e.border,
            u = e.className,
            l = e.children,
            d = e.active,
            f = e.canBeHovered,
            p = void 0 === f || f,
            m = function(e, t) {
                var n = {};
                for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                return n
            }(e, ["icon", "aside", "chevron", "selectable", "border", "className", "children", "active", "canBeHovered"]),
            g = {
                "ListItem--chevron": !!a,
                "ListItem--selectable": !!s,
                "ListItem--border": !!c,
                "ListItem--active": !!d,
                "ListItem--can-be-hovered": p
            };
        return r.createElement("li", o({}, m, {
            className: Object(i.classNames)("ListItem", g, u)
        }), t && r.createElement("div", {
            className: "ListItem__icon"
        }, t), r.createElement("div", {
            className: "ListItem__main"
        }, l), r.createElement("div", {
            className: "ListItem__aside"
        }, n))
    }
    a.defaultProps = {
        onClick: function() {},
        icon: null,
        aside: null,
        chevron: !1,
        selectable: !0,
        border: !0
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "getUploadModule", function() {
        return o
    }), n.d(t, "getUploadVideoExtMasks", function() {
        return i
    }), n.d(t, "onVideoUploaded", function() {
        return a
    });
    var r = n(17);

    function i(e) {
        var t = r.VIDEO_UPLOAD_EXTS.slice(0, r.VIDEO_UPLOAD_EXTS.length);
        if ("types" === e) {
            for (var n = t.length, i = 0; i < n; ++i) t.push(t[i].toUpperCase());
            return "*." + t.join(";*.")
        }
        return "accept" === e ? "." + r.VIDEO_UPLOAD_EXTS.join(",.") : ""
    }

    function o(e, t, n, o) {
        o = o || {}, cur.maxFiles = (cur.chooseParams || {}).maxFiles || 10;
        var a = cur.maxFiles - (cur.savedVideos || []).length,
            s = {
                accept: browser.safari ? "" : "video/*," + i("accept"),
                file_input: null,
                file_name: "video_file",
                file_size_limit: 1024 * (n.options.file_size_limit_in_GB || r.VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB) * 1024 * 1024,
                file_types_description: "Video files",
                file_types: i("types"),
                chooseBox: 1,
                chunked: 1,
                chunkSize: r.VIDEO_UPLOAD_CHUNK_SIZE,
                clear: 1,
                dragEl: t === boxLayerWrap ? boxLayerWrap : bodyNode,
                dropbox: t,
                lang: n.lang,
                max_attempts: 3,
                max_files: a,
                multiple: 1,
                multi_progress: 1,
                requestOptionsForFile: !0,
                type: "video",
                visibleDropbox: !n.options.hasOwnProperty("visible_dropbox") || n.options.visible_dropbox
            };
        return Upload.init(e, "", {}, Object.assign(s, o))
    }

    function a(e, t, n, r) {
        n = n || cur;
        var i = void 0 !== e.ind ? e.ind : e,
            o = (e.fileName || e.filename || "").replace(/[&<>"']/g, ""),
            a = o ? i + "_" + o : e,
            s = cur.gid ? -cur.gid : vk.id,
            c = s + "_" + t.video_id,
            u = ge("upload" + a + "_progress_wrap");
        u && hide(geByClass1("progress_x", u)), ajax.post("al_video.php", {
            act: "a_video_photo_sizes",
            oid: s,
            vid: t.video_id
        }, {
            onDone: function(e) {
                n.chooseMedia("video", c, extend(e, {
                    upload_ind: a
                })), setTimeout(function() {
                    ! function e(t, n, r) {
                        var i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : null;
                        var o = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 0;
                        var a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 1;
                        ajax.post("al_video.php", {
                            act: "encode_progress",
                            oid: t,
                            vid: n,
                            hash: r,
                            need_thumb: a
                        }, {
                            onDone: function(s) {
                                if (s) {
                                    if (s.error) return c = getLang("video_upload_encode_error"), void setTimeout(showFastBox({
                                        title: getLang("global_error")
                                    }, c).hide, 2e3);
                                    a && s.thumb && (a = 0, ajax.post("al_video.php", {
                                        act: "a_video_photo_sizes",
                                        oid: t,
                                        vid: n
                                    }, {
                                        onDone: function(e) {
                                            i && i(e)
                                        }
                                    }))
                                }
                                var c;
                                a && setTimeout(e.pbind(t, n, r, i, o, a), 1e3)
                            },
                            onFail: function() {
                                o || (o = 1), setTimeout(e.pbind(t, n, r, i, o + 1, a), 2e3 * o)
                            }
                        })
                    }(s, t.video_id, t.video_hash, function(e) {
                        n.hasChosenMedia("video", c) ? n.updateChosenMedia("video", c, extend(e, {
                            upload_ind: a
                        })) : r && r(e, c)
                    })
                })
            }
        })
    }
    t.default = {
        getUploadModule: function(e, t, n, r) {
            return o(e, t, n, r)
        },
        initModalVideoUploader: function() {
            var e = this,
                t = cur.videoUploadParams,
                n = ge("choose_video_upload"),
                r = {
                    onUploadStart: function(e) {
                        boxQueue.hideLast(), r.onUploadProgress(e, 0, 0)
                    },
                    onUploadComplete: function(e, t) {
                        var n = window.parseJSON(t);
                        n.video_id ? a(e, n) : "string" == typeof t && t.indexOf("TERMINATED") > -1 || Upload.onUploadError(e)
                    },
                    onUploadProgress: function(t, n, r) {
                        var i = void 0 !== t.ind ? t.ind : t;
                        show("_im_media_preview"), cur.showMediaProgress("video", i, e.parseOnUploadProgress(t, n, r))
                    },
                    onUploadError: function(e, n) {
                        statlogsValueEvent("upload_video_fails", 1, t.options.server, n),
                            function(e) {
                                var t = void 0 !== e.ind ? e.ind : e,
                                    n = e.fileName ? t + "_" + e.fileName : e;
                                if (re("upload" + n + "_progress_wrap"), !geByClass1("popup_box_container")) {
                                    var r = getLang("video_upload_error");
                                    setTimeout(showFastBox({
                                        title: getLang("global_error")
                                    }, r).hide, 2e3)
                                }
                                topError("Upload failed", {
                                    dt: -1,
                                    type: 102,
                                    url: (ge("file_uploader_form" + t) || {}).action
                                }), Upload.embed(t)
                            }(e)
                    }
                };
            return this.initDragEvents(), o(n, boxLayerWrap, t, r)
        },
        initDragEvents: function() {
            var e = function(e) {
                    cur.dragTimeout && (clearTimeout(cur.dragTimeout), delete cur.dragTimeout);
                    var t = ge("video_choose_upload_area_wrap");
                    if (!hasClass(t, "video_choose_upload_area_enter")) {
                        addClass(t, "video_choose_upload_area_enter");
                        var n = ge("video_choose_wrap"),
                            r = getXY(n)[1],
                            i = getSize(t)[1];
                        return hide("video_choose_wrap"), setStyle(t, "height", scrollGetY() + window.clientHeight() - r + i), cancelEvent(e)
                    }
                },
                t = function(e) {
                    return cur.dragTimeout && (clearTimeout(cur.dragTimeout), delete cur.dragTimeout), cur.dragTimeout = setTimeout(function() {
                        var e = ge("video_choose_upload_area_wrap");
                        removeClass(e, "video_choose_upload_area_enter"), setStyle(e, "height", null), show("video_choose_wrap")
                    }, 100), cancelEvent(e)
                },
                n = function(e) {
                    if (t(), e.dataTransfer.files.length && Upload.checkFilesSizes(window.videoInlineUploader, e.dataTransfer.files)) return window.Upload && Upload.checked && Upload.checked[window.videoInlineUploader] && Upload.onFileApiSend(window.videoInlineUploader, e.dataTransfer.files), cancelEvent(e)
                },
                r = function() {
                    addEvent(boxLayerWrap, "dragenter dragover", e), addEvent(boxLayerWrap, "dragleave", t), addEvent(boxLayerWrap, "drop", n)
                };
            r(), setTimeout(curBox().setOptions.pbind({
                onHide: function() {
                    removeEvent(boxLayerWrap, "dragenter dragover", e), removeEvent(boxLayerWrap, "dragleave", t), removeEvent(boxLayerWrap, "drop", n)
                },
                onShow: function() {
                    r()
                }
            }), 0)
        },
        parseOnUploadProgress: function(e, t, n) {
            return {
                loaded: t,
                total: n,
                fileName: e.fileName ? e.fileName.replace(/[&<>"']/g, "") : void 0
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return w
    });
    var r = n(194),
        i = n(54),
        o = window,
        a = o.nav,
        s = o.setStyle,
        c = o.getLang,
        u = "._im_sick_reload",
        l = "._im_sick_timer",
        d = 5e3,
        f = 6e5,
        p = 30,
        m = 400,
        g = void 0,
        h = void 0;

    function _(e) {
        var t = ge("page_header"),
            n = window.clientHeight() - t.offsetHeight - p - 2,
            r = m;
        s(e, {
            height: Math.max(n, r)
        })
    }

    function v(e) {
        var t = Object(i.formatTimespan)(Math.floor(Math.max(e, 0) / 1e3), !0);
        return t ? c("mail_sick_timer").replace(/{timer}/gi, t) : ""
    }

    function b() {
        a.reload({
            force: !0
        })
    }

    function y(e) {
        return {
            unmount: function() {
                clearInterval(h), clearTimeout(g), Object(r.destroyModule)(e)
            }
        }
    }

    function w(e, t, n) {
        _(e);
        var i, o, a = (0, Object(r.createMutations)(y).bindMutations)(Object(r.createModule)({
                handlers: function(t, n) {
                    t(e.querySelector(u), "click", b), t(window, "resize", _.bind(null, e))
                }
            })),
            s = (i = localStorage.getItem("im_sick_timer"), o = i ? Math.min(2 * parseInt(i), f) : d, localStorage.setItem("im_sick_timer", o), o),
            c = e.querySelector(l),
            p = +new Date;
        return c.innerHTML = v(s), h = setInterval(function() {
            c.innerHTML = v(p + s - new Date)
        }, 500), g = setTimeout(b, s), a
    }
}, function(e, t, n) {
    var r = n(124).f,
        i = n(155),
        o = n(68)("toStringTag");
    e.exports = function(e, t, n) {
        e && !i(e = n ? e : e.prototype, o) && r(e, o, {
            configurable: !0,
            value: t
        })
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return g
    });
    var r = n(102),
        i = n(194),
        o = "im_hist_search",
        a = "_im_search_date",
        s = "_im_search_date_input",
        c = "_im_search_history_input",
        u = "_im_start_inplace_search",
        l = "_im_cancel_inplace_search",
        d = "_im_clear_date";

    function f(e, t, n, r, a, s) {
        return {
            focus: function(e) {
                uiSearch.focus(t),
                    function(e, t, n, r) {
                        cancelStackPush(o, m.bind(null, e, t, n, r))
                    }(e, t, n, r)
            },
            changePeer: function(e, n) {
                uiSearch.getFieldEl(t).value = n.get().tabs[e].searchText || ""
            },
            search: function() {
                s({})
            },
            unmount: function() {
                Object(i.destroyModule)(a), cancelStackFilter(o), r.then(function(e) {
                    return e.destroy()
                })
            }
        }
    }

    function p(e, t, n) {
        var i = e.get().peer;
        uiSearch.showProgress(n), Object(r.searchMessagesInplace)(i, e.get()).then(function(r) {
            uiSearch.hideProgress(n), t().insertSearch(r, e)
        }).catch(function() {
            uiSearch.focus(n), uiSearch.hideProgress(n)
        })
    }

    function m(e, t, n, i) {
        cancelStackFilter(o), i.then(function(e) {
            e.hide()
        }), e.set(r.cancelSearch.bind(null, e.get().peer)).then(function() {
            uiSearch.getFieldEl(t).value = "", n().cancelSearch(e)
        })
    }

    function g(e, t, n) {
        var o = geByClass1(s, e),
            g = geByClass1(c, e),
            h = function(e, t, n, r) {
                var i = '<td class="im_cal_clear" colspan="7"><button type="button" class="im_cal_clear_lnk _im_clear_date">' + getLang("wall_clear_date_filter") + "</button></td>";
                return new Promise(function(e) {
                    stManager.add(["ui_controls.js", "datepicker.js", "datepicker.css"], function() {
                        var t = new Datepicker(n, {
                            width: 140,
                            resfmt: "plain",
                            addRows: '<tr id="im_day_clear">' + i + "</tr>",
                            addRowsM: '<tr id="im_month_clear">' + i + "</tr>",
                            onUpdate: r
                        });
                        e(t)
                    })
                })
            }(0, 0, o, function(e, t, n, i) {
                e.set(r.setCurrentSearchDate.bind(null, e.get().peer, i.d + "." + i.m + "." + i.y)).then(p.bind(null, e, t, n))
            }.bind(null, t, n, g)),
            _ = function(e, t) {
                e.then(function(e) {
                    triggerEvent(geByClass1("datepicker_control", t), "mousedown", !1, !0)
                })
            }.bind(null, h, e),
            v = function(e, t, n, i, o, a) {
                if ("keyup" !== a.type || 13 == a.which) {
                    var s = clean(uiSearch.getFieldEl(t).value);
                    e.set(r.setCurrentSearch.bind(null, s, e.get().peer)).then(o.bind(null, e, i, t))
                }
            }.bind(null, t, g, o, n, debounce(p, 300)),
            b = m.bind(null, t, g, n, h),
            y = function(e, t, n, i) {
                n.then(function(e) {
                    e.hide()
                }), e.set(r.clearDate.bind(null, e.get().peer)).then(p.bind(null, e, t, i))
            }.bind(null, t, n, h, g),
            w = Object(i.createModule)({
                handlers: function(t, n) {
                    t(geByClass1(a, e), "click", _), t(uiSearch.getFieldEl(g), "keyup", v), t(geByClass1(u, e), "click", v), t(geByClass1(l, e), "click", b), n(e, "click", d, y)
                }
            });
        return f(0, g, n, h, w, v)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151));
    var o = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            r.getActiveTab = function() {
                var e = r.props.active,
                    t = [],
                    n = null;
                return r.props.children.forEach(function(r) {
                    r.key === e ? n = r : t.push(r)
                }), n || (Number.isInteger(e) && t.length > e ? t[e] : t[0])
            }, r.onClick = function(e, t) {
                if (t !== r.state.active) {
                    var n = r.refsStore[t],
                        i = r.getTransform(n);
                    r.setState({
                        active: t,
                        isAnimating: !0,
                        transform: i
                    }), r.props.onTabClick(e, t)
                }
            }, r.onTransitionEnd = function(e) {
                "transform" === e.propertyName && r.setState({
                    isAnimating: !1
                })
            }, r.getRef = function(e, t) {
                r.refsStore[e] = t
            };
            var i = r.getActiveTab();
            return r.refsStore = {}, r.state = {
                isAnimating: !1,
                active: i.key
            }, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.getTransform = function(e) {
            var t = e.offsetWidth;
            return "translateX(" + (e.offsetLeft - 50 + .5 * t) + "px) scaleX(" + t / 100 + ")"
        }, t.prototype.componentDidMount = function() {
            var e = this.refsStore[this.state.active];
            this.setState({
                transform: this.getTransform(e)
            })
        }, t.prototype.render = function() {
            var e = this,
                t = {
                    "Tabs--animating": this.state.isAnimating
                };
            return r.createElement("nav", {
                className: Object(i.classNames)("Tabs", this.props.className, t),
                style: this.props.style
            }, r.createElement("ul", {
                className: "Tabs__list"
            }, this.props.children.map(function(t, n) {
                return r.createElement("li", {
                    className: Object(i.classNames)("Tabs__item", {
                        "Tabs__item--active": e.state.active === (t.key || n)
                    }),
                    onClick: function(r) {
                        return e.onClick(r, t.key || n)
                    },
                    ref: function(r) {
                        return e.getRef(t.key || n, r)
                    },
                    key: t.key || n
                }, t)
            })), r.createElement("div", {
                style: {
                    transform: this.state.transform
                },
                className: "Tabs__divider",
                onTransitionEnd: this.onTransitionEnd
            }))
        }, t
    }(r.Component);
    t.default = o, o.defaultProps = {
        onTabClick: function() {},
        active: 0
    }
}, function(e, t, n) {
    var r = n(27),
        i = n(32);
    e.exports = Object.keys || function(e) {
        return r(e, i)
    }
}, function(e, t, n) {
    "use strict";
    var r = n(56);
    e.exports = function(e) {
        return r(e) && 3 == e.nodeType
    }
}, function(e, t, n) {
    "use strict";
    var r = n(174),
        i = n(188),
        o = n(134),
        a = n(131),
        s = n(82),
        c = n(211),
        u = n(138),
        l = n(205),
        d = n(164);

    function f(e) {
        for (var t = arguments.length - 1, n = "https://reactjs.org/docs/error-decoder.html?invariant=" + e, i = 0; i < t; i++) n += "&args[]=" + encodeURIComponent(arguments[i + 1]);
        r(!1, "Minified React error #" + e + "; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ", n)
    }
    i || f("227");
    var p = {
        _caughtError: null,
        _hasCaughtError: !1,
        _rethrowError: null,
        _hasRethrowError: !1,
        invokeGuardedCallback: function(e, t, n, r, i, o, a, s, c) {
            (function(e, t, n, r, i, o, a, s, c) {
                this._hasCaughtError = !1, this._caughtError = null;
                var u = Array.prototype.slice.call(arguments, 3);
                try {
                    t.apply(n, u)
                } catch (e) {
                    this._caughtError = e, this._hasCaughtError = !0
                }
            }).apply(p, arguments)
        },
        invokeGuardedCallbackAndCatchFirstError: function(e, t, n, r, i, o, a, s, c) {
            if (p.invokeGuardedCallback.apply(this, arguments), p.hasCaughtError()) {
                var u = p.clearCaughtError();
                p._hasRethrowError || (p._hasRethrowError = !0, p._rethrowError = u)
            }
        },
        rethrowCaughtError: function() {
            return function() {
                if (p._hasRethrowError) {
                    var e = p._rethrowError;
                    throw p._rethrowError = null, p._hasRethrowError = !1, e
                }
            }.apply(p, arguments)
        },
        hasCaughtError: function() {
            return p._hasCaughtError
        },
        clearCaughtError: function() {
            if (p._hasCaughtError) {
                var e = p._caughtError;
                return p._caughtError = null, p._hasCaughtError = !1, e
            }
            f("198")
        }
    };
    var m = null,
        g = {};

    function h() {
        if (m)
            for (var e in g) {
                var t = g[e],
                    n = m.indexOf(e);
                if (-1 < n || f("96", e), !v[n])
                    for (var r in t.extractEvents || f("97", e), v[n] = t, n = t.eventTypes) {
                        var i = void 0,
                            o = n[r],
                            a = t,
                            s = r;
                        b.hasOwnProperty(s) && f("99", s), b[s] = o;
                        var c = o.phasedRegistrationNames;
                        if (c) {
                            for (i in c) c.hasOwnProperty(i) && _(c[i], a, s);
                            i = !0
                        } else o.registrationName ? (_(o.registrationName, a, s), i = !0) : i = !1;
                        i || f("98", r, e)
                    }
            }
    }

    function _(e, t, n) {
        y[e] && f("100", e), y[e] = t, w[e] = t.eventTypes[n].dependencies
    }
    var v = [],
        b = {},
        y = {},
        w = {};

    function O(e) {
        m && f("101"), m = Array.prototype.slice.call(e), h()
    }

    function C(e) {
        var t, n = !1;
        for (t in e)
            if (e.hasOwnProperty(t)) {
                var r = e[t];
                g.hasOwnProperty(t) && g[t] === r || (g[t] && f("102", t), g[t] = r, n = !0)
            }
        n && h()
    }
    var k = {
            plugins: v,
            eventNameDispatchConfigs: b,
            registrationNameModules: y,
            registrationNameDependencies: w,
            possibleRegistrationNames: null,
            injectEventPluginOrder: O,
            injectEventPluginsByName: C
        },
        E = null,
        j = null,
        S = null;

    function T(e, t, n, r) {
        t = e.type || "unknown-event", e.currentTarget = S(r), p.invokeGuardedCallbackAndCatchFirstError(t, n, void 0, e), e.currentTarget = null
    }

    function I(e, t) {
        return null == t && f("30"), null == e ? t : Array.isArray(e) ? Array.isArray(t) ? (e.push.apply(e, t), e) : (e.push(t), e) : Array.isArray(t) ? [e].concat(t) : [e, t]
    }

    function P(e, t, n) {
        Array.isArray(e) ? e.forEach(t, n) : e && t.call(n, e)
    }
    var M = null;

    function x(e, t) {
        if (e) {
            var n = e._dispatchListeners,
                r = e._dispatchInstances;
            if (Array.isArray(n))
                for (var i = 0; i < n.length && !e.isPropagationStopped(); i++) T(e, t, n[i], r[i]);
            else n && T(e, t, n, r);
            e._dispatchListeners = null, e._dispatchInstances = null, e.isPersistent() || e.constructor.release(e)
        }
    }

    function L(e) {
        return x(e, !0)
    }

    function A(e) {
        return x(e, !1)
    }
    var N = {
        injectEventPluginOrder: O,
        injectEventPluginsByName: C
    };

    function D(e, t) {
        var n = e.stateNode;
        if (!n) return null;
        var r = E(n);
        if (!r) return null;
        n = r[t];
        e: switch (t) {
            case "onClick":
            case "onClickCapture":
            case "onDoubleClick":
            case "onDoubleClickCapture":
            case "onMouseDown":
            case "onMouseDownCapture":
            case "onMouseMove":
            case "onMouseMoveCapture":
            case "onMouseUp":
            case "onMouseUpCapture":
                (r = !r.disabled) || (r = !("button" === (e = e.type) || "input" === e || "select" === e || "textarea" === e)), e = !r;
                break e;
            default:
                e = !1
        }
        return e ? null : (n && "function" != typeof n && f("231", t, typeof n), n)
    }

    function R(e, t) {
        null !== e && (M = I(M, e)), e = M, M = null, e && (P(e, t ? L : A), M && f("95"), p.rethrowCaughtError())
    }

    function F(e, t, n, r) {
        for (var i = null, o = 0; o < v.length; o++) {
            var a = v[o];
            a && (a = a.extractEvents(e, t, n, r)) && (i = I(i, a))
        }
        R(i, !1)
    }
    var B = {
            injection: N,
            getListener: D,
            runEventsInBatch: R,
            runExtractedEventsInBatch: F
        },
        H = Math.random().toString(36).slice(2),
        U = "__reactInternalInstance$" + H,
        z = "__reactEventHandlers$" + H;

    function G(e) {
        if (e[U]) return e[U];
        for (; !e[U];) {
            if (!e.parentNode) return null;
            e = e.parentNode
        }
        return 5 === (e = e[U]).tag || 6 === e.tag ? e : null
    }

    function W(e) {
        if (5 === e.tag || 6 === e.tag) return e.stateNode;
        f("33")
    }

    function V(e) {
        return e[z] || null
    }
    var K = {
        precacheFiberNode: function(e, t) {
            t[U] = e
        },
        getClosestInstanceFromNode: G,
        getInstanceFromNode: function(e) {
            return !(e = e[U]) || 5 !== e.tag && 6 !== e.tag ? null : e
        },
        getNodeFromInstance: W,
        getFiberCurrentPropsFromNode: V,
        updateFiberProps: function(e, t) {
            e[z] = t
        }
    };

    function q(e) {
        do {
            e = e.return
        } while (e && 5 !== e.tag);
        return e || null
    }

    function Q(e, t, n) {
        for (var r = []; e;) r.push(e), e = q(e);
        for (e = r.length; 0 < e--;) t(r[e], "captured", n);
        for (e = 0; e < r.length; e++) t(r[e], "bubbled", n)
    }

    function $(e, t, n) {
        (t = D(e, n.dispatchConfig.phasedRegistrationNames[t])) && (n._dispatchListeners = I(n._dispatchListeners, t), n._dispatchInstances = I(n._dispatchInstances, e))
    }

    function Y(e) {
        e && e.dispatchConfig.phasedRegistrationNames && Q(e._targetInst, $, e)
    }

    function X(e) {
        if (e && e.dispatchConfig.phasedRegistrationNames) {
            var t = e._targetInst;
            Q(t = t ? q(t) : null, $, e)
        }
    }

    function Z(e, t, n) {
        e && n && n.dispatchConfig.registrationName && (t = D(e, n.dispatchConfig.registrationName)) && (n._dispatchListeners = I(n._dispatchListeners, t), n._dispatchInstances = I(n._dispatchInstances, e))
    }

    function J(e) {
        e && e.dispatchConfig.registrationName && Z(e._targetInst, null, e)
    }

    function ee(e) {
        P(e, Y)
    }

    function te(e, t, n, r) {
        if (n && r) e: {
            for (var i = n, o = r, a = 0, s = i; s; s = q(s)) a++;s = 0;
            for (var c = o; c; c = q(c)) s++;
            for (; 0 < a - s;) i = q(i),
            a--;
            for (; 0 < s - a;) o = q(o),
            s--;
            for (; a--;) {
                if (i === o || i === o.alternate) break e;
                i = q(i), o = q(o)
            }
            i = null
        }
        else i = null;
        for (o = i, i = []; n && n !== o && (null === (a = n.alternate) || a !== o);) i.push(n), n = q(n);
        for (n = []; r && r !== o && (null === (a = r.alternate) || a !== o);) n.push(r), r = q(r);
        for (r = 0; r < i.length; r++) Z(i[r], "bubbled", e);
        for (e = n.length; 0 < e--;) Z(n[e], "captured", t)
    }
    var ne = {
        accumulateTwoPhaseDispatches: ee,
        accumulateTwoPhaseDispatchesSkipTarget: function(e) {
            P(e, X)
        },
        accumulateEnterLeaveDispatches: te,
        accumulateDirectDispatches: function(e) {
            P(e, J)
        }
    };

    function re(e, t) {
        var n = {};
        return n[e.toLowerCase()] = t.toLowerCase(), n["Webkit" + e] = "webkit" + t, n["Moz" + e] = "moz" + t, n["ms" + e] = "MS" + t, n["O" + e] = "o" + t.toLowerCase(), n
    }
    var ie = {
            animationend: re("Animation", "AnimationEnd"),
            animationiteration: re("Animation", "AnimationIteration"),
            animationstart: re("Animation", "AnimationStart"),
            transitionend: re("Transition", "TransitionEnd")
        },
        oe = {},
        ae = {};

    function se(e) {
        if (oe[e]) return oe[e];
        if (!ie[e]) return e;
        var t, n = ie[e];
        for (t in n)
            if (n.hasOwnProperty(t) && t in ae) return oe[e] = n[t];
        return e
    }
    o.canUseDOM && (ae = document.createElement("div").style, "AnimationEvent" in window || (delete ie.animationend.animation, delete ie.animationiteration.animation, delete ie.animationstart.animation), "TransitionEvent" in window || delete ie.transitionend.transition);
    var ce = se("animationend"),
        ue = se("animationiteration"),
        le = se("animationstart"),
        de = se("transitionend"),
        fe = "abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),
        pe = null;

    function me() {
        return !pe && o.canUseDOM && (pe = "textContent" in document.documentElement ? "textContent" : "innerText"), pe
    }
    var ge = {
        _root: null,
        _startText: null,
        _fallbackText: null
    };

    function he() {
        if (ge._fallbackText) return ge._fallbackText;
        var e, t, n = ge._startText,
            r = n.length,
            i = _e(),
            o = i.length;
        for (e = 0; e < r && n[e] === i[e]; e++);
        var a = r - e;
        for (t = 1; t <= a && n[r - t] === i[o - t]; t++);
        return ge._fallbackText = i.slice(e, 1 < t ? 1 - t : void 0), ge._fallbackText
    }

    function _e() {
        return "value" in ge._root ? ge._root.value : ge._root[me()]
    }
    var ve = "dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances".split(" "),
        be = {
            type: null,
            target: null,
            currentTarget: s.thatReturnsNull,
            eventPhase: null,
            bubbles: null,
            cancelable: null,
            timeStamp: function(e) {
                return e.timeStamp || Date.now()
            },
            defaultPrevented: null,
            isTrusted: null
        };

    function ye(e, t, n, r) {
        for (var i in this.dispatchConfig = e, this._targetInst = t, this.nativeEvent = n, e = this.constructor.Interface) e.hasOwnProperty(i) && ((t = e[i]) ? this[i] = t(n) : "target" === i ? this.target = r : this[i] = n[i]);
        return this.isDefaultPrevented = (null != n.defaultPrevented ? n.defaultPrevented : !1 === n.returnValue) ? s.thatReturnsTrue : s.thatReturnsFalse, this.isPropagationStopped = s.thatReturnsFalse, this
    }

    function we(e, t, n, r) {
        if (this.eventPool.length) {
            var i = this.eventPool.pop();
            return this.call(i, e, t, n, r), i
        }
        return new this(e, t, n, r)
    }

    function Oe(e) {
        e instanceof this || f("223"), e.destructor(), 10 > this.eventPool.length && this.eventPool.push(e)
    }

    function Ce(e) {
        e.eventPool = [], e.getPooled = we, e.release = Oe
    }
    a(ye.prototype, {
        preventDefault: function() {
            this.defaultPrevented = !0;
            var e = this.nativeEvent;
            e && (e.preventDefault ? e.preventDefault() : "unknown" != typeof e.returnValue && (e.returnValue = !1), this.isDefaultPrevented = s.thatReturnsTrue)
        },
        stopPropagation: function() {
            var e = this.nativeEvent;
            e && (e.stopPropagation ? e.stopPropagation() : "unknown" != typeof e.cancelBubble && (e.cancelBubble = !0), this.isPropagationStopped = s.thatReturnsTrue)
        },
        persist: function() {
            this.isPersistent = s.thatReturnsTrue
        },
        isPersistent: s.thatReturnsFalse,
        destructor: function() {
            var e, t = this.constructor.Interface;
            for (e in t) this[e] = null;
            for (t = 0; t < ve.length; t++) this[ve[t]] = null
        }
    }), ye.Interface = be, ye.extend = function(e) {
        function t() {}

        function n() {
            return r.apply(this, arguments)
        }
        var r = this;
        t.prototype = r.prototype;
        var i = new t;
        return a(i, n.prototype), n.prototype = i, n.prototype.constructor = n, n.Interface = a({}, r.Interface, e), n.extend = r.extend, Ce(n), n
    }, Ce(ye);
    var ke = ye.extend({
            data: null
        }),
        Ee = ye.extend({
            data: null
        }),
        je = [9, 13, 27, 32],
        Se = o.canUseDOM && "CompositionEvent" in window,
        Te = null;
    o.canUseDOM && "documentMode" in document && (Te = document.documentMode);
    var Ie = o.canUseDOM && "TextEvent" in window && !Te,
        Pe = o.canUseDOM && (!Se || Te && 8 < Te && 11 >= Te),
        Me = String.fromCharCode(32),
        xe = {
            beforeInput: {
                phasedRegistrationNames: {
                    bubbled: "onBeforeInput",
                    captured: "onBeforeInputCapture"
                },
                dependencies: ["compositionend", "keypress", "textInput", "paste"]
            },
            compositionEnd: {
                phasedRegistrationNames: {
                    bubbled: "onCompositionEnd",
                    captured: "onCompositionEndCapture"
                },
                dependencies: "blur compositionend keydown keypress keyup mousedown".split(" ")
            },
            compositionStart: {
                phasedRegistrationNames: {
                    bubbled: "onCompositionStart",
                    captured: "onCompositionStartCapture"
                },
                dependencies: "blur compositionstart keydown keypress keyup mousedown".split(" ")
            },
            compositionUpdate: {
                phasedRegistrationNames: {
                    bubbled: "onCompositionUpdate",
                    captured: "onCompositionUpdateCapture"
                },
                dependencies: "blur compositionupdate keydown keypress keyup mousedown".split(" ")
            }
        },
        Le = !1;

    function Ae(e, t) {
        switch (e) {
            case "keyup":
                return -1 !== je.indexOf(t.keyCode);
            case "keydown":
                return 229 !== t.keyCode;
            case "keypress":
            case "mousedown":
            case "blur":
                return !0;
            default:
                return !1
        }
    }

    function Ne(e) {
        return "object" == typeof(e = e.detail) && "data" in e ? e.data : null
    }
    var De = !1;
    var Re = {
            eventTypes: xe,
            extractEvents: function(e, t, n, r) {
                var i = void 0,
                    o = void 0;
                if (Se) e: {
                    switch (e) {
                        case "compositionstart":
                            i = xe.compositionStart;
                            break e;
                        case "compositionend":
                            i = xe.compositionEnd;
                            break e;
                        case "compositionupdate":
                            i = xe.compositionUpdate;
                            break e
                    }
                    i = void 0
                }
                else De ? Ae(e, n) && (i = xe.compositionEnd) : "keydown" === e && 229 === n.keyCode && (i = xe.compositionStart);
                return i ? (Pe && (De || i !== xe.compositionStart ? i === xe.compositionEnd && De && (o = he()) : (ge._root = r, ge._startText = _e(), De = !0)), i = ke.getPooled(i, t, n, r), o ? i.data = o : null !== (o = Ne(n)) && (i.data = o), ee(i), o = i) : o = null, (e = Ie ? function(e, t) {
                    switch (e) {
                        case "compositionend":
                            return Ne(t);
                        case "keypress":
                            return 32 !== t.which ? null : (Le = !0, Me);
                        case "textInput":
                            return (e = t.data) === Me && Le ? null : e;
                        default:
                            return null
                    }
                }(e, n) : function(e, t) {
                    if (De) return "compositionend" === e || !Se && Ae(e, t) ? (e = he(), ge._root = null, ge._startText = null, ge._fallbackText = null, De = !1, e) : null;
                    switch (e) {
                        case "paste":
                            return null;
                        case "keypress":
                            if (!(t.ctrlKey || t.altKey || t.metaKey) || t.ctrlKey && t.altKey) {
                                if (t.char && 1 < t.char.length) return t.char;
                                if (t.which) return String.fromCharCode(t.which)
                            }
                            return null;
                        case "compositionend":
                            return Pe ? null : t.data;
                        default:
                            return null
                    }
                }(e, n)) ? ((t = Ee.getPooled(xe.beforeInput, t, n, r)).data = e, ee(t)) : t = null, null === o ? t : null === t ? o : [o, t]
            }
        },
        Fe = null,
        Be = {
            injectFiberControlledHostComponent: function(e) {
                Fe = e
            }
        },
        He = null,
        Ue = null;

    function ze(e) {
        if (e = j(e)) {
            Fe && "function" == typeof Fe.restoreControlledState || f("194");
            var t = E(e.stateNode);
            Fe.restoreControlledState(e.stateNode, e.type, t)
        }
    }

    function Ge(e) {
        He ? Ue ? Ue.push(e) : Ue = [e] : He = e
    }

    function We() {
        return null !== He || null !== Ue
    }

    function Ve() {
        if (He) {
            var e = He,
                t = Ue;
            if (Ue = He = null, ze(e), t)
                for (e = 0; e < t.length; e++) ze(t[e])
        }
    }
    var Ke = {
        injection: Be,
        enqueueStateRestore: Ge,
        needsStateRestore: We,
        restoreStateIfNeeded: Ve
    };

    function qe(e, t) {
        return e(t)
    }

    function Qe(e, t, n) {
        return e(t, n)
    }

    function $e() {}
    var Ye = !1;

    function Xe(e, t) {
        if (Ye) return e(t);
        Ye = !0;
        try {
            return qe(e, t)
        } finally {
            Ye = !1, We() && ($e(), Ve())
        }
    }
    var Ze = {
        color: !0,
        date: !0,
        datetime: !0,
        "datetime-local": !0,
        email: !0,
        month: !0,
        number: !0,
        password: !0,
        range: !0,
        search: !0,
        tel: !0,
        text: !0,
        time: !0,
        url: !0,
        week: !0
    };

    function Je(e) {
        var t = e && e.nodeName && e.nodeName.toLowerCase();
        return "input" === t ? !!Ze[e.type] : "textarea" === t
    }

    function et(e) {
        return (e = e.target || window).correspondingUseElement && (e = e.correspondingUseElement), 3 === e.nodeType ? e.parentNode : e
    }

    function tt(e, t) {
        return !(!o.canUseDOM || t && !("addEventListener" in document)) && ((t = (e = "on" + e) in document) || ((t = document.createElement("div")).setAttribute(e, "return;"), t = "function" == typeof t[e]), t)
    }

    function nt(e) {
        var t = e.type;
        return (e = e.nodeName) && "input" === e.toLowerCase() && ("checkbox" === t || "radio" === t)
    }

    function rt(e) {
        e._valueTracker || (e._valueTracker = function(e) {
            var t = nt(e) ? "checked" : "value",
                n = Object.getOwnPropertyDescriptor(e.constructor.prototype, t),
                r = "" + e[t];
            if (!e.hasOwnProperty(t) && void 0 !== n && "function" == typeof n.get && "function" == typeof n.set) {
                var i = n.get,
                    o = n.set;
                return Object.defineProperty(e, t, {
                    configurable: !0,
                    get: function() {
                        return i.call(this)
                    },
                    set: function(e) {
                        r = "" + e, o.call(this, e)
                    }
                }), Object.defineProperty(e, t, {
                    enumerable: n.enumerable
                }), {
                    getValue: function() {
                        return r
                    },
                    setValue: function(e) {
                        r = "" + e
                    },
                    stopTracking: function() {
                        e._valueTracker = null, delete e[t]
                    }
                }
            }
        }(e))
    }

    function it(e) {
        if (!e) return !1;
        var t = e._valueTracker;
        if (!t) return !0;
        var n = t.getValue(),
            r = "";
        return e && (r = nt(e) ? e.checked ? "true" : "false" : e.value), (e = r) !== n && (t.setValue(e), !0)
    }
    var ot = i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,
        at = "function" == typeof Symbol && Symbol.for,
        st = at ? Symbol.for("react.element") : 60103,
        ct = at ? Symbol.for("react.portal") : 60106,
        ut = at ? Symbol.for("react.fragment") : 60107,
        lt = at ? Symbol.for("react.strict_mode") : 60108,
        dt = at ? Symbol.for("react.profiler") : 60114,
        ft = at ? Symbol.for("react.provider") : 60109,
        pt = at ? Symbol.for("react.context") : 60110,
        mt = at ? Symbol.for("react.async_mode") : 60111,
        gt = at ? Symbol.for("react.forward_ref") : 60112,
        ht = at ? Symbol.for("react.timeout") : 60113,
        _t = "function" == typeof Symbol && Symbol.iterator;

    function vt(e) {
        return null === e || void 0 === e ? null : "function" == typeof(e = _t && e[_t] || e["@@iterator"]) ? e : null
    }

    function bt(e) {
        var t = e.type;
        if ("function" == typeof t) return t.displayName || t.name;
        if ("string" == typeof t) return t;
        switch (t) {
            case mt:
                return "AsyncMode";
            case pt:
                return "Context.Consumer";
            case ut:
                return "ReactFragment";
            case ct:
                return "ReactPortal";
            case dt:
                return "Profiler(" + e.pendingProps.id + ")";
            case ft:
                return "Context.Provider";
            case lt:
                return "StrictMode";
            case ht:
                return "Timeout"
        }
        if ("object" == typeof t && null !== t) switch (t.$$typeof) {
            case gt:
                return "" !== (e = t.render.displayName || t.render.name || "") ? "ForwardRef(" + e + ")" : "ForwardRef"
        }
        return null
    }

    function yt(e) {
        var t = "";
        do {
            e: switch (e.tag) {
                case 0:
                case 1:
                case 2:
                case 5:
                    var n = e._debugOwner,
                        r = e._debugSource,
                        i = bt(e),
                        o = null;
                    n && (o = bt(n)), n = r, i = "\n    in " + (i || "Unknown") + (n ? " (at " + n.fileName.replace(/^.*[\\\/]/, "") + ":" + n.lineNumber + ")" : o ? " (created by " + o + ")" : "");
                    break e;
                default:
                    i = ""
            }
            t += i,
            e = e.return
        } while (e);
        return t
    }
    var wt = /^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,
        Ot = {},
        Ct = {};

    function kt(e, t, n, r, i) {
        this.acceptsBooleans = 2 === t || 3 === t || 4 === t, this.attributeName = r, this.attributeNamespace = i, this.mustUseProperty = n, this.propertyName = e, this.type = t
    }
    var Et = {};
    "children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e) {
        Et[e] = new kt(e, 0, !1, e, null)
    }), [
        ["acceptCharset", "accept-charset"],
        ["className", "class"],
        ["htmlFor", "for"],
        ["httpEquiv", "http-equiv"]
    ].forEach(function(e) {
        var t = e[0];
        Et[t] = new kt(t, 1, !1, e[1], null)
    }), ["contentEditable", "draggable", "spellCheck", "value"].forEach(function(e) {
        Et[e] = new kt(e, 2, !1, e.toLowerCase(), null)
    }), ["autoReverse", "externalResourcesRequired", "preserveAlpha"].forEach(function(e) {
        Et[e] = new kt(e, 2, !1, e, null)
    }), "allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e) {
        Et[e] = new kt(e, 3, !1, e.toLowerCase(), null)
    }), ["checked", "multiple", "muted", "selected"].forEach(function(e) {
        Et[e] = new kt(e, 3, !0, e.toLowerCase(), null)
    }), ["capture", "download"].forEach(function(e) {
        Et[e] = new kt(e, 4, !1, e.toLowerCase(), null)
    }), ["cols", "rows", "size", "span"].forEach(function(e) {
        Et[e] = new kt(e, 6, !1, e.toLowerCase(), null)
    }), ["rowSpan", "start"].forEach(function(e) {
        Et[e] = new kt(e, 5, !1, e.toLowerCase(), null)
    });
    var jt = /[\-:]([a-z])/g;

    function St(e) {
        return e[1].toUpperCase()
    }

    function Tt(e, t, n, r) {
        var i = Et.hasOwnProperty(t) ? Et[t] : null;
        (null !== i ? 0 === i.type : !r && (2 < t.length && ("o" === t[0] || "O" === t[0]) && ("n" === t[1] || "N" === t[1]))) || (function(e, t, n, r) {
            if (null === t || void 0 === t || function(e, t, n, r) {
                    if (null !== n && 0 === n.type) return !1;
                    switch (typeof t) {
                        case "function":
                        case "symbol":
                            return !0;
                        case "boolean":
                            return !r && (null !== n ? !n.acceptsBooleans : "data-" !== (e = e.toLowerCase().slice(0, 5)) && "aria-" !== e);
                        default:
                            return !1
                    }
                }(e, t, n, r)) return !0;
            if (r) return !1;
            if (null !== n) switch (n.type) {
                case 3:
                    return !t;
                case 4:
                    return !1 === t;
                case 5:
                    return isNaN(t);
                case 6:
                    return isNaN(t) || 1 > t
            }
            return !1
        }(t, n, i, r) && (n = null), r || null === i ? function(e) {
            return !!Ct.hasOwnProperty(e) || !Ot.hasOwnProperty(e) && (wt.test(e) ? Ct[e] = !0 : (Ot[e] = !0, !1))
        }(t) && (null === n ? e.removeAttribute(t) : e.setAttribute(t, "" + n)) : i.mustUseProperty ? e[i.propertyName] = null === n ? 3 !== i.type && "" : n : (t = i.attributeName, r = i.attributeNamespace, null === n ? e.removeAttribute(t) : (n = 3 === (i = i.type) || 4 === i && !0 === n ? "" : "" + n, r ? e.setAttributeNS(r, t, n) : e.setAttribute(t, n))))
    }

    function It(e, t) {
        var n = t.checked;
        return a({}, t, {
            defaultChecked: void 0,
            defaultValue: void 0,
            value: void 0,
            checked: null != n ? n : e._wrapperState.initialChecked
        })
    }

    function Pt(e, t) {
        var n = null == t.defaultValue ? "" : t.defaultValue,
            r = null != t.checked ? t.checked : t.defaultChecked;
        n = Nt(null != t.value ? t.value : n), e._wrapperState = {
            initialChecked: r,
            initialValue: n,
            controlled: "checkbox" === t.type || "radio" === t.type ? null != t.checked : null != t.value
        }
    }

    function Mt(e, t) {
        null != (t = t.checked) && Tt(e, "checked", t, !1)
    }

    function xt(e, t) {
        Mt(e, t);
        var n = Nt(t.value);
        null != n && ("number" === t.type ? (0 === n && "" === e.value || e.value != n) && (e.value = "" + n) : e.value !== "" + n && (e.value = "" + n)), t.hasOwnProperty("value") ? At(e, t.type, n) : t.hasOwnProperty("defaultValue") && At(e, t.type, Nt(t.defaultValue)), null == t.checked && null != t.defaultChecked && (e.defaultChecked = !!t.defaultChecked)
    }

    function Lt(e, t) {
        (t.hasOwnProperty("value") || t.hasOwnProperty("defaultValue")) && ("" === e.value && (e.value = "" + e._wrapperState.initialValue), e.defaultValue = "" + e._wrapperState.initialValue), "" !== (t = e.name) && (e.name = ""), e.defaultChecked = !e.defaultChecked, e.defaultChecked = !e.defaultChecked, "" !== t && (e.name = t)
    }

    function At(e, t, n) {
        "number" === t && e.ownerDocument.activeElement === e || (null == n ? e.defaultValue = "" + e._wrapperState.initialValue : e.defaultValue !== "" + n && (e.defaultValue = "" + n))
    }

    function Nt(e) {
        switch (typeof e) {
            case "boolean":
            case "number":
            case "object":
            case "string":
            case "undefined":
                return e;
            default:
                return ""
        }
    }
    "accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e) {
        var t = e.replace(jt, St);
        Et[t] = new kt(t, 1, !1, e, null)
    }), "xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e) {
        var t = e.replace(jt, St);
        Et[t] = new kt(t, 1, !1, e, "http://www.w3.org/1999/xlink")
    }), ["xml:base", "xml:lang", "xml:space"].forEach(function(e) {
        var t = e.replace(jt, St);
        Et[t] = new kt(t, 1, !1, e, "http://www.w3.org/XML/1998/namespace")
    }), Et.tabIndex = new kt("tabIndex", 1, !1, "tabindex", null);
    var Dt = {
        change: {
            phasedRegistrationNames: {
                bubbled: "onChange",
                captured: "onChangeCapture"
            },
            dependencies: "blur change click focus input keydown keyup selectionchange".split(" ")
        }
    };

    function Rt(e, t, n) {
        return (e = ye.getPooled(Dt.change, e, t, n)).type = "change", Ge(n), ee(e), e
    }
    var Ft = null,
        Bt = null;

    function Ht(e) {
        R(e, !1)
    }

    function Ut(e) {
        if (it(W(e))) return e
    }

    function zt(e, t) {
        if ("change" === e) return t
    }
    var Gt = !1;

    function Wt() {
        Ft && (Ft.detachEvent("onpropertychange", Vt), Bt = Ft = null)
    }

    function Vt(e) {
        "value" === e.propertyName && Ut(Bt) && Xe(Ht, e = Rt(Bt, e, et(e)))
    }

    function Kt(e, t, n) {
        "focus" === e ? (Wt(), Bt = n, (Ft = t).attachEvent("onpropertychange", Vt)) : "blur" === e && Wt()
    }

    function qt(e) {
        if ("selectionchange" === e || "keyup" === e || "keydown" === e) return Ut(Bt)
    }

    function Qt(e, t) {
        if ("click" === e) return Ut(t)
    }

    function $t(e, t) {
        if ("input" === e || "change" === e) return Ut(t)
    }
    o.canUseDOM && (Gt = tt("input") && (!document.documentMode || 9 < document.documentMode));
    var Yt = {
            eventTypes: Dt,
            _isInputEventSupported: Gt,
            extractEvents: function(e, t, n, r) {
                var i = t ? W(t) : window,
                    o = void 0,
                    a = void 0,
                    s = i.nodeName && i.nodeName.toLowerCase();
                if ("select" === s || "input" === s && "file" === i.type ? o = zt : Je(i) ? Gt ? o = $t : (o = qt, a = Kt) : (s = i.nodeName) && "input" === s.toLowerCase() && ("checkbox" === i.type || "radio" === i.type) && (o = Qt), o && (o = o(e, t))) return Rt(o, n, r);
                a && a(e, i, t), "blur" === e && null != t && (e = t._wrapperState || i._wrapperState) && e.controlled && "number" === i.type && At(i, "number", i.value)
            }
        },
        Xt = ye.extend({
            view: null,
            detail: null
        }),
        Zt = {
            Alt: "altKey",
            Control: "ctrlKey",
            Meta: "metaKey",
            Shift: "shiftKey"
        };

    function Jt(e) {
        var t = this.nativeEvent;
        return t.getModifierState ? t.getModifierState(e) : !!(e = Zt[e]) && !!t[e]
    }

    function en() {
        return Jt
    }
    var tn = Xt.extend({
            screenX: null,
            screenY: null,
            clientX: null,
            clientY: null,
            pageX: null,
            pageY: null,
            ctrlKey: null,
            shiftKey: null,
            altKey: null,
            metaKey: null,
            getModifierState: en,
            button: null,
            buttons: null,
            relatedTarget: function(e) {
                return e.relatedTarget || (e.fromElement === e.srcElement ? e.toElement : e.fromElement)
            }
        }),
        nn = tn.extend({
            pointerId: null,
            width: null,
            height: null,
            pressure: null,
            tiltX: null,
            tiltY: null,
            pointerType: null,
            isPrimary: null
        }),
        rn = {
            mouseEnter: {
                registrationName: "onMouseEnter",
                dependencies: ["mouseout", "mouseover"]
            },
            mouseLeave: {
                registrationName: "onMouseLeave",
                dependencies: ["mouseout", "mouseover"]
            },
            pointerEnter: {
                registrationName: "onPointerEnter",
                dependencies: ["pointerout", "pointerover"]
            },
            pointerLeave: {
                registrationName: "onPointerLeave",
                dependencies: ["pointerout", "pointerover"]
            }
        },
        on = {
            eventTypes: rn,
            extractEvents: function(e, t, n, r) {
                var i = "mouseover" === e || "pointerover" === e,
                    o = "mouseout" === e || "pointerout" === e;
                if (i && (n.relatedTarget || n.fromElement) || !o && !i) return null;
                if (i = r.window === r ? r : (i = r.ownerDocument) ? i.defaultView || i.parentWindow : window, o ? (o = t, t = (t = n.relatedTarget || n.toElement) ? G(t) : null) : o = null, o === t) return null;
                var a = void 0,
                    s = void 0,
                    c = void 0,
                    u = void 0;
                return "mouseout" === e || "mouseover" === e ? (a = tn, s = rn.mouseLeave, c = rn.mouseEnter, u = "mouse") : "pointerout" !== e && "pointerover" !== e || (a = nn, s = rn.pointerLeave, c = rn.pointerEnter, u = "pointer"), e = null == o ? i : W(o), i = null == t ? i : W(t), (s = a.getPooled(s, o, n, r)).type = u + "leave", s.target = e, s.relatedTarget = i, (n = a.getPooled(c, t, n, r)).type = u + "enter", n.target = i, n.relatedTarget = e, te(s, n, o, t), [s, n]
            }
        };

    function an(e) {
        var t = e;
        if (e.alternate)
            for (; t.return;) t = t.return;
        else {
            if (0 != (2 & t.effectTag)) return 1;
            for (; t.return;)
                if (0 != (2 & (t = t.return).effectTag)) return 1
        }
        return 3 === t.tag ? 2 : 3
    }

    function sn(e) {
        2 !== an(e) && f("188")
    }

    function cn(e) {
        var t = e.alternate;
        if (!t) return 3 === (t = an(e)) && f("188"), 1 === t ? null : e;
        for (var n = e, r = t;;) {
            var i = n.return,
                o = i ? i.alternate : null;
            if (!i || !o) break;
            if (i.child === o.child) {
                for (var a = i.child; a;) {
                    if (a === n) return sn(i), e;
                    if (a === r) return sn(i), t;
                    a = a.sibling
                }
                f("188")
            }
            if (n.return !== r.return) n = i, r = o;
            else {
                a = !1;
                for (var s = i.child; s;) {
                    if (s === n) {
                        a = !0, n = i, r = o;
                        break
                    }
                    if (s === r) {
                        a = !0, r = i, n = o;
                        break
                    }
                    s = s.sibling
                }
                if (!a) {
                    for (s = o.child; s;) {
                        if (s === n) {
                            a = !0, n = o, r = i;
                            break
                        }
                        if (s === r) {
                            a = !0, r = o, n = i;
                            break
                        }
                        s = s.sibling
                    }
                    a || f("189")
                }
            }
            n.alternate !== r && f("190")
        }
        return 3 !== n.tag && f("188"), n.stateNode.current === n ? e : t
    }

    function un(e) {
        if (!(e = cn(e))) return null;
        for (var t = e;;) {
            if (5 === t.tag || 6 === t.tag) return t;
            if (t.child) t.child.return = t, t = t.child;
            else {
                if (t === e) break;
                for (; !t.sibling;) {
                    if (!t.return || t.return === e) return null;
                    t = t.return
                }
                t.sibling.return = t.return, t = t.sibling
            }
        }
        return null
    }
    var ln = ye.extend({
            animationName: null,
            elapsedTime: null,
            pseudoElement: null
        }),
        dn = ye.extend({
            clipboardData: function(e) {
                return "clipboardData" in e ? e.clipboardData : window.clipboardData
            }
        }),
        fn = Xt.extend({
            relatedTarget: null
        });

    function pn(e) {
        var t = e.keyCode;
        return "charCode" in e ? 0 === (e = e.charCode) && 13 === t && (e = 13) : e = t, 10 === e && (e = 13), 32 <= e || 13 === e ? e : 0
    }
    var mn = {
            Esc: "Escape",
            Spacebar: " ",
            Left: "ArrowLeft",
            Up: "ArrowUp",
            Right: "ArrowRight",
            Down: "ArrowDown",
            Del: "Delete",
            Win: "OS",
            Menu: "ContextMenu",
            Apps: "ContextMenu",
            Scroll: "ScrollLock",
            MozPrintableKey: "Unidentified"
        },
        gn = {
            8: "Backspace",
            9: "Tab",
            12: "Clear",
            13: "Enter",
            16: "Shift",
            17: "Control",
            18: "Alt",
            19: "Pause",
            20: "CapsLock",
            27: "Escape",
            32: " ",
            33: "PageUp",
            34: "PageDown",
            35: "End",
            36: "Home",
            37: "ArrowLeft",
            38: "ArrowUp",
            39: "ArrowRight",
            40: "ArrowDown",
            45: "Insert",
            46: "Delete",
            112: "F1",
            113: "F2",
            114: "F3",
            115: "F4",
            116: "F5",
            117: "F6",
            118: "F7",
            119: "F8",
            120: "F9",
            121: "F10",
            122: "F11",
            123: "F12",
            144: "NumLock",
            145: "ScrollLock",
            224: "Meta"
        },
        hn = Xt.extend({
            key: function(e) {
                if (e.key) {
                    var t = mn[e.key] || e.key;
                    if ("Unidentified" !== t) return t
                }
                return "keypress" === e.type ? 13 === (e = pn(e)) ? "Enter" : String.fromCharCode(e) : "keydown" === e.type || "keyup" === e.type ? gn[e.keyCode] || "Unidentified" : ""
            },
            location: null,
            ctrlKey: null,
            shiftKey: null,
            altKey: null,
            metaKey: null,
            repeat: null,
            locale: null,
            getModifierState: en,
            charCode: function(e) {
                return "keypress" === e.type ? pn(e) : 0
            },
            keyCode: function(e) {
                return "keydown" === e.type || "keyup" === e.type ? e.keyCode : 0
            },
            which: function(e) {
                return "keypress" === e.type ? pn(e) : "keydown" === e.type || "keyup" === e.type ? e.keyCode : 0
            }
        }),
        _n = tn.extend({
            dataTransfer: null
        }),
        vn = Xt.extend({
            touches: null,
            targetTouches: null,
            changedTouches: null,
            altKey: null,
            metaKey: null,
            ctrlKey: null,
            shiftKey: null,
            getModifierState: en
        }),
        bn = ye.extend({
            propertyName: null,
            elapsedTime: null,
            pseudoElement: null
        }),
        yn = tn.extend({
            deltaX: function(e) {
                return "deltaX" in e ? e.deltaX : "wheelDeltaX" in e ? -e.wheelDeltaX : 0
            },
            deltaY: function(e) {
                return "deltaY" in e ? e.deltaY : "wheelDeltaY" in e ? -e.wheelDeltaY : "wheelDelta" in e ? -e.wheelDelta : 0
            },
            deltaZ: null,
            deltaMode: null
        }),
        wn = [
            ["abort", "abort"],
            [ce, "animationEnd"],
            [ue, "animationIteration"],
            [le, "animationStart"],
            ["canplay", "canPlay"],
            ["canplaythrough", "canPlayThrough"],
            ["drag", "drag"],
            ["dragenter", "dragEnter"],
            ["dragexit", "dragExit"],
            ["dragleave", "dragLeave"],
            ["dragover", "dragOver"],
            ["durationchange", "durationChange"],
            ["emptied", "emptied"],
            ["encrypted", "encrypted"],
            ["ended", "ended"],
            ["error", "error"],
            ["gotpointercapture", "gotPointerCapture"],
            ["load", "load"],
            ["loadeddata", "loadedData"],
            ["loadedmetadata", "loadedMetadata"],
            ["loadstart", "loadStart"],
            ["lostpointercapture", "lostPointerCapture"],
            ["mousemove", "mouseMove"],
            ["mouseout", "mouseOut"],
            ["mouseover", "mouseOver"],
            ["playing", "playing"],
            ["pointermove", "pointerMove"],
            ["pointerout", "pointerOut"],
            ["pointerover", "pointerOver"],
            ["progress", "progress"],
            ["scroll", "scroll"],
            ["seeking", "seeking"],
            ["stalled", "stalled"],
            ["suspend", "suspend"],
            ["timeupdate", "timeUpdate"],
            ["toggle", "toggle"],
            ["touchmove", "touchMove"],
            [de, "transitionEnd"],
            ["waiting", "waiting"],
            ["wheel", "wheel"]
        ],
        On = {},
        Cn = {};

    function kn(e, t) {
        var n = e[0],
            r = "on" + ((e = e[1])[0].toUpperCase() + e.slice(1));
        t = {
            phasedRegistrationNames: {
                bubbled: r,
                captured: r + "Capture"
            },
            dependencies: [n],
            isInteractive: t
        }, On[e] = t, Cn[n] = t
    }[
        ["blur", "blur"],
        ["cancel", "cancel"],
        ["click", "click"],
        ["close", "close"],
        ["contextmenu", "contextMenu"],
        ["copy", "copy"],
        ["cut", "cut"],
        ["dblclick", "doubleClick"],
        ["dragend", "dragEnd"],
        ["dragstart", "dragStart"],
        ["drop", "drop"],
        ["focus", "focus"],
        ["input", "input"],
        ["invalid", "invalid"],
        ["keydown", "keyDown"],
        ["keypress", "keyPress"],
        ["keyup", "keyUp"],
        ["mousedown", "mouseDown"],
        ["mouseup", "mouseUp"],
        ["paste", "paste"],
        ["pause", "pause"],
        ["play", "play"],
        ["pointercancel", "pointerCancel"],
        ["pointerdown", "pointerDown"],
        ["pointerup", "pointerUp"],
        ["ratechange", "rateChange"],
        ["reset", "reset"],
        ["seeked", "seeked"],
        ["submit", "submit"],
        ["touchcancel", "touchCancel"],
        ["touchend", "touchEnd"],
        ["touchstart", "touchStart"],
        ["volumechange", "volumeChange"]
    ].forEach(function(e) {
        kn(e, !0)
    }), wn.forEach(function(e) {
        kn(e, !1)
    });
    var En = {
            eventTypes: On,
            isInteractiveTopLevelEventType: function(e) {
                return void 0 !== (e = Cn[e]) && !0 === e.isInteractive
            },
            extractEvents: function(e, t, n, r) {
                var i = Cn[e];
                if (!i) return null;
                switch (e) {
                    case "keypress":
                        if (0 === pn(n)) return null;
                    case "keydown":
                    case "keyup":
                        e = hn;
                        break;
                    case "blur":
                    case "focus":
                        e = fn;
                        break;
                    case "click":
                        if (2 === n.button) return null;
                    case "dblclick":
                    case "mousedown":
                    case "mousemove":
                    case "mouseup":
                    case "mouseout":
                    case "mouseover":
                    case "contextmenu":
                        e = tn;
                        break;
                    case "drag":
                    case "dragend":
                    case "dragenter":
                    case "dragexit":
                    case "dragleave":
                    case "dragover":
                    case "dragstart":
                    case "drop":
                        e = _n;
                        break;
                    case "touchcancel":
                    case "touchend":
                    case "touchmove":
                    case "touchstart":
                        e = vn;
                        break;
                    case ce:
                    case ue:
                    case le:
                        e = ln;
                        break;
                    case de:
                        e = bn;
                        break;
                    case "scroll":
                        e = Xt;
                        break;
                    case "wheel":
                        e = yn;
                        break;
                    case "copy":
                    case "cut":
                    case "paste":
                        e = dn;
                        break;
                    case "gotpointercapture":
                    case "lostpointercapture":
                    case "pointercancel":
                    case "pointerdown":
                    case "pointermove":
                    case "pointerout":
                    case "pointerover":
                    case "pointerup":
                        e = nn;
                        break;
                    default:
                        e = ye
                }
                return ee(t = e.getPooled(i, t, n, r)), t
            }
        },
        jn = En.isInteractiveTopLevelEventType,
        Sn = [];

    function Tn(e) {
        var t = e.targetInst;
        do {
            if (!t) {
                e.ancestors.push(t);
                break
            }
            var n;
            for (n = t; n.return;) n = n.return;
            if (!(n = 3 !== n.tag ? null : n.stateNode.containerInfo)) break;
            e.ancestors.push(t), t = G(n)
        } while (t);
        for (n = 0; n < e.ancestors.length; n++) t = e.ancestors[n], F(e.topLevelType, t, e.nativeEvent, et(e.nativeEvent))
    }
    var In = !0;

    function Pn(e) {
        In = !!e
    }

    function Mn(e, t) {
        if (!t) return null;
        var n = (jn(e) ? Ln : An).bind(null, e);
        t.addEventListener(e, n, !1)
    }

    function xn(e, t) {
        if (!t) return null;
        var n = (jn(e) ? Ln : An).bind(null, e);
        t.addEventListener(e, n, !0)
    }

    function Ln(e, t) {
        Qe(An, e, t)
    }

    function An(e, t) {
        if (In) {
            var n = et(t);
            if (null === (n = G(n)) || "number" != typeof n.tag || 2 === an(n) || (n = null), Sn.length) {
                var r = Sn.pop();
                r.topLevelType = e, r.nativeEvent = t, r.targetInst = n, e = r
            } else e = {
                topLevelType: e,
                nativeEvent: t,
                targetInst: n,
                ancestors: []
            };
            try {
                Xe(Tn, e)
            } finally {
                e.topLevelType = null, e.nativeEvent = null, e.targetInst = null, e.ancestors.length = 0, 10 > Sn.length && Sn.push(e)
            }
        }
    }
    var Nn = {
            get _enabled() {
                return In
            },
            setEnabled: Pn,
            isEnabled: function() {
                return In
            },
            trapBubbledEvent: Mn,
            trapCapturedEvent: xn,
            dispatchEvent: An
        },
        Dn = {},
        Rn = 0,
        Fn = "_reactListenersID" + ("" + Math.random()).slice(2);

    function Bn(e) {
        return Object.prototype.hasOwnProperty.call(e, Fn) || (e[Fn] = Rn++, Dn[e[Fn]] = {}), Dn[e[Fn]]
    }

    function Hn(e) {
        for (; e && e.firstChild;) e = e.firstChild;
        return e
    }

    function Un(e, t) {
        var n, r = Hn(e);
        for (e = 0; r;) {
            if (3 === r.nodeType) {
                if (n = e + r.textContent.length, e <= t && n >= t) return {
                    node: r,
                    offset: t - e
                };
                e = n
            }
            e: {
                for (; r;) {
                    if (r.nextSibling) {
                        r = r.nextSibling;
                        break e
                    }
                    r = r.parentNode
                }
                r = void 0
            }
            r = Hn(r)
        }
    }

    function zn(e) {
        var t = e && e.nodeName && e.nodeName.toLowerCase();
        return t && ("input" === t && "text" === e.type || "textarea" === t || "true" === e.contentEditable)
    }
    var Gn = o.canUseDOM && "documentMode" in document && 11 >= document.documentMode,
        Wn = {
            select: {
                phasedRegistrationNames: {
                    bubbled: "onSelect",
                    captured: "onSelectCapture"
                },
                dependencies: "blur contextmenu focus keydown keyup mousedown mouseup selectionchange".split(" ")
            }
        },
        Vn = null,
        Kn = null,
        qn = null,
        Qn = !1;

    function $n(e, t) {
        if (Qn || null == Vn || Vn !== c()) return null;
        var n = Vn;
        return "selectionStart" in n && zn(n) ? n = {
            start: n.selectionStart,
            end: n.selectionEnd
        } : window.getSelection ? n = {
            anchorNode: (n = window.getSelection()).anchorNode,
            anchorOffset: n.anchorOffset,
            focusNode: n.focusNode,
            focusOffset: n.focusOffset
        } : n = void 0, qn && u(qn, n) ? null : (qn = n, (e = ye.getPooled(Wn.select, Kn, e, t)).type = "select", e.target = Vn, ee(e), e)
    }
    var Yn = {
        eventTypes: Wn,
        extractEvents: function(e, t, n, r) {
            var i, o = r.window === r ? r.document : 9 === r.nodeType ? r : r.ownerDocument;
            if (!(i = !o)) {
                e: {
                    o = Bn(o),
                    i = w.onSelect;
                    for (var a = 0; a < i.length; a++) {
                        var s = i[a];
                        if (!o.hasOwnProperty(s) || !o[s]) {
                            o = !1;
                            break e
                        }
                    }
                    o = !0
                }
                i = !o
            }
            if (i) return null;
            switch (o = t ? W(t) : window, e) {
                case "focus":
                    (Je(o) || "true" === o.contentEditable) && (Vn = o, Kn = t, qn = null);
                    break;
                case "blur":
                    qn = Kn = Vn = null;
                    break;
                case "mousedown":
                    Qn = !0;
                    break;
                case "contextmenu":
                case "mouseup":
                    return Qn = !1, $n(n, r);
                case "selectionchange":
                    if (Gn) break;
                case "keydown":
                case "keyup":
                    return $n(n, r)
            }
            return null
        }
    };
    N.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")), E = K.getFiberCurrentPropsFromNode, j = K.getInstanceFromNode, S = K.getNodeFromInstance, N.injectEventPluginsByName({
        SimpleEventPlugin: En,
        EnterLeaveEventPlugin: on,
        ChangeEventPlugin: Yt,
        SelectEventPlugin: Yn,
        BeforeInputEventPlugin: Re
    });
    var Xn = void 0;
    Xn = "object" == typeof performance && "function" == typeof performance.now ? function() {
        return performance.now()
    } : function() {
        return Date.now()
    };
    var Zn = void 0,
        Jn = void 0;
    if (o.canUseDOM) {
        var er = [],
            tr = 0,
            nr = {},
            rr = -1,
            ir = !1,
            or = !1,
            ar = 0,
            sr = 33,
            cr = 33,
            ur = {
                didTimeout: !1,
                timeRemaining: function() {
                    var e = ar - Xn();
                    return 0 < e ? e : 0
                }
            },
            lr = function(e, t) {
                if (nr[t]) try {
                    e(ur)
                } finally {
                    delete nr[t]
                }
            },
            dr = "__reactIdleCallback$" + Math.random().toString(36).slice(2);
        window.addEventListener("message", function(e) {
            if (e.source === window && e.data === dr && (ir = !1, 0 !== er.length)) {
                if (0 !== er.length && (e = Xn(), !(-1 === rr || rr > e))) {
                    rr = -1, ur.didTimeout = !0;
                    for (var t = 0, n = er.length; t < n; t++) {
                        var r = er[t],
                            i = r.timeoutTime; - 1 !== i && i <= e ? lr(r.scheduledCallback, r.callbackId) : -1 !== i && (-1 === rr || i < rr) && (rr = i)
                    }
                }
                for (e = Xn(); 0 < ar - e && 0 < er.length;) e = er.shift(), ur.didTimeout = !1, lr(e.scheduledCallback, e.callbackId), e = Xn();
                0 < er.length && !or && (or = !0, requestAnimationFrame(fr))
            }
        }, !1);
        var fr = function(e) {
            or = !1;
            var t = e - ar + cr;
            t < cr && sr < cr ? (8 > t && (t = 8), cr = t < sr ? sr : t) : sr = t, ar = e + cr, ir || (ir = !0, window.postMessage(dr, "*"))
        };
        Zn = function(e, t) {
            var n = -1;
            return null != t && "number" == typeof t.timeout && (n = Xn() + t.timeout), (-1 === rr || -1 !== n && n < rr) && (rr = n), t = ++tr, er.push({
                scheduledCallback: e,
                callbackId: t,
                timeoutTime: n
            }), nr[t] = !0, or || (or = !0, requestAnimationFrame(fr)), t
        }, Jn = function(e) {
            delete nr[e]
        }
    } else {
        var pr = 0,
            mr = {};
        Zn = function(e) {
            var t = pr++,
                n = setTimeout(function() {
                    e({
                        timeRemaining: function() {
                            return 1 / 0
                        },
                        didTimeout: !1
                    })
                });
            return mr[t] = n, t
        }, Jn = function(e) {
            var t = mr[e];
            delete mr[e], clearTimeout(t)
        }
    }

    function gr(e, t) {
        return e = a({
            children: void 0
        }, t), (t = function(e) {
            var t = "";
            return i.Children.forEach(e, function(e) {
                null == e || "string" != typeof e && "number" != typeof e || (t += e)
            }), t
        }(t.children)) && (e.children = t), e
    }

    function hr(e, t, n, r) {
        if (e = e.options, t) {
            t = {};
            for (var i = 0; i < n.length; i++) t["$" + n[i]] = !0;
            for (n = 0; n < e.length; n++) i = t.hasOwnProperty("$" + e[n].value), e[n].selected !== i && (e[n].selected = i), i && r && (e[n].defaultSelected = !0)
        } else {
            for (n = "" + n, t = null, i = 0; i < e.length; i++) {
                if (e[i].value === n) return e[i].selected = !0, void(r && (e[i].defaultSelected = !0));
                null !== t || e[i].disabled || (t = e[i])
            }
            null !== t && (t.selected = !0)
        }
    }

    function _r(e, t) {
        var n = t.value;
        e._wrapperState = {
            initialValue: null != n ? n : t.defaultValue,
            wasMultiple: !!t.multiple
        }
    }

    function vr(e, t) {
        return null != t.dangerouslySetInnerHTML && f("91"), a({}, t, {
            value: void 0,
            defaultValue: void 0,
            children: "" + e._wrapperState.initialValue
        })
    }

    function br(e, t) {
        var n = t.value;
        null == n && (n = t.defaultValue, null != (t = t.children) && (null != n && f("92"), Array.isArray(t) && (1 >= t.length || f("93"), t = t[0]), n = "" + t), null == n && (n = "")), e._wrapperState = {
            initialValue: "" + n
        }
    }

    function yr(e, t) {
        var n = t.value;
        null != n && ((n = "" + n) !== e.value && (e.value = n), null == t.defaultValue && (e.defaultValue = n)), null != t.defaultValue && (e.defaultValue = t.defaultValue)
    }

    function wr(e) {
        var t = e.textContent;
        t === e._wrapperState.initialValue && (e.value = t)
    }
    var Or = {
        html: "http://www.w3.org/1999/xhtml",
        mathml: "http://www.w3.org/1998/Math/MathML",
        svg: "http://www.w3.org/2000/svg"
    };

    function Cr(e) {
        switch (e) {
            case "svg":
                return "http://www.w3.org/2000/svg";
            case "math":
                return "http://www.w3.org/1998/Math/MathML";
            default:
                return "http://www.w3.org/1999/xhtml"
        }
    }

    function kr(e, t) {
        return null == e || "http://www.w3.org/1999/xhtml" === e ? Cr(t) : "http://www.w3.org/2000/svg" === e && "foreignObject" === t ? "http://www.w3.org/1999/xhtml" : e
    }
    var Er, jr = void 0,
        Sr = (Er = function(e, t) {
            if (e.namespaceURI !== Or.svg || "innerHTML" in e) e.innerHTML = t;
            else {
                for ((jr = jr || document.createElement("div")).innerHTML = "<svg>" + t + "</svg>", t = jr.firstChild; e.firstChild;) e.removeChild(e.firstChild);
                for (; t.firstChild;) e.appendChild(t.firstChild)
            }
        }, "undefined" != typeof MSApp && MSApp.execUnsafeLocalFunction ? function(e, t, n, r) {
            MSApp.execUnsafeLocalFunction(function() {
                return Er(e, t)
            })
        } : Er);

    function Tr(e, t) {
        if (t) {
            var n = e.firstChild;
            if (n && n === e.lastChild && 3 === n.nodeType) return void(n.nodeValue = t)
        }
        e.textContent = t
    }
    var Ir = {
            animationIterationCount: !0,
            borderImageOutset: !0,
            borderImageSlice: !0,
            borderImageWidth: !0,
            boxFlex: !0,
            boxFlexGroup: !0,
            boxOrdinalGroup: !0,
            columnCount: !0,
            columns: !0,
            flex: !0,
            flexGrow: !0,
            flexPositive: !0,
            flexShrink: !0,
            flexNegative: !0,
            flexOrder: !0,
            gridRow: !0,
            gridRowEnd: !0,
            gridRowSpan: !0,
            gridRowStart: !0,
            gridColumn: !0,
            gridColumnEnd: !0,
            gridColumnSpan: !0,
            gridColumnStart: !0,
            fontWeight: !0,
            lineClamp: !0,
            lineHeight: !0,
            opacity: !0,
            order: !0,
            orphans: !0,
            tabSize: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0,
            fillOpacity: !0,
            floodOpacity: !0,
            stopOpacity: !0,
            strokeDasharray: !0,
            strokeDashoffset: !0,
            strokeMiterlimit: !0,
            strokeOpacity: !0,
            strokeWidth: !0
        },
        Pr = ["Webkit", "ms", "Moz", "O"];

    function Mr(e, t) {
        for (var n in e = e.style, t)
            if (t.hasOwnProperty(n)) {
                var r = 0 === n.indexOf("--"),
                    i = n,
                    o = t[n];
                i = null == o || "boolean" == typeof o || "" === o ? "" : r || "number" != typeof o || 0 === o || Ir.hasOwnProperty(i) && Ir[i] ? ("" + o).trim() : o + "px", "float" === n && (n = "cssFloat"), r ? e.setProperty(n, i) : e[n] = i
            }
    }
    Object.keys(Ir).forEach(function(e) {
        Pr.forEach(function(t) {
            t = t + e.charAt(0).toUpperCase() + e.substring(1), Ir[t] = Ir[e]
        })
    });
    var xr = a({
        menuitem: !0
    }, {
        area: !0,
        base: !0,
        br: !0,
        col: !0,
        embed: !0,
        hr: !0,
        img: !0,
        input: !0,
        keygen: !0,
        link: !0,
        meta: !0,
        param: !0,
        source: !0,
        track: !0,
        wbr: !0
    });

    function Lr(e, t, n) {
        t && (xr[e] && (null != t.children || null != t.dangerouslySetInnerHTML) && f("137", e, n()), null != t.dangerouslySetInnerHTML && (null != t.children && f("60"), "object" == typeof t.dangerouslySetInnerHTML && "__html" in t.dangerouslySetInnerHTML || f("61")), null != t.style && "object" != typeof t.style && f("62", n()))
    }

    function Ar(e, t) {
        if (-1 === e.indexOf("-")) return "string" == typeof t.is;
        switch (e) {
            case "annotation-xml":
            case "color-profile":
            case "font-face":
            case "font-face-src":
            case "font-face-uri":
            case "font-face-format":
            case "font-face-name":
            case "missing-glyph":
                return !1;
            default:
                return !0
        }
    }
    var Nr = s.thatReturns("");

    function Dr(e, t) {
        var n = Bn(e = 9 === e.nodeType || 11 === e.nodeType ? e : e.ownerDocument);
        t = w[t];
        for (var r = 0; r < t.length; r++) {
            var i = t[r];
            if (!n.hasOwnProperty(i) || !n[i]) {
                switch (i) {
                    case "scroll":
                        xn("scroll", e);
                        break;
                    case "focus":
                    case "blur":
                        xn("focus", e), xn("blur", e), n.blur = !0, n.focus = !0;
                        break;
                    case "cancel":
                    case "close":
                        tt(i, !0) && xn(i, e);
                        break;
                    case "invalid":
                    case "submit":
                    case "reset":
                        break;
                    default:
                        -1 === fe.indexOf(i) && Mn(i, e)
                }
                n[i] = !0
            }
        }
    }

    function Rr(e, t, n, r) {
        return n = 9 === n.nodeType ? n : n.ownerDocument, r === Or.html && (r = Cr(e)), r === Or.html ? "script" === e ? ((e = n.createElement("div")).innerHTML = "<script><\/script>", e = e.removeChild(e.firstChild)) : e = "string" == typeof t.is ? n.createElement(e, {
            is: t.is
        }) : n.createElement(e) : e = n.createElementNS(r, e), e
    }

    function Fr(e, t) {
        return (9 === t.nodeType ? t : t.ownerDocument).createTextNode(e)
    }

    function Br(e, t, n, r) {
        var i = Ar(t, n);
        switch (t) {
            case "iframe":
            case "object":
                Mn("load", e);
                var o = n;
                break;
            case "video":
            case "audio":
                for (o = 0; o < fe.length; o++) Mn(fe[o], e);
                o = n;
                break;
            case "source":
                Mn("error", e), o = n;
                break;
            case "img":
            case "image":
            case "link":
                Mn("error", e), Mn("load", e), o = n;
                break;
            case "form":
                Mn("reset", e), Mn("submit", e), o = n;
                break;
            case "details":
                Mn("toggle", e), o = n;
                break;
            case "input":
                Pt(e, n), o = It(e, n), Mn("invalid", e), Dr(r, "onChange");
                break;
            case "option":
                o = gr(e, n);
                break;
            case "select":
                _r(e, n), o = a({}, n, {
                    value: void 0
                }), Mn("invalid", e), Dr(r, "onChange");
                break;
            case "textarea":
                br(e, n), o = vr(e, n), Mn("invalid", e), Dr(r, "onChange");
                break;
            default:
                o = n
        }
        Lr(t, o, Nr);
        var c, u = o;
        for (c in u)
            if (u.hasOwnProperty(c)) {
                var l = u[c];
                "style" === c ? Mr(e, l) : "dangerouslySetInnerHTML" === c ? null != (l = l ? l.__html : void 0) && Sr(e, l) : "children" === c ? "string" == typeof l ? ("textarea" !== t || "" !== l) && Tr(e, l) : "number" == typeof l && Tr(e, "" + l) : "suppressContentEditableWarning" !== c && "suppressHydrationWarning" !== c && "autoFocus" !== c && (y.hasOwnProperty(c) ? null != l && Dr(r, c) : null != l && Tt(e, c, l, i))
            }
        switch (t) {
            case "input":
                rt(e), Lt(e, n);
                break;
            case "textarea":
                rt(e), wr(e);
                break;
            case "option":
                null != n.value && e.setAttribute("value", n.value);
                break;
            case "select":
                e.multiple = !!n.multiple, null != (t = n.value) ? hr(e, !!n.multiple, t, !1) : null != n.defaultValue && hr(e, !!n.multiple, n.defaultValue, !0);
                break;
            default:
                "function" == typeof o.onClick && (e.onclick = s)
        }
    }

    function Hr(e, t, n, r, i) {
        var o = null;
        switch (t) {
            case "input":
                n = It(e, n), r = It(e, r), o = [];
                break;
            case "option":
                n = gr(e, n), r = gr(e, r), o = [];
                break;
            case "select":
                n = a({}, n, {
                    value: void 0
                }), r = a({}, r, {
                    value: void 0
                }), o = [];
                break;
            case "textarea":
                n = vr(e, n), r = vr(e, r), o = [];
                break;
            default:
                "function" != typeof n.onClick && "function" == typeof r.onClick && (e.onclick = s)
        }
        Lr(t, r, Nr), t = e = void 0;
        var c = null;
        for (e in n)
            if (!r.hasOwnProperty(e) && n.hasOwnProperty(e) && null != n[e])
                if ("style" === e) {
                    var u = n[e];
                    for (t in u) u.hasOwnProperty(t) && (c || (c = {}), c[t] = "")
                } else "dangerouslySetInnerHTML" !== e && "children" !== e && "suppressContentEditableWarning" !== e && "suppressHydrationWarning" !== e && "autoFocus" !== e && (y.hasOwnProperty(e) ? o || (o = []) : (o = o || []).push(e, null));
        for (e in r) {
            var l = r[e];
            if (u = null != n ? n[e] : void 0, r.hasOwnProperty(e) && l !== u && (null != l || null != u))
                if ("style" === e)
                    if (u) {
                        for (t in u) !u.hasOwnProperty(t) || l && l.hasOwnProperty(t) || (c || (c = {}), c[t] = "");
                        for (t in l) l.hasOwnProperty(t) && u[t] !== l[t] && (c || (c = {}), c[t] = l[t])
                    } else c || (o || (o = []), o.push(e, c)), c = l;
            else "dangerouslySetInnerHTML" === e ? (l = l ? l.__html : void 0, u = u ? u.__html : void 0, null != l && u !== l && (o = o || []).push(e, "" + l)) : "children" === e ? u === l || "string" != typeof l && "number" != typeof l || (o = o || []).push(e, "" + l) : "suppressContentEditableWarning" !== e && "suppressHydrationWarning" !== e && (y.hasOwnProperty(e) ? (null != l && Dr(i, e), o || u === l || (o = [])) : (o = o || []).push(e, l))
        }
        return c && (o = o || []).push("style", c), o
    }

    function Ur(e, t, n, r, i) {
        "input" === n && "radio" === i.type && null != i.name && Mt(e, i), Ar(n, r), r = Ar(n, i);
        for (var o = 0; o < t.length; o += 2) {
            var a = t[o],
                s = t[o + 1];
            "style" === a ? Mr(e, s) : "dangerouslySetInnerHTML" === a ? Sr(e, s) : "children" === a ? Tr(e, s) : Tt(e, a, s, r)
        }
        switch (n) {
            case "input":
                xt(e, i);
                break;
            case "textarea":
                yr(e, i);
                break;
            case "select":
                e._wrapperState.initialValue = void 0, t = e._wrapperState.wasMultiple, e._wrapperState.wasMultiple = !!i.multiple, null != (n = i.value) ? hr(e, !!i.multiple, n, !1) : t !== !!i.multiple && (null != i.defaultValue ? hr(e, !!i.multiple, i.defaultValue, !0) : hr(e, !!i.multiple, i.multiple ? [] : "", !1))
        }
    }

    function zr(e, t, n, r, i) {
        switch (t) {
            case "iframe":
            case "object":
                Mn("load", e);
                break;
            case "video":
            case "audio":
                for (r = 0; r < fe.length; r++) Mn(fe[r], e);
                break;
            case "source":
                Mn("error", e);
                break;
            case "img":
            case "image":
            case "link":
                Mn("error", e), Mn("load", e);
                break;
            case "form":
                Mn("reset", e), Mn("submit", e);
                break;
            case "details":
                Mn("toggle", e);
                break;
            case "input":
                Pt(e, n), Mn("invalid", e), Dr(i, "onChange");
                break;
            case "select":
                _r(e, n), Mn("invalid", e), Dr(i, "onChange");
                break;
            case "textarea":
                br(e, n), Mn("invalid", e), Dr(i, "onChange")
        }
        for (var o in Lr(t, n, Nr), r = null, n)
            if (n.hasOwnProperty(o)) {
                var a = n[o];
                "children" === o ? "string" == typeof a ? e.textContent !== a && (r = ["children", a]) : "number" == typeof a && e.textContent !== "" + a && (r = ["children", "" + a]) : y.hasOwnProperty(o) && null != a && Dr(i, o)
            }
        switch (t) {
            case "input":
                rt(e), Lt(e, n);
                break;
            case "textarea":
                rt(e), wr(e);
                break;
            case "select":
            case "option":
                break;
            default:
                "function" == typeof n.onClick && (e.onclick = s)
        }
        return r
    }

    function Gr(e, t) {
        return e.nodeValue !== t
    }
    var Wr = {
            createElement: Rr,
            createTextNode: Fr,
            setInitialProperties: Br,
            diffProperties: Hr,
            updateProperties: Ur,
            diffHydratedProperties: zr,
            diffHydratedText: Gr,
            warnForUnmatchedText: function() {},
            warnForDeletedHydratableElement: function() {},
            warnForDeletedHydratableText: function() {},
            warnForInsertedHydratedElement: function() {},
            warnForInsertedHydratedText: function() {},
            restoreControlledState: function(e, t, n) {
                switch (t) {
                    case "input":
                        if (xt(e, n), t = n.name, "radio" === n.type && null != t) {
                            for (n = e; n.parentNode;) n = n.parentNode;
                            for (n = n.querySelectorAll("input[name=" + JSON.stringify("" + t) + '][type="radio"]'), t = 0; t < n.length; t++) {
                                var r = n[t];
                                if (r !== e && r.form === e.form) {
                                    var i = V(r);
                                    i || f("90"), it(r), xt(r, i)
                                }
                            }
                        }
                        break;
                    case "textarea":
                        yr(e, n);
                        break;
                    case "select":
                        null != (t = n.value) && hr(e, !!n.multiple, t, !1)
                }
            }
        },
        Vr = null,
        Kr = null;

    function qr(e, t) {
        switch (e) {
            case "button":
            case "input":
            case "select":
            case "textarea":
                return !!t.autoFocus
        }
        return !1
    }

    function Qr(e, t) {
        return "textarea" === e || "string" == typeof t.children || "number" == typeof t.children || "object" == typeof t.dangerouslySetInnerHTML && null !== t.dangerouslySetInnerHTML && "string" == typeof t.dangerouslySetInnerHTML.__html
    }
    var $r = Xn,
        Yr = Zn,
        Xr = Jn;

    function Zr(e) {
        for (e = e.nextSibling; e && 1 !== e.nodeType && 3 !== e.nodeType;) e = e.nextSibling;
        return e
    }

    function Jr(e) {
        for (e = e.firstChild; e && 1 !== e.nodeType && 3 !== e.nodeType;) e = e.nextSibling;
        return e
    }
    new Set;
    var ei = [],
        ti = -1;

    function ni(e) {
        return {
            current: e
        }
    }

    function ri(e) {
        0 > ti || (e.current = ei[ti], ei[ti] = null, ti--)
    }

    function ii(e, t) {
        ei[++ti] = e.current, e.current = t
    }
    var oi = ni(d),
        ai = ni(!1),
        si = d;

    function ci(e) {
        return li(e) ? si : oi.current
    }

    function ui(e, t) {
        var n = e.type.contextTypes;
        if (!n) return d;
        var r = e.stateNode;
        if (r && r.__reactInternalMemoizedUnmaskedChildContext === t) return r.__reactInternalMemoizedMaskedChildContext;
        var i, o = {};
        for (i in n) o[i] = t[i];
        return r && ((e = e.stateNode).__reactInternalMemoizedUnmaskedChildContext = t, e.__reactInternalMemoizedMaskedChildContext = o), o
    }

    function li(e) {
        return 2 === e.tag && null != e.type.childContextTypes
    }

    function di(e) {
        li(e) && (ri(ai), ri(oi))
    }

    function fi(e) {
        ri(ai), ri(oi)
    }

    function pi(e, t, n) {
        oi.current !== d && f("168"), ii(oi, t), ii(ai, n)
    }

    function mi(e, t) {
        var n = e.stateNode,
            r = e.type.childContextTypes;
        if ("function" != typeof n.getChildContext) return t;
        for (var i in n = n.getChildContext()) i in r || f("108", bt(e) || "Unknown", i);
        return a({}, t, n)
    }

    function gi(e) {
        if (!li(e)) return !1;
        var t = e.stateNode;
        return t = t && t.__reactInternalMemoizedMergedChildContext || d, si = oi.current, ii(oi, t), ii(ai, ai.current), !0
    }

    function hi(e, t) {
        var n = e.stateNode;
        if (n || f("169"), t) {
            var r = mi(e, si);
            n.__reactInternalMemoizedMergedChildContext = r, ri(ai), ri(oi), ii(oi, r)
        } else ri(ai);
        ii(ai, t)
    }

    function _i(e, t, n, r) {
        this.tag = e, this.key = n, this.sibling = this.child = this.return = this.stateNode = this.type = null, this.index = 0, this.ref = null, this.pendingProps = t, this.memoizedState = this.updateQueue = this.memoizedProps = null, this.mode = r, this.effectTag = 0, this.lastEffect = this.firstEffect = this.nextEffect = null, this.expirationTime = 0, this.alternate = null
    }

    function vi(e, t, n) {
        var r = e.alternate;
        return null === r ? ((r = new _i(e.tag, t, e.key, e.mode)).type = e.type, r.stateNode = e.stateNode, r.alternate = e, e.alternate = r) : (r.pendingProps = t, r.effectTag = 0, r.nextEffect = null, r.firstEffect = null, r.lastEffect = null), r.expirationTime = n, r.child = e.child, r.memoizedProps = e.memoizedProps, r.memoizedState = e.memoizedState, r.updateQueue = e.updateQueue, r.sibling = e.sibling, r.index = e.index, r.ref = e.ref, r
    }

    function bi(e, t, n) {
        var r = e.type,
            i = e.key;
        if (e = e.props, "function" == typeof r) var o = r.prototype && r.prototype.isReactComponent ? 2 : 0;
        else if ("string" == typeof r) o = 5;
        else switch (r) {
            case ut:
                return yi(e.children, t, n, i);
            case mt:
                o = 11, t |= 3;
                break;
            case lt:
                o = 11, t |= 2;
                break;
            case dt:
                return (r = new _i(15, e, i, 4 | t)).type = dt, r.expirationTime = n, r;
            case ht:
                o = 16, t |= 2;
                break;
            default:
                e: {
                    switch ("object" == typeof r && null !== r ? r.$$typeof : null) {
                        case ft:
                            o = 13;
                            break e;
                        case pt:
                            o = 12;
                            break e;
                        case gt:
                            o = 14;
                            break e;
                        default:
                            f("130", null == r ? r : typeof r, "")
                    }
                    o = void 0
                }
        }
        return (t = new _i(o, e, i, t)).type = r, t.expirationTime = n, t
    }

    function yi(e, t, n, r) {
        return (e = new _i(10, e, r, t)).expirationTime = n, e
    }

    function wi(e, t, n) {
        return (e = new _i(6, e, null, t)).expirationTime = n, e
    }

    function Oi(e, t, n) {
        return (t = new _i(4, null !== e.children ? e.children : [], e.key, t)).expirationTime = n, t.stateNode = {
            containerInfo: e.containerInfo,
            pendingChildren: null,
            implementation: e.implementation
        }, t
    }

    function Ci(e, t, n) {
        return e = {
            current: t = new _i(3, null, null, t ? 3 : 0),
            containerInfo: e,
            pendingChildren: null,
            earliestPendingTime: 0,
            latestPendingTime: 0,
            earliestSuspendedTime: 0,
            latestSuspendedTime: 0,
            latestPingedTime: 0,
            pendingCommitExpirationTime: 0,
            finishedWork: null,
            context: null,
            pendingContext: null,
            hydrate: n,
            remainingExpirationTime: 0,
            firstBatch: null,
            nextScheduledRoot: null
        }, t.stateNode = e
    }
    var ki = null,
        Ei = null;

    function ji(e) {
        return function(t) {
            try {
                return e(t)
            } catch (e) {}
        }
    }

    function Si(e) {
        "function" == typeof ki && ki(e)
    }

    function Ti(e) {
        "function" == typeof Ei && Ei(e)
    }
    var Ii = !1;

    function Pi(e) {
        return {
            expirationTime: 0,
            baseState: e,
            firstUpdate: null,
            lastUpdate: null,
            firstCapturedUpdate: null,
            lastCapturedUpdate: null,
            firstEffect: null,
            lastEffect: null,
            firstCapturedEffect: null,
            lastCapturedEffect: null
        }
    }

    function Mi(e) {
        return {
            expirationTime: e.expirationTime,
            baseState: e.baseState,
            firstUpdate: e.firstUpdate,
            lastUpdate: e.lastUpdate,
            firstCapturedUpdate: null,
            lastCapturedUpdate: null,
            firstEffect: null,
            lastEffect: null,
            firstCapturedEffect: null,
            lastCapturedEffect: null
        }
    }

    function xi(e) {
        return {
            expirationTime: e,
            tag: 0,
            payload: null,
            callback: null,
            next: null,
            nextEffect: null
        }
    }

    function Li(e, t, n) {
        null === e.lastUpdate ? e.firstUpdate = e.lastUpdate = t : (e.lastUpdate.next = t, e.lastUpdate = t), (0 === e.expirationTime || e.expirationTime > n) && (e.expirationTime = n)
    }

    function Ai(e, t, n) {
        var r = e.alternate;
        if (null === r) {
            var i = e.updateQueue,
                o = null;
            null === i && (i = e.updateQueue = Pi(e.memoizedState))
        } else i = e.updateQueue, o = r.updateQueue, null === i ? null === o ? (i = e.updateQueue = Pi(e.memoizedState), o = r.updateQueue = Pi(r.memoizedState)) : i = e.updateQueue = Mi(o) : null === o && (o = r.updateQueue = Mi(i));
        null === o || i === o ? Li(i, t, n) : null === i.lastUpdate || null === o.lastUpdate ? (Li(i, t, n), Li(o, t, n)) : (Li(i, t, n), o.lastUpdate = t)
    }

    function Ni(e, t, n) {
        var r = e.updateQueue;
        null === (r = null === r ? e.updateQueue = Pi(e.memoizedState) : Di(e, r)).lastCapturedUpdate ? r.firstCapturedUpdate = r.lastCapturedUpdate = t : (r.lastCapturedUpdate.next = t, r.lastCapturedUpdate = t), (0 === r.expirationTime || r.expirationTime > n) && (r.expirationTime = n)
    }

    function Di(e, t) {
        var n = e.alternate;
        return null !== n && t === n.updateQueue && (t = e.updateQueue = Mi(t)), t
    }

    function Ri(e, t, n, r, i, o) {
        switch (n.tag) {
            case 1:
                return "function" == typeof(e = n.payload) ? e.call(o, r, i) : e;
            case 3:
                e.effectTag = -1025 & e.effectTag | 64;
            case 0:
                if (null === (i = "function" == typeof(e = n.payload) ? e.call(o, r, i) : e) || void 0 === i) break;
                return a({}, r, i);
            case 2:
                Ii = !0
        }
        return r
    }

    function Fi(e, t, n, r, i) {
        if (Ii = !1, !(0 === t.expirationTime || t.expirationTime > i)) {
            for (var o = (t = Di(e, t)).baseState, a = null, s = 0, c = t.firstUpdate, u = o; null !== c;) {
                var l = c.expirationTime;
                l > i ? (null === a && (a = c, o = u), (0 === s || s > l) && (s = l)) : (u = Ri(e, 0, c, u, n, r), null !== c.callback && (e.effectTag |= 32, c.nextEffect = null, null === t.lastEffect ? t.firstEffect = t.lastEffect = c : (t.lastEffect.nextEffect = c, t.lastEffect = c))), c = c.next
            }
            for (l = null, c = t.firstCapturedUpdate; null !== c;) {
                var d = c.expirationTime;
                d > i ? (null === l && (l = c, null === a && (o = u)), (0 === s || s > d) && (s = d)) : (u = Ri(e, 0, c, u, n, r), null !== c.callback && (e.effectTag |= 32, c.nextEffect = null, null === t.lastCapturedEffect ? t.firstCapturedEffect = t.lastCapturedEffect = c : (t.lastCapturedEffect.nextEffect = c, t.lastCapturedEffect = c))), c = c.next
            }
            null === a && (t.lastUpdate = null), null === l ? t.lastCapturedUpdate = null : e.effectTag |= 32, null === a && null === l && (o = u), t.baseState = o, t.firstUpdate = a, t.firstCapturedUpdate = l, t.expirationTime = s, e.memoizedState = u
        }
    }

    function Bi(e, t) {
        "function" != typeof e && f("191", e), e.call(t)
    }

    function Hi(e, t, n) {
        for (null !== t.firstCapturedUpdate && (null !== t.lastUpdate && (t.lastUpdate.next = t.firstCapturedUpdate, t.lastUpdate = t.lastCapturedUpdate), t.firstCapturedUpdate = t.lastCapturedUpdate = null), e = t.firstEffect, t.firstEffect = t.lastEffect = null; null !== e;) {
            var r = e.callback;
            null !== r && (e.callback = null, Bi(r, n)), e = e.nextEffect
        }
        for (e = t.firstCapturedEffect, t.firstCapturedEffect = t.lastCapturedEffect = null; null !== e;) null !== (t = e.callback) && (e.callback = null, Bi(t, n)), e = e.nextEffect
    }

    function Ui(e, t) {
        return {
            value: e,
            source: t,
            stack: yt(t)
        }
    }
    var zi = ni(null),
        Gi = ni(null),
        Wi = ni(0);

    function Vi(e) {
        var t = e.type._context;
        ii(Wi, t._changedBits), ii(Gi, t._currentValue), ii(zi, e), t._currentValue = e.pendingProps.value, t._changedBits = e.stateNode
    }

    function Ki(e) {
        var t = Wi.current,
            n = Gi.current;
        ri(zi), ri(Gi), ri(Wi), (e = e.type._context)._currentValue = n, e._changedBits = t
    }
    var qi = {},
        Qi = ni(qi),
        $i = ni(qi),
        Yi = ni(qi);

    function Xi(e) {
        return e === qi && f("174"), e
    }

    function Zi(e, t) {
        ii(Yi, t), ii($i, e), ii(Qi, qi);
        var n = t.nodeType;
        switch (n) {
            case 9:
            case 11:
                t = (t = t.documentElement) ? t.namespaceURI : kr(null, "");
                break;
            default:
                t = kr(t = (n = 8 === n ? t.parentNode : t).namespaceURI || null, n = n.tagName)
        }
        ri(Qi), ii(Qi, t)
    }

    function Ji(e) {
        ri(Qi), ri($i), ri(Yi)
    }

    function eo(e) {
        $i.current === e && (ri(Qi), ri($i))
    }

    function to(e, t, n) {
        var r = e.memoizedState;
        r = null === (t = t(n, r)) || void 0 === t ? r : a({}, r, t), e.memoizedState = r, null !== (e = e.updateQueue) && 0 === e.expirationTime && (e.baseState = r)
    }
    var no = {
        isMounted: function(e) {
            return !!(e = e._reactInternalFiber) && 2 === an(e)
        },
        enqueueSetState: function(e, t, n) {
            e = e._reactInternalFiber;
            var r = ga(),
                i = xi(r = pa(r, e));
            i.payload = t, void 0 !== n && null !== n && (i.callback = n), Ai(e, i, r), ma(e, r)
        },
        enqueueReplaceState: function(e, t, n) {
            e = e._reactInternalFiber;
            var r = ga(),
                i = xi(r = pa(r, e));
            i.tag = 1, i.payload = t, void 0 !== n && null !== n && (i.callback = n), Ai(e, i, r), ma(e, r)
        },
        enqueueForceUpdate: function(e, t) {
            e = e._reactInternalFiber;
            var n = ga(),
                r = xi(n = pa(n, e));
            r.tag = 2, void 0 !== t && null !== t && (r.callback = t), Ai(e, r, n), ma(e, n)
        }
    };

    function ro(e, t, n, r, i, o) {
        var a = e.stateNode;
        return e = e.type, "function" == typeof a.shouldComponentUpdate ? a.shouldComponentUpdate(n, i, o) : !e.prototype || !e.prototype.isPureReactComponent || (!u(t, n) || !u(r, i))
    }

    function io(e, t, n, r) {
        e = t.state, "function" == typeof t.componentWillReceiveProps && t.componentWillReceiveProps(n, r), "function" == typeof t.UNSAFE_componentWillReceiveProps && t.UNSAFE_componentWillReceiveProps(n, r), t.state !== e && no.enqueueReplaceState(t, t.state, null)
    }

    function oo(e, t) {
        var n = e.type,
            r = e.stateNode,
            i = e.pendingProps,
            o = ci(e);
        r.props = i, r.state = e.memoizedState, r.refs = d, r.context = ui(e, o), null !== (o = e.updateQueue) && (Fi(e, o, i, r, t), r.state = e.memoizedState), "function" == typeof(o = e.type.getDerivedStateFromProps) && (to(e, o, i), r.state = e.memoizedState), "function" == typeof n.getDerivedStateFromProps || "function" == typeof r.getSnapshotBeforeUpdate || "function" != typeof r.UNSAFE_componentWillMount && "function" != typeof r.componentWillMount || (n = r.state, "function" == typeof r.componentWillMount && r.componentWillMount(), "function" == typeof r.UNSAFE_componentWillMount && r.UNSAFE_componentWillMount(), n !== r.state && no.enqueueReplaceState(r, r.state, null), null !== (o = e.updateQueue) && (Fi(e, o, i, r, t), r.state = e.memoizedState)), "function" == typeof r.componentDidMount && (e.effectTag |= 4)
    }
    var ao = Array.isArray;

    function so(e, t, n) {
        if (null !== (e = n.ref) && "function" != typeof e && "object" != typeof e) {
            if (n._owner) {
                var r = void 0;
                (n = n._owner) && (2 !== n.tag && f("110"), r = n.stateNode), r || f("147", e);
                var i = "" + e;
                return null !== t && null !== t.ref && "function" == typeof t.ref && t.ref._stringRef === i ? t.ref : ((t = function(e) {
                    var t = r.refs === d ? r.refs = {} : r.refs;
                    null === e ? delete t[i] : t[i] = e
                })._stringRef = i, t)
            }
            "string" != typeof e && f("148"), n._owner || f("254", e)
        }
        return e
    }

    function co(e, t) {
        "textarea" !== e.type && f("31", "[object Object]" === Object.prototype.toString.call(t) ? "object with keys {" + Object.keys(t).join(", ") + "}" : t, "")
    }

    function uo(e) {
        function t(t, n) {
            if (e) {
                var r = t.lastEffect;
                null !== r ? (r.nextEffect = n, t.lastEffect = n) : t.firstEffect = t.lastEffect = n, n.nextEffect = null, n.effectTag = 8
            }
        }

        function n(n, r) {
            if (!e) return null;
            for (; null !== r;) t(n, r), r = r.sibling;
            return null
        }

        function r(e, t) {
            for (e = new Map; null !== t;) null !== t.key ? e.set(t.key, t) : e.set(t.index, t), t = t.sibling;
            return e
        }

        function i(e, t, n) {
            return (e = vi(e, t, n)).index = 0, e.sibling = null, e
        }

        function o(t, n, r) {
            return t.index = r, e ? null !== (r = t.alternate) ? (r = r.index) < n ? (t.effectTag = 2, n) : r : (t.effectTag = 2, n) : n
        }

        function a(t) {
            return e && null === t.alternate && (t.effectTag = 2), t
        }

        function s(e, t, n, r) {
            return null === t || 6 !== t.tag ? ((t = wi(n, e.mode, r)).return = e, t) : ((t = i(t, n, r)).return = e, t)
        }

        function c(e, t, n, r) {
            return null !== t && t.type === n.type ? ((r = i(t, n.props, r)).ref = so(e, t, n), r.return = e, r) : ((r = bi(n, e.mode, r)).ref = so(e, t, n), r.return = e, r)
        }

        function u(e, t, n, r) {
            return null === t || 4 !== t.tag || t.stateNode.containerInfo !== n.containerInfo || t.stateNode.implementation !== n.implementation ? ((t = Oi(n, e.mode, r)).return = e, t) : ((t = i(t, n.children || [], r)).return = e, t)
        }

        function l(e, t, n, r, o) {
            return null === t || 10 !== t.tag ? ((t = yi(n, e.mode, r, o)).return = e, t) : ((t = i(t, n, r)).return = e, t)
        }

        function d(e, t, n) {
            if ("string" == typeof t || "number" == typeof t) return (t = wi("" + t, e.mode, n)).return = e, t;
            if ("object" == typeof t && null !== t) {
                switch (t.$$typeof) {
                    case st:
                        return (n = bi(t, e.mode, n)).ref = so(e, null, t), n.return = e, n;
                    case ct:
                        return (t = Oi(t, e.mode, n)).return = e, t
                }
                if (ao(t) || vt(t)) return (t = yi(t, e.mode, n, null)).return = e, t;
                co(e, t)
            }
            return null
        }

        function p(e, t, n, r) {
            var i = null !== t ? t.key : null;
            if ("string" == typeof n || "number" == typeof n) return null !== i ? null : s(e, t, "" + n, r);
            if ("object" == typeof n && null !== n) {
                switch (n.$$typeof) {
                    case st:
                        return n.key === i ? n.type === ut ? l(e, t, n.props.children, r, i) : c(e, t, n, r) : null;
                    case ct:
                        return n.key === i ? u(e, t, n, r) : null
                }
                if (ao(n) || vt(n)) return null !== i ? null : l(e, t, n, r, null);
                co(e, n)
            }
            return null
        }

        function m(e, t, n, r, i) {
            if ("string" == typeof r || "number" == typeof r) return s(t, e = e.get(n) || null, "" + r, i);
            if ("object" == typeof r && null !== r) {
                switch (r.$$typeof) {
                    case st:
                        return e = e.get(null === r.key ? n : r.key) || null, r.type === ut ? l(t, e, r.props.children, i, r.key) : c(t, e, r, i);
                    case ct:
                        return u(t, e = e.get(null === r.key ? n : r.key) || null, r, i)
                }
                if (ao(r) || vt(r)) return l(t, e = e.get(n) || null, r, i, null);
                co(t, r)
            }
            return null
        }

        function g(i, a, s, c) {
            for (var u = null, l = null, f = a, g = a = 0, h = null; null !== f && g < s.length; g++) {
                f.index > g ? (h = f, f = null) : h = f.sibling;
                var _ = p(i, f, s[g], c);
                if (null === _) {
                    null === f && (f = h);
                    break
                }
                e && f && null === _.alternate && t(i, f), a = o(_, a, g), null === l ? u = _ : l.sibling = _, l = _, f = h
            }
            if (g === s.length) return n(i, f), u;
            if (null === f) {
                for (; g < s.length; g++)(f = d(i, s[g], c)) && (a = o(f, a, g), null === l ? u = f : l.sibling = f, l = f);
                return u
            }
            for (f = r(i, f); g < s.length; g++)(h = m(f, i, g, s[g], c)) && (e && null !== h.alternate && f.delete(null === h.key ? g : h.key), a = o(h, a, g), null === l ? u = h : l.sibling = h, l = h);
            return e && f.forEach(function(e) {
                return t(i, e)
            }), u
        }

        function h(i, a, s, c) {
            var u = vt(s);
            "function" != typeof u && f("150"), null == (s = u.call(s)) && f("151");
            for (var l = u = null, g = a, h = a = 0, _ = null, v = s.next(); null !== g && !v.done; h++, v = s.next()) {
                g.index > h ? (_ = g, g = null) : _ = g.sibling;
                var b = p(i, g, v.value, c);
                if (null === b) {
                    g || (g = _);
                    break
                }
                e && g && null === b.alternate && t(i, g), a = o(b, a, h), null === l ? u = b : l.sibling = b, l = b, g = _
            }
            if (v.done) return n(i, g), u;
            if (null === g) {
                for (; !v.done; h++, v = s.next()) null !== (v = d(i, v.value, c)) && (a = o(v, a, h), null === l ? u = v : l.sibling = v, l = v);
                return u
            }
            for (g = r(i, g); !v.done; h++, v = s.next()) null !== (v = m(g, i, h, v.value, c)) && (e && null !== v.alternate && g.delete(null === v.key ? h : v.key), a = o(v, a, h), null === l ? u = v : l.sibling = v, l = v);
            return e && g.forEach(function(e) {
                return t(i, e)
            }), u
        }
        return function(e, r, o, s) {
            "object" == typeof o && null !== o && o.type === ut && null === o.key && (o = o.props.children);
            var c = "object" == typeof o && null !== o;
            if (c) switch (o.$$typeof) {
                case st:
                    e: {
                        var u = o.key;
                        for (c = r; null !== c;) {
                            if (c.key === u) {
                                if (10 === c.tag ? o.type === ut : c.type === o.type) {
                                    n(e, c.sibling), (r = i(c, o.type === ut ? o.props.children : o.props, s)).ref = so(e, c, o), r.return = e, e = r;
                                    break e
                                }
                                n(e, c);
                                break
                            }
                            t(e, c), c = c.sibling
                        }
                        o.type === ut ? ((r = yi(o.props.children, e.mode, s, o.key)).return = e, e = r) : ((s = bi(o, e.mode, s)).ref = so(e, r, o), s.return = e, e = s)
                    }
                    return a(e);
                case ct:
                    e: {
                        for (c = o.key; null !== r;) {
                            if (r.key === c) {
                                if (4 === r.tag && r.stateNode.containerInfo === o.containerInfo && r.stateNode.implementation === o.implementation) {
                                    n(e, r.sibling), (r = i(r, o.children || [], s)).return = e, e = r;
                                    break e
                                }
                                n(e, r);
                                break
                            }
                            t(e, r), r = r.sibling
                        }(r = Oi(o, e.mode, s)).return = e,
                        e = r
                    }
                    return a(e)
            }
            if ("string" == typeof o || "number" == typeof o) return o = "" + o, null !== r && 6 === r.tag ? (n(e, r.sibling), (r = i(r, o, s)).return = e, e = r) : (n(e, r), (r = wi(o, e.mode, s)).return = e, e = r), a(e);
            if (ao(o)) return g(e, r, o, s);
            if (vt(o)) return h(e, r, o, s);
            if (c && co(e, o), void 0 === o) switch (e.tag) {
                case 2:
                case 1:
                    f("152", (s = e.type).displayName || s.name || "Component")
            }
            return n(e, r)
        }
    }
    var lo = uo(!0),
        fo = uo(!1),
        po = null,
        mo = null,
        go = !1;

    function ho(e, t) {
        var n = new _i(5, null, null, 0);
        n.type = "DELETED", n.stateNode = t, n.return = e, n.effectTag = 8, null !== e.lastEffect ? (e.lastEffect.nextEffect = n, e.lastEffect = n) : e.firstEffect = e.lastEffect = n
    }

    function _o(e, t) {
        switch (e.tag) {
            case 5:
                var n = e.type;
                return null !== (t = 1 !== t.nodeType || n.toLowerCase() !== t.nodeName.toLowerCase() ? null : t) && (e.stateNode = t, !0);
            case 6:
                return null !== (t = "" === e.pendingProps || 3 !== t.nodeType ? null : t) && (e.stateNode = t, !0);
            default:
                return !1
        }
    }

    function vo(e) {
        if (go) {
            var t = mo;
            if (t) {
                var n = t;
                if (!_o(e, t)) {
                    if (!(t = Zr(n)) || !_o(e, t)) return e.effectTag |= 2, go = !1, void(po = e);
                    ho(po, n)
                }
                po = e, mo = Jr(t)
            } else e.effectTag |= 2, go = !1, po = e
        }
    }

    function bo(e) {
        for (e = e.return; null !== e && 5 !== e.tag && 3 !== e.tag;) e = e.return;
        po = e
    }

    function yo(e) {
        if (e !== po) return !1;
        if (!go) return bo(e), go = !0, !1;
        var t = e.type;
        if (5 !== e.tag || "head" !== t && "body" !== t && !Qr(t, e.memoizedProps))
            for (t = mo; t;) ho(e, t), t = Zr(t);
        return bo(e), mo = po ? Zr(e.stateNode) : null, !0
    }

    function wo() {
        mo = po = null, go = !1
    }

    function Oo(e, t, n) {
        Co(e, t, n, t.expirationTime)
    }

    function Co(e, t, n, r) {
        t.child = null === e ? fo(t, null, n, r) : lo(t, e.child, n, r)
    }

    function ko(e, t) {
        var n = t.ref;
        (null === e && null !== n || null !== e && e.ref !== n) && (t.effectTag |= 128)
    }

    function Eo(e, t, n, r, i) {
        ko(e, t);
        var o = 0 != (64 & t.effectTag);
        if (!n && !o) return r && hi(t, !1), To(e, t);
        n = t.stateNode, ot.current = t;
        var a = o ? null : n.render();
        return t.effectTag |= 1, o && (Co(e, t, null, i), t.child = null), Co(e, t, a, i), t.memoizedState = n.state, t.memoizedProps = n.props, r && hi(t, !0), t.child
    }

    function jo(e) {
        var t = e.stateNode;
        t.pendingContext ? pi(0, t.pendingContext, t.pendingContext !== t.context) : t.context && pi(0, t.context, !1), Zi(e, t.containerInfo)
    }

    function So(e, t, n, r) {
        var i = e.child;
        for (null !== i && (i.return = e); null !== i;) {
            switch (i.tag) {
                case 12:
                    var o = 0 | i.stateNode;
                    if (i.type === t && 0 != (o & n)) {
                        for (o = i; null !== o;) {
                            var a = o.alternate;
                            if (0 === o.expirationTime || o.expirationTime > r) o.expirationTime = r, null !== a && (0 === a.expirationTime || a.expirationTime > r) && (a.expirationTime = r);
                            else {
                                if (null === a || !(0 === a.expirationTime || a.expirationTime > r)) break;
                                a.expirationTime = r
                            }
                            o = o.return
                        }
                        o = null
                    } else o = i.child;
                    break;
                case 13:
                    o = i.type === e.type ? null : i.child;
                    break;
                default:
                    o = i.child
            }
            if (null !== o) o.return = i;
            else
                for (o = i; null !== o;) {
                    if (o === e) {
                        o = null;
                        break
                    }
                    if (null !== (i = o.sibling)) {
                        i.return = o.return, o = i;
                        break
                    }
                    o = o.return
                }
            i = o
        }
    }

    function To(e, t) {
        if (null !== e && t.child !== e.child && f("153"), null !== t.child) {
            var n = vi(e = t.child, e.pendingProps, e.expirationTime);
            for (t.child = n, n.return = t; null !== e.sibling;) e = e.sibling, (n = n.sibling = vi(e, e.pendingProps, e.expirationTime)).return = t;
            n.sibling = null
        }
        return t.child
    }

    function Io(e, t, n) {
        if (0 === t.expirationTime || t.expirationTime > n) {
            switch (t.tag) {
                case 3:
                    jo(t);
                    break;
                case 2:
                    gi(t);
                    break;
                case 4:
                    Zi(t, t.stateNode.containerInfo);
                    break;
                case 13:
                    Vi(t)
            }
            return null
        }
        switch (t.tag) {
            case 0:
                null !== e && f("155");
                var r = t.type,
                    i = t.pendingProps,
                    o = ci(t);
                return r = r(i, o = ui(t, o)), t.effectTag |= 1, "object" == typeof r && null !== r && "function" == typeof r.render && void 0 === r.$$typeof ? (o = t.type, t.tag = 2, t.memoizedState = null !== r.state && void 0 !== r.state ? r.state : null, "function" == typeof(o = o.getDerivedStateFromProps) && to(t, o, i), i = gi(t), r.updater = no, t.stateNode = r, r._reactInternalFiber = t, oo(t, n), e = Eo(e, t, !0, i, n)) : (t.tag = 1, Oo(e, t, r), t.memoizedProps = i, e = t.child), e;
            case 1:
                return i = t.type, n = t.pendingProps, ai.current || t.memoizedProps !== n ? (i = i(n, r = ui(t, r = ci(t))), t.effectTag |= 1, Oo(e, t, i), t.memoizedProps = n, e = t.child) : e = To(e, t), e;
            case 2:
                if (i = gi(t), null === e)
                    if (null === t.stateNode) {
                        var a = t.pendingProps,
                            s = t.type;
                        r = ci(t);
                        var c = 2 === t.tag && null != t.type.contextTypes;
                        a = new s(a, o = c ? ui(t, r) : d), t.memoizedState = null !== a.state && void 0 !== a.state ? a.state : null, a.updater = no, t.stateNode = a, a._reactInternalFiber = t, c && ((c = t.stateNode).__reactInternalMemoizedUnmaskedChildContext = r, c.__reactInternalMemoizedMaskedChildContext = o), oo(t, n), r = !0
                    } else {
                        s = t.type, r = t.stateNode, c = t.memoizedProps, o = t.pendingProps, r.props = c;
                        var u = r.context;
                        a = ui(t, a = ci(t));
                        var l = s.getDerivedStateFromProps;
                        (s = "function" == typeof l || "function" == typeof r.getSnapshotBeforeUpdate) || "function" != typeof r.UNSAFE_componentWillReceiveProps && "function" != typeof r.componentWillReceiveProps || (c !== o || u !== a) && io(t, r, o, a), Ii = !1;
                        var p = t.memoizedState;
                        u = r.state = p;
                        var m = t.updateQueue;
                        null !== m && (Fi(t, m, o, r, n), u = t.memoizedState), c !== o || p !== u || ai.current || Ii ? ("function" == typeof l && (to(t, l, o), u = t.memoizedState), (c = Ii || ro(t, c, o, p, u, a)) ? (s || "function" != typeof r.UNSAFE_componentWillMount && "function" != typeof r.componentWillMount || ("function" == typeof r.componentWillMount && r.componentWillMount(), "function" == typeof r.UNSAFE_componentWillMount && r.UNSAFE_componentWillMount()), "function" == typeof r.componentDidMount && (t.effectTag |= 4)) : ("function" == typeof r.componentDidMount && (t.effectTag |= 4), t.memoizedProps = o, t.memoizedState = u), r.props = o, r.state = u, r.context = a, r = c) : ("function" == typeof r.componentDidMount && (t.effectTag |= 4), r = !1)
                    }
                else s = t.type, r = t.stateNode, o = t.memoizedProps, c = t.pendingProps, r.props = o, u = r.context, a = ui(t, a = ci(t)), (s = "function" == typeof(l = s.getDerivedStateFromProps) || "function" == typeof r.getSnapshotBeforeUpdate) || "function" != typeof r.UNSAFE_componentWillReceiveProps && "function" != typeof r.componentWillReceiveProps || (o !== c || u !== a) && io(t, r, c, a), Ii = !1, u = t.memoizedState, p = r.state = u, null !== (m = t.updateQueue) && (Fi(t, m, c, r, n), p = t.memoizedState), o !== c || u !== p || ai.current || Ii ? ("function" == typeof l && (to(t, l, c), p = t.memoizedState), (l = Ii || ro(t, o, c, u, p, a)) ? (s || "function" != typeof r.UNSAFE_componentWillUpdate && "function" != typeof r.componentWillUpdate || ("function" == typeof r.componentWillUpdate && r.componentWillUpdate(c, p, a), "function" == typeof r.UNSAFE_componentWillUpdate && r.UNSAFE_componentWillUpdate(c, p, a)), "function" == typeof r.componentDidUpdate && (t.effectTag |= 4), "function" == typeof r.getSnapshotBeforeUpdate && (t.effectTag |= 256)) : ("function" != typeof r.componentDidUpdate || o === e.memoizedProps && u === e.memoizedState || (t.effectTag |= 4), "function" != typeof r.getSnapshotBeforeUpdate || o === e.memoizedProps && u === e.memoizedState || (t.effectTag |= 256), t.memoizedProps = c, t.memoizedState = p), r.props = c, r.state = p, r.context = a, r = l) : ("function" != typeof r.componentDidUpdate || o === e.memoizedProps && u === e.memoizedState || (t.effectTag |= 4), "function" != typeof r.getSnapshotBeforeUpdate || o === e.memoizedProps && u === e.memoizedState || (t.effectTag |= 256), r = !1);
                return Eo(e, t, r, i, n);
            case 3:
                return jo(t), null !== (i = t.updateQueue) ? (r = null !== (r = t.memoizedState) ? r.element : null, Fi(t, i, t.pendingProps, null, n), (i = t.memoizedState.element) === r ? (wo(), e = To(e, t)) : (r = t.stateNode, (r = (null === e || null === e.child) && r.hydrate) && (mo = Jr(t.stateNode.containerInfo), po = t, r = go = !0), r ? (t.effectTag |= 2, t.child = fo(t, null, i, n)) : (wo(), Oo(e, t, i)), e = t.child)) : (wo(), e = To(e, t)), e;
            case 5:
                return Xi(Yi.current), (i = Xi(Qi.current)) !== (r = kr(i, t.type)) && (ii($i, t), ii(Qi, r)), null === e && vo(t), i = t.type, c = t.memoizedProps, r = t.pendingProps, o = null !== e ? e.memoizedProps : null, ai.current || c !== r || ((c = 1 & t.mode && !!r.hidden) && (t.expirationTime = 1073741823), c && 1073741823 === n) ? (c = r.children, Qr(i, r) ? c = null : o && Qr(i, o) && (t.effectTag |= 16), ko(e, t), 1073741823 !== n && 1 & t.mode && r.hidden ? (t.expirationTime = 1073741823, t.memoizedProps = r, e = null) : (Oo(e, t, c), t.memoizedProps = r, e = t.child)) : e = To(e, t), e;
            case 6:
                return null === e && vo(t), t.memoizedProps = t.pendingProps, null;
            case 16:
                return null;
            case 4:
                return Zi(t, t.stateNode.containerInfo), i = t.pendingProps, ai.current || t.memoizedProps !== i ? (null === e ? t.child = lo(t, null, i, n) : Oo(e, t, i), t.memoizedProps = i, e = t.child) : e = To(e, t), e;
            case 14:
                return i = t.type.render, n = t.pendingProps, r = t.ref, ai.current || t.memoizedProps !== n || r !== (null !== e ? e.ref : null) ? (Oo(e, t, i = i(n, r)), t.memoizedProps = n, e = t.child) : e = To(e, t), e;
            case 10:
                return n = t.pendingProps, ai.current || t.memoizedProps !== n ? (Oo(e, t, n), t.memoizedProps = n, e = t.child) : e = To(e, t), e;
            case 11:
                return n = t.pendingProps.children, ai.current || null !== n && t.memoizedProps !== n ? (Oo(e, t, n), t.memoizedProps = n, e = t.child) : e = To(e, t), e;
            case 15:
                return n = t.pendingProps, t.memoizedProps === n ? e = To(e, t) : (Oo(e, t, n.children), t.memoizedProps = n, e = t.child), e;
            case 13:
                return function(e, t, n) {
                    var r = t.type._context,
                        i = t.pendingProps,
                        o = t.memoizedProps,
                        a = !0;
                    if (ai.current) a = !1;
                    else if (o === i) return t.stateNode = 0, Vi(t), To(e, t);
                    var s = i.value;
                    if (t.memoizedProps = i, null === o) s = 1073741823;
                    else if (o.value === i.value) {
                        if (o.children === i.children && a) return t.stateNode = 0, Vi(t), To(e, t);
                        s = 0
                    } else {
                        var c = o.value;
                        if (c === s && (0 !== c || 1 / c == 1 / s) || c != c && s != s) {
                            if (o.children === i.children && a) return t.stateNode = 0, Vi(t), To(e, t);
                            s = 0
                        } else if (s = "function" == typeof r._calculateChangedBits ? r._calculateChangedBits(c, s) : 1073741823, 0 == (s |= 0)) {
                            if (o.children === i.children && a) return t.stateNode = 0, Vi(t), To(e, t)
                        } else So(t, r, s, n)
                    }
                    return t.stateNode = s, Vi(t), Oo(e, t, i.children), t.child
                }(e, t, n);
            case 12:
                e: if (r = t.type, o = t.pendingProps, c = t.memoizedProps, i = r._currentValue, a = r._changedBits, ai.current || 0 !== a || c !== o) {
                    if (t.memoizedProps = o, void 0 !== (s = o.unstable_observedBits) && null !== s || (s = 1073741823), t.stateNode = s, 0 != (a & s)) So(t, r, a, n);
                    else if (c === o) {
                        e = To(e, t);
                        break e
                    }
                    n = (n = o.children)(i), t.effectTag |= 1, Oo(e, t, n), e = t.child
                } else e = To(e, t);
                return e;
            default:
                f("156")
        }
    }

    function Po(e) {
        e.effectTag |= 4
    }
    var Mo = void 0,
        xo = void 0,
        Lo = void 0;

    function Ao(e, t) {
        var n = t.pendingProps;
        switch (t.tag) {
            case 1:
                return null;
            case 2:
                return di(t), null;
            case 3:
                Ji(), fi();
                var r = t.stateNode;
                return r.pendingContext && (r.context = r.pendingContext, r.pendingContext = null), null !== e && null !== e.child || (yo(t), t.effectTag &= -3), Mo(t), null;
            case 5:
                eo(t), r = Xi(Yi.current);
                var i = t.type;
                if (null !== e && null != t.stateNode) {
                    var o = e.memoizedProps,
                        a = t.stateNode,
                        s = Xi(Qi.current);
                    a = Hr(a, i, o, n, r), xo(e, t, a, i, o, n, r, s), e.ref !== t.ref && (t.effectTag |= 128)
                } else {
                    if (!n) return null === t.stateNode && f("166"), null;
                    if (e = Xi(Qi.current), yo(t)) n = t.stateNode, i = t.type, o = t.memoizedProps, n[U] = t, n[z] = o, r = zr(n, i, o, e, r), t.updateQueue = r, null !== r && Po(t);
                    else {
                        (e = Rr(i, n, r, e))[U] = t, e[z] = n;
                        e: for (o = t.child; null !== o;) {
                            if (5 === o.tag || 6 === o.tag) e.appendChild(o.stateNode);
                            else if (4 !== o.tag && null !== o.child) {
                                o.child.return = o, o = o.child;
                                continue
                            }
                            if (o === t) break;
                            for (; null === o.sibling;) {
                                if (null === o.return || o.return === t) break e;
                                o = o.return
                            }
                            o.sibling.return = o.return, o = o.sibling
                        }
                        Br(e, i, n, r), qr(i, n) && Po(t), t.stateNode = e
                    }
                    null !== t.ref && (t.effectTag |= 128)
                }
                return null;
            case 6:
                if (e && null != t.stateNode) Lo(e, t, e.memoizedProps, n);
                else {
                    if ("string" != typeof n) return null === t.stateNode && f("166"), null;
                    r = Xi(Yi.current), Xi(Qi.current), yo(t) ? (r = t.stateNode, n = t.memoizedProps, r[U] = t, Gr(r, n) && Po(t)) : ((r = Fr(n, r))[U] = t, t.stateNode = r)
                }
                return null;
            case 14:
            case 16:
            case 10:
            case 11:
            case 15:
                return null;
            case 4:
                return Ji(), Mo(t), null;
            case 13:
                return Ki(t), null;
            case 12:
                return null;
            case 0:
                f("167");
            default:
                f("156")
        }
    }

    function No(e, t) {
        var n = t.source;
        null === t.stack && null !== n && yt(n), null !== n && bt(n), t = t.value, null !== e && 2 === e.tag && bt(e);
        try {
            t && t.suppressReactErrorLogging || console.error(t)
        } catch (e) {
            e && e.suppressReactErrorLogging || console.error(e)
        }
    }

    function Do(e) {
        var t = e.ref;
        if (null !== t)
            if ("function" == typeof t) try {
                t(null)
            } catch (t) {
                da(e, t)
            } else t.current = null
    }

    function Ro(e) {
        switch (Ti(e), e.tag) {
            case 2:
                Do(e);
                var t = e.stateNode;
                if ("function" == typeof t.componentWillUnmount) try {
                    t.props = e.memoizedProps, t.state = e.memoizedState, t.componentWillUnmount()
                } catch (t) {
                    da(e, t)
                }
                break;
            case 5:
                Do(e);
                break;
            case 4:
                Ho(e)
        }
    }

    function Fo(e) {
        return 5 === e.tag || 3 === e.tag || 4 === e.tag
    }

    function Bo(e) {
        e: {
            for (var t = e.return; null !== t;) {
                if (Fo(t)) {
                    var n = t;
                    break e
                }
                t = t.return
            }
            f("160"),
            n = void 0
        }
        var r = t = void 0;
        switch (n.tag) {
            case 5:
                t = n.stateNode, r = !1;
                break;
            case 3:
            case 4:
                t = n.stateNode.containerInfo, r = !0;
                break;
            default:
                f("161")
        }
        16 & n.effectTag && (Tr(t, ""), n.effectTag &= -17);e: t: for (n = e;;) {
            for (; null === n.sibling;) {
                if (null === n.return || Fo(n.return)) {
                    n = null;
                    break e
                }
                n = n.return
            }
            for (n.sibling.return = n.return, n = n.sibling; 5 !== n.tag && 6 !== n.tag;) {
                if (2 & n.effectTag) continue t;
                if (null === n.child || 4 === n.tag) continue t;
                n.child.return = n, n = n.child
            }
            if (!(2 & n.effectTag)) {
                n = n.stateNode;
                break e
            }
        }
        for (var i = e;;) {
            if (5 === i.tag || 6 === i.tag)
                if (n)
                    if (r) {
                        var o = t,
                            a = i.stateNode,
                            s = n;
                        8 === o.nodeType ? o.parentNode.insertBefore(a, s) : o.insertBefore(a, s)
                    } else t.insertBefore(i.stateNode, n);
            else r ? (o = t, a = i.stateNode, 8 === o.nodeType ? o.parentNode.insertBefore(a, o) : o.appendChild(a)) : t.appendChild(i.stateNode);
            else if (4 !== i.tag && null !== i.child) {
                i.child.return = i, i = i.child;
                continue
            }
            if (i === e) break;
            for (; null === i.sibling;) {
                if (null === i.return || i.return === e) return;
                i = i.return
            }
            i.sibling.return = i.return, i = i.sibling
        }
    }

    function Ho(e) {
        for (var t = e, n = !1, r = void 0, i = void 0;;) {
            if (!n) {
                n = t.return;
                e: for (;;) {
                    switch (null === n && f("160"), n.tag) {
                        case 5:
                            r = n.stateNode, i = !1;
                            break e;
                        case 3:
                        case 4:
                            r = n.stateNode.containerInfo, i = !0;
                            break e
                    }
                    n = n.return
                }
                n = !0
            }
            if (5 === t.tag || 6 === t.tag) {
                e: for (var o = t, a = o;;)
                    if (Ro(a), null !== a.child && 4 !== a.tag) a.child.return = a, a = a.child;
                    else {
                        if (a === o) break;
                        for (; null === a.sibling;) {
                            if (null === a.return || a.return === o) break e;
                            a = a.return
                        }
                        a.sibling.return = a.return, a = a.sibling
                    }i ? (o = r, a = t.stateNode, 8 === o.nodeType ? o.parentNode.removeChild(a) : o.removeChild(a)) : r.removeChild(t.stateNode)
            }
            else if (4 === t.tag ? r = t.stateNode.containerInfo : Ro(t), null !== t.child) {
                t.child.return = t, t = t.child;
                continue
            }
            if (t === e) break;
            for (; null === t.sibling;) {
                if (null === t.return || t.return === e) return;
                4 === (t = t.return).tag && (n = !1)
            }
            t.sibling.return = t.return, t = t.sibling
        }
    }

    function Uo(e, t) {
        switch (t.tag) {
            case 2:
                break;
            case 5:
                var n = t.stateNode;
                if (null != n) {
                    var r = t.memoizedProps;
                    e = null !== e ? e.memoizedProps : r;
                    var i = t.type,
                        o = t.updateQueue;
                    t.updateQueue = null, null !== o && (n[z] = r, Ur(n, o, i, e, r))
                }
                break;
            case 6:
                null === t.stateNode && f("162"), t.stateNode.nodeValue = t.memoizedProps;
                break;
            case 3:
            case 15:
            case 16:
                break;
            default:
                f("163")
        }
    }

    function zo(e, t, n) {
        (n = xi(n)).tag = 3, n.payload = {
            element: null
        };
        var r = t.value;
        return n.callback = function() {
            Qa(r), No(e, t)
        }, n
    }

    function Go(e, t, n) {
        (n = xi(n)).tag = 3;
        var r = e.stateNode;
        return null !== r && "function" == typeof r.componentDidCatch && (n.callback = function() {
            null === aa ? aa = new Set([this]) : aa.add(this);
            var n = t.value,
                r = t.stack;
            No(e, t), this.componentDidCatch(n, {
                componentStack: null !== r ? r : ""
            })
        }), n
    }

    function Wo(e, t, n, r, i, o) {
        n.effectTag |= 512, n.firstEffect = n.lastEffect = null, r = Ui(r, n), e = t;
        do {
            switch (e.tag) {
                case 3:
                    return e.effectTag |= 1024, void Ni(e, r = zo(e, r, o), o);
                case 2:
                    if (t = r, n = e.stateNode, 0 == (64 & e.effectTag) && null !== n && "function" == typeof n.componentDidCatch && (null === aa || !aa.has(n))) return e.effectTag |= 1024, void Ni(e, r = Go(e, t, o), o)
            }
            e = e.return
        } while (null !== e)
    }

    function Vo(e) {
        switch (e.tag) {
            case 2:
                di(e);
                var t = e.effectTag;
                return 1024 & t ? (e.effectTag = -1025 & t | 64, e) : null;
            case 3:
                return Ji(), fi(), 1024 & (t = e.effectTag) ? (e.effectTag = -1025 & t | 64, e) : null;
            case 5:
                return eo(e), null;
            case 16:
                return 1024 & (t = e.effectTag) ? (e.effectTag = -1025 & t | 64, e) : null;
            case 4:
                return Ji(), null;
            case 13:
                return Ki(e), null;
            default:
                return null
        }
    }
    Mo = function() {}, xo = function(e, t, n) {
        (t.updateQueue = n) && Po(t)
    }, Lo = function(e, t, n, r) {
        n !== r && Po(t)
    };
    var Ko = $r(),
        qo = 2,
        Qo = Ko,
        $o = 0,
        Yo = 0,
        Xo = !1,
        Zo = null,
        Jo = null,
        ea = 0,
        ta = -1,
        na = !1,
        ra = null,
        ia = !1,
        oa = !1,
        aa = null;

    function sa() {
        if (null !== Zo)
            for (var e = Zo.return; null !== e;) {
                var t = e;
                switch (t.tag) {
                    case 2:
                        di(t);
                        break;
                    case 3:
                        Ji(), fi();
                        break;
                    case 5:
                        eo(t);
                        break;
                    case 4:
                        Ji();
                        break;
                    case 13:
                        Ki(t)
                }
                e = e.return
            }
        Jo = null, ea = 0, ta = -1, na = !1, Zo = null, oa = !1
    }

    function ca(e) {
        for (;;) {
            var t = e.alternate,
                n = e.return,
                r = e.sibling;
            if (0 == (512 & e.effectTag)) {
                t = Ao(t, e);
                var i = e;
                if (1073741823 === ea || 1073741823 !== i.expirationTime) {
                    var o = 0;
                    switch (i.tag) {
                        case 3:
                        case 2:
                            var a = i.updateQueue;
                            null !== a && (o = a.expirationTime)
                    }
                    for (a = i.child; null !== a;) 0 !== a.expirationTime && (0 === o || o > a.expirationTime) && (o = a.expirationTime), a = a.sibling;
                    i.expirationTime = o
                }
                if (null !== t) return t;
                if (null !== n && 0 == (512 & n.effectTag) && (null === n.firstEffect && (n.firstEffect = e.firstEffect), null !== e.lastEffect && (null !== n.lastEffect && (n.lastEffect.nextEffect = e.firstEffect), n.lastEffect = e.lastEffect), 1 < e.effectTag && (null !== n.lastEffect ? n.lastEffect.nextEffect = e : n.firstEffect = e, n.lastEffect = e)), null !== r) return r;
                if (null === n) {
                    oa = !0;
                    break
                }
                e = n
            } else {
                if (null !== (e = Vo(e))) return e.effectTag &= 511, e;
                if (null !== n && (n.firstEffect = n.lastEffect = null, n.effectTag |= 512), null !== r) return r;
                if (null === n) break;
                e = n
            }
        }
        return null
    }

    function ua(e) {
        var t = Io(e.alternate, e, ea);
        return null === t && (t = ca(e)), ot.current = null, t
    }

    function la(e, t, n) {
        Xo && f("243"), Xo = !0, t === ea && e === Jo && null !== Zo || (sa(), ea = t, ta = -1, Zo = vi((Jo = e).current, null, ea), e.pendingCommitExpirationTime = 0);
        var r = !1;
        for (na = !n || ea <= qo;;) {
            try {
                if (n)
                    for (; null !== Zo && !qa();) Zo = ua(Zo);
                else
                    for (; null !== Zo;) Zo = ua(Zo)
            } catch (t) {
                if (null === Zo) r = !0, Qa(t);
                else {
                    null === Zo && f("271");
                    var i = (n = Zo).return;
                    if (null === i) {
                        r = !0, Qa(t);
                        break
                    }
                    Wo(e, i, n, t, 0, ea), Zo = ca(n)
                }
            }
            break
        }
        if (Xo = !1, r) return null;
        if (null === Zo) {
            if (oa) return e.pendingCommitExpirationTime = t, e.current.alternate;
            na && f("262"), 0 <= ta && setTimeout(function() {
                    var t = e.current.expirationTime;
                    0 !== t && (0 === e.remainingExpirationTime || e.remainingExpirationTime < t) && Fa(e, t)
                }, ta),
                function(e) {
                    null === Ca && f("246"), Ca.remainingExpirationTime = e
                }(e.current.expirationTime)
        }
        return null
    }

    function da(e, t) {
        var n;
        e: {
            for (Xo && !ia && f("263"), n = e.return; null !== n;) {
                switch (n.tag) {
                    case 2:
                        var r = n.stateNode;
                        if ("function" == typeof n.type.getDerivedStateFromCatch || "function" == typeof r.componentDidCatch && (null === aa || !aa.has(r))) {
                            Ai(n, e = Go(n, e = Ui(t, e), 1), 1), ma(n, 1), n = void 0;
                            break e
                        }
                        break;
                    case 3:
                        Ai(n, e = zo(n, e = Ui(t, e), 1), 1), ma(n, 1), n = void 0;
                        break e
                }
                n = n.return
            }
            3 === e.tag && (Ai(e, n = zo(e, n = Ui(t, e), 1), 1), ma(e, 1)),
            n = void 0
        }
        return n
    }

    function fa() {
        var e = 2 + 25 * (1 + ((ga() - 2 + 500) / 25 | 0));
        return e <= $o && (e = $o + 1), $o = e
    }

    function pa(e, t) {
        return e = 0 !== Yo ? Yo : Xo ? ia ? 1 : ea : 1 & t.mode ? xa ? 2 + 10 * (1 + ((e - 2 + 15) / 10 | 0)) : 2 + 25 * (1 + ((e - 2 + 500) / 25 | 0)) : 1, xa && (0 === Ea || e > Ea) && (Ea = e), e
    }

    function ma(e, t) {
        for (; null !== e;) {
            if ((0 === e.expirationTime || e.expirationTime > t) && (e.expirationTime = t), null !== e.alternate && (0 === e.alternate.expirationTime || e.alternate.expirationTime > t) && (e.alternate.expirationTime = t), null === e.return) {
                if (3 !== e.tag) break;
                var n = e.stateNode;
                !Xo && 0 !== ea && t < ea && sa();
                var r = n.current.expirationTime;
                Xo && !ia && Jo === n || Fa(n, r), Na > Aa && f("185")
            }
            e = e.return
        }
    }

    function ga() {
        return Qo = $r() - Ko, qo = 2 + (Qo / 10 | 0)
    }

    function ha(e) {
        var t = Yo;
        Yo = 2 + 25 * (1 + ((ga() - 2 + 500) / 25 | 0));
        try {
            return e()
        } finally {
            Yo = t
        }
    }

    function _a(e, t, n, r, i) {
        var o = Yo;
        Yo = 1;
        try {
            return e(t, n, r, i)
        } finally {
            Yo = o
        }
    }
    var va = null,
        ba = null,
        ya = 0,
        wa = -1,
        Oa = !1,
        Ca = null,
        ka = 0,
        Ea = 0,
        ja = !1,
        Sa = !1,
        Ta = null,
        Ia = null,
        Pa = !1,
        Ma = !1,
        xa = !1,
        La = null,
        Aa = 1e3,
        Na = 0,
        Da = 1;

    function Ra(e) {
        if (0 !== ya) {
            if (e > ya) return;
            Xr(wa)
        }
        var t = $r() - Ko;
        ya = e, wa = Yr(Ha, {
            timeout: 10 * (e - 2) - t
        })
    }

    function Fa(e, t) {
        if (null === e.nextScheduledRoot) e.remainingExpirationTime = t, null === ba ? (va = ba = e, e.nextScheduledRoot = e) : (ba = ba.nextScheduledRoot = e).nextScheduledRoot = va;
        else {
            var n = e.remainingExpirationTime;
            (0 === n || t < n) && (e.remainingExpirationTime = t)
        }
        Oa || (Pa ? Ma && (Ca = e, ka = 1, Va(e, 1, !1)) : 1 === t ? Ua() : Ra(t))
    }

    function Ba() {
        var e = 0,
            t = null;
        if (null !== ba)
            for (var n = ba, r = va; null !== r;) {
                var i = r.remainingExpirationTime;
                if (0 === i) {
                    if ((null === n || null === ba) && f("244"), r === r.nextScheduledRoot) {
                        va = ba = r.nextScheduledRoot = null;
                        break
                    }
                    if (r === va) va = i = r.nextScheduledRoot, ba.nextScheduledRoot = i, r.nextScheduledRoot = null;
                    else {
                        if (r === ba) {
                            (ba = n).nextScheduledRoot = va, r.nextScheduledRoot = null;
                            break
                        }
                        n.nextScheduledRoot = r.nextScheduledRoot, r.nextScheduledRoot = null
                    }
                    r = n.nextScheduledRoot
                } else {
                    if ((0 === e || i < e) && (e = i, t = r), r === ba) break;
                    n = r, r = r.nextScheduledRoot
                }
            }
        null !== (n = Ca) && n === t && 1 === e ? Na++ : Na = 0, Ca = t, ka = e
    }

    function Ha(e) {
        za(0, !0, e)
    }

    function Ua() {
        za(1, !1, null)
    }

    function za(e, t, n) {
        if (Ia = n, Ba(), t)
            for (; null !== Ca && 0 !== ka && (0 === e || e >= ka) && (!ja || ga() >= ka);) ga(), Va(Ca, ka, !ja), Ba();
        else
            for (; null !== Ca && 0 !== ka && (0 === e || e >= ka);) Va(Ca, ka, !1), Ba();
        null !== Ia && (ya = 0, wa = -1), 0 !== ka && Ra(ka), Ia = null, ja = !1, Wa()
    }

    function Ga(e, t) {
        Oa && f("253"), Ca = e, ka = t, Va(e, t, !1), Ua(), Wa()
    }

    function Wa() {
        if (Na = 0, null !== La) {
            var e = La;
            La = null;
            for (var t = 0; t < e.length; t++) {
                var n = e[t];
                try {
                    n._onComplete()
                } catch (e) {
                    Sa || (Sa = !0, Ta = e)
                }
            }
        }
        if (Sa) throw e = Ta, Ta = null, Sa = !1, e
    }

    function Va(e, t, n) {
        Oa && f("245"), Oa = !0, n ? null !== (n = e.finishedWork) ? Ka(e, n, t) : (e.finishedWork = null, null !== (n = la(e, t, !0)) && (qa() ? e.finishedWork = n : Ka(e, n, t))) : null !== (n = e.finishedWork) ? Ka(e, n, t) : (e.finishedWork = null, null !== (n = la(e, t, !1)) && Ka(e, n, t)), Oa = !1
    }

    function Ka(e, t, n) {
        var r = e.firstBatch;
        if (null !== r && r._expirationTime <= n && (null === La ? La = [r] : La.push(r), r._defer)) return e.finishedWork = t, void(e.remainingExpirationTime = 0);
        if (e.finishedWork = null, ia = Xo = !0, (n = t.stateNode).current === t && f("177"), 0 === (r = n.pendingCommitExpirationTime) && f("261"), n.pendingCommitExpirationTime = 0, ga(), ot.current = null, 1 < t.effectTag)
            if (null !== t.lastEffect) {
                t.lastEffect.nextEffect = t;
                var i = t.firstEffect
            } else i = t;
        else i = t.firstEffect;
        Vr = In;
        var o = c();
        if (zn(o)) {
            if ("selectionStart" in o) var a = {
                start: o.selectionStart,
                end: o.selectionEnd
            };
            else e: {
                var s = window.getSelection && window.getSelection();
                if (s && 0 !== s.rangeCount) {
                    a = s.anchorNode;
                    var u = s.anchorOffset,
                        d = s.focusNode;
                    s = s.focusOffset;
                    try {
                        a.nodeType, d.nodeType
                    } catch (e) {
                        a = null;
                        break e
                    }
                    var p = 0,
                        m = -1,
                        g = -1,
                        h = 0,
                        _ = 0,
                        v = o,
                        b = null;
                    t: for (;;) {
                        for (var y; v !== a || 0 !== u && 3 !== v.nodeType || (m = p + u), v !== d || 0 !== s && 3 !== v.nodeType || (g = p + s), 3 === v.nodeType && (p += v.nodeValue.length), null !== (y = v.firstChild);) b = v, v = y;
                        for (;;) {
                            if (v === o) break t;
                            if (b === a && ++h === u && (m = p), b === d && ++_ === s && (g = p), null !== (y = v.nextSibling)) break;
                            b = (v = b).parentNode
                        }
                        v = y
                    }
                    a = -1 === m || -1 === g ? null : {
                        start: m,
                        end: g
                    }
                } else a = null
            }
            a = a || {
                start: 0,
                end: 0
            }
        } else a = null;
        for (Kr = {
                focusedElem: o,
                selectionRange: a
            }, Pn(!1), ra = i; null !== ra;) {
            o = !1, a = void 0;
            try {
                for (; null !== ra;) {
                    if (256 & ra.effectTag) {
                        var w = ra.alternate;
                        switch ((u = ra).tag) {
                            case 2:
                                if (256 & u.effectTag && null !== w) {
                                    var O = w.memoizedProps,
                                        C = w.memoizedState,
                                        k = u.stateNode;
                                    k.props = u.memoizedProps, k.state = u.memoizedState;
                                    var E = k.getSnapshotBeforeUpdate(O, C);
                                    k.__reactInternalSnapshotBeforeUpdate = E
                                }
                                break;
                            case 3:
                            case 5:
                            case 6:
                            case 4:
                                break;
                            default:
                                f("163")
                        }
                    }
                    ra = ra.nextEffect
                }
            } catch (e) {
                o = !0, a = e
            }
            o && (null === ra && f("178"), da(ra, a), null !== ra && (ra = ra.nextEffect))
        }
        for (ra = i; null !== ra;) {
            w = !1, O = void 0;
            try {
                for (; null !== ra;) {
                    var j = ra.effectTag;
                    if (16 & j && Tr(ra.stateNode, ""), 128 & j) {
                        var S = ra.alternate;
                        if (null !== S) {
                            var T = S.ref;
                            null !== T && ("function" == typeof T ? T(null) : T.current = null)
                        }
                    }
                    switch (14 & j) {
                        case 2:
                            Bo(ra), ra.effectTag &= -3;
                            break;
                        case 6:
                            Bo(ra), ra.effectTag &= -3, Uo(ra.alternate, ra);
                            break;
                        case 4:
                            Uo(ra.alternate, ra);
                            break;
                        case 8:
                            Ho(C = ra), C.return = null, C.child = null, C.alternate && (C.alternate.child = null, C.alternate.return = null)
                    }
                    ra = ra.nextEffect
                }
            } catch (e) {
                w = !0, O = e
            }
            w && (null === ra && f("178"), da(ra, O), null !== ra && (ra = ra.nextEffect))
        }
        if (T = Kr, S = c(), j = T.focusedElem, w = T.selectionRange, S !== j && l(document.documentElement, j)) {
            zn(j) && (S = w.start, void 0 === (T = w.end) && (T = S), "selectionStart" in j ? (j.selectionStart = S, j.selectionEnd = Math.min(T, j.value.length)) : window.getSelection && (S = window.getSelection(), O = j[me()].length, T = Math.min(w.start, O), w = void 0 === w.end ? T : Math.min(w.end, O), !S.extend && T > w && (O = w, w = T, T = O), O = Un(j, T), C = Un(j, w), O && C && (1 !== S.rangeCount || S.anchorNode !== O.node || S.anchorOffset !== O.offset || S.focusNode !== C.node || S.focusOffset !== C.offset) && ((k = document.createRange()).setStart(O.node, O.offset), S.removeAllRanges(), T > w ? (S.addRange(k), S.extend(C.node, C.offset)) : (k.setEnd(C.node, C.offset), S.addRange(k))))), S = [];
            for (T = j; T = T.parentNode;) 1 === T.nodeType && S.push({
                element: T,
                left: T.scrollLeft,
                top: T.scrollTop
            });
            for (j.focus(), j = 0; j < S.length; j++)(T = S[j]).element.scrollLeft = T.left, T.element.scrollTop = T.top
        }
        for (Kr = null, Pn(Vr), Vr = null, n.current = t, ra = i; null !== ra;) {
            i = !1, j = void 0;
            try {
                for (S = r; null !== ra;) {
                    var I = ra.effectTag;
                    if (36 & I) {
                        var P = ra.alternate;
                        switch (w = S, (T = ra).tag) {
                            case 2:
                                var M = T.stateNode;
                                if (4 & T.effectTag)
                                    if (null === P) M.props = T.memoizedProps, M.state = T.memoizedState, M.componentDidMount();
                                    else {
                                        var x = P.memoizedProps,
                                            L = P.memoizedState;
                                        M.props = T.memoizedProps, M.state = T.memoizedState, M.componentDidUpdate(x, L, M.__reactInternalSnapshotBeforeUpdate)
                                    }
                                var A = T.updateQueue;
                                null !== A && (M.props = T.memoizedProps, M.state = T.memoizedState, Hi(T, A, M));
                                break;
                            case 3:
                                var N = T.updateQueue;
                                if (null !== N) {
                                    if (O = null, null !== T.child) switch (T.child.tag) {
                                        case 5:
                                            O = T.child.stateNode;
                                            break;
                                        case 2:
                                            O = T.child.stateNode
                                    }
                                    Hi(T, N, O)
                                }
                                break;
                            case 5:
                                var D = T.stateNode;
                                null === P && 4 & T.effectTag && qr(T.type, T.memoizedProps) && D.focus();
                                break;
                            case 6:
                            case 4:
                            case 15:
                            case 16:
                                break;
                            default:
                                f("163")
                        }
                    }
                    if (128 & I) {
                        T = void 0;
                        var R = ra.ref;
                        if (null !== R) {
                            var F = ra.stateNode;
                            switch (ra.tag) {
                                case 5:
                                    T = F;
                                    break;
                                default:
                                    T = F
                            }
                            "function" == typeof R ? R(T) : R.current = T
                        }
                    }
                    var B = ra.nextEffect;
                    ra.nextEffect = null, ra = B
                }
            } catch (e) {
                i = !0, j = e
            }
            i && (null === ra && f("178"), da(ra, j), null !== ra && (ra = ra.nextEffect))
        }
        Xo = ia = !1, Si(t.stateNode), 0 === (t = n.current.expirationTime) && (aa = null), e.remainingExpirationTime = t
    }

    function qa() {
        return !(null === Ia || Ia.timeRemaining() > Da) && (ja = !0)
    }

    function Qa(e) {
        null === Ca && f("246"), Ca.remainingExpirationTime = 0, Sa || (Sa = !0, Ta = e)
    }

    function $a(e, t) {
        var n = Pa;
        Pa = !0;
        try {
            return e(t)
        } finally {
            (Pa = n) || Oa || Ua()
        }
    }

    function Ya(e, t) {
        if (Pa && !Ma) {
            Ma = !0;
            try {
                return e(t)
            } finally {
                Ma = !1
            }
        }
        return e(t)
    }

    function Xa(e, t) {
        Oa && f("187");
        var n = Pa;
        Pa = !0;
        try {
            return _a(e, t)
        } finally {
            Pa = n, Ua()
        }
    }

    function Za(e) {
        var t = Pa;
        Pa = !0;
        try {
            _a(e)
        } finally {
            (Pa = t) || Oa || za(1, !1, null)
        }
    }

    function Ja(e, t, n, r, i) {
        var o = t.current;
        if (n) {
            var a;
            n = n._reactInternalFiber;
            e: {
                for (2 === an(n) && 2 === n.tag || f("170"), a = n; 3 !== a.tag;) {
                    if (li(a)) {
                        a = a.stateNode.__reactInternalMemoizedMergedChildContext;
                        break e
                    }(a = a.return) || f("171")
                }
                a = a.stateNode.context
            }
            n = li(n) ? mi(n, a) : a
        } else n = d;
        return null === t.context ? t.context = n : t.pendingContext = n, t = i, (i = xi(r)).payload = {
            element: e
        }, null !== (t = void 0 === t ? null : t) && (i.callback = t), Ai(o, i, r), ma(o, r), r
    }

    function es(e) {
        var t = e._reactInternalFiber;
        return void 0 === t && ("function" == typeof e.render ? f("188") : f("268", Object.keys(e))), null === (e = un(t)) ? null : e.stateNode
    }

    function ts(e, t, n, r) {
        var i = t.current;
        return Ja(e, t, n, i = pa(ga(), i), r)
    }

    function ns(e) {
        if (!(e = e.current).child) return null;
        switch (e.child.tag) {
            case 5:
            default:
                return e.child.stateNode
        }
    }

    function rs(e) {
        var t = e.findFiberByHostInstance;
        return function(e) {
            if ("undefined" == typeof __REACT_DEVTOOLS_GLOBAL_HOOK__) return !1;
            var t = __REACT_DEVTOOLS_GLOBAL_HOOK__;
            if (t.isDisabled || !t.supportsFiber) return !0;
            try {
                var n = t.inject(e);
                ki = ji(function(e) {
                    return t.onCommitFiberRoot(n, e)
                }), Ei = ji(function(e) {
                    return t.onCommitFiberUnmount(n, e)
                })
            } catch (e) {}
            return !0
        }(a({}, e, {
            findHostInstanceByFiber: function(e) {
                return null === (e = un(e)) ? null : e.stateNode
            },
            findFiberByHostInstance: function(e) {
                return t ? t(e) : null
            }
        }))
    }
    var is = $a,
        os = function(e, t, n) {
            if (xa) return e(t, n);
            Pa || Oa || 0 === Ea || (za(Ea, !1, null), Ea = 0);
            var r = xa,
                i = Pa;
            Pa = xa = !0;
            try {
                return e(t, n)
            } finally {
                xa = r, (Pa = i) || Oa || Ua()
            }
        },
        as = function() {
            Oa || 0 === Ea || (za(Ea, !1, null), Ea = 0)
        };

    function ss(e) {
        this._expirationTime = fa(), this._root = e, this._callbacks = this._next = null, this._hasChildren = this._didComplete = !1, this._children = null, this._defer = !0
    }

    function cs() {
        this._callbacks = null, this._didCommit = !1, this._onCommit = this._onCommit.bind(this)
    }

    function us(e, t, n) {
        this._internalRoot = Ci(e, t, n)
    }

    function ls(e) {
        return !(!e || 1 !== e.nodeType && 9 !== e.nodeType && 11 !== e.nodeType && (8 !== e.nodeType || " react-mount-point-unstable " !== e.nodeValue))
    }

    function ds(e, t, n, r, i) {
        ls(n) || f("200");
        var o = n._reactRootContainer;
        if (o) {
            if ("function" == typeof i) {
                var a = i;
                i = function() {
                    var e = ns(o._internalRoot);
                    a.call(e)
                }
            }
            null != e ? o.legacy_renderSubtreeIntoContainer(e, t, i) : o.render(t, i)
        } else {
            if (o = n._reactRootContainer = function(e, t) {
                    if (t || (t = !(!(t = e ? 9 === e.nodeType ? e.documentElement : e.firstChild : null) || 1 !== t.nodeType || !t.hasAttribute("data-reactroot"))), !t)
                        for (var n; n = e.lastChild;) e.removeChild(n);
                    return new us(e, !1, t)
                }(n, r), "function" == typeof i) {
                var s = i;
                i = function() {
                    var e = ns(o._internalRoot);
                    s.call(e)
                }
            }
            Ya(function() {
                null != e ? o.legacy_renderSubtreeIntoContainer(e, t, i) : o.render(t, i)
            })
        }
        return ns(o._internalRoot)
    }

    function fs(e, t) {
        var n = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null;
        return ls(t) || f("200"),
            function(e, t, n) {
                var r = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : null;
                return {
                    $$typeof: ct,
                    key: null == r ? null : "" + r,
                    children: e,
                    containerInfo: t,
                    implementation: n
                }
            }(e, t, null, n)
    }
    Be.injectFiberControlledHostComponent(Wr), ss.prototype.render = function(e) {
        this._defer || f("250"), this._hasChildren = !0, this._children = e;
        var t = this._root._internalRoot,
            n = this._expirationTime,
            r = new cs;
        return Ja(e, t, null, n, r._onCommit), r
    }, ss.prototype.then = function(e) {
        if (this._didComplete) e();
        else {
            var t = this._callbacks;
            null === t && (t = this._callbacks = []), t.push(e)
        }
    }, ss.prototype.commit = function() {
        var e = this._root._internalRoot,
            t = e.firstBatch;
        if (this._defer && null !== t || f("251"), this._hasChildren) {
            var n = this._expirationTime;
            if (t !== this) {
                this._hasChildren && (n = this._expirationTime = t._expirationTime, this.render(this._children));
                for (var r = null, i = t; i !== this;) r = i, i = i._next;
                null === r && f("251"), r._next = i._next, this._next = t, e.firstBatch = this
            }
            this._defer = !1, Ga(e, n), t = this._next, this._next = null, null !== (t = e.firstBatch = t) && t._hasChildren && t.render(t._children)
        } else this._next = null, this._defer = !1
    }, ss.prototype._onComplete = function() {
        if (!this._didComplete) {
            this._didComplete = !0;
            var e = this._callbacks;
            if (null !== e)
                for (var t = 0; t < e.length; t++)(0, e[t])()
        }
    }, cs.prototype.then = function(e) {
        if (this._didCommit) e();
        else {
            var t = this._callbacks;
            null === t && (t = this._callbacks = []), t.push(e)
        }
    }, cs.prototype._onCommit = function() {
        if (!this._didCommit) {
            this._didCommit = !0;
            var e = this._callbacks;
            if (null !== e)
                for (var t = 0; t < e.length; t++) {
                    var n = e[t];
                    "function" != typeof n && f("191", n), n()
                }
        }
    }, us.prototype.render = function(e, t) {
        var n = this._internalRoot,
            r = new cs;
        return null !== (t = void 0 === t ? null : t) && r.then(t), ts(e, n, null, r._onCommit), r
    }, us.prototype.unmount = function(e) {
        var t = this._internalRoot,
            n = new cs;
        return null !== (e = void 0 === e ? null : e) && n.then(e), ts(null, t, null, n._onCommit), n
    }, us.prototype.legacy_renderSubtreeIntoContainer = function(e, t, n) {
        var r = this._internalRoot,
            i = new cs;
        return null !== (n = void 0 === n ? null : n) && i.then(n), ts(t, r, e, i._onCommit), i
    }, us.prototype.createBatch = function() {
        var e = new ss(this),
            t = e._expirationTime,
            n = this._internalRoot,
            r = n.firstBatch;
        if (null === r) n.firstBatch = e, e._next = null;
        else {
            for (n = null; null !== r && r._expirationTime <= t;) n = r, r = r._next;
            e._next = r, null !== n && (n._next = e)
        }
        return e
    }, qe = is, Qe = os, $e = as;
    var ps = {
        createPortal: fs,
        findDOMNode: function(e) {
            return null == e ? null : 1 === e.nodeType ? e : es(e)
        },
        hydrate: function(e, t, n) {
            return ds(null, e, t, !0, n)
        },
        render: function(e, t, n) {
            return ds(null, e, t, !1, n)
        },
        unstable_renderSubtreeIntoContainer: function(e, t, n, r) {
            return (null == e || void 0 === e._reactInternalFiber) && f("38"), ds(e, t, n, !1, r)
        },
        unmountComponentAtNode: function(e) {
            return ls(e) || f("40"), !!e._reactRootContainer && (Ya(function() {
                ds(null, null, e, !1, function() {
                    e._reactRootContainer = null
                })
            }), !0)
        },
        unstable_createPortal: function() {
            return fs.apply(void 0, arguments)
        },
        unstable_batchedUpdates: $a,
        unstable_deferredUpdates: ha,
        flushSync: Xa,
        unstable_flushControlled: Za,
        __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED: {
            EventPluginHub: B,
            EventPluginRegistry: k,
            EventPropagators: ne,
            ReactControlledComponent: Ke,
            ReactDOMComponentTree: K,
            ReactDOMEventListener: Nn
        },
        unstable_createRoot: function(e, t) {
            return new us(e, !0, null != t && !0 === t.hydrate)
        }
    };
    rs({
        findFiberByHostInstance: G,
        bundleType: 0,
        version: "16.4.0",
        rendererPackageName: "react-dom"
    });
    var ms = {
            default: ps
        },
        gs = ms && ps || ms;
    e.exports = gs.default ? gs.default : gs
}, function(e, t, n) {
    var r = n(68)("iterator"),
        i = !1;
    try {
        var o = [7][r]();
        o.return = function() {
            i = !0
        }, Array.from(o, function() {
            throw 2
        })
    } catch (e) {}
    e.exports = function(e, t) {
        if (!t && !i) return !1;
        var n = !1;
        try {
            var o = [7],
                a = o[r]();
            a.next = function() {
                n = !0
            }, o[r] = function() {
                return a
            }, e(o)
        } catch (e) {}
        return n
    }
}, function(e, t, n) {
    "use strict";

    function r(e, t, n, r, i) {
        return window.statlogsValueEvent(e, t, n, r, i)
    }

    function i(e) {
        return Math.random() < e
    }

    function o(e, t, n, o, a, s) {
        i(e) && r(t, n, o, a, s)
    }
    n.r(t), n.d(t, "statlogsValueEvent", function() {
        return r
    }), n.d(t, "randEnabled", function() {
        return i
    }), n.d(t, "statlogsProbValueEvent", function() {
        return o
    })
}, function(e, t, n) {
    var r = n(22),
        i = n(81),
        o = n(103);
    e.exports = function(e) {
        return function(t, n, a) {
            var s, c = r(t),
                u = i(c.length),
                l = o(a, u);
            if (e && n != n) {
                for (; u > l;)
                    if ((s = c[l++]) != s) return !0
            } else
                for (; u > l; l++)
                    if ((e || l in c) && c[l] === n) return e || l;
            return !e && -1
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "isWeirdLogging", function() {
        return u
    }), n.d(t, "imWeirdLog", function() {
        return l
    }), n.d(t, "imWeirdCatch", function() {
        return d
    }), n.d(t, "startLoggingAllUnhandled", function() {
        return f
    }), n.d(t, "stopLoggingAllUnhandled", function() {
        return p
    });
    var r = n(70),
        i = n(30),
        o = void 0,
        a = 1;

    function s(e, t, n, r, i) {
        if ("Script error." !== e) {
            var a = i ? i.stack || i.message : null;
            l("unhandled_error", a ? {
                err: e,
                stack: a
            } : {
                err: e
            })
        }
        o && o.apply(this, arguments)
    }

    function c(e) {
        e.preventDefault()
    }

    function u() {
        return !!window.imwl
    }

    function l(e, t) {
        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2];
        u() && (n && window.console && (console.error(e, t), console.trace && console.trace()), Object(i.retryFn)(r.post, 3, function() {
            return 2
        })("al_im.php", {
            act: "a_weird_log",
            kind: e,
            data: JSON.stringify(extend({
                errIdx: a++,
                ua: navigator.userAgent
            }, t))
        }))
    }

    function d(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};
        return l(e, extend({
            err: t && t.message || t
        }, n)), Promise.reject(t)
    }

    function f() {
        o = window.onerror, window.onerror = s, window.addEventListener("unhandledrejection", c)
    }

    function p() {
        window.onerror = o, o = void 0, window.removeEventListener("unhandledrejection", c)
    }
}, function(e, t) {
    var n = 0,
        r = Math.random();
    e.exports = function(e) {
        return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++n + r).toString(36))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(109),
        o = n(85),
        a = n(38),
        s = n(71),
        c = n(33),
        u = n(64),
        l = n(101),
        d = n(203),
        f = n(187);
    var p = Math.log2 || function(e) {
            return Math.log(e) / Math.LN2
        },
        m = i.default.getLang,
        g = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onChange = function(e) {
                    var t = e.name,
                        n = e.selected.value,
                        i = r.state.flags;
                    r.setState({
                        flags: n ? i | 1 << t : i & ~(1 << t)
                    })
                }, r.onCancel = function() {
                    r.setState({
                        flags: r.props.tab.data.flags
                    }), r.props.back()
                }, r.onSave = function() {
                    r.state.loading || (r.setState({
                        loading: !0
                    }), r.props.onSave(r.state.flags).then(function() {
                        r.setState({
                            loading: !1
                        }, r.props.afterSave)
                    }).catch(function(e) {
                        r.setState({
                            loading: !1,
                            flags: r.props.tab.data.flags
                        })
                    }))
                }, r.state = {
                    flags: n.tab.data.flags,
                    loading: !1
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this,
                    t = this.props.tab,
                    n = this.state.flags,
                    i = [{
                        value: !0,
                        label: m("mail_settings_only_admins")
                    }, {
                        value: !1,
                        label: m("mail_settings_all_members")
                    }],
                    g = t.serverSettings;
                return r.createElement("div", {
                    className: "ChatSettingsOptions"
                }, r.createElement(o.default, null, r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__select",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE),
                        options: i,
                        value: !!(n & f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE)
                    })
                }, r.createElement(d.default, {
                    type: "plus"
                }), m("mail_settings_can_invite")), r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__select",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_KICK),
                        options: i,
                        value: !!(n & f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_KICK)
                    })
                }, r.createElement(d.default, {
                    type: "remove"
                }), m("mail_settings_can_kick")), r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__select",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE),
                        options: i,
                        value: !!(n & f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE)
                    })
                }, r.createElement(d.default, {
                    type: "pencil"
                }), m("mail_settings_can_edit_info")), r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__select",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN),
                        options: i,
                        value: !!(n & f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN)
                    })
                }, r.createElement(d.default, {
                    type: "pin"
                }), m("mail_settings_can_pin")), r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__longselect",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS),
                        options: [{
                            value: !1,
                            label: m("mail_settings_only_owner")
                        }, {
                            value: !0,
                            label: m("mail_settings_owner_and_admins")
                        }],
                        value: !!(n & f.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS)
                    })
                }, r.createElement(d.default, {
                    type: "user"
                }), m("mail_settings_admins_can_add_admins")), g.map(function(t) {
                    return r.createElement(a.default, {
                        selectable: !1,
                        key: t.name,
                        aside: r.createElement(s.default, {
                            className: "ChatSettingsOptions__select",
                            onChange: e.onChange,
                            name: p(t.bit),
                            options: t.options,
                            value: !!(n & t.bit)
                        })
                    }, r.createElement(d.default, {
                        type: t.icon
                    }), t.name)
                })), r.createElement(l.default, {
                    alignment: "right"
                }, r.createElement(c.default, {
                    appearance: "tertiary",
                    onClick: this.onCancel
                }, m("global_cancel")), r.createElement(u.default, {
                    onClick: this.onSave,
                    loading: this.state.loading
                }, m("global_save"))))
            }, t
        }(r.Component);
    t.default = g
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return F
    });
    var r = n(102),
        i = n(148),
        o = n(146),
        a = n(54),
        s = n(122),
        c = n(194),
        u = n(176),
        l = n(18),
        d = "_im_create_cancel",
        f = "_im_create_list",
        p = "_im_dialog",
        m = "_im_create_tab",
        g = "_im_dialogs_creation_name",
        h = "_im_create_select",
        _ = "_im_create_avatar",
        v = "_im_create_remove_avatar",
        b = "_im_confirm_creation",
        y = "_im_cancel_creation",
        w = "_im_avatar_img",
        O = ["im-creation--item_hovered"],
        C = "olist_item_wrap_on",
        k = 100;

    function E(e, t, n, i, o, a) {
        Object(r.toggleConversation)(!1), removeClass(t, "im-create_shown"), removeClass(t, "im-create_photo-attached"), setTimeout(S.bind(null, t, !1), 100), M(a).map(function(e) {
            return geByClass1("_im_dialog" + e)
        }).forEach(function(e) {
            removeClass(e, C)
        }), n().createCanceled(e, i), o.resetSelection(), "add_member" === e.get().creationType && e.set(r.setCreationType.bind(null, "chat", [])), e.set(r.presetAvatar.bind(null, !1));
        var s = geByClass1(w, t);
        T(e, a, t), uiSearch.reset(geByClass1(g, t)), uiSearch.reset(geByClass1(h, t)), s && s.parentNode.removeChild(s), T(e, a, t), cancelStackFilter("im_search");
        var c = 0 === e.get().peer ? "search" : "default";
        e.get().longpoll.push([Object(l.transitionEvent)(c)]), attr(t, "aria-hidden", "true")
    }

    function j(e, t, n) {
        return t && (n.current_create_peer_ids = {}, n.current_create_peers = []), n.current_create_peer_ids || (n.current_create_peer_ids = {}), n.current_create_peers || (n.current_create_peers = []), e.forEach(function(e) {
            e.then(function(e) {
                e = e.filter(function(e) {
                    return !n.current_create_peer_ids[e.peerId]
                }), n.current_create_peer_ids = e.reduce(function(e, t) {
                    return e[t.peerId] = !0, e
                }, n.current_create_peer_ids), n.current_create_peers = n.current_create_peers.concat(e)
            })
        }), Promise.resolve(n)
    }

    function S(e, t) {
        toggleClass(e, "im-create_material", t)
    }

    function T(e, t, n) {
        var r = geByClass1(b, n),
            i = t.get().selection.length,
            o = i > 0,
            a = i > 1;
        "add_member" === e.get().creationType ? val(r, 1 === i ? getLang("mail_append_chat") : getLang("mail_im_create_chat_with")) : (val(r, a ? getLang("mail_im_create_chat") : getLang("mail_im_go_to_dialog")), toggleClass(n, "im-create_chat-details", a)), toggleClass(n, "im-create_tools", o), toggleClass(r, "button_disabled", !o)
    }

    function I(e, t, n, r, i, o, a) {
        if (a) {
            var s = intval(domData(a, "list-id")),
                c = M(o),
                u = trim(a.textContent),
                l = geByClass1(h, t),
                d = getSize(l)[1],
                f = void 0;
            inArray(s, c) ? (f = r.removeSelection(s, u), removeClass(a, C)) : (f = r.addSelection(s, u), addClass(a, C)), f.then(function() {
                var e = d - getSize(l)[1],
                    t = i.scrollTop();
                i.scrollTop(t - e)
            }), T(e, o, t);
            var p = geByClass1(h, t);
            uiSearch.reset(p)
        }
    }

    function P(e) {
        return Object(i.getSearchText)(e) || !1
    }

    function M(e) {
        return e.get().selection.map(function(e) {
            return e.id
        })
    }

    function x(e, t, n, r) {
        toggleClass(e, "im-create_chat", "chat" === r.get().creationType), toggleClass(e, "im-create_invite", "add_member" === r.get().creationType);
        var i = "chat" === r.get().creationType ? getLang("mail_im_group_dialog") : getLang("mail_im_friends_tab"),
            o = geByClass1("_im_create_title", e);
        val(o, i), val(geByClass1(b, e), "add_member" === r.get().creationType ? getLang("mail_im_create_chat_with") : getLang("mail_im_create_chat")), A(e, r, t, !1, n.get().selection.map(function(e) {
            return e.id
        })), Object(a.fixTableCellChildHeight)("_im_create_wrap_safe", e)
    }

    function L(e, t, n) {
        return e.then(function(e) {
            return e.filter(function(e) {
                return e.is_friend && !inArray(e.peerId, n.get().creationFilter)
            })
        })
    }

    function A(e, t, n, i, o) {
        var a = geByClass1(h, e),
            s = void 0,
            c = void 0,
            u = Object(r.searchLocalHints)(i, t.get()),
            l = n.hoverFirstElement.bind(n, O, R(t));
        t.get().creation_shown_all = !1, n.reset(), n.pipe(L(u, 0, t), i), n.toTop(), i ? (c = Object(r.searchTopConv)(i, t.get()), s = Object(r.searchHintsIndex)(i, [], "friends", t.get()), n.pipe(L(s, 0, t), i).then(l), n.pipe(L(c, 0, t), i).then(l)) : (s = Promise.resolve([]), c = Promise.resolve([])), t.set(j.bind(null, [u, c, s], !0)), uiSearch.showProgress(a), Promise.all([u, s, c]).then(function() {
            return uiSearch.hideProgress(a)
        })
    }

    function N(e, t, n, r, i, o) {
        M(t).map(function(e) {
            return geByClass1("_im_dialog" + e)
        }).forEach(function(e) {
            return removeClass(e, C)
        }), t.reset(), A(n, e, r, !1, M(t)), i.resetSelection(), E(e, n, o, !1, i, t)
    }

    function D(e, t, n, o, a, s, c) {
        var u = M(t),
            d = e.get(),
            f = geByClass1(b, n),
            p = uiSearch.getFieldEl(geByClass1(g, n)).value;
        if (0 !== u.length) {
            if ("add_member" === e.get().creationType) return e.set(r.addNewMember.bind(null, d.peer, u)).catch(function(e) {
                return showFastBox(getLang("global_error"), e)
            }), E(e, n, s, "", a, t);
            if (lockButton(f), 1 === u.length) return m(u[0]);
            e.set(r.createChat.bind(null, d.next_chat_avatar, u, p)).then(function() {
                return m(d.next_peer)
            }).catch(function(e) {
                unlockButton(f), topMsg(getLang("global_unknown_error"), 2, "#FFB4A3")
            })
        }

        function m(r) {
            N(e, t, n, o, a, s),
                function(e, t, n, r, i, o) {
                    E(e, t, n, !1, i, o), e.get().longpoll.push([Object(l.changePeer)(r, !1, !1, !1, "create_conversation")])
                }(e, n, s, r, a, t), unlockButton(f), Object(i.isSearching)(e) ? s().cancelSearch(e) : s().restoreDialogs(e)
        }
    }

    function R(e, t) {
        var n = t && t.get().selection.length;
        return {
            top: -1,
            bottom: Object(a.isClassicInterface)(e) ? n > 0 ? 69 : 0 : -1
        }
    }

    function F(e, t, n) {
        var i = Object(u.default)({
                selection: []
            }),
            g = geByClass1(f, e),
            F = Object(o.mount)(g, Object(u.default)({
                offset: 0,
                limit: k,
                elements: [],
                elCls: p
            }), function() {
                return {
                    idFn: function(e) {
                        return intval(e.peerId)
                    },
                    hoverableFn: function(e) {
                        return hasClass(e, "_im_dialog")
                    },
                    renderFn: function(e, t) {
                        var n = M(e),
                            r = ["_im_dialog", "_im_dialog" + t.peerId, "im-creation--item"],
                            i = [];
                        return t.online && i.push("online"), mobPlatforms[t.online] && i.push("mobile"), inArray(t.peerId, n) && r.push(C), getTemplate("im_owner_item", {
                            owner_id: t.peerId,
                            cls: " " + r.join(" "),
                            photo: t.photo,
                            name: t.name,
                            link: t.href,
                            img_cls: i.join(" ")
                        })
                    }.bind(null, i),
                    more: function(e, n) {
                        var o = void 0;
                        return t.get().shown ? (t.get().creation_shown_all || !1 !== P(i) ? o = Promise.resolve([]) : (t.get().creation_shown_all = !0, o = Object(r.searchTopConv)(P(i), t.get())), t.set(j.bind(null, [o], !1)), L(o, P(i), t)) : Promise.resolve(!1)
                    },
                    onClick: function(n, r) {
                        checkEvent(n) || (I(t, e, 0, H, F, i, r), cancelEvent(n))
                    }
                }
            });
        t.get().creationQuery = !1, t.get().creationType = "chat";
        var B = geByClass1(h, e),
            H = Object(s.mount)(B, i, function() {
                return {
                    selectionDeleted: function(n, r) {
                        T(t, n, e), removeClass(geByClass1("_im_dialog" + r), C)
                    },
                    onChange: function(e, t, n, r) {
                        var i = r.get(),
                            o = P(i);
                        i.selection.map(function(e) {
                            return e.id
                        }), n.unhoverElements(O), e.get().creationQuery = o, A(t, e, n, o)
                    }.bind(null, t, e, F)
                }
            }),
            U = E.bind(null, t, e, n, "cross", H, i),
            z = function(e, t, n, i, o, a, s, c) {
                uiTabs.switchTab(c.firstElementChild);
                var u = domData(c, "type");
                switch (u) {
                    case "chat":
                        a.restore()
                }
                e.set(r.setCreationType.bind(null, u, [])).then(x.bind(null, t, i, o))
            }.bind(null, t, e, n, F, i, H),
            G = function(e, t, n, i) {
                var o = 2e9 + Math.round(rand(1e6, 2e6));
                cur.recieveCropResult = function(n) {
                    cur.recieveCropResult = !1, curBox() && curBox().hide(), e.set(r.presetAvatar.bind(null, n)), Object(r.getOwnerPhoto)(n, o).then(function(e) {
                        geByClass1(_, t).appendChild(ce("img", {
                            className: "im-chat-placeholder--img " + w,
                            src: e
                        }))
                    }), addClass(t, "im-create_photo-attached")
                }, Page.ownerPhoto(o)
            }.bind(null, t, e),
            W = function(e, t) {
                geByClass1(_, t).innerHTML = "", e.set(r.presetAvatar.bind(null, !1)), removeClass(t, "im-create_photo-attached")
            }.bind(null, t, e),
            V = N.bind(null, t, i, e, F, H, n),
            K = D.bind(null, t, i, e, F, H, n),
            q = geByClass1(d, e),
            Q = Object(c.createModule)({
                handlers: function(t, n) {
                    t(q, "click", U), t(q, "mouseover", function(e, t) {
                        return showTooltip(e, {
                            text: getLang("mail_cancel"),
                            black: 1,
                            zIndex: 1e3,
                            shift: [3, -2],
                            appendCls: "js-im-page"
                        })
                    }.bind(null, q)), t(geByClass1(_, e), "click", G), t(geByClass1(v, e), "click", W), t(geByClass1(y, e), "click", V), t(geByClass1(b, e), "click", K), t(e, "mouseover", throttle(F.unhoverElements.bind(F, O), 100)), n(e, "click", m, z)
                }
            });
        return function(e, t, n, r, i, o, s, u) {
            return {
                show: function(t) {
                    var o = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
                    t.setState({
                        shown: !0
                    }), S(e, !0), cancelStackPush("im_create", s), addClass(e, "im-create_shown");
                    var a = r.get().selection.reduce(function(e, t) {
                        return e[t.id] = !0, e
                    }, {});
                    o && o.forEach(function(t) {
                        if (!a[t[0]]) {
                            var n = e.querySelector("._im_dialog" + t[0]);
                            i.addSelection(t[0], t[1]), n && !n.classList.contains(C) && n.classList.add(C)
                        }
                    }), x(e, n, r, t), setTimeout(function() {
                        t.get().longpoll.push([Object(l.transitionEvent)("create")]), attr(e, "aria-hidden", "false"), i.focus()
                    }, 1)
                },
                focusSearch: function(e) {
                    i.focus()
                },
                confirmCreate: function(e) {
                    u()
                },
                hide: function(n) {
                    n.get().shown = !1, E(n, e, t, !1, i, r)
                },
                scroll: function(e) {
                    n.scrollPage(e, !0)
                },
                updateScroll: function() {
                    Object(a.fixTableCellChildHeight)("_im_create_wrap_safe", e), n.updateScroll()
                },
                selectElement: function(t) {
                    I(t, e, 0, i, n, r, n.getHoveredElement())
                },
                hoverPrevElement: function(e) {
                    n.hoverPrevElement(O, null, R(e, r))
                },
                hoverNextElement: function(e) {
                    n.hoverNextElement(O, null, R(e, r))
                },
                unmount: function() {
                    Object(c.destroyModule)(o), n.unmount(), i.unmount(), cancelStackFilter("im_create"), cur.recieveCropResult = void 0
                }
            }
        }(e, n, F, i, H, Q, U, K)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "SENDING_CLASS", function() {
        return b
    }), n.d(t, "FAILED_CLASS", function() {
        return y
    }), n.d(t, "ORIGINAL_CLASS", function() {
        return w
    }), n.d(t, "RESTORE_CLASS", function() {
        return O
    }), n.d(t, "TYPING_CLASS", function() {
        return C
    }), n.d(t, "CREATE_CHAT_ACTION", function() {
        return k
    }), n.d(t, "CHAT_TITLE_ACTION", function() {
        return E
    }), n.d(t, "CHAT_INVITE_USER", function() {
        return j
    }), n.d(t, "CHAT_KICK_USER", function() {
        return S
    }), n.d(t, "CHAT_PHOTO_UPDATE", function() {
        return T
    }), n.d(t, "CHAT_PHOTO_REMOVE", function() {
        return I
    }), n.d(t, "CHAT_PIN_MESSAGE", function() {
        return P
    }), n.d(t, "CHAT_UNPIN_MESSAGE", function() {
        return M
    }), n.d(t, "CHAT_INVITE_BY_LINK", function() {
        return x
    }), n.d(t, "DESELECT_ALL_CLASS", function() {
        return L
    }), n.d(t, "SHOW_CHAT_MEMBERS_CLASS", function() {
        return A
    }), n.d(t, "HIDE_TOP_NOTICE_CLASS", function() {
        return N
    }), n.d(t, "HIDE_ASIDE_NOTICE_CLASS", function() {
        return D
    }), n.d(t, "HIDE_ASIDE_PROMO_BLOCK_CLASS", function() {
        return R
    }), n.d(t, "INSTALL_VKADMIN_LINK", function() {
        return F
    }), n.d(t, "CLEAR_RECENT_CLASS", function() {
        return B
    }), n.d(t, "MESSAGE_SEARCH_CLASS", function() {
        return H
    }), n.d(t, "PINNED_CONTAINER_CLASS", function() {
        return U
    }), n.d(t, "getClassicChatHeight", function() {
        return Ge
    }), n.d(t, "setClassicChatHeight", function() {
        return We
    }), n.d(t, "fixTableCellChildHeight", function() {
        return Ve
    }), n.d(t, "applyInnerHtml", function() {
        return Ke
    }), n.d(t, "compensateHistoryHeightChange", function() {
        return qe
    }), n.d(t, "renderSticker", function() {
        return Qe
    }), n.d(t, "isAlreadyDeleted", function() {
        return $e
    }), n.d(t, "replaceMessageAttrs", function() {
        return Ye
    }), n.d(t, "isVoiceMessageAvailable", function() {
        return Xe
    }), n.d(t, "getAvailableMicrophones", function() {
        return Ze
    }), n.d(t, "renderAttach", function() {
        return Je
    }), n.d(t, "dayFromVal", function() {
        return et
    }), n.d(t, "showInvisibleBar", function() {
        return tt
    }), n.d(t, "updateMessageInCache", function() {
        return nt
    }), n.d(t, "editAndReplaceMessage", function() {
        return rt
    }), n.d(t, "renderMessage", function() {
        return it
    }), n.d(t, "renderMessageMedia", function() {
        return ot
    }), n.d(t, "ensureDomHasActions", function() {
        return at
    }), n.d(t, "renderCallMessage", function() {
        return st
    }), n.d(t, "appendToHistory", function() {
        return ct
    }), n.d(t, "restoreQueue", function() {
        return ut
    }), n.d(t, "markMessagesAsRead", function() {
        return lt
    }), n.d(t, "replaceAttaches", function() {
        return dt
    }), n.d(t, "isDuplicate", function() {
        return ft
    }), n.d(t, "isReservedPeer", function() {
        return pt
    }), n.d(t, "isUserPeer", function() {
        return mt
    }), n.d(t, "isChatPeer", function() {
        return gt
    }), n.d(t, "isPeerActive", function() {
        return ht
    }), n.d(t, "isFvkcomgroup", function() {
        return _t
    }), n.d(t, "isTabLoaded", function() {
        return vt
    }), n.d(t, "isTabLoadedWithMessage", function() {
        return bt
    }), n.d(t, "parseMessage", function() {
        return Ct
    }), n.d(t, "convertPeerToUrl", function() {
        return kt
    }), n.d(t, "unUrlPeer", function() {
        return Et
    }), n.d(t, "simplifyCounter", function() {
        return jt
    }), n.d(t, "chatActions", function() {
        return St
    }), n.d(t, "renderPhotos", function() {
        return Pt
    }), n.d(t, "renderPhotosFromTab", function() {
        return Mt
    }), n.d(t, "renderBtnSearchOnlyMessages", function() {
        return xt
    }), n.d(t, "renderMessagesSep", function() {
        return Lt
    }), n.d(t, "renderConversationsSep", function() {
        return At
    }), n.d(t, "renderPopularSuggSep", function() {
        return Nt
    }), n.d(t, "renderClearRecent", function() {
        return Dt
    }), n.d(t, "renderPopularSuggestions", function() {
        return Rt
    }), n.d(t, "setMessageError", function() {
        return Ft
    }), n.d(t, "startResendMessage", function() {
        return Bt
    }), n.d(t, "removeMessages", function() {
        return Ht
    }), n.d(t, "removeStartingFromMessage", function() {
        return zt
    }), n.d(t, "removeMessagesWithRestore", function() {
        return Gt
    }), n.d(t, "restoreMessage", function() {
        return Wt
    }), n.d(t, "formatTyper", function() {
        return Vt
    }), n.d(t, "renderEmptySearch", function() {
        return qt
    }), n.d(t, "serviceLink", function() {
        return Qt
    }), n.d(t, "renderServiceMsg", function() {
        return $t
    }), n.d(t, "addChatPhotoToUpdate", function() {
        return Yt
    }), n.d(t, "replaceSpecialSymbols", function() {
        return Xt
    }), n.d(t, "isSelfMessage", function() {
        return Zt
    }), n.d(t, "showVerifiedTooltip", function() {
        return Jt
    }), n.d(t, "wrapLoading", function() {
        return en
    }), n.d(t, "tabFromIds", function() {
        return tn
    }), n.d(t, "checkSelectClick", function() {
        return nn
    }), n.d(t, "renderGoTo", function() {
        return rn
    }), n.d(t, "showFlushDialog", function() {
        return on
    }), n.d(t, "showUnpinDialog", function() {
        return an
    }), n.d(t, "showMsgDeleteDialog", function() {
        return sn
    }), n.d(t, "cleanHistory", function() {
        return cn
    }), n.d(t, "showChatMembers", function() {
        return un
    }), n.d(t, "inviteUser", function() {
        return ln
    }), n.d(t, "showUnreadOnly", function() {
        return dn
    }), n.d(t, "changeTab", function() {
        return fn
    }), n.d(t, "isImportant", function() {
        return pn
    }), n.d(t, "isUnrespond", function() {
        return mn
    }), n.d(t, "isPeerBlocked", function() {
        return gn
    }), n.d(t, "isPendingForward", function() {
        return hn
    }), n.d(t, "isPeerBlockedByMe", function() {
        return _n
    }), n.d(t, "blockLatencyCompensation", function() {
        return vn
    }), n.d(t, "showSpamLayer", function() {
        return bn
    }), n.d(t, "getLastSeenTextInHeader", function() {
        return yn
    }), n.d(t, "getLastSeenText", function() {
        return wn
    }), n.d(t, "showBlacklistBoxUser", function() {
        return Cn
    }), n.d(t, "showBlacklistBox", function() {
        return kn
    }), n.d(t, "getBaseLink", function() {
        return En
    }), n.d(t, "showFavvedBox", function() {
        return jn
    }), n.d(t, "isEditableFocused", function() {
        return Sn
    }), n.d(t, "updateStar", function() {
        return Tn
    }), n.d(t, "removewNewUnreadBarAndMerge", function() {
        return In
    }), n.d(t, "isMessagesVisible", function() {
        return Pn
    }), n.d(t, "hideTopNotice", function() {
        return Mn
    }), n.d(t, "hideAsideNotice", function() {
        return xn
    }), n.d(t, "hideAsidePromoBlock", function() {
        return Ln
    }), n.d(t, "installVKAdminApp", function() {
        return An
    }), n.d(t, "renderShortText", function() {
        return Nn
    }), n.d(t, "attachToText", function() {
        return Dn
    }), n.d(t, "lockButton", function() {
        return Rn
    }), n.d(t, "unlockButton", function() {
        return Fn
    }), n.d(t, "renderPinnedMessage", function() {
        return Bn
    }), n.d(t, "renderPinnedMedia", function() {
        return Hn
    }), n.d(t, "showEditTimeTooltip", function() {
        return Un
    }), n.d(t, "getPinnedMessageHeight", function() {
        return zn
    }), n.d(t, "boxHandleEditTimeTooltips", function() {
        return Gn
    }), n.d(t, "showPinnedBox", function() {
        return Wn
    }), n.d(t, "isUserAliveInChat", function() {
        return Vn
    }), n.d(t, "getAliveMembersCount", function() {
        return Kn
    }), n.d(t, "normalizeTab", function() {
        return qn
    }), n.d(t, "normalizeTabsGotFromServer", function() {
        return Qn
    }), n.d(t, "splitMessageToParts", function() {
        return $n
    }), n.d(t, "isMessageTooLong", function() {
        return Yn
    }), n.d(t, "showInvitationBox", function() {
        return Xn
    }), n.d(t, "showWaitUntilUploadedBox", function() {
        return Zn
    }), n.d(t, "canMessageBeDeletedForAll", function() {
        return Jn
    }), n.d(t, "getTopChatMembers", function() {
        return er
    }), n.d(t, "getChatMembersByIds", function() {
        return tr
    }), n.d(t, "getChatMembers", function() {
        return nr
    }), n.d(t, "formatTimespan", function() {
        return rr
    });
    var r = n(18),
        i = n(128),
        o = n(194),
        a = n(148);
    n.d(t, "getFirstUnread", function() {
        return a.getFirstUnread
    }), n.d(t, "isSearchShown", function() {
        return a.isSearchShown
    }), n.d(t, "getPeer", function() {
        return a.getPeer
    }), n.d(t, "getCurrentKeyboard", function() {
        return a.getCurrentKeyboard
    }), n.d(t, "getKeyboard", function() {
        return a.getKeyboard
    }), n.d(t, "getTab", function() {
        return a.getTab
    }), n.d(t, "getCurrentTab", function() {
        return a.getCurrentTab
    }), n.d(t, "getSelectedMessages", function() {
        return a.getSelectedMessages
    }), n.d(t, "getMessageRangeFromSelection", function() {
        return a.getMessageRangeFromSelection
    }), n.d(t, "countUnread", function() {
        return a.countUnread
    }), n.d(t, "getMessageByRid", function() {
        return a.getMessageByRid
    }), n.d(t, "isRidExist", function() {
        return a.isRidExist
    }), n.d(t, "getLocalId", function() {
        return a.getLocalId
    }), n.d(t, "getLastMessage", function() {
        return a.getLastMessage
    }), n.d(t, "parserMessage", function() {
        return a.parserMessage
    }), n.d(t, "getAuthorFullName", function() {
        return a.getAuthorFullName
    }), n.d(t, "getMessage", function() {
        return a.getMessage
    }), n.d(t, "getPreviousMessage", function() {
        return a.getPreviousMessage
    }), n.d(t, "isClassicInterface", function() {
        return a.isClassicInterface
    }), n.d(t, "isLocksAvailable", function() {
        return a.isLocksAvailable
    }), n.d(t, "isFoldersAvailable", function() {
        return a.isFoldersAvailable
    }), n.d(t, "isCommunityInterface", function() {
        return a.isCommunityInterface
    }), n.d(t, "getBareTab", function() {
        return a.getBareTab
    }), n.d(t, "isReversedDialogs", function() {
        return a.isReversedDialogs
    }), n.d(t, "isFullyLoadedTab", function() {
        return a.isFullyLoadedTab
    }), n.d(t, "makeTabNotFullyLoaded", function() {
        return a.makeTabNotFullyLoaded
    }), n.d(t, "isGoToEndVisible", function() {
        return a.isGoToEndVisible
    }), n.d(t, "getUnreadScrollBottom", function() {
        return a.getUnreadScrollBottom
    }), n.d(t, "isSendingAvailable", function() {
        return a.isSendingAvailable
    }), n.d(t, "isCommunityPeer", function() {
        return a.isCommunityPeer
    }), n.d(t, "isCommunityBlocked", function() {
        return a.isCommunityBlocked
    }), n.d(t, "checkVoiceMessageAvailable", function() {
        return a.checkVoiceMessageAvailable
    }), n.d(t, "isSearching", function() {
        return a.isSearching
    }), n.d(t, "getSearchText", function() {
        return a.getSearchText
    }), n.d(t, "isSearchingValue", function() {
        return a.isSearchingValue
    }), n.d(t, "isRecentSearchesActive", function() {
        return a.isRecentSearchesActive
    }), n.d(t, "getPinnedMessage", function() {
        return a.getPinnedMessage
    }), n.d(t, "doPopularSuggExist", function() {
        return a.doPopularSuggExist
    }), n.d(t, "isAnyMessageBeingEdited", function() {
        return a.isAnyMessageBeingEdited
    }), n.d(t, "getGroupId", function() {
        return a.getGroupId
    }), n.d(t, "getTabDraft", function() {
        return a.getTabDraft
    });
    var s = n(26),
        c = n(69),
        u = n(105),
        l = n(7),
        d = n(11),
        f = n(160),
        p = n(72),
        m = n(102),
        g = n(50),
        h = n(187),
        _ = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        v = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };
    var b = "_im_mess_sending",
        y = "_im_mess_failed",
        w = "_im_mess_original",
        O = "_im_mess_restore",
        C = "_im_typing",
        k = "chat_create",
        E = "chat_title_update",
        j = "chat_invite_user",
        S = "chat_kick_user",
        T = "chat_photo_update",
        I = "chat_photo_remove",
        P = "chat_pin_message",
        M = "chat_unpin_message",
        x = "chat_invite_user_by_link",
        L = "_im_deselect_all",
        A = "_im_show_chat_mems",
        N = "_im_top_notice_hide",
        D = "_im_aside_notice_hide",
        R = "_im_aside_promo_block_hide",
        F = "_im_vkadmin_promo_link",
        B = "_im_clear_recent",
        H = "_im_mess_search",
        U = "_im_pinned",
        z = window,
        G = z.vk,
        W = z.ls,
        V = z.se,
        K = z.re,
        q = z.rs,
        Q = z.sech,
        $ = z.inArray,
        Y = z.intval,
        X = z.trim,
        Z = z.stripHTML,
        J = z.domFC,
        ee = z.domPS,
        te = z.domLC,
        ne = z.domChildren,
        re = z.domClosestSibling,
        ie = z.domData,
        oe = z.geByClass,
        ae = z.geByClass1,
        se = z.gpeByClass,
        ce = z.addClass,
        ue = z.removeClass,
        le = z.toggleClass,
        de = z.hasClass,
        fe = z.attr,
        pe = z.setStyle,
        me = z.val,
        ge = z.getTemplate,
        he = z.getLang,
        _e = z.langSex,
        ve = z.langDate,
        be = z.langNumeric,
        ye = z.getDateText,
        we = z.getSmDate,
        Oe = z.getShortDate,
        Ce = z.isSameDate,
        ke = z.isToday,
        Ee = z.ajax,
        je = z.showBox,
        Se = z.showFastBox,
        Te = z.showTabbedBox,
        Ie = z.showTooltip,
        Pe = z.mobPlatforms,
        Me = z.onlinePlatformClass,
        xe = z.AudioMessagePlayer,
        Le = z.Emoji,
        Ae = z.slideUp,
        Ne = z.fadeOut,
        De = z.cancelEvent,
        Re = z.fifaReplaceText,
        Fe = 4096,
        Be = 100,
        He = 8,
        Ue = 52,
        ze = "chatPosition";

    function Ge() {
        return W.get(ze) || 0
    }

    function We(e) {
        e >= window.clientHeight() - 30 && (e = 0), W.set(ze, e)
    }

    function Ve(e, t) {
        var n = ae(e, t);
        n.firstElementChild.offsetHeight !== n.parentNode.offsetHeight && pe(n.firstElementChild, {
            height: n.parentNode.offsetHeight
        })
    }

    function Ke(e, t) {
        e && e.innerHTML !== t && (e.innerHTML = t)
    }

    function qe(e, t, n, r) {
        var i = t && !n ? 1 : !t && n ? -1 : 0;
        i && !Object(a.isClassicInterface)(e) && r().compensateHistoryHeightChange(i)
    }

    function Qe(e, t, n, r) {
        var i = window.devicePixelRatio >= 2 ? "256" : "128",
            o = "animation" === n,
            a = "im_gift";
        o && (a += " sticker_img");
        var s = '<img height="128" class="' + a + '" src="' + ("/images/stickers/" + Y(e) + "/" + i + ".png") + '"/>';
        if (o) {
            var c = "animatedSticker" + r;
            s = '<div id="' + c + '" data-loop-count=3 data-animation-path="' + ("/stickers.php?act=proxy_animation&product_id=" + t + "&sticker_id=" + e) + '" onmouseenter="StickersAnimation.loadAndPlaySticker(this);"\n     data-uniq-id="' + r + '" data-sticker-id="' + Y(e) + '" class="sticker_animation sticker_animation_128 im_gift">' + s + "</div>";
            var u = !1;
            browser.msie ? (0 ^ r) === r && (u = !0) : u = Number.isInteger(r), u && window.StickersSettings.getAutoplay() && window.StickersAnimation && window.StickersAnimation.loadAndPlayStickerWithTimer(c, 10)
        }
        return t && (s = '<a onmouseover="return Emoji.stickerOver(' + Y(e) + ', this);"\n        onclick="return Emoji.clickSticker(' + Y(t) + ', this, event);">' + s + "</a>"), s = '<div class="im_sticker_row">' + s + "</div>"
    }

    function $e(e, t, n) {
        var r = e.get ? e.get() : e;
        if (vt(r, t)) {
            var i = r.tabs[t].deleted || [];
            return $(n, i)
        }
        return !1
    }

    function Ye(e, t, n) {
        var r = n.randomId,
            i = ae("_im_mess_rid" + r, t);
        return i && (t = ct(e, n, t = Ut([i], t), !0, !1)), t
    }

    function Xe(e) {
        var t = Object(a.checkVoiceMessageAvailable)(e);
        return browser.mobile && browser.safari ? Promise.resolve(!1) : void 0 !== t ? Promise.resolve(t) : Ze().then(function(e) {
            return e.length > 0
        }).catch(function(e) {
            return !1
        })
    }

    function Ze() {
        return window.AudioContext && navigator.mediaDevices ? navigator.mediaDevices.enumerateDevices().then(function(e) {
            for (var t = [], n = 0; n < e.length; n++) "audioinput" == e[n].kind && t.push(e[n]);
            return t
        }) : Promise.reject(new Error("NotSupported"))
    }

    function Je(e) {
        return ge("im_preloader", {
            preloader: q(G.pr_tpl, {
                id: ""
            }),
            cls: "im-preloader_attach im-preloader_visible im-preloader_" + e
        })
    }

    function et(e) {
        var t = e.split(".");
        return (t[0] < 10 ? "0" : "") + t[0] + (t[1] < 10 ? "0" : "") + t[1] + t[2]
    }

    function tt(e) {
        var t = ae("_im_invisible_bar", e);
        t && (ue(t, "_im_invisible_bar"), ue(t, "im-page--history-new-bar_hide"))
    }

    function nt(e, t, n) {
        var r = ie(n, "msgid"),
            i = ae("_im_mess_" + r, t),
            o = n.cloneNode(!0);
        return i && (i.parentNode.replaceChild(o, i), at(t)), t
    }

    function rt(e, t, n) {
        var r = it(e, t),
            i = ae("_im_mess_" + t.messageId, n);
        return i && (i.parentNode.replaceChild(V(r), i), at(n)), n
    }

    function it(e, t) {
        var n = ["_im_mess"],
            r = Object(s.isUnread)(e.tabs[t.peerId], t);
        Object(s.isOut)(t) && r && n.push("im-mess_unread _im_mess_unread"), Object(s.isOut)(t) && n.push("im-mess_out"), Object(s.wasEdited)(t) && n.push("im-mess_was_edited"), Object(p.canMessageBeEdited)(e, t) && n.push("im-mess_editable"), Object(s.isImportant)(t) && n.push("im-mess_fav"), -1 != (e.selectedMessages || []).indexOf(t.messageId) && n.push("im-mess_selected");
        var i = Date.now() - 1e3 * t.date > 1e3;
        t.local && i && n.push("im-mess_sending"), t.local && n.push("" + b), t.local && Object(s.wasEdited)(t) && !r && n.push("im-mess_unread im-mess_nobg"), t.failed && n.push("im-mess_failed " + y), Object(s.isGift)(t) && n.push("im-mess_gift");
        var o = ot(t),
            a = Ct(e, t.text, t.kludges, !1, t.peerId);
        "" != a && Object(s.wasEdited)(t) && (a += ge("sImLblWasEdited", {
            update_time: t.update_time
        })), t.subject && "..." !== t.subject.trim() && !gt(t.peerId) && (a = ge("im_topic", {
            topic: t.subject
        }) + a);
        var c = ge("im_message_media", {
            messageId: t.messageId,
            attaches: o.join(""),
            text: Object(s.isGift)(t) ? '<div class="im-mess--gift-lbl">' + a + "</div>" : ""
        });
        return Object(s.isGift)(t) || (c = a + c), "" == a && Object(s.wasEdited)(t) && (c += ge("sImLblWasEdited", {
            update_time: t.update_time
        })), ge("im_msg_row", {
            msg_id: t.messageId,
            from_id: t.peerId,
            text: c,
            aria_hidden: t.local && !t.failed ? "true" : "false",
            ts: t.date,
            marker_params: t.failed ? 'aria-label="' + he("mail_send_message_error") + '" role="link"' : "",
            unread_params: r ? 'aria-label="' + he("mail_unread_message") + '"' : "",
            cls: n.join(" ")
        })
    }

    function ot(e) {
        return e.attaches.map(function(t) {
            return "sticker" === t.type ? e.messageId ? Qe(t.id, t.productId, t.kind, e.messageId) : Qe(t.id, t.productId) : Je(t.type)
        })
    }

    function at(e) {
        for (var t = e.getElementsByClassName("_im_mess_noa"), n = t.length; n--;) de(t[n], "im-mess_fwd") || t[n].insertAdjacentHTML("afterbegin", ge("sImHistoryRowActions")), ue(t[n], "_im_mess_noa")
    }

    function st(e, t, n) {
        var r, i, o, a, s, c = G.id,
            u = e.attaches[0],
            l = u.initiatorId,
            f = u.state,
            p = u.receiverId,
            m = void 0;
        switch (f) {
            case "reached":
                m = he(c === l ? "mail_call_outgoing" : "mail_call_incoming");
                var g = t ? "" : (r = u.duration, i = Math.floor(r / 3600), o = Math.floor(r / 60) - 60 * i, a = !1, s = !1, [i, o, r - 3600 * i - 60 * o].reduce(function(e, t) {
                    return 0 !== t || s ? (a && (t = t < 10 ? "0" + t : t), a = !0, s = !0, e + ("" !== e ? ":" : "") + t) : (s = !0, e)
                }, ""));
                m = m.replace("{duration}", g);
                break;
            case "canceled_by_initiator":
                m = he(c === l ? "mail_call_canceled" : "mail_call_missed");
                break;
            case "canceled_by_receiver":
                if (c === l) {
                    if (t) return he("mail_call_declined");
                    var h = Object(d.oCacheGet)(n, p);
                    return h ? _e(h.sex, he("mail_call_declined_by", "raw")).replace("{user_name}", h.first_name) : he("mail_call_declined")
                }
                return he("mail_call_canceled");
            default:
                m = he("mail_added_call")
        }
        return ge("im_calls_link", {
            text: m
        })
    }

    function ct(e, t, n) {
        !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3];
        var r = !(arguments.length > 4 && void 0 !== arguments[4]) || arguments[4],
            i = !(arguments.length > 5 && void 0 !== arguments[5]) || arguments[5],
            o = Date.now() - 1e3 * t.date > 1e3,
            c = e.tabs[t.peerId];
        if (!n || ae("_im_mess", n) || ae("_im_bar_date", n) || (n.innerHTML = ""), c.skipped > 0) return n;
        var u = [];
        t.local || (u = e.imQueue(t.peerId, r)), u.length > 0 && Ut(u.map(function(e) {
            return ae("_im_mess_rid" + e.rid, n)
        }, n).filter(function(e) {
            return e
        }));
        var f = it(e, t),
            p = te(n);
        de(p, "_im_mess_stack") || (p = re(p, "._im_mess_stack", -1));
        for (var m = Object(a.getLastMessage)(e, t.peerId, t.messageId); t.peerId === e.peer && m && !ae("_im_mess_" + m.messageId);) m = Object(a.getLastMessage)(e, t.peerId, m.messageId);
        var g = ae("_im_unread_bar_row", n),
            h = Object(s.getUserId)(t),
            _ = m ? yt(m.date, e) : 0;
        if (!m || wt(c, m, t, e, i)) {
            var v = "",
                y = !1;
            if (g && Object(s.isOut)(t) && In(e, n, t.peerId), 1 === c.unread && !Object(s.isOut)(t) && i && (v += ge("im_mess_bar", {}), y = !0, In(e, n, t.peerId)), !ke(new Date(_))) {
                var w = new Date,
                    O = y ? "im-page--history-new-bar_hide _im_invisible_bar" : "";
                v += ge("im_day_bar", {
                    day: Oe(t.date, e.timeshift, !0, he("months_of", "raw"), !0),
                    date: t.date,
                    day_class: w.getDate() + w.getMonth() + w.getFullYear() + " " + O
                })
            }
            if (Object(s.isServiceMsg)(t)) v += ge("im_service_row", {
                text: $t(e, t, c),
                type: "",
                date: t.date,
                from_id: "",
                message_id: t.messageId
            });
            else if (Object(s.isCallMessage)(t)) v += ge("im_service_row", {
                text: Qt("", st(t, !1, e), ""),
                type: "",
                date: t.date,
                from_id: "",
                message_id: t.messageId
            });
            else {
                var C = e.gid && Object(s.isOut)(t) ? Y(t.kludges.from_admin) || -e.gid : 0,
                    k = Object(d.oCacheGet)(e, C ? -e.gid : h) || c,
                    E = gt(t.peerId) ? k.name : k.first_name,
                    j = k.link || c.href,
                    S = ge("im_mess_stack_name", {
                        name: E,
                        link: j,
                        class: Object(s.isMoney)(t) ? " im-mess-stack--lnk-money-transfer" : ""
                    });
                if (Object(s.isGift)(t)) {
                    var T = he("mail_gift_message_sent", "raw");
                    S += ' <span class="im-mess-stack--gift">' + _e(k.sex || 0, T) + "</span>"
                }
                if (Object(s.isMoney)(t)) {
                    var I = Object(s.isMoneyRequest)(t) ? he("mail_money_request_message_sent", "raw") : he("mail_money_tranfer_message_sent", "raw");
                    S += ' <span class="im-mess-stack--money-transfer">' + _e(k.sex || 0, I) + "</span>"
                }
                var P = e.gid ? "/gim" + e.gid : "/im",
                    M = void 0;
                if (M = t.local ? Ot(t.date, e.timeshift) : ge("im_stack_date", {
                        date: Ot(t.date, e.timeshift),
                        link: P + "?sel=" + t.peerId + "&msgid=" + t.messageId
                    }), C && e.admins[C]) {
                    var x = e.admins[C],
                        L = C === G.id ? he("mail_by_you") : x[0];
                    M = M + " " + ge("im_admin_link", {
                        name: L,
                        href: x[1]
                    })
                }
                v += ge("im_mess_stack", {
                    photo: k.photo,
                    href: j,
                    cls: "",
                    date_attr: "",
                    link: "/im?sel=" + t.peerId + "&msgid=" + t.messageId,
                    name: Z(S),
                    stack_name: S,
                    peerId: h,
                    date: M,
                    messages: f,
                    admin: t.kludges.from_admin || 0
                })
            }
            Object(l.toArray)(Q(v)).forEach(function(e) {
                return n && n.appendChild(e)
            })
        } else g && e.peer === t.peerId && !c.inplaceSearch && Object(s.isOut)(t) && In(e, n, t.peerId), ae("_im_stack_messages", p).appendChild(V(f));
        return Object(s.isOut)(t) && !o && setTimeout(function() {
            var e = ae("_im_mess_" + t.messageId, n);
            de(e, b) && ce(e, "im-mess_sending")
        }, 500), u = u.filter(function(e) {
            return e.rid !== t.randomId
        }), at(n), ut(u, e, n)
    }

    function ut(e, t, n) {
        var r = void 0;
        return (r = "object" === (void 0 === e ? "undefined" : v(e)) ? e : t.imQueue(e, !1)).length > 0 && r.map(function(e) {
            return e.mess.failed = !!e.failed, e.mess
        }).filter(function(e) {
            return Object(a.getMessage)(t, e.peerId, e.messageId)
        }).forEach(function(e) {
            return ct(t, e, n, !1)
        }), n
    }

    function lt(e, t, n) {
        var r = e.tabs[t];
        return Object(l.toArray)(oe("_im_mess_unread", n)).forEach(function(e) {
            var t, n = Y(ie(e, "msgid"));
            n > 0 && r.out_up_to >= n && (ue(e, "_im_mess_unread"), ue(e, "im-mess_unread"), (t = ae("_im_mess_blind_unread_marker", e)) && (t.removeAttribute("aria-label"), t.removeAttribute("role"), t.removeAttribute("tabindex")))
        }), n
    }

    function dt(e, t, n) {
        var r = ae("_im_msg_media" + t.messageId, e);
        return r && (r.innerHTML = n.tabs[t.peerId].mediacontent[t.messageId][0]), e
    }

    function ft(e, t) {
        if (!Object(a.isFullyLoadedTab)(t, e.peerId)) return 0;
        var n = t.tabs[e.peerId];
        return n.msgs[e.messageId] ? 1 : n.msgs["rid" + e.randomId] ? 2 : 0
    }

    function pt(e) {
        return 0 == e
    }

    function mt(e) {
        return e > 0 && e < 2e9
    }

    function gt(e) {
        return e > 2e9
    }

    function ht(e, t) {
        return e === t.peer
    }

    function _t(e, t) {
        return Object(h.doesChatTabHaveFlag)(Object(a.getTab)(e, t), 1024)
    }

    function vt(e, t) {
        return !!e.tabs[t]
    }

    function bt(e, t) {
        return !!vt(e, t) && null !== e.tabs[t].lastmsg
    }

    function yt(e, t) {
        return 1e3 * e + 1e3 * t.timeshift
    }

    function wt(e, t, n, r, i) {
        if (Object(s.getUserId)(t) !== Object(s.getUserId)(n)) return !0;
        var o = yt(t.date, r),
            c = yt(n.date, r);
        return !Ce(o, c) || (!(!Object(a.isCommunityInterface)(r) || Y(t.kludges.from_admin) === Y(n.kludges.from_admin)) || (n.date - t.date > 300 || (!(!Object(s.isServiceMsg)(t) && !Object(s.isServiceMsg)(n)) || (!(!Object(s.isCallMessage)(n) && !Object(s.isCallMessage)(t)) || (!(!Object(s.isGift)(t) && !Object(s.isGift)(n)) || (!(!Object(s.isGraffiti)(t) && !Object(s.isGraffiti)(n)) || !(Object(s.isUnread)(e, t) === Object(s.isUnread)(e, n) || !i || Object(s.isOut)(n) || Zt(n.peerId, r.gid))))))))
    }

    function Ot(e, t) {
        return ve(1e3 * e, "{hour}:{minute} {am_pm}", 1e3 * t, [], !0)
    }

    function Ct(e, t, n) {
        var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
            i = arguments.length > 4 && void 0 !== arguments[4] && arguments[4],
            o = Math.round(1e9 * Math.random()).toString(16),
            s = {},
            u = 0;
        return t = (t = Object(c.replaceHyperLinks)(t || "", c.linksReplacer.bind(null, r))).replace(/(<a.+?<\/a>)/gi, function(e) {
            var t = "!link_" + u + "_" + o + "!";
            return s[t] = e, u++, t
        }), t = Object(c.replaceMentions)(t), t = Object(c.replaceEmailLinks)(t), t = Object(c.replaceHashtags)(t, function(t) {
            var n = Object(a.getGroupId)(e);
            return '<a href="/' + (n ? "gim" + n : "im") + "?sel=" + (i || Object(a.getPeer)(e)) + "&st=" + encodeURIComponent(t) + '">' + t + "</a>"
        }), Object.keys(s).forEach(function(e) {
            t = t.replace(e, function() {
                return s[e]
            })
        }), n.emoji && (t = Le.emojiToHTML(t, !0)), Re && (t = Re(t)), t
    }

    function kt(e) {
        return gt(e) ? "c" + (e - 2e9) : e < -2e9 ? "e" + Math.abs(e + 2e9) : e
    }

    function Et(e) {
        switch (e.substr(0, 1)) {
            case "e":
                return -2e9 - Y(e.substr(1));
            case "c":
                return 2e9 + Y(e.substr(1));
            default:
                return Y(e)
        }
    }

    function jt(e) {
        return e > 9999999 ? Math.floor(e / 1e6) + "M" : e > 9999 ? Math.floor(e / 1e3) + "K" : e > 0 ? e.toString() : ""
    }

    function St(e, t) {
        return {
            search: {
                name: he("mail_im_peer_search"),
                icon: "search"
            },
            block_community: {
                icon: "block",
                name: he("mail_block_comm_messages")
            },
            allow_community: {
                icon: "unblock",
                name: he("mail_allow_comm_messages")
            },
            clear: {
                name: e.peer < -2e9 ? he("mail_im_delete_email_contact") : he("mail_im_delete_all_history"),
                icon: "clear"
            },
            chat: {
                name: he("mail_im_create_chat_with"),
                icon: "invite"
            },
            mute: {
                name: he("mail_im_mute"),
                icon: "mute"
            },
            unmute: {
                name: he("mail_im_unmute"),
                icon: "unmute"
            },
            photos: {
                name: e.gid ? he("mail_im_show_media_history_group") : he("mail_im_show_media_history"),
                icon: "media"
            },
            avatar: {
                icon: "avatar",
                name: he("mail_update_photo_red")
            },
            block: {
                icon: "block",
                name: he("mail_block_user")
            },
            invite: {
                icon: "invite",
                name: he("mail_im_create_chat_with")
            },
            invite_link: {
                icon: "invite-link",
                name: he(t ? "mail_vkcomgroup_invite_link" : "mail_chat_invite_link")
            },
            leave: {
                icon: "leave",
                name: he(t ? "mail_leave_vkcomgroup" : "mail_leave_chat")
            },
            topic: {
                icon: "topic",
                name: he("mail_change_topic")
            },
            return: {
                icon: "return",
                name: he(t ? "mail_return_to_vkcomgroup" : "mail_return_to_chat")
            },
            pin_hide: {
                icon: "pin_hide",
                name: he("mail_menu_pin_hide")
            },
            pin_unhide: {
                icon: "pin_unhide",
                name: he("mail_menu_pin_show")
            },
            unpin: {
                icon: "unpin",
                name: he("mail_menu_unpin")
            },
            settings: {
                icon: "settings",
                name: he(t ? "mail_vkcomgroup_settings" : "mail_settings")
            }
        }
    }

    function Tt(e, t) {
        var n = '<img src="' + e + '" alt="" class="dialogs_inline_chatter dialogs_inline_chatter_half"/>';
        return t && (n = ge("im_dialogs_link", {
            href: t,
            photo: n
        })), '<div class="im_grid">\n    <div class="dialogs_inline_chatter dialogs_inline_chatter_half">\n      ' + n + "\n    </div>\n  </div>"
    }

    function It(e, t) {
        var n = '<img src="' + e + '" alt="" class="dialogs_inline_chatter"/>';
        return t && (n = ge("im_dialogs_link", {
            href: t,
            photo: n
        })), '<div class="im_grid">\n    <div class="dialogs_inline_chatter">\n      ' + n + "\n    </div>\n  </div>"
    }

    function Pt(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
        if ("string" == typeof e) return '<div class="im_grid"><img src="' + e + '" alt=""/></div>';
        switch (e.length) {
            case 1:
                return '<div class="im_grid"><img src="' + e[0] + '" alt=""/></div>';
            case 2:
                return e.map(function(e, n) {
                    return Tt(e, t[n])
                }).join("");
            case 3:
                return Tt(e[0], t[0]) + e.slice(1).map(function(e, n) {
                    return It(e, t[n + 1])
                }).join("");
            case 4:
                return e.map(function(e, n) {
                    return It(e, t[n])
                }).join("")
        }
    }

    function Mt(e, t, n) {
        if ("string" == typeof t.photo && t.photo) return '<div class="im_grid"><img src="' + t.photo + '" alt=""></div>';
        if (gt(t.peerId) && t.membersCount < 2) return '<div class="im_grid"><img src="' + e.get().default_chat_photo + '" alt=""></div>';
        if (Array.isArray(t.photo)) return Pt(t.photo);
        var r = t.data.active.slice(0, 4).map(d.oCacheGet.bind(null, e));
        return Pt(r.map(function(e) {
            return e.photo
        }), n ? [] : r.map(function(e) {
            return e.link
        }))
    }

    function xt(e) {
        var t = e.get().gid ? he("mail_search_only_messages_comm") : he("mail_search_only_messages");
        return '<li class="im-page--mess-search-w">\n    <div class="im-page--mess-search ' + H + '">\n      <button type="button" class="im-i--messages-search"></button>' + t + "\n    </div>\n  </li>"
    }

    function Lt() {
        return '<li class="im-search-results-head">' + he("mail_search_messages") + "</li>"
    }

    function At() {
        return '<li class="im-search-results-head">' + he("mail_search_conversations_sep") + "</li>"
    }

    function Nt() {
        return '<li class="im-search-results-head">' + he("mail_search_dialogs_sep") + "</li>"
    }

    function Dt() {
        return '<li class="im-search-results-head _im_recent_bar">\n    ' + he("mail_recent_searches") + '\n    <button type="button" class="' + B + ' im-page--clear-recent">' + he("mail_clear_recent") + "</button>\n  </li>"
    }

    function Rt(e) {
        var t = e.get().popular_sugg,
            n = Object(a.isClassicInterface)(e) ? 8 : 5;
        return t.length > n && (t = t.slice(0, n)), '<li class="im-popular clear_fix">' + t.map(function(t) {
            var n = t.peerId,
                r = Object(d.oCacheGet)(e, n) || t,
                i = e.get().tabs[n] || t,
                o = (e.get().mutedPeers || []).indexOf(n) >= 0;
            return '<div class="' + ["im-popular--item", "fl_l", "_im_dialog", "_dont_add_recent", "_im_sugg_" + n, i.unread > 0 && "sugg-is_unread", o && "sugg-is_muted"].filter(function(e) {
                return !!e
            }).join(" ") + '" data-peer="' + n + '">\n    <a class="im-popular--avatar-w ' + Me(i.online) + '" href="' + r.link + '"><img class="im-popular--avatar" src="' + r.photo + '"/></a>\n    <div class="im-popular--name-w"><a class="im-popular--name" href="' + r.link + '">' + (r.first_name || r.name) + '</a></div>\n    <span class="im-popular--unread _sugg_unread_ct">' + jt(i.unread) + "</span>\n</div>"
        }).join("") + "</li>"
    }

    function Ft(e, t, n) {
        var r = ae("_im_mess_" + t.messageId, n);
        if (r) {
            fe(r, "aria-hidden", "false"), ce(r, "im-mess_failed " + y);
            var i = ae("_im_mess_marker", r);
            fe(i, "aria-label", he("mail_send_message_error")), fe(i, "role", "link")
        }
        return n
    }

    function Bt(e, t, n) {
        var r = ae("_im_mess_" + t, n);
        if (r) {
            ue(r, "im-mess_failed"), fe(r, "aria-hidden", "true"), ue(r, y);
            var i = ae("_im_mess_marker", r);
            fe(i, "aria-label", ""), fe(i, "role", "")
        }
        return n
    }

    function Ht(e, t) {
        return Ut(e.map(function(e) {
            return ae("_im_mess_" + e, t)
        }).filter(function(e) {
            return e
        }), t)
    }

    function Ut(e, t) {
        var n = e.filter(function(e) {
            return !de(e, "im-mess_srv")
        }).map(function(e) {
            return e.parentNode
        });
        return e.forEach(function(e) {
            de(e, "im-mess_srv") ? e.parentNode.parentNode.removeChild(e.parentNode) : e.parentNode.removeChild(e)
        }), n.filter(function(e) {
            return 0 === ne(e).length
        }).map(function(e) {
            return se("_im_mess_stack", e)
        }).forEach(function(e) {
            de(ee(e), "_im_bar_date") && K(ee(e)), de(ee(e), "_im_unread_bar_row") && K(ee(e)), K(e)
        }), t
    }

    function zt(e) {
        for (var t = e; t;) {
            var n = t;
            if (null === (t = t.previousElementSibling)) {
                de(n, "mess_srv") && (t = n.parentNode);
                var r = se("_im_mess_stack", n);
                r && (t = r.previousElementSibling, 1 === ne(n.parentNode).length && r.parentNode.removeChild(r))
            }
            de(n, "_im_unread_bar_row") || n.parentNode.removeChild(n)
        }
    }

    function Gt(e, t, n, r) {
        return e.map(function(e) {
            return ae("_im_mess_" + e, r)
        }).filter(function(e) {
            return e
        }).forEach(function(e) {
            me(e, function(e, t, n) {
                var r = t.innerHTML;
                return '<div class="im-mess--text">\n    ' + he("delete" === n ? "mail_deleted_stop" : "mail_marked_as_spam") + ' <button type="button" data-peer="' + e + '" class="' + O + ' im-mess--btn">' + he("mail_restore") + '</button>\n    <div class="' + w + ' im-mess--original">' + r + "</div>\n  </div>"
            }(t, e, n)), ce(e, "im-mess_light")
        }), r
    }

    function Wt(e, t, n) {
        var r = ae("_im_mess_" + e, n);
        if (r) {
            var i = ae(w, r);
            me(r, i.innerHTML), ue(r, "im-mess_light")
        }
        return n
    }

    function Vt(e, t, n, r) {
        var i = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 2;
        if (arguments.length > 5 && void 0 !== arguments[5] && arguments[5]) return Kt(e, t, n, r, !0, i);
        var o = (Object(a.isClassicInterface)(r), 60),
            s = Kt(e, t, n, r, !1, i);
        return s.length > o ? Kt(e, t, n, r, !0, i) : s
    }

    function Kt(e, t, n, r, i, o) {
        var s, c, u, l = [],
            f = (e && e.userIds || []).filter(function(e) {
                var t = Object(d.oCacheExists)(r, e);
                return t || l.push(e), t && e != r.id
            });
        if (l.length && Object(m.loadChatMember)((u = l, (c = t) in (s = {}) ? Object.defineProperty(s, c, {
                value: u,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : s[c] = u, s), r), 0 === f.length) return "";
        var p = mt(t) || Object(a.isCommunityPeer)(t) ? "first_name" : i ? "short_name" : "name";
        if (1 == f.length) return (n ? "" : Object(d.oCacheGet)(r, f[0])[p]) + " " + he("mail_typing");
        var g = he("mail_typing_several", f.length),
            h = f.slice(0, Math.min(f.length - 1, o)),
            _ = h.map(function(e) {
                return Object(d.oCacheGet)(r, e)[p]
            }).join(", ");
        if (f.length > o + 1) _ += " " + he("mail_and_peer").replace("{count}", e.totalCount - o).replace("{typing}", g);
        else {
            var v = Object(d.oCacheGet)(r, f[h.length])[p];
            _ += " " + he("mail_and_peer_one") + " " + v + " " + g
        }
        return _
    }

    function qt() {
        return '<div class="im-page--chat-search-empty">\n    ' + he("mail_im_search_empty") + "\n  </div>"
    }

    function Qt(e, t, n) {
        var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "";
        return n ? '<a class="im_srv_lnk ' + r + '" target="_blank" href="' + e + '">' + t + "</a>" : '<span class="' + r + '">' + t + "</span>"
    }

    function $t(e, t, n) {
        var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
            i = t.kludges,
            o = i.source_act,
            a = Y(i.source_mid),
            s = t.userId,
            c = Object(d.oCacheGet)(e, s),
            u = "",
            l = s === a;
        switch (o) {
            case k:
                u = "mail_im_chat_created";
                break;
            case E:
                u = i.source_is_channel ? "mail_im_title_updated_channel" : "mail_im_title_updated_dot";
                break;
            case j:
                u = l ? "mail_im_returned_to_chat" : "mail_im_invited";
                break;
            case S:
                u = l ? "mail_im_left" : "mail_im_kicked_from_chat";
                break;
            case T:
                u = "mail_im_photo_set";
                break;
            case I:
                u = i.source_is_channel ? "mail_im_photo_removed_channel" : "mail_im_photo_removed";
                break;
            case P:
                u = i.source_message ? "mail_im_pin_message" : "mail_im_pin_message_empty2";
                break;
            case M:
                u = i.source_message ? "mail_im_unpin_message" : "mail_im_unpin_message_empty2";
                break;
            case x:
                u = "mail_im_invite_by_link";
                break;
            default:
                return "mail_no_support"
        }
        if (u = (u = _e(c.sex, he(u, "raw"))).replace("{from}", Qt(c.link, c.name, r)), a && a !== s) {
            var f = i.source_email;
            if (f) u = u.replace("{user}", Qt("/im?email=" + encodeURIComponent(f), "email", r));
            else {
                var p = Object(d.oCacheGet)(e, a),
                    m = o === S ? p.inv_name : p.kick_name;
                u = u.replace("{user}", Qt(p.link, m, r))
            }
        }
        if (i.source_text) {
            var g = i.source_old_text ? '«<b class="im_srv_lnk">' + i.source_old_text + "</b>» &rarr; " : "";
            u = u.replace("{title}", g + '«<b class="im_srv_lnk">' + i.source_text + "</b>»")
        }
        if (i.source_act === P || i.source_act === M)
            if (i.source_message) {
                var h = Qt("", Xt(Le.emojiToHTML(Z(i.source_message.replace(/<br\s?\/?>/gi, " ")), !0)), !1, "im_srv_mess_link");
                u = u.replace("{msg}", h)
            } else u = u.replace(/{link}(.+){\/link}/i, function(e, t) {
                return Qt("", t, !1, "im_srv_mess_link")
            });
        return u
    }

    function Yt(e, t, n, r) {
        if (t === T) {
            var i = ae("_im_mess_" + e.messageId, r);
            if (i) {
                var o = n.tabs[e.peerId];
                i.parentNode.innerHTML = ge("im_msg_row", {
                    msg_id: e.messageId,
                    from_id: e.peerId,
                    text: $t(n, e, o) + n.chat_photo_msg,
                    ts: e.date,
                    cls: "im-mess_srv"
                })
            }
        }
        return r
    }

    function Xt(e) {
        return e.replace(/&lt;&lt;/g, "&laquo;").replace(/&gt;&gt;/g, "&raquo;").replace(/ \-\-/g, " &mdash;").replace(/\-\- /g, "&mdash; ").replace(i.MENTION_RAW, "$1$4")
    }

    function Zt(e, t) {
        return !t && e === G.id
    }

    function Jt(e, t) {
        return Ie(e, {
            url: Object(a.isCommunityPeer)(t) ? "al_groups.php" : "al_profile.php",
            params: {
                act: "verified_tt",
                mid: t,
                gid: t
            },
            slide: 15,
            ajxdt: 200,
            showdt: 200,
            hidedt: 200,
            dir: "auto",
            shift: [94, 7, 7],
            className: "verified_tt"
        })
    }

    function en(e) {
        return function(t) {
            var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "bottom",
                r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "",
                i = V(ge("im_preloader", {
                    preloader: q(G.pr_tpl, {
                        id: ""
                    }),
                    cls: ["bottom" === n ? "im-preloader_bottom" : "im-preloader_top", r].join(" ")
                })),
                o = !1;

            function a() {
                o = !0, ue(i, "im-preloader_visible"), i.parentNode && i.parentNode.removeChild(i)
            }
            setTimeout(function() {
                o || ("bottom" === n ? e.appendChild(i) : e.insertBefore(i, J(e)), ce(i, "im-preloader_visible"))
            }, 0), t.then(a).catch(function(e) {
                Object(g.imWeirdCatch)("wrapLoading", e), a()
            })
        }
    }

    function tn(e, t) {
        return {
            0: {
                msgs: e.reduce(function(e, t) {
                    return e[t] = [t, r.FLAG_IMPORTANT, 0, 0, "", {}, {}, 0, 0, 0], e
                }, {}),
                hash: t,
                history: 1
            }
        }
    }

    function nn(e, t) {
        if (!t && !e) return !1;
        var n = e.target || e.srcElement,
            r = He,
            i = !1,
            o = /_im_mess|im_log_act|im_log_ract|_im_log_body|im_log_rspacer|_im_graffiti_w|_wall_post_cont/;
        do {
            if (!n || n.onclick || n.onmousedown || "A" == n.tagName || de(n, "_im_no_select") || de(n, "im_msg_media_link") || "IMG" == n.tagName && !de(n, "_im_graffiti") && !de(n, "emoji") && !de(n, "emoji_css") && !de(n, "im_gift") || "TEXTAREA" == n.tagName || de(n, "play_new") || de(n, "videoplayer") || (i = o.test(n.className))) break
        } while (r-- && (n = n.parentNode));
        return !i || !!X((window.getSelection && window.getSelection() || document.getSelection && document.getSelection() || "").toString())
    }

    function rn(e, t) {
        return '<div class="im-mess--text">\n      <span>' + he("mail_restored") + '</span>\n      <a class="_im_go_to" href="/im?sel=' + kt(e) + "&msgid=" + t + '">' + he("mail_im_goto_conversation") + "</a>\n    </div>"
    }

    function on(e, t, n) {
        var r = he("mail_deleteall1"),
            i = he("mail_sure_to_delete_all"),
            o = he("mail_delete");
        return gt(t) && (Object(h.doesChatTabHaveFlag)(e, 1024) ? (r = he("mail_leave_vkcomgroup"), i = he("mail_unfollow_channel_confirmation"), o = he("mail_unfollow_channel")) : i = he("mail_chat_sure_to_delete_all")), Object(a.isCommunityPeer)(t) && (i = he("mail_group_sure_to_delete_all")), Se(r, i, o, n, he("global_cancel"))
    }

    function an(e) {
        return Se(he("mail_unpin_title"), he("mail_unpin_text"), he("mail_unpin"), e, he("global_cancel"))
    }

    function sn(e, t, n, r) {
        var i = he("mail_dialog_msg_delete_N", t),
            o = Se(he("mail_dialog_msg_delete_title"), i, he("mail_delete"), function() {
                return r(isChecked(ae("_check_forall")))
            }, he("global_cancel")),
            a = "",
            s = !1;
        return n && (a = '<div class="checkbox im-delete-forall-checkbox _check_forall" onclick="checkbox(this);" role="checkbox" aria-checked="false">' + he("mail_delete_for_all") + "</div>", s = cur.imDb.selectByKey("del_forall_checked")), o.setControlsText(a), s && checkbox(ae("_check_forall")), o
    }

    function cn(e, t, n, r, i) {
        t.showProgress(), e.set(r.bind(null, i)).then(function() {
            t.hideProgress(), t.hide(), n().removePeer(e, i), n().updateDialogFilters(e)
        })
    }

    function un(e, t, n, r, i) {
        var a = e.get().peer;
        De(r), je("al_im.php", {
            act: "a_show_members_box",
            chat: a - 2e9
        }, {
            stat: ["boxes.css"],
            params: {
                dark: 1
            },
            onDone: function(r, i) {
                var a = Object(o.createModule)({
                    handlers: function(i, s) {
                        s(r.bodyNode.parentNode, "click", "_im_invite_box", function() {
                            r.hide(), ln(e, e.get().peer, t, n), Object(o.destroyModule)(a)
                        }), s(r.bodyNode.parentNode, "mouseover", "im_status_mob_onl", function(e, t) {
                            var n = ae("_im_chat_members_w", r.bodyNode.parentNode),
                                i = se("_im_member_item", t).offsetTop - n.scrollTop + 160 > 370;
                            mobileOnlineTip(t, {
                                was: Y(ie(t, "was")),
                                mid: Y(ie(t, "peer")),
                                vk_mobile: Y(ie(t, "vk_mobile")),
                                forcetoup: i
                            })
                        })
                    }
                })
            }
        }, r)
    }

    function ln(e, t, n, r) {
        var i = e.get().tabs[t].memberIds;
        e.set(r.bind(null, "add_member", i)).then(n().showCreation)
    }

    function dn(e, t, n) {
        if (e.get().active_tab === i.FOLDER_ALL && 0 === e.get().unread_cnt) return !1;
        var r = e.get().active_tab === i.FOLDER_ALL ? i.FOLDER_UNREAD : i.FOLDER_ALL;
        return e.set(n.bind(null, r)).then(function(e) {
            t().restoreDialogs(e, !0)
        })
    }

    function fn(e, t, n, r) {
        if (t.get().active_tab === e) return Promise.resolve(t);
        var i = Object(a.isReversedDialogs)(t);
        return t.set(r.bind(null, e)).then(function(e) {
            return n().restoreDialogs(e, !0, i !== Object(a.isReversedDialogs)(e)), e
        })
    }

    function pn(e, t) {
        void 0 === t && (t = e.get().peer);
        var n = e.get().tabs[t];
        return i.FOLDER_MASKS[i.FOLDER_IMPORTANT] & n.folders
    }

    function mn(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
        if (void 0 === t && (t = e.get().peer), !Object(a.isFoldersAvailable)(e)) return !1;
        var r = n || e.get().tabs[t];
        return i.FOLDER_MASKS[i.FOLDER_UNRESPOND] & r.folders
    }

    function gn(e, t) {
        return !1 === ((t.get().block_states || {})[e] || {}).free
    }

    function hn(e) {
        return null != e.get().pendingForward
    }

    function _n(e, t) {
        return (t.get().block_states[e] || {}).who === G.id
    }

    function vn(e, t) {
        var n = e.get().block_states;
        Object.keys(n).forEach(function(i) {
            n[i].time ? !1 === n[i].free && Date.now() - n[i].time >= 5e4 && t.push([r.mutexEvent([, 1, "gim" + e.get().gid, i, 0, ""])]) : n[i].time = Date.now()
        })
    }

    function bn(e, t, n) {
        var r = void 0;
        return !Te("al_im.php", {
            act: "a_spam",
            offset: "0",
            gid: e.get().gid
        }, {
            onDone: function(n, i) {
                i && (r = t(n, e, i))
            },
            params: {
                width: 638,
                onHide: function() {
                    xe.loaded && xe.detachPlayer(!0), r.unmount()
                }
            }
        }, n)
    }

    function yn(e, t) {
        return wn(e.get(), t, Object(a.getTab)(e, t).last_seen)
    }

    function wn(e, t, n, r) {
        if (n[0]) return 2 === n[2] ? '<span class="is_vk_mobile is_online">' + he("mail_header_online_status") + On(t, !1, !0, !0, r) + "</span>" : "online" + (Pe[n[0]] ? On(t, !1, !1, !0, r) : "");
        if (!n[1]) return "";
        var i = ye(n[1], e.timeshift),
            o = _e(Object(d.oCacheGet)(e, t).sex, he("mail_last_activity_tip", "raw")).replace("{user}", "").replace("{time}", i);
        return 2 === n[2] ? o += On(t, !1, !0, !1, r) : n[2] && (o += On(t, !1, !1, !1, r)), o
    }

    function On(e, t, n, r, i) {
        var o = {
            mid: e
        };
        r && (o.was = 1), t ? o.forcetoup = !0 : o.forcetodown = !0, n && (o.vk_mobile = 1), o = Object.assign(o, i);
        var a = JSON.stringify(o).slice(1, -1).replace(/"/g, "&quot;");
        return ge("im_wrap_mobile", {
            class: "im_status_mob_onl" + (n ? " vk_mobile" : ""),
            params: a,
            attrs: n ? "" : 'onclick="mobilePromo();"'
        })
    }

    function Cn(e, t) {
        var n = t.get().tabs[e];
        return je("al_settings.php", {
            act: "blacklist_box",
            q: n.href
        }, {
            stat: ["settings.js", "settings.css"],
            dark: 1
        })
    }

    function kn(e, t) {
        return je("groupsedit.php", {
            act: "bl_edit",
            name: "/id" + e,
            gid: t.get().gid
        }, {
            stat: ["page.css", "ui_controls.js", "ui_controls.css"],
            dark: 1
        })
    }

    function En(e) {
        return e.get().gid ? "/gim" + e.get().gid : "/im"
    }

    function jn(e, t, n, r) {
        var i = void 0;
        Gn(Te("al_im.php", {
            act: "a_important",
            offset: "0"
        }, {
            onDone: function(r, o) {
                o && (i = n(r, e, t, o))
            },
            params: {
                width: 638,
                onHide: function() {
                    xe.loaded && xe.detachPlayer(!0)
                },
                onDestroy: function() {
                    i && i.unmount()
                }
            }
        }, r), e)
    }

    function Sn() {
        var e = document.activeElement;
        return null !== e && ("INPUT" === e.tagName || "TEXTAREA" === e.tagName || e.getAttribute("contenteditable"))
    }

    function Tn(e, t, n) {
        var r = ae("_im_mess_" + e, n);
        return r && le(r, "im-mess_fav", t), n
    }

    function In(e, t, n) {
        var r = ae("_im_unread_bar_row", t);
        if (!r) return t;
        var i = re(r, "._im_mess_stack", -1),
            o = re(r, "._im_mess_stack"),
            s = i ? oe("_im_mess", i).pop() : null,
            c = o ? ae("_im_mess", o) : null;
        if (K(r), tt(t), !c || !s) return t;
        var u = ie(c, "msgid"),
            d = Object(a.getPreviousMessage)(e, n, u),
            f = Object(a.getMessage)(e, n, u);
        if (!d || wt(e.tabs[n], d, f, e)) return t;
        var p = ae("_im_stack_messages", i),
            m = ae("_im_stack_messages", o).children;
        return Object(l.toArray)(m).forEach(function(e) {
            K(e), p.appendChild(e)
        }), K(o), t
    }

    function Pn(e, t, n) {
        var r = Object(a.getFirstUnread)(e, e.get().peer);
        if (!r) return [!1, 0];
        var i = ae("_im_mess_" + r, t);
        if (!i) {
            var o = Object(a.getLastMessage)(e, e.get().peer, r);
            if (!o) return [!0, 0];
            i = ae("_im_mess_" + o.messageId, t)
        }
        var s = de(i, "_im_mess_srv") ? i : se("_im_mess_stack", i);
        if (!s) return [!0, 0];
        var c = i ? i.offsetTop : 0,
            u = s.offsetTop + c,
            l = n.contHeight();
        return u <= n.scrollTop() + n.getScrollHeight() ? [!0, 0] : [!1, Math.max(0, l - u)]
    }

    function Mn(e, t, n) {
        De(t);
        var r = se("_im_top_notice", n);
        Ne(r, 200, K.pbind(r));
        var i = se("_im_page_dialogs", r);
        i && de(i, "im-page--dialogs-notice") && ue(i, "im-page--dialogs-notice"), Ee.post("al_im.php", {
            act: "a_hide_top_notice",
            type: r.getAttribute("data-type"),
            hash: r.getAttribute("data-hash")
        })
    }

    function xn(e, t, n) {
        De(t);
        var r = se("_im_aside_notice", n);
        Ae(r, 200, K.pbind(r)), Ee.post("al_im.php", {
            act: "a_hide_top_notice",
            type: r.getAttribute("data-type"),
            hash: r.getAttribute("data-hash")
        })
    }

    function Ln(e, t) {
        De(e);
        var n = se("_im_aside_promo_block", t);
        Ae(n, 200, K.pbind(n)), Ee.post("al_im.php", {
            act: "a_hide_promo_block",
            type: n.getAttribute("data-type"),
            hash: n.getAttribute("data-hash")
        })
    }

    function An(e, t) {
        se("_im_aside_promo_block", t).classList.add("--action-called"), Ee.post("al_im.php", {
            act: "a_vkadmin_app_install",
            hash: ie(t, "hash"),
            platform: ie(t, "platform")
        })
    }

    function Nn(e, t, n, r, i) {
        return n = n.replace(/\<br\s*\/?\>(\n)?/gi, " ").replace(/[\n\r]/gi, " "), n = Object(c.replaceMentions)(n, function(e, t, n, r, i) {
            return i
        }), r && (n = Le.emojiToHTML(n, !0)), t && "..." !== t.trim() && !gt(e) && (n = ge("im_topic", {
            topic: t,
            cls: "im-topic_dialog"
        }) + n), !n && i.length > 0 && (n = ge("im_dialog_media", {
            name: Dn(i[0], i)
        })), n
    }

    function Dn(e, t) {
        var n = {
            photo: he("mail_added_photos", "raw"),
            video: he("mail_added_videos", "raw"),
            audio: he("mail_added_audios", "raw")
        };
        switch (e.type) {
            case "mail":
                return be(e.object.fwd_count, he("mail_fwd_msgs", "raw"), !0);
            case "photo":
            case "video":
            case "audio":
                var r = t.filter(function(t) {
                    return t.type === e.type
                }).length;
                return be(r, n[e.type], !0);
            case "audio_playlist":
                return he("mail_added_audio_playlist");
            case "doc":
                switch (e.kind) {
                    case "graffiti":
                        return he("mail_added_graffiti");
                    case "audiomsg":
                        return he("mail_added_audiomsg");
                    default:
                        return he("mail_added_docs")
                }
            case "geo":
            case "map":
                return he("mail_added_geo");
            case "wall":
                return he("mail_added_wall");
            case "wall_reply":
                return he("mail_added_wall_reply");
            case "gift":
                return he("mail_added_gift");
            case "link":
            case "share":
                return he("mail_added_link");
            case "sticker":
                return he("mail_added_sticker");
            case "market":
                return he("mail_added_market_item");
            case "money_transfer":
                return he("mail_added_money_transfer");
            case "money_request":
                return he("mail_added_money_request");
            case "story":
                return he("mail_added_story");
            case "mask":
                return he("mail_added_mask");
            case "article":
                return he("mail_added_article");
            case "call":
                return he("mail_added_call");
            case "poll":
                return he("mail_added_poll");
            default:
                return he("mail_added_" + e.type)
        }
        return ""
    }

    function Rn(e) {
        ce(e, "im-send-btn_loading")
    }

    function Fn(e) {
        ue(e, "im-send-btn_loading")
    }

    function Bn(e) {
        var t = e.get(),
            n = Object(a.getPinnedMessage)(e);
        if (!n || !Object(f.isPinnedMessageVisibleInTab)(e, Object(a.getPeer)(e))) return "";
        var r = Object(d.oCacheGet)(e, n.userId);
        if (!r) return "";
        var i = Hn(e, n);
        return i || (i = !(i = n.text) && n.attaches.length ? ge("im_pinned_message_media", {
            text: Dn(n.attaches[0], n.attaches)
        }) : Ct(e, i, n && n.kludges || {}) || ""), i = i.replace(/<br\s?\/?>/gi, " "), ge("im_pinned_message", {
            date: we(n.date, t.timeshift),
            content: i,
            link: r.link,
            name: r.name
        })
    }

    function Hn(e, t) {
        var n = "";
        if (t && Object(s.isMoneyRequest)(t) && void 0 !== t.kludges.attach1_tr_amount) {
            var r = "%s " + t.kludges.attach1_currency;
            if ("RUB" === t.kludges.attach1_currency && (r = he("mail_money_amount_rub", "raw")), t.kludges.attach1_total_amount) {
                var i = be(t.kludges.attach1_tr_amount / 1e3, "%s", !0),
                    o = be(t.kludges.attach1_total_amount / 1e3, r, !0);
                n = he("mail_money_request_collected_amount_from").replace("{amount}", i).replace("{total_amount}", o)
            } else {
                var a = be(t.kludges.attach1_tr_amount / 1e3, r, !0);
                n = he("mail_money_request_collected_amount").replace("{amount}", a)
            }
            if (Y(t.kludges.attach1_held_amount)) {
                var c = be(t.kludges.attach1_held_amount / 1e3, r, !0);
                n += " " + he("mail_money_request_held_amount").replace("{amount}", c)
            }
            t.text && (n += '<span class="divider"></span>' + Ct(e, t.text, t.kludges)), t.kludges.attach1_total_amount && (n += ge("im_pinned_message_media_bar", {
                percent: Math.min(100, Math.floor(t.kludges.attach1_tr_amount / t.kludges.attach1_total_amount * 100))
            }))
        }
        return n
    }

    function Un(e, t, n) {
        var r = +n.getAttribute("data-time");
        r && Ie(n, {
            text: he("mail_message_edited") + " " + we(r, e.get().timeshift),
            className: "_im_history_tooltip",
            appendParentCls: "_im_mess_stack",
            black: 1,
            shift: [0, 4]
        })
    }

    function zn() {
        var e = getSize(ae(U))[1];
        return e || (e = Ue), e
    }

    function Gn(e, t) {
        e.bodyNode.addEventListener("mouseover", function(e) {
            de(e.target, "_im_edit_time") && Un(t, 0, e.target)
        })
    }

    function Wn(e, t, n, r, i) {
        var o = e.get(),
            a = void 0;
        Gn(Te("al_im.php", {
            act: "a_get_pinned_message_box",
            chat: n,
            gid: e.get().gid,
            hash: o.tabs[n].hash
        }, {
            onDone: function(n, i) {
                i && (a = r(n, e, t, i))
            },
            params: {
                width: 638,
                onHide: function() {
                    xe.loaded && xe.detachPlayer(!0)
                },
                onDestroy: function() {
                    a && a.unmount()
                }
            }
        }, i), e)
    }

    function Vn(e, t) {
        return !(!gt(e.peerId) || !e.memberIds) && e.memberIds.indexOf(t) >= 0
    }

    function Kn(e) {
        return !gt(e.peerId) || e.data.kicked ? 0 : e.membersCount
    }

    function qn(e, t) {
        var n = Object(d.oCacheGet)(e, t.peerId),
            r = Object(a.getTab)(e, t.peerId) || {};
        return n && (t.photo = t.photo || n.photo, t.name = t.name || n.name, t.href = t.link || n.link, t.sex = t.sex || n.sex), t.last_touched = r.last_touched || 0, t.verified = !!t.verified, t.lastmsg = t.lastmsg || t.lastmsg_meta && t.lastmsg_meta[0] || !1, t.folders = t.folders || null, t.unread = t.unread || 0, t.last_seen = t.last_seen || [0, 0, 0], t.online = t.last_seen && t.last_seen[0] || 0, t.out_up_to = null != t.out_up_to ? t.out_up_to : t.in_up_to || 0, gt(t.peerId) && (t.memberIds = t.memberIds || r.memberIds || null), t
    }

    function Qn(e, t) {
        for (var n in t) t.hasOwnProperty(n) && qn(e, t[n])
    }

    function $n(e, t) {
        var n = [],
            r = t.find(function(e) {
                return "mail" === e[0]
            }),
            i = r ? r[1].split(";") : [];
        for (i.length > Be && (r[1] = i.slice(0, Be).join(";")); e.length > Fe;) {
            var o = e.substr(0, Fe).lastIndexOf(" "); - 1 == o && (o = Fe), n.push({
                msgText: X(e.substr(0, o))
            }), e = X(e.substr(o))
        }
        for (e.length && n.push({
                msgText: e,
                attaches: t
            }), n.length || n.push({
                attaches: t
            }), i = i.slice(Be); i.length; i = i.slice(Be)) n.push({
            attaches: [
                ["mail", i.slice(0, Be).join(";")]
            ]
        });
        return n
    }

    function Yn(e) {
        return e.length > Fe
    }

    function Xn(e, t, n) {
        var r = !1;
        je("al_im.php", {
            act: "a_chat_preview",
            chat_id: t.invite_chat_id,
            hash: t.invite_hash
        }, {
            stat: ["boxes.css"],
            params: {
                dark: 1,
                hideButtons: !0,
                onHide: function() {
                    e.set(n), r && r.unmount()
                }
            },
            onFail: function(e) {
                return setTimeout(function() {
                    return Se(he("global_error"), e)
                }, 0), !0
            },
            onDone: function(t, n) {
                r = Object(u.mount)(t.bodyNode, e)
            }
        }, {})
    }

    function Zn() {
        Se(he("global_error"), he("mail_message_wait_until_uploaded"))
    }

    function Jn(e, t) {
        var n = Object(a.getTab)(e, t.peerId) || {};
        if (!t || !Object(s.isOut)(t)) return !1;
        if (333 == t.peerId) return !1;
        if (Date.now() / 1e3 - t.date > 86400) return !1;
        if ($e(e, t.peerId, t.messageId)) return !1;
        if (gt(t.peerId)) {
            if (n.data.kicked || n.data.closed) return !1
        } else if (n.block_error > 0) return !1;
        return !0
    }

    function er(e, t) {
        var n = Object(a.getTab)(e, t),
            r = -1 !== n.memberIds.indexOf(n.ownerId),
            i = r ? [n.ownerId] : [];
        return (i = i.concat(n.memberIds.filter(function(t) {
            return t !== n.ownerId && Object(d.oCacheExists)(e, t)
        }).slice(0, r ? 4 : 5))).map(function(t) {
            return Object(d.oCacheGet)(e, t)
        })
    }

    function tr(e, t) {
        return t.map(function(t) {
            return Object(d.oCacheGet)(e, t)
        })
    }

    function nr(e, t) {
        return Object(a.getTab)(e, t).memberIds.reduce(function(t, n) {
            var r = Object(d.oCacheGet)(e, n);
            return t[r.id] = r, t
        }, {})
    }

    function rr(e, t) {
        if ("number" != typeof e || 0 === e) return "";
        var n, r = e,
            i = [];
        if ([
                [31536e3, he(t ? "global_years_accusative" : "global_age_years", "raw")],
                [2592e3, he(t ? "global_months_accusative" : "global_age_months", "raw")],
                [604800, he(t ? "global_weeks_accusative" : "global_age_weeks", "raw")],
                [86400, he(t ? "global_days_accusative" : "global_age_days", "raw")],
                [3600, he(t ? "global_hours_accusative" : "global_hours", "raw")],
                [60, he(t ? "global_minutes_accusative" : "global_minutes", "raw")],
                [1, he(t ? "global_seconds_accusative" : "global_age_seconds", "raw")]
            ].forEach(function(e) {
                var t = _(e, 2),
                    n = t[0],
                    o = t[1],
                    a = Math.floor(r / n);
                r %= n, a >= 1 && i.push(be(a, o))
            }), 1 === (n = i.length)) return i.pop();
        var o = i.slice(0, n - 1).join(", "),
            a = i.pop();
        return he("global_and").replace(/{before}/gi, o).replace(/{after}/gi, a)
    }
}, function(e, t, n) {
    var r = n(163),
        i = n(68)("toStringTag"),
        o = "Arguments" == r(function() {
            return arguments
        }());
    e.exports = function(e) {
        var t, n, a;
        return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof(n = function(e, t) {
            try {
                return e[t]
            } catch (e) {}
        }(t = Object(e), i)) ? n : o ? r(t) : "Object" == (a = r(t)) && "function" == typeof t.callee ? "Arguments" : a
    }
}, function(e, t, n) {
    "use strict";
    e.exports = function(e) {
        var t = (e ? e.ownerDocument || e : document).defaultView || window;
        return !(!e || !("function" == typeof t.Node ? e instanceof t.Node : "object" == typeof e && "number" == typeof e.nodeType && "string" == typeof e.nodeName))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "setCurrentDateBar", function() {
        return _
    }), n.d(t, "mount", function() {
        return O
    });
    var r = n(54),
        i = n(102),
        o = n(191),
        a = n(176),
        s = n(160),
        c = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var u = 68,
        l = 32,
        d = 300,
        f = 20,
        p = 68,
        m = 10,
        g = 2e3,
        h = 100;

    function _(e, t) {
        domData(e, "ts") !== t.date && (e.innerHTML = t.text, domData(e, "ts", t.date), setStyle(e, {
            visibility: "visible"
        }))
    }

    function v(e, t, n, r) {
        var i = e instanceof Array ? e : geByClass("_im_bar_date", e),
            a = t.contHeight();
        o.default.onNewMessagesChunk();
        var s = i.reduce(function(e, t) {
                return e[domData(t, "date")] = [t.offsetTop + m, a, t], e
            }, {}),
            c = !n && r.barMap ? r.barMap : {};
        return r.barMap = extend(c, s), r.barMapKeys = Object.keys(r.barMap).sort(), Promise.resolve(r)
    }

    function b(e, t, n, i, o) {
        var a = e.get().barMap[t],
            s = Object(r.isClassicInterface)(o) ? p : f;
        return n - (a[0] + n - a[1]) + i - s
    }

    function y(e, t, n, r, i) {
        var o = e.get(),
            a = void 0,
            s = void 0,
            u = n - t;
        o.barMapKeys.forEach(function(t) {
            var o = b(e, t, n, r, i);
            if (o >= u) {
                var c = a ? b(e, a, n, r, i) : n;
                a = c > o ? t : a
            } else if (o < u) {
                var l = s ? b(e, s, n, r, i) : 0;
                s = o > l ? t : s
            }
        });
        var l = {};
        return [
            [s, "prev"],
            [a, "cur"]
        ].forEach(function(t) {
            var o = c(t, 2),
                a = o[0],
                s = o[1];
            a && (l[s + "Bar"] = function(e, t) {
                var n = e.get().barMap[t][2];
                return {
                    text: n.textContent,
                    date: domData(n, "date")
                }
            }(e, a), l[s + "Left"] = b(e, a, n, r, i) - u)
        }), l
    }

    function w(e, t, n, o, a) {
        var c = e.get(),
            d = Object(i.isEverythingLoaded)(c),
            f = t.get(),
            p = a.scrollTop(),
            m = f.lastTop ? f.lastTop - p : 0;
        f.lastTop = p;
        var g, h, v, b = Object(s.isPinnedMessageVisibleInTab)(c, c.peer) ? Object(r.getPinnedMessageHeight)() : 0,
            w = Object(i.isSearchingInplace)(c.peer, c) && c.tabs[c.peer] && c.tabs[c.peer].top_banner ? 50 : 0,
            O = (Object(r.isClassicInterface)(e) ? u + b + w : 0) - l / 2,
            C = y(t, p, a.contHeight(), O, e),
            k = C.prevBar,
            E = C.curBar,
            j = C.prevLeft,
            S = "translateY(0px)",
            T = !1,
            I = !1,
            P = !1;
        E || d || (E = function(e) {
            var t = geByClass1("_im_mess", e),
                n = domData(t, "ts");
            return t && n ? {
                text: getShortDate(intval(n), !1, !0, getLang("months_of", "raw")),
                date: n
            } : null
        }(o)), E ? T = E : I = !0, k && E && j > -l && j < 0 && (P = !0, I = !1, T = E, S = "translateY(" + (-l - j) + "px)"), T && _(n, T), P ? t.set(function(e, t, n, r) {
            return r.barTransition = r.barMap[t][2], n > 0 ? (addClass(r.barMap[t][2], "im-page--date-bar-transition-inverse"), addClass(e, "im-page--date-bar-transition-inverse")) : n < 0 && (removeClass(r.barMap[t][2], "im-page--date-bar-transition-inverse"), removeClass(e, "im-page--date-bar-transition-inverse")), addClass(r.barMap[t][2], "im-page--date-bar-transition"), addClass(e, "im-page--date-bar-transition"), Promise.resolve(r)
        }.bind(null, n, k.date, m)) : t.set(function(e, t) {
            return t.barTransition && (removeClass(t.barTransition, "im-page--date-bar-transition"), t.barTransition = null), removeClass(e, "im-page--date-bar-transition"), Promise.resolve(t)
        }.bind(null, n)), S && setStyle(n, (g = {}, h = cssTransformProp, v = S, h in g ? Object.defineProperty(g, h, {
            value: v,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : g[h] = v, g)), toggleClass(n, "im-page--top-date-bar_no-b", I)
    }

    function O(e, t) {
        var n = geByClass1("_im_top_date_bar"),
            r = Object(a.default)({
                lastTop: !1,
                barMap: {},
                barMapKeys: []
            }),
            i = null,
            o = null,
            s = null,
            c = debounce(function(e) {
                r.set(v.bind(null, t, e, !1))
            }, 500);
        return {
            reset: function(i) {
                r.set(v.bind(null, t, i, !0)).then(function() {
                    w(e, r, n, t, i)
                })
            },
            disable: function() {
                r.reset()
            },
            heightIncreased: function(e, t) {
                return c(t), r.set(function(e, t) {
                    return t.barMapKeys.forEach(function(n) {
                        t.barMap[n][0] -= e
                    }), Promise.resolve(t)
                }.bind(null, e))
            },
            parseMore: function(i, o) {
                r.set(v.bind(null, i, o, !1)).then(function() {
                    w(e, r, n, t, o)
                })
            },
            toggle: function(e) {
                e ? setStyle(n, {
                    display: ""
                }) : hide(n)
            },
            show: function() {
                o = Date.now(), s || (addClass(geByClass1("_im_page_history"), "im-page--top-date-bar_visible"), s = setInterval(function() {
                    Date.now() - o > g && (removeClass(geByClass1("_im_page_history"), "im-page--top-date-bar_visible"), clearInterval(s), s = null)
                }, h))
            },
            update: function(o) {
                i && (clearTimeout(i), i = null), i = setTimeout(function() {
                    w(e, r, n, t, o)
                }, d), w(e, r, n, t, o)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(65),
        o = (n(195), n(151)),
        a = n(189);
    var s = 80,
        c = 250,
        u = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onClick = function() {
                    if (!r.state.dropdown || r.state.dropdown.removed) {
                        var e = r.props,
                            t = e.text,
                            n = e.position,
                            i = e.align,
                            o = e.marginTop,
                            s = e.marginLeft,
                            c = Object(a.default)(r.el);
                        r.update({
                            text: t,
                            position: n,
                            align: i,
                            rect: c,
                            marginTop: o,
                            marginLeft: s
                        })
                    } else r.update()
                }, r.onMouseEnter = function(e) {
                    r.callerHovered = !0, r.timeouts.appear = setTimeout(function() {
                        if (r.el && r.callerHovered) {
                            var e = r.props,
                                t = e.position,
                                n = e.align,
                                i = e.marginTop,
                                o = e.marginLeft,
                                s = Object(a.default)(r.el);
                            r.update({
                                position: t,
                                align: n,
                                rect: s,
                                marginTop: i,
                                marginLeft: o
                            })
                        }
                    }, s)
                }, r.onMouseLeave = function(e) {
                    r.callerHovered = !1, r.timeouts.callerDisappear = setTimeout(function() {
                        r.callerHovered || r.hovered || r.update()
                    }, c)
                }, r.onDropdownMouseEnter = function() {
                    "hover" === r.props.trigger && (r.hovered = !0)
                }, r.onDropdownMouseLeave = function(e) {
                    "hover" === r.props.trigger && (r.hovered = !1, r.timeouts.disappear = setTimeout(function() {
                        r.callerHovered || r.hovered || r.update()
                    }, c))
                }, r.onDocumentClick = function(e) {
                    !r.state.dropdown || r.state.dropdown.removed || r.el.contains(e.target) || r.update()
                }, r.onResize = function(e) {
                    if (r.state.dropdown && !r.state.dropdown.removed) {
                        var t = r.props,
                            n = t.text,
                            i = t.position,
                            o = t.align,
                            s = t.marginTop,
                            c = t.marginLeft,
                            u = Object(a.default)(r.el);
                        r.update({
                            text: n,
                            position: i,
                            align: o,
                            rect: u,
                            marginTop: s,
                            marginLeft: c
                        })
                    }
                }, r.onTransitionEnd = function(e) {
                    "visibility" === e.propertyName && r.state.dropdown && r.state.dropdown.removed && r.setState({
                        dropdown: void 0
                    })
                }, r.onItemClick = function(e, t) {
                    r.update(), t.onClick(e)
                }, r.state = {}, r.timeouts = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                this.el = i.findDOMNode(this), "click" === this.props.trigger ? (this.el.addEventListener("click", this.onClick), document.addEventListener("mousedown", this.onDocumentClick), window.addEventListener("resize", this.onResize)) : (this.el.addEventListener("mouseenter", this.onMouseEnter), this.el.addEventListener("mouseleave", this.onMouseLeave))
            }, t.prototype.componentWillUnmount = function() {
                var e = this;
                Object.keys(this.timeouts).forEach(function(t) {
                    clearTimeout(e.timeouts[t])
                }), "click" === this.props.trigger ? (this.el.removeEventListener("click", this.onClick), document.removeEventListener("mousedown", this.onDocumentClick), window.removeEventListener("resize", this.onResize)) : (this.el.removeEventListener("mouseenter", this.onMouseEnter), this.el.removeEventListener("mouseleave", this.onMouseLeave)), this.defaultNode && (this.defaultNode.parentNode.removeChild(this.defaultNode), delete this.defaultNode)
            }, t.prototype.update = function(e) {
                if (!e) return this.setState({
                    dropdown: Object.assign({}, this.state.dropdown, {
                        removed: !0
                    })
                });
                var t = e.position,
                    n = e.align,
                    r = e.rect,
                    i = e.marginTop,
                    o = e.marginLeft,
                    a = r.left,
                    s = r.top;
                switch (t) {
                    case "t":
                        a += .5 * r.width;
                        break;
                    case "r":
                        a += r.width, s += .5 * r.height;
                        break;
                    case "b":
                        a += .5 * r.width, s += r.height;
                        break;
                    case "l":
                        s += .5 * r.height
                }
                a = Math.round(a + o), s = Math.round(s + i), this.setState({
                    dropdown: {
                        position: t,
                        align: n,
                        x: a,
                        y: s
                    }
                })
            }, t.prototype.renderDropdown = function() {
                var e = this;
                if (!this.state.dropdown) return null;
                var t, n, i, a = this.state.dropdown,
                    s = a.x,
                    c = a.y,
                    u = a.position,
                    l = a.align,
                    d = a.removed,
                    f = Object(o.classNames)("Dropdown", "Dropdown--" + u, (t = {
                        "Dropdown--removed": !!d
                    }, n = "Dropdown--align-" + l, i = "t" === u || "b" === u, n in t ? Object.defineProperty(t, n, {
                        value: i,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : t[n] = i, t));
                return r.createElement("div", {
                    className: f,
                    style: {
                        top: c,
                        left: s
                    },
                    onTransitionEnd: function(t) {
                        return e.onTransitionEnd(t)
                    },
                    onMouseEnter: this.onDropdownMouseEnter,
                    onMouseLeave: this.onDropdownMouseLeave
                }, r.createElement("ul", {
                    className: "Dropdown__in"
                }, this.props.data.map(function(t, n) {
                    return r.createElement("li", {
                        className: "Dropdown__item",
                        onClick: function(n) {
                            return e.onItemClick(n, t)
                        },
                        key: t.id || n
                    }, t.text)
                })))
            }, t.prototype.render = function() {
                var e = this.renderDropdown();
                return e ? (this.defaultNode || "undefined" == typeof window || (this.defaultNode = document.createElement("div"), document.body.appendChild(this.defaultNode)), r.createElement(r.Fragment, null, this.props.children, i.createPortal(e, this.defaultNode))) : this.props.children
            }, t
        }(r.Component);
    t.default = u, u.defaultProps = {
        position: "b",
        align: "center",
        marginTop: 0,
        marginLeft: 0,
        trigger: "click"
    }
}, , , function(e, t, n) {
    var r = n(91),
        i = n(34),
        o = n(155),
        a = n(51)("src"),
        s = Function.toString,
        c = ("" + s).split("toString");
    n(184).inspectSource = function(e) {
        return s.call(e)
    }, (e.exports = function(e, t, n, s) {
        var u = "function" == typeof n;
        u && (o(n, "name") || i(n, "name", t)), e[t] !== n && (u && (o(n, a) || i(n, a, e[t] ? "" + e[t] : c.join(String(t)))), e === r ? e[t] = n : s ? e[t] ? e[t] = n : i(e, t, n) : (delete e[t], i(e, t, n)))
    })(Function.prototype, "toString", function() {
        return "function" == typeof this && this[a] || s.call(this)
    })
}, function(e, t, n) {
    var r = n(133),
        i = n(98),
        o = n(22),
        a = n(215),
        s = n(155),
        c = n(198),
        u = Object.getOwnPropertyDescriptor;
    t.f = n(154) ? u : function(e, t) {
        if (e = o(e), t = a(t, !0), c) try {
            return u(e, t)
        } catch (e) {}
        if (s(e, t)) return i(!r.f.call(e, t), e[t])
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return c
    });
    var r = n(54),
        i = n(102),
        o = 5e3,
        a = 54e6,
        s = 72e5;

    function c(e) {
        var t = setInterval(function(e) {
            var t = e.get().tabs,
                n = e.get().peer,
                o = Object.keys(t).filter(function(t) {
                    return Object(r.isFullyLoadedTab)(e, t) && intval(t) !== n
                }).map(function(e) {
                    return t[e]
                });
            o.filter(function(e) {
                return Date.now() - e.last_visited > a
            }).forEach(function(t) {
                return e.set(i.cleanTab.bind(null, t.peerId))
            }), o.filter(function(t) {
                return Object(r.isFullyLoadedTab)(e, t.peerId) && "string" != typeof t.history && Date.now() - t.last_touched > s
            }).forEach(function(t) {
                return e.set(i.stringifyTab.bind(null, t.peerId))
            })
        }.bind(null, e), o);
        return {
            unmount: function() {
                clearInterval(t)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151)),
        o = n(162),
        a = n(33),
        s = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var c = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.needRecalcSize = !1, r.state = {}, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.className,
                n = e.loading,
                c = e.children,
                u = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["className", "loading", "children"]),
                l = Object(i.classNames)("ButtonWithProgress", {
                    "ButtonWithProgress--loading": n
                }, t);
            return r.createElement(a.default, s({}, u, {
                className: l
            }), r.createElement("span", {
                className: "ButtonWithProgress__content"
            }, c), n && r.createElement(o.default, {
                inverted: "primary" === e.appearance,
                className: "ButtonWithProgress__progress"
            }))
        }, t
    }(r.Component);
    t.default = c, c.defaultProps = {
        appearance: "primary",
        size: "m",
        wide: !1,
        loading: !1
    }
}, function(e, t, n) {
    "use strict";
    ! function e() {
        if ("undefined" != typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ && "function" == typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE) try {
            __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)
        } catch (e) {
            console.error(e)
        }
    }(), e.exports = n(46)
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(33),
        o = n(112),
        a = n(90),
        s = n(151),
        c = n(109),
        u = n(148),
        l = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function d(e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
    }

    function f(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }

    function p(e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
        e.prototype = Object.create(t && t.prototype, {
            constructor: {
                value: e,
                enumerable: !1,
                writable: !0,
                configurable: !0
            }
        }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
    }
    var m = function(e) {
            function t() {
                return d(this, t), f(this, e.apply(this, arguments))
            }
            return p(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.color,
                    n = e.action,
                    o = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["color", "action"]),
                    a = t.toLowerCase().replace("default", "secondary"),
                    s = Emoji.emojiToHTML(clean(Object(c.decodeHTMLEntities)(n.label)).replace(/\n(\r)?/gi, " "), !0);
                return r.createElement(i.default, l({
                    wide: !0,
                    overflow: !0
                }, o, {
                    appearance: a,
                    dangerouslySetInnerHTML: {
                        __html: s
                    }
                }))
            }, t
        }(r.Component),
        g = function(e) {
            function t() {
                return d(this, t), f(this, e.apply(this, arguments))
            }
            return p(t, e), t.prototype.render = function() {
                var e = this,
                    t = Object(u.getCurrentKeyboard)(this.props.store);
                if (!t || !t.buttons) return null;
                return r.createElement("div", {
                    className: Object(s.classNames)("Keyboard", {
                        "Keyboard--hidden": t.hide
                    })
                }, r.createElement(o.default, {
                    className: "Keyboard__scroll-wrapper"
                }, r.createElement("div", {
                    className: "Keyboard__container"
                }, t.buttons.map(function(t, n) {
                    return r.createElement("div", {
                        key: "row-" + n,
                        className: "Keyboard__row"
                    }, t.map(function(n, i) {
                        return r.createElement("div", {
                            className: "Keyboard__button",
                            key: "row-" + i,
                            style: {
                                width: (o = t.length, "calc(100% / " + o + " - 10px)")
                            }
                        }, r.createElement(m, l({
                            onClick: function() {
                                return e.props.send(n)
                            }
                        }, n)));
                        var o
                    }))
                }))))
            }, t
        }(r.Component);
    t.default = Object(a.connect)(g)
}, , function(e, t, n) {
    var r = n(170)("wks"),
        i = n(51),
        o = n(91).Symbol,
        a = "function" == typeof o;
    e.exports = function(e) {
        return r[e] || (r[e] = a && o[e] || (a ? o : i)("Symbol." + e))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "parseFwd", function() {
        return f
    }), n.d(t, "replaceHyperLinks", function() {
        return p
    }), n.d(t, "replaceEmailLinks", function() {
        return m
    }), n.d(t, "replaceMentions", function() {
        return g
    }), n.d(t, "replaceHashtags", function() {
        return v
    }), n.d(t, "confirmDelivery", function() {
        return b
    }), n.d(t, "linksReplacer", function() {
        return y
    });
    var r = n(128),
        i = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        o = void 0,
        a = window,
        s = a.clean,
        c = a.replaceEntities,
        u = a.statlogsValueEvent;

    function l(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [],
            n = e.split("_"),
            r = i(n, 2);
        return [r[0], r[1], t]
    }
    var d = {};

    function f(e) {
        if (d[e]) return d[e];
        for (var t = e ? e.length : 0, n = [], r = [], o = "", a = 0; a < t; a++) {
            var s = e[a],
                c = s.charCodeAt(0);
            c >= 48 && c <= 57 || "_" === s || "-" === s ? o += s : "(" !== s && ")" !== s && ":" !== s && "," !== s || ("" !== o && (r.push(o), n.push("id"), o = ""), r.push(s), n.push(s))
        }
        o.length > 0 && (r.push(o), n.push("id"));
        var u = function e(t, n) {
                var r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0,
                    o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0;
                if (o > 50) return [
                    [], t.length
                ];
                for (var a = [], s = ""; r < t.length;) {
                    var c = t[r];
                    if ("id" === c) s = n[r];
                    else if ("," === c && s) a.push(l(s)), s = "";
                    else if ("(" === c) {
                        var u = e(t, n, r + 1, o + 1),
                            d = i(u, 2),
                            f = d[0];
                        r = d[1], a.push(l(s, f)), s = ""
                    } else if (")" === c) return "" !== s && a.push(l(s)), [a, r];
                    r++
                }
                return s && a.push(l(s)), [a, r]
            }(n, r),
            f = i(u, 1)[0];
        return Object.keys(d).length > 300 && (d = {}), d[e] = f, f
    }

    function p(e, t) {
        for (var n = void 0, i = 0, o = e; null !== (n = r.MESSAGE_REGEXP.exec(e));) {
            var a = (n = h(n))[0].length,
                s = n.index + a,
                c = e[n.index - 1],
                u = e[s - 1],
                l = void 0 !== c && /([\w\$А-Яа-яёЁєЄҐґЇїІіЈј\—\-\_@;.])/i.test(c),
                d = void 0 !== u && /([:;$])/i.test(u);
            if (!l && !d) {
                var f = _(n),
                    p = f.domain.toLowerCase();
                if (p.length <= r.MAX_DOMAIN_LENGTH && -1 !== r.TOP_DOMAINS.indexOf(p)) {
                    var m = t(f);
                    o = o.slice(0, n.index + i) + m + o.slice(s + i), i += m.length - a
                }
            }
        }
        return o
    }

    function m(e, t) {
        return e.replace(r.EMAIL, t || function(e) {
            return '<a href="mailto:' + e + '">' + e + "</a>"
        })
    }

    function g(e, t) {
        return e.replace(r.MENTION, t || function(e, t, n, r, i) {
            return '<a href="/' + (t + n) + '" class="mem_link" mention="' + s(r || "") + '" mention_id="' + s(t + n) + '" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)">' + i + "</a>"
        })
    }

    function h(e) {
        if (!e[0] || !e[6]) return e;
        var t = e[0].length - 1,
            n = e[6].length - 1;
        return "." === e[0][t] && "." === e[6][n] && (e[0] = e[0].slice(0, t), e[6] = e[6].slice(0, n)), e
    }

    function _(e) {
        return {
            full: e[0],
            protocol: e[1] || "http://",
            url: e[2],
            domain: e[4],
            query: e[6] || ""
        }
    }

    function v(e, t) {
        return e.replace((o || (o = new RegExp(r.RE_HASHTAG_EXTRACTION_PATTERN, "ig")), o), function(e, n, r, i, o, a) {
            return (n || "") + t(r + (o || ""))
        })
    }

    function b(e) {
        u("ttl_message_confirm_delivery", e)
    }

    function y(e, t) {
        var n = t.protocol,
            i = t.url,
            o = t.query,
            a = t.domain,
            u = t.full;
        try {
            u = decodeURIComponent(u)
        } catch (e) {}
        if (u.length > 55 && (u = u.substr(0, 53) + ".."), u = s(u).replace(/&amp;/g, "&"), !e && a.match(r.OUR_DOMAINS)) {
            var l, d = i = c(i).replace(r.ENTITIES, encodeURIComponent),
                f = i.indexOf("#/"),
                p = "";
            return f >= 0 ? d = i.substr(f + 1) : (f = i.indexOf("#!")) >= 0 && (d = "/" + i.substr(f + 2).replace(/^\//, "")), (l = d.match(r.VK_DOMAIN)) && l[1].length < 32 && (p = ' mention_id="' + l[1] + '" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"'), '<a href="' + function(e) {
                return e.replace(/"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;")
            }(n + i + o) + '" target="_blank"' + p + ">" + u + "</a>"
        }
        return '<a href="' + ("away.php?utf=1&to=" + encodeURIComponent(n + c(i + o))) + '" target="_blank" onclick="' + ("return goAway('" + s((n + i + o).replace(/'/g, "\\'")) + "', {}, event);") + '">' + u + "</a>"
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "CONTROLLER", function() {
        return r
    }), n.d(t, "post", function() {
        return o
    }), n.d(t, "plainget", function() {
        return a
    }), n.d(t, "plaingetCancelable", function() {
        return s
    });
    var r = "al_im.php",
        i = 2;

    function o(e, t, n) {
        return t && (t.im_v = i), new Promise(function(r, i) {
            ajax.post(e, t, {
                timeout: n,
                onDone: function() {
                    r.apply(null, [
                        [].concat(Array.prototype.slice.call(arguments))
                    ])
                },
                onFail: function() {
                    return i.apply(null, arguments), !0
                }
            })
        })
    }

    function a(e, t) {
        return s(e, t, arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}).request
    }

    function s(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
            r = void 0;
        return r = window.XDomainRequest ? new XDomainRequest : ajax._getreq(), {
            request: new Promise(function(i, o) {
                var a = void 0,
                    s = Date.now(),
                    c = n.timeout || 60,
                    u = ajx2q(t);
                if (window.XDomainRequest) r.open("get", e + "?" + u), r.ontimeout = function() {
                    o(["", {}])
                }, r.onerror = function() {
                    o(["", {}])
                }, r.onload = function() {
                    i([r.responseText, {}])
                }, setTimeout(function() {
                    r.send()
                }, 0);
                else {
                    r.onreadystatechange = function() {
                        4 == r.readyState && (clearInterval(a), r.status >= 200 && r.status < 300 ? i([r.responseText, r]) : o([r.responseText, r]))
                    };
                    try {
                        r.open("GET", e + "?" + u, !0)
                    } catch (e) {
                        return o([e, r])
                    }
                    r.send()
                }
                a = setInterval(function() {
                    Date.now() - s > 1e3 * c && (o(["", {}]), clearInterval(a))
                }, 1e3)
            }),
            cancel: function() {
                r.abort()
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(65)),
        o = n(151),
        a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };
    var s = "Select...",
        c = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.handleMouseDown = function(e) {
                    r.props.onFocus && "function" == typeof r.props.onFocus && r.props.onFocus(r.state.opened), "mousedown" === e.type && 0 !== e.button || (e.stopPropagation(), e.preventDefault(), r.props.disabled || r.setState({
                        opened: !r.state.opened
                    }))
                }, r.setValue = function(e, t) {
                    var n = {
                        selected: {
                            value: e,
                            label: t
                        },
                        opened: !1
                    };
                    r.fireChangeEvent(n), r.setState(n)
                }, r.fireChangeEvent = function(e) {
                    e.selected !== r.state.selected && r.props.onChange && r.props.onChange({
                        name: r.props.name,
                        selected: e.selected
                    })
                }, r.handleDocumentClick = function(e) {
                    r.mounted && r.state.opened && !r.el.contains(e.target) && r.setState({
                        opened: !1
                    })
                }, r.state = {
                    selected: void 0 !== n.value ? r.getOptionByValue(n.options, n.value) : {
                        label: n.placeholder || s,
                        value: ""
                    },
                    opened: !1
                }, r.mounted = !0, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                void 0 !== e.value && e.value !== this.state.selected ? this.setState({
                    selected: this.getOptionByValue(e.options, e.value)
                }) : void 0 === e.value && this.setState({
                    selected: {
                        label: e.placeholder || s,
                        value: ""
                    }
                })
            }, t.prototype.componentDidMount = function() {
                this.el = i.findDOMNode(this), document.addEventListener("click", this.handleDocumentClick, !1), document.addEventListener("touchend", this.handleDocumentClick, !1)
            }, t.prototype.componentWillUnmount = function() {
                this.mounted = !1, document.removeEventListener("click", this.handleDocumentClick, !1), document.removeEventListener("touchend", this.handleDocumentClick, !1)
            }, t.prototype.getOptionByValue = function(e, t) {
                return e.find(function(e) {
                    return "object" !== (void 0 === e ? "undefined" : a(e)) ? e === t : e.value === t
                })
            }, t.prototype.renderOption = function(e) {
                var t = this,
                    n = Object(o.classNames)("Select__option", {
                        "Select__option--selected": e === this.state.selected
                    }),
                    i = void 0 !== e.value ? e.value : e.label || e,
                    a = void 0 !== e.label ? e.label : e;
                return r.createElement("div", {
                    key: i,
                    className: n,
                    onMouseDown: function() {
                        return t.setValue(i, a)
                    },
                    onClick: function() {
                        return t.setValue(i, a)
                    }
                }, a)
            }, t.prototype.buildMenu = function() {
                var e = this,
                    t = this.props.options.map(function(t) {
                        return "group" === t.type ? r.createElement("div", {
                            className: "Select__group",
                            key: t.name
                        }, t.name && r.createElement("div", {
                            className: "Select__title"
                        }, t.name), t.items.map(function(t) {
                            return e.renderOption(t)
                        })) : e.renderOption(t)
                    });
                return t.length ? t : r.createElement("div", {
                    className: "Select__noresults"
                }, "No options found")
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.className,
                    n = e.style,
                    i = Object(o.classNames)("Select", t, {
                        "Select--opened": this.state.opened,
                        "Select--disabled": this.props.disabled
                    });
                return r.createElement("div", {
                    className: i,
                    style: n
                }, r.createElement("div", {
                    className: "Select__control",
                    onClick: this.handleMouseDown
                }, r.createElement("div", {
                    className: "Select__placeholder"
                }, "string" == typeof this.state.selected ? this.state.selected : this.state.selected.label), r.createElement("span", {
                    className: "Select__arrow"
                })), this.state.opened && r.createElement("div", {
                    className: "Select__menu"
                }, this.buildMenu()))
            }, t
        }(r.Component);
    t.default = c
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "canMessageBeEdited", function() {
        return c
    }), n.d(t, "convertEmojiHtmlToRegularText", function() {
        return u
    }), n.d(t, "findLastMessageToEdit", function() {
        return l
    }), n.d(t, "wasMessageReallyModified", function() {
        return d
    }), n.d(t, "replaceMsgAfterEdit", function() {
        return f
    });
    var r = n(148),
        i = n(26),
        o = n(54),
        a = n(118),
        s = n(7);

    function c(e, t) {
        t = Object(r.parserMessage)(t);
        var n = vk.id == t.peerId && !Object(s.unpackStore)(e).gid;
        return 333 != t.peerId && (!(!n && !Object(i.isOut)(t)) && (!Object(i.isServiceMsg)(t) && (!(Date.now() / 1e3 - t.date > 86400) && (!(Object(i.isGift)(t) || Object(i.isSticker)(t) || Object(i.isAudioMsg)(t) || Object(i.isGraffiti)(t) || Object(i.isMoney)(t) || Object(i.isMessageWithInviteLink)(t) || Object(i.isVKPay)(t)) && !Object(o.isAlreadyDeleted)(e, t.peerId, t.messageId)))))
    }

    function u(e) {
        var t = document.createElement("div");
        return e = e.replace(/\[((id|club)\d+)\|(.+?)]/g, "@$1 ($3)"), t.innerHTML = e, Emoji.val(t)
    }

    function l(e, t) {
        return +(t && t.msgs ? Object.keys(t.msgs) : []).filter(function(e) {
            return e > 0
        }).sort(function(e, t) {
            return t - e
        }).find(function(n) {
            return c(e, t.msgs[n])
        }) || null
    }

    function d(e, t, n) {
        var r = Object(a.convertKludgesToAttaches)(t.kludges, t.messageId),
            i = n.dData.attaches;
        if (u(t.text) !== n.dData.txt || r.length !== i.length) return !0;
        for (var o = r.length; o--;) {
            var s = r[o],
                c = i[o];
            if (s.id != c.id || s.type != c.type || "poll" == s.type && c.object && c.object.poll_is_edited) return !0
        }
        return !1
    }

    function f(e, t, n, r, i, a) {
        t.origText = n, t.text = Object(o.replaceSpecialSymbols)(clean(n)).replace(/\n/gi, "<br>"), t.attaches = r, t.kludges.emoji = 1, t.local = 1, t.share_url = i, t.cancelled_shares = a, t.update_time = Math.floor(Date.now() / 1e3), e.get().tabs[t.peerId].msgs[t.messageId] = t
    }
}, function(e, t, n) {
    var r = n(68)("unscopables"),
        i = Array.prototype;
    void 0 == i[r] && n(34)(i, r, {}), e.exports = function(e) {
        i[r][e] = !0
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(109),
        o = n(151),
        a = n(148),
        s = n(102),
        c = n(178),
        u = n(161),
        l = n(64),
        d = n(101),
        f = n(30);

    function p(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    var m = i.default.getLang,
        g = window,
        h = g.showFastBox,
        _ = g.unclean,
        v = function() {},
        b = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onChange = function(e) {
                    var t = r.props.store.get(),
                        n = e.target.value;
                    Object(s.searchLocalHints)(n, t).then(function(e) {
                        return r.setSearchResults({}, !1, n, e), n ? (r.isSearching = !0, r.serverSearch(n, e.map(function(e) {
                            return e.peerId
                        }))) : Promise.resolve([])
                    }).then(r.appendSearchResults).catch(function() {})
                }, r.serverSearch = Object(f.debouncedPromise)(function(e, t) {
                    var n = r.props.store;
                    return Object(s.searchHints)(e, t, "friends", n.get())
                }, 300), r.onRemoveToken = function(e) {
                    return new Promise(function(t) {
                        var n = r.state.selected.filter(function(t) {
                            return t !== e
                        });
                        r.selected = n.reduce(function(e, t) {
                            return e[t] = !0, e
                        }, {}), r.setState({
                            selected: n
                        }, t)
                    })
                }, r.onSelect = function(e) {
                    return new Promise(function(t) {
                        var n = r.selected[e] ? r.state.selected.filter(function(t) {
                            return t !== e
                        }) : [].concat(r.state.selected, e).filter(function(e, t, n) {
                            return n.indexOf(e) === t
                        });
                        r.selected = n.reduce(function(e, t) {
                            return e[t] = !0, e
                        }, {}), r.resetSearch({
                            selected: n,
                            value: ""
                        }, t)
                    })
                }, r.onAddPeople = function() {
                    var e = r.props.store,
                        t = e.get().peer,
                        n = r.state.selected.map(function(e) {
                            return parseInt(e)
                        });
                    r.setState({
                        loading: !0
                    }), e.set(s.addNewMember.bind(null, t, n)).then(function() {
                        return e.set(s.getChatDetails.bind(null, t)).then(function() {
                            r.selected = {}, r.resetSearch({
                                selected: [],
                                loading: !1
                            }, function() {
                                r.props.afterSave(n.length)
                            })
                        })
                    }).catch(function(e) {
                        r.selected = {}, r.resetSearch({
                            selected: [],
                            loading: !1
                        }), h(m("global_error"), e)
                    })
                }, r.setSearchResults = function(e, t, n, i) {
                    var o = r.props.store.get(),
                        s = Object(a.getTab)(o, o.peer),
                        c = [];
                    i.forEach(function(e) {
                        r.data[e.peerId] || (r.data[e.peerId] = e), -1 === s.memberIds.indexOf(e.peerId) && c.push(e.peerId)
                    }), r.setState(Object.assign({}, e, {
                        found: c,
                        value: n
                    }), t || v)
                }, r.appendSearchResults = function(e) {
                    var t = r.props.store.get(),
                        n = Object(a.getTab)(t, t.peer),
                        i = r.state.found;
                    e.forEach(function(e) {
                        r.data[e.peerId] || (r.data[e.peerId] = e), -1 === n.memberIds.indexOf(e.peerId) && -1 === i.indexOf(e.peerId) && i.push(e.peerId)
                    }), r.isSearching = !1, r.setState({
                        found: i
                    })
                }, r.state = {
                    selected: [],
                    value: "",
                    loading: !1,
                    found: []
                }, r.data = {}, r.selected = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.resetSearch = function(e, t) {
                return Object(s.searchLocalHints)("", this.props.store.get()).then(this.setSearchResults.bind(this, e, t, ""))
            }, t.prototype.componentDidMount = function() {
                this.resetSearch()
            }, t.prototype.render = function() {
                var e, t = this,
                    n = Object.keys(this.state.selected).length;
                return r.createElement("div", {
                    className: "ChatSettingsMembers"
                }, r.createElement(u.default, (p(e = {
                    className: "ChatSettingsMembers__multiSelect",
                    tokens: this.state.selected.map(function(e) {
                        return {
                            text: _(t.data[e].name),
                            id: e
                        }
                    }),
                    removeTokenPlaceholder: m("mail_create_chat_remove_user"),
                    onRemoveToken: this.onRemoveToken,
                    placeholder: m("mail_search_creation"),
                    value: this.state.value,
                    useInfiniteScroll: !1,
                    onChange: this.onChange,
                    onSelect: this.onSelect
                }, "useInfiniteScroll", !0), p(e, "hasMore", !1), p(e, "virtualized", !0), p(e, "loadMore", function() {}), p(e, "notFoundText", m("mail_not_found")), p(e, "autoFocus", !0), p(e, "isSearching", this.isSearching), e), this.state.found.map(function(e) {
                    return r.createElement("div", {
                        className: Object(o.classNames)("ChatSettingsMembers__entity", p({}, "ChatSettingsMembers__entity--selected", t.selected[e])),
                        key: e,
                        "data-id": e
                    }, r.createElement(c.default, {
                        size: "34",
                        title: t.data[e].name,
                        photo: t.data[e].photo
                    }))
                })), r.createElement(d.default, {
                    alignment: "right"
                }, r.createElement(l.default, {
                    disabled: 0 === n,
                    onClick: this.onAddPeople,
                    loading: this.state.loading
                }, m(n < 2 ? "mail_append_chat" : "mail_im_create_chat_with"))))
            }, t
        }(r.Component);
    t.default = b
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "RECENT_SEARCH_OP", function() {
        return i
    }), n.d(t, "PIN_HIDDEN_ID_OP", function() {
        return o
    }), n.d(t, "deleteOldStoredFormat", function() {
        return u
    }), n.d(t, "mount", function() {
        return l
    });
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        i = "recent_search",
        o = "pin_hide";

    function a(e) {
        return "im_store_" + e
    }

    function s(e) {
        return ls.get(a(e)) || {}
    }

    function c(e, t, n) {
        if (ls.checkVersion()) {
            var r = JSON.stringify(t);
            rand(0, 1e5) <= 1 && statlogsValueEvent("im_local_store_size", r.length), n(a(e), r)
        }
    }

    function u(e, t) {
        for (var n = ["fwd", "draft", "bind_attach"], r = s(e), i = !1, o = n.length; o--;) n[o] in r && (delete r[n[o]], i = !0);
        i && c(e, r, t)
    }

    function l(e) {
        var t = debounce(function(e, t) {
            localStorage.setItem(e, t)
        }, 300);
        ls.checkVersion() && u(e, t);
        var n = {
                db: s(e),
                checkTime: Date.now()
            },
            l = function(e, t, n) {
                n.key === a(e) && (t.db = JSON.parse(n.newValue), t.checkTime = Date.now())
            }.bind(null, e, n);
        return window.addEventListener("storage", l, !1), {
            select: function(t, r) {
                return Date.now() - n.checkTime > 1e3 && (n.db = s(e)),
                    function(e, t, n) {
                        return t === i ? e[t] || [] : t === o ? e[t] && e[t][n] : e[t] ? extend(!0, {}, e[t][n]) : null
                    }(n.db, t, r)
            },
            selectByKey: function(t) {
                return Date.now() - n.checkTime > 1e3 && (n.db = s(e)), n.db[t]
            },
            update: function(a, s) {
                var u = function(e, t, n) {
                    switch (e[t] || (e[t] = {}), t) {
                        case i:
                            var a = n;
                            a && a.length > 0 ? e[t] = a : delete e[t];
                            break;
                        case o:
                            var s = r(n, 2),
                                c = s[0],
                                u = s[1];
                            u ? e[t][c] = +u : delete e[t][c]
                    }
                    return e
                }(n.db, a, s);
                return n.db = u, n.checkTime = Date.now(), c(e, u, t)
            },
            updateByKey: function(r, i) {
                return n.db[r] = i, n.checkTime = Date.now(), c(e, n.db, t)
            },
            unmount: function() {
                window.removeEventListener("storage", l, !1)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151)),
        o = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.onChange = function(e) {
                r.isControlledOutside || r.setState({
                    value: e.target.value
                }), r.props.onChange && r.props.onChange(e)
            }, r.getRef = function(e) {
                r.element = e
            }, void 0 !== n.value || n.isControlledOutside ? r.isControlledOutside = !0 : r.state = {
                value: n.initialValue || ""
            }, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.alignment,
                n = e.value,
                a = (e.onChange, e.initialValue, e.className),
                s = (e.isControlledOutside, function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["alignment", "value", "onChange", "initialValue", "className", "isControlledOutside"])),
                c = {
                    "Input--left": "left" === t,
                    "Input--center": "center" === t,
                    "Input--right": "right" === t
                };
            return r.createElement("input", o({}, s, {
                className: Object(i.classNames)("Input", c, a),
                ref: this.getRef,
                value: this.isControlledOutside ? n : this.state.value,
                onChange: this.onChange
            }))
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        type: "text",
        initialValue: "",
        alignment: "left"
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return w
    });
    var r = n(194),
        i = n(188),
        o = n(65),
        a = n(90),
        s = n(130),
        c = n(102),
        u = window,
        l = u.MessageBox,
        d = u.show,
        f = u.hide,
        p = u.isVisible,
        m = u.getLang,
        g = u.boxRefreshCoords,
        h = void 0;

    function _() {
        h && h.hide()
    }

    function v() {
        h && h.updateBoxCoords()
    }

    function b() {
        return document.querySelector("#MessageForward")
    }

    function y(e) {
        var t = document.querySelector("#box_layer_wrap"),
            n = document.querySelector("#box_loader"),
            i = p(t);
        return {
            unmount: function() {
                var t = b();
                t && o.unmountComponentAtNode(t), Object(r.destroyModule)(e)
            },
            showLoader: function() {
                g(n), d(n), i || d(t)
            },
            hideLoader: function() {
                f(n), i || f(t)
            }
        }
    }

    function w(e, t, n) {
        var u = (0, Object(r.createMutations)(y).bindMutations)(Object(r.createModule)({
                handlers: function(e, t) {}
            })),
            d = {
                hideButtons: !0,
                bodyStyle: "padding: 0; background: none;",
                width: 500,
                onShow: function() {
                    ! function(e) {
                        var t = b();
                        t && o.render(i.createElement(a.default, {
                            value: e
                        }, i.createElement(s.default, {
                            getLang: m,
                            closePopup: _,
                            updatePopup: v
                        })), t)
                    }(t), requestAnimationFrame(function() {
                        return h.updateBoxCoords()
                    })
                },
                onHideAttempt: function() {
                    return t.set(c.prepareForward.bind(null, null)), u.unmount(), !0
                }
            };
        return u.showLoader(), Promise.resolve().then(function(e) {
            u.hideLoader(), h = new l(d).content('<div id="MessageForward"></div>').show()
        }), u
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "chatUserHasJoined", function() {
        return v
    }), n.d(t, "chatUserHasLeft", function() {
        return b
    }), n.d(t, "handleEventChatUpdated", function() {
        return y
    });
    var r = n(54),
        i = n(148),
        o = n(102),
        a = n(76);
    var s = 3,
        c = 4,
        u = 5,
        l = 6,
        d = 7,
        f = 8,
        p = 9,
        m = 10,
        g = 11;

    function h(e, t) {
        return -1 === (e ? e.indexOf(t) : 0) && (e.push(t), !0)
    }

    function _(e, t) {
        var n = e ? e.indexOf(t) : -1;
        return -1 !== n && (e.splice(n, 1), !0)
    }

    function v(e, t, n) {
        if (Object(r.isTabLoaded)(n.get(), e)) {
            var a = Object(i.getTab)(n, e);
            h(a.memberIds, t) && a.membersCount++, t === vk.id && (a.data.kicked = 0, a.data.closed = 0)
        }
        return n.set(o.loadChatMember.bind(null, (s = {}, c = e, u = [t], c in s ? Object.defineProperty(s, c, {
            value: u,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : s[c] = u, s))).then(function(r) {
            if (t === vk.id && n.get().peer === e) return Promise.all([n.set(o.getPinnedMessage.bind(null, e)), n.set(o.loadKeyboard.bind(null, e))])
        });
        var s, c, u
    }

    function b(e, t, n, a, s) {
        if (Object(r.isTabLoaded)(a.get(), e)) {
            var c = Object(i.getTab)(a, e);
            _(c.memberIds, t) && c.membersCount--, t === vk.id && (n ? c.data.kicked = 1 : c.data.closed = 1)
        }
        return t === vk.id && a.get().peer === e ? (s.cancelEditing(), a.set(o.unpinMessageOptimistic.bind(null, e))) : Promise.resolve()
    }

    function y(e, t, n, r, y, C) {
        var k = Object(i.getTab)(e, t);
        switch (n) {
            case s:
            case p:
                return n === s ? h(k.adminIds, r) : _(k.adminIds, r), w(e, t, y), !0;
            case c:
                return k.data.flags = r, w(e, t, y), !0;
            case u:
                return delete k.pinHideId, cur.imDb.update(a.PIN_HIDDEN_ID_OP, [k.peerId, void 0]), !1;
            case l:
                return v(t, r, e).then(function() {
                    return O(e, t, y, C), y.fixKeyboard()
                }), !0;
            case d:
            case f:
                return b(t, r, n === f, e, y).then(function() {
                    return O(e, t, y, C)
                }), e.get().id !== r && (Object(i.getKeyboard)(e, t) || {}).author_id !== r || e.set(o.deleteKeyboard.bind(null, t)).then(function() {
                    return y.fixKeyboard()
                }), !0;
            case m:
                return e.set(o.loadBanner.bind(null, t)).then(function() {
                    return y.updateBanner(e)
                }), !0;
            case g:
                return !0;
            default:
                return !1
        }
    }

    function w(e, t, n) {
        e.get().peer === t && (Object(o.setActions)(e.get()), n.updateActions(e))
    }

    function O(e, t, n, r) {
        e.get().peer === t && (Object(o.setActions)(e.get()), n.updateChat(e, t), r.updateDialog(t, e))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return H
    });
    var r = n(194),
        i = n(102),
        o = n(120),
        a = n(54),
        s = 600,
        c = browser.msie && intval(browser.version) < 10 ? window.XDomainRequest : window.XMLHttpRequest;

    function u(e) {
        var t = e % 60;
        return parseInt(e / 60) + ":" + (t < 10 ? "0" : "") + t
    }
    var l = void 0,
        d = void 0,
        f = void 0,
        p = void 0,
        m = void 0,
        g = void 0,
        h = void 0,
        _ = void 0,
        v = void 0,
        b = void 0,
        y = void 0,
        w = void 0,
        O = void 0,
        C = !1,
        k = !1,
        E = 100;

    function j(e) {
        if (!k) {
            k = !0, Object(a.lockButton)(g);
            var t = {
                peer: _.get().peer,
                from_place: cur.docsChooseFrom,
                imhash: cur.docsChooseImHash,
                blockPersonal: cur.docsChooseBlockPersonal,
                mail_add: cur.docsChooseMailAdd
            };
            (function(e) {
                return new Promise(function(t, n) {
                    for (var r = new FormData, i = [], o = 0; o < e.wave.length; o++) i.push(parseInt(31 * e.wave[o]));
                    r.append("waveform", JSON.stringify(i)), r.append("file", e.buffer, "voice_message." + function(e) {
                        var t = e.match(/.*\/(\w*).*/);
                        switch (t[1]) {
                            case "mpeg":
                                return "mp3";
                            case "ogg":
                            case "webm":
                            case "wav":
                                return t[1]
                        }
                        return ""
                    }(e.mimeType));
                    var a = new c;
                    a.onload = a.onerror = function(e) {
                        var r = e.currentTarget.response;
                        200 == this.status && r.length > 0 && "{" == r[0] ? (r = JSON.parse(r), t(r)) : n()
                    }, a.open("POST", O.upload_url, !0), a.send(r)
                })
            })(e).then(function(e) {
                return e.file ? new Promise(function(n, r) {
                    ajax.post("/docs.php", extend({
                        act: "a_save_doc",
                        from: "choose",
                        from_place: t.from_place,
                        imhash: t.imhash,
                        blockPersonal: t.blockPersonal,
                        mail_add: t.mail_add
                    }, e), {
                        onDone: function(e, r) {
                            P(), y([
                                ["doc", e + "_" + r, "audiomsg"]
                            ], {}, t.peer), D(), n()
                        },
                        onFail: function(e) {
                            r(e)
                        },
                        progress: null
                    })
                }) : Promise.reject()
            }).then(function() {
                Object(a.unlockButton)(g), k = !1
            }).catch(function() {
                k = !1, Object(a.unlockButton)(g), showFastBox(getLang("global_error"), getLang("mail_audio_message_upload_error"))
            })
        }
    }

    function S() {
        d.innerHTML = u(C.duration), C.duration >= s && N()
    }

    function T() {
        stManager.add(["voice_message_player.js", "speech.js"], function() {
            C || (C = Speech.newRecorder(), addEvent(C, "progress", S)), AudioMessagePlayer.detachPlayer(), AudioMessagePlayer.pauseGlobalMedia(), C.record().then(function() {
                var e;
                e = _, O.isRecording = !0, cancelStackPush("audio_message_cancel", function(e) {
                    e.set(i.cancelRecording).then(L)
                }.bind(null, e)), hideProgress(geByClass1("im-audio-message-send-wrapper", l)), show(g), d.innerHTML = "0:00", addClass(l, "im-audio-message_recording"), removeClass(l, "im-audio-message_recorded"), show(l), hide(geByClass1("_im_chat_input_parent")), (b = Speech.createVisualization("wave", C.source, f)).start();
                var t = f.getBoundingClientRect();
                E = (t.right - t.left) / 3
            }).catch(function(e) {
                AudioMessagePlayer.resumeGlobalMedia();
                var t = e.name;
                switch (e.name) {
                    case "DevicesNotFoundError":
                    case "NotFoundError":
                        t = "mail_audio_message_device_error";
                        break;
                    case "PermissionDeniedError":
                    case "PermissionDismissedError":
                        t = "mail_audio_message_permission_error";
                        break;
                    case "Unsupported":
                        t = "mail_audio_message_unsupported_error"
                }
                showFastBox(getLang("global_error"), getLang(t)), console.error(e)
            })
        })
    }

    function I() {
        C && C.stop(), b && (b.destroy(), b = null)
    }

    function P() {
        O.isRecording = !1, cancelStackFilter("audio_message_cancel")
    }

    function M() {
        x(), j(C)
    }

    function x() {
        var e;
        AudioMessagePlayer.loaded && AudioMessagePlayer.resumeGlobalMedia(), removeEvent(C, "finish", x), removeEvent(C, "finish", M), e = URL.createObjectURL(C.buffer), domData(v, "duration", C.duration), domData(v, "ogg", e), domData(v, "mp3", e), geByClass1("audio-msg-track--duration", v).innerHTML = u(C.duration), geByClass1("audio-msg-track--wave-wrapper", v).innerHTML = AudioMessagePlayer.getWave(C.wave, E), removeClass(l, "im-audio-message_recording"), addClass(l, "im-audio-message_recorded")
    }

    function L() {
        var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
        P(), AudioMessagePlayer.loaded && (AudioMessagePlayer.resumeGlobalMedia(), AudioMessagePlayer.detachPlayer()), removeEvent(C, "finish", x), removeEvent(C, "finish", M), I(), D(), e && w()
    }

    function A() {
        C.isRecording ? (addEvent(C, "finish", M), removeEvent(C, "finish", x), I()) : j(C)
    }

    function N() {
        addEvent(C, "finish", x), removeEvent(C, "finish", M), I()
    }

    function D() {
        removeClass(l, "im-audio-message_recorded"), removeClass(l, "im-audio-message_recording"), hide(l), show(geByClass1("_im_chat_input_parent"))
    }

    function R() {
        ge("audiomsg_record"), v = ge("audiomsg_player"), l = geByClass1("im-audio-message-input"), d = geByClass1("audio-msg-track--duration", l), f = geByClass1("audio-msg-track--wave", l), m = geByClass1("im-audio-message--cancel-btn", l), g = geByClass1("_im_audio_send", l), h = geByClass1("audio-msg-track--btn", l), geByClass1("im-chat-input--text", geByClass1("im-page--chat-input"));
        var e = geByClass1("im-chat-input--textarea", geByClass1("im-page--chat-input"));
        addClass(e, "_voice_field_wrap"), addEvent(p, "click", T), addEvent(m, "click", L), addEvent(g, "click", A), addEvent(h, "click", N)
    }

    function F() {
        ! function() {
            C && removeEvent(C, "progress", S);
            removeEvent(p, "click", T), removeEvent(m, "click", L), removeEvent(g, "click", A), removeEvent(h, "click", N)
        }(), v = l = d = f = p = m = g = h = null
    }

    function B(e, t, n) {
        return {
            cancelRecording: L,
            start: function() {
                T()
            },
            unmount: function() {
                L(!1), F()
            }
        }
    }

    function H(e, t, n, s, c) {
        return _ = t, O = t.get().audio_msg, y = n, w = c, Object(o.initFailBack)(), Object(a.getAvailableMicrophones)().then(function(e) {
            var n = e.length > 0;
            n ? (R(), s()) : setCookie("remixvoice", "0", 7), t.set(i.setVoiceMessageAvail.bind(null, n))
        }).catch(function(e) {
            throw setCookie("remixvoice", "0", 7), e
        }), (0, Object(r.createMutations)(B).bindMutations)(e, t, n)
    }
}, function(e, t, n) {
    var r = n(149),
        i = Math.min;
    e.exports = function(e) {
        return e > 0 ? i(r(e), 9007199254740991) : 0
    }
}, function(e, t, n) {
    "use strict";

    function r(e) {
        return function() {
            return e
        }
    }
    var i = function() {};
    i.thatReturns = r, i.thatReturnsFalse = r(!1), i.thatReturnsTrue = r(!0), i.thatReturnsNull = r(null), i.thatReturnsThis = function() {
        return this
    }, i.thatReturnsArgument = function(e) {
        return e
    }, e.exports = i
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return b
    });
    var r = n(194),
        i = n(39),
        o = n(102),
        a = "_im_upload_dropbox",
        s = "jpg jpeg png gif heic heif".split(" "),
        c = ["application/vnd.rn-realmedia-vbr", "application/vnd.rn-realmedia"];

    function u(e) {
        var t = s.slice(0, s.length);
        if ("types" === e) {
            for (var n = t.length, r = 0; r < n; ++r) t.push(t[r].toUpperCase());
            return "*." + t.join(";*.")
        }
        return "accept" === e ? "." + s.join(",.") : "mask" === e ? s.join("|") : ""
    }

    function l(e, t, n) {
        var r = void 0 !== t.ind ? t.ind : t,
            i = t.fileName ? r + "_" + t.fileName : t;
        if (re("upload" + i + "_progress_wrap"), e().unchoose(i), !geByClass1("popup_box_container")) {
            var o = getLang("mail_add_doc_error");
            "photo" === Upload.options[r].file_name ? o = getLang("mail_add_photo_error") : "video_file" === Upload.options[r].file_name && (o = getLang("video_upload_error")), setTimeout(showFastBox({
                title: getLang("global_error")
            }, o).hide, 2e3)
        }
        topError("Upload failed", {
            dt: -1,
            type: 102,
            url: (ge("file_uploader_form" + r) || {}).action
        }), Upload.embed(r)
    }

    function d(e) {
        var t = void 0 !== e.ind ? e.ind : e,
            n = (e.fileName || e.filename || "").replace(/[&<>"']/g, ""),
            r = n ? t + "_" + n : e,
            i = ge("upload" + r + "_progress_wrap");
        return i && hide(geByClass1("progress_x", i)), r
    }

    function f(e, t) {
        if (!e().canAddMedia()) return "none";
        if (!t.items || !t.items.length) return "media";
        var n = "^(" + u("mask") + ")";
        return [].slice.call(t.items).every(function(e) {
            var t = e.type.split("/");
            return new RegExp(n, "i").test(t[1])
        }) ? "photo" : [].slice.call(t.items).every(function(e) {
            return "video" === e.type.split("/")[0] || ~c.indexOf(e.type)
        }) ? "video" : "doc"
    }

    function p(e) {
        var t = geByClass1(a),
            n = geByClass1("im-page--chat-header").getBoundingClientRect(),
            r = geByClass1("im-chat-input").getBoundingClientRect();
        (n.width < 10 || r.bottom - n.bottom < 10) && (e = "none"), t.style.top = n.bottom + "px", t.style.left = n.left + 1 + "px", t.style.width = n.width - 2 + "px", t.style.height = r.bottom - n.bottom + "px", t.setAttribute("data-mode", e), "none" !== e && show(t)
    }

    function m() {
        var e = geByClass1(a);
        hide(e)
    }

    function g(e, t, n) {
        return {
            loaded: t,
            total: n,
            fileName: e.fileName ? e.fileName.replace(/[&<>"']/g, "") : void 0
        }
    }

    function h(e, t, n, r) {
        "string" == typeof t && t.indexOf("TERMINATED") > -1 || Upload.onUploadError(e), r().reHeight(n)
    }

    function _(e, t, n, r) {
        var i = t.get().upload_opts,
            o = geByClass1("_im_upload_photo"),
            a = geByClass1("_im_drop_photo");
        return Upload.init(o, i.url, i.params, {
            accept: u("accept"),
            file_name: "photo",
            file_size_limit: 26214400,
            file_types: u("types"),
            file_match: i.opts.ext_re,
            lang: i.opts.lang,
            multiple: 1,
            multi_progress: 1,
            max_files: 10,
            chooseBox: 1,
            clear: 1,
            type: "photo",
            max_attempts: 3,
            server: i.opts.server,
            error: i.opts.default_error,
            error_hash: i.opts.error_hash,
            dropbox: a,
            dragEl: bodyNode,
            onNoFilteredCallback: function(e) {
                Upload.onFileApiSend(r, e)
            },
            onUploadStart: function(e, t) {
                delete cur.notStarted, this.onUploadProgress(e, 0, 0)
            },
            onUploadComplete: function(e, r) {
                var i = window.parseJSON(r);
                i.photos ? function(e, t, n, r) {
                    var i = d(e);
                    ajax.post("al_photos.php", extend({
                        act: "choose_uploaded"
                    }, t), {
                        onDone: function(e, t) {
                            r().choose("photo", e, extend(t, {
                                upload_ind: i
                            }))
                        },
                        onFail: l.bind(null, r, e)
                    })
                }(e, i, 0, n) : h(e, r, t, n)
            },
            onUploadProgress: function(e, t, r) {
                var i = void 0 !== e.ind ? e.ind : e;
                n().progress("photo", i, g(e, t, r))
            },
            onUploadError: function(e, t) {
                statlogsValueEvent("upload_photo_fails", 1, i.opts.server, t), l(n, e)
            },
            onDragEnter: function(e) {
                var t = geByClass1("im-audio-message_recording");
                e.dataTransfer && !t && p(f(n, e.dataTransfer))
            },
            onDragOut: function() {
                m()
            },
            onDrop: function() {
                m()
            }
        })
    }

    function v(e, t, n) {
        var r = t.get().upload_doc_opts,
            i = geByClass1("_im_upload_doc"),
            o = geByClass1("_im_drop_doc");
        return Upload.init(i, r.url, r.params, {
            file_name: "file",
            file_size_limit: 209715200,
            file_types: "*.*;",
            lang: r.opts.lang,
            multiple: 1,
            multi_progress: 1,
            max_files: 10,
            chooseBox: 1,
            clear: 1,
            type: "doc",
            max_attempts: 3,
            server: r.opts.server,
            error: r.opts.default_error,
            error_hash: r.opts.error_hash,
            dropbox: o,
            dragEl: bodyNode,
            onUploadStart: function(e, t) {
                delete cur.notStarted, this.onUploadProgress(e, 0, 0)
            },
            onUploadComplete: function(e, i) {
                var o = window.parseJSON(i);
                o.file ? function(e, t, n, r) {
                    var i = d(e),
                        o = {
                            act: "a_save_doc",
                            from: "choose",
                            mail_add: 1
                        };
                    n.opts.imhash && (o = extend(o, {
                        from_place: "from_gim",
                        imhash: n.opts.imhash
                    })), ajax.post("docs.php", extend(o, t), {
                        onDone: function(e, t, n) {
                            r().choose("doc", e + "_" + t, extend(n, {
                                upload_ind: i
                            }))
                        },
                        onFail: l.bind(null, r, e)
                    })
                }(e, o, r, n) : h(e, i, t, n)
            },
            onUploadProgress: function(e, t, r) {
                var i = void 0 !== e.ind ? e.ind : e;
                n().progress("doc", i, g(e, t, r))
            },
            onUploadError: function(e, t) {
                statlogsValueEvent("upload_doc_fails", 1, r.opts.server, t), l(n, e)
            }
        })
    }

    function b(e, t, n) {
        removeEvent(bodyNode, "dragover dragenter");
        var a = v(0, t, n),
            s = function(e, t, n, r) {
                var a = t.get().upload_video_params;
                if (a) {
                    var s = geByClass1("_im_upload_video"),
                        c = geByClass1("_im_drop_video");
                    return a.options.visible_dropbox = !1, Object(i.getUploadModule)(s, c, a, {
                        onUploadStart: function(e, t) {
                            delete cur.notStarted, this.onUploadProgress(e, 0, 0)
                        },
                        onUploadComplete: function(e, r) {
                            var a = window.parseJSON(r);
                            a.video_id ? Object(i.onVideoUploaded)(e, a, t.get().textMediaSelector, function(e, n) {
                                var r = document.querySelector('[data-video="' + n + '"]'),
                                    i = e.editable.sizes.x[0] || e.thumb;
                                if (r && i) {
                                    r.style.backgroundImage = "url(" + i + ")";
                                    var a = gpeByClass("_im_mess", r);
                                    "im" === cur.module && a && Object(o.updateVideoThumb)(t, a)
                                }
                            }) : h(e, r, t, n)
                        },
                        onUploadProgress: function(e, t, r) {
                            var i = void 0 !== e.ind ? e.ind : e;
                            n().progress("video", i, g(e, t, r))
                        },
                        onUploadError: function(e, t) {
                            statlogsValueEvent("upload_video_fails", 1, a.options.server, t), l(n, e)
                        },
                        onNoFilteredCallback: function(e) {
                            Upload.onFileApiSend(r, e)
                        },
                        onDragEnter: function(e) {
                            var t = geByClass1("im-audio-message_recording");
                            e.dataTransfer && !t && p(f(n, e.dataTransfer))
                        },
                        onDragOut: function() {
                            m()
                        },
                        onDrop: function() {
                            m()
                        }
                    })
                }
            }(0, t, n, a),
            c = _(0, t, n, s);
        cur.lang.attachments_limit = t.get().upload_opts.opts.lang.max_files_warning;
        var d = Object(r.createModule)({
            handlers: function(e) {
                var t = ge("im_full_upload");
                e(t, "change", function o(a) {
                    if (window.Upload && a.target.files) {
                        if (n().canAddMedia()) {
                            var l = Array.from(a.target.files),
                                f = l.filter(function(e) {
                                    return Upload.checkFileType(e.name, u("types"))
                                }),
                                p = l.filter(function(e) {
                                    return Upload.checkFileType(e.name, Object(i.getUploadVideoExtMasks)("types"))
                                });
                            Upload.onFileApiSend(c, f), Upload.onFileApiSend(s, p)
                        } else showFastBox(getLang("global_error"), getLang("global_error"));
                        Object(r.destroyModule)(d);
                        var m = t.cloneNode();
                        t.parentNode.replaceChild(m, t), e(t = m, "change", o)
                    }
                })
            }
        });
        return {
            paste: function(e) {
                Upload.onFileApiSend(c, e)
            },
            unmount: function() {
                Object(r.destroyModule)(d), Upload.deinit(c), Upload.deinit(s), Upload.deinit(a)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return m
    });
    var r = n(194),
        i = n(171),
        o = n(102),
        a = n(54),
        s = n(128),
        c = n(148),
        u = "_im_dialogs_cog_settings",
        l = "_im_settings_action",
        d = "_im_to_unread";

    function f() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "im_settings";
        return getTemplate(e, {
            sound: ls.get("sound_notify_off") ? getLang("mail_im_sound_off") : getLang("mail_im_sound_on"),
            browser: p() ? getLang("mail_im_notifications_on") : getLang("mail_im_notifications_off")
        })
    }

    function p() {
        return DesktopNotifications.supported() && !DesktopNotifications.checkPermission() && !ls.get("im_ui_notify_off")
    }

    function m(e, t, n) {
        var m = function(e, t) {
                showTooltip(t.target, {
                    content: f("im_settings_pop"),
                    dir: "down",
                    shift: [220, 9],
                    hasover: !0,
                    showdt: 300
                })
            }.bind(null, t),
            g = function(e, t, n, r, o) {
                var s = domData(o, "action"),
                    c = gpeByClass("_im_settings_menu", o),
                    u = hasClass(c, "_im_settings_popup") ? "im_settings_pop" : "im_settings";
                switch (s) {
                    case "spam":
                        Object(a.showSpamLayer)(e, i.mount, r);
                        break;
                    case "sound":
                        ls.get("sound_notify_off") ? ls.set("sound_notify_off", 0) : ls.set("sound_notify_off", 1), c.outerHTML = f(u);
                        break;
                    case "browser":
                        p() ? (ls.set("im_ui_notify_off", 1), c.outerHTML = f(u)) : DesktopNotifications.checkPermission() ? DesktopNotifications.requestPermission(function() {
                            c.parentNode && (c.outerHTML = f(u))
                        }) : (ls.set("im_ui_notify_off", 0), c.outerHTML = f(u))
                }
            }.bind(null, t, n, e),
            h = function(e, r) {
                if (Object(a.showUnreadOnly)(t, n, o.changeDialogsTab)) {
                    var i = t.get().active_tab === s.FOLDER_UNREAD;
                    val(r, getTemplate("im_filter", {
                        filter: i ? getLang("mail_to_all_dialogs") : getLang("mail_to_unread")
                    }))
                }
            },
            _ = Object(r.createModule)({
                handlers: function(t, n) {
                    n(e, "mouseover", u, m), n(e, "click", l, g), n(e, "click", d, h)
                }
            });
        return function(e, t) {
            return {
                updateFilter: function(t) {
                    var n = t.get().active_tab === s.FOLDER_UNREAD,
                        r = void 0,
                        i = [];
                    Object(c.isSearching)(t) && i.push("im-page--dialogs-filter_hidden"), t.get().unread_cnt > 0 ? r = n ? getLang("mail_to_all_dialogs") : getLang("mail_to_unread") : (r = getLang("mail_all_dialogs"), i.push("im-page--dialogs-filter_disabled")), val(geByClass1(d, e), getTemplate("im_filter", {
                        filter: r,
                        cls: i.join(" ")
                    }))
                },
                toggleButton: function(t, n) {
                    var r = geByClass1("im-page--dialogs-filter", e);
                    toggleClass(r, "im-page--dialogs-filter_hidden", n)
                },
                toggleLoader: function(t, n) {
                    var r = geByClass1(u, e);
                    toggleClass(r, "im-page--dialogs-settings_loading", n)
                },
                updateSettings: function(t) {
                    geByClass1("_im_settings_menu", e).outerHTML = f()
                },
                unmount: function() {
                    Object(r.destroyModule)(t)
                }
            }
        }(e, _)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return o
    });
    var r = n(188),
        i = (n(195), n(151));

    function o(e) {
        var t = {
            "List--border": !!e.border
        };
        return r.createElement("ul", {
            className: Object(i.classNames)("List", t, e.className),
            style: e.style
        }, e.children)
    }
    o.defaultProps = {
        border: !0
    }
}, function(e, t) {
    e.exports = !1
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "addDelegateEvent", function() {
        return a
    }), n.d(t, "removeDelegateEvent", function() {
        return s
    });
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        i = new window.Map;

    function o(e) {
        var t = i.get(e.currentTarget);
        if (t) {
            var n = t[e.type];
            if (n)
                for (var o = void 0, a = 0; a < n.length; a++) {
                    var s = r(n[a], 2),
                        c = s[0],
                        u = s[1],
                        l = void 0;
                    if (hasClass(e.target, c) ? l = u(e, e.target) : (o = gpeByClass(c, e.target, e.currentTarget)) && (l = u(e, o)), !1 === l) break
                }
        }
    }

    function a(e, t, n, r) {
        var a = i.get(e);
        a || (i.set(e, {}), a = i.get(e));
        for (var s = t.split(" "), c = 0; c < s.length; c++) {
            var u = s[c];
            a[u] || (a[u] = [], addEvent(e, u, o)), a[u].push([n, r])
        }
    }

    function s(e, t, n, r) {
        var a = i.get(e);
        a && (t.split(" ").forEach(function(t) {
            a[t] && (a[t] = a[t].filter(function(e) {
                return e[0] !== n || e[1] !== r
            }), 0 === a[t].length && removeEvent(e, t, o))
        }), 0 === Object.keys(a).map(function(e) {
            return a[e].length
        }).reduce(function(e, t) {
            return e + t
        }) && i.delete(e))
    }
}, function(e, t, n) {
    var r = n(4);
    e.exports = function(e, t, n, i) {
        try {
            return i ? t(r(n)[0], n[1]) : t(n)
        } catch (t) {
            var o = e.return;
            throw void 0 !== o && r(o.call(e)), t
        }
    }
}, function(e, t, n) {
    "use strict";

    function r(e, t) {
        var n = !1,
            r = void 0,
            i = void 0;
        return function o() {
            if (n) return r = arguments, void(i = this);
            e.apply(this, arguments), n = !0, setTimeout(function() {
                n = !1, r && (o.apply(i, r), r = i = null)
            }, t)
        }
    }
    n.r(t), n.d(t, "default", function() {
        return r
    })
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "connect", function() {
        return u
    });
    var r = n(188),
        i = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function o(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var a = r.createContext(),
        s = a.Provider,
        c = a.Consumer;

    function u(e) {
        return function(t) {
            function n() {
                var e, r;
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, n);
                for (var i = arguments.length, a = Array(i), s = 0; s < i; s++) a[s] = arguments[s];
                return e = r = o(this, t.call.apply(t, [this].concat(a))), r.onUpdate = function() {
                    r.setState({})
                }, o(r, e)
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(n, t), n.prototype.componentDidMount = function() {
                this.store.subscribe(this.onUpdate)
            }, n.prototype.componentWillUnmount = function() {
                this.store.unsubscribe(this.onUpdate)
            }, n.prototype.render = function() {
                var t = this;
                return r.createElement(c, null, function(n) {
                    return t.store || (t.store = n), r.createElement(e, i({}, t.props, {
                        store: n
                    }))
                })
            }, n
        }(r.Component)
    }
    t.default = s
}, function(e, t) {
    var n = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")();
    "number" == typeof __g && (__g = n)
}, , function(e, t) {
    e.exports = function(e, t, n, r) {
        if (!(e instanceof t) || void 0 !== r && r in e) throw TypeError(n + ": incorrect invocation!");
        return e
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "screenfull", function() {
        return r
    });
    var r = function() {
        var e = "undefined" != typeof Element && "ALLOW_KEYBOARD_INPUT" in Element,
            t = function() {
                for (var e = void 0, t = void 0, n = [
                        ["requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror"],
                        ["webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror"],
                        ["webkitRequestFullScreen", "webkitCancelFullScreen", "webkitCurrentFullScreenElement", "webkitCancelFullScreen", "webkitfullscreenchange", "webkitfullscreenerror"],
                        ["mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror"],
                        ["msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError"]
                    ], r = 0, i = n.length, o = {}; r < i; r++)
                    if ((e = n[r]) && e[1] in document) {
                        for (r = 0, t = e.length; r < t; r++) o[n[0][r]] = e[r];
                        return o
                    }
                return !1
            }(),
            n = {
                request: function(n) {
                    var r = t.requestFullscreen;
                    n = n || document.documentElement, /5\.1[\.\d]* Safari/.test(navigator.userAgent) ? n[r]() : n[r](e && Element.ALLOW_KEYBOARD_INPUT)
                },
                exit: function() {
                    document[t.exitFullscreen]()
                },
                toggle: function(e) {
                    this.isFullscreen ? this.exit() : this.request(e)
                },
                raw: t
            };
        return !!t && (Object.defineProperties(n, {
            isFullscreen: {
                get: function() {
                    return Boolean(document[t.fullscreenElement])
                }
            },
            element: {
                enumerable: !0,
                get: function() {
                    return document[t.fullscreenElement]
                }
            },
            enabled: {
                enumerable: !0,
                get: function() {
                    return Boolean(document[t.fullscreenEnabled])
                }
            }
        }), n)
    }()
}, function(e, t, n) {
    var r = n(163);
    e.exports = Object("z").propertyIsEnumerable(0) ? Object : function(e) {
        return "String" == r(e) ? e.split("") : Object(e)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151));
    var o = function(e) {
        function t() {
            return function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t),
                function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.photos,
                n = e.links,
                o = e.className,
                a = Object(i.classNames)("MembersGrid", "MembersGrid--" + Math.min(t.length, 4), o);
            return r.createElement("div", {
                className: a
            }, t.map(function(e, t) {
                var i = n && n[t] ? n[t] : void 0,
                    o = i ? "a" : "span";
                return r.createElement(o, {
                    key: t,
                    href: i,
                    className: "MembersGrid__i",
                    style: {
                        backgroundImage: "url(" + e + ")"
                    }
                })
            }))
        }, t
    }(r.Component);
    t.default = o, o.defaultProps = {
        links: [],
        className: ""
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return le
    });
    var r = n(18),
        i = n(80),
        o = n(166),
        a = n(102),
        s = n(54),
        c = n(48),
        u = n(148),
        l = n(187),
        d = n(181),
        f = n(183),
        p = n(7),
        m = n(194),
        g = n(109),
        h = n(83),
        _ = n(72),
        v = n(118),
        b = n(11);
    var y = 4,
        w = 5,
        O = 6,
        C = 7,
        k = 9,
        E = 11,
        j = 12,
        S = 13,
        T = 14,
        I = 16,
        P = 19,
        M = 20,
        x = 23,
        L = 2e3,
        A = "_im_media_selector",
        N = "_im_media_fwd",
        D = "_im_fwd_close",
        R = "_im_peer_mute_unmute",
        F = "_im_peer_return_to_chat",
        B = "_im_submit_btn",
        H = "_im_media_preview";

    function U(e, t) {
        if (!e) return !1;
        window.tooltips && tooltips.hide(e, t)
    }

    function z(e, t, n, i, o, a) {
        var c = !(arguments.length > 6 && void 0 !== arguments[6]) || arguments[6];
        if (ae(t, i)) return Promise.resolve(!1);
        var u = q(i);
        u.getBoundAttach(n.message) && (n.message = ""), n.share_url = u.getShareUrl(), n.cancelled_shares = u.getCancelledShares();
        var l, d = Object(f.random)(),
            p = {
                peerId: t,
                messageId: "rid" + d,
                flags: r.FLAG_OUTBOUND,
                date: intval(Date.now() / 1e3) - i.get().timeshift,
                subject: "",
                text: Object(s.replaceSpecialSymbols)(clean(n.message)).replace(/\n/gi, "<br>"),
                local: !0,
                kludges: {
                    emoji: !0,
                    from_admin: i.get().gid ? vk.id : null
                },
                type: r.ADD_MESSAGE,
                attaches: (l = n.attaches, l.map(function(e) {
                    return {
                        id: e[1],
                        type: e[0],
                        kind: e[2] || null
                    }
                }))
            };
        return n.rid = d, n.mess = p, e(t, n), i.get().longpoll.push([p]), c && a().clearText(t, i), o().newMessage(i), Promise.resolve(!0)
    }

    function G(e, t, n, r, i, o, a) {
        var s = arguments.length > 7 && void 0 !== arguments[7] && arguments[7];
        s || (s = e.get().peer);
        var c = {
            message: "",
            attaches: o
        };
        a && extend(c, a), W(e, t, !1).then(function(i) {
            return z(n, s, c, e, t, r, !1)
        }).catch(function(t) {
            debugLog(t), K(e, i)
        })
    }

    function W(e, t, n) {
        return e.get().tabs[e.get().peer].skipped > 0 ? (t().loadingPeer(e), e.setState({
            no_moving_down: !0
        }), e.set(a.changePeer.bind(null, e.get().peer, !1, !1)).then(function() {
            return e.set(a.loadPeer.bind(null, e.get().peer, !0, -1, !1))
        }).then(function() {
            return t().changePeer(e, !1), e.setState({
                no_moving_down: !1
            }), n
        })) : Promise.resolve(n)
    }

    function V(e, t, n, r) {
        return !e.get().delayed_ts && setTimeout(function() {
            e.set(a.setDelayedMessage.bind(null, !1, !1)).then(function() {
                n.apply(void 0, function(e) {
                    if (Array.isArray(e)) {
                        for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                        return n
                    }
                    return Array.from(e)
                }(r))
            })
        }, t)
    }

    function K(e, t) {
        document.activeElement && document.activeElement.blur(), showFastBox({
            title: getLang("global_error")
        }, getLang("mail_send_error"), getLang("mail_ok"), function() {
            nav.reload({
                force: !0
            })
        });
        var n = geByClass1("_im_send", t);
        return e.set(a.toggleSendingAbility.bind(null, !0)).then(function() {
            Object(s.lockButton)(n)
        })
    }

    function q(e) {
        return e.get().tfdraft || new v.ImDraft
    }

    function Q(e, t, n, r, i, o) {
        var l = arguments,
            d = e.get(),
            f = Object(u.getPeer)(e),
            m = Object(u.getCurrentKeyboard)(e) || {},
            h = m.one_time,
            _ = void 0 !== h && h,
            v = m.author_id,
            b = geByClass1("_im_send", r);
        return Promise.resolve().then(function() {
            if (Object(u.isSendingAvailable)(e)) {
                if (Object(a.isAnythingLoading)(e.get()) || !Object(s.isFullyLoadedTab)(e, e.get().peer)) {
                    var r = V(e, L, Q, Object(p.toArray)(l));
                    return e.set(a.setDelayedMessage.bind(null, !0, r)).then(function() {
                        Object(s.lockButton)(b)
                    })
                }
                return clearTimeout(e.get().delayed_ts), e.set(a.setDelayedMessage.bind(null, !1, !1)).then(function() {
                    return Object(s.unlockButton)(b)
                }).then(W.bind(null, e, t)).then(function() {
                    var r = Object(g.decodeHTMLEntities)(o.action.label);
                    Object(s.isChatPeer)(f) && (r = "@" + d.owners.find(function(e) {
                        return e.id === v
                    }).link.slice(1) + " " + r);
                    return Object(c.statlogsValueEvent)("message_send_from_keyboard", 0, e.get().id, f, v), z(n, f, {
                        message: r,
                        attaches: [],
                        payload: Object(g.decodeHTMLEntities)(o.action.payload)
                    }, e, t, i, !1)
                }).then(function() {
                    return _ ? e.set(a.deleteKeyboard.bind(null, f)) : Promise.resolve()
                }).then(function() {
                    return i().fixKeyboard()
                })
            }
        }).catch(function(t) {
            debugLog(t), K(e, r)
        })
    }

    function $(e, t, n, i, o, c) {
        var l = arguments,
            d = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : [];
        return Promise.resolve().then(function() {
            var f = geByClass1("_im_send", i);
            if (!Object(u.isSendingAvailable)(e)) return !1;
            if (Object(a.isAnythingLoading)(e.get()) || !Object(s.isFullyLoadedTab)(e, e.get().peer)) {
                var m = V(e, L, $, Object(p.toArray)(l));
                return e.set(a.setDelayedMessage.bind(null, !0, m)).then(function() {
                    Object(s.lockButton)(f)
                })
            }
            clearTimeout(e.get().delayed_ts), o().saveText(e);
            var g = !1,
                h = q(e),
                v = h.dData.attaches.map(function(e) {
                    if ("poll" == e.type) {
                        var t = c.pollData();
                        return t || (g = !0), [e.type, e.id, t]
                    }
                    return [e.type, e.id]
                }).concat(d);
            if (g) return !1;
            var b = e.set(a.setDelayedMessage.bind(null, !1, !1)).then(function() {
                    Object(s.unlockButton)(f)
                }),
                y = Object(u.getPeer)(e);
            return b.then(W.bind(null, e, t)).then(function() {
                var c = h.dData.txt,
                    u = t().getEditingMessage();
                if (u || c || v.length) {
                    if (u) return c || v.length ? Object(s.isMessageTooLong)(c) ? void showFastBox(getLang("global_error"), getLang("mail_err_edit_too_long")) : (t().cancelEditing(), void(Object(_.wasMessageReallyModified)(e, u, h) && (Object(_.replaceMsgAfterEdit)(e, u, c, v, h.getShareUrl(), h.getCancelledShares()), t().sendEditMessage(e, u), e.get().longpoll.push([Object(r.editMessageLocallyEvent)(u)])))) : void
                    function(e, t, n, r) {
                        var i = e.get(),
                            o = i.peer,
                            s = showFastBox({
                                title: getLang("mail_dialog_msg_delete_title"),
                                dark: 1
                            }, getLang("mail_dialog_msg_delete_for_all"), getLang("mail_delete"), function(e) {
                                Object(a.removeMessageSend)([r], o, null, "deleteforall", i), s.hide(), t().cancelEditing()
                            }, getLang("global_cancel"), function() {
                                s.hide(), X(geByClass1("_im_text", n))
                            })
                    }(e, t, i, u.messageId);
                    var l = Object(s.splitMessageToParts)(c, v).map(function(r) {
                        return z(n, y, {
                            message: r.msgText || "",
                            attaches: r.attaches || []
                        }, e, t, o)
                    });
                    return Promise.all(l)
                }
            })
        }).catch(function(t) {
            debugLog(t), K(e, i)
        })
    }

    function Y(e, t, n, r, i, o, c) {
        var l = void 0,
            d = debounce(function(e, t, n) {
                var r = e.get().peer,
                    i = Emoji.val(n);
                Object(s.isReservedPeer)(r) || q(e).dData.txt == i || ae(r, e) || (t.checkMessageURLs(i, !0, L), q(e).setText(i))
            }.bind(null, e, n), 500);
        var f = Emoji.init(geByClass1("_im_text", t), {
            ttDiff: 93,
            rPointer: !0,
            ref: "im",
            onSend: function() {
                return r([])
            },
            controlsCont: t,
            forceTxt: !e.get().editable,
            checkEditable: function(n, r) {
                var i = e.get().peer,
                    o = Emoji.val(r);
                Object(s.isReservedPeer)(i) || ae(i, e) || q(e).dData.txt == o || !o || function(e) {
                    var t = e.get().peer;
                    Object(s.isFullyLoadedTab)(e, t) && !Object(u.isAnyMessageBeingEdited)(e) && Date.now() - (Object(u.getTab)(e, t).lastTyping || 0) > 1e3 * a.TYPING_PERIOD && e.set(a.sendTyping.bind(null, t))
                }(e), ue(e, t, o), d(r);
                var f = t.offsetHeight;
                if (l && l !== f) {
                    var p = c().updateScroll();
                    c().scrollFix(e, e.get().peer, p)
                }
                l = f
            },
            onStickerSend: function(e, t, n) {
                return i([
                    ["sticker", e, n]
                ], {
                    sticker_referrer: t
                })
            },
            uploadActions: o
        });
        return Emoji.emojiLoadMore(f), e.setState({
            emojiOptId: f
        }), f
    }

    function X(e) {
        Emoji.focus(e, !0), setTimeout(Emoji.correctCaret.pbind(e), 10)
    }

    function Z(e, t, n, r) {
        var i = e.getFwdRaw(),
            o = geByClass1(N, t);
        if (!(Object(u.getCurrentKeyboard)(r) || {}).hide && i && n.toggleKeyboard(!0), i)
            if (i.object && i.object.authorName) {
                var a = i.object,
                    c = Object(s.renderShortText)(0, "", a.text, !0, Object(v.convertKludgesToAttaches)(a.kludges, 0));
                o.innerHTML = getTemplate("im_attach_mess", {
                    messages: c,
                    text: a.authorName,
                    date: getSmDate(a.date, r.get().timeshift),
                    modifier: "im-fwd_msg"
                })
            } else o.innerHTML = getTemplate("im_attach_mess", {
                messages: getLang("mail_title_X_msgs", e.getFwdCount()),
                text: getLang("mail_im_fwd_msgs_title"),
                date: "",
                modifier: ""
            });
        else o.innerHTML = ""
    }

    function J(e, t, n) {
        e.set(a.forwardMessages.bind(null, null, q(e))).then(function() {
            var r = geByClass1(N, t);
            if (r && r.children.length) {
                r.innerHTML = "";
                var i = n().updateScroll();
                n().scrollFix(e, e.get().peer, i)
            }
            ue(e, t)
        })
    }
    var ee = "close",
        te = "open",
        ne = "hide";

    function re(e, t, n, r, i, o, a) {
        if (a !== ee && a !== te && a !== ne) throw new Error('Action "' + a + '" not found');
        var c = e.get(),
            l = Object(u.getCurrentKeyboard)(e);
        (Object(s.isCommunityInterface)(e) || !l || c.isEditing) && (a = ne);
        var d = a === ee || a === ne,
            f = Promise.resolve();
        return d || n.isMounted || (f = n.init()), f.then(function() {
            return toggleClass(t, "im-chat-input_open-keyboard", !d), toggleClass(t, "im-chat-input_close-keyboard", d && a !== ne), toggleClass(r, "im_chat-input--keyboard-button_hidden", a === ne), n.toggle(c.peer, d, o)
        }).then(function() {
            var t = i().updateScroll();
            return i().scrollFix(e, c.peer, t)
        })
    }

    function ie(e, t, n, r, i, o, a, c, d, f, p, g) {
        return {
            restoreKeyboard: function() {
                this.toggleKeyboard(!!(ls.get("is_keyboards_hide") || {})[Object(u.getPeer)(e)])
            },
            toggleKeyboard: function() {
                var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : !Object(u.getCurrentKeyboard)(e).hide,
                    n = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                return re(e, r, g, p, o, n, t ? ee : te)
            },
            initKeyboard: function() {
                if (!e.get().peer || !Object(u.getCurrentKeyboard)(e)) return Promise.resolve();
                var t = !!(ls.get("is_keyboards_hide") || {})[Object(u.getPeer)(e)];
                return re(e, r, g, p, o, !0, t ? ee : te)
            },
            fixKeyboard: function() {
                var t = Object(u.getCurrentKeyboard)(e),
                    n = void 0;
                return n = t ? t.hide ? ee : te : ne, re(e, r, g, p, o, !0, n)
            },
            hideKeyboard: function() {
                return re(e, r, g, p, o, !1, ne)
            },
            restoreDraft: function(e, i) {
                var a = this;
                t.chosenMedias.length > 0 && (e.setState({
                    removingMedias: !0
                }), t.unchooseMedia(), t.chosenMedias = [], e.setState({
                    removingMedias: !1
                }));
                var c = e.get().peer,
                    l = Object(s.isUserPeer)(c) && c != vk.id && !e.get().gid,
                    d = Object(s.isUserPeer)(c) && c != vk.id && !e.get().gid && !inArray(c, e.get().moneyTransferExcept) || Object(s.isCommunityPeer)(c) && e.get().moneyTransferCommAvail && Object(u.getCurrentTab)(e).moneyTransferAvail && !e.get().gid || e.get().gid && e.get().moneyRequestAvail || Object(s.isChatPeer)(c) && Object(u.getCurrentTab)(e).moneyRequestAvail;
                if (toggle(geByClass1("ms_item_gift", r), l && !Object(u.isAnyMessageBeingEdited)(e)), toggle(geByClass1("ms_item_money", r), d && !Object(u.isAnyMessageBeingEdited)(e)), toggle(geByClass1("ms_item_poll", r), Object(s.isChatPeer)(c) && !Object(u.isAnyMessageBeingEdited)(e)), Object(s.isReservedPeer)(c)) return Promise.resolve();
                var f = q(e);
                return Emoji.val(n) !== f.dData.txt ? function(e, t) {
                    Emoji.val(e, clean(t)), X(e)
                }(n, f.dData.txt) : X(n), f.prepareObjects(e.get().gid, i && i.messageId).then(function() {
                    if (!se(e, c, n) && c == e.get().peer) {
                        for (var i = f.dData.attaches, s = 0; s < i.length; s++) t.chooseMedia(i[s].type, i[s].id, i[s].object || {});
                        Z(f, r, a, e);
                        var u = o().updateScroll();
                        o().scrollFix(e, c, u), ue(e, r, f.dData.txt)
                    }
                })
            },
            sendMessage: function() {
                i([])
            },
            choose: function(e, n, r) {
                t.chooseMedia(e, n, r)
            },
            updateChosenMedia: function(e, n, r) {
                t.updateChosenMedia(e, n, r)
            },
            canAddMedia: function() {
                return !t.hasRestrictingAttach() && !ae(e.get().peer, e)
            },
            isEmpty: function(e) {
                return !trim(Emoji.val(n)) && !q(e).hasAttaches()
            },
            unchoose: function(e) {
                t.unchooseMedia(e)
            },
            attachCount: function() {
                return t.attachCount()
            },
            progress: function(e, n, r) {
                show(H), t.showMediaProgress(e, n, r)
            },
            updateState: function(e) {
                this.restoreKeyboard(), se(e, e.get().peer, n)
            },
            focusOn: function(e) {
                Emoji.editableFocus(n, !1, !0)
            },
            setDraft: function(e, t) {
                var n = Object(u.getTab)(e, e.get().peer);
                Object(l.doesChatTabHaveFlag)(n, 1024) && !e.get().gid || (e.setState({
                    tfdraft: t
                }), t && this.restoreDraft(e, o().getEditingMessage()))
            },
            clearText: function(e, i) {
                q(i).clear(), t.cancelCheckUrl(), t.unchooseMedia(), t.chosenMedias = [], Emoji.val(n, ""), J(i, r, o);
                var a = o().updateScroll();
                o().scrollFix(i, i.get().peer, a)
            },
            attachMessages: function(e, t) {
                if (e.get().peer === t) {
                    Z(q(e), r, this, e);
                    var n = o().updateScroll();
                    o().scrollFix(e, t, n), ue(e, r)
                }
            },
            cancelRecording: function() {
                f.cancelRecording()
            },
            reHeight: function(e) {
                var t = o().updateScroll();
                o().scrollFix(e, e.get().peer, t)
            },
            isBlocked: function() {
                return ae(e.get().peer, e)
            },
            toggleStickers: function(e, t) {
                Emoji.toggleStickers(e.get().emojiOptId, !t)
            },
            saveText: function(e) {
                q(e).setText(Emoji.val(geByClass1("_im_text", r)))
            },
            unmount: function() {
                Object(m.destroyModule)(d), t.destroy(), c.unmount(), g.unmount(), Emoji.destroy(e.get().emojiOptId), f.unmount()
            }
        }
    }

    function oe(e, t) {
        return !!Object(s.isChatPeer)(e) && t.get().tabs[e].data.kicked
    }

    function ae(e, t) {
        return oe(e, t) || Object(u.getTab)(t, e) && Object(u.getTab)(t, e).block_error > 0 || Object(s.isLocksAvailable)(t) && Object(s.isPeerBlocked)(e, t)
    }

    function se(e, t, n) {
        var r = gpeByClass("_im_chat_input_parent", n),
            i = geByClass1("_im_chat_input_error", r);
        if (ae(t, e)) {
            n.disabled = !0;
            var o = Object(u.getTab)(e, t),
                a = function(e, t, n) {
                    switch (n.block_error) {
                        case C:
                        case w:
                            return getLang("mail_peer_deleted");
                        case T:
                            return getLang("mail_community_deleted");
                        case E:
                            return getLang("mail_group_banned_messages");
                        case y:
                        case O:
                        case k:
                        case P:
                        case M:
                        case S:
                            return Object(s.isCommunityPeer)(t) ? getLang("mail_send_privacy_community_error") : getLang("mail_send_privacy_error");
                        case x:
                            var r = Object(b.oCacheGet)(e, t);
                            return langSex(r.sex, getLang("mail_blacklist_user", "raw")).replace("{user}", r.kick_name);
                        case j:
                            return getLang("mail_cant_send_messages_to_community");
                        case I:
                            return getLang("mail_chat_youre_kicked");
                        case 0:
                            if (oe(t, e)) return getLang("mail_chat_youre_kicked");
                            var i = e.get().block_states[t].name;
                            return getLang("mail_community_answering").replace("{username}", i);
                        default:
                            return getLang("mail_send_privacy_error")
                    }
                }(e, t, o);
            if (addClass(n, "im-chat-input--text_disabled"), addClass(r, "im-chat-input_error"), addClass(geByClass1("_im_page_history"), "is_tf_blocked"), n.contentEditable = "false", Object(s.isFvkcomgroup)(e, t) && !e.get().gid) {
                addClass(r, "is-f-vkcomgroup");
                var c = inArray(t, e.get().mutedPeers);
                a = o.data.closed || o.data.kicked ? getTemplate("sImPeerReturnToChat", {
                    text: getLang("mail_return_to_vkcomgroup")
                }) : getTemplate("sImPeerMuteUnmute", {
                    text: c ? getLang("mail_im_unmute") : getLang("mail_im_mute"),
                    cls: c ? "im-action_unmute" : "im-action_mute"
                })
            } else removeClass(r, "is-f-vkcomgroup");
            return val(i, a), !0
        }
        return n.disabled && (n.disabled = !1, removeClass(r, "im-chat-input_error"), removeClass(r, "is-f-vkcomgroup"), n.contentEditable = "true", removeClass(n, "im-chat-input--text_disabled"), removeClass(geByClass1("_im_page_history"), "is_tf_blocked"), val(i, "")), !1
    }

    function ce(e, t, n) {
        return Object(s.isVoiceMessageAvailable)(e).then(function(r) {
            if (!r && !Object(u.isAnyMessageBeingEdited)(e)) return !0;
            var i = null != n ? n : Emoji.val(geByClass1("_im_text", t));
            return trim(i) ? !Object(u.isAnyMessageBeingEdited)(e) || !Object(s.isMessageTooLong)(i) : q(e).hasAttaches()
        })
    }

    function ue(e, t, n) {
        var r = geByClass1("_im_send", t.parentNode);
        U(r, {
            fasthide: !0
        }), ce(e, t, n).then(function(t) {
            if (Object(u.isAnyMessageBeingEdited)(e)) toggleClass(r, "is_input_empty", !t), attr(r, "aria-label", getLang("mail_im_edit"));
            else {
                toggleClass(r, "im-send-btn_audio", !t), toggleClass(r, "im-send-btn_send", t), t && removeClass(r, "im-send-btn_saudio");
                var n = t ? getLang("mail_send2") : getLang("mail_added_audiomsg");
                attr(r, "aria-label", n)
            }
        })
    }

    function le(e, t, n) {
        cur.share_timehash = t.get().share_timehash;
        var c = Object(m.createMutations)(ie),
            l = c.callMutations,
            f = c.bindMutations,
            g = Object(h.mount)(e, t, l),
            v = function(e, t, n) {
                return e.set(a.deliverMessage.bind(null, t, n, {}))
            }.bind(null, t);
        ls.remove("im_send_queue_2" + vk.id), ls.remove("im_send_queue_1" + vk.id);
        var b = Object(d.initQueue)(v, function(e, t, n, i) {
                e.get().longpoll.push([r.failedMessage(t, n.mess, i)])
            }.bind(null, t), {
                store: "ls",
                key: "im_send_queue_" + vk.id,
                waitCommit: !0
            }),
            y = b.pushMessage,
            w = b.inspectQueue,
            O = b.resend,
            C = b.setErrored,
            k = b.complete,
            E = G.bind(null, t, n, y, l, e),
            j = function(e) {
                var t = q(e).getFwdRaw();
                t && window.showForwardBox({
                    act: "a_show_forward_box",
                    will_fwd: t.id,
                    gid: e.get().gid
                })
            }.bind(null, t);
        hide(geByClass1("ms_items_more_helper", e));
        var S = t.get().mediaTypes || [
            ["photo", getLang("mail_added_photo")],
            ["video", getLang("profile_wall_video")],
            ["audio", getLang("profile_wall_audio")],
            ["doc", getLang("profile_wall_doc")],
            ["map", getLang("profile_wall_map")],
            ["gift", getLang("profile_wall_gift")]
        ];
        (t.get().moneyTransferAvail || t.get().moneyRequestAvail) && S.push(["money", getLang("profile_wall_money")]);
        var T = new MediaSelector(geByClass1(A, e), H, S, {
                maxShown: 0,
                vectorIcon: !0,
                ignoreMobile: !0,
                onAddMediaChange: function(r, i, o, s) {
                    return r && l().toggleKeyboard(!0),
                        function(e, t, n, r, i, o, s, c, u) {
                            if (!t.get().removingMedias) {
                                if ("album" === i || "page" === i || "mail" === i) return !1;
                                if ("share" === i && !s.title) return !1;
                                var l, d;
                                show(H), o && "string" == typeof i ? (c && q(t).addBindUrl(c, i, o), q(t).addAttach(i, o, s)) : (q(t).syncWithSelector(u), "number" == typeof o && u.chosenMedias[o] && (l = u.chosenMedias[o], d = q(t), "string" == typeof l[0] && "string" == typeof l[1] && l[1] && d.dData.cancelled.push(l[0] + "," + l[1])));
                                var f = e().updateScroll();
                                if (e().scrollFix(t, t.get().peer, f), t.get().delayed_message && !Object(a.isAnythingLoading)(t.get())) return n([]), !1;
                                ue(t, r)
                            }
                        }(n, t, I, e, r, i, o, s, T)
                },
                onMediaChange: function() {
                    return function(e, t, n, r, i) {
                        if (!t.get().removingMedias) {
                            var o = i.getMedias().find(function(e) {
                                return "poll" === e[0]
                            });
                            o && q(t).addAttach(o[0], o[1], i.pollData(!0, !0)), ue(t, r)
                        }
                    }(0, t, 0, e, T)
                },
                editable: 1,
                onChangedSize: function() {
                    var r, i, o = n().updateScroll();
                    n().scrollFix(t, t.get().peer, o), r = e, i = ge(H).offsetHeight, toggleClass(r, "im-chat-input--overflowed", i > 400)
                },
                sortable: 1,
                teWidth: 150,
                mail: 1,
                teHeight: 100,
                forceToUp: !0,
                toId: t.get().gid ? -t.get().gid : void 0,
                blockPersonal: t.get().gid ? 1 : 0,
                docParams: t.get().gid ? {
                    imhash: t.get().upload_doc_opts.opts.imhash,
                    from: "from_gim"
                } : {}
            }),
            I = $.bind(null, t, n, y, e, l, T),
            P = function(e, t, n) {
                var r = Emoji.val(geByClass1("_im_text", t));
                Object(u.isAnyMessageBeingEdited)(e) && "" !== r || ce(e, t).then(function(t) {
                    var i = intval(domData(n.target, "tttype"));
                    if ((2 === i && !0 !== t || 1 === i && !0 === t || 3 !== i && "" === r) && window.tooltips && tooltips.destroy(n.target, {
                            fasthide: !0
                        }), Object(u.isAnyMessageBeingEdited)(e) && "" === r) return domData(n.target, "tttype", 3), showTooltip(n.target, {
                        text: getLang("mail_delete_for_all"),
                        black: !0,
                        force: 3 !== i,
                        appendParentCls: "_im_chat_input_parent",
                        shift: [-8, -10]
                    });
                    if (!0 !== t) return domData(n.target, "tttype", 1), showTooltip(n.target, {
                        text: getLang("mail_added_audiomsg"),
                        black: !0,
                        force: 1 !== i,
                        appendParentCls: "_im_chat_input_parent",
                        shift: [-8, -10]
                    });
                    domData(n.target, "tttype", 2);
                    var o = e.get().ctrl_submit ? 1 : 0;
                    return showTooltip(n.target, {
                        text: getTemplate("ctrl_submit_hint", {
                            enter_on: o ? "" : "on",
                            ctrl_on: o ? "on" : ""
                        }),
                        dir: "down",
                        shift: [-28, -5],
                        needLeft: !0,
                        className: "im-chat-input--tt",
                        hasover: !0,
                        force: 2 !== i,
                        showdt: 700,
                        zIndex: 200,
                        hidedt: 700,
                        appendParentCls: "_im_chat_input_parent",
                        onCreate: function() {
                            radioBtns.im_submit = {
                                els: Object(p.toArray)(geByClass(B)),
                                val: o
                            }
                        }
                    })
                })
            }.bind(null, t, e),
            M = geByClass1("_im_send", e),
            x = G.bind(null, t, n, y, l, e),
            L = Object(i.mount)(e, t, x, function() {
                addClass(M, "im-send-btn_audio"), removeClass(M, "im-send-btn_static")
            }, function() {
                l().restoreKeyboard()
            });
        toggle(geByClass1("ms_item_poll", e), Object(s.isChatPeer)(Object(u.getPeer)(t)) && !Object(u.isAnyMessageBeingEdited)(t)),
            function(e, t) {
                var n = geByClass1("_im_text", e);
                Wall.initComposer(n, {
                    lang: {
                        introText: getLang("profile_mention_start_typing"),
                        noResult: getLang("profile_mention_not_found")
                    },
                    toup: !0,
                    getValue: function() {
                        return t.get().peer > 2e9 ? (window.Emoji && Emoji.editableVal || val)(n) : ""
                    },
                    onShow: function() {
                        addClass(e, "im_mention_shown");
                        var t = data(n, "composer");
                        if (t && t.wdd && t.wdd.shown) {
                            var r = 0,
                                i = !1,
                                o = function() {
                                    t.ignoredTerm = t.curTerm, t.curTerm = !1, val(t.wddInput, ""), Composer.toggleSelectList(t)
                                };
                            each(t.wdd.shown, function() {
                                this[0] && (r++, "@" + t.curTerm == this[2] && (i = !0))
                            }), !r || i && 1 == r ? o() : cancelStackPush("im_mention", o)
                        }
                    },
                    onHide: function() {
                        removeClass(e, "im_mention_shown"), cancelStackFilter("im_mention")
                    },
                    searchKeys: [1, 7],
                    wddOpts: {}
                })
            }(e, t), t.get().textMediaSelector = T, t.set(a.initTextStore.bind(null, w, O, C, k));
        var N = geByClass1("_im_text", e);
        setTimeout(function() {
            Object(u.getPeer)(t) && l().setDraft(t, Object(u.getTabDraft)(Object(u.getCurrentTab)(t))), Y(t, e, T, I, E, g, n)
        }, 0);
        var z = J.bind(null, t, e, n),
            W = function(e, t, n, r) {
                var i = e.get().peer,
                    o = inArray(i, e.get().mutedPeers);
                e.set(a.toggleMutePeer.bind(null, i, !o)).then(n().updateState.bind(null, i)), cancelEvent(r)
            }.bind(null, t, e, n),
            V = function(e, t, n, r) {
                var i = e.get().peer;
                e.set(a.returnToChat.bind(null, i)).then(function(e) {
                    return e.set(a.getPinnedMessage.bind(null, i))
                }).then(n().updateChatTopic.bind(null, i)), cancelEvent(r)
            }.bind(null, t, e, n),
            K = function(e, t, n) {
                var r = !!intval(domData(n, "val"));
                r !== cur.ctrl_submit && (cur.ctrl_submit = r, e.set(a.changeSubmitSettings.bind(null, r)))
            }.bind(null, t);
        se(t, t.get().peer, N);
        var X = e.querySelector("._im_keyboard_button"),
            Z = Object(o.mount)(null, t, e, Q.bind(null, t, n, y, e, l), l),
            ee = Object(m.createModule)({
                handlers: function(i, o) {
                    i(M, "click", function() {
                        Promise.resolve().then(function() {
                            return ce(t, e)
                        }).then(function(e) {
                            e || Object(u.isAnyMessageBeingEdited)(t) ? I([]) : (U(M, {
                                fasthide: !0
                            }), L.start(), setTimeout(function() {
                                return removeClass(M, "im-send-btn_saudio")
                            }, 300))
                        })
                    }), i(M, "mouseover", P), i(N, "focus", function() {
                        t.get().longpoll.push([r.transitionEvent("message")]), cur.focused = t.get().peer
                    }), i(N, "blur", function() {
                        var e = 0 === t.get().peer ? "search" : "default";
                        t.get().longpoll.push([r.transitionEvent(e)]), cur.focused = !1
                    }), i(X, "click", function() {
                        return l().toggleKeyboard(void 0)
                    }), i(X, "mouseover", function() {
                        showTooltip(X, {
                            text: function() {
                                var e = Object(u.getCurrentKeyboard)(t);
                                return !e || e.hide ? getLang("mail_show_keyboard") : getLang("mail_hide_keyboard")
                            },
                            black: !0,
                            shift: [4, 5]
                        })
                    }), o(e.parentNode, "click", R, W), o(e.parentNode, "click", F, V), o(e, "click", D, z), o(e, "click", "_im_will_fwd", j), o(e, "keydown", "_im_text", function(e) {
                        return function(e, t, n, r) {
                            if (38 === r.which && n().isEmpty(e) && !t().getEditingMessage() && !Emoji.shown && !hasAccessibilityMode() && !Object(a.isAnythingLoading)(e.get())) {
                                var i = Object(_.findLastMessageToEdit)(e, Object(u.getCurrentTab)(e));
                                i && t().startEditing(Object(u.getMessage)(e, e.get().peer, i))
                            }
                        }(t, n, l, e)
                    }), o(bodyNode, "click", B, K)
                }
            }),
            te = f(t, T, N, e, I, n, w, g, ee, L, X, Z);
        return te.initKeyboard(), te
    }
}, function(e, t) {
    e.exports = function(e, t) {
        return {
            enumerable: !(1 & e),
            configurable: !(2 & e),
            writable: !(4 & e),
            value: t
        }
    }
}, function(e, t) {
    e.exports = {
        im_img_prebody: '<div class="im-prebody"> <img alt="" src="%photo%" /> </div>',
        im_admin_link: ' (<a href="%href%" class="_im_admin_name" target="_blank">%name%</a>)',
        im_right_menu_tpl: '<a id="ui_rmenu_peer_%peer%" href="%href%" class="_im_peer_tab ui_rmenu_item %cls%"%attrs%>\n  <span>%label%</span>\n</a>',
        im_right_menu_sep: '<div class="ui_rmenu_sep"></div>',
        im_right_menu_ct: '<span class="ui_rmenu_count im-right-menu--count _im_r_ct">%count%</span> <button type="button" class="im-right-menu--close _im_r_cl"></button><span class="im-right-menu--text _im_r_tx">%name%</span>',
        im_dialogs_link_img: '<a href="%href%" class="_im_peer_target _online_reader" target="_blank"><div class="im_grid">%photo%</div></a>',
        im_dialogs_link: '<a href="%href%" class="_im_peer_target _online_reader" target="_blank">%photo%</a>',
        im_peer_photo: '<div class="nim-peer %online_class% %modifier_class%"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo"> %owner_photo% </div> </div> </div>',
        im_owner_item: '<a href="%link%" class="olist_item_wrap%cls%" id="olist_item_wrap%owner_id%" >\n  <div class="olist_item clear_fix">\n    <div class="olist_item_photo_wrap %img_cls%">\n      <img class="olist_item_photo" src="%photo%"/>\n    </div>\n    <div class="olist_item_name">%name%</div>\n    <div class="olist_checkbox"></div>\n  </div>\n</a>',
        im_simple_name: '<div class="im-page--title %more_cls%"> <span class="im-page--title-main" title="%name_attr%" %ads_union%><span class="im-page--title-main-in"><a href="%href%" target="_blank" class="im-page--title-main-inner _im_page_peer_name">%name%</a><span class="im-page--title-main-verified _im_chat_verified"></span></span></span> <span class="im-page--title-meta _im_page_peer_online">%online%</span> </div>',
        im_simple_link: '<a href="%href%" class="_im_header_link" target="_blank">%content%</a>',
        im_selected_messages: '<span class="im-page--selected-messages-count">%label%</span> <button aria-label="%tip%" type="button" class="im-page--selected-messages-remove"></button>',
        im_topic: "<div class='im-topic %cls%'>%topic%</div>",
        im_stack_date: ' <a href="%link%" class="_im_mess_link" >%date%</a>',
        im_dialogs_none: '<li data-list-id="002300" class="im-page--dialogs-empty"> %msg%</li>',
        im_filter: '<a class="im-page--dialogs-filter %cls%">%filter%</a>',
        im_drow_prebody: '<span class="nim-dialog--who">%prebody%</span> <span class="nim-dialog--inner-text">%body%</span>',
        im_attach_mess: ' <div class="im-fwd %modifier%"> <span class="im-fwd--title"> <span class="im-fwd--title-name">%text%</span> <span class="im-fwd--date">%date%</span></span> <span class="im-fwd--close _im_fwd_close"></span> <div rel="button" tab-index="0" type="button" class="im-fwd--messages _im_will_fwd">%messages%</div> </div>',
        im_preloader: '<div class="im-preloader %cls%"> %preloader%</div>',
        im_service_row: '<ul class="ui_clean_list"> <li class="im-mess im-mess_srv _im_mess _im_mess_srv _im_mess_%message_id%" data-msgid="%message_id%" data-from="%from_id%" data-ts="%date%"> <div class="im-mess--text">%text%</div> </li> </ul>',
        im_chat_members: '<button type="button" class="_im_chat_members im-page--members">%name%</button>',
        im_vkcomgroup_members: '<span class="im-page--members im-page--members--nohover">%name%</span>',
        im_mess_stack: '<div class="im-mess-stack _im_mess_stack %cls%" data-peer="%peerId%" data-admin="%admin%"> <div class="im-mess-stack--photo"> <div class="nim-peer nim-peer_small fl_l"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo"> <a target="_blank" class="im_grid" href="%href%"><img alt="%name%" src="%photo%" /></a> </div> </div> </div> </div> <div class="im-mess-stack--content"> <div class="im-mess-stack--info"> <div class="im-mess-stack--pname"> %stack_name% <span class="im-mess-stack--tools">%date%</span> </div> </div> <ul class="ui_clean_list im-mess-stack--mess _im_stack_messages"> %messages% </ul> </div> </div>',
        im_mess_stack_name: '<a href="%link%" class="im-mess-stack--lnk%class%" title="" target="_blank">%name%</a>',
        im_message_media: '<div class="_im_msg_media%messageId%" class="wall_module">%attaches%</div>%text%',
        im_dialog_media: '<span class="nim-dialog--preview nim-dialog--preview-attach">%name%</span>',
        im_typing: '<div class="im-page--typing _im_typing"> <div class="im-typing %cls%"><div class="pr im-typing--icon"><div class="pr_bt"></div><div class="pr_bt"></div><div class="pr_bt"></div></div><span class="_im_typing_name">&nbsp;</span></div> </div>',
        ctrl_submit_hint: function() {
            return '<div class="reply_submit_hint_wrap" >\n  <div class="reply_submit_hint_title">' + getLang("wall_reply_submit_settings") + '</div>\n  <div class="reply_submit_hint_opts" id="">\n    <div class="radiobtn %enter_on% _im_submit_btn" data-val="0" onclick="radiobtn(this, 0, \'im_submit\'); "><div class="radiobtn_label">' + getLang("wall_reply_submit_settings_1") + '</div></div>\n    <div class="radiobtn %ctrl_on% _im_submit_btn" data-val="1" onclick="radiobtn(this, 1, \'im_submit\'); "><div class="radiobtn_label">' + getLang("wall_reply_submit_settings_2") + "</div></div>\n  </div>\n</div>"
        },
        im_day_bar: '<h5 class="im-page--history-new-bar im-page--history-new-bar_days _im_bar_date %day_class%" data-date="%date%"><span>%day%</span></h5>',
        im_mess_bar: function() {
            return '<h4 class="im-page--history-new-bar _im_unread_bar_row"><span>' + getLang("mail_new_unread_msgs") + "</span></h4>"
        },
        im_drow: function() {
            return '<li data-list-id="%peer%" class="nim-dialog _im_dialog _im_dialog_%peer% %is_unread% %is_unread_out% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer %is_online% _im_peer_online"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo _im_dialog_photo"> %photo% </div> </div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="' + getLang("mail_im_to_multidialog") + ': %tab_name%"></span> <div class="nim-dialog--date _im_dialog_date">%date%</div> <button type="button" class="nim-dialog--close _im_dialog_close"></button> <button type="button" class="nim-dialog--markre _im_dialog_markre"></button> <div class="nim-dialog--name"> <span class="nim-dialog--name-w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--verfifed _im_dialog_verified"></span> <span class="nim-dialog--mute"></span> <button type="button" class="nim-dialog--star _im_dialog_star"></button> </div> <div class="nim-dialog--text-preview"> <span class="nim-dialog--preview _dialog_body" tabindex="0">%body%</span> <span class="nim-dialog--typing _im_dialog_typing"></span><span class="nim-dialog--typer-el"></span> </div> <label class="blind_label _im_unread_blind_label">%unread_message_string%</label> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </li>'
        },
        im_conversation_search_row: function() {
            return '<li data-list-id="%peer%" class="nim-dialog nim-conversation-search-row _im_dialog _im_dialog_%peer% %is_unread% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer nim-peer_search %is_online% _im_peer_online"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo _im_dialog_photo"> %photo% </div> </div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="' + getLang("mail_im_to_multidialog") + ': %tab_name%"></span> <button type="button" class="nim-dialog--close _im_dialog_close"></button> <div class="nim-dialog--name"> <span class="nim-dialog--name-w" aria-hidden="true"> %user_link% </span> </div> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </li>'
        },
        im_delete_actions: function() {
            return '<span class="nim-dialog--who">%text%</span> <button class="nim-dialog--daction ui_bullet _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="restore" type="button">' + getLang("mail_restore") + '</button> <button class="nim-dialog--daction ui_bullet _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="spam" type="button">' + getLang("mail_im_mark_spam") + '</button> <button class="nim-dialog--daction nim-dialog--daction_last _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="block" type="button">' + getLang("mail_user_black_list") + "</button>"
        },
        im_chat_change_topic: function() {
            return '<div class="im_change_topic_wrap clear_fix"> <div class="im_change_topic_label fl_l ta_r">' + getLang("mail_chat_topic_change_label") + '</div> <div class="im_change_topic_labeled fl_l"> <input class="text _im_chat_topic_change_input" value="%value%"/> </div> </div>'
        },
        im_msg_row: function() {
            return '<li class="im-mess %cls% _im_mess_noa _im_mess_%msg_id%" aria-hidden="%aria_hidden%" data-ts="%ts%" data-msgid="%msg_id%" data-peer="%from_id%"> <div class="im-mess--text wall_module _im_log_body">%text%</div> <span tabindex="0" role="link" aria-label="' + getLang("mail_select_message") + '" class="blind_label im-mess--blind-select _im_mess_blind_label_select"></span> <span class="blind_label im-mess--blind-read _im_mess_blind_unread_marker" %unread_params%></span> <span class="im-mess--marker _im_mess_marker" %marker_params%></span> </li>'
        },
        sImHistoryRowActions: function() {
            return '<div class="im-mess--actions"> <span role="link" aria-label="' + getLang("mail_im_reply") + '" class="im-mess--reply _im_mess_reply"></span><span role="link" aria-label="' + getLang("mail_im_edit") + '" class="im-mess--edit _im_mess_edit"></span><span role="link" aria-label="' + getLang("mail_important_message") + '" class="im-mess--fav _im_mess_fav"></span> </div> <div class="im-mess--check fl_l"></div>'
        },
        im_wrap_mobile: '<b class="mob_onl %class%" %attrs% onmouseover="mobileOnlineTip(this, {%params%})"></b>',
        im_pinned_message: '<div class="im-page-pinned _im_pinned_message"> <button class="im-page-pinned--hide _im_pin_hide"></button> <div class="im-page-pinned--meta"> <a href="%link%" target="_blank" class="im-page-pinned--name">%name%</a> <span class="im-page-pinned--date">%date%</span> </div> <div class="im-page-pinned--content">%content%</div> </div>',
        im_pinned_message_media: '<span class="im-page-pinned--media">%text%</span>',
        im_pinned_message_media_bar: '<div class="im-page-pinned--media-bar">\n  <div class="im-page-pinned--media-bar_progress" style="width: %percent%%;"></div>\n</div>',
        im_pinned_messages_promo: '<div class="im-page--mess-actions-promo-content">%content%</div>',
        im_retry_link: function() {
            return '<button class="im-page--retry _im_retry_media">' + getLang("mail_retry") + "</button>"
        },
        sImLblWasEdited: function() {
            return " <span class='im-mess--lbl-was-edited _im_edit_time' data-time='%update_time%'>" + getLang("mail_was_edited_short") + "</span>"
        },
        im_top_banner: '<div class="im-top-banner">\n  %icon%\n  <div class="im-top-banner--text"><div>%text%</div></div>\n  <div class="im-top-banner--buttons">%buttons%</div>\n</div>',
        im_top_banner_icon: '<div class="im-top-banner--icon">\n  <img src="%icon%" alt=""/>\n</div>',
        im_top_banner_button_link: '<a href="%link%" target="_blank" class="_im_top_banner_button im-top-banner--button %css_class% flat_button">%text%</a>',
        im_top_banner_button: '<button class="_im_top_banner_button im-top-banner--button %css_class% flat_button" data-payload="%callback_data%">%text%</button>',
        im_top_banner_hide_btn: '<button class="im-top-banner--button im-top-banner--button_hide _im_top_banner_hide"></button>',
        im_calls_link: '<a href="/calls" class="im_srv_lnk_light" onclick="return showWiki({ w: \'calls\'});">%text%</a>',
        sImPeerMuteUnmute: '<a href="#" class="_im_peer_mute_unmute ui_actions_menu_item im-action nohover %cls%">%text%</a>',
        sImPeerReturnToChat: '<a href="#" class="_im_peer_return_to_chat">%text%</a>'
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "updateLocation", function() {
        return a
    }), n.d(t, "updateLazyLocation", function() {
        return s
    });
    var r = window,
        i = r.nav,
        o = r.extend;

    function a(e) {
        var t = o({}, i.objLoc, e);
        Object.keys(t).filter(function(e) {
            return "" === t[e]
        }).forEach(function(e) {
            delete t[e]
        });
        var n = i.toStr(t);
        i.setLoc(n)
    }

    function s() {
        var e = {};
        return {
            scheduleNav: function(t) {
                e = o(e, t)
            },
            commitNav: function() {
                a(e), e = {}
            },
            scheduleNavWithTimeOut: function(t) {
                var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 100;
                e = o(e, t), setTimeout(function() {
                    a(e), e = {}
                }, n)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return o
    });
    var r = n(188),
        i = n(151);

    function o(e) {
        var t = {
            "SubmitArea--left": !e.alignment || "left" === e.alignment,
            "SubmitArea--center": "center" === e.alignment,
            "SubmitArea--right": "right" === e.alignment
        };
        return r.createElement("div", {
            className: Object(i.classNames)("SubmitArea", t),
            style: e.style
        }, e.children)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "TYPING_PERIOD", function() {
        return O
    }), n.d(t, "ACTION_PRIORITIES", function() {
        return T
    }), n.d(t, "loadHashes", function() {
        return I
    }), n.d(t, "strHistory", function() {
        return L
    }), n.d(t, "updateBlockStates", function() {
        return A
    }), n.d(t, "loadPeer", function() {
        return N
    }), n.d(t, "restoreHistoryQueue", function() {
        return D
    }), n.d(t, "removeFailed", function() {
        return R
    }), n.d(t, "selectPeer", function() {
        return B
    }), n.d(t, "selectPeerOnMessage", function() {
        return U
    }), n.d(t, "changePeer", function() {
        return z
    }), n.d(t, "updateMentions", function() {
        return G
    }), n.d(t, "setActions", function() {
        return W
    }), n.d(t, "loadMoreHistory", function() {
        return V
    }), n.d(t, "loadLessHistory", function() {
        return K
    }), n.d(t, "readLastMessages", function() {
        return Q
    }), n.d(t, "loadLongPollKey", function() {
        return $
    }), n.d(t, "loadLongPollTs", function() {
        return Y
    }), n.d(t, "setMessageErrored", function() {
        return X
    }), n.d(t, "resendMessage", function() {
        return Z
    }), n.d(t, "loadAdmins", function() {
        return ee
    }), n.d(t, "updateVideoThumb", function() {
        return re
    }), n.d(t, "editMessage", function() {
        return ie
    }), n.d(t, "addMessage", function() {
        return oe
    }), n.d(t, "markInboundMessagesAsRead", function() {
        return ce
    }), n.d(t, "markOutboundMessagesAsRead", function() {
        return ue
    }), n.d(t, "initTextStore", function() {
        return le
    }), n.d(t, "processFwd", function() {
        return de
    }), n.d(t, "mergeTabs", function() {
        return fe
    }), n.d(t, "updateOnline", function() {
        return pe
    }), n.d(t, "setTyping", function() {
        return me
    }), n.d(t, "waitTyping", function() {
        return ge
    }), n.d(t, "sendMessage", function() {
        return ve
    }), n.d(t, "deliverMessage", function() {
        return be
    }), n.d(t, "deliverEditedMessage", function() {
        return ye
    }), n.d(t, "addSelection", function() {
        return we
    }), n.d(t, "cleanSelected", function() {
        return Oe
    }), n.d(t, "dropSelection", function() {
        return Ce
    }), n.d(t, "replaceMessage", function() {
        return ke
    }), n.d(t, "saveMedia", function() {
        return Ee
    }), n.d(t, "loadMedia", function() {
        return je
    }), n.d(t, "addAttachmentsToStoreData", function() {
        return Se
    }), n.d(t, "replaceMediaAttachesStore", function() {
        return Te
    }), n.d(t, "setCurrentSearchDate", function() {
        return Ie
    }), n.d(t, "setInplaceSearch", function() {
        return Pe
    }), n.d(t, "setCurrentSearch", function() {
        return Me
    }), n.d(t, "searchHints", function() {
        return xe
    }), n.d(t, "searchHintsIndex", function() {
        return Le
    }), n.d(t, "localIndexToDialog", function() {
        return Ae
    }), n.d(t, "searchTopConv", function() {
        return De
    }), n.d(t, "searchImTopConv", function() {
        return Re
    }), n.d(t, "searchLocalHints", function() {
        return Fe
    }), n.d(t, "preloadSearchIndex", function() {
        return Be
    }), n.d(t, "loadDialogs", function() {
        return He
    }), n.d(t, "searchMessages", function() {
        return Ue
    }), n.d(t, "isSearchAllLoaded", function() {
        return ze
    }), n.d(t, "isSearchingInplace", function() {
        return Ge
    }), n.d(t, "cancelSearch", function() {
        return We
    }), n.d(t, "clearDate", function() {
        return Ve
    }), n.d(t, "searchInplaceStart", function() {
        return Ke
    }), n.d(t, "searchMessagesInplace", function() {
        return qe
    }), n.d(t, "loadImportant", function() {
        return Qe
    }), n.d(t, "loadActualLastMessage", function() {
        return $e
    }), n.d(t, "removeMessagesMarkDeleted", function() {
        return Ye
    }), n.d(t, "removeMessages", function() {
        return Xe
    }), n.d(t, "removeMessageSend", function() {
        return Ze
    }), n.d(t, "removeMessagesWithRestore", function() {
        return Je
    }), n.d(t, "restoreMessage", function() {
        return et
    }), n.d(t, "restoreMessageSend", function() {
        return tt
    }), n.d(t, "sendTyping", function() {
        return nt
    }), n.d(t, "forwardMessages", function() {
        return rt
    }), n.d(t, "prepareForward", function() {
        return it
    }), n.d(t, "deletedDialog", function() {
        return ot
    }), n.d(t, "flushHistory", function() {
        return at
    }), n.d(t, "updateChatTopic", function() {
        return st
    }), n.d(t, "loadChatInfo", function() {
        return ct
    }), n.d(t, "addNewMemberOptimisticly", function() {
        return ut
    }), n.d(t, "addNewMember", function() {
        return lt
    }), n.d(t, "loadChatMember", function() {
        return dt
    }), n.d(t, "checkNewPeople", function() {
        return ft
    }), n.d(t, "loadNewPeople", function() {
        return pt
    }), n.d(t, "updateChatPhoto", function() {
        return mt
    }), n.d(t, "updateActions", function() {
        return gt
    }), n.d(t, "leaveChat", function() {
        return ht
    }), n.d(t, "returnToChat", function() {
        return _t
    }), n.d(t, "toggleMutePeer", function() {
        return vt
    }), n.d(t, "setMutedPeer", function() {
        return bt
    }), n.d(t, "setExecStack", function() {
        return yt
    }), n.d(t, "favMessage", function() {
        return wt
    }), n.d(t, "updateFavMessage", function() {
        return Ot
    }), n.d(t, "updateImportant", function() {
        return Ct
    }), n.d(t, "loadSpam", function() {
        return kt
    }), n.d(t, "flushSpam", function() {
        return Et
    }), n.d(t, "setCreationType", function() {
        return jt
    }), n.d(t, "getOwnerPhoto", function() {
        return St
    }), n.d(t, "presetAvatar", function() {
        return Tt
    }), n.d(t, "setChatPhoto", function() {
        return It
    }), n.d(t, "createChat", function() {
        return Pt
    }), n.d(t, "resync", function() {
        return Mt
    }), n.d(t, "toggleSendingAbility", function() {
        return xt
    }), n.d(t, "setDelayedMessage", function() {
        return Lt
    }), n.d(t, "isAnythingLoading", function() {
        return At
    }), n.d(t, "updateUnreadCount", function() {
        return Nt
    }), n.d(t, "changeSubmitSettings", function() {
        return Dt
    }), n.d(t, "updateFavAndTitle", function() {
        return Rt
    }), n.d(t, "saveHistoryScroll", function() {
        return Ft
    }), n.d(t, "filterFromTab", function() {
        return Bt
    }), n.d(t, "changeDialogsTab", function() {
        return Ht
    }), n.d(t, "updateFolderState", function() {
        return zt
    }), n.d(t, "toggleDialogImportant", function() {
        return Gt
    }), n.d(t, "markDialogAnswered", function() {
        return Wt
    }), n.d(t, "getMutexQueue", function() {
        return Vt
    }), n.d(t, "releaseBlock", function() {
        return Kt
    }), n.d(t, "toggleCommunityMute", function() {
        return qt
    }), n.d(t, "deleteDialog", function() {
        return Qt
    }), n.d(t, "restoreDialog", function() {
        return $t
    }), n.d(t, "spamDialog", function() {
        return Yt
    }), n.d(t, "updateTabbedPeers", function() {
        return Xt
    }), n.d(t, "isEverythingLoaded", function() {
        return Zt
    }), n.d(t, "cleanTab", function() {
        return Jt
    }), n.d(t, "stringifyTab", function() {
        return en
    }), n.d(t, "updateGoToEndVisibility", function() {
        return tn
    }), n.d(t, "toggleCommunityMessages", function() {
        return nn
    }), n.d(t, "updateHistory", function() {
        return rn
    }), n.d(t, "startRecording", function() {
        return on
    }), n.d(t, "cancelRecording", function() {
        return an
    }), n.d(t, "setVoiceMessageAvail", function() {
        return sn
    }), n.d(t, "toggleConversation", function() {
        return cn
    }), n.d(t, "updateSearchQuery", function() {
        return un
    }), n.d(t, "initializeChatResize", function() {
        return ln
    }), n.d(t, "joinChat", function() {
        return dn
    }), n.d(t, "getInviteLink", function() {
        return fn
    }), n.d(t, "resetInviteLink", function() {
        return pn
    }), n.d(t, "leaveInvitation", function() {
        return mn
    }), n.d(t, "saveRecentSearchPeer", function() {
        return gn
    }), n.d(t, "resetRecentSearch", function() {
        return hn
    }), n.d(t, "removeFromRecentSearch", function() {
        return _n
    }), n.d(t, "pinMessageOptimistic", function() {
        return vn
    }), n.d(t, "unpinMessageOptimistic", function() {
        return bn
    }), n.d(t, "pinMessage", function() {
        return yn
    }), n.d(t, "unpinMessage", function() {
        return wn
    }), n.d(t, "getPinnedMessage", function() {
        return On
    }), n.d(t, "getMessageLocalId", function() {
        return Cn
    }), n.d(t, "getChatDetails", function() {
        return kn
    }), n.d(t, "updateFlags", function() {
        return En
    }), n.d(t, "removeChatPhoto", function() {
        return jn
    }), n.d(t, "kickUserOptimisticly", function() {
        return Sn
    }), n.d(t, "kickUser", function() {
        return Tn
    }), n.d(t, "toggleAdminOptimisticly", function() {
        return In
    }), n.d(t, "toggleAdmin", function() {
        return Pn
    }), n.d(t, "checkChatMember", function() {
        return Mn
    }), n.d(t, "hidePromoTooltip", function() {
        return xn
    }), n.d(t, "videoAutoPlayHandler", function() {
        return Ln
    }), n.d(t, "hideTopBannerAction", function() {
        return An
    }), n.d(t, "callbackTopBannerAction", function() {
        return Nn
    }), n.d(t, "loadBanner", function() {
        return Dn
    }), n.d(t, "setKeyboard", function() {
        return Rn
    }), n.d(t, "deleteKeyboard", function() {
        return Fn
    }), n.d(t, "toggleKeyboard", function() {
        return Bn
    }), n.d(t, "loadKeyboard", function() {
        return Hn
    }), n.d(t, "changeCommunityAccess", function() {
        return Un
    }), n.d(t, "resetTabAll", function() {
        return zn
    });
    var r = n(70),
        i = n(100),
        o = n(18),
        a = n(30),
        s = n(7),
        c = n(76),
        u = n(54),
        l = n(128),
        d = n(148),
        f = n(26),
        p = n(11),
        m = n(50),
        g = n(160),
        h = n(187),
        _ = n(115),
        v = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        },
        b = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function y(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }

    function w(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
            return n
        }
        return Array.from(e)
    }
    var O = 5,
        C = 8,
        k = Object(i.updateLazyLocation)(),
        E = k.scheduleNav,
        j = k.commitNav,
        S = k.scheduleNavWithTimeOut;
    var T = {
        settings: 0,
        block: 1,
        fav: 1,
        chat: 2,
        invite: 2,
        invite_link: 3,
        topic: 3,
        avatar: 4,
        photos: 5,
        search: 6,
        pin_hide: 7,
        pin_unhide: 7,
        unpin: 8,
        mute: 10,
        unmute: 10,
        clear: 11,
        leave: 12,
        return: 12,
        block_community: 12,
        allow_community: 12
    };

    function I(e, t, n) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_renew_hash",
            peers: e.join(","),
            gid: t.hidegid ? void 0 : n.gid
        })
    }

    function P(e, t, n) {
        return function(e) {
            return e.resync_in_process ? e.resync_in_process : Promise.resolve(!1)
        }(e).then(function(r) {
            return r ? t.apply(void 0, w(n)) : function(e) {
                if (!e.renew_hashes) {
                    var t = e.last_hashes_update || 0;
                    if (Date.now() - t < 1e4) return Promise.resolve();
                    var n = Object.keys(e.tabs).filter(function(t) {
                        return Object(u.isFullyLoadedTab)(e, t)
                    });
                    e.renew_hashes = I(n, {}, e).then(function(t) {
                        var r = b(t, 2),
                            i = r[0],
                            o = r[1];
                        return n.forEach(function(t) {
                            e.tabs[t].hash = i[t]
                        }), e.writeHash = o, delete e.renew_hashes, e.last_hashes_update = Date.now(), e
                    })
                }
                return e.renew_hashes
            }(e).then(function(e) {
                return t.apply(void 0, w(n))
            })
        })
    }

    function M(e) {
        return function() {
            var t = arguments,
                n = t[t.length - 1];
            return e.apply(void 0, w(t)).catch(function(r) {
                if (r && r.match && r.match(/1001;/)) return P(n, e, t);
                throw r
            })
        }
    }

    function x(e) {
        return "string" == typeof e ? se("<div>" + e + "</div>") : e
    }

    function L(e) {
        return "string" == typeof e ? e : e.innerHTML
    }

    function A(e, t) {
        return t.block_states = extend(t.block_states, e), Promise.resolve(t)
    }

    function N(e, t, n, i, o) {
        return o.tabHistoryNotChanged = !1, Object(a.retryFn)(r.post, 3, function(e) {
            return e - 1
        })(r.CONTROLLER, {
            act: "a_start",
            peer: e,
            msgid: n,
            history: t,
            prevpeer: o.prevPeer,
            gid: o.gid,
            block: i
        }).then(function(t) {
            var r = b(t, 5),
                i = r[0],
                a = r[1],
                s = r[2],
                c = r[3],
                l = r[4];
            if (a.forEach(function(e) {
                    return Object(p.oCacheAdd)(o, e)
                }), o.tabs || (o.tabs = {}), o.dialog_tab_cts = l, o.tabs[e] || (o.tabs[e] = Object(u.normalizeTab)(o, i)), A(c, o), n) {
                if (o.tabs[e]) {
                    var d = o.tabs[e].lastmsg,
                        f = o.tabs[e].lastmsg_meta;
                    extend(o.tabs[e], i), o.tabs[e].lastmsg = d, o.tabs[e].lastmsg_meta = f
                }
            } else extend(o.tabs[e], i);
            return o.admins = extend(o.admins, s), o.imQueue(e, !1), Ln(), D(e, o)
        }).catch(function(e) {
            return Object(m.imWeirdCatch)("loadPeer", e)
        })
    }

    function D(e, t) {
        var n = t.imQueue(e, !1),
            r = t.tabs[e],
            i = n.filter(function(n) {
                return !Object(d.isRidExist)(t, e, n.rid)
            });
        return r.msgs = i.reduce(function(e, t) {
            return e["rid" + t.rid] = t.mess, e
        }, r.msgs), t.imQueueSet(e, i), t.tabs[e].history = Object(u.restoreQueue)(i, t, x(t.tabs[e].history)), Promise.resolve(t)
    }

    function R(e, t, n) {
        var r = n.imQueue(e, !1).filter(function(e) {
            return e.failed && e.mess.messageId !== t
        });
        return n.imQueueSet(e, r), n.tabs[e].history = Object(u.removeMessages)([t], x(n.tabs[e].history)), Promise.resolve(n)
    }

    function F(e, t) {
        return !1 === (t.block_states[e] || {}).free ? Promise.resolve(t) : Object(r.post)(r.CONTROLLER, {
            act: "a_block",
            peer: e,
            prevPeer: t.prevPeer,
            gid: t.gid
        }).then(function(e) {
            return A(b(e, 1)[0], t)
        })
    }

    function B(e, t) {
        var n = t.peer;
        return Promise.resolve(t).then(function(t) {
            return t.tabHistoryNotChanged = !1, Object(u.isFullyLoadedTab)(t, n) && !t.tabs[n].msgid ? (t.gid && F(n, t), Promise.resolve(t).then(W)) : (Object(u.isFullyLoadedTab)(t, n) && (t.tabs[n].msgid = !1), N(n, e, !1, !0, t))
        }).then(W).then(H.bind(null, n))
    }

    function H(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
        return Object(u.isTabLoaded)(t, e) && (t.tabs[e].last_touched = Date.now()), Object(u.isTabLoaded)(t, e) && n && (t.tabs[e].last_visited = Date.now()), t
    }

    function U(e, t, n) {
        var r = n.msgid,
            i = n.peer;
        return !e && Object(u.isFullyLoadedTab)(n, i) && n.tabs[i].msgs[r] ? (t === n.peer ? n.tabHistoryNotChanged = !0 : n.tabHistoryNotChanged = !1, n.gid && F(i, n), Promise.resolve(n).then(W).then(H.bind(null, i))) : N(i, !0, r, !0, n).then(W).then(function() {
            return Object(d.getTab)(n, i).msgid = r, n
        }).then(H.bind(null, i))
    }

    function z(e, t, n, r) {
        if (At(r)) throw Object(u.showWaitUntilUploadedBox)(), new Error("Cant change peer while loading somethind");
        var i = r.gid ? "gim" + r.gid : "im";
        if (r.prevPeer = r.peer, r.peer = e, r.msgid = t || "", r.currentEntryPoint = n, cur.peer = e, E({
                sel: e ? Object(u.convertPeerToUrl)(e) : null,
                msgid: r.msgid,
                email: "",
                0: i
            }), 0 != r.prevPeer && H(r.prevPeer, r, !0), 0 !== e) {
            Object(u.isTabLoaded)(r, e) && H(e, r, !0), Xt(r.tabbedPeers.map(function(e) {
                return e.peer
            }).indexOf(e) < 0 ? [{
                peer: e,
                type: "perm"
            }].concat(r.tabbedPeers) : r.tabbedPeers.map(function(t) {
                return t.peer == e && "perm" !== t.type && (t.type = "perm"), t
            }), !1, r)
        } else Xt(r.tabbedPeers, !1, r);
        return j(), We(r.prevPeer, r)
    }

    function G(e) {
        if (cur.wallMentions = [], Object(u.isChatPeer)(e.peer) && Object(u.isFullyLoadedTab)(e, e.peer) && !Object(u.isFvkcomgroup)(e, e.peer)) {
            var t = e.tabs[e.peer],
                n = [];
            Object.keys(t.msgs || {}).reverse().forEach(function(e) {
                var r = Object(d.parserMessage)(t.msgs[e]),
                    i = r && r.userId;
                i && i != vk.id && -1 === n.indexOf(i) && Object(u.isUserAliveInChat)(t, i) && n.push(i)
            }), (t.memberIds || []).forEach(function(e) {
                -1 === n.indexOf(e) && n.push(e)
            }), n.forEach(function(t) {
                if (Object(p.oCacheExists)(e, t)) {
                    var n = Object(p.oCacheGet)(e, t),
                        r = n.link.substring(1);
                    cur.wallMentions.push([n.id, n.name, "@" + r, n.photo, void 0, void 0, void 0, r, n.first_name])
                }
            })
        }
    }

    function W(e) {
        var t = e.peer;
        if (0 === t) return Promise.resolve(e);
        var n = e.tabs[t],
            r = [],
            i = Object(u.isChatPeer)(t) && (n.data.closed || n.data.kicked),
            o = Object(u.isFvkcomgroup)(e, t);
        n.offset && r.push("photos"), n.offset && r.push("search"), (t < -2e9 || n.offset) && !o && r.push("clear"), Object(u.isCommunityInterface)(e) && !o && r.push("block"), Object(u.isCommunityPeer)(t) && (n.blocked_community ? r.push("allow_community") : r.push("block_community")), !Object(u.isChatPeer)(t) && !Object(u.isUserPeer)(t) || Object(u.isCommunityInterface)(e) || Object(u.isChatPeer)(t) && (n.data.kicked || n.data.closed) || (inArray(t, e.mutedPeers) ? r.push("unmute") : r.push("mute")), Object(u.isUserPeer)(t) && !e.gid && !n.blacklisted && n.is_friend && r.push("invite"), !e.chatSettingsAllowed && Object(u.isChatPeer)(t) && !i && n.data.link && r.push("invite_link"), Object(u.isChatPeer)(t) && !i && (e.chatSettingsAllowed || (Object(h.canChangeTitle)(e) && r.push("topic"), Object(h.canChangeAvatar)(e) && r.push("avatar")), Object(h.canInviteUser)(e) && r.push("invite"), e.gid || r.push("leave")), Object(u.isChatPeer)(t) && n.data.closed && !n.data.kicked && r.push("return"), Object(u.isChatPeer)(t) && e.chatSettingsAllowed && !n.data.closed && !n.data.kicked && r.push("settings"), Object(u.isChatPeer)(t) && n.pinned && (r.push(Object(g.isPinnedMessageVisibleInTab)(e, t) ? "pin_hide" : "pin_unhide"), Object(h.canPinOrUnpin)(e) && r.push("unpin"));
        var a = Object(u.chatActions)(e, o);
        return e.curActions = r.sort(function(e, t) {
            return T[e] - T[t]
        }).reduce(function(e, t) {
            return e[t] = a[t], e
        }, {}), Promise.resolve(e)
    }

    function V(e, t, n) {
        var i = n.tabs[n.peer];
        return Object(r.post)(r.CONTROLLER, {
            peer: n.peer,
            whole: e,
            act: "a_history",
            offset: i.offset + (i.skipped || 0),
            toend: t,
            gid: n.gid
        }).then(function(e) {
            var t = b(e, 4),
                r = t[0],
                o = t[1],
                a = t[2],
                s = t[3];
            return i.allShown = a, n.admins = extend(n.admins, s), i.history = r + L(i.history), i.historyToAppend = r, i.offset += Object.keys(o).length, i.msgs = extend(i.msgs, o), n
        })
    }

    function K(e) {
        var t = e.tabs[e.peer];
        return Object(r.post)(r.CONTROLLER, {
            peer: e.peer,
            act: "a_history",
            rev: 1,
            offset: t.skipped,
            gid: e.gid
        }).then(function(n) {
            var r = b(n, 5),
                i = r[0],
                o = r[1],
                a = r[2];
            r[3], r[4];
            t.allShown = t.allShown || a, t.history = L(t.history) + i, t.historyToAppend = i;
            var s = Object.keys(o).length;
            return t.skipped -= s, t.offset += s, t.msgs = extend(t.msgs, o), e
        })
    }

    function q(e, t, n, r) {
        var i = e.tabs[t];
        return r === o.FLAG_OUTBOUND && i.out_up_to > n ? e : (r === o.FLAG_OUTBOUND ? i.out_up_to = n : i.in_up_to = n, e)
    }
    var Q = M(function(e, t) {
        var n = t.tabs[e],
            i = Object.keys(n.msgs).map(function(n) {
                return Object(d.getMessage)(t, e, n)
            }).filter(function(e) {
                return !Object(f.isOut)(e)
            }).map(function(e) {
                return e.messageId
            }).sort(function(e, t) {
                return t - e
            });
        return n.skipped > 0 && (i = i.filter(function(e) {
            return intval(e) <= n.lastmsg - n.skipped
        })), (i = intval(i.shift())) <= n.in_up_to ? Promise.resolve(t) : (t.longpoll.push([o.readInboundEvent([6, e, i])]), Object(r.post)(r.CONTROLLER, {
            peer: e,
            ids: [i],
            hash: n.hash,
            act: "a_mark_read",
            gid: t.gid
        }).then(function() {
            return q(t, e, i, o.FLAG_OUTBOUND)
        }))
    });

    function $(e) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_get_key",
            uid: e.id,
            gid: e.gid
        }).then(function(t) {
            var n = b(t, 3),
                r = n[0],
                i = n[1],
                o = n[2];
            return extend({}, e, {
                imKey: r,
                imUrl: i,
                imPart: o
            })
        })
    }

    function Y(e) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_get_ts",
            gid: e.gid
        }).then(function(t) {
            var n = b(t, 1)[0];
            return extend({}, e, {
                imTs: n
            })
        })
    }

    function X(e, t, n) {
        var r = n.tabs[e];
        return r.msgs[t.messageId] && (r.msgs[t.messageId].errored = 1, r.history = Object(u.setMessageError)(e, t, x(r.history))), Promise.resolve(n)
    }

    function Z(e, t, n, r) {
        var i = r.tabs[e];
        return i.msgs[t] && (i.msgs[t].errored = 0, i.lastmsg_meta = n, i.lastmsg = t, i.history = Object(u.startResendMessage)(e, t, x(i.history))), Promise.resolve(r)
    }

    function J(e, t, n, r) {
        var i = arguments.length > 4 && void 0 !== arguments[4] && arguments[4];
        t.deletedDialog || (e.dialog_tabs = Object.keys(e.dialog_tabs).reduce(function(e, o) {
            return !n && !Bt(o)(t) || i && !i(o, e[o], t) || (e[o] = Object(s.arrayUnique)(r(e[o], o))), e
        }, e.dialog_tabs))
    }

    function ee(e, t) {
        return 0 === e.length ? Promise.resolve(t) : Object(r.post)(r.CONTROLLER, {
            act: "a_get_admin",
            admins: e.join(","),
            gid: t.gid
        }).then(function(e) {
            var n = b(e, 1)[0];
            return t.admins = extend(t.admins, n), t
        })
    }

    function te(e, t) {
        if (!inArray(e, t.tabbedPeers.map(function(e) {
                return e.peer
            })) && (0 !== t.peer || t.searchText) && !inArray(e, t.mutedPeers)) {
            var n = {
                peer: e,
                type: "temp"
            };
            Xt(t.tabbedPeers.concat([n]), !1, t)
        }
    }

    function ne(e, t, n) {
        return Object(u.isReversedDialogs)(n) ? t.concat([e]) : [e].concat(t)
    }

    function re(e, t) {
        var n = e.get().peer,
            r = Object(d.getTab)(e, n);
        if (Object(u.isFullyLoadedTab)(e, n)) {
            var i = x(r.history);
            r.history = Object(u.updateMessageInCache)(e, i, t)
        }
    }

    function ie(e, t) {
        var n = Object(d.getTab)(t, e.peerId);
        if (Object(u.isFullyLoadedTab)(t, e.peerId)) {
            var r = x(n.history);
            n.msgs[e.messageId] = extend(!0, {}, e), n.history = Object(u.editAndReplaceMessage)(t, e, r)
        }
        n && n.lastmsg == e.messageId && (n.lastmsg_meta = e);
        var i = n && n.pinned && Object(d.parserMessage)(n.pinned);
        return i && i.messageId == e.messageId && (n.pinned = e), Promise.resolve(t)
    }

    function oe(e, t) {
        var n = e.flags & o.FLAG_OUTBOUND,
            r = e.peerId;
        if (Object(u.isTabLoaded)(t, r)) {
            var i = t.tabs[r];
            if (i.deletedDialog = !1, !t.msg_local_ids_sort && e.local ? t.msg_local_ids_sort = y({}, e.messageId, 0) : e.local && (t.msg_local_ids_sort[e.messageId] = Object.keys(t.msg_local_ids_sort).length), n ? i.unread = 0 : (i.lastmsg == e.messageId && i.unread ? ae(t, 1, e.peerId) : (!i.unread && ae(t, 1, e.peerId), i.unread++), te(e.peerId, t)), Object(u.isFullyLoadedTab)(t, r)) {
                var a = x(i.history);
                i.skipped > 0 && i.skipped++, i.offset++, i.msgs[e.messageId] = extend(!0, {}, e), i.history = Object(u.appendToHistory)(t, e, a, !0, !0, !0), Object(f.isOut)(e) && (i.blocked_community = 0, W(t))
            }
            if (i.typing) {
                var s = i.typing.userIds.indexOf(e.userId);
                s >= 0 && i.typing.userIds.splice(s, 1)
            }
            return i.lastmsg = e.messageId, i.lastmsg_meta = e, H(e.peerId, t), J(t, i, !1, ne.bind(null, r), Ut.bind(null, t)), Promise.resolve(t)
        }
        return N(r, 0, 0, 0, t).then(function(t) {
            return J(t, t.tabs[r], !1, ne.bind(null, r), Ut.bind(null, t)), H(e.peerId, t), n || te(e.peerId, t), t
        })
    }

    function ae(e, t, n) {
        e.cur_unread_cnt || (e.cur_unread_cnt = {}), -1 === t && delete e.cur_unread_cnt[n], e.unread_cnt += t
    }

    function ce(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e.peerId)) {
            var n = t.tabs[e.peerId],
                r = n.unread;
            if (t = q(t, e.peerId, e.upToId, 0), null != e.unread ? n.unread = e.unread : n.unread = e.upToId >= n.lastmsg ? 0 : Object(d.countUnread)(e.peerId, t) + (n.unread > 0 ? +n.skipped : 0), r > 0 && !n.unread && ae(t, -1, e.peerId), !n.skipped) {
                var i = x(n.history);
                n.history = Object(u.removewNewUnreadBarAndMerge)(t, i, e.peerId)
            }
        } else Object(u.isTabLoaded)(t, e.peerId) && (t.tabs[e.peerId].unread > 0 && ae(t, -1, e.peerId), t.tabs[e.peerId].unread = 0, t.tabs[e.peerId].in_up_to = e.upToId);
        return Object(u.isTabLoaded)(t, e.peerId) && (t.dialog_tabs[l.FOLDER_UNREAD] = t.dialog_tabs[l.FOLDER_UNREAD].filter(function(t) {
            return intval(t) !== e.peerId
        })), 0 !== t.unread_cnt || t.active_tab !== l.FOLDER_UNREAD || t.gid ? Promise.resolve(t) : Ht(l.FOLDER_ALL, t)
    }

    function ue(e, t) {
        var n = t.tabs[e.peerId];
        if (Object(u.isTabLoaded)(t, e.peerId) && q(t, e.peerId, e.upToId, o.FLAG_OUTBOUND), Object(u.isFullyLoadedTab)(t, e.peerId)) {
            var r = x(n.history);
            n.history = Object(u.markMessagesAsRead)(t, e.peerId, r)
        }
        return Promise.resolve(t)
    }

    function le(e, t, n, r, i) {
        return i.text = {}, i.imQueue = e, i.imQueueResend = t, i.imQueueSet = n, i.imQueueComplete = r, Promise.resolve(i)
    }

    function de(e, t, n) {
        function r(e, t) {
            return {
                id: e.messageId,
                text: e.text,
                date: e.date,
                kludges: e.kludges,
                authorName: t
            }
        }
        if (1 === e.length) {
            var i = e[0],
                o = Object(d.getMessage)(n, t, i),
                a = Object(d.getAuthorFullName)(n, t, i);
            return !1 === a ? n.set(dt.bind(null, y({}, t, [o.userId]))).then(function(n) {
                var a = Object(d.getAuthorFullName)(n, t, i);
                return {
                    msgIds: e,
                    object: r(o, a)
                }
            }) : Promise.resolve({
                msgIds: e,
                object: r(o, a)
            })
        }
        return Promise.resolve({
            msgIds: e
        })
    }

    function fe(e, t) {
        Object(u.normalizeTabsGotFromServer)(t, e);
        var n = t.tabs[t.peer];
        return t.tabs = Object.keys(e).reduce(function(n, r) {
            var i = t.tabs[r] ? t.tabs[r].msgs : {},
                o = extend({}, i || {}, e[r].msgs || {});
            return n[r] = extend(t.tabs[r] || {}, e[r]), o && (n[r].msgs = o), e[r].lastmsg || (n[r].lastmsg = !1), n
        }, t.tabs), n && (t.tabs[t.peer] = n), Promise.resolve(t)
    }

    function pe(e, t, n, r) {
        var i = Object(d.getTab)(r, e);
        if (i) {
            var o = !1 !== t ? t == C ? 2 : mobPlatforms[t] ? 1 : 0 : i.last_seen[2];
            i.online = t, i.last_seen = [t, n || i.last_seen[1], o]
        }
        return Promise.resolve(r)
    }

    function me(e, t) {
        var n = Object(d.getTab)(t, e.peerId);
        return n && (e.ts = Date.now() / 1e3, n.typing = e), Promise.resolve(t)
    }

    function ge(e, t) {
        return Object(a.pause)(O + 2).then(function() {
            if (Object(u.isTabLoaded)(t, e)) {
                var n = t.tabs[e];
                if (n.typing) Date.now() - 1e3 * n.typing.ts >= 1e3 * O && (n.typing = void 0)
            }
            return t
        })
    }

    function he(e) {
        var t = {},
            n = e.find(function(e) {
                return "poll" === e[0]
            });
        if (n) {
            var r = b(n, 3)[2];
            Object.assign(t, r)
        }
        return t
    }

    function _e(e) {
        return e.map(function(e) {
            return e[0] + ":" + e[1]
        }).join(",")
    }
    var ve = function(e, t, n, i) {
            var o = Date.now() + rand(0, 100).toFixed(0);
            return Object(a.retryFn)(r.post, 1)(r.CONTROLLER, Object.assign({
                act: "a_send",
                to: e,
                hash: n.hash,
                msg: t.message,
                payload: t.payload,
                media: _e(t.attaches),
                guid: o,
                share_url: t.share_url,
                cancelled_shares: t.cancelled_shares,
                random_id: t.rid,
                gid: n.hidegid ? void 0 : i.gid,
                entrypoint: i.currentEntryPoint || "",
                sticker_referrer: t.sticker_referrer
            }, n.external, he(t.attaches)), 2e4).then(function(e) {
                var t = b(e, 1)[0];
                return i.version !== t.version && nav.reload({
                    force: !0
                }), i.currentEntryPoint = "", i
            })
        },
        be = M(function(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                r = arguments[3],
                i = r.tabs[e];
            return ve(e, t, v({
                hash: i.hash
            }, n), r)
        }),
        ye = M(function(e, t, n) {
            return Object(r.post)(r.CONTROLLER, Object.assign({
                act: "a_edit_message",
                hash: e.hash,
                id: t.messageId,
                peerId: e.peerId,
                gid: n.gid,
                msg: t.origText,
                media: _e(t.attaches),
                share_url: t.share_url,
                cancelled_shares: t.cancelled_shares
            }, he(t.attaches)), 2e4).then(function(e) {
                b(e, 1)[0];
                return n
            })
        });

    function we(e, t) {
        if (t.selectedMessages || (t.selectedMessages = []), 1 === e.length && inArray(e[0], t.selectedMessages)) t.selectedMessages = t.selectedMessages.filter(function(t) {
            return t !== e[0]
        });
        else {
            var n = t.selectedMessages.concat(e);
            t.selectedMessages = Object(s.arrayUnique)(n).sort(function(e, t) {
                return e - t
            })
        }
        return Promise.resolve(t)
    }

    function Oe(e) {
        return e.selectedMessages = [], Promise.resolve(e)
    }

    function Ce(e) {
        return e.selectedMessages = [], Promise.resolve(e)
    }

    function ke(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e.peerId)) {
            var n = t.tabs[e.peerId],
                r = t.imQueue(e.peerId).filter(function(t) {
                    return t.failed && t.rid !== e.randomId
                });
            t.imQueueSet(e.peerId, r), t.imQueueComplete(e.peerId, e.randomId), n.lastmsg_meta = e, n.lastmsg = e.messageId, n.msgs["rid" + e.randomId] && (n.msgs[e.messageId] = e, delete n.msgs["rid" + e.randomId]), n.history = Object(u.replaceMessageAttrs)(t, x(n.history), e)
        }
        return Promise.resolve(t)
    }

    function Ee(e, t) {
        return Promise.resolve()
    }

    function je(e, t) {
        var n = {
            act: "a_get_media",
            id: e.messageId,
            gid: t.gid
        };
        return Object(a.retryFn)(r.post, 3, function(e) {
            return e * e
        })(r.CONTROLLER, n).then(function(n) {
            return Se(e, n, t)
        }).catch(function() {
            return Se(e, null, t)
        })
    }

    function Se(e, t, n) {
        var r = n.tabs[e.peerId];
        return r.mediacontent || (r.mediacontent = {}), r.mediacontent[e.messageId] = t || [getTemplate("im_retry_link")], Te(e, n)
    }

    function Te(e, t) {
        var n = t.tabs[e.peerId];
        return n.history = Object(u.replaceAttaches)(x(n.history), e, t), Promise.resolve(t)
    }

    function Ie(e, t, n) {
        var r = Object(u.dayFromVal)(t),
            i = n.tabs[e];
        return i.searchDay = r, i.searchOffset = 0, i.searchAllLoaded = !1, Promise.resolve(n)
    }

    function Pe(e, t, n) {
        return n.tabs[t].searchText = e, Ke(t, n), n
    }

    function Me(e, t, n) {
        if (t) {
            var r = n.tabs[t];
            r.searchText = e, r.searchOffset = 0, r.searchAllLoaded = !1
        } else n.searchText = e, n.searchOffset = 0, n.searchAllLoaded = !1;
        return Promise.resolve(n)
    }

    function xe(e, t, n, i, o) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_hints",
            str: e,
            gid: i.hidegid ? 0 : o.gid,
            query: n,
            peerIds: t.join(",")
        }).then(function(e) {
            var t = b(e, 3),
                n = t[0],
                r = t[1];
            return A(t[2], o), r.forEach(function(e) {
                return Object(p.oCacheAdd)(o, e)
            }), fe(n, o), Object.keys(n).sort(function(e, t) {
                return n[e].order - n[t].order
            }).map(function(e) {
                return n[e]
            })
        })
    }

    function Le(e, t, n, r) {
        return xe(e, t, n, {}, r).then(function(e) {
            return e.map(function(e) {
                return {
                    peerId: e.peerId,
                    name: e.tab,
                    photo: e.photo,
                    online: e.online,
                    is_friend: "friends" === n
                }
            })
        })
    }

    function Ae(e) {
        var t = {
            peerId: e[0],
            name: e[1],
            tab: e[1],
            photo: e[2],
            href: e[3],
            online: e[4],
            is_friend: e[5],
            local_index: !0
        };
        return e[6] && (t.data = {
            flags: e[6]
        }), t
    }

    function Ne(e) {
        return function(t, n) {
            return e(n).then(function(e) {
                var r = (t ? e.search(t) : e.list).map(Ae);
                return n.mapped_index || (n.mapped_index = {}), r.forEach(function(e) {
                    n.mapped_index[e.peerId] = e
                }), r
            })
        }
    }
    var De = Ne(function(e) {
            return e.topConvTree
        }),
        Re = Ne(function(e) {
            return e.imTopConvTree
        }),
        Fe = Ne(function(e) {
            return e.hintsTree
        });

    function Be(e, t) {
        var n = void 0,
            i = void 0,
            o = void 0;
        t.topConvTree = new Promise(function(e) {
            n = e
        }), t.hintsTree = new Promise(function(e) {
            i = e
        }), t.imTopConvTree = new Promise(function(e) {
            o = e
        });
        var s = e.select(c.RECENT_SEARCH_OP);
        return Object(a.retryFn)(r.post, 1, function() {
            return 4
        })(r.CONTROLLER, {
            act: "a_dialogs_preload",
            rs: s.join(","),
            gid: t.gid
        }).catch(function(e) {
            return [
                [],
                [],
                []
            ]
        }).then(function(e) {
            var r = b(e, 4),
                a = r[0],
                s = r[1],
                c = r[2],
                u = r[3];
            return t.popular_sugg = c, new vkIndexer(a, function(e) {
                return e[1]
            }, n), new vkIndexer(s, function(e) {
                return e[1]
            }, i), u && u.length > 0 ? new vkIndexer(u, function(e) {
                return e[1]
            }, o) : o(), t
        })
    }

    function He(e) {
        var t = e.active_tab,
            n = void 0;
        return n = e.dialog_tabs[t].length > 0 ? Math.min.apply(null, e.dialog_tabs[t].map(function(t) {
            return e.tabs[t].lastmsg
        })) : 0, Object(r.post)(r.CONTROLLER, {
            act: "a_get_dialogs",
            start_message_id: n,
            tab: t,
            gid: e.gid
        }).then(function(n) {
            var r = b(n, 4),
                i = r[0],
                o = r[1],
                a = r[2],
                s = r[3];
            return a.forEach(function(t) {
                return Object(p.oCacheAdd)(e, t)
            }), A(s, e), fe(o, e), e.dialog_tabs[t] = e.dialog_tabs[t].concat(Object.keys(o).map(intval)), e.dialog_tabs_all[t] = !i.has_more, Promise.resolve(e)
        })
    }
    var Ue = M(function(e, t) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_search",
            q: e,
            from: "all",
            gid: t.gid,
            hash: t.writeHash,
            offset: t.searchOffset || 0
        }).then(function(n) {
            var r = b(n, 5),
                i = r[0],
                o = r[1],
                a = r[2],
                s = r[3],
                c = r[4];
            return o.forEach(function(e) {
                return Object(p.oCacheAdd)(t, e)
            }), Object(u.normalizeTabsGotFromServer)(t, i), e === t.searchText && (t.searchOffset = s, t.searchAllLoaded = c), Object.keys(i).filter(function(e) {
                return !t.tabs[e]
            }).forEach(function(e) {
                t.tabs[e] = i[e]
            }), [i, a]
        })
    });

    function ze(e, t) {
        return t.tabs[e].searchAllLoaded
    }

    function Ge(e, t) {
        return !(t.peer !== e || !Object(u.isFullyLoadedTab)(t, e)) && t.tabs[e].inplaceSearch
    }

    function We(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e)) {
            var n = t.tabs[e];
            delete n.inplaceSearch, delete n.searchOffset, delete n.searchAllLoaded, delete n.searchText, delete n.searchDay, E({
                st: ""
            }), j()
        }
        return Promise.resolve(t)
    }

    function Ve(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e)) {
            var n = t.tabs[e];
            delete n.searchDay, n.searchOffset = 0, n.searchAllLoaded = !1
        }
        return Promise.resolve(t)
    }

    function Ke(e, t) {
        return t.tabs[e].inplaceSearch = !0, Promise.resolve(t)
    }
    var qe = M(function(e, t) {
        var n = t.tabs[e],
            i = "";
        if (Ke(e, t), n.searchDay && (i = "day:" + n.searchDay), !i && !n.searchText) return Promise.reject();
        var o = "in:" + e + " " + i + " " + (n.searchText || "");
        return E({
            st: n.searchText
        }), j(), Object(r.post)(r.CONTROLLER, {
            act: "a_search",
            q: o,
            from: "in",
            gid: t.gid,
            hash: t.writeHash,
            offset: n.searchOffset || 0
        }).then(function(e) {
            var t = b(e, 3),
                r = t[0],
                i = t[1],
                o = t[2];
            return n.searchOffset = i, n.searchAllLoaded = o, r
        })
    });

    function Qe(e) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_important",
            offset: e,
            part: e > 0
        })
    }

    function $e(e, t) {
        var n = Object(d.getTab)(e, t);
        return Object(r.post)(r.CONTROLLER, {
            act: "a_load_lastmsg",
            peerId: t,
            gid: e.get().gid
        }).then(function(r) {
            var i = b(r, 2),
                o = i[0],
                a = i[1];
            n.lastmsg = o[0] || !1, n.lastmsg_meta = o;
            var s = b(a, 3);
            n.unread = s[0], n.in_up_to = s[1], n.out_up_to = s[2], n.unread || (e.get().dialog_tabs[l.FOLDER_UNREAD] = e.get().dialog_tabs[l.FOLDER_UNREAD].filter(function(e) {
                return e != t
            })), J(e.get(), n, !1, ne.bind(null, t), Ut.bind(null, e.get()))
        })
    }

    function Ye(e, t, n) {
        if (Object(u.isFullyLoadedTab)(n, t)) {
            var r = n.tabs[t];
            r.deleted = r.deleted ? r.deleted.concat(e) : e
        }
        return Promise.resolve(n)
    }

    function Xe(e, t, n) {
        if (Object(u.isFullyLoadedTab)(n, t)) {
            var r = n.tabs[t];
            r.history = Object(u.removeMessages)(e, x(r.history)), r.offset -= e.filter(function(e) {
                return r.msgs[e]
            }).length, e.forEach(function(e) {
                return delete r.msgs[e]
            }), e.forEach(function(e) {
                var t = (n.selectedMessages || []).indexOf(e); - 1 != t && n.selectedMessages.splice(t, 1)
            })
        }
        return Promise.resolve(n)
    }
    var Ze = M(function(e, t, n, i, o) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_mark",
            peer: t,
            hash: n || o.tabs[t].hash,
            gid: o.gid,
            msgs_ids: e.join(","),
            mark: i
        })
    });

    function Je(e, t, n, r) {
        if (Object(u.isFullyLoadedTab)(r, t)) {
            var i = r.tabs[t];
            i.deleted = i.deleted ? i.deleted.concat(e) : e, i.history = Object(u.removeMessagesWithRestore)(e, t, n, x(i.history)), i.offset -= e.filter(function(e) {
                return i.msgs[e]
            }).length
        }
        return Promise.resolve(r)
    }

    function et(e, t, n) {
        if (Object(u.isFullyLoadedTab)(n, t)) {
            var r = n.tabs[t];
            r.deleted && (r.deleted = r.deleted.filter(function(t) {
                return t !== e
            })), r.history = Object(u.restoreMessage)(e, t, x(r.history)), r.offset++
        }
        return Promise.resolve(n)
    }

    function tt(e, t, n, i) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_restore",
            id: e,
            peer: t,
            hash: n,
            gid: i
        })
    }
    var nt = M(function(e, t) {
        return t.tabs[e].lastTyping = Date.now(), Object(r.post)(r.CONTROLLER, {
            act: "a_typing",
            peer: e,
            gid: t.gid,
            hash: t.tabs[e].hash
        }).then(function() {
            return t
        }, function() {
            return t
        })
    });

    function rt(e, t, n) {
        return t && (n.pendingForward = null, e || (e = {
            msgIds: []
        }), t.addAttach("mail", e.msgIds.join(";"), e.object || null)), Promise.resolve(n)
    }

    function it(e, t) {
        return t.pendingForward = e, Promise.resolve(t)
    }

    function ot(e, t, n) {
        if (Object(u.isTabLoaded)(n, e)) {
            n.blockedFlagUpdates || (n.blockedFlagUpdates = {}), n.blockedFlagUpdates[e] = !0, J(n, n.tabs[e], !0, function(t) {
                return t.filter(function(t) {
                    return t !== e
                })
            }), n.tabs[e].unread > 0 && ae(n, -1, e);
            var r = n.tabs[e];
            return r.deletedDialog = !0, Xt(n.tabbedPeers.filter(function(t) {
                return t.peer !== e
            }), !0, n), t.then(function(t) {
                var i = b(t, 2);
                i[0], i[1];
                return delete n.blockedFlagUpdates[e], r.msgs = null, r.history = null, r.unread = 0, r.lastmsg = !1, r.lastmsg_meta = null, n
            })
        }
    }
    var at = M(function(e, t) {
            return ot(e, Object(r.post)("al_im.php", {
                act: "a_flush_history",
                id: e,
                from: "im",
                gid: t.gid,
                hash: t.tabs[e].hash
            }), t)
        }),
        st = M(function(e, t, n) {
            return Object(r.post)(r.CONTROLLER, {
                act: "a_set_chat_title",
                peer: e,
                new_title: t,
                gid: n.gid,
                hash: n.tabs[e].hash
            }).then(function() {
                return n
            })
        }),
        ct = M(function(e, t) {
            return Object(r.post)(r.CONTROLLER, {
                act: "a_load_chat_info",
                peer: e,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(function(n) {
                var r = b(n, 1)[0];
                return t.tabs[e] = extend(t.tabs[e], r), t
            })
        });

    function ut(e, t, n) {
        var r = n.tabs[e];
        return r.memberIds = [].concat(r.memberIds, t).filter(function(e, t, n) {
            return n.indexOf(e) === t
        }), r.membersCount = r.memberIds.length, Promise.resolve(n)
    }
    var lt = M(function(e, t, n) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_add_chat_members",
            peer: e,
            new_peer: t.join(","),
            gid: n.gid,
            hash: n.tabs[e].hash
        }).then(function(e) {
            return n
        })
    });

    function dt(e, t) {
        if (isEmpty(e)) return Promise.resolve(t);
        var n = Object.keys(e).map(function(t) {
            return t + ":" + e[t].join(",")
        }).join(";");
        return Object(r.post)(r.CONTROLLER, {
            act: "a_load_member",
            need: n
        }).then(function(e) {
            return b(e, 1)[0].forEach(function(e) {
                return Object(p.oCacheAdd)(t, e)
            }), t
        })
    }

    function ft(e, t, n) {
        var r = {},
            i = n.get();

        function a(e, t) {
            Object(u.isChatPeer)(e) && t && !Object(p.oCacheExists)(i, t) && (r[e] ? -1 === r[e].indexOf(t) && r[e].push(t) : r[e] = [t])
        }
        var s = t.filter(function(e) {
            return !Object(u.isTabLoaded)(i, e.peerId)
        }).map(function(e) {
            return e.peerId
        });
        t.forEach(function(e) {
            Object(u.isTabLoaded)(i, e.peerId) && a(e.peerId, e.userId)
        }), e.forEach(function(e) {
            a(e.peerId, +e.kludges.source_mid)
        });
        var c = t.filter(function(e) {
            return e.flags & o.FLAG_OUTBOUND && !e.local
        }).map(function(e) {
            return e.kludges.from_admin
        }).filter(function(e) {
            return e && !i.admins[e]
        });
        return 0 === Object.keys(r).length && 0 === c.length && 0 === s.length ? Promise.resolve(i) : {
            shouldLoad: Object.keys(r).length > 0 || c.length > 0 || s.length > 0,
            needMembers: r,
            needAdminIds: c,
            needPeers: s
        }
    }

    function pt(e, t, n) {
        var r = e.needMembers,
            i = e.needAdminIds,
            o = e.needPeers;
        return t.pause(), Promise.all([dt(r, n), ee(i, n), Promise.all(o.map(function(e) {
            return N(e, 0, 0, 0, n)
        }))]).catch(function() {
            return n
        }).then(function() {
            return t.resume()
        }).then(function() {
            return n
        })
    }
    var mt = M(function(e, t) {
        return e.kludges.source_act === u.CHAT_PHOTO_REMOVE ? (delete t.tabs[e.peerId].photo, delete t.tabs[e.peerId].photoLarge, Promise.resolve(t)) : Object(r.post)(r.CONTROLLER, {
            act: "a_get_chat_photo",
            msg_id: e.messageId
        }).then(function(n) {
            var r = b(n, 2),
                i = r[0],
                o = r[1];
            t.chat_photo_msg = o;
            var a = t.tabs[e.peerId];
            if (t.tabs[e.peerId].photo = i[0], t.tabs[e.peerId].photoLarge = i[1], Object(u.isFullyLoadedTab)(t, e.peerId)) {
                var s = e.kludges.source_act;
                a.history = Object(u.addChatPhotoToUpdate)(e, s, t, x(a.history))
            }
            return t
        })
    });

    function gt(e, t, n, r) {
        return t !== vk.id ? Promise.resolve(r) : (Object(u.isTabLoaded)(r, n) && r.peer == n && (r = W(r)), Promise.resolve(r))
    }
    var ht = M(function(e, t) {
            return Object(r.post)(r.CONTROLLER, {
                act: "a_leave_chat",
                chat: e - 2e9,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(gt.bind(null, u.CHAT_KICK_USER, vk.id, e, t))
        }),
        _t = M(function(e, t) {
            return Object(r.post)(r.CONTROLLER, {
                act: "a_return_to_chat",
                chat: e - 2e9,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(gt.bind(null, u.CHAT_INVITE_USER, vk.id, e, t))
        }),
        vt = M(function(e, t, n) {
            return Object(r.post)(r.CONTROLLER, {
                act: "a_mute",
                peer: e,
                hash: n.tabs[e].hash,
                gid: n.gid,
                value: t ? 1 : 0
            }).then(function() {
                var r = t ? "mute" : "unmute";
                return window.Notifier && Notifier.lcSend("im", {
                    act: r,
                    peer: e
                }), n
            }).then(bt.bind(null, e, t))
        });

    function bt(e, t, n) {
        var r = n.mutedPeers.filter(function(t) {
            return t !== e
        });
        return t && r.push(e), n.mutedPeers = r, cur.mutedPeers = n.mutedPeers, W(n)
    }

    function yt(e, t) {
        return t.stack = e, Promise.resolve(t)
    }
    var wt = M(function(e, t, n, i) {
        return Ot(e, n, t, i), Object(r.post)(r.CONTROLLER, {
            act: "a_mark_important",
            ids: e,
            val: t ? 1 : 0,
            from: "im",
            gid: i.gid,
            peer: n,
            hash: i.tabs[n].hash
        }).then(function(e) {
            return i
        })
    });

    function Ot(e, t, n, r) {
        if (Object(u.isFullyLoadedTab)(r, t)) {
            var i = r.tabs[t];
            e.filter(function(e) {
                return i.msgs[e]
            }).forEach(function(e) {
                var a = Object(d.getMessage)(r, t, e),
                    s = n ? a.flags | o.FLAG_IMPORTANT : a.flags & ~o.FLAG_IMPORTANT;
                a.flags = s, i.msgs[e] = a, i.history = Object(u.updateStar)(e, n, x(i.history))
            })
        }
        return Promise.resolve(r)
    }

    function Ct(e, t, n) {
        return n.importants || (n.importants = {}), (n.importants[t] || 0) !== e && (n.important_cnt += e, n.importants[t] = e), Promise.resolve(n)
    }

    function kt(e, t) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_spam",
            offset: e,
            gid: t,
            part: e > 0
        })
    }

    function Et(e, t) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_flush_spam",
            gid: t,
            hash: e
        })
    }

    function jt(e, t, n) {
        return n.creationType = e, n.creationFilter = t, Promise.resolve(n)
    }

    function St(e, t) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_owner_photo",
            photo: JSON.parse(e).data[0],
            peer: t
        })
    }

    function Tt(e, t) {
        return t.next_chat_avatar = e, Promise.resolve(t)
    }

    function It(e, t, n) {
        return Object(r.post)("al_page.php", {
            act: "owner_photo_save",
            peer: e,
            _query: t
        }).then(function(e) {
            return n
        })
    }
    var Pt = M(function(e, t, n, i) {
        return i.creating = !0, i.longpoll.pause(), Object(r.post)(r.CONTROLLER, {
            act: "a_multi_start",
            hash: i.writeHash,
            peers: t.join(","),
            title: n
        }).then(function(e) {
            var t = b(e, 1)[0];
            return i.next_peer = t.peerId, i.tabs[t.peerId] = t, J(i, t, !1, function(e) {
                return [t.peerId].concat(e)
            }), i.longpoll.resume(), i
        }).then(function(t) {
            return e ? It(t.next_peer, e, t) : t
        }).then(function(e) {
            return e.creating = !1, e
        }).catch(function(e) {
            throw i.creating = !1, i.longpoll.resume(), e
        })
    });

    function Mt(e) {
        var t = void 0;
        e.resync_in_process = new Promise(function(e) {
            t = e
        });
        var n = Object.keys(e.tabs).length,
            i = e.active_tab;
        return Object(r.post)(r.CONTROLLER, {
            act: "a_resync",
            sel: e.peer,
            gid: e.gid,
            loaded: n,
            tab: i,
            add_peers: e.tabbedPeers.map(function(e) {
                return e.peer
            }).join(",")
        }).then(function(n) {
            var r = b(n, 5),
                o = r[0],
                a = r[1],
                c = r[2],
                d = r[3],
                f = r[4];
            a.forEach(function(t) {
                return Object(p.oCacheAdd)(e, t)
            }), Object(u.normalizeTabsGotFromServer)(e, o), c.user_unread && handlePageCount("msg", c.user_unread), Object(s.lplog)("Resync success", "success");
            var m = e.peer,
                g = void 0;
            if (Object(u.isReservedPeer)(m)) g = Promise.resolve(!1);
            else {
                var h = {
                    tabs: y({}, m, e.tabs[m]),
                    oCache: {}
                };
                g = fe(y({}, m, o[m]), h)
            }
            return g.then(function(n) {
                e.tabs = o, e.admins = extend(e.admins, d), n && (e.tabs[m] = n.tabs[m], e.tabs[m].history = Object(u.restoreQueue)(m, e, x(e.tabs[m].history))), e.loadingDialogs = !1, e.mutedPeers = c.mutedPeers, e.lastDialogsOptions = {
                    has_more: c.has_more
                }, e.dialog_tab_cts = c.folder_cts, e.dialog_tabs[i] = f.map(intval);
                var r = e.dialog_tabs[i].map(function(t) {
                    return e.tabs[t]
                });
                return Object.keys(e.dialog_tabs).filter(function(e) {
                    return e != i
                }).forEach(function(t) {
                    i == l.FOLDER_ALL ? e.dialog_tabs[t] = r.filter(Bt(t)).map(function(e) {
                        return e.peerId
                    }) : e.dialog_tabs[t] = []
                }), delete e.resync_in_process, setTimeout(t.bind(null, !0), 0), Nt(intval(c.unread), e)
            })
        }).catch(function(t) {
            return Object(s.lplog)("Resync error: " + t.message + " " + t.stack, "error"), Object(a.pause)(2).then(Mt.bind(null, e))
        })
    }

    function xt(e, t) {
        return t.lockedSending = e, Promise.resolve(t)
    }

    function Lt(e, t, n) {
        return e && !n.delayed_message ? (n.delayed_message = e, n.delayed_ts = t) : e || (n.delayed_message = e, n.delayed_ts = t), Promise.resolve(n)
    }

    function At(e) {
        return !!e.textMediaSelector.urlAttachmentLoading || !!(window.Upload && Upload.options && Upload.isSomethingUploading) && Object.keys(Upload.options).filter(function(e) {
            return Upload.isSomethingUploading(e)
        }).length > 0
    }

    function Nt(e, t) {
        return t.unread_cnt = e, t.dialog_tab_cts[l.FOLDER_UNREAD] = e, Promise.resolve(t)
    }

    function Dt(e, t) {
        return t.ctrl_submit = !!e, Object(r.post)(r.CONTROLLER, {
            act: "a_save_ctrl_submit",
            to: t.peer,
            hash: t.tabs[t.peer].hash,
            value: e ? 1 : 0
        }).then(function(e) {
            return t
        })
    }

    function Rt(e, t, n) {
        n.cur_unread_cnt || (n.cur_unread_cnt = {}), t && !inArray(e, n.mutedPeers) && (n.cur_unread_cnt[e] = !0);
        var r = document.title,
            i = window.devicePixelRatio >= 2 ? "_2x" : "";
        if (t && !n.update_title_to) {
            var o = function(e, t, n) {
                return function() {
                    n.update_old_title = e;
                    var r = Object.keys(n.cur_unread_cnt).length;
                    if (0 === r) return Object(_.setDocumentTitle)(e || document.title), setFavIcon("/images/icons/favicons/fav_im" + t + ".ico"), clearInterval(n.update_title_to), void(n.update_title_to = !1);
                    e ? (Object(_.setDocumentTitle)(e), setFavIcon("/images/icons/favicons/fav_im" + t + ".ico"), e = !1) : (e = document.title, setFavIcon("/images/icons/favicons/fav_im" + (r > 9 ? 10 : r) + t + ".ico"), Object(_.setDocumentTitle)(winToUtf(getLang("mail_im_new_messages", r))))
                }
            }(r, i, n);
            n.update_title_to = setInterval(o, 1e3), o()
        } else !t && n.update_old_title && (Object(_.setDocumentTitle)(n.update_old_title), n.cur_unread_cnt = {}, r = !1, n.update_old_title = !1, setFavIcon("/images/icons/favicons/fav_im" + i + ".ico"), clearInterval(n.update_title_to), n.update_title_to = !1);
        return Promise.resolve(n)
    }

    function Ft(e, t, n, r, i) {
        return Object(u.isFullyLoadedTab)(i, e) && (i.tabs[e].scrollTop = intval(t), i.tabs[e].scrollBottom = intval(n), i.tabs[e].contHeight = intval(r)), Promise.resolve(i)
    }

    function Bt(e) {
        return e === l.FOLDER_ALL ? function() {
            return !0
        } : e === l.FOLDER_UNREAD ? function(e) {
            return e.unread > 0
        } : function(t) {
            return t.folders & l.FOLDER_MASKS[e]
        }
    }

    function Ht(e, t) {
        t.active_tab = e, Object(i.updateLocation)({
            tab: e === l.FOLDER_ALL ? null : e
        });
        var n = [];
        if (e !== l.FOLDER_ALL && !Object(u.isReversedDialogs)(t)) {
            var r = t.dialog_tabs[e];
            n = t.dialog_tabs[l.FOLDER_ALL].map(function(e) {
                return t.tabs[e]
            }).filter(Bt(e)).map(function(e) {
                return e.peerId
            }), t.dialog_tabs[e] = r.length >= n.length ? r : n
        }
        return Promise.resolve(t)
    }

    function Ut(e, t, n, r) {
        var i = e.dialog_tabs_all;
        return !(!i[l.FOLDER_ALL] && !i[t]) || (n.filter(function(e) {
            return e === r.peerId
        }).length > 0 || ("r" === r.lastmsg[0] || n.map(function(t) {
            return e.tabs[t.toString()]
        }).filter(function(t) {
            return Object(u.isReversedDialogs)(e) ? t.lastmsg > r.lastmsg : t.lastmsg < r.lastmsg
        }).length > 0))
    }

    function zt(e, t, n, r, i) {
        if (Object(u.isTabLoaded)(i, e)) {
            var a = i.tabs[e];
            return n === o.REPLACE_DIRECTORIES && (t ^= a.folders),
                function(e, t, n) {
                    return !(e === o.SET_DIRECTORIES && n.folders & t || !(e !== o.RESET_DIRECTORIES || n.folders & t))
                }(n, t, a) && Object.keys(l.FOLDER_MASKS).filter(function(e) {
                    return l.FOLDER_MASKS[e] & t
                }).forEach(function(e) {
                    i.dialog_tab_cts[e] += function(e, t, n) {
                        return t !== o.RESET_DIRECTORIES || e.folders & l.FOLDER_MASKS[n] ? t === o.REPLACE_DIRECTORIES ? e.folders & l.FOLDER_MASKS[n] ? -1 : 1 : t === o.SET_DIRECTORIES ? 1 : -1 : 0
                    }(a, n, e)
                }), n === o.SET_DIRECTORIES ? i.tabs[e].folders |= t : n === o.RESET_DIRECTORIES ? i.tabs[e].folders &= ~t : i.tabs[e].folders = t ^= a.folders, J(i, i.tabs[e], !0, function(t, n) {
                    return t.concat([e]).map(function(e) {
                        return i.tabs[e]
                    }).filter(Bt(n)).map(function(e) {
                        return e.peerId
                    })
                }, Ut.bind(null, i)), Promise.resolve(i)
        }
        return N(e, 0, 0, 0, i).then(zt.bind(null, e, t, n, i))
    }
    var Gt = M(function(e, t) {
            var n = l.FOLDER_MASKS[l.FOLDER_IMPORTANT],
                i = t.tabs[e].folders & n,
                a = i ? o.resetDirectoriesEvent : o.setDirectoriesEvent;
            return t.longpoll.push([a([0, e, n, !0])]), Object(r.post)(r.CONTROLLER, {
                act: "a_dialog_star",
                val: i ? 0 : 1,
                peer: e,
                hash: t.tabs[e].hash,
                gid: t.gid
            }).then(function() {
                return t
            })
        }),
        Wt = M(function(e, t, n) {
            var i = l.FOLDER_MASKS[l.FOLDER_UNRESPOND];
            return n.longpoll.push([o.resetDirectoriesEvent([0, e, i, !0]), o.readInboundEvent([6, e, t])]), Object(r.post)(r.CONTROLLER, {
                act: "a_mark_answered",
                peer: e,
                lastmsg: t,
                hash: n.tabs[e].hash,
                gid: n.gid
            }).then(function() {
                return n
            })
        });

    function Vt(e) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_get_mutex_key",
            gid: e
        })
    }

    function Kt(e, t) {
        return A(y({}, e, {
            free: !0
        }), t), Object(r.post)(r.CONTROLLER, {
            act: "a_block_release",
            peer: e,
            gid: t.gid
        }).then(function() {
            return t
        })
    }

    function qt(e, t) {
        var n = ls.get("comm_mute_" + t.gid) ? 1 : 0;
        return e && (n ^= 1), ls.set("comm_mute_" + t.gid, n), t.mute = n, Promise.resolve(t)
    }
    var Qt = M(function(e, t) {
        return J(t, t.tabs[e], !0, function(t) {
            return t.filter(function(t) {
                return t !== e
            })
        }), t.tabs[e].deletedDialog = !0, Object(r.post)(r.CONTROLLER, {
            act: "a_delete_dialog",
            peer: e,
            gid: t.gid,
            hash: t.tabs[e].hash
        }).then(function(n) {
            return n[0] ? (Xt(t.tabbedPeers.filter(function(t) {
                return t.peer !== e
            }), !0, t), t.tabs[e].unread = 0, t.tabs[e].lastmsg = !1, t.tabs[e].lastmsg_meta = null) : (t.tabs[e].deletedDialog = !1, J(t, t.tabs[e], !1, ne.bind(null, e), Ut.bind(null, t))), n
        })
    });

    function $t(e, t, n, i) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_restore_dialog",
            hash: t,
            gid: i.gid,
            spam: n ? 1 : 0,
            peer: e
        }).then(function(t) {
            return i.tabs[e].deletedDialog = !1, J(i, i.tabs[e], !1, function(t) {
                return [e].concat(t)
            }), i.tabs[e].unread = t, i
        })
    }

    function Yt(e, t, n) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_spam_dialog",
            peer: e,
            gid: n.gid,
            hash: t
        })
    }

    function Xt(e, t, n) {
        return n.tabbedPeers = e, Object(u.isClassicInterface)(n) && (E({
            peers: n.tabbedPeers.filter(function(e) {
                var t = e.peer,
                    r = e.type;
                return t !== n.peer && "perm" === r
            }).map(function(e) {
                return Object(u.getBareTab)(e.peer, n)
            }).filter(function(e) {
                return !e.deletedDialog
            }).map(function(e) {
                return e.peerId
            }).map(u.convertPeerToUrl).join("_")
        }), t && j()), Promise.resolve(n)
    }

    function Zt(e) {
        return !e.peer || (Ge(e.peer, e) ? ze(e.peer, e) : !!Object(u.isFullyLoadedTab)(e, e.peer) && e.tabs[e.peer].allShown)
    }

    function Jt(e, t) {
        var n = t.tabs[e];
        return Object(u.isFullyLoadedTab)(t, e) && (n.skipped = null, n.msgs = null, n.offset = null, n.allShown = null, n.history = null), Promise.resolve(t)
    }

    function en(e, t) {
        var n = t.tabs[e];
        return Object(u.isFullyLoadedTab)(t, e) && (n.history = L(n.history)), Promise.resolve(t)
    }

    function tn(e, t) {
        return t.go_to_end_visible = e, Promise.resolve(t)
    }

    function nn(e, t, n) {
        if (!Object(u.isCommunityPeer)(t)) return Promise.resolve(n);
        var i = Object(d.getTab)(n, t);
        return i.blocked_community = !e, Object(r.post)(r.CONTROLLER, {
            act: "a_toggle_community",
            peer_id: t,
            hash: i.hash,
            state: e ? 1 : 0
        }).then(function() {
            return W(n)
        })
    }

    function rn(e, t) {
        if (0 !== t.peer && Object(u.isFullyLoadedTab)(t, t.peer)) {
            var n = Object(d.getTab)(t, t.peer);
            n.history = x(n.history), e(n.history)
        }
        return Promise.resolve(t)
    }

    function on(e) {
        return e.audio_msg.isRecording ? Promise.reject() : (e.audio_msg.isRecording = !0, Promise.resolve(e))
    }

    function an(e) {
        return e.audio_msg.isRecording = !1, Promise.resolve(e)
    }

    function sn(e, t) {
        return t.voice_message_available = e, Promise.resolve(t)
    }

    function cn(e) {
        E({
            act: e ? "create" : null
        }), j()
    }

    function un() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null;
        E({
            q: e
        }), j()
    }

    function ln(e) {
        return void 0 === e.chatResizeInitialized && (e.chatResizeInitialized = !0, Object(u.getClassicChatHeight)() > window.clientHeight() && Object(u.setClassicChatHeight)(0)), Promise.resolve(e)
    }
    var dn = M(function(e, t, n) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_join_chat",
            chat_id: e,
            hash: t,
            write_hash: n.writeHash
        }).then(function(e) {
            var t = b(e, 4),
                r = t[0],
                i = t[1],
                o = t[2],
                a = t[3];
            return o.forEach(function(e) {
                return Object(p.oCacheAdd)(n, e)
            }), n.tabs[r] = i, J(n, i, !1, ne.bind(null, r), Ut.bind(null, n)), n.admins = extend(n.admins, a), [r]
        })
    });

    function fn(e, t) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_get_link",
            gid: t.gid,
            chat_id: e
        })
    }
    var pn = M(function(e, t) {
        var n = t.tabs[e];
        return Object(r.post)(r.CONTROLLER, {
            act: "a_reset_link",
            chat_id: e - 2e9,
            write_hash: t.writeHash
        }).then(function(e) {
            return n.inviteLink = e[0], e
        })
    });

    function mn(e) {
        return S({
            invite_chat_id: null,
            invite_hash: null
        }), e.invitation = void 0, Promise.resolve(e)
    }

    function gn(e, t) {
        var n = Object(s.arrayUnique)([e].concat(t.select(c.RECENT_SEARCH_OP))).slice(0, 500);
        t.update(c.RECENT_SEARCH_OP, n)
    }

    function hn(e) {
        e.update(c.RECENT_SEARCH_OP, [])
    }

    function _n(e, t) {
        var n = t.select(c.RECENT_SEARCH_OP).filter(function(t) {
            return t !== e
        });
        return t.update(c.RECENT_SEARCH_OP, n), n
    }

    function vn(e, t, n) {
        var r = n.tabs[t],
            i = Object(d.getMessage)(n, t, e);
        return r.data.kicked || r.data.closed || i.kludges.source_act || (r.pinned = i), Promise.resolve(n)
    }

    function bn(e, t) {
        return t.tabs[e].pinned = null, Promise.resolve(t)
    }
    var yn = M(function(e, t, n) {
            var i = n.tabs[t];
            return i.data.kicked || i.data.closed ? Promise.resolve(n) : Object(r.post)(r.CONTROLLER, {
                act: "a_pin_message",
                msgid: e,
                chat: t,
                gid: n.gid,
                hash: n.tabs[t].hash
            }).then(function(e) {
                var r = b(e, 1)[0];
                return n.tabs[t] = Object.assign({}, i, r), n
            })
        }),
        wn = M(function(e, t) {
            var n = t.tabs[e];
            return n.data.kicked || n.data.closed ? Promise.resolve(t) : Object(r.post)(r.CONTROLLER, {
                act: "a_unpin_message",
                chat: e,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(function(r) {
                var i = b(r, 1)[0];
                return t.tabs[e] = Object.assign({}, n, i), t
            })
        }),
        On = M(function(e, t) {
            var n = t.tabs[e];
            return Object(r.post)(r.CONTROLLER, {
                act: "a_get_pinned_message",
                chat: e,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(function(e) {
                var r = b(e, 1)[0];
                return n.pinned = r || null, t
            })
        }),
        Cn = M(function(e, t, n) {
            var i = n.tabs[e];
            return Object(r.post)(r.CONTROLLER, {
                act: "a_get_message_local_id",
                chat: e,
                chat_local_id: t,
                hash: i.hash
            })
        }),
        kn = M(function(e, t) {
            var n = t.tabs[e];
            return Object(r.post)(r.CONTROLLER, {
                act: "a_get_chat_details",
                chat: e,
                gid: t.gid,
                hash: n.hash
            }).then(function(e) {
                var r = b(e, 1)[0];
                return n.photoGrid = r.grid, n.photoLarge = r.photo, n.membersLastSeen = r.lastSeen || null, n.inviters = r.inviters, n.caccess = r.caccess, n.invitedByMe = r.invitedByMe || [], n.inviteLink = r.link || null, n.serverSettings = r.serverSettings || null, t
            })
        }),
        En = M(function(e, t, n) {
            var i = n.tabs[e];
            return Object(r.post)(r.CONTROLLER, {
                act: "a_update_flags",
                chat: e,
                hash: i.hash,
                flags: t
            })
        }),
        jn = M(function(e, t) {
            var n = t.tabs[e];
            return Object(r.post)("al_page.php", {
                act: "owner_photo_remove",
                oid: e,
                gid: t.gid,
                hash: n.photoHash
            }).then(function() {
                return n.photo = null, n.photoLarge = null, t
            })
        });

    function Sn(e, t, n) {
        var r = n.tabs[e];
        return r.memberIds = r.memberIds.filter(function(e) {
            return e !== t
        }), r.adminIds = r.adminIds.filter(function(e) {
            return e !== t
        }), r.membersCount = r.memberIds.length, Promise.resolve(n)
    }
    var Tn = M(function(e, t, n) {
        var i = n.tabs[e];
        return Object(r.post)(r.CONTROLLER, {
            act: "a_kick_user",
            chat: e,
            hash: i.hash,
            mid: t
        }).then(function() {
            return i.memberIds = i.memberIds.filter(function(e) {
                return e !== t
            }), i.adminIds = i.adminIds.filter(function(e) {
                return e !== t
            }), i.membersCount = i.memberIds.length, n
        })
    });

    function In(e, t, n, r) {
        var i = r.tabs[e];
        return i.adminIds = n ? [].concat(i.adminIds, t).filter(function(e, t, n) {
            return n.indexOf(e) === t
        }) : i.adminIds.filter(function(e) {
            return e !== t
        }), Promise.resolve(r)
    }
    var Pn = M(function(e, t, n, i) {
        var o = i.tabs[e];
        return Object(r.post)(r.CONTROLLER, {
            act: "a_toggle_admin",
            chat: e,
            hash: o.hash,
            mid: t,
            is_admin: +n
        }).then(function() {
            return In(e, t, n, i)
        })
    });

    function Mn(e, t, n, r) {
        var i = Object(d.getMessage)(e, n, t).userId;
        return Object(p.oCacheGet)(r, i) ? Promise.resolve(r) : dt(y({}, n, [i]), r)
    }

    function xn() {
        ajax.post("al_im.php", {
            act: "a_hide_promo_tooltip"
        })
    }

    function Ln() {
        cur.videoAutoplayScrollHandler && cur.videoAutoplayScrollHandler()
    }
    var An = M(function(e, t) {
            return t.tabs[e].top_banner = void 0, Object(r.post)(r.CONTROLLER, {
                act: "a_hide_banner",
                peer_id: e,
                hash: t.tabs[e].hash
            }).then(function() {
                return t
            })
        }),
        Nn = M(function(e, t, n) {
            n.tabs[e].top_banner = void 0;
            var i = n.tabs[e];
            return Object(r.post)(r.CONTROLLER, {
                act: "a_callback_banner",
                peer_id: e,
                callback_data: t,
                hash: i.hash
            }).then(function() {
                return n
            })
        });

    function Dn(e, t) {
        return Object(r.post)(r.CONTROLLER, {
            act: "a_load_banner",
            peer_id: e
        }).then(function(n) {
            var r = b(n, 1)[0];
            return t.tabs[e].top_banner = r, t
        })
    }

    function Rn(e, t, n) {
        return n.tabs[e].keyboard = t && t.buttons ? t : null, Bn(e, !1, !0, n)
    }

    function Fn(e, t) {
        return Rn(e, null, t)
    }

    function Bn(e, t, n, r) {
        return ((r.tabs || {})[e] || {}).keyboard && (r.tabs[e].keyboard.hide = t, n && ls.set("is_keyboards_hide", Object.assign(ls.get("is_keyboards_hide") || {}, y({}, e, t)))), Promise.resolve(r)
    }
    var Hn = M(function(e, t) {
        var n = t.tabs[e];
        return Object(r.post)(r.CONTROLLER, {
            act: "a_get_keyboard",
            peer_id: e,
            hash: n.hash
        }).then(function(n) {
            var r = b(n, 1)[0];
            return Rn(e, r, t)
        })
    });

    function Un(e, t, n, i) {
        var o = i.tabs[e];
        return o.caccess[t] = n, Object(r.post)(r.CONTROLLER, {
            act: "a_change_caccess",
            peer_id: e,
            member_id: t,
            hash: o.hash,
            access: n ? 1 : 0
        }).then(function() {
            return i
        }).catch(function(e) {
            throw o.caccess[t] = !n, e
        })
    }

    function zn(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e)) {
            var n = Object(d.getTab)(t, e);
            n.allShown = !1, n.lastReset = Date.now()
        }
        return t
    }
}, function(e, t, n) {
    var r = n(149),
        i = Math.max,
        o = Math.min;
    e.exports = function(e, t) {
        return (e = r(e)) < 0 ? i(e + t, 0) : o(e, t)
    }
}, function(e, t, n) {
    var r = n(61);
    e.exports = function(e, t, n) {
        for (var i in t) r(e, i, t[i], n);
        return e
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return c
    });
    var r = n(102),
        i = n(194),
        o = n(18),
        a = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        s = "_im_join_chat";

    function c(e, t) {
        var n = Object(i.createModule)({
            handlers: function(n, i) {
                i(e, "click", s, function(e) {
                    return function(e, t) {
                        var n = domData(t, "chat-id"),
                            i = domData(t, "hash");
                        return lockButton(t), Object(r.joinChat)(n, i, e.get()).then(function(n) {
                            var r = a(n, 1)[0];
                            unlockButton(t), e.get().longpoll.push([Object(o.changePeer)(r)])
                        }).catch(function(e) {
                            showFastBox(getLang("mail_join_invite_error_title"), e), unlockButton(t)
                        })
                    }(t, e.target)
                })
            }
        });
        return {
            unmount: function() {
                Object(i.destroyModule)(n)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    var r = n(55),
        i = {};
    i[n(68)("toStringTag")] = "z", i + "" != "[object z]" && n(61)(Object.prototype, "toString", function() {
        return "[object " + r(this) + "]"
    }, !0)
}, function(e, t) {
    e.exports = {}
}, function(e, t, n) {
    var r = n(55),
        i = n(68)("iterator"),
        o = n(107);
    e.exports = n(184).getIteratorMethod = function(e) {
        if (void 0 != e) return e[i] || e["@@iterator"] || o[r(e)]
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "decodeHTMLEntities", function() {
        return a
    });
    var r = {},
        i = window.getLang,
        o = window.langNumeric;

    function a(e) {
        return e.replace(/&#(\d+);/g, function(e, t) {
            return String.fromCodePoint(t)
        })
    }
    t.default = {
        getLang: function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
                n = arguments[2],
                s = "number" == typeof t,
                c = e + (t || s ? ".raw" : "");
            if (void 0 === r[c]) {
                var u = t || s ? i(e, "raw") : i(e);
                "string" == typeof u ? r[c] = a(u) : Array.isArray(u) && (r[c] = u.map(a))
            }
            return s ? o(t, r[c], n) : r[c] || ""
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return Ae
    });
    var r = n(102),
        i = n(54),
        o = n(148),
        a = n(7),
        s = n(26),
        c = n(94),
        u = n(194),
        l = n(192),
        d = n(97),
        f = n(42),
        p = n(193),
        m = n(123),
        g = n(21),
        h = n(160),
        _ = n(204),
        v = n(57),
        b = n(18),
        y = n(186),
        w = n(191),
        O = n(100),
        C = n(76),
        k = n(72),
        E = n(118),
        j = n(127),
        S = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        T = 1e3,
        I = -30,
        P = 30,
        M = 2e3,
        x = 700,
        L = 15,
        A = 47,
        N = "_im_cancel_fwd",
        D = "_im_to_end",
        R = "_im_failed_action",
        F = "_im_mess_link",
        B = "_im_admin_name",
        H = "_im_typer_c",
        U = "_im_error",
        z = "_im_join_cancel",
        G = "_im_retry_media",
        W = "im-audio-message_recorded",
        V = "im-audio-message_recording",
        K = "_im_mess_srv",
        q = "im_srv_mess_link",
        Q = "_chat_invitation",
        $ = "_im_mess",
        Y = !1,
        X = {};

    function Z(e) {
        var t = Object(o.getTab)(e, e.get().peer);
        return !!Object(o.getPinnedMessage)(e) || !!t.top_banner
    }

    function J(e, t) {
        var n = Object(a.unpackStore)(e),
            r = Object(o.getTab)(n, t);
        return Object(i.isChatPeer)(t) && Object(h.isPinnedMessageVisibleInTab)(n, t) || !!r.top_banner && !Object(o.isSearchShown)(t, n)
    }

    function ee(e, t) {
        return Object(i.getPinnedMessageHeight)()
    }

    function te(e, t) {
        var n = ge("page_header"),
            r = geByClass1("_im_chat_input_w", t),
            i = r.offsetHeight - r.clientHeight;
        return Math.min(window.clientHeight() - i, Math.max(Math.max(0, e), x + n.offsetHeight + t.offsetTop))
    }

    function ne(e, t) {
        return geByClass1("_im_mess_" + t, e)
    }

    function re(e) {
        hide(e.target)
    }

    function ie(e, t, n) {
        var i = Object(o.getTab)(t, n),
            a = Object(r.strHistory)(i.history);
        toggleClass(e, "im-page--history_empty-hist", !a)
    }

    function oe(e) {
        return geByClass1("_im_peer_history", e)
    }

    function ae(e, t) {
        var n = t.contHeight(),
            r = e.scrollTop + (n - e.contHeight);
        t.scrollTop(r)
    }

    function se(e, t, n, o, a, s, c, u) {
        var l = !(arguments.length > 8 && void 0 !== arguments[8]) || arguments[8],
            d = arguments.length > 9 && void 0 !== arguments[9] && arguments[9],
            f = (t.get().tabs || {})[n];
        a().hideError(), s.renderPeer(t), u.renderPeer(t);
        var p = geByClass1("_im_peer_history", e);
        if (!t.get().tabHistoryNotChanged) {
            val(geByClass1("_im_page_peer_name", e), f.tab);
            var m = Object(r.strHistory)(f.history);
            ie(e, t, n), m || (m = getLang("mail_im_here_history")), val(p, m), getAudioPlayer().isPlaying() && getAudioPlayer().updateCurrentPlaying(), Object(i.isClassicInterface)(t) || Object(i.fixTableCellChildHeight)("_chat_body_wrap", e), Ce(t, o, e)
        }
        if (Object(r.isSearchingInplace)(n, t.get()) ? a().showSearch(t) : a().cancelSearch(t, !1), c.changePeer(n, t), t.get().msgid) me(o, e, t.get().msgid, t);
        else if (f.scrollBottom && l) {
            ae(f, o);
            var g = Object(i.isMessagesVisible)(t, e, o),
                h = S(g, 1)[0];
            f.skipped || setTimeout(function() {
                f.unread && !h && ve(t, e, !0), le(t, o, e)
            }, 100)
        } else pe(o, e, a, t, d) || o.scrollBottom(I);
        window.LazyLoad && window.LazyLoad.scan(!!o.scroll && o.scroll.scroller)
    }

    function ue(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2] || t.scrollTop(),
            i = t.scrollBottom(),
            o = t.contHeight(),
            a = e.get().peer;
        e.set(r.saveHistoryScroll.bind(null, a, n, i, o))
    }

    function le(e, t, n) {
        var r = Object(o.isGoToEndVisible)(e),
            i = 4 * t.getScrollHeight();
        t.scrollBottom() > i && !r && ve(e, n, !0, 2 * t.getScrollHeight())
    }

    function de(e, t, n, a, s, u, l, d) {
        var f = !(arguments.length > 8 && void 0 !== arguments[8]) || arguments[8];
        if ((e.get().history_init || (e.get().history_init = !0, !(d.scrollTop() > 0))) && !c.screenfull.isFullscreen) {
            s.update(d), s.show();
            var p = e.get().peer;
            if (0 !== p && Object(i.isFullyLoadedTab)(e.get(), p) && (w.default.onHistoryScroll(d.scrollTop()), !layers.visible)) {
                var m = Object(o.isGoToEndVisible)(e),
                    g = Object(o.getTab)(e, p);
                g && !g.skipped && l < 0 ? le(e, d, u) : l > 0 && !g.skipped && !g.unread && Se(e, u), _e(e, d) && (m && g && !g.skipped && Se(e, u), g.unread > 0 && fe(e));
                var h = Object(i.wrapLoading)(n);
                if (!Object(r.isSearchingInplace)(p, e.get()) && f && a(d), !Y && (l < 0 || 0 === d.scrollBottom()) && d.scrollBottom() < T) {
                    if (Object(r.isSearchingInplace)(p, e.get())) return;
                    if (g.skipped > 0 && !e.get().no_moving_down) {
                        var _ = gpeByClass("_im_page_history", _),
                            v = e.get();
                        Y = !0;
                        var b = e.set(r.loadLessHistory).then(t().loadHistory.bind(null, v.peer, {
                            reversed: !0
                        })).then(function() {
                            fe(e), Y = !1, ve(e, _), g.skipped || e.set(r.changePeer.bind(null, e.get().peer, !1, !1))
                        });
                        return we(_, !0), void b.then(we.bind(null, _, !1))
                    }
                }
                if (!Y && d.scrollTop() < T) {
                    if (Object(r.isSearchingInplace)(p, e.get())) {
                        Y = !0;
                        var y = t().getSearchResulstModule();
                        return y.isAll(e) ? void(Y = !1) : void h(y.loadMore(e).then(function(n) {
                            Y = !1, n && (t().loadHistory(e.get().peer, {}, e, n), a(d))
                        }), "up")
                    }
                    var O = e.get();
                    g.allShown || (Y = !0, h(e.set(r.loadMoreHistory.bind(null, 0, 0)).then(t().loadHistory.bind(null, O.peer, {})).then(function() {
                        Y = !1, a(d)
                    }), "up"))
                }
                l < 0 && xe(e, p, d.scrollBottom(), u, t), Object(r.videoAutoPlayHandler)()
            }
        }
    }

    function fe(e) {
        if (!(window.curNotifier && curNotifier.idle_manager && curNotifier.idle_manager.is_idle)) return e.set(r.readLastMessages.bind(null, e.get().peer))
    }

    function pe(e, t, n, r, o) {
        var a = geByClass1("_im_unread_bar_row", t);
        if (a) {
            var s = r.get(),
                c = s.peer,
                u = a.getBoundingClientRect(),
                l = geByClass1("_im_chat_body_abs", t).getBoundingClientRect().top + 20;
            Object(i.isClassicInterface)(r) && (l += A + (J(s, c) ? ee() : 0));
            var d = e.scrollTop() - l + u.top;
            return e.scrollTop(d), ue(r, e, d), setTimeout(function() {
                c === r.get().peer && de(r, n, oe(t), function() {}, o, t, 0, e)
            }, 80), fe(r), !0
        }
        return !1
    }

    function me(e, t, n, r) {
        var o = ne(t, n);
        if (o) {
            var a = Object(i.isClassicInterface)(r),
                s = r.get().peer,
                c = a ? window.clientHeight() : geByClass1("_im_chat_body_abs", t).offsetHeight,
                u = o.offsetTop + domPN(o).offsetTop + domPN(domPN(o)).offsetTop + domPN(domPN(domPN(o))).offsetTop;
            a && J(r, s) && (u -= ee(r.get())), e.scrollTop(u - e.getScrollHeight() / 2 + c / 2), addClass(o, "im-mess_light"), setTimeout(function() {
                removeClass(o, "im-mess_light")
            }, M)
        }
    }

    function he(e, t, n) {
        n.updateLastSeen(e)
    }

    function _e(e, t) {
        return Object(o.getUnreadScrollBottom)(e) >= intval(t.scrollBottom())
    }

    function ve(e, t, n) {
        var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0,
            a = e.get().peer;
        if (!Object(i.isReservedPeer)(a)) {
            var s = e.get().tabs[a],
                c = geByClass1(D, t),
                u = geByClass1("_im_to_end_label", c);
            n && s.unread > 0 ? val(u, getLang("mail_im_new_messages", s.unread)) : val(u, getLang("mail_im_to_end_new"));
            var l = !1;
            (n || s.skipped > 0) && !Object(r.isSearchingInplace)(e.get().peer, e.get()) ? (l = !0, addClass(c, "im-to-end_shown")) : je(c, !0), e.set(r.updateGoToEndVisibility.bind(null, [l, intval(o)]))
        }
    }

    function be(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
        return (0 !== e.scrollTop() || 0 !== e.scrollBottom()) && e.scrollBottom() < (t ? P + t : P)
    }

    function ye(e, t, n) {
        cancelStackFilter("forward"), e.set(r.prepareForward.bind(null, null)).then(function() {
            t().changePeer(!1, e), removeClass(n, "im-page--history_fwd"), e.get().longpoll.push([Object(b.transitionEvent)("default")])
        })
    }

    function we(e, t) {
        var n = geByClass1(D, e);
        toggleClass(n, "im-to-end_loading", t)
    }

    function Oe(e, t, n, i) {
        if (!t.get().tabs[t.get().peer].skipped) return i.scrollBottom(I), ve(t, n), fe(t), void xe(t, t.get().peer, 0, n, e);
        we(n, !0), t.set(r.changePeer.bind(null, t.get().peer, !1, !1)).then(function() {
            return t.set(r.loadPeer.bind(null, t.get().peer, !0, -1, !1))
        }).then(function() {
            we(n, !1), e().changePeer(t, !1, !1), fe(t)
        })
    }

    function Ce(e, t, n) {
        var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
        if (Object(i.isClassicInterface)(e)) {
            var o = t.contHeight(),
                a = geByClass1("_im_chat_input_w", n),
                s = a.offsetHeight - a.clientHeight,
                c = geByClass1("_im_chat_resize", n),
                u = geByClass1("_im_chat_input_parent", n),
                l = geByClass1("_im_chat_audio_input_parent", n);
            if (!1 !== (r = !1 !== r ? r : Object(i.getClassicChatHeight)()) && r > 0) {
                var d = te(r, n),
                    f = d - (hasClass(l, V) || hasClass(l, W) ? l : u).offsetHeight;
                c.style.height = window.clientHeight() - d - s + "px", setStyle(a, {
                    top: f + "px",
                    bottom: "auto"
                })
            } else c.style.height = "0px", setStyle(a, {
                top: "auto",
                bottom: "0px"
            });
            var p = geByClass1("_im_peer_history_w", n);
            return setStyle(p, {
                borderBottomWidth: a.offsetHeight - L - 1
            }), t.contHeight() - o
        }
        Object(i.fixTableCellChildHeight)("_chat_body_wrap", n);
        var m = t.getScrollHeight();
        return t.update(!1, !0), m - t.getScrollHeight()
    }

    function ke(e, t, n, r) {
        var i = t.offsetHeight;
        r(), e.heightIncreased(t.offsetHeight - i, n)
    }

    function Ee(e, t) {
        var n = t.getBoundingClientRect().top;
        showTooltip(t, {
            className: "im-page--admin-tt",
            text: getLang("mail_only_admin_see"),
            appendParentCls: "_chat_body_wrap",
            shift: [20, 5],
            dir: "auto",
            showdt: 400,
            noZIndex: !0,
            toup: n > 200
        })
    }

    function je(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
        hasClass(e, "im-to-end_shown") && (t && addClass(e, "im-to-end_fast"), removeClass(e, "im-to-end_shown"), t && (e.offsetHeight, removeClass(e, "im-to-end_fast")))
    }

    function Se(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
            i = geByClass1(D, t);
        e.set(r.updateGoToEndVisibility.bind(null, [!1, 0])), je(i, n)
    }

    function Te(e) {
        var t = Object(o.getCurrentTab)(e);
        Object(i.isChatPeer)(t.peerId) && (t.pinHideId = cur.imDb.select(C.PIN_HIDDEN_ID_OP, t.peerId))
    }

    function Ie(e, t, n, r, i) {
        e.setState({
            isEditing: !1
        }), removeClass(r, "im-mess_is_editing"), removeClass(geByClass1("_im_page_history"), "is_msg_editing"), cancelStackFilter("cancel_edit"), n.setDraft(e, Object(o.getPeer)(e) ? Object(o.getTabDraft)(Object(o.getCurrentTab)(e)) : null), n.toggleStickers(e, !0), n.restoreKeyboard(), Me(t)
    }

    function Pe(e) {
        var t = geByClass1("im-mess_is_editing");
        if (!t) return null;
        var n = e.get().tabs[e.get().peer],
            r = Object(o.parserMessage)(n.msgs[domData(t, "msgid")]);
        return r && r.peerId == e.get().peer ? r : null
    }

    function Me(e) {
        Object(a.toArray)(geByClass("_im_history_tooltip", e)).forEach(hide)
    }

    function xe(e, t, n, i, a) {
        var s = Object(o.getTab)(e, t);
        if (!(Date.now() - (s.lastReset || 0) < 1e3) && (s && s.msgs && s.history && !Y && s.offset > 300 && 0 == s.skipped && n < 50 && n >= 0 && 0 === (e.get().selectedMessages || []).length)) {
            var c = Object.keys(s.msgs).filter(function(e) {
                    return e > 0
                }).sort(function(e, t) {
                    return e - t
                }).slice(0, -50),
                u = c.slice(-1)[0];
            e.mutate(r.resetTabAll.bind(null, t)), e.set(r.removeMessages.bind(null, c, t)).then(function() {
                return a().removeStartingFromMessage(u, t, e)
            })
        }
    }

    function Le(e, t, n, a, c, l, d, f, m, g, h, _, v, w, O, C) {
        var j = void 0,
            T = throttle(function() {
                n.smoothScroll.apply(n, arguments)
            }, 300);
        return {
            fixKeyboard: function() {
                c.fixKeyboard()
            },
            changePeer: function(e) {
                var s = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],
                    u = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2];
                if (0 === e.get().peer && O.disable(), revertLastInlineVideo(t), 0 === e.get().peer) return c.setDraft(e, null),
                    function(e) {
                        addClass(e, "im-page--history_empty"), oe(e).innerHTML = ""
                    }(t);
                if (Object(i.isFullyLoadedTab)(e.get(), e.get().peer)) {
                    removeClass(t, "im-page--history_search"), e.set(r.dropSelection), a.changeActions(e);
                    var d = e.get().peer,
                        p = e.get().prevPeer;
                    removeClass(t, "im-page--history_loading"), toggleClass(t, "im-page--history_vkcomgroup", Object(i.isFvkcomgroup)(e, d)), s ? c.setDraft(e, Object(o.getTabDraft)(Object(o.getCurrentTab)(e))) : c.updateState(e), ve(e, t), l().updateTyping(d, e), O.toggle(!0), he(e, 0, a), Object(i.isReservedPeer)(p) && !Object(i.isReservedPeer)(d) ? (! function(e, t, n, r, i, o, a, s, c, u) {
                        removeClass(e, "im-page--history_empty"), se(e, t, n, r, i, o, a, s, c, u)
                    }(t, e, d, n, l, a, f, C, u, O), O.reset(n)) : Object(i.isReservedPeer)(p) || Object(i.isReservedPeer)(d) || (se(t, e, d, n, l, a, f, C, u, O), O.reset(n)), Object(i.isReservedPeer)(d) || de(e, l, oe(t), v, O, t, 0, n), Object(i.ensureDomHasActions)(t)
                }
            },
            preparePeer: function(e) {
                var n = Object(o.getPeer)(e);
                Te(e), c.setDraft(e, Object(o.getTabDraft)(Object(o.getTab)(e, n))), l().updateTyping(n, e), l().hideError(), a.renderPeer(e), C.renderPeer(e), a.hideActions(e), f.changePeer(n, e), he(e, 0, a), O.toggle(!1), Se(e, t, !0)
            },
            saveScroll: function(e) {
                return ue(e, n)
            },
            loadingPeer: function(e) {
                Object(r.isAnythingLoading)(e.get()) || (removeClass(t, "im-page--history_empty"), addClass(t, "im-page--history_loading"))
            },
            stopLoading: function(e) {
                removeClass(t, "im-page--history_loading")
            },
            deselectDialog: function(e) {
                d().removeSelection(e)
            },
            replaceMessageAttrs: function(e, n) {
                Object(i.replaceMessageAttrs)(n.get(), oe(t), e)
            },
            cleanSelection: function(e) {
                g.cleanSelection(e)
            },
            updateDialogFilters: function(e) {
                d().updateDialogFilters(e)
            },
            getSearchResulstModule: function() {
                return j
            },
            insertSearch: function(e, r) {
                j || (a.deselectAll(r), j = Object(p.mount)(t, r, l)), addClass(t, "im-page--history_search"), e ? (removeClass(t, "im-page--history_search-empty"), oe(t).innerHTML = e) : (addClass(t, "im-page--history_search-empty"), oe(t).innerHTML = Object(i.renderEmptySearch)()), Ce(r, n, t), n.scrollBottom(0), ve(r, t), O.reset(n)
            },
            updateChatTopic: function(e, t) {
                d().updateDialog(e, t), e === t.get().peer && (a.renderPeer(t), a.renderActions(t), C.renderPeer(t))
            },
            updateActions: function(e) {
                a.changeActions(e)
            },
            updateChatPhoto: function(e, r, o) {
                if (Object(i.isPeerActive)(e.peerId, o.get())) {
                    a.renderPeer(o), C.renderPeer(o);
                    var s = be(n);
                    Object(i.addChatPhotoToUpdate)(e, r, o.get(), oe(t)), s && n.scrollBottom(I)
                }
            },
            markImportant: function(e, n, r) {
                ne(t, e) && (a.changedMessageSelection(r), m.markImportant(e, n, r))
            },
            isNewMessagesVisible: function(e) {
                return _e(e, n)
            },
            loadHistory: function(e, r, o) {
                var a = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                    s = o.get();
                if (Object(i.isPeerActive)(e, s)) {
                    var c = a || s.tabs[e].historyToAppend;
                    if (!c) return;
                    var u = geByClass1("_im_peer_history", t),
                        l = domFC(u),
                        d = n.scrollBottom(),
                        f = r.reversed ? function(e) {
                            return u.appendChild(e)
                        } : function(e) {
                            return u.insertBefore(e, l)
                        },
                        p = 0;
                    r.reversed && (p = u.offsetHeight);
                    var m = sech(c),
                        g = document.createDocumentFragment();
                    m.forEach(function(e) {
                        return g.appendChild(e)
                    }), f(g), r.reversed && O.heightIncreased(u.offsetHeight - p, n), r.reversed || n.scrollBottomFixSave(d), n.update(!1, !0);
                    var h = m.filter(function(e) {
                        return hasClass(e, "_im_bar_date")
                    });
                    O.parseMore(h, n), Object(i.ensureDomHasActions)(t)
                }
            },
            sendMessage: function(e) {
                0 !== e.get().peer && c.sendMessage()
            },
            editMessage: function(e, r) {
                if (Object(i.isFullyLoadedTab)(e, r.peerId) && Object(i.isPeerActive)(r.peerId, e.get())) {
                    if (!ne(t, r.messageId)) return;
                    ue(e, n), Object(i.editAndReplaceMessage)(e.get(), r, t), ae(Object(o.getTab)(e, r.peerId), n), a.reRenderPinned(e), O.reset(n)
                }
            },
            addMessage: function(e, a) {
                if (!Object(r.isSearchingInplace)(a.peerId, e.get()) && Object(i.isFullyLoadedTab)(e, a.peerId) && Object(i.isPeerActive)(a.peerId, e.get())) {
                    if (ne(t, a.messageId)) return;
                    var c = oe(t);
                    ke(O, c, n, function() {
                        var r = be(n),
                            u = geByClass1("_im_unread_bar_row", t),
                            d = Object(i.isMessagesVisible)(e, t, n),
                            f = S(d, 2),
                            p = f[0],
                            m = f[1];
                        Object(i.appendToHistory)(e.get(), a, c, !0, !0, !p && !u), removeClass(t, "im-page--history_empty-hist");
                        var g = Object(o.getTab)(e, e.get().peer),
                            h = Object(s.isServiceMsg)(a) && a.userId === vk.id,
                            _ = a.kludges && a.kludges.source_act,
                            v = h && _ !== i.CHAT_PIN_MESSAGE && _ !== i.CHAT_UNPIN_MESSAGE;
                        g.skipped || p || !Object(s.isUnread)(g, a) || Object(s.isOut)(a) || ve(e, t, !0, m), (a.local || r || v) && n.scrollBottom(0), l().updateTyping(a.peerId, e), Me(t)
                    });
                    var u = domPS(domLC(c));
                    if (hasClass(u, "_im_bar_date")) {
                        var d = ce("div");
                        d.innerHTML = u.outerHTML, O.parseMore(d, n)
                    }
                    l().hideError(), O.update(n), Object(r.updateMentions)(e.get()), xe(e, a.peerId, n.scrollBottom(), 0, l)
                }
            },
            setMessageErrored: function(e, n, r, o) {
                r && l().showError(r), Object(i.setMessageError)(e, n, t)
            },
            markMessagesAsRead: function(e, n) {
                e.get().peer === n.peerId && Object(i.markMessagesAsRead)(e.get(), n.peerId, t)
            },
            compensateHistoryHeightChange: function(e) {
                n.scrollTop(n.scrollTop() + e * ee(_.get(), _.get().peer))
            },
            hideFwd: function(e) {
                removeClass(t, "im-page--history_fwd")
            },
            updateTyping: function(e, n) {
                if (!Object(r.isSearchingInplace)(e, n.get())) {
                    var o = n.get();
                    if (n.get().peer === e && Object(i.isFullyLoadedTab)(o, e)) {
                        var a = Object(i.formatTyper)(n.get().tabs[e].typing, e, !1, n.get()),
                            s = geByClass1(i.TYPING_CLASS, t);
                        if (s || a) {
                            if (!s) {
                                var c = geByClass1(H, t);
                                val(c, getTemplate("im_typing", {
                                    cls: Object(i.isClassicInterface)(n) ? "im-typing_classic" : ""
                                })), s = geByClass1(i.TYPING_CLASS, t)
                            }
                            val(geByClass1("_im_typing_name", s), a), a ? (addClass(s, "im-page--typing_vis"), l().hideError()) : removeClass(s, "im-page--typing_vis")
                        }
                    }
                }
            },
            scrollFix: function(e, t, r) {
                O.heightIncreased(r, n), O.update(n), Object(i.isPeerActive)(t, e.get()) && be(n, r) && n.scrollBottom(I)
            },
            goToEnd: function() {
                var e = this;
                Oe(function() {
                    return e
                }, _, t, n)
            },
            updateGoToEnd: function(e, r) {
                var i = Object(o.getTab)(e, e.get().peer);
                i && i.skipped ? ve(e, t) : Se(e, t, r), h(0, n, !1);
                var a = e.get().peer;
                setTimeout(function() {
                    e.get().peer === a && ue(e, n)
                })
            },
            newMessage: function(e) {
                d().newMessage(e), Se(e, t, !0)
            },
            scroll: function(e, t) {
                var r = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                    i = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
                if (0 !== e.get().peer) {
                    var o = r ? n.getScrollHeight() : 40;
                    !0 === i && (o = n.contHeight()), o = "up" === t ? -o : o, r || i ? T(o, function() {
                        h(o, n)
                    }) : (n.scrollTop(n.scrollTop() + o), h(o, n))
                }
            },
            showCreation: function(e, t) {
                d().showCreation(e, t)
            },
            updateScroll: function() {
                return Ce(_, n, t)
            },
            toggleBarDate: function(e) {
                O.toggle(e)
            },
            changedMessageSelection: function(e) {
                a.changedMessageSelection(e)
            },
            updateOnline: function(e, t) {
                Object(i.isTabLoaded)(t.get(), e) && e === t.get().peer && a.renderPeer(t)
            },
            isEmpty: function(e) {
                return c.isEmpty(e)
            },
            replaceAttachmentPlaceholders: function(e, r) {
                if (Object(i.isPeerActive)(r.peerId, e.get())) ke(O, oe(t), n, function() {
                    var s = be(n);
                    Object(i.replaceAttaches)(t, r, e.get());
                    var c = Object(o.getTab)(e, r.peerId);
                    if (c.mediacontent[r.messageId].length >= 3 && c.mediacontent[r.messageId][2].pinned) {
                        var u = Object(o.parserMessage)(c.pinned);
                        u && u.messageId == r.messageId && (c.pinned = c.mediacontent[r.messageId][2].pinned, a.reRenderPinned(e))
                    }
                    s && n.scrollBottom(0)
                }), O.update(n);
                else if (Object(s.isMoneyRequest)(r)) {
                    var c = Object(o.getTab)(e, r.peerId);
                    if (c.mediacontent[r.messageId].length >= 3 && c.mediacontent[r.messageId][2].pinned) {
                        var u = Object(o.parserMessage)(c.pinned);
                        u && u.messageId == r.messageId && (c.pinned = c.mediacontent[r.messageId][2].pinned)
                    }
                }
            },
            removeMessages: function(e, r, o) {
                o.get().peer === r && (Object(i.removeMessages)(e, oe(t)), Ce(o, n, t), a.changedMessageSelection(o))
            },
            removeStartingFromMessage: function(e, r, o) {
                if (o.get().peer === r) {
                    var s = oe(t),
                        c = geByClass1("_im_mess_" + e, s);
                    Object(i.removeStartingFromMessage)(c, s), Ce(o, n, t), a.changedMessageSelection(o)
                }
            },
            hideGoToEnd: function(e) {
                Se(_, t, e)
            },
            removeMessagesRestore: function(e, n, r, o) {
                o.get().peer === n && Object(i.removeMessagesWithRestore)(e, n, r, oe(t))
            },
            updateState: function(e, t) {
                d().updateState(e, t)
            },
            updateBanner: function(e) {
                C.renderPeer(e)
            },
            updateChat: function(e, t) {
                e.get().peer === t && (a.changeActions(e), a.renderPeer(e), a.renderActions(e), C.renderPeer(e), c.updateState(e), Object(r.updateMentions)(e.get()))
            },
            focustTxt: function(e) {
                c.focusOn(e)
            },
            startSearch: function(e) {
                l().showSearch(e), f.changePeer(e.get().peer, e), f.search()
            },
            showSearch: function(e) {
                addClass(t, "im-page--hisory_search-open"), e.setState({
                    searchShown: !0
                }), Z(e) && this.updateChatTopic(e.get().peer, e), this.cancelEditing(), setTimeout(function() {
                    return f.focus(e)
                }, 10)
            },
            cancelSearch: function(e) {
                var o = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                if (e.get().searchShown && (removeClass(t, "im-page--hisory_search-open"), removeClass(t, "im-page--history_search"), removeClass(t, "im-page--history_search-empty"), e.setState({
                        searchShown: !1
                    }), Z(e) && this.updateChatTopic(e.get().peer, e), a.changedMessageSelection(e)), o && !Object(i.isReservedPeer)(e.get().peer) && j) {
                    var s = e.get().tabs[e.get().peer];
                    oe(t).innerHTML = Object(r.strHistory)(s.history), Ce(e, n, t), n.scrollBottom(0), e.get().msgid && (me(n, t, e.get().msgid, e), ve(e, t)), v(n), O.reset(n)
                }
                j && (j.unmount(), j = !1, Object(i.ensureDomHasActions)(t))
            },
            updateHistory: function(e) {
                0 !== _.get().peer && e(t)
            },
            focusOnMessage: function() {
                me(n, t, _.get().msgid, _)
            },
            sendEditMessage: function(e, t) {
                e.set(r.deliverEditedMessage.bind(null, Object(o.getTab)(e, t.peerId), t)).catch(function(n) {
                    return e.get().longpoll.push([Object(b.failedMessage)(t.peerId, t, n)])
                })
            },
            unmount: function() {
                Object(u.destroyModule)(e), n.destroy(), clearInterval(w), c.unmount(), a.unmount(), m.unmount(), g.unmount(), f.unmount(), cancelStackFilter("forward"),
                    function(e, t) {
                        Object(y.removeDraggable)(geByClass1(e, t))
                    }("_im_chat_resize_track", t)
            },
            removePeer: function(e, t) {
                d().removePeer(e, t)
            },
            restoreScroll: function(e, t) {
                var r = e.get().tabs[t];
                r.scrollBottom ? ae(r, n) : n.scrollBottom(I)
            },
            resendMessage: function(e, n) {
                e === _.get().peer && Object(i.startResendMessage)(e, n, t)
            },
            respond: function(e, t) {
                c.attachMessages(e, t), c.focusOn(e);
                var r = Object(o.getTab)(e, t);
                r && !r.skipped && (n.scrollBottom(I), v(n))
            },
            startForward: function(e) {
                addClass(t, "im-page--history_fwd"), geByClass1("_im_explain_fwd", t).textContent = getLang("mail_explain_fwd", e.get().pendingForward.msgIds.length), d().cancelSearch(e), d().removeSelection(e), cancelStackPush("forward", function() {
                    return ye(e, d, t)
                })
            },
            cancelRecording: function() {
                c.cancelRecording()
            },
            hideError: function() {
                hide(geByClass1(U, t))
            },
            showError: function(e) {
                geByClass1(U, t).innerHTML = e, show(geByClass1(U, t)), n.scrollBottom(I)
            },
            startEditing: function(e) {
                if (Object(r.isAnythingLoading)(_.get())) Object(i.showWaitUntilUploadedBox)();
                else {
                    e = Object(o.parserMessage)(e);
                    var n = Pe(_);
                    if (!(c.isBlocked() || n && n.messageId == e.messageId)) {
                        n && this.cancelEditing(), Me(t), _.get().searchShown && this.cancelSearch(_);
                        var s = ne(t, e.messageId);
                        s && (this.cancelRecording(), function(e, t, n, r, i) {
                            e.setState({
                                isEditing: !0
                            }), n.saveText(e), addClass(r, "im-mess_is_editing"), addClass(geByClass1("_im_page_history"), "is_msg_editing"), cancelStackPush("cancel_edit", function() {
                                return Ie(e, t, n, r)
                            });
                            var o = new E.ImDraft;
                            o.dData.txt = Object(k.convertEmojiHtmlToRegularText)(i.text), o.dData.attaches = Object(E.convertKludgesToAttaches)(i.kludges, i.messageId), n.toggleStickers(e, !1), n.setDraft(e, o), setTimeout(function() {
                                return n.focusOn(e)
                            }, 0)
                        }(_, t, c, s, e), c.hideKeyboard(), a.deselectAll(_))
                    }
                }
            },
            cancelEditing: function() {
                var e = Pe(_);
                e && Ie(_, t, c, ne(t, e.messageId))
            },
            getEditingMessage: function() {
                return Pe(_)
            },
            focusEditingMessage: function() {
                var e = Pe(_);
                e && me(n, t, e.messageId, _), c.focusOn(_)
            }
        }
    }

    function Ae(e, t, n) {
        var p = geByClass1("_im_peer_history_w", e);
        show(p), hasAccessibilityMode() && addClass(p, "history_a11y");
        var w, C, k, E = Object(u.createMutations)(Le),
            T = E.callMutations,
            P = E.bindMutations,
            M = (w = ue.bind(null, t), C = debounce(w, 100), k = throttle(w, 100), function(e) {
                C(e), k(e)
            }),
            x = Object(v.mount)(t, e),
            L = de.bind(null, t, T, p, M, x, e),
            A = Object(_.createScroll)(geByClass1("_im_chat_body_abs", e), {
                onScroll: L,
                nativeScroll: Object(i.isClassicInterface)(t),
                shadows: !1
            });
        setTimeout(function() {
            t.get().peer && (Te(t), (Object(o.getCurrentTab)(t).pinned || Object(o.getCurrentTab)(t).top_banner) && (T().updateChatTopic(t.get().peer, t), t.set(r.setActions), H.changeActions(t)), t.get().msgid ? me(A, e, t.get().msgid, t) : pe(A, e, T, t, x) || A.scrollBottom(I), t.get().history_init = !1, x.reset(A), ve(t, e), de(t, T, p, M, x, e, 0, A), Object(i.ensureDomHasActions)(e), nav.objLoc.st && (t.mutate(r.setInplaceSearch.bind(null, nav.objLoc.st, t.get().peer)), T().startSearch(t)))
        }, 15);
        var H = Object(l.mount)(geByClass1("_im_dialog_actions", e), t, T),
            W = Object(d.mount)(geByClass1("_im_text_input", e), t, T),
            V = Object(f.mount)(geByClass1("_im_dialog_actions", e), t, T),
            Y = Object(m.mount)(e, t, T),
            Z = Object(g.mount)(e, t, function() {
                return {
                    changedMessageSelection: H.changedMessageSelection
                }
            });
        Object(h.mount)(e, t, T);
        var J = Object(j.mount)(e, t, function() {
            return {
                hidePinned: function() {
                    Object(h.pinnedMessageHide)(t, t.get().peer, T, !1)
                },
                compensateHistoryHeightChange: function(e) {
                    T().compensateHistoryHeightChange(e)
                },
                showPinned: function() {
                    Object(h.pinnedMessageUnHide)(t, t.get().peer, T, !1)
                }
            }
        });
        Object(i.isReservedPeer)(t.get().peer) || t.set(r.restoreHistoryQueue.bind(null, t.get().peer)).then(function() {
                Object(i.restoreQueue)(t.get().peer, t.get(), oe(e)), ie(e, t, t.get().peer)
            }),
            function(e, t, n) {
                var r = geByClass1(e, t),
                    o = void 0,
                    a = void 0;
                Object(y.initDraggable)(r, {
                    onStartDrag: function(e, t) {
                        addClass(bodyNode, "cursor_ns_resize"), o = t, a = t
                    },
                    onDrop: function() {
                        removeClass(bodyNode, "cursor_ns_resize")
                    },
                    onDrag: function(e, r) {
                        var s = te(a - o + r, t);
                        Object(i.setClassicChatHeight)(s), n().fixHeight()
                    }
                })
            }("_im_chat_resize_track", e, n);
        var ee = function(e, t, n, r, i) {
                var a = domData(i, "msgid"),
                    s = e.get().peer,
                    c = Object(o.getMessage)(e, s, a);
                c.type === b.EDIT_MESSAGE ? (n().sendEditMessage(e, c), n().resendMessage(s, a)) : e.get().imQueueResend(s, a).then(function(t) {
                    e.get().longpoll.push([Object(b.resendEvent)(s, t.mess)])
                })
            }.bind(null, t, e, T),
            ae = function(e, t, n, o, a) {
                var s = intval(domData(a, "peer")),
                    c = intval(domData(gpeByClass("_im_mess", a), "msgid")),
                    u = e.get().tabs[s].hash;
                return Object(r.restoreMessageSend)(c, s, u, e.get().gid), e.set(r.restoreMessage.bind(null, c, s)).then(i.restoreMessage.bind(null, c, s, oe(t))).then(function() {
                    return Ce(e, n, t)
                }), !1
            }.bind(null, t, e, A),
            se = ye.bind(null, t, n, e),
            ce = function(e, t) {
                e().showCreation(t)
            }.bind(null, n, t),
            le = Oe.bind(null, T, t, e, A),
            fe = function(e, t, n, r) {
                if (hasClass(n.target, "_im_mess_marker")) {
                    var o = n.target;
                    window.tooltips && Object(a.toArray)(geByClass(i.FAILED_CLASS, t)).map(function(e) {
                        return geByClass1("_im_mess_marker", e)
                    }).filter(function(e) {
                        return e !== o
                    }).forEach(function(e) {
                        return tooltips.hide(e, {
                            fasthide: !0
                        })
                    });
                    var s = domData(r, "msgid");
                    showTooltip(o, {
                        content: getTemplate("im_failed_menu", {
                            id: s
                        }),
                        className: "im-page--failed-tt" + (s > 0 ? " no_delete" : ""),
                        appendParentCls: "_chat_body_wrap",
                        dir: "down",
                        noZIndex: !0,
                        shift: [12, 8],
                        hasover: !0
                    })
                }
            }.bind(null, t, e),
            ge = i.showEditTimeTooltip.bind(null, t),
            _e = function(e, t, n, o, a) {
                var s = domData(a, "action"),
                    c = domData(a, "msgid"),
                    u = geByClass1("_im_mess_marker", ne(n, c));
                switch (s) {
                    case "resend":
                        t(o, a);
                        break;
                    case "delete":
                        e.set(r.removeFailed.bind(null, e.get().peer, c)).then(function() {
                            Object(i.removeMessages)([c], oe(n))
                        })
                }
                tooltips.hide(u, {
                    fasthide: !0
                })
            }.bind(null, t, ee, e),
            be = i.showChatMembers.bind(null, t, T, r.setCreationType),
            we = function(e, t, n, i, o) {
                if (checkEvent(i)) return !0;
                var a = q2ajx(o.getAttribute("href")),
                    s = intval(a.msgid);
                s && e.set(r.changePeer.bind(null, e.get().peer, s)).then(function() {
                    me(n, t, s, e)
                }), cancelEvent(i)
            }.bind(null, t, e, A),
            ke = function(e, t, n) {
                c.screenfull.isFullscreen || 0 === t.get().peer || Object(i.isClassicInterface)(t) || e().restoreScroll(t, t.get().peer)
            }.bind(null, T, t, A),
            je = function(e, t) {
                var n = e.get(),
                    a = n.peer,
                    c = domClosest(K, t.target),
                    u = intval(domData(c, "msgid")),
                    l = Object(o.getMessage)(e, a, u),
                    d = l && Object(s.isServiceMsg)(l) && l.kludges.source_act;
                if (d === i.CHAT_PIN_MESSAGE || d === i.CHAT_UNPIN_MESSAGE) {
                    var f = c.querySelector("." + q);
                    if (f && "A" !== f.tagName) {
                        var p = l.kludges.source_chat_local_id;
                        if (!p || X[p]) return;
                        X[p] = Object(r.getMessageLocalId)(a, p, n).then(function(e) {
                            var t = S(e, 1)[0];
                            if (t) {
                                var n = "/im?sel=" + Object(i.convertPeerToUrl)(a) + "&msgid=" + t,
                                    r = f.innerHTML;
                                domReplaceEl(f, Object(i.serviceLink)(n, r, !0, q)), delete X[p]
                            }
                        })
                    }
                }
            }.bind(null, t),
            Se = function(e, t, n) {
                var r = e.get(),
                    a = r.peer,
                    s = n.target.href && n.target.href.match(/msgid=([\d]+)/),
                    c = s && s[1];
                "A" !== n.target.tagName || !c || Object(i.isAlreadyDeleted)(e, a, c) || checkEvent(n) || (Object(o.getMessage)(e, a, c) ? (e.setState({
                    msgid: c
                }), Object(O.updateLocation)({
                    msgid: c
                }), t().focusOnMessage()) : r.longpoll.push([Object(b.changePeer)(a, c)])), cancelEvent(n)
            }.bind(null, t, T),
            Ie = Object(u.createModule)({
                handlers: function(n, a) {
                    a(e, "click", i.RESTORE_CLASS, ae), a(e, "mouseover click", i.FAILED_CLASS, fe), a(e, "mouseover", "_im_edit_time", ge), a(e, "click", "_im_mess_susp", function(e, t) {
                        var n = intval(domData(t.target, "msgid")),
                            r = gpeByClass("_im_mess_" + n, t.target),
                            i = geByClass1("_im_log_body", r),
                            o = geByClass1("_im_mess_susp_cont", r);
                        i.innerHTML = o.innerHTML
                    }.bind(null, e)), a(e, "click", N, se), a(e, "click", R, _e), a(e, "click", i.SHOW_CHAT_MEMBERS_CLASS, be), a(e, "click", F, we), a(e, "mouseover", B, Ee), a(e, "mouseover", K, je), a(e, "click", q, Se), a(e, "click", U, re), a(e, "click", Q, function(e, n) {
                        if (checkEvent(e)) return !0;
                        if (!gpeByClass("wall_postlink_preview_btn", e.target) && !hasClass(e.target, "wall_postlink_preview_btn")) return !0;
                        var o = geByClass1("flat_button", n),
                            a = {
                                invite_chat_id: domData(o, "inv-id"),
                                invite_hash: domData(o, "hash")
                            };
                        Object(i.showInvitationBox)(t, a, r.leaveInvitation), cancelEvent(e)
                    }), a(e, "click", z, function() {
                        return t.get().longpoll.push([Object(b.resetPeer)()])
                    }), a(e, "click", G, function(e) {
                        return function(e, t, n) {
                            var a = e.get(),
                                s = domClosest($, n.target),
                                c = domData(s, "msgid"),
                                u = Object(o.getMessage)(a, a.peer, c),
                                l = function(e) {
                                    return t().replaceAttachmentPlaceholders(e, u)
                                };
                            u && (e.set(r.addAttachmentsToStoreData.bind(null, u, [Object(i.renderMessageMedia)(u)])).then(l), e.set(r.loadMedia.bind(null, u)).then(l))
                        }(t, T, e)
                    }), n(geByClass1("_im_peer_history_w", e), "mousemove", x.show), n(geByClass1("_im_start_new", e), "click", ce), n(geByClass1(D, e), "click", le), n(geByClass1("_im_cancel_edit", e), "click", function() {
                        return T().cancelEditing(), !1
                    }), n(geByClass1("_im_edit_focus_cur", e), "click", function() {
                        return T().focusEditingMessage(), !1
                    }), c.screenfull.raw && n(document, c.screenfull.raw.fullscreenchange, ke)
                }
            });
        curNotifier.recvClbks.pin_hide = [function(e) {
            e.hide ? Object(h.pinnedMessageHide)(t, e.peer, T, !1) : Object(h.pinnedMessageUnHide)(t, e.peer, T, !1)
        }], window.showForwardBox = function(e) {
            return function(e, t) {
                Object(i.boxHandleEditTimeTooltips)(showBox("al_im.php", t, {
                    dark: 1
                }), e)
            }(t, e)
        };
        var Pe = setInterval(he.bind(null, t, e, H), 1e4);
        return P(Ie, e, A, H, W, T, n, V, Y, Z, L, t, M, Pe, x, J)
    }
}, function(e, t, n) {
    (function(r, i) {
        var o;
        (function() {
            "use strict";

            function a(e) {
                return "function" == typeof e
            }
            var s, c, u = Array.isArray ? Array.isArray : function(e) {
                    return "[object Array]" === Object.prototype.toString.call(e)
                },
                l = 0,
                d = function(e, t) {
                    C[l] = e, C[l + 1] = t, 2 === (l += 2) && (c ? c(k) : v())
                };
            var f = "undefined" != typeof window ? window : void 0,
                p = f || {},
                m = p.MutationObserver || p.WebKitMutationObserver,
                g = void 0 !== r && "[object process]" === {}.toString.call(r),
                h = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel;

            function _() {
                return function() {
                    setTimeout(k, 1)
                }
            }
            var v, b, y, w, O, C = new Array(1e3);

            function k() {
                for (var e = 0; e < l; e += 2) {
                    (0, C[e])(C[e + 1]), C[e] = void 0, C[e + 1] = void 0
                }
                l = 0
            }
            g ? v = function() {
                r.nextTick(k)
            } : m ? (y = 0, w = new m(k), O = document.createTextNode(""), w.observe(O, {
                characterData: !0
            }), v = function() {
                O.data = y = ++y % 2
            }) : h ? ((b = new MessageChannel).port1.onmessage = k, v = function() {
                b.port2.postMessage(0)
            }) : v = void 0 === f ? function() {
                try {
                    var e = n(168);
                    return s = e.runOnLoop || e.runOnContext,
                        function() {
                            s(k)
                        }
                } catch (e) {
                    return _()
                }
            }() : _();
            var E = function(e, t) {
                var n = this._state;
                if (n === I && !e || n === P && !t) return this;
                var r = new this.constructor(S),
                    i = this._result;
                if (n) {
                    var o = arguments[n - 1];
                    d(function() {
                        z(n, r, o, i)
                    })
                } else F(this, r, e, t);
                return r
            };
            var j = function(e) {
                if (e && "object" == typeof e && e.constructor === this) return e;
                var t = new this(S);
                return A(t, e), t
            };

            function S() {}
            var T = void 0,
                I = 1,
                P = 2,
                M = new H;

            function x(e) {
                try {
                    return e.then
                } catch (e) {
                    return M.error = e, M
                }
            }

            function L(e, t, n) {
                t.constructor === e.constructor && n === E && constructor.resolve === j ? function(e, t) {
                    t._state === I ? D(e, t._result) : t._state === P ? R(e, t._result) : F(t, void 0, function(t) {
                        A(e, t)
                    }, function(t) {
                        R(e, t)
                    })
                }(e, t) : n === M ? R(e, M.error) : void 0 === n ? D(e, t) : a(n) ? function(e, t, n) {
                    d(function(e) {
                        var r = !1,
                            i = function(e, t, n, r) {
                                try {
                                    e.call(t, n, r)
                                } catch (e) {
                                    return e
                                }
                            }(n, t, function(n) {
                                r || (r = !0, t !== n ? A(e, n) : D(e, n))
                            }, function(t) {
                                r || (r = !0, R(e, t))
                            }, e._label);
                        !r && i && (r = !0, R(e, i))
                    }, e)
                }(e, t, n) : D(e, t)
            }

            function A(e, t) {
                var n;
                e === t ? R(e, new TypeError("You cannot resolve a promise with itself")) : "function" == typeof(n = t) || "object" == typeof n && null !== n ? L(e, t, x(t)) : D(e, t)
            }

            function N(e) {
                e._onerror && e._onerror(e._result), B(e)
            }

            function D(e, t) {
                e._state === T && (e._result = t, e._state = I, 0 !== e._subscribers.length && d(B, e))
            }

            function R(e, t) {
                e._state === T && (e._state = P, e._result = t, d(N, e))
            }

            function F(e, t, n, r) {
                var i = e._subscribers,
                    o = i.length;
                e._onerror = null, i[o] = t, i[o + I] = n, i[o + P] = r, 0 === o && e._state && d(B, e)
            }

            function B(e) {
                var t = e._subscribers,
                    n = e._state;
                if (0 !== t.length) {
                    for (var r, i, o = e._result, a = 0; a < t.length; a += 3) r = t[a], i = t[a + n], r ? z(n, r, i, o) : i(o);
                    e._subscribers.length = 0
                }
            }

            function H() {
                this.error = null
            }
            var U = new H;

            function z(e, t, n, r) {
                var i, o, s, c, u = a(n);
                if (u) {
                    if ((i = function(e, t) {
                            try {
                                return e(t)
                            } catch (e) {
                                return U.error = e, U
                            }
                        }(n, r)) === U ? (c = !0, o = i.error, i = null) : s = !0, t === i) return void R(t, new TypeError("A promises callback cannot return that same promise."))
                } else i = r, s = !0;
                t._state !== T || (u && s ? A(t, i) : c ? R(t, o) : e === I ? D(t, i) : e === P && R(t, i))
            }
            var G = function(e) {
                return new $(this, e).promise
            };
            var W = function(e) {
                var t = new this(S);
                if (!u(e)) return R(t, new TypeError("You must pass an array to race.")), t;
                var n = e.length;

                function r(e) {
                    A(t, e)
                }

                function i(e) {
                    R(t, e)
                }
                for (var o = 0; t._state === T && o < n; o++) F(this.resolve(e[o]), void 0, r, i);
                return t
            };
            var V = function(e) {
                    var t = new this(S);
                    return R(t, e), t
                },
                K = 0;
            var q = Q;

            function Q(e) {
                this._id = K++, this._state = void 0, this._result = void 0, this._subscribers = [], S !== e && ("function" != typeof e && function() {
                    throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")
                }(), this instanceof Q ? function(e, t) {
                    try {
                        t(function(t) {
                            A(e, t)
                        }, function(t) {
                            R(e, t)
                        })
                    } catch (t) {
                        R(e, t)
                    }
                }(this, e) : function() {
                    throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")
                }())
            }
            Q.all = G, Q.race = W, Q.resolve = j, Q.reject = V, Q._setScheduler = function(e) {
                c = e
            }, Q._setAsap = function(e) {
                d = e
            }, Q._asap = d, Q.prototype = {
                constructor: Q,
                then: E,
                catch: function(e) {
                    return this.then(null, e)
                }
            };
            var $ = Y;

            function Y(e, t) {
                this._instanceConstructor = e, this.promise = new e(S), Array.isArray(t) ? (this._input = t, this.length = t.length, this._remaining = t.length, this._result = new Array(this.length), 0 === this.length ? D(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(), 0 === this._remaining && D(this.promise, this._result))) : R(this.promise, this._validationError())
            }
            Y.prototype._validationError = function() {
                return new Error("Array Methods must be provided an Array")
            }, Y.prototype._enumerate = function() {
                for (var e = this.length, t = this._input, n = 0; this._state === T && n < e; n++) this._eachEntry(t[n], n)
            }, Y.prototype._eachEntry = function(e, t) {
                var n = this._instanceConstructor,
                    r = n.resolve;
                if (r === j) {
                    var i = x(e);
                    if (i === E && e._state !== T) this._settledAt(e._state, t, e._result);
                    else if ("function" != typeof i) this._remaining--, this._result[t] = e;
                    else if (n === q) {
                        var o = new n(S);
                        L(o, e, i), this._willSettleAt(o, t)
                    } else this._willSettleAt(new n(function(t) {
                        t(e)
                    }), t)
                } else this._willSettleAt(r(e), t)
            }, Y.prototype._settledAt = function(e, t, n) {
                var r = this.promise;
                r._state === T && (this._remaining--, e === P ? R(r, n) : this._result[t] = n), 0 === this._remaining && D(r, this._result)
            }, Y.prototype._willSettleAt = function(e, t) {
                var n = this;
                F(e, void 0, function(e) {
                    n._settledAt(I, t, e)
                }, function(e) {
                    n._settledAt(P, t, e)
                })
            };
            var X = function() {
                    var e;
                    if (void 0 !== i) e = i;
                    else if ("undefined" != typeof self) e = self;
                    else try {
                        e = Function("return this")()
                    } catch (e) {
                        throw new Error("polyfill failed because global object is unavailable in this environment")
                    }
                    var t = e.Promise;
                    t && "[object Promise]" === Object.prototype.toString.call(t.resolve()) && !t.cast || (e.Promise = q)
                },
                Z = {
                    Promise: q,
                    polyfill: X
                };
            void 0 === (o = function() {
                return Z
            }.call(t, n, t, e)) || (e.exports = o), X()
        }).call(this)
    }).call(this, n(37), n(173))
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(204)),
        o = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function a(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var s = function(e) {
        function t() {
            var n, r;
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            for (var i = arguments.length, o = Array(i), s = 0; s < i; s++) o[s] = arguments[s];
            return n = r = a(this, e.call.apply(e, [this].concat(o))), r.getWrapperRef = function(e) {
                r.wrapper = e
            }, a(r, n)
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentDidMount = function() {
            var e = this.props,
                t = e.isNative,
                n = e.isShadows;
            this.scroller || (this.scroller = Object(i.createScroll)(this.wrapper, {
                shadows: n,
                nativeScroll: t
            }))
        }, t.prototype.componentDidUpdate = function() {
            this.scroller.update()
        }, t.prototype.componentWillUnmount = function() {
            this.scroller.destroy(), this.scroller = null
        }, t.prototype.render = function() {
            var e = this.props,
                t = e.children,
                n = (e.isNative, e.isShadows, function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["children", "isNative", "isShadows"]));
            return r.createElement("div", o({}, n, {
                ref: this.getWrapperRef
            }), t)
        }, t
    }(r.Component);
    t.default = s, s.defaultProps = {
        isNative: !1,
        isShadows: !1
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "startLongPollForGroup", function() {
        return S
    }), n.d(t, "startLongPoll", function() {
        return T
    });
    var r = n(102),
        i = n(176),
        o = n(70),
        a = n(18),
        s = n(30),
        c = n(181),
        u = n(7),
        l = n(13),
        d = n(10),
        f = n(50),
        p = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        m = 202,
        g = 4,
        h = 5,
        _ = 3e4,
        v = {},
        b = Date.now();

    function y(e, t) {
        var n = Math.floor(t.status / 100);
        t.status && e.stat && (t.status >= 500 && t.status < 600 && statlogsValueEvent("im_longpoll", 1, n + "0x", t.getResponseHeader("x-frontend")), v[n] = v[n] ? v[n] + 1 : 1, Date.now() - b >= _ && (Object.keys(v).forEach(function(e) {
            statlogsValueEvent("im_longpoll", v[e], e + "0x", t.getResponseHeader("x-frontend"))
        }), v = {}, b = Date.now()))
    }

    function w(e) {
        return e.updates.map(function(e) {
            switch (e[0]) {
                case 0:
                    return a.deleteEvent(e);
                case 1:
                    return a.replaceFlagsEvent(e);
                case 2:
                    return a.setFlagsEvent(e);
                case 3:
                    return a.resetFlagsEvent(e);
                case 4:
                    return a.addMessageEvent(e);
                case 5:
                    return a.editMessageEvent(e);
                case 6:
                    return a.readInboundEvent(e);
                case 7:
                    return a.readOutboundEvent(e);
                case 8:
                    return a.gotOnlineEvent(e);
                case 9:
                    return a.gotOfflineEvent(e);
                case 10:
                    return a.resetDirectoriesEvent(e);
                case 11:
                    return a.replaceDirectoriesEvent(e);
                case 12:
                    return a.setDirectoriesEvent(e);
                case 13:
                    return a.deleteDialogEvent(e);
                case 18:
                    return a.replaceMessageEvent(e);
                case 51:
                    return a.chatChangedEvent(e);
                case 52:
                    return a.chatUpdatedEvent(e);
                case 63:
                    return a.typingEvent(e);
                case 70:
                    return a.videoCallEvent(e);
                case 80:
                    return a.unreadCountEvent(e);
                case 114:
                    return a.notifySettingsChangedEvent(e);
                case 116:
                    return a.refreshMessageEvent(e);
                case -1:
                    return a.resyncEvent();
                default:
                    return a.emptyEvent(e)
            }
        })
    }

    function O(e, t) {
        return Promise.resolve(extend({}, t, {
            timeout: e < 64 ? 2 * e : e
        }))
    }

    function C(e, t) {
        return t.pauses || (t.pauses = []), t.pauses.push(e), Promise.resolve(t)
    }

    function k(e) {
        return e.pauses || (e.pauses = []), Object(u.lplog)("Aborting all pauses", "error"), e.pauses.forEach(function(e) {
            return e()
        }), e.pauses = [], Promise.resolve(e)
    }

    function E(e, t, n, i) {
        var o = i.failed ? Object(s.abortablePause)(g, e) : {},
            c = o.abort,
            l = o.pause;
        switch (i.failed) {
            case 1:
                return Object(u.lplog)("Old timestamp, init resync", "error"), e.set(C.bind(null, c)), n([a.resyncEvent()]), e.set(r.loadLongPollTs).then(l).then(j.bind(null, e, t, n));
            case 2:
                return Object(u.lplog)("Key is incorrect", "error"), e.set(C.bind(null, c)), e.set(r.loadLongPollKey).then(l).then(j.bind(null, e, t, n));
            case 3:
                throw nav.reload({
                    force: !0
                }), new Error("ts is very wrong");
            default:
                return e.set(function(e, t) {
                    return Promise.resolve(extend({}, t, {
                        imTs: e
                    }))
                }.bind(null, i.ts)).then(function() {
                    return i
                })
        }
    }

    function j(e, t, n) {
        if (e.get().stopped) return Promise.resolve({
            updates: []
        });
        if (t()) return Promise.reject(new Error("pause"));
        var r = e.get(),
            i = r.imUrl + "/" + r.imPart,
            a = Object(o.plaingetCancelable)(i, {
                act: "a_check",
                key: r.imKey,
                version: h,
                ts: r.imTs,
                wait: 25,
                mode: r.mode
            }),
            s = a.request,
            c = a.cancel;
        return e.set(function(e, t) {
            return t.cancelToken = e, Promise.resolve(t)
        }.bind(null, c)).then(function() {
            return s
        }).then(function(t) {
            var n = p(t, 2),
                i = n[0],
                o = n[1];
            return o && y(r, o), e.set(O.bind(null, 1)), JSON.parse(i)
        }).catch(function(e) {
            var t = p(e, 2),
                n = t[0],
                i = t[1];
            throw i && y(r, i), n
        }).then(E.bind(null, e, t, n))
    }

    function S(e) {
        Object(f.imWeirdLog)("im_start_longpoll_group", {}, !1);
        var t = Object(d.createLongpollEventsQueue)(e.ts, function(e) {
                r.trigger("data", e)
            }),
            n = Object(l.createLongPoll)(e, t.onLp),
            r = new window.EventEmitter;
        return {
            onData: function(e) {
                return r.on("data", e)
            },
            offData: function(e) {
                return r.off("data", e)
            },
            push: function(e) {
                return r.trigger("data", e)
            },
            pause: t.pause.bind(t),
            resume: t.resume.bind(t),
            abortWaiting: n.abortWaiting.bind(n),
            onLp: t.onLp.bind(t),
            stop: n.stopConnection.bind(n)
        }
    }

    function T(e) {
        var t = e.id,
            n = e.gid,
            r = e.key,
            o = e.ts,
            a = e.url,
            l = e.lhost,
            d = e.lpstat,
            f = new EventEmitter,
            p = Object(c.initQueue)(function(e, t) {
                return window.vk.lpConfig && window.vk.lpConfig.enabled && window.longpollTesting_onImEvents && window.longpollTesting_onImEvents(t), f.trigger("data", t), Promise.resolve({})
            }),
            h = p.pause,
            _ = p.resume,
            v = p.pushMessage,
            b = p.isPaused,
            y = p.reset,
            E = Object(i.default)({
                id: t,
                gid: n,
                mode: m,
                timeout: 1,
                imKey: r,
                imTs: o,
                imPart: a,
                imUrl: l,
                pause: !1,
                stat: d
            });
        return function e(t, n, r) {
            t.get().stopped || (Object(u.lplog)("New request"), j(t, r, n).then(w).then(function(e) {
                return Object(u.lplog)("Request success", "success"), e
            }).then(n).catch(function(e) {
                if (!t.get().stopped) return "pause" !== e.message && topError(e), Object(u.lplog)("Error, waiting: " + (e.message || "no message (probably browser reset)"), "error"), t.set(O.bind(null, r() ? g / 2 : t.get().timeout)).then(function() {
                    var e = Object(s.abortablePause)(t.get().timeout, t),
                        n = e.abort,
                        r = e.pause;
                    return t.set(C.bind(null, n)).then(r)
                });
                Object(u.lplog)("Stopped longpoll")
            }).then(e.bind(null, t, n, r)))
        }(E, v.bind(null, "main"), b.bind(null, "main")), {
            onData: function(e) {
                return f.on("data", e)
            },
            offData: function(e) {
                return f.off("data", e)
            },
            abortWaiting: function() {
                return E.set(k)
            },
            stop: function(e) {
                e.set(function(e) {
                    return Promise.resolve(extend({}, e, {
                        stopped: !0
                    }))
                }).then(function() {
                    e.get().cancelToken()
                })
            }.bind(null, E),
            pause: h.bind(null, "main"),
            resume: _.bind(null, "main"),
            reset: y.bind(null, "main"),
            push: function(e) {
                return f.trigger("data", e)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "statlogsForwardEvent", function() {
        return i
    }), n.d(t, "statlogsForwardFromCommunityEvent", function() {
        return o
    });
    var r = n(48);

    function i(e) {
        Object(r.statlogsProbValueEvent)(.1, "im_forward_stat", a(e), !!e.get().gid)
    }

    function o(e, t) {
        Object(r.statlogsProbValueEvent)(.1, "im_forward_from_community_stat", a(e), !!e.get().gid, +t)
    }

    function a(e) {
        var t = e.get().pendingForward;
        return +(t && t.msgIds && t.msgIds.length)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "ge", function() {
        return u
    }), n.d(t, "geByTag", function() {
        return l
    }), n.d(t, "geByTag1", function() {
        return d
    }), n.d(t, "geByClass", function() {
        return f
    }), n.d(t, "geByClass1", function() {
        return p
    }), n.d(t, "gpeByClass", function() {
        return m
    }), n.d(t, "domQuery", function() {
        return g
    }), n.d(t, "domQuery1", function() {
        return h
    }), n.d(t, "domClosest", function() {
        return _
    }), n.d(t, "domClosestByTag", function() {
        return v
    }), n.d(t, "gpeByTag", function() {
        return b
    }), n.d(t, "ce", function() {
        return y
    }), n.d(t, "re", function() {
        return w
    }), n.d(t, "se", function() {
        return O
    }), n.d(t, "sech", function() {
        return C
    }), n.d(t, "rs", function() {
        return k
    }), n.d(t, "psr", function() {
        return E
    }), n.d(t, "domReplaceEl", function() {
        return j
    }), n.d(t, "domEL", function() {
        return S
    }), n.d(t, "domNS", function() {
        return T
    }), n.d(t, "domPS", function() {
        return I
    }), n.d(t, "domFC", function() {
        return P
    }), n.d(t, "domLC", function() {
        return M
    }), n.d(t, "domPN", function() {
        return x
    }), n.d(t, "domChildren", function() {
        return L
    }), n.d(t, "domInsertBefore", function() {
        return A
    }), n.d(t, "domInsertAfter", function() {
        return N
    }), n.d(t, "domByClass", function() {
        return D
    }), n.d(t, "domData", function() {
        return R
    }), n.d(t, "domChildIndex", function() {
        return F
    }), n.d(t, "domCA", function() {
        return B
    }), n.d(t, "domClosestSibling", function() {
        return H
    }), n.d(t, "matchesSelector", function() {
        return U
    }), n.d(t, "isHover", function() {
        return z
    }), n.d(t, "isAncestor", function() {
        return G
    }), n.d(t, "getScroll", function() {
        return W
    }), n.d(t, "domClosestPositioned", function() {
        return V
    }), n.d(t, "domClosestOverflowHidden", function() {
        return K
    }), n.d(t, "show", function() {
        return q
    }), n.d(t, "hide", function() {
        return Q
    }), n.d(t, "isVisible", function() {
        return $
    }), n.d(t, "clientHeight", function() {
        return Y
    }), n.d(t, "getClientRectOffsetY", function() {
        return X
    }), n.d(t, "toggle", function() {
        return Z
    }), n.d(t, "boundingRectEnabled", function() {
        return J
    }), n.d(t, "getXYRect", function() {
        return ee
    }), n.d(t, "getXY", function() {
        return te
    }), n.d(t, "isWindow", function() {
        return ne
    }), n.d(t, "getSize", function() {
        return re
    }), n.d(t, "getW", function() {
        return ie
    }), n.d(t, "getH", function() {
        return oe
    }), n.d(t, "hasClass", function() {
        return ae
    }), n.d(t, "addClass", function() {
        return se
    }), n.d(t, "addClassDelayed", function() {
        return ce
    }), n.d(t, "removeClass", function() {
        return ue
    }), n.d(t, "removeClassDelayed", function() {
        return le
    }), n.d(t, "toggleClass", function() {
        return de
    }), n.d(t, "toggleClassDelayed", function() {
        return fe
    }), n.d(t, "replaceClass", function() {
        return pe
    }), n.d(t, "getStyle", function() {
        return me
    }), n.d(t, "setStyle", function() {
        return ge
    }), n.d(t, "setStyleDelayed", function() {
        return he
    }), n.d(t, "setPseudoStyle", function() {
        return _e
    }), n.d(t, "data", function() {
        return ve
    }), n.d(t, "attr", function() {
        return be
    }), n.d(t, "removeAttr", function() {
        return ye
    }), n.d(t, "removeData", function() {
        return we
    }), n.d(t, "cleanElems", function() {
        return Oe
    }), n.d(t, "setTitle", function() {
        return Ce
    }), n.d(t, "getZoom", function() {
        return ke
    }), n.d(t, "val", function() {
        return Ee
    }), n.d(t, "elfocus", function() {
        return je
    }), n.d(t, "traverseParent", function() {
        return Se
    }), n.d(t, "setDocumentTitle", function() {
        return Ie
    }), n.d(t, "lockDocumentTitle", function() {
        return Pe
    });
    var r, i, o, a, s = n(129),
        c = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };

    function u(e) {
        return "string" == typeof e || "number" == typeof e ? document.getElementById(e) : e
    }

    function l(e, t) {
        return (t = u(t) || document).getElementsByTagName(e)
    }

    function d(e, t) {
        return (t = u(t) || document).querySelector && t.querySelector(e) || l(e, t)[0]
    }

    function f(e, t, n) {
        t = u(t) || document, n = n || "*";
        var r = [];
        if (t.querySelectorAll && "*" != n) return t.querySelectorAll(n + "." + e);
        if (t.getElementsByClassName) {
            var i = t.getElementsByClassName(e);
            if ("*" != n) {
                n = n.toUpperCase();
                for (var o = 0, a = i.length; o < a; ++o) i[o].tagName.toUpperCase() == n && r.push(i[o])
            } else r = Array.prototype.slice.call(i);
            return r
        }
        var s = l(n, t),
            c = new RegExp("(^|\\s)" + e + "(\\s|$)");
        for (o = 0, a = s.length; o < a; ++o) c.test(s[o].className) && r.push(s[o]);
        return r
    }

    function p(e, t, n) {
        return t = u(t) || document, n = n || "*", t.querySelector && t.querySelector(n + "." + e) || f(e, t, n)[0]
    }

    function m(e, t, n) {
        if (!(t = u(t))) return null;
        for (; n !== t && (t = t.parentNode);)
            if (ae(t, e)) return t;
        return null
    }

    function g(e, t) {
        return (t || document).querySelectorAll(e)
    }

    function h(e, t) {
        return (t || document).querySelector(e)
    }

    function _(e, t) {
        return ae(t, e) ? t : m(e, t)
    }

    function v(e, t) {
        return e = e.toUpperCase(), t.nodeType == Node.ELEMENT_NODE && t.tagName.toUpperCase() == e ? t : b(e, t)
    }

    function b(e, t) {
        if (!(t = u(t))) return null;
        for (e = e.toUpperCase(); t = t.parentNode;)
            if (t.tagName && t.tagName.toUpperCase() == e) return t;
        return null
    }

    function y(e, t, n) {
        var r = document.createElement(e);
        return t && extend(r, t), n && ge(r, n), r
    }

    function w(e) {
        return (e = u(e)) && e.parentNode && e.parentNode.removeChild(e), e
    }

    function O(e) {
        return P(y("div", {
            innerHTML: e
        }))
    }

    function C(e) {
        return L(y("div", {
            innerHTML: e
        }))
    }

    function k(e, t) {
        return each(t, function(t, n) {
            e = e.replace(new RegExp("%" + t + "%", "g"), (void 0 === n ? "" : n).toString().replace(/\$/g, "&#036;"))
        }), e
    }

    function E(e) {
        return "https:" != locProtocol ? e : e = (e = (e = (e = (e = e.replace(/http:\/\/(cs(\d+)\.vk\.me\/c(\d+)\/)/gi, "https://$1")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\/c(\d+)\/(v\d+\/|[a-z0-9\/_:\-]+\.jpg)/gi, "https://pp.vk.me/c$3/$4")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\/([a-z0-9\/_:\-]+\.jpg)/gi, "https://pp.vk.me/c$1/$3")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\//gi, "https://ps.vk.me/c$1/")).replace(/http:\/\/video(\d+)\.vkadre\.ru\//gi, "https://ps.vk.me/v$1/")
    }

    function j(e, t) {
        return isString(t) && (t = O(t)), x(e).replaceChild(t, e), t
    }

    function S(e, t) {
        for (t = t ? "previousSibling" : "nextSibling"; e && !e.tagName;) e = e[t];
        return e
    }

    function T(e) {
        return S((e || {}).nextSibling)
    }

    function I(e) {
        return S((e || {}).previousSibling, 1)
    }

    function P(e) {
        return S((e || {}).firstChild)
    }

    function M(e) {
        return S((e || {}).lastChild, 1)
    }

    function x(e) {
        return (e || {}).parentNode
    }

    function L(e) {
        for (var t = [], n = e.childNodes, r = 0; r < n.length; r++) n[r].tagName && t.push(n[r]);
        return t
    }

    function A(e, t) {
        var n = x(t);
        return n && n.insertBefore(e, t)
    }

    function N(e, t) {
        var n = x(t);
        return n && n.insertBefore(e, T(t))
    }

    function D(e, t) {
        return e ? p(t, e) : e
    }

    function R(e, t, n) {
        return e ? void 0 !== n ? (null === n ? e.removeAttribute("data-" + t) : e.setAttribute("data-" + t, n), n) : e.getAttribute("data-" + t) : null
    }

    function F(e) {
        for (var t = 0; null != (e = I(e));) t++;
        return t
    }

    function B(e, t) {
        do {
            e = x(e)
        } while (e && !U(e, t));
        return e
    }

    function H(e, t, n) {
        for (var r = null; null === r && e;)(e = -1 === n ? I(e) : T(e)) && U(e, t) && (r = e);
        return r
    }

    function U(e, t) {
        return !(!(e = u(e)) || e == document) && (e.matches || e.webkitMatchesSelector || e.mozMatchesSelector || e.msMatchesSelector || function(e) {
            for (var t = (this.parentNode || this.document || this.ownerDocument).querySelectorAll(e), n = t.length; --n >= 0 && t[n] !== this;);
            return n > -1
        }).call(e, t)
    }

    function z(e) {
        return U(e, ":hover")
    }

    function G(e, t) {
        var n = u(e);
        if (t = u(t), !e || !t) return !1;
        for (; n = n.parentNode;)
            if (n == t) return !0;
        return !1
    }

    function W() {
        var e = browser.msie6 ? u("PageContainer") : document.body,
            t = document.documentElement;
        return [e.scrollLeft || t.scrollLeft || window.pageXOffset || 0, e.scrollTop || t.scrollTop || window.pageYOffset || 0, t.clientWidth || e.clientWidth || 0, t.clientHeight || e.clientHeight || 0]
    }

    function V(e, t) {
        for (var n = (t = t || {}).fromEl || x(e), r = t.positions || ["relative", "absolute", "fixed"]; n && n != bodyNode;) {
            var i = me(n, "position");
            if (inArray(i, r) && (!t.noOverflow || "hidden" != me(n, "overflow"))) break;
            n = x(n)
        }
        return n
    }

    function K(e, t) {
        for (var n, r, i, o, a = e = u(e); a && a.tagName && a !== bodyNode && (n = me(a, "position"), r = me(a, "overflow"), i = me(a, "transform"), !t || !browser.mozilla || "page_wrap" == a.id || a === e || "visible" === r || ("static" === n ? o && "relative" !== o : "fixed" === o));) "none" !== i ? o = void 0 : "static" !== n && "fixed" !== o && (o = n), a = x(a);
        return a
    }

    function q(e) {
        var t = arguments.length;
        if (t > 1)
            for (var n = 0; n < t; n++) q(arguments[n]);
        else if ((e = u(e)) && e.style) {
            var r = e.olddisplay,
                i = "block",
                o = e.tagName.toLowerCase();
            e.style.display = r || "", "none" === me(e, "display") && (i = ae(e, "inline") || ae(e, "_inline") ? "inline" : ae(e, "_inline_block") ? "inline-block" : "tr" !== o || browser.msie ? "table" !== o || browser.msie ? "block" : "table" : "table-row", e.style.display = e.olddisplay = i)
        }
    }

    function Q(e) {
        var t = arguments.length;
        if (t > 1)
            for (var n = 0; n < t; n++) Q(arguments[n]);
        else if ((e = u(e)) && e.style) {
            var r = me(e, "display");
            e.olddisplay = "none" != r ? r : "", e.style.display = "none"
        }
    }

    function $(e) {
        return !(!(e = u(e)) || !e.style) && "none" != me(e, "display")
    }

    function Y() {
        return window.innerHeight || document.documentElement.clientHeight || bodyNode.clientHeight
    }

    function X(e, t, n) {
        e = u(e), n = n || 0;
        var r = te(e)[1],
            i = re(e)[1],
            o = window,
            a = document.documentElement,
            s = Math.max(intval(o.innerHeight), intval(a.clientHeight)),
            c = u("page_header_cont"),
            l = a.scrollTop || bodyNode.scrollTop || window.scrollY || 0,
            d = vk.staticheader ? Math.max(0, re(c)[1] - l) : re(c)[1];
        if (t) {
            if (r + i < l + d + n) return r + i - l - d - n;
            if (r > l + s - n) return r - l - s + n
        } else {
            if (r < l + d + n) return r - l - d - n;
            if (r + i > l + s - n) return r + i - l - s + n
        }
        return 0
    }

    function Z(e, t) {
        return void 0 === t && (t = !$(e)), t ? q(e) : Q(e), t
    }

    function J(e) {
        return void 0 !== e.getBoundingClientRect
    }

    function ee(e, t) {
        var n;
        if (t && "inline" == me(e, "display")) {
            var r = e.getClientRects();
            n = r && r[0] || e.getBoundingClientRect()
        } else n = e.getBoundingClientRect();
        return n
    }

    function te(e, t) {
        if (!(e = u(e))) return [0, 0];
        var n, r, i = {
                top: 0,
                left: 0
            },
            o = e.ownerDocument;
        return o ? (n = o.documentElement, J(e) && (i = ee(e, !0)), r = o == o.window ? o : 9 === o.nodeType && (o.defaultView || o.parentWindow), [i.left + (t ? 0 : r.pageXOffset || n.scrollLeft) - (n.clientLeft || 0), i.top + (t ? 0 : r.pageYOffset || n.scrollTop) - (n.clientTop || 0)]) : [0, 0]
    }

    function ne(e) {
        return null != e && e === e.window
    }

    function re(e, t, n) {
        e = u(e);
        var r, i = [0, 0],
            o = document.documentElement;
        if (t && "border-box" === me(e, "boxSizing") && (t = !1), e == document) i = [Math.max(o.clientWidth, bodyNode.scrollWidth, o.scrollWidth, bodyNode.offsetWidth, o.offsetWidth), Math.max(o.clientHeight, bodyNode.scrollHeight, o.scrollHeight, bodyNode.offsetHeight, o.offsetHeight)];
        else if (e) {
            var a = function() {
                if (i = J(e) && (r = ee(e, n)) && void 0 !== r.width ? [r.width, r.height] : [e.offsetWidth, e.offsetHeight], t) {
                    each(i, function(t, n) {
                        each(t ? ["Top", "Bottom"] : ["Left", "Right"], function() {
                            i[t] -= parseFloat(me(e, "padding" + this)) || 0, i[t] -= parseFloat(me(e, "border" + this + "Width")) || 0
                        })
                    })
                }
            };
            if ($(e)) a();
            else {
                var s = {
                        position: "absolute",
                        visibility: "hidden",
                        display: "block"
                    },
                    c = {},
                    l = !1;
                e.style.cssText.indexOf("!important") > -1 && (l = e.style.cssText), each(s, function(t, n) {
                    c[t] = e.style[t], e.style[t] = n
                }), a(), each(s, function(t, n) {
                    e.style[t] = c[t]
                }), l && (e.style.cssText = l)
            }
        }
        return i
    }

    function ie(e) {
        return re(e)[0]
    }

    function oe(e) {
        return re(e)[1]
    }

    function ae(e, t) {
        return !!((e = u(e)) && 1 === e.nodeType && (" " + e.className + " ").replace(window.whitespaceRegex, " ").indexOf(" " + t + " ") >= 0)
    }

    function se(e, t) {
        (e = u(e)) && !ae(e, t) && (e.className = (e.className ? e.className + " " : "") + t)
    }

    function ce(e, t) {
        return setTimeout(se.pbind(e, t), 0)
    }

    function ue(e, t) {
        (e = u(e)) && (e.className = trim((e.className || "").replace(new RegExp("(\\s|^)" + t + "(\\s|$)"), " ")))
    }

    function le(e, t) {
        return setTimeout(ue.pbind(e, t), 0)
    }

    function de(e, t, n) {
        return void 0 === n && (n = !ae(e, t)), (n ? se : ue)(e, t), n
    }

    function fe(e, t, n) {
        return void 0 === n && (n = !ae(e, t)), (n ? ce : le)(e, t), n
    }

    function pe(e, t, n) {
        ue(e, t), se(e, n)
    }

    function me(e, t, n) {
        if (e = u(e), isArray(t)) {
            var r = {};
            return each(t, function(t, n) {
                r[n] = me(e, n)
            }), r
        }
        if (!e) return "";
        if (void 0 === n && (n = !0), !n && "opacity" == t && browser.msie) return (s = e.style.filter) ? s.indexOf("opacity=") >= 0 ? parseFloat(s.match(/opacity=([^)]*)/)[1]) / 100 + "" : "1" : "";
        if (!n && e.style && (e.style[t] || "height" == t)) return e.style[t];
        var i, o = document.defaultView || window;
        if (o.getComputedStyle) {
            t = t.replace(/([A-Z])/g, "-$1").toLowerCase();
            var a = o.getComputedStyle(e, null);
            a && (i = a.getPropertyValue(t))
        } else if (e.currentStyle) {
            var s;
            if ("opacity" == t && browser.msie) return (s = e.currentStyle.filter) && s.indexOf("opacity=") >= 0 ? parseFloat(s.match(/opacity=([^)]*)/)[1]) / 100 + "" : "1";
            var c = t.replace(/\-(\w)/g, function(e, t) {
                return t.toUpperCase()
            });
            "auto" == (i = e.currentStyle[t] || e.currentStyle[c]) && (i = 0), i = (i + "").split(" "), each(i, function(t, n) {
                if (!/^\d+(px)?$/i.test(n) && /^\d/.test(n)) {
                    var r = e.style,
                        o = r.left,
                        a = e.runtimeStyle.left;
                    e.runtimeStyle.left = e.currentStyle.left, r.left = n || 0, i[t] = r.pixelLeft + "px", r.left = o, e.runtimeStyle.left = a
                }
            }), i = i.join(" ")
        }
        if (n && ("width" == t || "height" == t)) {
            var l = re(e, !0)[{
                width: 0,
                height: 1
            }[t]];
            i = (intval(i) ? Math.max(floatval(i), l) : l) + "px"
        }
        return i
    }

    function ge(e, t, n) {
        if (e = u(e)) {
            if ("object" == (void 0 === t ? "undefined" : c(t))) return each(t, function(t, n) {
                ge(e, t, n)
            });
            if ("opacity" == t) browser.msie && ((n + "").length ? e.style.filter = 1 !== n ? "alpha(opacity=" + 100 * n + ")" : "" : e.style.cssText = e.style.cssText.replace(/filter\s*:[^;]*/gi, ""), e.style.zoom = 1), e.style.opacity !== n && (e.style.opacity = n);
            else try {
                var r = "number" == typeof n;
                r && /height|width/i.test(t) && (n = Math.abs(n)), n = r && !/z-?index|font-?weight|opacity|zoom|line-?height/i.test(t) ? n + "px" : n, e.style[t] !== n && (e.style[t] = n)
            } catch (e) {
                debugLog("setStyle error: ", [t, n], e)
            }
        }
    }

    function he(e, t, n) {
        setTimeout(ge.pbind(e, t, n), 0)
    }

    function _e(e, t, n) {
        var r = ve(e, "pseudo-id");
        r || (ve(e, "pseudo-id", r = irand(1e8, 999999999)), se(e, "_pseudo_" + r));
        var i = t + "-style-" + r,
            o = u(i),
            a = "._pseudo_" + r + ":" + t + "{";
        o || (o = headNode.appendChild(y("style", {
            id: i,
            type: "text/css"
        }))), each(n, function(e, t) {
            a += e + ": " + t + " !important;"
        }), a += "}", o.sheet ? (o.sheet.cssRules.length && o.sheet.deleteRule(0), o.sheet.insertRule(a, 0)) : o.styleSheet && (o.styleSheet.cssText = a)
    }

    function ve(e, t, n) {
        if (!e) return !1;
        var r = e[vkExpand];
        return r || (r = e[vkExpand] = ++vkUUID), void 0 !== n && (vkCache[r] || (vkCache[r] = {}, __debugMode && (vkCache[r].__elem = e)), vkCache[r][t] = n), t ? vkCache[r] && vkCache[r][t] : r
    }

    function be(e, t, n) {
        return e = u(e), void 0 === n ? e.getAttribute(t) : (e.setAttribute(t, n), n)
    }

    function ye(e) {
        for (var t = 0, n = arguments.length; t < n; ++t) {
            var r = arguments[t];
            if (void 0 !== e[r]) try {
                delete e[r]
            } catch (t) {
                try {
                    e.removeAttribute(r)
                } catch (e) {}
            }
        }
    }

    function we(e, t) {
        var n = !!e && e[vkExpand];
        if (n)
            if (t) {
                if (vkCache[n]) {
                    delete vkCache[n][t], t = "";
                    var r = 0;
                    for (t in vkCache[n])
                        if ("__elem" !== t) {
                            r++;
                            break
                        }
                    r || we(e)
                }
            } else removeEvent(e), ye(e, vkExpand), delete vkCache[n]
    }

    function Oe() {
        for (var e = arguments, t = 0; t < e.length; ++t) {
            var n = u(e[t]);
            n && (we(n), ye(n, "btnevents"))
        }
    }

    function Ce(e, t, n) {
        if ((e = u(e)) && !e.titleSet) {
            if (t || (t = e), t.scrollWidth > t.clientWidth) e.setAttribute("title", n || e.innerText || e.textContent);
            else {
                var r = d("b", e);
                r && r.scrollWidth > r.clientWidth ? e.setAttribute("title", n || e.innerText || e.textContent) : e.removeAttribute("title")
            }
            e.titleSet = 1
        }
    }

    function ke() {
        var e = u("zoom_test_1") || document.body.appendChild(y("div", {
            id: "zoom_test_1"
        }, {
            left: "10%",
            position: "absolute",
            visibility: "hidden"
        }));
        return (u("zoom_test_2") || document.body.appendChild(y("div", {
            id: "zoom_test_2"
        }, {
            left: e.offsetLeft + "px",
            position: "absolute",
            visibility: "hidden"
        }))).offsetLeft / e.offsetLeft
    }

    function Ee(e, t, n) {
        if (e = u(e)) return void 0 !== t && (e.setValue ? (e.setValue(t), !n && e.phonblur && e.phonblur()) : "INPUT" == e.tagName || "TEXTAREA" == e.tagName ? e.value = t : void 0 !== e.emojiId && window.Emoji ? Emoji.val(e, t) : e.innerHTML = t, !n && triggerEvent(e, "valueChanged")), e.getValue ? e.getValue() : ("INPUT" == e.tagName || "TEXTAREA" == e.tagName ? e.value : e.innerHTML) || ""
    }

    function je(e, t, n) {
        e = u(e);
        try {
            if (e.focus(), void 0 !== t && !1 !== t || (t = e.value.length), void 0 !== n && !1 !== n || (n = t), e.createTextRange) {
                var r = e.createTextRange();
                r.collapse(!0), r.moveEnd("character", n), r.moveStart("character", t), r.select()
            } else e.setSelectionRange && e.setSelectionRange(t, n)
        } catch (e) {}
    }

    function Se(e, t, n) {
        for (e = u(e), n = n || 999; e && !t(e);) {
            if (0 == --n) return !1;
            try {
                if ((e = x(e)) == document) break
            } catch (t) {
                e = !1
            }
        }
        return e
    }
    window.cf = (r = document, i = r.createDocumentFragment(), o = r.createElement("div"), a = r.createRange && r.createRange(), i.appendChild(o), a && a.selectNodeContents(o), a && a.createContextualFragment ? function(e) {
        return e ? a.createContextualFragment(e) : r.createDocumentFragment()
    } : function(e) {
        if (!e) return r.createDocumentFragment();
        o.innerHTML = e;
        for (var t = r.createDocumentFragment(); o.firstChild;) t.appendChild(o.firstChild);
        return t
    }), window.whitespaceRegex = /[\t\r\n\f]/g, window.cssTransformProp = function() {
        var e = document.createElement("div");
        if (null == e.style.transform) {
            var t = ["Webkit", "Moz", "ms"];
            for (var n in t)
                if (void 0 !== e.style[t[n] + "Transform"]) return t[n] + "Transform"
        }
        return "transform"
    }(), window.vkExpand = window.vkExpand || "VK" + Object(s.vkNow)(), window.vkUUID = window.vkUUID || 0, window.vkCache = window.vkCache || {};
    var Te = !1;

    function Ie(e) {
        if (!Te) return window.document.title = replaceEntities(e)
    }

    function Pe(e) {
        Te = e, e && window.cur && window.cur.destroy.push(function() {
            Pe(!1)
        })
    }
    window.ge = u, window.geByTag = l, window.geByTag1 = d, window.geByClass = f, window.geByClass1 = p, window.gpeByClass = m, window.domQuery = g, window.domQuery1 = h, window.domClosest = _, window.ce = y, window.re = w, window.se = O, window.sech = C, window.rs = k, window.psr = E, window.domReplaceEl = j, window.domEL = S, window.domNS = T, window.domPS = I, window.domFC = P, window.domLC = M, window.domPN = x, window.domChildren = L, window.domInsertBefore = A, window.domInsertAfter = N, window.domByClass = D, window.domData = R, window.domChildIndex = F, window.domCA = B, window.domClosestSibling = H, window.matchesSelector = U, window.isHover = z, window.isAncestor = G, window.getScroll = W, window.domClosestPositioned = V, window.domClosestOverflowHidden = K, window.show = q, window.hide = Q, window.isVisible = $, window.clientHeight = Y, window.getClientRectOffsetY = X, window.toggle = Z, window.boundingRectEnabled = J, window.getXYRect = ee, window.getXY = te, window.isWindow = ne, window.getSize = re, window.hasClass = ae, window.addClass = se, window.addClassDelayed = ce, window.removeClass = ue, window.removeClassDelayed = le, window.toggleClass = de, window.toggleClassDelayed = fe, window.replaceClass = pe, window.getStyle = me, window.setStyle = ge, window.setStyleDelayed = he, window.setPseudoStyle = _e, window.data = ve, window.attr = be, window.removeAttr = ye, window.removeData = we, window.cleanElems = Oe, window.setTitle = Ce, window.getZoom = ke, window.val = Ee, window.elfocus = je, window.traverseParent = Se, window.getH = oe, window.getW = ie, window.domClosestByTag = v, window.setDocumentTitle = Ie, window.lockDocumentTitle = Pe
}, function(e, t, n) {
    var r = n(180);
    e.exports = function(e) {
        return Object(r(e))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(109),
        o = n(58),
        a = n(8),
        s = n(187),
        c = n(50),
        u = n(102),
        l = n(148);

    function d(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var f = i.default.getLang,
        p = function(e) {
            function t() {
                var n, r;
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                for (var i = arguments.length, o = Array(i), a = 0; a < i; a++) o[a] = arguments[a];
                return n = r = d(this, e.call.apply(e, [this].concat(o))), r.toggleAdmin = function() {
                    var e = r.props,
                        t = e.store,
                        n = e.mid,
                        i = e.adminMap,
                        o = t.get().peer,
                        a = !i[n];
                    t.set(u.toggleAdminOptimisticly.bind(null, o, n, a)), t.set(u.toggleAdmin.bind(null, o, n, a))
                }, r.kick = function() {
                    var e = r.props.store,
                        t = e.get().peer,
                        n = r.props.mid;
                    e.set(u.kickUserOptimisticly.bind(null, t, n)), e.set(u.kickUser.bind(null, t, n)).catch(function(e) {
                        Object(c.imWeirdCatch)("ChatSettingsMemberEdit.kick", e)
                    })
                }, r.changeAccess = function(e) {
                    var t = r.props.store,
                        n = t.get().peer,
                        i = r.props.mid;
                    t.set(u.changeCommunityAccess.bind(null, n, i, !e)).catch(function(e) {
                        Object(c.imWeirdCatch)("ChatSettingsMemberEdit.changeAccess", e)
                    })
                }, d(r, n)
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.getMemberRole = function(e, t) {
                var n = this.props.storeData,
                    r = n.peer;
                return t === n.tabs[r].ownerId ? f("mail_settings_owner") : e[t] ? f("mail_settings_admin") : null
            }, t.prototype.getActions = function(e) {
                var t = window.vk.id,
                    n = this.props,
                    r = n.store,
                    i = n.mid,
                    o = [];
                if (t === i) return [{
                    text: f("mail_leave_chat"),
                    onClick: this.props.onLeave
                }];
                if (Object(s.canAddAdmin)(r, i) && o.push({
                        text: e[i] ? f("mail_chat_remove_admin") : f("mail_settings_appoint_admin"),
                        onClick: this.toggleAdmin
                    }), Object(s.canKickUser)(r, i) && o.push({
                        text: f("mail_settings_kick"),
                        onClick: this.kick
                    }), Object(l.isCommunityPeer)(i) && !e[i]) {
                    var a = Object(s.canSeeAllMessages)(r, r.get().peer, i),
                        c = a ? "mail_settings_community_mentions_only" : "mail_settings_community_full_access";
                    o.push({
                        text: f(c),
                        onClick: this.changeAccess.bind(this, a)
                    })
                }
                return o
            }, t.prototype.render = function() {
                var e = window.vk.id,
                    t = this.props,
                    n = t.adminMap,
                    i = t.storeData,
                    c = t.mid,
                    u = !!n[e],
                    l = this.getMemberRole(n, c),
                    d = e === c,
                    p = u && this.getActions(n);
                return r.createElement(r.Fragment, null, l && r.createElement("span", {
                    className: "ChatSettingsMembersEdit__role"
                }, l), p && p.length > 0 && r.createElement(o.default, {
                    position: "b",
                    align: "right",
                    trigger: "hover",
                    marginTop: -8,
                    marginLeft: 1,
                    data: this.getActions(n)
                }, r.createElement("span", {
                    className: "ChatSettingsMembersEdit__actions"
                })), !u && !d && Object(s.canKickUser)(i, c) && r.createElement(a.default, {
                    text: f("mail_settings_kick"),
                    position: "t",
                    align: "right"
                }, r.createElement("span", {
                    onClick: this.kick,
                    className: "ChatSettingsMembersEdit__kick"
                })), !u && d && r.createElement(a.default, {
                    text: f("mail_leave_chat"),
                    position: "t",
                    align: "right"
                }, r.createElement("span", {
                    onClick: this.props.onLeave,
                    className: "ChatSettingsMembersEdit__kick"
                })))
            }, t
        }(r.Component);
    t.default = p
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "ImDraft", function() {
        return a
    }), n.d(t, "convertKludgesToAttaches", function() {
        return c
    }), n.d(t, "loadDraftForPeer", function() {
        return u
    });
    var r = n(70),
        i = n(69),
        o = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function a(e, t) {
        this._db = e, this._key = t, this.dData = {
            txt: "",
            attaches: [],
            urlBinds: [],
            cancelled: []
        }, this.load()
    }

    function s(e) {
        switch (e.type) {
            case "mail":
                return e.id < 0 && 1 == e.object.fwd_count;
            default:
                return !e.object
        }
    }

    function c(e, t) {
        var n = [];
        e.fwd_count ? n.push({
            type: "mail",
            id: -t,
            object: {
                fwd_count: e.fwd_count
            }
        }) : e.fwd && n.push({
            type: "mail",
            id: -t,
            object: {
                fwd_count: Object(i.parseFwd)(e.fwd).length
            }
        });
        for (var r = 1; e["attach" + r + "_type"]; ++r) "call" === e["attach" + r + "_type"] ? n.push({
            type: e["attach" + r + "_type"],
            id: e["attach" + r],
            initiatorId: intval(e["attach" + r + "_call_initiator_id"]),
            state: e["attach" + r + "_call_state"],
            duration: intval(e["attach" + r + "_call_duration"]),
            receiverId: intval(e["attach" + r + "_call_receiver_id"])
        }) : n.push({
            type: e["attach" + r + "_type"],
            id: e["attach" + r],
            kind: e["attach" + r + "_kind"],
            productId: e["attach" + r + "_product_id"]
        });
        return e.geo && n.push({
            type: "geo",
            id: e.geo
        }), n
    }

    function u(e, t) {
        return new a(e, "draft_" + t)
    }
    a.prototype.dump = function() {
        var e;
        this._key && this._db.updateByKey(this._key, {
            txt: (e = this.dData).txt,
            attaches: e.attaches.length ? e.attaches : void 0,
            urlBinds: e.urlBinds.length ? e.urlBinds : void 0,
            cancelled: e.cancelled.length ? e.cancelled : void 0
        })
    }, a.prototype.load = function() {
        if (this._key) {
            var e = this._db.selectByKey(this._key);
            e && (this.dData = function(e) {
                return {
                    txt: e.txt,
                    attaches: e.attaches || [],
                    urlBinds: e.urlBinds || [],
                    cancelled: e.cancelled || []
                }
            }(e))
        }
    }, a.prototype.clear = function() {
        this.dData = {
            txt: "",
            attaches: [],
            urlBinds: [],
            cancelled: []
        }, this.dump()
    }, a.prototype.setText = function(e) {
        this.dData.txt = trim(e), this.dump()
    }, a.prototype.addAttach = function(e, t, n) {
        if ("share" !== e && "mail" !== e || this.removeAttachByType(e), !e || !t && "poll" !== e) return !1;
        var r = this.dData.attaches.findIndex(function(n) {
            return n.type === e && n.id === t
        }); - 1 === r ? (this.dData.attaches.push({
            type: e,
            id: t,
            object: n
        }), this.dump()) : "video" !== e && "poll" !== e || (this.dData.attaches[r] = {
            type: e,
            id: t,
            object: n
        }, this.dump())
    }, a.prototype.syncWithSelector = function(e) {
        var t = this,
            n = this.getFwdRaw();
        this.dData.attaches = (n ? [n] : []).concat(e.getMedias().map(function(e) {
            var n = o(e, 2),
                r = n[0],
                i = n[1];
            return t.dData.attaches.find(function(e) {
                return e.type == r && e.id == i
            }) || {
                type: r,
                id: i
            }
        })), this.dump()
    }, a.prototype.removeAttachByType = function(e) {
        for (var t = this.dData.attaches.length; t--;) this.dData.attaches[t].type === e && this.dData.attaches.splice(t, 1);
        this.dump()
    }, a.prototype.removeAllAttaches = function() {
        this.dData.attaches = [], this.dData.cancelled = [], this.dump()
    }, a.prototype.addBindUrl = function(e, t, n) {
        this.getBoundAttach(e) || (this.dData.urlBinds.push({
            url: e,
            type: t,
            id: n
        }), this.dump())
    }, a.prototype.getBoundAttach = function(e) {
        var t = this.dData.urlBinds.find(function(t) {
            return t.url === e
        });
        return t && this.dData.attaches.find(function(e) {
            return e.type === t.type && e.id === t.id
        }) || null
    }, a.prototype.getShareUrl = function() {
        var e = this.dData.attaches.find(function(e) {
            return "share" === e.type
        });
        if (e && e.object) return e.object.url
    }, a.prototype.getCancelledShares = function() {
        return this.dData.cancelled.length ? this.dData.cancelled : void 0
    }, a.prototype.hasAttaches = function() {
        return this.dData.attaches.length > 0
    }, a.prototype.destroy = function() {
        this.dData = {}, this._key = this._db = null
    }, a.prototype.prepareObjects = function(e, t) {
        var n = this;
        return this.dData.attaches.find(s) ? Object(r.post)(r.CONTROLLER, {
            act: "draft_medias",
            gid: e,
            messageId: t || 0,
            media: t ? void 0 : this.dData.attaches.map(function(e) {
                return [e.type, e.id]
            }).join("*")
        }).then(function(e) {
            var t = o(e, 1)[0];
            n.dData.attaches = t.map(function(e) {
                return {
                    type: e[0],
                    id: e[1],
                    object: e[2]
                }
            })
        }) : Promise.resolve()
    }, a.prototype.getFwdRaw = function() {
        return this.dData.attaches.find(function(e) {
            return "mail" === e.type
        })
    }, a.prototype.getFwdCount = function() {
        var e = this.getFwdRaw();
        return e ? e.id < 0 ? e.object.fwd_count : e.id.split(";").length : 0
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(128),
        i = n(102),
        o = n(54),
        a = n(18),
        s = n(176),
        c = n(194);

    function u(e) {
        return e.which || e.keyCode
    }

    function l(e, t, n, i) {
        var s = u(i);
        if (!layers.visible) {
            if (s >= 49 && s <= 57 && (i.ctrlKey || i.metaKey && browser.mac) && Object(o.isClassicInterface)(t)) return function(e, t) {
                var n = e.get().tabbedPeers[t];
                n && e.get().longpoll.push([Object(a.changePeer)(n.peer, !1, !0, !0)])
            }(t, s - 49), cancelEvent(i);
            inArray(s, r.UP_DOWN_CONTROLS) && e.signal(s, i)
        }
    }

    function d(e, t) {
        var n = browser.mozilla ? "keydown" : "keypress",
            a = Object(s.default)({
                signalTimer: !1
            }),
            d = function(e, t, n) {
                !n || inArray(u(n), r.UNPRINTABLE_KEYS) || Object(i.isSearchingInplace)(e.get().peer, e.get()) || Object(o.isEditableFocused)() || n.ctrlKey || browser.mac && n.metaKey || n.key && 1 !== n.key.length || t.signal("printable", n)
            }.bind(null, e, t),
            f = l.bind(null, t, e, a),
            p = function(e, t, n) {
                u(n) === r.ENTER && e.signal(u(n), n)
            }.bind(null, t, a),
            m = Object(c.createModule)({
                handlers: function(e, t) {
                    e(document, "keydown", f), e(document, "keyup", p), e(document, n, d)
                }
            });
        return {
            unmount: function() {
                Object(c.destroyModule)(m)
            }
        }
    }
}, function(e, t, n) {
    "use strict";

    function r() {
        var e = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || window.MediaDevices && window.MediaDevices.getUserMedia;
        e && !navigator.mediaDevices && (navigator.mediaDevices = navigator.mediaDevices || {}), navigator.mediaDevices && (navigator.mediaDevices.getUserMedia || (navigator.mediaDevices.getUserMedia = function(t) {
            return new Promise(function(n, r) {
                e ? e.call(navigator, t, n, r) : r(new Error("NotSupported"))
            })
        }), navigator.mediaDevices.enumerateDevices || (navigator.mediaDevices.enumerateDevices = function() {
            return new Promise(function(e, t) {
                if (MediaStreamTrack && MediaStreamTrack.getSources) {
                    var n = {
                        audio: "audioinput",
                        video: "videoinput"
                    };
                    return MediaStreamTrack.getSources(function(t) {
                        e(t.map(function(e) {
                            return {
                                label: e.label,
                                kind: n[e.kind],
                                deviceId: e.id,
                                groupId: ""
                            }
                        }))
                    })
                }
                t(new Error("NotSupported"))
            })
        })), window.AudioContext = window.AudioContext || window.webkitAudioContext, window.AudioContext && (window.AudioContext.prototype.createScriptProcessor = window.AudioContext.prototype.createScriptProcessor || window.AudioContext.prototype.createJavaScriptNode)
    }
    n.r(t), n.d(t, "initFailBack", function() {
        return r
    })
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        i = [],
        o = 0,
        a = !1;

    function s(e) {
        i = i.reduce(function(t, n) {
            var i = r(n, 2),
                o = i[0],
                a = i[1];
            return a(e) ? t : t.concat([
                [o, a]
            ])
        }, [])
    }
    t.default = function(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
        return o++, {
            stop: function() {
                o--,
                function(e) {
                    i = i.filter(function(t) {
                        return r(t, 1)[0] !== e
                    }), 0 === o && (document.body.removeEventListener("click", s, !0), a = !1)
                }(e)
            },
            replaceOrAdd: function(n) {
                var o = i.filter(function(t) {
                        var n = r(t, 1)[0];
                        return e === n
                    }),
                    c = function(e, t) {
                        return 0 === t.length ? function(t) {
                            return e(t), !0
                        } : function(n) {
                            var r = t.reduce(function(e, t) {
                                return e && !domClosest(t, n.target)
                            }, !0);
                            return r && e(n), r
                        }
                    }(n, t);
                o.length > 0 ? function(e, t) {
                    i = i.map(function(n) {
                        var i = r(n, 2),
                            o = i[0],
                            a = i[1];
                        return o === e ? [e, t] : [o, a]
                    })
                }(e, c) : function(e, t) {
                    !1 === a && (a = !0, document.body.addEventListener("click", s, !0)), i = i.concat([
                        [e, t]
                    ])
                }(e, c)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(102),
        i = n(194),
        o = "_ui_multiselect_cancel";

    function a(e) {
        return e.selection = [], Promise.resolve(e)
    }

    function s(e, t) {
        return t.selection = t.selection.filter(function(t) {
            return t.id !== e
        }), Promise.resolve(t)
    }

    function c(e, t, n, r) {
        e.set(a).then(u.bind(null, t, n, e, r))
    }

    function u(e, t, n, r) {
        var i = n.get().selection,
            a = uiSearch.getFieldEl(e);
        uiSearch.focus(e), i.length > 0 ? attr(a, "placeholder", "") : attr(a, "placeholder", unclean(getLang("mail_search_creation"))), t.innerHTML = i.map(function(e) {
            return '<div class="token">\n      <div class="token_title">' + e.name + '</div>\n      <div data-peer="' + e.id + '" class="token_del ' + o + '"></div>\n    </div>'
        }).join(""), toggleClass(e, "ui_multiselect_has_selection", i.length > 0), domFC(e).scrollTop += 50, r()
    }

    function l(e, t) {
        return showTooltip(t, {
            text: getLang("mail_create_chat_remove_user"),
            black: 1,
            shift: [15, 8],
            appendParentCls: "_wrap"
        })
    }

    function d(e, t, n) {
        uiSearch.init(e, {
            onChange: function(e, t, n, i) {
                e.set(r.setCurrentSearch.bind(null, n, !1)).then(t().onChange)
            }.bind(null, t, n)
        });
        var d = uiSearch.getFieldEl(e),
            f = ce("div", {
                className: "_ui_multiselection ui_multiselect_cnt"
            });
        d && d.parentNode.insertBefore(f, d);
        var p, m, g = (p = d, m = 0, function() {
            var e = p.offsetWidth;
            setStyle(p, {
                width: 1
            });
            var t = p.offsetLeft;
            m !== t ? (m = t, e = p.parentNode.offsetWidth, setStyle(p, {
                width: Math.max(30, e - t - 20)
            })) : setStyle(p, {
                width: e
            })
        });
        t.set(a);
        var h = function(e, t, n, r, i, o, a) {
                var c = intval(domData(a, "peer"));
                tooltips.hide(a), t.set(s.bind(null, c)).then(function(o) {
                    u(e, r, t, i), n().selectionDeleted(t, c)
                })
            }.bind(null, e, t, n, f, g),
            _ = function(t) {
                document.activeElement !== d && uiSearch.focus(e)
            },
            v = Object(i.createModule)({
                handlers: function(t, n) {
                    n(e, "click", o, h), n(e, "mouseover", o, l), t(e, "click", _)
                }
            });
        return {
            addSelection: function(n, r) {
                return t.set(function(e, t) {
                    return t.selection || (t.selection = []), t.selection.push(e), Promise.resolve(t)
                }.bind(null, {
                    id: n,
                    name: r
                })).then(u.bind(null, e, f, t, g))
            },
            removeSelection: function(n) {
                return t.set(s.bind(null, n)).then(u.bind(null, e, f, t, g))
            },
            resetSelection: function() {
                c(t, e, f, g)
            },
            focus: function() {
                uiSearch.focus(e)
            },
            save: function() {
                t.stash(), u(e, f, t, g)
            },
            restore: function() {
                t.pop(), u(e, f, t, g)
            },
            unmount: function() {
                uiSearch.destroy(e), Object(i.destroyModule)(v)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return g
    });
    var r = n(102),
        i = n(54),
        o = n(26),
        a = n(148),
        s = n(194),
        c = n(18),
        u = n(160),
        l = "_im_mess_fav",
        d = "_im_mess_reply",
        f = "_im_mess_edit";

    function p(e, t, n, r, o) {
        var s = Object(a.getPeer)(e),
            c = Object(a.getTab)(e, s),
            l = 105 + (Object(u.isPinnedMessageVisibleInTab)(e, Object(a.getPeer)(e)) || c && c.top_banner ? Object(i.getPinnedMessageHeight)() : 0);
        showTooltip(t, {
            shift: [n, 10],
            black: 1,
            className: "_im_history_tooltip " + r,
            appendParentCls: "_im_mess_stack",
            toup: t.getBoundingClientRect().top > l + 37,
            text: o
        })
    }

    function m(e, t, n, r) {
        var i = getLang("mail_im_toggle_important").length > 14;
        p(e, r, i ? 84 : 34, i ? "im-star-tt_long" : "im-star-tt", function() {
            var t = domData(gpeByClass("_im_mess", r), "msgid"),
                n = Object(a.getMessage)(e, e.get().peer, t);
            return n ? Object(o.isImportant)(n) ? getLang("mail_im_unmark_important") : getLang("mail_im_toggle_important") : ""
        })
    }

    function g(e, t, n) {
        var u = m.bind(null, t, 0),
            g = function(e, t, n) {
                var i = gpeByClass("_im_mess", n),
                    s = intval(domData(i, "msgid")),
                    u = e.get().peer,
                    l = Object(a.getMessage)(e, u, s),
                    d = !Object(o.isImportant)(l);
                return e.get().longpoll.push([{
                    peerId: u,
                    messageId: s,
                    type: d ? c.SET_FLAGS : c.RESET_FLAGS,
                    flags: c.FLAG_IMPORTANT
                }]), e.set(r.favMessage.bind(null, [s], d, u)), m(e, 0, 0, n), !1
            }.bind(null, t),
            h = function(e, t, n, r) {
                p(e, r, 18, "im-reply-tt", getLang("mail_im_reply"))
            }.bind(null, t, 0),
            _ = function(e, t, n) {
                var i = e.get().peer,
                    o = +domData(domClosest("im-mess", n.target), "msgid");
                return Object(r.processFwd)([o], i, e).then(function(t) {
                    return e.set(r.forwardMessages.bind(null, t, e.get().tfdraft))
                }).then(function() {
                    return t().respond(e, i)
                }), !1
            }.bind(null, t, n),
            v = function(e, t, n) {
                p(e, n, 18, "im-edit-tt", getLang("mail_im_edit"))
            }.bind(null, t),
            b = function(e, t, n, r) {
                var i = intval(domData(gpeByClass("_im_mess", r), "msgid")),
                    o = Object(a.getMessage)(e, e.get().peer, i);
                return o && t().startEditing(o), !1
            }.bind(null, t, n),
            y = Object(s.createModule)({
                handlers: function(t, n) {
                    n(e, "click", l, g), n(e, "mouseover", l, u), n(e, "click", d, _), n(e, "mouseover", d, h), n(e, "click", f, b), n(e, "mouseover", f, v)
                }
            });
        return function(e, t) {
            return {
                markImportant: function(t, n, r) {
                    Object(i.updateStar)(t, n, e)
                },
                unmount: function() {
                    Object(s.destroyModule)(t)
                }
            }
        }(e, y)
    }
}, function(e, t, n) {
    var r = n(4),
        i = n(198),
        o = n(215),
        a = Object.defineProperty;
    t.f = n(154) ? Object.defineProperty : function(e, t, n) {
        if (r(e), t = o(t, !0), r(n), i) try {
            return a(e, t, n)
        } catch (e) {}
        if ("get" in n || "set" in n) throw TypeError("Accessors not supported!");
        return "value" in n && (e[t] = n.value), e
    }
}, function(e, t, n) {
    var r = n(35),
        i = n(91).document,
        o = r(i) && r(i.createElement);
    e.exports = function(e) {
        return o ? i.createElement(e) : {}
    }
}, function(e, t, n) {
    e.exports = n(141)
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(194),
        i = n(102),
        o = n(148),
        a = n(54),
        s = "_im_top_banner_button",
        c = "_im_top_banner_hide";

    function u(e, t) {
        var n = geByClass1("_im_dialog_actions", e);
        toggleClass(n, "im-page--chat-header_top-banner", t)
    }

    function l(e, t) {
        var n = geByClass1(c, e);
        n && window.tooltips && tooltips.hide(n), u(e, !1), t.innerHTML = ""
    }

    function d(e, t, n) {
        var d = geByClass1("_im_top_banner", e),
            f = Object(r.createModule)({
                handlers: function(r, o) {
                    var u = geByClass1("_im_dialog_actions", e);
                    o(e, "click", c, function(r) {
                        t.set(i.hideTopBannerAction.bind(null, t.get().peer)), l(e, d);
                        var o = !!Object(a.renderPinnedMessage)(t);
                        Object(a.compensateHistoryHeightChange)(t, o, !0, n)
                    }), o(e, "click", s, function(r) {
                        var o = function(e, t, n, r) {
                                var o = domData(e, "payload");
                                return !!o && (t.set(i.callbackTopBannerAction.bind(null, t.get().peer, o)), l(n, r), !0)
                            }(r.target, t, e, d),
                            s = !!Object(a.renderPinnedMessage)(t);
                        Object(a.compensateHistoryHeightChange)(t, s, !o, n)
                    }), o(u, "mouseover", c, function(e, t) {
                        showTooltip(t, {
                            text: getLang("mail_top_banner_hide"),
                            black: 1,
                            shift: [8, 4],
                            appendEl: bodyNode
                        })
                    })
                }
            });
        return {
            renderPeer: function(t) {
                var r, i, s, c = Object(o.getTab)(t, t.get().peer).top_banner,
                    f = d.children.length;
                c && !Object(o.isSearchShown)(t) ? (u(e, !0), d.innerHTML = (i = (r = c).icon ? getTemplate("im_top_banner_icon", {
                    icon: r.icon
                }) : "", s = (s = (r.buttons || []).map(function(e) {
                    var t = "";
                    switch (e.layout) {
                        case "secondary":
                            t = "secondary";
                            break;
                        default:
                            t = "blue_button"
                    }
                    return "link" === e.type ? getTemplate("im_top_banner_button_link", {
                        link: e.link,
                        text: e.text,
                        css_class: t
                    }) : getTemplate("im_top_banner_button", {
                        callback_data: e.callback_data,
                        text: e.text,
                        css_class: t
                    })
                })).concat([getTemplate("im_top_banner_hide_btn", {})]), getTemplate("im_top_banner", {
                    text: r.text,
                    icon: i,
                    buttons: s.join("")
                }))) : d.children.length && l(e, d);
                var p = d.children.length;
                Object(a.compensateHistoryHeightChange)(t, p, f, n)
            },
            unmount: function() {
                Object(r.destroyModule)(f)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    var r;

    function i(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    n.r(t), n.d(t, "OUR_DOMAINS", function() {
        return o
    }), n.d(t, "ENTITIES", function() {
        return a
    }), n.d(t, "VK_DOMAIN", function() {
        return s
    }), n.d(t, "MENTION", function() {
        return c
    }), n.d(t, "MENTION_RAW", function() {
        return u
    }), n.d(t, "ARROW_UP", function() {
        return l
    }), n.d(t, "ARROW_DOWN", function() {
        return d
    }), n.d(t, "PAGE_UP", function() {
        return f
    }), n.d(t, "PAGE_DOWN", function() {
        return p
    }), n.d(t, "END_KEY", function() {
        return m
    }), n.d(t, "HOME", function() {
        return g
    }), n.d(t, "ENTER", function() {
        return h
    }), n.d(t, "ESC", function() {
        return _
    }), n.d(t, "UNPRINTABLE_KEYS", function() {
        return v
    }), n.d(t, "UP_DOWN_CONTROLS", function() {
        return b
    }), n.d(t, "PRINTABLE", function() {
        return y
    }), n.d(t, "FOLDER_UNREAD", function() {
        return w
    }), n.d(t, "FOLDER_ALL", function() {
        return O
    }), n.d(t, "FOLDER_UNRESPOND", function() {
        return C
    }), n.d(t, "FOLDER_IMPORTANT", function() {
        return k
    }), n.d(t, "FOLDERS", function() {
        return E
    }), n.d(t, "FOLDER_MASKS", function() {
        return j
    }), n.d(t, "TOP_DOMAINS", function() {
        return S
    }), n.d(t, "MAX_DOMAIN_LENGTH", function() {
        return T
    }), n.d(t, "EMAIL", function() {
        return I
    }), n.d(t, "MESSAGE_REGEXP", function() {
        return P
    }), n.d(t, "RE_HASHTAG_EXTRACTION_PATTERN", function() {
        return M
    });
    var o = /^([a-zA-Z0-9\.\_\-]+\.)?(vkontakte\.ru|vk\.com|vkadre\.ru|vshtate\.ru|userapi\.com|vk\.me)$/,
        a = /([^a-zA-Z0-9#%;_\-.\/?&=\[\]])/g,
        s = /^(?:https?:\/\/)?(?:vk\.com|vkontakte\.ru)?\/([a-zA-Z0-9\._]+)\??$/,
        c = /\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,
        u = /(^|[\s.,:\'\";>\)\(])(\*|@)([A-Za-z0-9_\.]{2,32})\s*\((.+?)\)/g,
        l = 38,
        d = 40,
        f = 33,
        p = 34,
        m = 35,
        g = 36,
        h = 13,
        _ = 27,
        v = [l, d, f, p, h, _, m, g],
        b = [f, p, d, l, g, m],
        y = "printable",
        w = "unread",
        O = "all",
        C = "unrespond",
        k = "important",
        E = [O, w, C, k],
        j = (i(r = {}, C, 2), i(r, k, 1), r),
        S = [].concat("aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","), "бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","), "qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map(function(e) {
            return "xn--" + e
        })),
        T = S.reduce(function(e, t) {
            return Math.max(e, t.length)
        }, 0),
        I = new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})))", "ig"),
        P = new RegExp("(https?:\\/\\/)?(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})(?:\\:(\\d{2,5}))?)(([\\/?#])(?:\\&amp;|\\&#\\d{2,6};|,[_%]|!|,*[\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$.~=;:'ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ　-〿＀-￯]+|(?:\\(|\\[)[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\d&#%;,]+(?:\\)|\\])){0,200})?", "ig"),
        M = "(^|[s.,:'\";>)(]?)((#(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)){0,100}(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?))(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)){0,100}))(@((?:[a-z0-9_]*[a-z0-9])?(?:(?:.[a-z](?:[a-z0-9_]+[a-z0-9])?)*.[a-z][a-z0-9_]{2,40}[a-z0-9])?))?(?=$|[s.,:'\"&;?<)(]?)"
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "vkLocal", function() {
        return o
    }), n.d(t, "lTimeout", function() {
        return a
    }), n.d(t, "rand", function() {
        return s
    }), n.d(t, "irand", function() {
        return c
    }), n.d(t, "isUndefined", function() {
        return u
    }), n.d(t, "isFunction", function() {
        return l
    }), n.d(t, "isArray", function() {
        return d
    }), n.d(t, "isString", function() {
        return f
    }), n.d(t, "isObject", function() {
        return p
    }), n.d(t, "isEmpty", function() {
        return m
    }), n.d(t, "vkNow", function() {
        return g
    }), n.d(t, "vkImage", function() {
        return h
    }), n.d(t, "trim", function() {
        return _
    }), n.d(t, "stripHTML", function() {
        return v
    }), n.d(t, "escapeRE", function() {
        return b
    }), n.d(t, "intval", function() {
        return y
    }), n.d(t, "floatval", function() {
        return w
    }), n.d(t, "positive", function() {
        return O
    }), n.d(t, "isNumeric", function() {
        return C
    }), n.d(t, "winToUtf", function() {
        return k
    }), n.d(t, "replaceEntities", function() {
        return E
    }), n.d(t, "clean", function() {
        return j
    }), n.d(t, "unclean", function() {
        return S
    }), n.d(t, "each", function() {
        return T
    }), n.d(t, "indexOf", function() {
        return I
    }), n.d(t, "inArray", function() {
        return P
    }), n.d(t, "clone", function() {
        return M
    }), n.d(t, "arrayKeyDiff", function() {
        return x
    }), n.d(t, "extend", function() {
        return L
    }), n.d(t, "addTemplates", function() {
        return A
    }), n.d(t, "getTemplate", function() {
        return N
    }), n.d(t, "serializeForm", function() {
        return D
    }), n.d(t, "extractUrls", function() {
        return B
    }), n.d(t, "isRetina", function() {
        return H
    }), n.d(t, "getCaretCharacterOffsetWithin", function() {
        return U
    }), n.d(t, "formatCount", function() {
        return z
    }), n.d(t, "encodeHtml", function() {
        return V
    }), n.d(t, "decodeHtml", function() {
        return K
    });
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        i = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };

    function o(e) {
        var t = PageID;
        return function() {
            t == PageID && e.apply(this, arguments)
        }
    }

    function a(e, t) {
        return setTimeout(o(e), t)
    }

    function s(e, t) {
        return Math.random() * (t - e + 1) + e
    }

    function c(e, t) {
        return Math.floor(s(e, t))
    }

    function u(e) {
        return void 0 === e
    }

    function l(e) {
        return e && "[object Function]" === Object.prototype.toString.call(e)
    }

    function d(e) {
        return "[object Array]" === Object.prototype.toString.call(e)
    }

    function f(e) {
        return "string" == typeof e
    }

    function p(e) {
        return "[object Object]" === Object.prototype.toString.call(e)
    }

    function m(e) {
        if ("[object Object]" !== Object.prototype.toString.call(e)) return !1;
        for (var t in e)
            if (e.hasOwnProperty(t)) return !1;
        return !0
    }

    function g() {
        return +new Date
    }

    function h() {
        return window.Image ? new Image : ce("img")
    }

    function _(e) {
        return (e || "").replace(/^\s+|\s+$/g, "")
    }

    function v(e) {
        return e ? e.replace(/<(?:.|\s)*?>/g, "") : ""
    }

    function b(e) {
        return e ? e.replace(/([.*+?^${}()|[\]\/\\])/g, "\\$1") : ""
    }

    function y(e) {
        return !0 === e ? 1 : parseInt(e) || 0
    }

    function w(e) {
        return !0 === e ? 1 : parseFloat(e) || 0
    }

    function O(e) {
        return (e = y(e)) < 0 ? 0 : e
    }

    function C(e) {
        return !isNaN(e)
    }

    function k(e) {
        return e.replace(/&#(\d\d+);/g, function(e, t) {
            return (t = y(t)) >= 32 ? String.fromCharCode(t) : e
        }).replace(/&quot;/gi, '"').replace(/&lt;/gi, "<").replace(/&gt;/gi, ">").replace(/&amp;/gi, "&")
    }

    function E(e) {
        return se("<textarea>" + (e || "").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;") + "</textarea>").value
    }

    function j(e) {
        return e ? e.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") : ""
    }

    function S(e) {
        return E(e.replace(/\t/g, "\n"))
    }

    function T(e, t) {
        if (p(e) || void 0 === e.length) {
            for (var n in e)
                if (Object.prototype.hasOwnProperty.call(e, n) && !1 === t.call(e[n], n, e[n])) break
        } else
            for (var r = 0, i = e.length; r < i; r++) {
                var o = e[r];
                if (!1 === t.call(o, r, o)) break
            }
        return e
    }

    function I(e, t, n) {
        for (var r = n || 0, i = (e || []).length; r < i; r++)
            if (e[r] == t) return r;
        return -1
    }

    function P(e, t) {
        return -1 != I(t, e)
    }

    function M(e, t) {
        var n = p(e) || void 0 === e.length ? {} : [];
        for (var r in e)(!/webkit/i.test(_ua) || "layerX" != r && "layerY" != r && "webkitMovementX" != r && "webkitMovementY" != r) && (t && "object" === i(e[r]) && "prototype" !== r && null !== e[r] ? n[r] = M(e[r]) : n[r] = e[r]);
        return n
    }

    function x(e) {
        var t, n, r = {},
            i = 1,
            o = arguments.length,
            a = arguments;
        for (t in e) {
            for (n = !1, i = 1; i < o; i++) a[i][t] && a[i][t] == e[t] && (n = !0);
            n || (r[t] = e[t])
        }
        return r
    }

    function L() {
        var e, t = arguments,
            n = t[0] || {},
            r = 1,
            o = t.length,
            a = !1;
        for ("boolean" == typeof n && (a = n, n = t[1] || {}, r = 2), "object" === (void 0 === n ? "undefined" : i(n)) || l(n) || (n = {}); r < o; ++r)
            if (null != (e = t[r]))
                for (var s in e) {
                    var c = n[s],
                        u = e[s];
                    n !== u && (a && u && "object" === (void 0 === u ? "undefined" : i(u)) && !u.nodeType ? n[s] = L(a, c || (null != u.length ? [] : {}), u) : void 0 !== u && (n[s] = u))
                }
        return n
    }

    function A(e) {
        window.templates = window.templates || {}, L(window.templates, e)
    }

    function N(e, t) {
        var n = (window.templates = window.templates || {})[e];
        return "function" == typeof n && (n = n()), n && t ? rs(n, t) : n || ""
    }

    function D(e) {
        if ("object" != (void 0 === e ? "undefined" : i(e))) return !1;
        var t = {},
            n = function(t) {
                return geByTag(t, e)
            },
            r = function(n, r) {
                if (r.name)
                    if ("text" != r.type && r.type)
                        if (r.getAttribute("bool")) {
                            var i = val(r);
                            if (!i || "0" === i) return;
                            t[r.name] = 1
                        } else t[r.name] = browser.msie && !r.value && e[r.name] ? e[r.name].value : r.value;
                else t[r.name] = val(r)
            };
        return T(n("input"), function(e, t) {
            if ("radio" != t.type && "checkbox" != t.type || t.checked) return r(0, t)
        }), T(n("select"), r), T(n("textarea"), r), t
    }
    window.PageID = window.PageID || 1;
    var R = /(?:([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9_\-]+\.)+(?:[a-z]{2,9}|xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)]*(&nbsp;|[ \t\r\n \u00A0]))|([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9а-яєґї_\-]+\.)+(?:рф|укр|онлайн|сайт|срб))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)]*(&nbsp;|[ \t\r\n \u00A0])))/i,
        F = /(?:([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9_\-]+\.)+(?:[a-z]{2,9}|xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)&]*(&nbsp;|[ \t\r\n \u00A0]|$))|([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9а-яєґї_\-]+\.)+(?:рф|укр|онлайн|сайт|срб))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)&]*(&nbsp;|[ \t\r\n \u00A0]|$)))/i;

    function B(e, t) {
        for (var n, r = t ? F : R, i = []; e && (n = e.match(r));) {
            e = e.substr(n.index + n[0].length);
            var o = 0;
            n[4] || (o = 7), i.push({
                url: n[2 + o],
                query: n[5 + o] || "",
                domain: n[4 + o]
            })
        }
        return i
    }

    function H() {
        return window.devicePixelRatio >= 2
    }

    function U(e) {
        var t = 0,
            n = 0,
            r = e.ownerDocument || e.document,
            i = r.defaultView || r.parentWindow;
        if (i.getSelection().rangeCount > 0) {
            var o = i.getSelection().getRangeAt(0),
                a = o.cloneRange();
            a.selectNodeContents(e), a.setEnd(o.startContainer, o.startOffset), t = a.toString().length, a.setEnd(o.endContainer, o.endOffset), n = a.toString().length
        }
        return [t, n]
    }

    function z(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
            n = t.kLimit || 1e3;
        return e >= (t.mLimit || 1e6) && !t.noCheck ? z(e = (e = y(e / 1e5)) > 1e3 ? y(e / 10) : e / 10, L(t, {
            noCheck: !0
        }), !0) + "M" : e >= n && !t.noCheck ? z(e = (e = y(e / 100)) > 100 ? y(e / 10) : e / 10, L(t, {
            noCheck: !0
        }), !0) + "K" : langNumeric(e, "%s", !0).replace(/,/g, ".")
    }
    var G, W = r((G = null, [function(e) {
            return G || (G = se("<span> </span>")), G.innerText = e, G.innerHTML.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;")
        }, function(e) {
            return G || (G = se("<span> </span>")), G.innerHTML = e, G.innerText
        }]), 2),
        V = W[0],
        K = W[1];
    window.isRetina = H, window.extractUrls = B, window.serializeForm = D, window.addTemplates = A, window.getTemplate = N, window.rand = s, window.irand = c, window.isUndefined = u, window.isFunction = l, window.isArray = d, window.isString = f, window.isObject = p, window.isEmpty = m, window.vkNow = g, window.vkImage = h, window.trim = _, window.stripHTML = v, window.escapeRE = b, window.intval = y, window.floatval = w, window.positive = O, window.isNumeric = C, window.winToUtf = k, window.replaceEntities = E, window.clean = j, window.unclean = S, window.each = T, window.indexOf = I, window.inArray = P, window.clone = M, window.arrayKeyDiff = x, window.extend = L, window.vkLocal = o, window.lTimeout = a, window.getCaretCharacterOffsetWithin = U, window.formatCount = z, window.encodeHtml = V, window.decodeHtml = K
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(65),
        o = n(137),
        a = n(135),
        s = n(38),
        c = n(178),
        u = n(175),
        l = n(132),
        d = n(96),
        f = n(202),
        p = n(216),
        m = n(102),
        g = n(30),
        h = n(54),
        _ = n(148),
        v = n(187),
        b = n(18),
        y = n(109),
        w = n(114),
        O = n(151),
        C = n(118),
        k = n(90),
        E = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        },
        j = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var S = Object(g.debouncedPromise)(m.searchHints, 300),
        T = window,
        I = T.Emoji,
        P = T.langNumeric,
        M = y.default.getLang,
        x = 38,
        L = 27,
        A = 40,
        N = 13,
        D = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.toggleMode = function() {
                    var e = r.props.store;
                    if (Object(_.isCommunityInterface)(e)) {
                        var t = 0 === r.state.mode ? 1 : 0,
                            n = 0 === t ? m.searchImTopConv : m.searchTopConv;
                        r.setState({
                            value: "",
                            mode: t,
                            loading: !0,
                            selected: null,
                            found: []
                        }, function() {
                            return n("", e.get()).then(function(e) {
                                return r.setSearchResults(r.filterResults(e))
                            }).then(function() {
                                return r.searchInput.focus()
                            }).catch(function(e) {
                                return console.error(e)
                            })
                        })
                    }
                }, r.onChange = function(e) {
                    r.setState({
                        value: e.target.value,
                        loading: !0,
                        error: null
                    });
                    var t = e.target.value;
                    r.searchQuery !== t && (r.searchQuery = t, r.onSearch(t))
                }, r.filterResults = function(e) {
                    var t = Object(_.isCommunityInterface)(r.props.store) && 1 === r.state.mode;
                    return e.filter(function(e) {
                        var n = e.peerId;
                        return !(t && n < 0) && (!(t && n > 2e9 && !Object(v.doesChatTabHaveFlag)(e, 1024)) && !(!t && n > 2e9 && Object(v.doesChatTabHaveFlag)(e, 1024)))
                    })
                }, r.onSearch = function(e) {
                    var t = r.props.store,
                        n = t.get(),
                        i = Object(_.isCommunityInterface)(t) && 0 === r.state.mode,
                        o = i ? m.searchImTopConv : m.searchTopConv;
                    return 1 === r.state.mode && "" === e ? r.emptySearch().then(function(e) {
                        r.setSearchResults(r.filterResults(e))
                    }) : o(e, n).then(function(t) {
                        var o = t.map(function(e) {
                            return e.peerId
                        });
                        return t = r.filterResults(t), r.setSearchResults(t, !1, !t.length), e ? S(e, o, "all", {
                            hidegid: i
                        }, n) : Promise.resolve([])
                    }).then(function(t) {
                        e === r.state.value && r.setSearchResults(r.filterResults(t), !0)
                    }).catch(function() {})
                }, r.emptySearch = function() {
                    var e = r.props.store,
                        t = e.get(),
                        n = t.dialog_tabs.all,
                        i = {},
                        o = {};
                    return Object(m.searchTopConv)("", t).then(function(t) {
                        return t.forEach(function(e) {
                            o[e.peerId] = e
                        }), n.map(function(t) {
                            var n = Object(_.getTab)(e, t);
                            return i[t] = !0, {
                                name: o[t] && o[t].name || n.name,
                                photo: o[t] && o[t].photo || n.photo,
                                data: n.data,
                                peerId: t
                            }
                        }).concat(t.filter(function(e) {
                            return !i[e.peerId]
                        }))
                    })
                }, r.sendRecipient = function(e) {
                    var t = r.props.store,
                        n = t.get();
                    1 === r.state.mode ? (n.longpoll.push([Object(b.changePeer)(e, !1, !0, !0, "forward_messages_popup")]), Object(w.statlogsForwardEvent)(t), Object(_.isCommunityInterface)(t) && Object(w.statlogsForwardFromCommunityEvent)(t, !1)) : r.setState({
                        selected: e,
                        error: null
                    }, function() {
                        I.focus(r.input)
                    })
                }, r.cleanSelectedRecipient = function() {
                    r.setState({
                        activeElement: -1
                    })
                }, r.scrollToSelectedUser = function() {
                    var e = r.state,
                        t = e.found,
                        n = e.activeElement,
                        i = r.scrollContainer;
                    if (i) {
                        var o = i.querySelector('[data-id="' + t[n].peerId + '"]');
                        if (o)
                            if (o.offsetTop < i.scrollTop) i.scrollTop = o.offsetTop;
                            else {
                                var a = o.offsetTop + o.offsetHeight;
                                a > i.scrollTop + i.offsetHeight && (i.scrollTop = a - i.offsetHeight)
                            }
                        else i.scrollTop = (i.childNodes[1].offsetHeight || 0) * n
                    }
                }, r.selectRecipient = function(e) {
                    var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],
                        n = r.validateActiveElement(e);
                    r.state.activeElement !== n && r.setState({
                        activeElement: n
                    }, function() {
                        t && r.scrollToSelectedUser()
                    })
                }, r.onClick = function(e) {
                    return r.sendRecipient(Number(e.currentTarget.getAttribute("data-id")))
                }, r.loadMore = function() {}, r.setSearchResults = function(e, t) {
                    var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                    if (!r.unmounted)
                        if (t) {
                            var i = e.filter(function(e) {
                                return !r.found[e.peerId]
                            });
                            i.forEach(function(e) {
                                r.found[e.peerId] = !0
                            }), r.setState({
                                found: [].concat(r.state.found, i),
                                loading: n
                            })
                        } else r.found = e.reduce(function(e, t) {
                            return e[t.peerId] = !0, e
                        }, {}), r.setState({
                            found: e,
                            loading: n,
                            activeElement: 0
                        })
                }, r.getFormRef = function(e) {
                    r.form = e
                }, r.getInputRef = function(e) {
                    r.input = e
                }, r.getSearchRef = function(e) {
                    r.searchInput = e && e.element
                }, r.getScrollContainerRef = function(e) {
                    r.scrollContainer = i.findDOMNode(e)
                }, r.getEmojiButtonRef = function(e) {
                    r.emojiButton = e
                }, r.onEmojiButtonMouseOver = function(e) {
                    e.persist(), I.show(r.emojiButton, e)
                }, r.onEmojiButtonMouseOut = function(e) {
                    e.persist(), I.hide(r.emojiButton, e)
                }, r.send = function() {
                    var e = r.props.store,
                        t = r.state.selected,
                        n = I.val(r.input).trim(),
                        i = new C.ImDraft({}, 0),
                        o = e.get().pendingForward;
                    if (t && !Object(h.isMessageTooLong)(val)) {
                        r.setState({
                            sending: !0
                        });
                        var a = Object(_.isCommunityInterface)(e) && 0 === r.state.mode;
                        a || i.addAttach("mail", o.msgIds.join(";"), o.object || null);
                        var s = {
                                message: n,
                                attaches: i.dData.attaches.map(function(e) {
                                    return [e.type, e.id]
                                }) || []
                            },
                            c = {
                                hidegid: !0,
                                external: {
                                    original_gid: e.get().id,
                                    fwd_group_msg_ids: a ? o.msgIds.join(";") : void 0
                                }
                            };
                        new Promise(function(n) {
                            Object(m.loadHashes)([t], {
                                hidegid: !0
                            }, e.get()).then(function(e) {
                                var r = j(e, 1)[0];
                                return n(r[t])
                            })
                        }).then(function(n) {
                            return e.set(m.sendMessage.bind(null, t, s, E({
                                hash: n
                            }, c)))
                        }).then(function() {
                            Object(w.statlogsForwardFromCommunityEvent)(e, !0), e.setState({
                                pendingForward: null
                            }), r.props.closePopup(), showDoneBox(M("mail_send3"))
                        }).catch(function(e) {
                            r.unmounted || r.setState({
                                sending: !1
                            }, function() {
                                showFastBox(M("mail_error"), e)
                            })
                        })
                    }
                }, r.onSearchKeyDown = function(e) {
                    e.keyCode === L && r.state.value && (r.searchInput.blur(), r.searchQuery = "", r.setState({
                        value: "",
                        loading: !0,
                        error: null
                    }, r.onSearch.bind(r, "")), e.stopPropagation())
                }, r.onMessageInputKeyDown = function(e) {
                    e.keyCode === L && (r.state.sending || (I.val(r.input, ""), r.setState({
                        selected: null
                    }), r.searchInput.focus()), e.stopPropagation())
                }, r.onKeydown = function(e) {
                    var t = r.state.activeElement;
                    switch (e.which || e.keyCode) {
                        case x:
                            r.selectRecipient(t - 1), e.preventDefault();
                            break;
                        case A:
                            r.selectRecipient(t + 1), e.preventDefault();
                            break;
                        case N:
                            var n = r.state,
                                i = n.found,
                                o = n.activeElement;
                            i[o] && (r.sendRecipient(i[o].peerId), e.preventDefault())
                    }
                }, r.state = {
                    value: "",
                    found: [],
                    mode: 1,
                    loading: !0,
                    sending: !1,
                    selected: null,
                    activeElement: 0
                }, r.emptySearch().then(function(e) {
                    r.setSearchResults(r.filterResults(e))
                }).catch(function(e) {
                    return console.error(e)
                }), r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.getMembersCount = function(e) {
                if (!Object(h.isChatPeer)(e)) return "";
                var t = this.props.store,
                    n = Object(_.getTab)(t, e);
                return n && n.membersCount ? P(n.membersCount, M("mail_im_n_chat_members", "raw")) : ""
            }, t.prototype.validateActiveElement = function(e) {
                return e > this.state.found.length - 1 ? this.state.found.length - 1 : e < 0 ? 0 : e
            }, t.prototype.componentDidMount = function() {
                this.props.updatePopup(), I.init(this.input, {
                    noStickers: !0,
                    onSend: this.send
                }), this.input.addEventListener("keydown", this.onMessageInputKeyDown), this.searchInput.addEventListener("keydown", this.onKeydown), this.searchInput.addEventListener("keydown", this.onSearchKeyDown)
            }, t.prototype.componentWillUnmount = function() {
                this.input.removeEventListener("keydown", this.onMessageInputKeyDown), this.searchInput.removeEventListener("keydown", this.onKeydown), this.searchInput.removeEventListener("keydown", this.onSearchKeyDown), this.unmounted = !0
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.store,
                    i = t.closePopup,
                    m = this.state,
                    g = m.mode,
                    h = m.loading,
                    v = m.selected,
                    b = m.found,
                    y = m.sending,
                    w = m.activeElement;
                return r.createElement("section", {
                    className: Object(O.classNames)("MessageForward", {
                        "MessageForward--form": 0 === g && !!v
                    })
                }, r.createElement(o.default, {
                    title: r.createElement(r.Fragment, null, r.createElement("span", {
                        className: "MessageForward__title"
                    }, M("mail_forward_messages")), Object(_.isCommunityInterface)(n) && r.createElement("span", {
                        className: "MessageForward__switch",
                        onClick: this.toggleMode
                    }, M(0 === g ? "mail_forward_to_community_messages" : "mail_forward_to_im"))),
                    onCloseClick: i
                }), r.createElement("div", {
                    className: "MessageForward__content",
                    onMouseLeave: this.cleanSelectedRecipient
                }, r.createElement(u.default, {
                    value: this.state.value,
                    onChange: this.onChange,
                    placeholder: M("mail_top_search"),
                    autoFocus: !0,
                    key: "search",
                    ref: this.getSearchRef
                }), h && r.createElement("div", {
                    className: "MessageForward__results",
                    key: "loading"
                }, r.createElement(f.default, {
                    className: "MessageForward__stub"
                }, r.createElement(p.default, null))), !h && 0 === b.length && r.createElement("div", {
                    className: "MessageForward__results",
                    key: "no-results"
                }, r.createElement(f.default, null, M("mail_im_search_empty_chats"))), !h && b.length > 0 && r.createElement(a.default, {
                    virtualized: !0,
                    className: "MessageForward__results",
                    loadMore: this.loadMore,
                    hasMore: !1,
                    ref: this.getScrollContainerRef,
                    key: "results"
                }, b.map(function(t, i) {
                    var o = t.peerId,
                        a = t.name,
                        u = t.photo,
                        f = t.online;
                    return r.createElement(s.default, {
                        key: o,
                        "data-id": o,
                        onClick: e.onClick,
                        chevron: 1 === g,
                        active: i === w,
                        canBeHovered: !1,
                        onMouseEnter: e.selectRecipient.bind(null, i, !1),
                        aside: 0 === g ? r.createElement("span", {
                            className: Object(O.classNames)("MessageForward__radio", {
                                "MessageForward__radio--selected": +v === o
                            })
                        }) : ""
                    }, r.createElement(c.default, {
                        size: "34",
                        title: a,
                        photo: Array.isArray(u) ? r.createElement(d.default, {
                            photos: u
                        }) : r.createElement(l.default, {
                            online: (Object(_.getTab)(n, o) || {}).online || f,
                            title: a,
                            photo: u
                        }),
                        description: e.getMembersCount(o)
                    }))
                })), r.createElement("footer", {
                    className: "MessageForward__footer",
                    ref: this.getFormRef,
                    key: "footer"
                }, r.createElement("div", {
                    className: "MessageForward__form _emoji_field_wrap"
                }, r.createElement("div", {
                    className: "MessageForward__input",
                    tabIndex: "0",
                    contentEditable: !0,
                    role: "textbox",
                    "aria-multiline": !0,
                    ref: this.getInputRef,
                    placeholder: M("mail_im_enter_msg")
                }), r.createElement("div", {
                    className: "MessageForward__emoji emoji_smile_wrap _emoji_wrap"
                }, r.createElement("div", {
                    ref: this.getEmojiButtonRef,
                    className: "emoji_smile _emoji_btn",
                    title: M("global_emoji_hint"),
                    onMouseOver: this.onEmojiButtonMouseOver,
                    onMouseOut: this.onEmojiButtonMouseOut,
                    onClick: this.onEmojiButtonClick
                }, r.createElement("div", {
                    className: "emoji_smile_icon_vector emoji_smile_icon"
                })))), y ? r.createElement("div", {
                    className: "MessageForward__send-spinner"
                }, r.createElement(p.default, null)) : r.createElement("button", {
                    className: "MessageForward__send",
                    onClick: this.send
                }))))
            }, t
        }(r.Component);
    t.default = Object(k.connect)(D)
}, function(e, t, n) {
    "use strict";
    var r = Object.getOwnPropertySymbols,
        i = Object.prototype.hasOwnProperty,
        o = Object.prototype.propertyIsEnumerable;
    e.exports = function() {
        try {
            if (!Object.assign) return !1;
            var e = new String("abc");
            if (e[5] = "de", "5" === Object.getOwnPropertyNames(e)[0]) return !1;
            for (var t = {}, n = 0; n < 10; n++) t["_" + String.fromCharCode(n)] = n;
            if ("0123456789" !== Object.getOwnPropertyNames(t).map(function(e) {
                    return t[e]
                }).join("")) return !1;
            var r = {};
            return "abcdefghijklmnopqrst".split("").forEach(function(e) {
                r[e] = e
            }), "abcdefghijklmnopqrst" === Object.keys(Object.assign({}, r)).join("")
        } catch (e) {
            return !1
        }
    }() ? Object.assign : function(e, t) {
        for (var n, a, s = function(e) {
                if (null === e || void 0 === e) throw new TypeError("Object.assign cannot be called with null or undefined");
                return Object(e)
            }(e), c = 1; c < arguments.length; c++) {
            for (var u in n = Object(arguments[c])) i.call(n, u) && (s[u] = n[u]);
            if (r) {
                a = r(n);
                for (var l = 0; l < a.length; l++) o.call(n, a[l]) && (s[a[l]] = n[a[l]])
            }
        }
        return s
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151));
    var o = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.onError = function() {
                r.setState({
                    errored: !0
                })
            }, r.state = {}, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.photo,
                n = e.title,
                o = e.online;
            return r.createElement("div", {
                className: Object(i.classNames)("Avatar", {
                    "Avatar--online": o,
                    "Avatar--mobile": mobPlatforms[o]
                })
            }, r.createElement("div", {
                className: "Avatar__wrapper"
            }, r.createElement("img", {
                onError: this.onError,
                className: "Avatar__img",
                src: this.state.errored ? "/images/camera_c.gif" : t,
                alt: n
            })))
        }, t
    }(r.Component);
    t.default = o
}, function(e, t) {
    t.f = {}.propertyIsEnumerable
}, function(e, t, n) {
    "use strict";
    var r = !("undefined" == typeof window || !window.document || !window.document.createElement),
        i = {
            canUseDOM: r,
            canUseWorkers: "undefined" != typeof Worker,
            canUseEventListeners: r && !(!window.addEventListener && !window.attachEvent),
            canUseViewport: r && !!window.screen,
            isInWorker: !r
        };
    e.exports = i
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(89)),
        o = n(216),
        a = n(151),
        s = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var c = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.checkLoad = Object(i.default)(function(e) {
                var t = s(e, 3),
                    n = t[0],
                    i = t[1],
                    o = t[2];
                if (!r.loading) return r.props.virtualized || r.props.hasMore ? void(i - n - o <= r.props.threshold && (r.loading = !0, r.props.loadMore().then(function() {
                    r.loading = !1
                }))) : r.detachListeners()
            }, 34), r.onScroll = function(e) {
                var t = r.getScrollData();
                r.props.virtualized && r.processChildren(r.props.children, t), r.props.hasMore && r.checkLoad(t)
            }, r.getRef = function(e) {
                r.container = e, r.props.virtualized && r.setState(r.getChildrenData(r.props.children, r.getScrollData()))
            }, r.useWindowScroll = n.useWindowScroll, n.virtualized && (r.state = {
                before: 0,
                after: n.children.length,
                start: 0,
                end: 0
            }), r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.getScrollData = function() {
            var e = this.useWindowScroll ? document.documentElement : this.container;
            return [this.getScrollTop(), e ? e.scrollHeight : 0, e ? e.clientHeight : 0]
        }, t.prototype.getScrollTop = function() {
            var e = document.documentElement || document.body.parentNode || document.body;
            return this.useWindowScroll ? void 0 !== window.pageYOffset ? window.pageYOffset : e.scrollTop : this.container ? this.container.scrollTop : 0
        }, t.prototype.attachListeners = function() {
            var e = this.useWindowScroll ? window : this.container;
            this.container && (e.addEventListener("scroll", this.onScroll, this.props.useCapture), e.addEventListener("resize", this.onScroll, this.props.useCapture))
        }, t.prototype.detachListeners = function() {
            var e = this.useWindowScroll ? window : this.container;
            this.container && (e.removeEventListener("scroll", this.onScroll, this.props.useCapture), e.removeEventListener("resize", this.onScroll, this.props.useCapture))
        }, t.prototype.processChildren = function(e, t) {
            var n = this.state,
                r = this.getChildrenData(e, t || this.getScrollData()),
                i = r.start,
                o = r.end,
                a = r.before,
                s = r.after;
            i === n.start && o === n.end && a === n.before && s === n.after || this.setState(r)
        }, t.prototype.getChildrenData = function(e, t) {
            var n = s(t, 3),
                r = n[0],
                i = n[1],
                o = n[2],
                a = this.useWindowScroll ? window : this.container,
                c = a && a.offsetHeight;
            if (!a || 0 === i || 0 === o) return {
                start: 0,
                end: 0,
                before: 0,
                after: e.length
            };
            o = Math.max(o, c);
            var u = e.length,
                l = Math.max(Math.floor(r / this.props.itemHeight) - 1, 0),
                d = Math.min(Math.floor((r + 2 * o) / this.props.itemHeight + 1), u);
            return {
                start: l,
                end: d,
                before: l,
                after: u - d
            }
        }, t.prototype.componentWillReceiveProps = function(e) {
            this.props.virtualized && this.processChildren(e.children)
        }, t.prototype.componentDidMount = function() {
            this.attachListeners()
        }, t.prototype.componentWillUnmount = function() {
            this.detachListeners()
        }, t.prototype.render = function() {
            return r.createElement("div", {
                className: Object(a.classNames)("InfiniteScroll", this.props.className),
                ref: this.getRef,
                style: this.props.style
            }, this.props.virtualized && this.state.before > 0 && r.createElement("div", {
                style: {
                    height: this.state.before * this.props.itemHeight
                },
                key: "before"
            }), this.props.virtualized ? [].concat(this.props.children).slice(this.state.start, this.state.end) : this.props.children, this.props.virtualized && this.state.after > 0 && r.createElement("div", {
                style: {
                    height: this.state.after * this.props.itemHeight
                },
                key: "after"
            }), this.props.hasMore && (this.props.loader || r.createElement("div", {
                className: "InfiniteScroll__loader",
                key: "loader"
            }, r.createElement(o.default, null))))
        }, t
    }(r.Component);
    t.default = c, c.defaultProps = {
        useWindowScroll: !1,
        virtualized: !1,
        hasMore: !0,
        useCapture: !1,
        threshold: 100,
        itemHeight: 55
    }
}, function(e, t, n) {
    "use strict";
    var r = n(185),
        i = n(98),
        o = n(41),
        a = {};
    n(34)(a, n(68)("iterator"), function() {
        return this
    }), e.exports = function(e, t, n) {
        e.prototype = r(a, {
            next: i(1, n)
        }), o(e, t + " Iterator")
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return o
    });
    var r = n(188),
        i = (n(195), n(151));

    function o(e) {
        return r.createElement("header", {
            className: Object(i.classNames)("PopupHeader", e.className),
            style: e.style
        }, e.back && r.createElement("div", {
            className: "PopupHeader__back",
            onClick: e.onBackClick
        }, r.createElement("button", {
            className: "PopupHeader__backBtn",
            onClick: e.onBackClick
        }, e.back)), r.createElement("h2", {
            className: "PopupHeader__title"
        }, e.title), r.createElement("div", {
            className: "PopupHeader__close"
        }, r.createElement("button", {
            className: "PopupHeader__closeBtn",
            onClick: e.onCloseClick
        })))
    }
    o.defaultProps = {
        back: null,
        title: "",
        onCloseClick: function() {}
    }
}, function(e, t, n) {
    "use strict";
    var r = Object.prototype.hasOwnProperty;

    function i(e, t) {
        return e === t ? 0 !== e || 0 !== t || 1 / e == 1 / t : e != e && t != t
    }
    e.exports = function(e, t) {
        if (i(e, t)) return !0;
        if ("object" != typeof e || null === e || "object" != typeof t || null === t) return !1;
        var n = Object.keys(e),
            o = Object.keys(t);
        if (n.length !== o.length) return !1;
        for (var a = 0; a < n.length; a++)
            if (!r.call(t, n[a]) || !i(e[n[a]], t[n[a]])) return !1;
        return !0
    }
}, function(e, t, n) {
    var r = n(107),
        i = n(68)("iterator"),
        o = Array.prototype;
    e.exports = function(e) {
        return void 0 !== e && (r.Array === e || o[i] === e)
    }
}, function(e, t, n) {
    "use strict";
    var r = n(1),
        i = n(174),
        o = n(164),
        a = n(82),
        s = "function" == typeof Symbol && Symbol.for,
        c = s ? Symbol.for("react.element") : 60103,
        u = s ? Symbol.for("react.portal") : 60106,
        l = s ? Symbol.for("react.fragment") : 60107,
        d = s ? Symbol.for("react.strict_mode") : 60108,
        f = s ? Symbol.for("react.profiler") : 60114,
        p = s ? Symbol.for("react.provider") : 60109,
        m = s ? Symbol.for("react.context") : 60110,
        g = s ? Symbol.for("react.async_mode") : 60111,
        h = s ? Symbol.for("react.forward_ref") : 60112;
    s && Symbol.for("react.timeout");
    var _ = "function" == typeof Symbol && Symbol.iterator;

    function v(e) {
        for (var t = arguments.length - 1, n = "https://reactjs.org/docs/error-decoder.html?invariant=" + e, r = 0; r < t; r++) n += "&args[]=" + encodeURIComponent(arguments[r + 1]);
        i(!1, "Minified React error #" + e + "; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ", n)
    }
    var b = {
        isMounted: function() {
            return !1
        },
        enqueueForceUpdate: function() {},
        enqueueReplaceState: function() {},
        enqueueSetState: function() {}
    };

    function y(e, t, n) {
        this.props = e, this.context = t, this.refs = o, this.updater = n || b
    }

    function w() {}

    function O(e, t, n) {
        this.props = e, this.context = t, this.refs = o, this.updater = n || b
    }
    y.prototype.isReactComponent = {}, y.prototype.setState = function(e, t) {
        "object" != typeof e && "function" != typeof e && null != e && v("85"), this.updater.enqueueSetState(this, e, t, "setState")
    }, y.prototype.forceUpdate = function(e) {
        this.updater.enqueueForceUpdate(this, e, "forceUpdate")
    }, w.prototype = y.prototype;
    var C = O.prototype = new w;
    C.constructor = O, r(C, y.prototype), C.isPureReactComponent = !0;
    var k = {
            current: null
        },
        E = Object.prototype.hasOwnProperty,
        j = {
            key: !0,
            ref: !0,
            __self: !0,
            __source: !0
        };

    function S(e, t, n) {
        var r = void 0,
            i = {},
            o = null,
            a = null;
        if (null != t)
            for (r in void 0 !== t.ref && (a = t.ref), void 0 !== t.key && (o = "" + t.key), t) E.call(t, r) && !j.hasOwnProperty(r) && (i[r] = t[r]);
        var s = arguments.length - 2;
        if (1 === s) i.children = n;
        else if (1 < s) {
            for (var u = Array(s), l = 0; l < s; l++) u[l] = arguments[l + 2];
            i.children = u
        }
        if (e && e.defaultProps)
            for (r in s = e.defaultProps) void 0 === i[r] && (i[r] = s[r]);
        return {
            $$typeof: c,
            type: e,
            key: o,
            ref: a,
            props: i,
            _owner: k.current
        }
    }

    function T(e) {
        return "object" == typeof e && null !== e && e.$$typeof === c
    }
    var I = /\/+/g,
        P = [];

    function M(e, t, n, r) {
        if (P.length) {
            var i = P.pop();
            return i.result = e, i.keyPrefix = t, i.func = n, i.context = r, i.count = 0, i
        }
        return {
            result: e,
            keyPrefix: t,
            func: n,
            context: r,
            count: 0
        }
    }

    function x(e) {
        e.result = null, e.keyPrefix = null, e.func = null, e.context = null, e.count = 0, 10 > P.length && P.push(e)
    }

    function L(e, t, n, r) {
        var i = typeof e;
        "undefined" !== i && "boolean" !== i || (e = null);
        var o = !1;
        if (null === e) o = !0;
        else switch (i) {
            case "string":
            case "number":
                o = !0;
                break;
            case "object":
                switch (e.$$typeof) {
                    case c:
                    case u:
                        o = !0
                }
        }
        if (o) return n(r, e, "" === t ? "." + A(e, 0) : t), 1;
        if (o = 0, t = "" === t ? "." : t + ":", Array.isArray(e))
            for (var a = 0; a < e.length; a++) {
                var s = t + A(i = e[a], a);
                o += L(i, s, n, r)
            } else if (null === e || void 0 === e ? s = null : s = "function" == typeof(s = _ && e[_] || e["@@iterator"]) ? s : null, "function" == typeof s)
                for (e = s.call(e), a = 0; !(i = e.next()).done;) o += L(i = i.value, s = t + A(i, a++), n, r);
            else "object" === i && v("31", "[object Object]" === (n = "" + e) ? "object with keys {" + Object.keys(e).join(", ") + "}" : n, "");
        return o
    }

    function A(e, t) {
        return "object" == typeof e && null !== e && null != e.key ? function(e) {
            var t = {
                "=": "=0",
                ":": "=2"
            };
            return "$" + ("" + e).replace(/[=:]/g, function(e) {
                return t[e]
            })
        }(e.key) : t.toString(36)
    }

    function N(e, t) {
        e.func.call(e.context, t, e.count++)
    }

    function D(e, t, n) {
        var r = e.result,
            i = e.keyPrefix;
        e = e.func.call(e.context, t, e.count++), Array.isArray(e) ? R(e, r, n, a.thatReturnsArgument) : null != e && (T(e) && (t = i + (!e.key || t && t.key === e.key ? "" : ("" + e.key).replace(I, "$&/") + "/") + n, e = {
            $$typeof: c,
            type: e.type,
            key: t,
            ref: e.ref,
            props: e.props,
            _owner: e._owner
        }), r.push(e))
    }

    function R(e, t, n, r, i) {
        var o = "";
        null != n && (o = ("" + n).replace(I, "$&/") + "/"), t = M(t, o, r, i), null == e || L(e, "", D, t), x(t)
    }
    var F = {
            Children: {
                map: function(e, t, n) {
                    if (null == e) return e;
                    var r = [];
                    return R(e, r, null, t, n), r
                },
                forEach: function(e, t, n) {
                    if (null == e) return e;
                    t = M(null, null, t, n), null == e || L(e, "", N, t), x(t)
                },
                count: function(e) {
                    return null == e ? 0 : L(e, "", a.thatReturnsNull, null)
                },
                toArray: function(e) {
                    var t = [];
                    return R(e, t, null, a.thatReturnsArgument), t
                },
                only: function(e) {
                    return T(e) || v("143"), e
                }
            },
            createRef: function() {
                return {
                    current: null
                }
            },
            Component: y,
            PureComponent: O,
            createContext: function(e, t) {
                return void 0 === t && (t = null), (e = {
                    $$typeof: m,
                    _calculateChangedBits: t,
                    _defaultValue: e,
                    _currentValue: e,
                    _currentValue2: e,
                    _changedBits: 0,
                    _changedBits2: 0,
                    Provider: null,
                    Consumer: null
                }).Provider = {
                    $$typeof: p,
                    _context: e
                }, e.Consumer = e
            },
            forwardRef: function(e) {
                return {
                    $$typeof: h,
                    render: e
                }
            },
            Fragment: l,
            StrictMode: d,
            unstable_AsyncMode: g,
            unstable_Profiler: f,
            createElement: S,
            cloneElement: function(e, t, n) {
                (null === e || void 0 === e) && v("267", e);
                var i = void 0,
                    o = r({}, e.props),
                    a = e.key,
                    s = e.ref,
                    u = e._owner;
                if (null != t) {
                    void 0 !== t.ref && (s = t.ref, u = k.current), void 0 !== t.key && (a = "" + t.key);
                    var l = void 0;
                    for (i in e.type && e.type.defaultProps && (l = e.type.defaultProps), t) E.call(t, i) && !j.hasOwnProperty(i) && (o[i] = void 0 === t[i] && void 0 !== l ? l[i] : t[i])
                }
                if (1 === (i = arguments.length - 2)) o.children = n;
                else if (1 < i) {
                    l = Array(i);
                    for (var d = 0; d < i; d++) l[d] = arguments[d + 2];
                    o.children = l
                }
                return {
                    $$typeof: c,
                    type: e.type,
                    key: a,
                    ref: s,
                    props: o,
                    _owner: u
                }
            },
            createFactory: function(e) {
                var t = S.bind(null, e);
                return t.type = e, t
            },
            isValidElement: T,
            version: "16.4.0",
            __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED: {
                ReactCurrentOwner: k,
                assign: r
            }
        },
        B = {
            default: F
        },
        H = B && F || B;
    e.exports = H.default ? H.default : H
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(12),
        i = n(40),
        o = n(176),
        a = n(111),
        s = n(18),
        c = n(102),
        u = n(11),
        l = n(54),
        d = n(50),
        f = n(99),
        p = a.Promise;
    window.IM = {
        init: function(e) {
            if (window.imwl = e.imwl, Object(d.startLoggingAllUnhandled)(), addTemplates(f), window.Promise || (window.Promise = p), window.cur.lang.dont_attach = getLang("mail_dont_add_media"), e.failed) return Object(i.mount)(geByClass1("im-sick", ge("page_body")), null);
            localStorage.removeItem("im_sick_timer"), e.tabbedPeers = (e.tabbedPeers || []).map(function(e) {
                return {
                    peer: e,
                    type: "perm"
                }
            }), cur.ctrl_submit = e.ctrl_submit, cur.module = "im", cur.mutedPeers = e.mutedPeers, cur.gid = e.gid, cur.peer = e.peer, e.blockedFlagUpdates = {}, e.msgid = intval(nav.objLoc.msgid), cur.options = {
                blacklist_hash: e.thash
            };
            var t = -10800 - 60 * (new Date).getTimezoneOffset(),
                n = e.timeshift;
            e.timeshift = n - t, e.oCache = {};
            var a = Object(o.default)(e);
            e.owners.forEach(function(e) {
                return Object(u.oCacheAdd)(a, e)
            }), e.owners = void 0, Object(l.normalizeTabsGotFromServer)(a, a.get().tabs), window.store = a, cur.imClassicInterface = Object(l.isClassicInterface)(a);
            var m = Object(r.mount)(geByClass1("js-im-page", ge("page_body")), a);
            Object(c.updateMentions)(a.get()), window.IMBRIDGE = {
                chatPhotoSaved: function(e) {
                    curBox() && curBox().hide();
                    var t = (e || {})[1];
                    return t ? (cur.pvShown && layers.fullhide(!0, !0), "im" != cur.module || a.get().peer != t ? nav.go("/im?sel=c" + (t - 2e9)) : void 0) : nav.reload()
                },
                updateHistory: function(e) {
                    a.set(c.updateHistory.bind(null, e)).then(function() {
                        m.updateHistory(e)
                    })
                },
                activateTab: function(e) {
                    a.get().gid || a.get().longpoll.push([Object(s.changePeer)(intval(e), !1, !1, !0)])
                }
            };
            var g = !1;
            cur.nav.push(function() {
                if (g) return !0;
                a.get().audio_msg && a.get().audio_msg.isRecording && m.cancelRecording(), AudioMessagePlayer.detachPlayer();
                var t = m.route.apply(null, arguments);
                return !1 !== t && (m.unmount(), window.IMBRIDGE = void 0, a.unmount(), window.store = void 0, g = !0, e = !1, a = !1, m = !1, Object(d.stopLoggingAllUnhandled)()), t
            })
        }
    };
    try {
        stManager.done("imn.js")
    } catch (e) {}
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(102),
        i = n(193),
        o = n(123),
        a = n(54),
        s = n(176),
        c = n(194),
        u = n(18),
        l = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function d(e, t, n, d) {
        var f = ge("box_layer_wrap"),
            p = t.get().longpoll,
            m = Object(s.default)({
                peer: 0,
                longpoll: p,
                oCache: {},
                tabs: Object(a.tabFromIds)(d.msgs, d.hash)
            }),
            g = Object(o.mount)(e.bodyNode, m, function() {
                return {}
            }),
            h = Object(i.mount)(e.bodyNode, t);
        Object(a.ensureDomHasActions)(e.bodyNode);
        var _ = function(e, t, n) {
            for (var i = arguments.length, o = Array(i > 3 ? i - 3 : 0), a = 3; a < i; a++) o[a - 3] = arguments[a];
            o.filter(function(e) {
                return inArray(e.type, [u.SET_FLAGS, u.RESET_FLAGS, u.CHANGE_PEER])
            }).forEach(function(i) {
                if (i.type !== u.CHANGE_PEER) {
                    if (i.flags === u.FLAG_IMPORTANT) {
                        var o = i.type === u.SET_FLAGS;
                        e.set(r.updateFavMessage.bind(null, [i.messageId], 0, o)).then(function(n) {
                            t.markImportant(i.messageId, o, e)
                        })
                    }
                } else n.hide()
            })
        }.bind(null, t, g, e);
        p.onData(_);
        var v = function(e, t, n, i) {
                if (!e.loading && !e.all && n.scrollTop + window.innerHeight - n.scrollHeight > -300) {
                    var o = geByClass1("_im_peer_history", t.bodyNode);
                    e.loading = !0, Object(a.wrapLoading)(o)(Object(r.loadImportant)(e.offset).then(function(t) {
                        var n = l(t, 4),
                            s = (n[0], n[1]),
                            c = (n[2], n[3]);
                        e.all = c.all, e.offset = c.offset, e.all ? addClass(o, "im-important_all") : e.loading = !1, i.set(r.mergeTabs.bind(null, Object(a.tabFromIds)(c.msgs, c.hash)));
                        var u = ce("div");
                        u.innerHTML = s, o.appendChild(u), Object(a.ensureDomHasActions)(o)
                    }), "bottom")
                }
            }.bind(null, {
                all: !1,
                loading: d.all,
                offset: d.offset
            }, e, f, m),
            b = Object(c.createModule)({
                handlers: function(e, t) {
                    e(f, "scroll", v)
                }
            });
        return {
            unmount: function() {
                Object(c.destroyModule)(b), h.unmount(), g.unmount(), p.offData(_)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "lpLogFc", function() {
        return o
    }), n.d(t, "longpollTesting_onFcEvents", function() {
        return f
    }), n.d(t, "longpollTesting_onImEvents", function() {
        return p
    });
    var r = n(50);

    function i(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
            return n
        }
        return Array.from(e)
    }

    function o(e, t) {
        var n;
        if (window.vk.lpConfig.debug) {
            for (var r = "background: " + e + "; color: white", i = new Date, o = function(e) {
                    return e < 10 ? "0" + e : e
                }, a = arguments.length, s = Array(a > 2 ? a - 2 : 0), c = 2; c < a; c++) s[c - 2] = arguments[c];
            (n = console).log.apply(n, ["%c " + i.getHours() + ":" + o(i.getMinutes()) + ":" + o(i.getSeconds()) + ":" + i.getMilliseconds() + " " + t + " ", r].concat(s))
        }
    }

    function a() {
        return window.lpBufferFc || (window.lpBufferFc = []), window.lpBufferFc
    }

    function s() {
        return window.lpBufferIm || (window.lpBufferIm = []), window.lpBufferIm
    }

    function c(e, t) {
        window.lpWeird || (window.lpWeird = []), window.lpWeird.push({
            msg: e,
            ev: t,
            is_master: window.curNotifier.is_server
        }), setTimeout(u, 1e4)
    }

    function u() {
        window.lpWeird.length && (Object(r.imWeirdLog)("fc_im_differ", {
            diff: window.lpWeird
        }, !1), window.lpWeird = [])
    }

    function l() {
        return "im" === window.cur.module && window.store && window.store.get().longpoll && !window.store.get().stopped
    }

    function d() {
        var e;
        l() && (s().forEach(function(e) {
            !a().find(function(t) {
                return e.ev === t.ev
            }) && e.time < Date.now() - 1e3 && !e.warned && (e.warned = !0, o("red", "im not fc", e.ev), Object(r.isWeirdLogging)() && c("im not fc", e.ev))
        }), a().forEach(function(e) {
            var t = s().find(function(t) {
                return t.ev === e.ev
            });
            t && t.warned && !e.warned && (e.warned = !0, o("red", "now fc like im", e.ev), Object(r.isWeirdLogging)() && c("now fc like im", e.ev))
        })), e = Date.now() - 3e4, window.lpBufferFc = a().filter(function(t) {
            return t.time > e
        }), window.lpBufferIm = s().filter(function(t) {
            return t.time > e
        })
    }

    function f(e) {
        var t;
        l() && ((t = a()).push.apply(t, i(e.map(function(e) {
            return {
                time: Date.now(),
                ev: JSON.stringify(e),
                warned: !1
            }
        }))), setTimeout(d, 0));
        o.apply(void 0, ["green", "fc"].concat(i(e)))
    }

    function p(e) {
        var t;
        l() && ((t = s()).push.apply(t, i(e.map(function(e) {
            return {
                time: Date.now(),
                ev: JSON.stringify(e),
                warned: !1
            }
        }))), setTimeout(d, 1100));
        o.apply(void 0, ["blue", "im"].concat(i(e)))
    }
    window.longpollTesting_onImEvents = p
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151)),
        o = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t() {
            return function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t),
                function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.hovered,
                n = e.className,
                a = e.children,
                s = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["hovered", "className", "children"]),
                c = Object(i.classNames)("Link", {
                    "Link--hovered": !!t
                }, n);
            return this.props.href ? r.createElement("a", o({}, s, {
                className: c
            }), a) : r.createElement("span", o({}, s, {
                className: c
            }), a)
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        href: void 0,
        hovered: !1
    }
}, function(e, t) {
    e.exports = function(e) {
        try {
            return !!e()
        } catch (e) {
            return !0
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createIdMap", function() {
        return p
    }), n.d(t, "addElements", function() {
        return m
    }), n.d(t, "collapseOps", function() {
        return h
    }), n.d(t, "distance", function() {
        return _
    }), n.d(t, "mount", function() {
        return C
    });
    var r = n(54),
        i = n(7),
        o = n(204),
        a = n(194);

    function s(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }

    function c(e, t) {
        return Object(i.toArray)(e).find(function(e) {
            return domData(e, "list-id") === t
        })
    }

    function u(e, t) {
        return Object(i.toArray)(e).findIndex(function(e) {
            return domData(e, "list-id") === t
        })
    }

    function l(e, t, n, r) {
        if (n) {
            d(e, t, r);
            var i = domData(n, "list-id"),
                o = i && c(t.children, i);
            o && r.forEach(function(e) {
                return addClass(o, e)
            }), e.setState({
                hoveredListItemId: i
            })
        }
    }

    function d(e, t, n) {
        var r = domQuery("." + n.join("."), t);
        r && Object(i.toArray)(r).forEach(function(e) {
            n.forEach(function(t) {
                return removeClass(e, t)
            })
        }), e.setState({
            hoveredListItemId: null
        })
    }

    function f(e, t) {
        var n = t && domQuery("." + t.join("."), e)[0];
        return n ? domData(n, "list-id") : null
    }

    function p(e, t, n) {
        return e.map(t).reduce(function(e, t) {
            return e[t] = !0, e
        }, n)
    }

    function m(e, t, n) {
        var r = e.filter(function(e) {
            return !n.ids[t(e)]
        });
        return {
            _sortedEls: !1,
            els: r,
            ids: p(r, t, n.ids),
            elements: n.elements.concat(r)
        }
    }

    function g(e, t, n) {
        return {
            ids: p(n.get().elements, e, {}),
            scrolls: t,
            activated: !0
        }
    }

    function h(e) {
        var t = {};
        return e.forEach(function(e) {
            "r" === e[0] && t["a," + e[1]] ? delete t["a," + e[1]] : t[e[0] + "," + e[1]] = e
        }), Object.keys(t).map(function(e) {
            return t[e]
        })
    }

    function _(e, t) {
        for (var n = [], r = Math.max(e.length, t.length), i = 0; i < r; i++) {
            var o = e[i],
                a = t[i];
            !o && a ? n.push(["a", a, i]) : o && !a ? n.push(["r", o, i]) : o !== a && (n.push(["r", o, i]), n.push(["a", a, i]))
        }
        var s = h(n),
            c = h(n.reverse());
        return s.length > c.length ? c : s
    }

    function v(e, t, n, r, i, o) {
        for (var a = 0; a < r; a++) e = domNS(e);
        var s = se(i(t));
        return domData(s, "list-id", n), e ? o.insertBefore(s, e) : o.appendChild(s), e
    }

    function b(e, t, n, r, o) {
        var a = r.get(),
            s = a.limit,
            c = a.offset,
            u = function(e, t) {
                var n = t.get();
                return !n._sortedEls && e && t.setState({
                    elements: n.elements.sort(e),
                    _sortedEls: !0
                }), t.get().elements
            }(n().sortFn, r).slice(0, c + s),
            l = _(Object(i.toArray)(e.children).map(function(e) {
                return domData(e, "list-id")
            }).filter(function(e) {
                return !!e
            }), u.map(function(e) {
                return n().idFn(e).toString()
            }));
        if (function(e, t, n, r) {
                if (0 !== t.length) {
                    var i = (t = t.sort(function(e, t) {
                        return e[2] - t[2]
                    })).filter(function(e) {
                        return "a" === e[0]
                    });
                    if (t.filter(function(e) {
                            return "r" === e[0]
                        }).map(function(t) {
                            return e.children[t[2]]
                        }).forEach(function(e) {
                            return re(e)
                        }), 0 !== i.length)
                        for (var o = i.shift(), a = o[2], s = (v(e.children[a], n[o[2]], o[1], 0, r, e), 0); s < i.length; s++) o = i[s], v(e.children[a], n[o[2]], o[1], o[2] - a, r, e), a = o[2]
                }
            }(e, l, u, n().renderFn), function(e, t) {
                e.get().loading ? t.update(!1, !0) : (e.get().loading = !0, t.update(!1, !0), e.get().loading = !1)
            }(r, t), o) return l.filter(function(e) {
            return "a" == e[0]
        }).map(function(e) {
            return parseInt(e[1])
        })
    }

    function y(e, t, n, r) {
        var i = arguments.length > 4 && void 0 !== arguments[4] && arguments[4],
            o = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 0,
            a = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0,
            s = e.get(),
            c = t.getContainer().children,
            l = u(c, r || s.hoveredListItemId);
        if (!(l < 0)) {
            (s.limit + s.offset < l ? e.setState({
                offset: l - s.limit + 1
            }).then(b.bind(null, t.getContainer(), t, n)) : Promise.resolve()).then(function() {
                var e = c[l],
                    n = t.scrollTop(),
                    r = t.getScrollHeight(),
                    s = e.offsetHeight;
                o = "center" === o ? -.5 * t.getScrollHeight() : o, a = "center" === a ? r / 2 : a;
                var u = i ? function(e) {
                        t.smoothScroll(e - t.scrollTop())
                    } : t.scrollTop.bind(t),
                    d = n + o > e.offsetTop,
                    f = s + e.offsetTop > n + r - a;
                d ? u(e.offsetTop - o) : f && u(e.offsetTop - r + s + a)
            })
        }
    }

    function w(e, t) {
        var n = e.get().pipeId;
        return !(void 0 !== n && void 0 !== t && n !== t)
    }

    function O(e, t, n, r, i, o) {
        return !!w(e, i) && e.setState(m(o, r().idFn, e.get())).then(b.bind(null, t, n, r))
    }

    function C(e, t, n) {
        var m = function(e, t) {
                if (e.get().loading || e.get().stop || !e.get().activated) return Promise.resolve([]);
                e.get().loading = !0;
                for (var n = arguments.length, r = Array(n > 2 ? n - 2 : 0), i = 2; i < n; i++) r[i - 2] = arguments[i];
                return t.apply(void 0, r).then(function() {
                    e.get().loading = !1
                })
            }.bind(null, t, function(e, t, n, i) {
                var o = e.get(),
                    a = o.elements,
                    s = i.getContainer(),
                    c = e.setState({
                        offset: o.offset + o.limit
                    }).then(function() {
                        var n = o.offset,
                            r = o.limit,
                            c = void 0;
                        return r + n > a.length ? c = t().more(n, r).then(function(t) {
                            return !1 === t ? [] : (0 === t.length && e.setState({
                                stop: !0
                            }), t)
                        }).then(O.bind(null, e, s, i, t, o.pipeId)) : (c = Promise.resolve(), b(s, i, t, e)), c
                    });
                if (!n) {
                    var u = a.length > 0 ? "im-preloader_fixed-bottom" : "im-preloader_fixed-center";
                    Object(r.wrapLoading)(s)(c, "bottom", u)
                }
                return c
            }.bind(null, t, n)),
            h = function(e, r) {
                (t.get().activated || e) && (void 0 !== r && t.get().elements.length > 0 && t.setState({
                    scrolled: r
                }), n().onScroll && n().onScroll())
            },
            _ = Object(o.createScroll)(e, {
                noScroll: t.get().noScroll,
                nativeScroll: t.get().nativeScroll,
                scrollChange: h.bind(null, !1),
                more: !!n().more && m.bind(null, !1)
            }),
            v = Object(a.createModule)({
                handlers: function(r, i) {
                    i(e, "click", t.get().elCls, n().onClick)
                }
            });
        return t.setState(g(n().idFn, {}, t)), {
            pipe: function(e, r) {
                return t.setState({
                    pipeId: r
                }), e.then(O.bind(null, t, _.getContainer(), _, n, r))
            },
            replacePreserveOrder: function(e) {
                return t.set(function(e, t, n) {
                    var r = [];
                    n.elements = n.elements.map(function(n) {
                        var i = t(n),
                            o = e.filter(function(e) {
                                return t(e) === i
                            })[0];
                        return r.push(i), o || n
                    });
                    var i = e.filter(function(e) {
                        return !inArray(t(e), r)
                    });
                    return n.elements = n.elements.concat(i), Promise.resolve(n)
                }.bind(null, e, n().idFn)).then(b.bind(null, _.getContainer(), _, n))
            },
            pipeReplace: function(e, r) {
                var i = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                return t.setState({
                    pipeId: r,
                    stop: !1
                }), e.then(function(e) {
                    if (w(t, r)) return t.setState({
                        elements: e,
                        _sortedEls: !1,
                        ids: p(e, n().idFn, {})
                    }).then(b.bind(null, _.getContainer(), _, n, t, i))
                })
            },
            wipe: function() {
                _.getContainer().innerHTML = ""
            },
            deactivate: function() {
                t.setState({
                    activated: !1
                })
            },
            activate: function() {
                t.setState({
                    activated: !0
                })
            },
            saveScroll: function(e, n) {
                return t.set(function(e, t, n) {
                    return n.scrolls || (n.scrolls = {}), n.scrolls[e] && !t || (n.scrolls[e] = {
                        scrolled: n.scrolled || 0,
                        scrollItem: n.scrollItem
                    }), Promise.resolve(n)
                }.bind(null, e, n))
            },
            updateScroll: function() {
                _.update(!1, !0)
            },
            toTop: function(e) {
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1] ? _.smoothScroll(-_.scrollTop()) : _.scrollTop(0), e && h(e, 0)
            },
            scrollTop: function(e) {
                return _.scrollTop(e)
            },
            restoreScroll: function(e) {
                var n = t.get().scrolls,
                    r = n[e];
                return r && (t.setState({
                    scrolls: extend({}, n, s({}, e, null))
                }), _.scrollTop(r.scrolled)), !!r
            },
            unsetScroll: function(e) {
                t.setState({
                    scrolls: extend({}, t.get().scrolls, s({}, e, null))
                })
            },
            scrollPage: function(e, t) {
                var n = _.scroll.scroller,
                    r = _.scrollTop(),
                    i = r + ("up" === e ? -1 : 1) * n.clientHeight;
                t ? _.smoothScroll(i - r) : _.scrollTop(i)
            },
            scrollToElement: function(e, r, i, o) {
                y(t, _, n, e, r, i, o)
            },
            checkMore: function(e) {
                return t.get().elements.length < t.get().limit ? m(e, _) : Promise.resolve([])
            },
            add: function(e, r) {
                return O(t, _.getContainer(), _, n, r, e)
            },
            hoverNextElement: function(e, r) {
                var o = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    a = _.getContainer(),
                    s = a.children,
                    c = u(s, t.get().hoveredListItemId || f(a, r)),
                    d = Object(i.toArray)(s).slice(c + 1).find(n().hoverableFn);
                l(t, a, d, e), y(t, _, n, null, !1, o.top, o.bottom)
            },
            hoverPrevElement: function(e, r) {
                var o = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    a = _.getContainer(),
                    s = a.children,
                    c = u(s, t.get().hoveredListItemId || f(a, r)),
                    d = c >= 0 && Object(i.toArray)(s).slice(0, c).reverse().find(n().hoverableFn);
                l(t, a, d, e), y(t, _, n, null, !1, o.top, o.bottom)
            },
            hoverFirstElement: function(e, r) {
                var o = _.getContainer(),
                    a = o.children,
                    s = Object(i.toArray)(a).findIndex(n().hoverableFn),
                    c = a[s];
                !t.get().hoveredListItemId && c && (l(t, o, c, e), y(t, _, n, s, !1, r.top, r.bottom))
            },
            hoverElement: function(e, r, i) {
                var o = _.getContainer(),
                    a = o.children,
                    s = u(a, e),
                    c = a[s];
                c && (l(t, o, c, r), y(t, _, n, s, !1, i.top, i.bottom))
            },
            unhoverElements: function(e) {
                d(t, _.getContainer(), e)
            },
            reset: function() {
                var e = t.get().scrolls;
                t.reset(), t.setState(g(n().idFn, e, t))
            },
            getHoveredElement: function() {
                return c(_.getContainer().children, t.get().hoveredListItemId)
            },
            getCurrentElements: function() {
                return t.get().elements
            },
            isLoading: function() {
                return t.get().loading
            },
            isEmpty: function() {
                return 0 === t.get().elements.length
            },
            remove: function(e) {
                t.set(function(e, t, n) {
                    return n.elements = n.elements.filter(function(n) {
                        return t(n) !== e
                    }), delete n.ids[e], Promise.resolve(n)
                }.bind(null, e, n().idFn)).then(b.bind(null, _.getContainer(), _, n))
            },
            unmount: function() {
                Object(a.destroyModule)(v), _.destroy()
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    var r = n(91),
        i = n(124),
        o = n(154),
        a = n(68)("species");
    e.exports = function(e) {
        var t = r[e];
        o && t && !t[a] && i.f(t, a, {
            configurable: !0,
            get: function() {
                return this
            }
        })
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "getFirstUnread", function() {
        return u
    }), n.d(t, "isSearchShown", function() {
        return l
    }), n.d(t, "getPeer", function() {
        return d
    }), n.d(t, "getCurrentKeyboard", function() {
        return f
    }), n.d(t, "getKeyboard", function() {
        return p
    }), n.d(t, "getTab", function() {
        return m
    }), n.d(t, "getCurrentTab", function() {
        return g
    }), n.d(t, "getSelectedMessages", function() {
        return h
    }), n.d(t, "getMessageRangeFromSelection", function() {
        return _
    }), n.d(t, "countUnread", function() {
        return v
    }), n.d(t, "getMessageByRid", function() {
        return b
    }), n.d(t, "isRidExist", function() {
        return y
    }), n.d(t, "getLocalId", function() {
        return w
    }), n.d(t, "getLastMessage", function() {
        return O
    }), n.d(t, "parserMessage", function() {
        return C
    }), n.d(t, "getAuthorFullName", function() {
        return k
    }), n.d(t, "getMessage", function() {
        return E
    }), n.d(t, "getPreviousMessage", function() {
        return j
    }), n.d(t, "isClassicInterface", function() {
        return S
    }), n.d(t, "isLocksAvailable", function() {
        return T
    }), n.d(t, "isFoldersAvailable", function() {
        return I
    }), n.d(t, "isCommunityInterface", function() {
        return P
    }), n.d(t, "getBareTab", function() {
        return M
    }), n.d(t, "isReversedDialogs", function() {
        return x
    }), n.d(t, "isFullyLoadedTab", function() {
        return L
    }), n.d(t, "makeTabNotFullyLoaded", function() {
        return A
    }), n.d(t, "isGoToEndVisible", function() {
        return N
    }), n.d(t, "getUnreadScrollBottom", function() {
        return D
    }), n.d(t, "isSendingAvailable", function() {
        return R
    }), n.d(t, "isCommunityPeer", function() {
        return F
    }), n.d(t, "isCommunityBlocked", function() {
        return B
    }), n.d(t, "checkVoiceMessageAvailable", function() {
        return H
    }), n.d(t, "isSearching", function() {
        return U
    }), n.d(t, "getSearchText", function() {
        return z
    }), n.d(t, "isSearchingValue", function() {
        return G
    }), n.d(t, "isRecentSearchesActive", function() {
        return W
    }), n.d(t, "getPinnedMessage", function() {
        return V
    }), n.d(t, "doPopularSuggExist", function() {
        return K
    }), n.d(t, "isAnyMessageBeingEdited", function() {
        return q
    }), n.d(t, "getGroupId", function() {
        return Q
    }), n.d(t, "getTabDraft", function() {
        return $
    });
    var r = n(26),
        i = n(18),
        o = n(128),
        a = n(11),
        s = n(118),
        c = n(7);

    function u(e, t) {
        var n = Object(c.unpackStore)(e),
            i = n.tabs[n.peer];
        return Object.keys(i.msgs).filter(function(n) {
            var o = E(e, t, n);
            return !Object(r.isOut)(o) && intval(n) > i.in_up_to
        })[0]
    }

    function l(e) {
        return Object(c.unpackStore)(e).searchShown
    }

    function d(e) {
        return Object(c.unpackStore)(e).peer
    }

    function f(e) {
        return p(e, d(e))
    }

    function p(e, t) {
        return (m(e, t) || {}).keyboard
    }

    function m(e, t) {
        var n = Object(c.unpackStore)(e);
        return n.tabs && n.tabs[t]
    }

    function g(e) {
        var t = Object(c.unpackStore)(e);
        return t.peer ? t.tabs[t.peer] : null
    }

    function h(e) {
        return Object(c.unpackStore)(e).selectedMessages
    }

    function _(e, t, n) {
        var i = m(e, t),
            o = h(e)[0];
        if (void 0 === o) return [n];
        var a = Math.min(n, o),
            s = Math.max(n, o);
        return Object.keys(i.msgs).filter(function(e) {
            return e >= a && e <= s
        }).filter(function(t) {
            var n = E(e, e.get().peer, t);
            return !Object(r.isServiceMsg)(n) && !Object(r.isCallMessage)(n)
        }).map(intval)
    }

    function v(e, t) {
        var n = m(Object(c.unpackStore)(t), e),
            i = 0;
        for (var o in n.msgs)
            if (n.msgs.hasOwnProperty(o)) {
                var a = E(t, e, o);
                Object(r.isOut)(a) || (i += Object(r.isUnread)(n, a) ? 1 : 0)
            }
        return i
    }

    function b(e, t, n) {
        var r = m(e, t);
        return Object.keys(r.msgs).filter(function(r) {
            return intval(E(e, t, r).randomId) === n
        }).length > 0
    }

    function y(e, t, n) {
        return !!b(e, t, n)
    }

    function w(e, t) {
        var n = Object(c.unpackStore)(e),
            r = n.msg_local_ids_sort && n.msg_local_ids_sort[t];
        return void 0 !== r ? 2e9 + r : t
    }

    function O(e, t, n) {
        var r = m(e, t),
            o = E(e, t, n),
            a = Object.keys(r.msgs).filter(function(n) {
                var r = E(e, t, n),
                    a = r.local && r.type !== i.EDIT_MESSAGE;
                return !(!o.local && a) && (!(!o.local || a) || w(e, o.messageId) > w(e, r.messageId))
            }).pop();
        return a ? E(e, t, a) : null
    }

    function C(e) {
        return e && e.length > 0 ? i.addMessageEvent([0].concat(e)) : e
    }

    function k(e, t, n) {
        var i = m(e, t),
            o = E(e, t, n),
            s = Object(c.unpackStore)(e);
        return Object(r.isOut)(o) ? Object(a.oCacheGet)(e, s.id).name : o.userId !== o.peerId ? !!Object(a.oCacheExists)(e, o.userId) && Object(a.oCacheGet)(e, o.userId).name : i.tab
    }

    function E(e, t, n) {
        var r = m(e, t),
            i = r && r.msgs && r.msgs[n];
        return i ? C(i) : null
    }

    function j(e, t, n) {
        var r = m(e, t),
            i = r && r.msgs && Object.keys(r.msgs).sort(function(e, t) {
                return +e - t
            });
        if (!i) return null;
        var o = i && i.indexOf("" + n),
            a = o > -1 ? i[o - 1] : null;
        return r.msgs[a]
    }

    function S(e) {
        var t = Object(c.unpackStore)(e);
        return t.gid || t.isClassic
    }

    function T(e) {
        return Object(c.unpackStore)(e).gid
    }

    function I(e) {
        return Object(c.unpackStore)(e).gid
    }

    function P(e) {
        return !!Object(c.unpackStore)(e).gid
    }

    function M(e, t) {
        var n = Object(c.unpackStore)(t);
        return n.tabs[e] || n.mapped_index[e]
    }

    function x(e) {
        var t = Object(c.unpackStore)(e);
        return !!P(e) && ((19542789 === t.gid || 103416369 == t.gid) && (t.active_tab === o.FOLDER_UNRESPOND || t.active_tab === o.FOLDER_UNREAD))
    }

    function L(e, t) {
        var n = (e = Object(c.unpackStore)(e)).tabs[t] && void 0 !== e.tabs[t].history;
        return !!(e.tabs[t] && e.tabs[t].msgs && n)
    }

    function A(e, t) {
        var n = m(e, t);
        n && (n.msgs = void 0, n.msgid = void 0, n.scrollTop = void 0, n.scrollBottom = void 0, n.contHeight = void 0, n.offset = void 0, n.skipped = void 0)
    }

    function N(e) {
        var t = e.get().go_to_end_visible;
        return !!t && t[0]
    }

    function D(e) {
        var t = e.get().go_to_end_visible;
        return t ? t[1] : 0
    }

    function R(e) {
        return !Object(c.unpackStore)(e).lockedSending
    }

    function F(e) {
        return e > -2e9 && e < 0
    }

    function B(e, t) {
        return !!F(t) && !!m(e, t).blocked_community
    }

    function H(e) {
        return Object(c.unpackStore)(e).voice_message_available
    }

    function U(e) {
        var t = Object(c.unpackStore)(e);
        return !(!z(t) && !t.recentSearch)
    }

    function z(e) {
        return Object(c.unpackStore)(e).searchText
    }

    function G(e, t) {
        var n = Object(c.unpackStore)(e);
        return !!(t && t !== z(e) || n.recentSearch)
    }

    function W(e) {
        return Object(c.unpackStore)(e).recentSearch
    }

    function V(e) {
        var t = g(e);
        return t && t.pinned && C(t.pinned)
    }

    function K(e) {
        var t = e.get().popular_sugg;
        return t && t.length > 0
    }

    function q(e) {
        return 1 == Object(c.unpackStore)(e).isEditing
    }

    function Q(e) {
        return Object(c.unpackStore)(e).gid
    }

    function $(e) {
        return e.draft || (e.draft = Object(s.loadDraftForPeer)(cur.imDb, e.peerId)), e.draft
    }
}, function(e, t) {
    var n = Math.ceil,
        r = Math.floor;
    e.exports = function(e) {
        return isNaN(e = +e) ? 0 : (e > 0 ? r : n)(e)
    }
}, function(e, t, n) {
    var r = n(35),
        i = n(4),
        o = function(e, t) {
            if (i(e), !r(t) && null !== t) throw TypeError(t + ": can't set as prototype!")
        };
    e.exports = {
        set: Object.setPrototypeOf || ("__proto__" in {} ? function(e, t, r) {
            try {
                (r = n(36)(Function.call, n(62).f(Object.prototype, "__proto__").set, 2))(e, []), t = !(e instanceof Array)
            } catch (e) {
                t = !0
            }
            return function(e, n) {
                return o(e, n), t ? e.__proto__ = n : r(e, n), e
            }
        }({}, !1) : void 0),
        check: o
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "classNames", function() {
        return i
    });
    var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
        return typeof e
    } : function(e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
    };

    function i() {
        var e = [];
        return [].concat(Array.prototype.slice.call(arguments)).forEach(function(t) {
            if (t) switch (void 0 === t ? "undefined" : r(t)) {
                case "string":
                    e.push(t);
                    break;
                case "object":
                    Object.keys(t).forEach(function(n) {
                        t[n] && e.push(n)
                    });
                    break;
                default:
                    e.push("" + t)
            }
        }), e.join(" ")
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return S
    });
    var r = n(102),
        i = n(148),
        o = n(54),
        a = n(121),
        s = n(194),
        c = n(48),
        u = n(30),
        l = n(18),
        d = n(142),
        f = n(76),
        p = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        m = debounce(c.statlogsProbValueEvent, 1e3),
        g = "_im_important_counter",
        h = "_im_gim_mute";

    function _(e) {
        return ge("im_dialogs_search", e)
    }

    function v(e, t, n, o, a, s) {
        var c = trim(s);
        if (Object(i.isSearchingValue)(e, c)) {
            var u = O.bind(null, e, n, a, t);
            c ? (e.setState({
                recentSearch: !1
            }), a.stop()) : a.replaceOrAdd(u), cancelStackPush("im_search", u), c && e.set(r.setCurrentSearch.bind(null, c, !1)).then(t), addClass(o, "im-page--dialogs-search_fill"), addClass(o, "_im_d_search")
        } else c || (a.stop(), e.set(r.setCurrentSearch.bind(null, "", !1)).then(t), removeClass(o, "im-page--dialogs-search_fill"), removeClass(o, "_im_d_search"))
    }

    function b(e, t, n) {
        return function() {
            Object(i.getSearchText)(t) === e && n.apply(void 0, arguments)
        }
    }

    function y(e, t, n) {
        var o = Object(i.getSearchText)(n);
        return m(.01, "im_search_stat", 1, "search_start"), Object(r.updateSearchQuery)(o), n.setState({
            recentSearch: !1
        }), e().toggleSettingsButton(n, !!o), o ? (n.get().dialog_search_going = !0, function(e, t, n) {
            var i = b(e, n, t().appendFastDialogs.bind(null, n));
            return Object(r.searchTopConv)(e, n.get()).then(function(e) {
                return i(e), e
            })
        }(o, e, n).then(function(r) {
            var i = r.map(function(e) {
                return e.peerId
            });
            return t(o, e, i, n)
        }).then(function(e) {
            n.get().dialog_search_going = !1
        }).catch(function() {})) : (e().restoreDialogs(n, !1, !0), Promise.resolve(!1))
    }

    function w(e, t, n, i) {
        var a = i.get(),
            s = b(e, i, t().appendDialogs.bind(null, i)),
            c = b(e, i, t().appendSearch);
        return Object(o.isPendingForward)(i) ? Object(r.searchHints)(e, n, "all", {}, a).then(s) : Promise.all([Object(r.searchHints)(e, n, "all", {}, a).then(s), Object(r.searchMessages)(e, a)]).then(function(e) {
            var t = p(e, 2),
                n = p(t[1], 2),
                r = n[0],
                o = n[1];
            c(i, r, o, !0)
        })
    }

    function O(e, t, n, r) {
        cancelStackFilter("im_search");
        var i = _(t);
        uiSearch.reset(i), e.setState({
            recentSearch: !1
        }), v(e, r, t, i, n, i.value)
    }

    function C(e, t) {
        return showTooltip(t, {
            appendEl: bodyNode,
            text: function() {
                return Object(i.isSearching)(e) ? getLang("mail_cancel") : getLang("mail_start_conversaion")
            },
            black: 1,
            shift: [3, -1],
            appendCls: "js-im-page"
        })
    }

    function k(e, t, n) {
        var i = n.target;
        e.set(r.toggleCommunityMute.bind(null, t)).then(function() {
            toggleClass(i, "im-page--gim-mute_muted", e.get().mute), t && E(e, {
                target: i
            })
        })
    }

    function E(e, t) {
        var n = t.target;
        return showTooltip(n, {
            text: function() {
                return e.get().mute ? getLang("mail_im_sound_off") : getLang("mail_im_sound_on")
            },
            black: 1,
            shift: [13, 9],
            appendCls: "js-im-page"
        })
    }

    function j(e, t, n, r, i, o) {
        return {
            focusInput: function(t) {
                uiSearch.focus(_(e).parentNode)
            },
            createCanceled: function(e, n) {
                removeClass(t, "im-dialog-select_rotated")
            },
            rotateCross: function(e) {
                addClass(t, "im-dialog-select_rotated")
            },
            setSearch: function(t, n) {
                var i = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                ! function(e, t, n, r, i) {
                    var o = _(t);
                    o.value = i, v(e, r, t, o, n, o.value)
                }(t, e, r, i ? o : function() {}, n)
            },
            clearSearch: function(t) {
                O(t, e, r, function() {})
            },
            updateImportantCnt: function(t) {
                var n = t.get().important_cnt,
                    r = geByClass1(g, e);
                toggleClass(r, "im-page--stars_hidden", 0 === n), r.innerHTML = "<i></i> " + n
            },
            unmount: function() {
                r.stop(), Object(s.destroyModule)(i), uiSearch.destroy(n), cancelStackFilter("im_search")
            }
        }
    }

    function S(e, t, n) {
        var c = geByClass1("_im_search_croll", e),
            p = _(e),
            m = Object(a.default)("im_search", ["_im_search_croll", "_im_page_dcontent", "_im_d_search", "_im_dialog"]),
            b = Object(u.debouncedPromise)(w, 300),
            S = y.bind(null, n, b),
            T = v.bind(null, t, S, e, p, m),
            I = function(e, t, n, r, o, a) {
                Object(i.isSearching)(e) ? (O(e, t, o, n), setTimeout(function() {
                    return C(e, a)
                }, 10)) : (window.tooltips && tooltips.hide(a, {
                    showsp: 0
                }), function(e, t, n) {
                    n().showCreation(e)
                }(e, 0, r))
            }.bind(null, t, e, S, n, m, c),
            P = function(e, t, n, r, i) {
                return Object(o.showFavvedBox)(e, n, d.mount, r)
            }.bind(null, t, e, n),
            M = geByClass1("_im_dialogs_search_input", e);
        uiSearch.init(M, {
            onChange: T
        });
        var x = C.bind(null, t, c),
            L = geByClass1(h, e);
        p.value && T(p.value);
        var A = Object(s.createModule)({
            handlers: function(a, s) {
                if (a(geByClass1("_im_av_time", e), "mouseover", function(e) {
                        showTooltip(e.target, {
                            text: getLang("mail_admin_av_time"),
                            dir: geByClass1("_im_top_notice") || geByClass1("im-page--dialogs--group-status") ? "down" : "up",
                            shift: [0, 8]
                        })
                    }), a(c, "click", I), a(c, "mouseover", x), a(geByClass1(g, e), "click", P), Object(o.isClassicInterface)(t)) {
                    var u = k.bind(null, t, !0),
                        d = E.bind(null, t);
                    a(L, "click", u), a(L, "mouseover", d)
                }
                a(p, "focus", function() {
                    t.get().longpoll.push([Object(l.transitionEvent)("search")])
                }), a(p, "click", function() {
                    Object(i.isSearching)(t) && n().toggleSettingsButton(t, !0),
                        function(e, t, n, a, s) {
                            if (!Object(i.isSearching)(e)) {
                                var c = cur.imDb.select(f.RECENT_SEARCH_OP);
                                if (0 !== c.length || Object(i.doPopularSuggExist)(e)) {
                                    e.setState({
                                        recentSearch: !0
                                    }), v(e, function() {
                                        Object(i.isSearching)(e) || (a.stop(), s().toggleSettingsButton(e, !1), s().restoreDialogs(e, !1, !0))
                                    }, t, n, a, "");
                                    var u = c.filter(function(t) {
                                            return !Object(o.isTabLoadedWithMessage)(e.get(), t)
                                        }),
                                        l = c.filter(function(t) {
                                            return Object(o.isTabLoadedWithMessage)(e.get(), t)
                                        }).reduce(function(t, n) {
                                            return t[n] = Object(i.getTab)(e, n), t
                                        }, {});
                                    e.get().topConvTree.then(function(t) {
                                        var n = t.list.filter(function(e) {
                                                return inArray(e[0], u)
                                            }).reduce(function(e, t) {
                                                return e[t[0]] = Object(r.localIndexToDialog)(t), e
                                            }, {}),
                                            i = extend({}, n, l);
                                        return s().appendFastDialogs(e, c.map(function(e) {
                                            return i[e]
                                        })), Object(r.searchHints)(!1, Object.keys(n), !1, {}, e.get())
                                    }).then(function(t) {
                                        s().appendDialogs(e, t)
                                    })
                                }
                            }
                        }(t, e, p, m, n)
                }), a(p, "blur", function() {
                    var e = void 0;
                    e = 0 === t.get().peer ? "search" : Object(o.isPendingForward)(t) ? "search" : "default", Object(i.isSearching)(t) || n().toggleSettingsButton(t, !1), t.get().longpoll.push([Object(l.transitionEvent)(e)])
                })
            }
        });
        return Object(o.isClassicInterface)(t) && k(t, !1, {
            target: L
        }), j(e, c, M, m, A, S)
    }
}, function(e, t, n) {
    e.exports = !n(145)(function() {
        return 7 != Object.defineProperty({}, "a", {
            get: function() {
                return 7
            }
        }).a
    })
}, function(e, t) {
    var n = {}.hasOwnProperty;
    e.exports = function(e, t) {
        return n.call(e, t)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return Y
    });
    var r = n(102),
        i = n(54),
        o = n(148),
        a = n(26),
        s = n(193),
        c = n(128),
        u = n(176),
        l = n(146),
        d = n(18),
        f = n(194),
        p = n(48),
        m = n(114),
        g = n(11),
        h = n(187),
        _ = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        v = 64,
        b = "_im_dialog_star",
        y = "_im_dialog_daction",
        w = ["_im_dialog_selected", "nim-dialog_selected"],
        O = ["_im_dialog_hovered", "nim-dialog_hovered"];

    function C(e) {
        return hasClass(e, "_im_search")
    }

    function k(e, t, n, a, s) {
        if (!gpeByClass("_im_peer_target", a.target)) {
            var c = t.get(),
                u = C(s),
                l = parseInt(domData(s, "peer"), 10),
                f = parseInt(domData(s, "msgid"), 10),
                p = "";
            Object(o.isSearching)(t) && (p = "conversations_search"), Object(o.isRecentSearchesActive)(t) && (p = "recent_searches"), hasClass(s, "_im_sugg_" + l) && (p = "popular_suggestions"), u && (p = "message_search");
            var m = Object(o.getTab)(t, l),
                g = !!c.pendingForward,
                _ = g && !Object(h.doesChatTabHaveFlag)(m, 1024);
            if (checkEvent(a)) return window.open(function(e, t, n) {
                var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                    o = Object(i.getBaseLink)(e),
                    a = function() {
                        return o + "?sel=" + Object(i.convertPeerToUrl)(t.peerId) + (r && n ? "&msgid=" + n : "")
                    };
                if (r) return a();
                if (Object(i.isUserPeer)(t.peerId) || Object(i.isCommunityPeer)(t.peerId)) return Object(i.isClassicInterface)(e) ? a() : t.href;
                return a()
            }(t, m, f, u));
            if (n.saveScroll("list"), u && c.msgid !== f) c.longpoll.push([d.changePeer(l, f, !1, !1, p)]);
            else if (l !== c.peer) {
                g && !_ || (c.longpoll.push([d.changePeer(l, !1, !0, !0, p)]), _ && E(t));
                var v = Object(o.isSearching)(t);
                v && !hasClass(s, "_dont_add_recent") && Object(r.saveRecentSearchPeer)(l, cur.imDb), v && m && !Object(i.isClassicInterface)(t) && setTimeout(function() {
                    var e = m.message ? m.message.messageId : m.peerId;
                    n.scrollToElement(e.toString(), !0, 0, "center")
                }, 100)
            } else l === c.peer && (g && _ ? (c.longpoll.push([d.changePeer(l, !1, !0, !u, p)]), E(t)) : e().goToHistoryEnd());
            cancelEvent(a)
        }
    }

    function E(e) {
        Object(m.statlogsForwardEvent)(e), Object(i.isCommunityInterface)(e) && Object(m.statlogsForwardFromCommunityEvent)(e, !1)
    }

    function j(e, t, n, r) {
        var o = void 0;
        return !Object(i.isChatPeer)(t) || "string" == typeof n.photo && "" !== n.photo ? (o = '<img src="' + n.photo + '" alt="">', r && (o = getTemplate("im_dialogs_link_img", {
            href: n.href,
            photo: o
        }))) : o = Object(i.renderPhotosFromTab)(e, n, !r), {
            photo: o,
            userLink: '<span class="_im_dialog_link">' + n.tab + "</span>"
        }
    }

    function S(e, t, n) {
        return n ? getTemplate("im_img_prebody", {
            photo: t
        }) : e + ":"
    }

    function T(e, t, n) {
        return !!(n & d.FLAG_OUTBOUND) && (!Object(i.isSelfMessage)(t.peerId, e.get().gid) && (!(Object(i.isChatPeer)(t.peerId) && t.data && t.data.closed) && (!t.unread && !(t.lastmsg <= t.out_up_to))))
    }

    function I(e) {
        var t = A(e);
        return (e.unread > 0 ? e.unread : "") > 0 && t
    }

    function P(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
            r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {},
            a = j(e, t.peerId, t, Object(i.isClassicInterface)(e)),
            s = a.photo,
            c = a.userLink,
            u = n || A(t);
        if (!u) return function(e, t, n, r) {
            var a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {},
                s = [];
            return Object(i.isClassicInterface)(r) && s.push("nim-dialog_classic"), Object(o.isRecentSearchesActive)(r) && s.push("nim-dialog_recent"), s.push("nim-dialog_empty"), a.search && s.push("_im_search"), getTemplate("im_drow", {
                peer: e.peerId,
                msg_id: "",
                photo: t,
                user_link: n,
                date: "",
                body: "",
                unread: "",
                more: s.join(" "),
                is_star: "",
                unread_message_string: "",
                is_online: onlinePlatformClass(e.online),
                is_unread: "",
                is_unread_out: "",
                is_selected: e.peerId == r.get().peer ? "nim-dialog_selected _im_dialog_selected" : ""
            })
        }(t, s, c, e, r);
        var l = u.flags,
            f = Object(i.isFvkcomgroup)(e, t.peerId),
            p = L(t, e, n),
            m = [];
        r.search && m.push("_im_search", "nim-dialog_search"), inArray(t.peerId, e.get().mutedPeers) && m.push("nim-dialog_muted"), t.verified && m.push("nim-dialog_verified"), Object(o.isRecentSearchesActive)(e) && m.push("nim-dialog_recent"), -1 === u.messageId && m.push("nim-dialog_empty"), Object(i.isClassicInterface)(e) && m.push("nim-dialog_classic"), t.folders & d.FOLDER_IMPORTANT && m.push("nim-dialog_starred"), !r.search && Object(i.isUnrespond)(e, t.peerId, t) && m.push("nim-dialog_unrespond"), f && e.get().gid && m.push("nim-dialog_deny-remove");
        var g = e.get().timeshift,
            h = T(e, t, l) ? "nim-dialog_unread-out" : "",
            _ = t.unread > 0 ? getLang("mail_im_new_messages", t.unread) : "";
        return getTemplate("im_drow", {
            peer: t.peerId,
            msg_id: u.messageId,
            photo: s,
            user_link: c,
            date: u.date ? getShortDateOrTime(u.date, g, !0, getLang("months_sm_of", "raw")) : "",
            body: p,
            unread_message_string: _,
            tab_name: stripHTML(t.tab),
            unread: Object(i.simplifyCounter)(t.unread),
            more: m.join(" "),
            is_online: onlinePlatformClass(t.online),
            is_unread: I(t) ? "nim-dialog_unread" : "",
            is_unread_out: h,
            is_selected: r.noselect || t.peerId != e.get().peer ? "" : "nim-dialog_selected _im_dialog_selected"
        })
    }

    function M(e, t, n, r, a) {
        if (!t.deletedDialog)
            if (hasClass(e, "nim-conversation-search-row")) x(e, t, n);
            else {
                var s = A(t),
                    c = s.flags,
                    u = L(t, n),
                    l = j(n, t.peerId, t, Object(i.isClassicInterface)(n)).photo,
                    f = n.get().timeshift,
                    p = s.date ? getShortDateOrTime(s.date, f, !0, getLang("months_sm_of", "raw")) : "";
                z(e, t), val(geByClass1("_dialog_body", e), u), val(geByClass1("_im_dialog_date", e), p), val(geByClass1("_im_dialog_unread_ct", e), Object(i.simplifyCounter)(t.unread)), val(geByClass1("_im_dialog_link", e), t.tab);
                var m = geByClass1("_im_dialog_photo", e);
                m.innerHTML !== l && val(m, l), toggleClass(e, "nim-dialog_verified", !!t.verified), toggleClass(e, "nim-dialog_starred", t.folders & d.FOLDER_IMPORTANT), toggleClass(e, "nim-dialog_muted", inArray(t.peerId, n.get().mutedPeers)), toggleClass(e, "nim-dialog_unrespond", Object(i.isUnrespond)(n, t.peerId, t)), toggleClass(e, "nim-dialog_classic", Object(i.isClassicInterface)(n)), toggleClass(e, "nim-dialog_unread", I(t)), toggleClass(e, "nim-dialog_deny-remove", n.get().gid > 0 && Object(i.isFvkcomgroup)(n, t.peerId)), removeClass(e, "nim-dialog_failed"), removeClass(e, "nim-dialog_deleted"), addClass(e, "_im_dialog"), toggleOnline(geByClass1("_im_peer_online", e), t.online), toggleClass(e, "nim-dialog_recent", Object(o.isRecentSearchesActive)(n)), toggleClass(e, "nim-dialog_empty", -1 === s.messageId), T(n, t, c) && addClass(e, "nim-dialog_unread-out"), a && setTimeout(function() {
                    addClass(geByClass1("_im_dialog_" + t.peerId, r), "nim-dialog_injected")
                }, 100)
            }
    }

    function x(e, t, n) {
        z(e, t), toggleClass(e, "nim-dialog_recent", Object(o.isRecentSearchesActive)(n)), val(geByClass1("_im_dialog_unread_ct", e), Object(i.simplifyCounter)(t.unread));
        var r = j(n, t.peerId, t, Object(i.isClassicInterface)(n)).photo,
            a = geByClass1("_im_dialog_photo", e);
        a.innerHTML !== r && val(a, r), toggleOnline(geByClass1("_im_peer_online", e), t.online), I(t) && addClass(e, "nim-dialog_unread")
    }

    function L(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2] || A(e);
        if (Object(i.isPeerBlocked)(e.peerId, t)) {
            var r = t.get().block_states[e.peerId].name,
                o = getLang("mail_community_answering").replace("{username}", r);
            return getTemplate("im_drow_prebody", {
                prebody: o,
                body: ""
            })
        }
        return Object(a.isServiceMsg)(n) ? Object(i.renderServiceMsg)(t, n, e, !1) : function(e, t, n, r, o, a, s, c, u, l) {
            var f = "";
            return t & d.FLAG_OUTBOUND ? f = S(getLang("mail_by_you"), l, u) : Object(i.isChatPeer)(n) && 0 !== r && (f = S(Object(g.oCacheGet)(e, r).first_name, Object(g.oCacheGet)(e, r).photo, u)), s = Object(i.renderShortText)(n, c, s, o, a), f ? getTemplate("im_drow_prebody", {
                prebody: f,
                body: s
            }) : s
        }(t, n.flags, e.peerId, n.userId, !0, n.attaches, n.text, n.subject, Object(i.isClassicInterface)(t), Object(g.oCacheGet)(t, t.get().id).photo)
    }

    function A(e) {
        var t = e.lastmsg_meta;
        return isArray(t) && (t = Object(d.addMessageEvent)([4].concat(t))), t || Object(d.addMessageEvent)([4, -1, 0, e.peer, 0, "", {}, {}, -1, -1, 0])
    }

    function N(e, t, n) {
        var a = Object(o.getTab)(e, t),
            s = Object(i.showFlushDialog)(a, t, function() {
                n().updateMenu(e), Object(i.cleanHistory)(e, s, n, r.flushHistory, t), Object(i.isChatPeer)(t) && Object(h.doesChatTabHaveFlag)(a, 1024) && e.set(r.leaveChat.bind(null, t))
            })
    }

    function D(e, t, n, o, a, s) {
        var c = gpeByClass("_im_dialog", s, n);
        if (c) {
            var u = intval(domData(c, "peer"));
            if (t.get().recentSearch) {
                var l = Object(r.removeFromRecentSearch)(u, cur.imDb);
                return re(c), cancelEvent(a), 0 === l.length && K(t, o, e), !1
            }
            var d = Object(i.isCommunityPeer)(u) || Object(i.isUserPeer)(u);
            Object(i.isClassicInterface)(t) && d ? Object(r.deleteDialog)(u, t.get()).then(function(n) {
                var r = _(n, 2),
                    i = r[0],
                    o = r[1];
                i ? (! function(e, t, n, r, i) {
                    var o = geByClass1("_dialog_body", t);
                    addClass(t, "nim-dialog_deleted"), removeClass(t, "_im_dialog"), val(o, getTemplate("im_delete_actions", {
                        text: langNumeric(n, getLang("mail_im_X_message_deleted", "raw")),
                        peer: e,
                        spam_id: r
                    }))
                }(u, c, i, o), e().updateMenu(t)) : N(t, u, e)
            }) : N(t, u, e)
        }
        return cancelEvent(a), !1
    }

    function R(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "",
            r = j(e, t.peerId, t, Object(i.isClassicInterface)(e)),
            a = r.photo,
            s = r.userLink,
            c = function(e) {
                return !Object(i.isPendingForward)(e)
            }(e),
            u = "" === n ? [] : [n];
        return Object(o.isRecentSearchesActive)(e) && u.push("nim-dialog_recent"), Object(i.isClassicInterface)(e) && u.push("nim-csr_classic"), inArray(t.peerId, e.get().mutedPeers) && u.push("nim-dialog_muted"), getTemplate("im_conversation_search_row", {
            peer: t.peerId,
            msg_id: t.lastmsg || "",
            photo: a,
            user_link: s,
            unread: Object(i.simplifyCounter)(t.unread),
            tab_name: stripHTML(t.tab),
            is_unread: I(t) ? "nim-dialog_unread" : "",
            is_online: onlinePlatformClass(t.online),
            is_selected: t.peerId == e.get().peer && c ? "nim-dialog_selected _im_dialog_selected" : "",
            more: u.join(" ")
        })
    }

    function F(e, t) {
        return e.map(function(e) {
            return Object(d.addMessageEvent)([4].concat(e))
        }).map(function(e) {
            return extend({}, t[e.peerId], {
                message: e
            })
        })
    }

    function B(e) {
        return {
            type: "empty",
            lang: e
        }
    }

    function H(e, t) {
        var n = e.get().msg_local_ids_sort && e.get().msg_local_ids_sort[t.lastmsg];
        return void 0 !== n ? 2e9 + n : t.lastmsg
    }

    function U(e, t, n, r) {
        showTooltip(r, {
            text: function() {
                var n = gpeByClass("_im_dialog", r, t),
                    i = domData(n, "peer");
                return e.get().tabs[i].folders & d.FOLDER_IMPORTANT ? getLang("mail_im_toggle_important_off") : getLang("mail_im_toggle_important")
            },
            black: 1,
            zIndex: 1,
            shift: [14, 8],
            toup: $(e, r.getBoundingClientRect().top)
        })
    }

    function z(e, t) {
        var n = t.unread > 0 ? getLang("mail_im_new_messages", t.unread) : "",
            r = geByClass1("_im_unread_blind_label", e);
        val(r, n)
    }

    function G(e) {
        var t = Object(o.isSearching)(e),
            n = e.get().searchOnlyMessages;
        return Object(i.isClassicInterface)(e) ? {
            top: t && !n ? 96 : 60,
            bottom: Object(i.isCommunityInterface)(e) ? 42 : 87
        } : {
            top: t && !n ? 36 : 0,
            bottom: 0
        }
    }

    function W(e, t) {
        e.hoverFirstElement(O, G(t))
    }

    function V(e) {
        e.unhoverElements(O)
    }

    function K(e, t, n) {
        if (Object(o.doPopularSuggExist)(e)) {
            t.pipeReplace(Promise.resolve([{
                type: "sep_popular"
            }, {
                type: "popular_sugg"
            }])), t.toTop()
        } else n().cancelSearch(e), cancelStackFilter("im_search")
    }

    function q(e, t, n, r, a) {
        return {
            selectPeer: function(t, n) {
                for (var r = geByClass("_im_dialog", e), i = n.get().peer, o = 0; o < r.length; o++) {
                    var a = r[o],
                        s = intval(domData(a, "peer")),
                        c = intval(domData(a, "msgid"));
                    s === i && (!C(a) || t === c && C(a)) ? (addClass(a, "nim-dialog_selected"), addClass(a, "_im_dialog_selected")) : hasClass(a, "_im_dialog_selected") && (removeClass(a, "nim-dialog_selected"), removeClass(a, "_im_dialog_selected"))
                }
            },
            appendFastDialogs: function(t, r, a) {
                removeClass(e.parentNode, "im-page--dialogs_with-mess"), n.saveScroll("list"), a ? (n.reset(), Object(i.isPendingForward)(t) || Object(o.isRecentSearchesActive)(t) || !Object(s.doesSearchResultContainConversations)(r) ? Object(o.isRecentSearchesActive)(t) && (Object(s.doesSearchResultContainConversations)(r) && (r = [{
                    type: "clear_recent"
                }].concat(r)), Object(o.doPopularSuggExist)(t) && (r = [{
                    type: "sep_popular"
                }, {
                    type: "popular_sugg"
                }].concat(r))) : r = [{
                    type: "sep_btn_search_msg"
                }, {
                    type: "sep_conversations"
                }].concat(r), t.setState({
                    searchOnlyMessages: !1
                }), n.pipeReplace(Promise.resolve(r)).then(function() {
                    return W(n, t)
                })) : n.pipe(Promise.resolve(r)), Object(i.isClassicInterface)(t) && !Object(i.isReservedPeer)(t.get().peer) || n.toTop()
            },
            deactivate: function() {
                n.deactivate()
            },
            activate: function() {
                n.activate()
            },
            hoverFirstDialog: function(e) {
                W(n, e)
            },
            hoverNextDialog: function(e) {
                n.hoverNextElement(O, w, G(e))
            },
            hoverPrevDialog: function(e) {
                n.hoverPrevElement(O, w, G(e))
            },
            unhoverDialogs: V.bind(n),
            selectHoveredDialog: function(t) {
                var i = geByClass1("_im_dialog_hovered", e);
                i || (i = geByClass1("_im_dialog", e)), i && k(r, t, n, {}, i)
            },
            appendSearch: function(t, r, i) {
                var o = F(i, r);
                i.length > 0 ? (addClass(e.parentNode, "im-page--dialogs_with-mess"), n.pipe(Promise.resolve([{
                    type: "sep_messages"
                }].concat(o))).then(function() {
                    return W(n, t)
                })) : (0 === n.getCurrentElements().length && n.pipeReplace(Promise.resolve([B()])), removeClass(e.parentNode, "im-page--dialogs_with-mess"))
            },
            updateDialog: function(t, n) {
                var r = geByClass1("_im_dialog_" + t);
                r && !C(r) && M(r, n.get().tabs[t], n, e)
            },
            focusOnSelected: function(e) {
                var t = e.get().peer;
                if (t) {
                    var r = geByClass1("_im_dialog_" + t);
                    r ? n.scrollTop(r.offsetTop - r.offsetHeight) : n.toTop()
                }
            },
            restoreScroll: function(e) {
                n.restoreScroll("list") || n.toTop()
            },
            restoreDialogs: function(t, o, a) {
                removeClass(e.parentNode, "im-page--dialogs_with-mess"), t.setState({
                    searchOnlyMessages: !1
                }), 0 !== Q(t).length || n.isLoading() || (o = !0), o && n.reset(), a && n.wipe(), n.pipeReplace(Promise.resolve(Q(t))).then(function(e) {
                    if (o && (!Object(i.isClassicInterface)(t) || !t.get().peer)) {
                        var a = function(e, t, n) {
                            return Object(i.isClassicInterface)(n) || t().toggleSettingsLoader(n, !0), e.checkMore(!Object(i.isClassicInterface)(n)).then(function() {
                                Object(i.isClassicInterface)(n) || t().toggleSettingsLoader(n, !1)
                            })
                        }(n, r, t);
                        return n.toTop(), a
                    }
                }).then(function() {
                    return V(n)
                })
            },
            appendDialogs: function(t, r) {
                removeClass(e.parentNode, "im-page--dialogs_with-mess"), r.forEach(function(n) {
                    var r = geByClass1("_im_dialog_" + n.peerId, e);
                    r && x(r, n, t)
                }), Object(i.isPendingForward)(t) || Object(o.isRecentSearchesActive)(t) || !Object(s.doesSearchResultContainConversations)(r) || (r = [{
                    type: "sep_btn_search_msg"
                }, {
                    type: "sep_conversations"
                }].concat(r)), t.setState({
                    searchOnlyMessages: !1
                }), n.isEmpty() && 0 === r.length && Object(i.isPendingForward)(t) && (r = [B(getLang("mail_im_search_empty_chats"))]), n.replacePreserveOrder(r)
            },
            updateCounter: function(t, n) {
                var r = geByClass1("_im_dialog_" + n, e),
                    a = Object(o.getTab)(t, n);
                if (r && !C(r) && (z(r, a), val(geByClass1("_im_dialog_unread_ct", r), Object(i.simplifyCounter)(a.unread)), toggleClass(r, "nim-dialog_unread", a.unread > 0), toggleClass(r, "nim-dialog_unread-out", T(t, a, A(a).flags))), Object(o.isRecentSearchesActive)(t)) {
                    var s = geByClass1("_im_sugg_" + n);
                    s && (val(geByClass1("_sugg_unread_ct", s), Object(i.simplifyCounter)(a.unread)), toggleClass(s, "sugg-is_unread", a.unread > 0))
                }
            },
            removeDialog: function(e, t) {
                n.remove(t)
            },
            updateOnline: function(t, n) {
                var r = geByClass1("_im_dialog_" + t, e);
                if (r) {
                    var i = n.get().tabs[t],
                        o = geByClass1("_im_peer_online", r);
                    toggleOnline(o, i.online)
                }
            },
            setDialogFailed: function(t, n, r) {
                var i = geByClass1("_im_dialog_" + t, e);
                i && (r.get().tabs[t].lastmsg === n && (addClass(i, "nim-dialog_failed"), val(geByClass1("_im_dialog_unread_ct", i), "!")))
            },
            scrollUp: function(e) {
                var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
                n.toTop(e, t), n.saveScroll("list", !0)
            },
            saveScroll: function(e) {
                n.saveScroll("list", !0)
            },
            promoteDialog: function(r, i) {
                var a = geByClass1("_im_dialog_" + i, e);
                a && !C(a) || !Object(o.isSearching)(r) ? (n.pipeReplace(Promise.resolve(Q(r)), void 0, !0).then(function(t) {
                    !inArray(i, t) && a && M(a, Object(o.getTab)(r, i), r, e)
                }), t().updateTyping(i, r)) : n.unsetScroll("list")
            },
            removeSelection: function(t) {
                var r = t.get().peer.toString(),
                    o = "._im_dialog_" + r + "." + w.join("."),
                    a = domQuery(o, e)[0];
                w.forEach(function(e) {
                    return removeClass(a, e)
                }), Object(i.isClassicInterface)(t) || n.hoverElement(r, O, G(t))
            },
            updateScroll: function() {
                n.updateScroll()
            },
            updateTyping: function(t, n) {
                var r = geByClass1("_im_dialog_" + t, e);
                if (r && !C(r) && !n.get().tabs[t].deletedDialog) {
                    var o = geByClass1("_im_dialog_typing", r),
                        a = !Object(i.isClassicInterface)(n),
                        s = Object(i.formatTyper)(n.get().tabs[t].typing, t, !Object(i.isChatPeer)(t), n.get(), 1, a);
                    val(o, s), toggleClass(r, "nim-dialog_typing", s)
                }
            },
            unmount: function() {
                n.unmount(), Object(f.destroyModule)(a)
            }
        }
    }

    function Q(e) {
        var t = e.get().active_tab,
            n = e.get().dialog_tabs[t],
            r = e.get().tabs;
        return n.map(function(e) {
            return r["" + e]
        }).sort(function(e, t, n) {
            var r = void 0;
            return t.message && n.message ? (r = n.message.messageId - t.message.messageId, r = Object(i.isReversedDialogs)(e) ? -r : r) : t.message && !n.message ? r = 1 : n.message && !t.message ? r = -1 : (r = H(e, n) - H(e, t), r = Object(i.isReversedDialogs)(e) ? -r : r), r
        }.bind(null, e))
    }

    function $(e, t) {
        return t > (e.get().gid ? 220 : 150) || Object(o.isSearching)(e)
    }

    function Y(e, t, n) {
        var a = Object(f.createMutations)(q),
            s = a.callMutations,
            d = a.bindMutations,
            m = function(e, n) {
                showTooltip(n, {
                    text: function() {
                        return Object(o.isRecentSearchesActive)(t) ? getLang("mail_hide_from_recent") : getLang("mail_delete")
                    },
                    black: 1,
                    center: !0,
                    shift: Object(i.isClassicInterface)(t) ? [-4, 10] : [2, 10],
                    toup: $(t, n.getBoundingClientRect().top),
                    zIndex: 1
                })
            },
            g = function(e, n) {
                showTooltip(n, {
                    text: getLang("mail_end_conversation"),
                    black: 1,
                    center: !0,
                    zIndex: 1,
                    shift: [1, 4],
                    toup: $(t, n.getBoundingClientRect().top)
                })
            },
            h = U.bind(null, t, e),
            w = function(e, t, n, i) {
                var o = gpeByClass("_im_dialog", i, t),
                    a = intval(domData(o, "peer"));
                return e.set(r.toggleDialogImportant.bind(null, a)), setTimeout(function() {
                    U(e, t, 0, i)
                }, 100), cancelEvent(n), !1
            }.bind(null, t, e),
            C = function(e, t, n, i, a) {
                var s = gpeByClass("_im_dialog", a, t),
                    c = intval(domData(s, "peer")),
                    u = e.get().tabs[c].lastmsg;
                return e.set(r.markDialogAnswered.bind(null, c, u)).then(function() {
                    M(s, e.get().tabs[c], e, t), Object(o.isRecentSearchesActive)(e) || n().restoreDialogs(e)
                }), showDoneBox(getLang("mail_marked_as_answered"), {
                    out: 1e3
                }), cancelEvent(i), !1
            }.bind(null, t, e, s),
            E = geByClass1("_im_dialogs_search"),
            j = {
                idFn: function(e) {
                    return function(e, t) {
                        return t.message ? t.message.messageId : Object(o.isSearching)(e) && t.peerId ? t.peerId + "cr" : t.peerId || t.type
                    }(t, e)
                },
                hoverableFn: function(e) {
                    return hasClass(e, "_im_dialog")
                },
                renderFn: function(e, t) {
                    switch (t.type) {
                        case "sep_btn_search_msg":
                            return Object(i.renderBtnSearchOnlyMessages)(e);
                        case "sep_messages":
                            return Object(i.renderMessagesSep)();
                        case "sep_conversations":
                            return Object(i.renderConversationsSep)();
                        case "sep_popular":
                            return Object(i.renderPopularSuggSep)();
                        case "popular_sugg":
                            return Object(i.renderPopularSuggestions)(e);
                        case "clear_recent":
                            return Object(i.renderClearRecent)();
                        case "empty_dialogs":
                            return getTemplate("im_dialogs_none", {
                                msg: getLang("mail_dialogs_list_empty")
                            });
                        case "empty":
                            return getTemplate("im_dialogs_none", {
                                msg: getLang("mail_im_search_empty")
                            });
                        default:
                            return t.message ? P(e, t, t.message, {
                                noselect: !0,
                                search: !0
                            }) : t.local_index || Object(o.isSearching)(e) ? R(e, t) : P(e, t)
                    }
                }.bind(null, t),
                more: function(e, t, n, a) {
                    if (Object(o.isSearching)(e) && e.get().searchAllLoaded || Object(o.isRecentSearchesActive)(e)) return Promise.resolve([]);
                    if (e.get().dialog_search_going || Object(i.isClassicInterface)(e) && 0 !== e.get().peer) return Promise.resolve(!1);
                    if (Object(o.isSearching)(e)) return Object(r.searchMessages)(Object(o.getSearchText)(e), e.get()).then(function(e) {
                        var t = _(e, 2),
                            n = t[0];
                        return F(t[1], n)
                    });
                    var s = e.get().active_tab,
                        u = e.get().dialog_tabs_all;
                    return u[c.FOLDER_ALL] && !Object(i.isReversedDialogs)(e) || u[s] ? 0 === Q(e).length ? Promise.resolve([{
                        type: "empty_dialogs"
                    }]) : Promise.resolve([]) : e.set(r.loadDialogs).then(function(t) {
                        var n = Q(e);
                        return 0 === n.length ? [{
                            type: "empty_dialogs"
                        }] : n
                    })
                }.bind(null, t, s),
                onScroll: !!Object(i.isClassicInterface)(t) && function() {
                    (bodyNode.scrollTop || document.documentElement.scrollTop) <= 0 && !layers.visible && browser.safari ? addClass(E, "im-page--header_static") : removeClass(E, "im-page--header_static")
                }
            },
            S = Object(l.mount)(e, Object(u.default)({
                limit: 40,
                offset: 0,
                nativeScroll: !!Object(i.isClassicInterface)(t),
                height: v,
                elements: Q(t)
            }), function() {
                return j
            }),
            T = k.bind(null, n, t, S),
            I = function(e, t, n) {
                removeClass(t.parentNode, "im-page--dialogs_with-mess");
                var r = n.getCurrentElements().filter(function(e) {
                    return e.message
                });
                n.toTop(), n.reset(), Object(p.statlogsProbValueEvent)(.01, "im_search_stat", 1, "search_messages_only"), r.length > 0 ? (r = [{
                    type: "sep_messages"
                }].concat(r), e.setState({
                    searchOnlyMessages: !0
                })) : r = [B()], n.pipeReplace(Promise.resolve(r))
            }.bind(null, t, e, S),
            x = function(e, t, n, o, a, s) {
                var c = intval(domData(s, "peer")),
                    u = domData(s, "action"),
                    l = domData(s, "sid"),
                    d = geByClass1("_im_dialog_" + c, t),
                    f = intval(domData(s, "spam"));
                switch (u) {
                    case "restore":
                        d && e.set(r.restoreDialog.bind(null, c, l, f)).then(function() {
                            addClass(d, "_im_dialog"), removeClass(d, "nim-dialog_deleted"), M(d, e.get().tabs[c], e, t, !1), o().updateMenu(e)
                        });
                        break;
                    case "spam":
                        var p = getLang("mail_im_dialog_marked_spam") + '\n        <button type="button" class="nim-dialog--daction nim-dialog--daction_last _im_dialog_daction"\n          data-action="restore"\n          data-spam="1"\n          data-sid="' + l + '" data-peer="' + c + '">\n            ' + getLang("mail_restore") + "\n        </button>";
                        if (d) {
                            var m = geByClass1("_dialog_body", d);
                            val(m, p), Object(r.spamDialog)(c, l, e.get())
                        }
                        break;
                    case "block":
                        (Object(i.isCommunityInterface)(e) ? Object(i.showBlacklistBox)(c, e) : Object(i.showBlacklistBoxUser)(c, e)).once("success", function() {
                            e.set(r.flushHistory.bind(null, c)).then(function() {
                                n().restoreDialogs(e)
                            })
                        })
                }
                cancelEvent(a)
            }.bind(null, t, e, s, n),
            L = D.bind(null, n, t, e, S),
            A = Object(f.createModule)({
                handlers: function(o, a) {
                    a(e, "click", "_im_dialog_close", L), a(e, "click", "_im_dialog_markre", C), a(e, "click", b, w), a(e, "click", "_im_dialog", T), a(e, "click", i.MESSAGE_SEARCH_CLASS, I), a(e, "mouseover", "_im_dialog_close", m), a(e, "mouseover", "_im_dialog_markre", g), a(e, "click", i.CLEAR_RECENT_CLASS, function() {
                        Object(r.resetRecentSearch)(cur.imDb), K(t, S, n)
                    }), a(e, "mouseover", b, h), a(e, "click", y, x), o(e, "mouseover", throttle(S.unhoverElements.bind(S, O), 100))
                }
            });
        return d(e, s, S, n, A)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "create", function() {
        return s
    });
    var r = n(176),
        i = n(54),
        o = n(128);

    function a(e, t, n, r, a) {
        switch (t) {
            case o.ARROW_UP:
                Object(i.isEditableFocused)() || (r.scroll(a, "up"), cancelEvent(n));
                break;
            case o.ARROW_DOWN:
                Object(i.isEditableFocused)() || (r.scroll(a, "down"), cancelEvent(n));
                break;
            case o.PAGE_UP:
                n.ctrlKey || Object(i.isClassicInterface)(a) || (r.scroll(a, "up", !0), cancelEvent(n));
                break;
            case o.PAGE_DOWN:
                n.ctrlKey || Object(i.isClassicInterface)(a) || (r.scroll(a, "down", !0), cancelEvent(n));
                break;
            case o.HOME:
                Object(i.isEditableFocused)() || (r.scroll(a, "up", !1, !0), cancelEvent(n));
                break;
            case o.END_KEY:
                Object(i.isEditableFocused)() || (r.scroll(a, "down", !1, !0), cancelEvent(n));
                break;
            case o.PRINTABLE:
                r.focustTxt(e)
        }
    }

    function s(e, t, n, s, c, u) {
        var l = Object(r.default)({
            state: t || "default"
        });
        return {
            signal: function(t, r) {
                if (!(cur.storyLayer || cur.articleEditorLayer || cur.articleLayer)) switch (l.get().state) {
                    case "default":
                        return a(l, t, r, s, e);
                    case "fwd":
                    case "search":
                        return function(e, t, n, r, a, s) {
                            switch (t) {
                                case o.ARROW_DOWN:
                                    r.hoverNextDialog(s), cancelEvent(n);
                                    break;
                                case o.ARROW_UP:
                                    r.hoverPrevDialog(s), cancelEvent(n);
                                    break;
                                case o.ENTER:
                                    Object(i.isEditableFocused)() && !gpeByClass("_im_dialogs_search_input", document.activeElement) || r.selectHoveredDialog(s);
                                    break;
                                case o.PRINTABLE:
                                    a.focusInput(s)
                            }
                        }(0, t, r, n, c, e);
                    case "create":
                        return function(e, t, n, r, a) {
                            switch (t) {
                                case o.PAGE_UP:
                                    !n.ctrlKey && Object(i.isClassicInterface)(a) && (r.scroll("up"), cancelEvent(n));
                                    break;
                                case o.PAGE_DOWN:
                                    !n.ctrlKey && Object(i.isClassicInterface)(a) && (r.scroll("down"), cancelEvent(n));
                                    break;
                                case o.ARROW_DOWN:
                                    r.hoverNextElement(a);
                                    break;
                                case o.ARROW_UP:
                                    r.hoverPrevElement(a);
                                    break;
                                case o.ENTER:
                                    gpeByClass("_im_dialogs_creation_name", document.activeElement) ? r.confirmCreate(a) : gpeByClass("im-create--search", document.activeElement) && r.selectElement(a);
                                    break;
                                case o.PRINTABLE:
                                    r.focusSearch(a)
                            }
                        }(0, t, r, u, e);
                    case "message":
                        return function(e, t, n, r, i) {
                            switch (t) {
                                case o.HOME:
                                case o.END_KEY:
                                    r.isEmpty(i) && a(e, t, n, r, i);
                                    break;
                                case o.PAGE_UP:
                                case o.PAGE_DOWN:
                                    a(e, t, n, r, i)
                            }
                        }(l, t, r, s, e);
                    default:
                        throw new Error("Unknown state: " + l.get().state)
                }
            },
            transition: function(e) {
                return l.set(function(e, t) {
                    return t.state = e, Promise.resolve(t)
                }.bind(null, e))
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return C
    });
    var r = n(194),
        i = n(188),
        o = n(65),
        a = n(28),
        s = n(102),
        c = n(148),
        u = n(7),
        l = window,
        d = l.MessageBox,
        f = l.show,
        p = l.hide,
        m = l.isVisible,
        g = l.boxRefreshCoords,
        h = void 0;

    function _(e) {
        var t = Object(c.getTab)(e, e.get().peer);
        t && t.data && !t.data.closed && !t.data.kicked ? v(e) : b()
    }

    function v(e) {
        var t = w();
        t && o.render(i.createElement(a.default, {
            store: e,
            closePopup: b,
            updatePopup: y
        }), t)
    }

    function b() {
        h && h.hide()
    }

    function y() {
        h && h.updateBoxCoords()
    }

    function w() {
        return document.querySelector("#ChatSettings")
    }

    function O(e) {
        var t = document.querySelector("#box_layer_wrap"),
            n = document.querySelector("#box_loader"),
            i = m(t);
        return {
            unmount: function() {
                var t = w();
                t && o.unmountComponentAtNode(t), Object(r.destroyModule)(e)
            },
            showLoader: function() {
                g(n), f(n), i || f(t)
            },
            hideLoader: function() {
                p(n), i || p(t)
            }
        }
    }

    function C(e, t, n) {
        var i = Object(r.createMutations)(O).bindMutations,
            o = t.get(),
            a = Object(r.createModule)({
                handlers: function(e, t) {}
            }),
            c = o.peer,
            l = i(a),
            f = {
                hideButtons: !0,
                bodyStyle: "padding: 0; background: none;",
                width: 560,
                onShow: function() {
                    v(t), t.subscribe(_), requestAnimationFrame(function() {
                        return h.updateBoxCoords()
                    })
                },
                onHideAttempt: function() {
                    return t.unsubscribe(v), l.unmount(), !0
                }
            };
        return l.showLoader(), t.set(s.getChatDetails.bind(null, o.peer)).then(function(e) {
            l.hideLoader();
            var t = Object(u.unpackStore)(e).peer;
            t && t === c ? h = new d(f).content('<div id="ChatSettings" class="ChatSettingsWrapper"></div>').show() : l.unmount()
        }), l
    }
}, function(e, t, n) {
    "use strict";
    var r = n(124).f,
        i = n(185),
        o = (n(34), n(104)),
        a = n(36),
        s = n(93),
        c = n(180),
        u = n(25),
        l = n(23),
        d = n(29),
        f = n(147),
        p = n(154),
        m = n(15).fastKey,
        g = p ? "_s" : "size",
        h = function(e, t) {
            var n, r = m(t);
            if ("F" !== r) return e._i[r];
            for (n = e._f; n; n = n.n)
                if (n.k == t) return n
        };
    e.exports = {
        getConstructor: function(e, t, n, l) {
            var d = e(function(e, r) {
                s(e, d, t, "_i"), e._i = i(null), e._f = void 0, e._l = void 0, e[g] = 0, void 0 != r && u(r, n, e[l], e)
            });
            return o(d.prototype, {
                clear: function() {
                    for (var e = this._i, t = this._f; t; t = t.n) t.r = !0, t.p && (t.p = t.p.n = void 0), delete e[t.i];
                    this._f = this._l = void 0, this[g] = 0
                },
                delete: function(e) {
                    var t = h(this, e);
                    if (t) {
                        var n = t.n,
                            r = t.p;
                        delete this._i[t.i], t.r = !0, r && (r.n = n), n && (n.p = r), this._f == t && (this._f = n), this._l == t && (this._l = r), this[g]--
                    }
                    return !!t
                },
                forEach: function(e) {
                    s(this, d, "forEach");
                    for (var t, n = a(e, arguments.length > 1 ? arguments[1] : void 0, 3); t = t ? t.n : this._f;)
                        for (n(t.v, t.k, this); t && t.r;) t = t.p
                },
                has: function(e) {
                    return !!h(this, e)
                }
            }), p && r(d.prototype, "size", {
                get: function() {
                    return c(this[g])
                }
            }), d
        },
        def: function(e, t, n) {
            var r, i, o = h(e, t);
            return o ? o.v = n : (e._l = o = {
                i: i = m(t, !0),
                k: t,
                v: n,
                p: r = e._l,
                n: void 0,
                r: !1
            }, e._f || (e._f = o), r && (r.n = o), e[g]++, "F" !== i && (e._i[i] = o)), e
        },
        getEntry: h,
        setStrong: function(e, t, n) {
            l(e, t, function(e, t) {
                this._t = e, this._k = t, this._l = void 0
            }, function() {
                for (var e = this._k, t = this._l; t && t.r;) t = t.p;
                return this._t && (this._l = t = t ? t.n : this._t._f) ? d(0, "keys" == e ? t.k : "values" == e ? t.v : [t.k, t.v]) : (this._t = void 0, d(1))
            }, n ? "entries" : "values", !n, !0), f(t)
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "isPinnedMessageVisibleInTab", function() {
        return m
    }), n.d(t, "pinnedMessageHide", function() {
        return g
    }), n.d(t, "pinnedMessageUnHide", function() {
        return h
    }), n.d(t, "pinnedMessageUnpin", function() {
        return _
    }), n.d(t, "mount", function() {
        return y
    });
    var r = n(194),
        i = n(102),
        o = n(18),
        a = n(165),
        s = n(54),
        c = n(148),
        u = n(7),
        l = n(100),
        d = n(76),
        f = "_im_pin_hide",
        p = "_im_pinned_message";

    function m(e, t) {
        if (Object(u.unpackStore)(e).searchShown) return !1;
        var n = Object(c.getTab)(e, t),
            r = n && Object(c.parserMessage)(n.pinned);
        return !!r && n.pinHideId != r.chat_local_id
    }

    function g(e, t, n) {
        var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
            i = Object(c.getTab)(e, t),
            o = i && Object(c.parserMessage)(i.pinned);
        i && o && (i.pinHideId = o.chat_local_id, cur.imDb.update(d.PIN_HIDDEN_ID_OP, [i.peerId, i.pinHideId]), v(n, t, e), re(geByClass1("_im_pinned_tt")), r && window.Notifier && Notifier.lcSend("pin_hide", {
            hide: 1,
            peer: t
        }), statlogsValueEvent("im_pinned_messages", "hide"))
    }

    function h(e, t, n) {
        var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
            i = Object(c.getTab)(e, t);
        i && i.pinHideId && (delete i.pinHideId, cur.imDb.update(d.PIN_HIDDEN_ID_OP, [i.peerId, void 0]), v(n, t, e), r && window.Notifier && Notifier.lcSend("pin_hide", {
            hide: 0,
            peer: t
        }), statlogsValueEvent("im_pinned_messages", "show"))
    }

    function _(e, t, n) {
        var r = v.bind(null, n, t),
            o = Object(s.showUnpinDialog)(function() {
                o.hideProgress(), o.hide(), e.set(i.unpinMessageOptimistic.bind(null, t)).then(r).then(function(e) {
                    return e.set(i.unpinMessage.bind(null, t))
                }).then(r)
            })
    }

    function v(e, t, n) {
        return e().updateChatTopic(t, n), Object(i.setActions)(n.get()), e().updateActions(n), n
    }

    function b(e) {
        return {
            unmount: function() {
                Object(r.destroyModule)(e)
            }
        }
    }

    function y(e, t, n) {
        var i = Object(r.createMutations)(b).bindMutations,
            u = function(e, t, n) {
                var r = e.get().peer,
                    i = Object(c.parserMessage)(Object(c.getTab)(e, r).pinned);
                if (n.target.classList.contains(f)) i && g(e, r, t);
                else if ("A" !== n.target.tagName) {
                    var u = i && i.messageId;
                    if (u && !Object(s.isAlreadyDeleted)(e, r, u)) {
                        var d = e.get();
                        Object(c.getMessage)(e, r, u) ? (e.setState({
                            msgid: u
                        }), Object(l.updateLocation)({
                            msgid: u
                        }), t().focusOnMessage()) : d.longpoll.push([Object(o.changePeer)(r, u)])
                    } else Object(s.showPinnedBox)(e, t, r, a.mount, n);
                    statlogsValueEvent("im_pinned_messages", "open")
                }
            }.bind(null, t, n),
            d = function(e) {
                showTooltip(e.target, {
                    text: getLang("mail_hide_unpin_hover"),
                    black: 1,
                    needLeft: 1,
                    shift: [8, 4],
                    forcetoup: !0,
                    className: "_im_pinned_tt",
                    appendEl: bodyNode
                })
            }.bind(null);
        return i(Object(r.createModule)({
            handlers: function(t, n) {
                n(e, "click", p, u), n(e, "mouseover", f, d)
            }
        }))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151)),
        o = n(135),
        a = n(38),
        s = n(8),
        c = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var u = 27,
        l = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onRemoveToken = function(e) {
                    var t = r.searchContainer.offsetHeight;
                    r.props.onRemoveToken(e.target.getAttribute("data-id")).then(function() {
                        r.updateScroll(t)
                    })
                }, r.onChange = function(e) {
                    var t = e.target.value;
                    t !== r.value && (r.value = t, r.props.onChange(e), r.scrollContainer.scrollTop = 0)
                }, r.onSelect = function(e) {
                    var t = r.searchContainer.offsetHeight;
                    r.props.onSelect(e.currentTarget.getAttribute("data-id")).then(function() {
                        r.updateScroll(t)
                    })
                }, r.onKeydown = function(e) {
                    e.keyCode === u && (r.input.value = "", r.input.blur(), r.props.onChange(e), e.stopPropagation())
                }, r.updateScroll = function(e) {
                    var t = r.searchContainer.offsetHeight;
                    r.input.focus(), r.searchContainer.scrollTop = r.searchContainer.scrollHeight, e !== t && (r.scrollContainer.scrollTop = r.scrollContainer.scrollTop + t - e)
                }, r.inputRef = function(e) {
                    r.input = e
                }, r.searchContainerRef = function(e) {
                    r.searchContainer = e
                }, r.scrollContainerRef = function(e) {
                    var t = e;
                    if (e && e.container)
                        for (t = e; t.container;) t = t.container;
                    r.scrollContainer = t
                }, r.value = n.value, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                this.input.addEventListener("keydown", this.onKeydown)
            }, t.prototype.componentWillUnmount = function() {
                this.input.removeEventListener("keydown", this.onKeydown)
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.className,
                    u = t.tokens,
                    l = (t.onSelect, t.onRemoveToken, t.removeTokenPlaceholder),
                    d = t.value,
                    f = t.placeholder,
                    p = t.useInfiniteScroll,
                    m = t.loadMore,
                    g = t.hasMore,
                    h = t.virtualized,
                    _ = t.notFoundText,
                    v = t.children,
                    b = t.emptyText,
                    y = t.isSearching,
                    w = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(t, ["className", "tokens", "onSelect", "onRemoveToken", "removeTokenPlaceholder", "value", "placeholder", "useInfiniteScroll", "loadMore", "hasMore", "virtualized", "notFoundText", "children", "emptyText", "isSearching"]),
                    O = p ? o.default : "div",
                    C = p ? {
                        loadMore: m,
                        hasMore: g,
                        virtualized: h,
                        useCapture: !1
                    } : {},
                    k = [].concat(v);
                return r.createElement("div", {
                    className: Object(i.classNames)("MultiSelect", n)
                }, r.createElement("div", {
                    className: "MultiSelect__search",
                    ref: this.searchContainerRef
                }, u.map(function(t, n) {
                    return r.createElement("span", {
                        className: "MultiSelect__token",
                        key: t.id
                    }, r.createElement("span", {
                        className: "MultiSelect__tokenTitle"
                    }, t.text), l ? r.createElement(s.default, {
                        text: l
                    }, r.createElement("span", {
                        className: "MultiSelect__tokenRemove",
                        "data-id": t.id,
                        onClick: e.onRemoveToken
                    })) : r.createElement("span", {
                        className: "MultiSelect__tokenRemove",
                        "data-id": t.id,
                        onClick: e.onRemoveToken
                    }))
                }), r.createElement("div", {
                    className: "MultiSelect__caret"
                }, r.createElement("div", {
                    className: "MultiSelect__caretIn"
                }, r.createElement("input", c({}, w, {
                    type: "text",
                    className: "MultiSelect__input",
                    placeholder: 0 === u.length ? f : "",
                    onChange: this.onChange,
                    onInput: this.onChange,
                    onPaste: this.onChange,
                    value: d,
                    ref: this.inputRef
                }))))), 0 === k.length && (d || b) && !y && r.createElement("div", {
                    className: "MultiSelect__empty"
                }, r.createElement("div", {
                    className: "MultiSelect__emptyIn"
                }, d ? _ : b)), r.createElement(O, c({
                    className: "MultiSelect__scroll",
                    ref: this.scrollContainerRef
                }, C), k.map(function(t) {
                    return r.createElement(a.default, {
                        className: "MultiSelect__suggestsItem",
                        "data-id": t.props["data-id"],
                        onClick: e.onSelect,
                        key: t.key
                    }, t)
                })))
            }, t
        }(r.PureComponent);
    t.default = l, l.defaultProps = {
        removeTokenPlaceholder: "",
        placeholder: "",
        value: "",
        useInfiniteScroll: !1,
        notFoundText: "Not found"
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return o
    });
    var r = n(188),
        i = (n(195), n(151));

    function o(e) {
        var t = Object(i.classNames)("Progress", {
            "Progress--inverted": e.inverted
        }, e.className);
        return r.createElement("div", {
            className: t
        }, r.createElement("div", {
            className: "Progress__item"
        }), r.createElement("div", {
            className: "Progress__item"
        }), r.createElement("div", {
            className: "Progress__item"
        }))
    }
    o.defaultProps = {
        inverted: !1
    }
}, function(e, t) {
    var n = {}.toString;
    e.exports = function(e) {
        return n.call(e).slice(8, -1)
    }
}, function(e, t, n) {
    "use strict";
    e.exports = {}
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return o
    });
    var r = n(194);

    function i(e) {
        return {
            unmount: function() {
                Object(r.destroyModule)(e)
            }
        }
    }

    function o(e, t, n) {
        return (0, Object(r.createMutations)(i).bindMutations)(Object(r.createModule)({
            handlers: function(e, t) {}
        }))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(188),
        i = n(65),
        o = n(66),
        a = n(90),
        s = n(194),
        c = n(102);

    function u() {
        return document.getElementById("_im_keyboard_container")
    }

    function l(e, t, n) {
        return {
            init: function() {
                var e = this;
                return new Promise(function(s) {
                    e.isMounted = !0,
                        function(e, t, n) {
                            var s = u();
                            if (s) {
                                var c = r.createElement(a.default, {
                                    value: e
                                }, r.createElement(o.default, {
                                    send: t
                                }));
                                i.render(c, s, n)
                            }
                        }(t, n, s)
                })
            },
            toggle: function(e, n, r) {
                return t.set(c.toggleKeyboard.bind(null, e, n, r))
            },
            unmount: function() {
                var t = u();
                t && this.isMounted && i.unmountComponentAtNode(t), this.isMounted = !1, Object(s.destroyModule)(e)
            }
        }
    }

    function d(e, t, n, r, i) {
        return (0, Object(s.createMutations)(l).bindMutations)(Object(s.createModule)({
            handlers: function(e, t) {}
        }), t, r)
    }
}, , function(e, t) {}, , function(e, t, n) {
    var r = n(91),
        i = r["__core-js_shared__"] || (r["__core-js_shared__"] = {});
    e.exports = function(e) {
        return i[e] || (i[e] = {})
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return g
    });
    var r = n(102),
        i = n(54),
        o = n(194),
        a = n(21),
        s = n(176),
        c = n(18),
        u = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        l = "_im_spam_not_spam",
        d = "_im_spam_spam";

    function f(e, t) {
        var n = t.get().selectedMessages,
            r = geByClass1("_im_spam_box", e.bodyNode),
            o = geByClass1("ui_tab_sel", e.bodyNode);
        if (n.length > 0) {
            var a = getLang("mail_selected", n.length);
            a = a.replace("{count}", n.length), val(o, a + '<button aria-label="' + getLang("mail_deselect_all") + '" type="button" class="im-deselect ' + i.DESELECT_ALL_CLASS + '"></button>')
        } else val(o, getLang("mail_spam"));
        0 === n.length ? removeClass(r, "im-important-box_with-sel") : (addClass(r, "im-important-box_with-sel"), val(geByClass1(l), getLang("mail_im_mark_notspam", n.length)), val(geByClass1(d), getLang("mail_im_mark_delspam", n.length)))
    }

    function p(e, t, n) {
        var i = e.get().selectedMessages;
        e.set(r.cleanSelected).then(n.cleanSelection.bind(null, i)).then(function(n) {
            return f(t, e)
        })
    }

    function m(e, t) {
        return {
            unmount: function() {
                t.unmount(), Object(o.destroyModule)(e)
            }
        }
    }

    function g(e, t, n) {
        var g = ge("box_layer_wrap"),
            h = Object(o.createMutations)(m),
            _ = h.callMutations,
            v = h.bindMutations,
            b = Object(s.default)({
                peer: 0,
                oCache: {},
                tabs: Object(i.tabFromIds)(n.msgs, n.hash),
                gid: t.get().gid
            }),
            y = function(e, t, n, o) {
                if (!e.loading && !e.all && n.scrollTop + window.innerHeight - n.scrollHeight > -300) {
                    var a = geByClass1("_im_peer_history", t.bodyNode);
                    e.loading = !0, Object(i.wrapLoading)(a)(Object(r.loadSpam)(e.offset, o.get().gid).then(function(t) {
                        var n = u(t, 4),
                            s = (n[0], n[1]),
                            c = (n[2], n[3]);
                        e.all = c.all, e.offset = c.offset, e.all ? addClass(a, "im-important_all") : e.loading = !1, o.set(r.mergeTabs.bind(null, Object(i.tabFromIds)(c.msgs, c.hash)));
                        var l = ce("div");
                        l.innerHTML = s, a.appendChild(l), Object(i.ensureDomHasActions)(a)
                    }), "bottom")
                }
            }.bind(null, {
                all: n.all,
                loading: !1,
                offset: n.offset
            }, e, g, b),
            w = function(e, t, n, o) {
                var a = gpeByClass("_im_mess", o, t);
                if (a) {
                    var s = intval(domData(a, "msgid"));
                    a && (Object(r.removeMessageSend)([s], 0, e.get().tabs[0].hash, "undel", e.get()), Object(i.restoreMessage)(s, 0, t))
                }
            }.bind(null, b, e.bodyNode),
            O = function(e, t, n, r, i) {
                var o = gpeByClass("_im_mess", i, t.bodyNode),
                    a = intval(domData(o, "peer")),
                    s = intval(domData(o, "msgid"));
                return t.hide(), n().unmount(), e.get().longpoll.push([Object(c.changePeer)(a, s)]), stopEvent(r), cancelEvent(r), !1
            }.bind(null, t, e, _),
            C = function(e, t, n, i) {
                var o = showFastBox({
                    title: getLang("mail_deleteall1"),
                    dark: 1,
                    bodyStyle: "padding: 20px; line-height: 160%;"
                }, getLang("mail_delete_all_spam"), getLang("mail_delete"), function() {
                    Object(r.flushSpam)(e, i).then(function(e) {
                        var t = u(e, 2),
                            n = (t[0], t[1]);
                        showDoneBox(n)
                    }), o.hide(), t.hide(), n().unmount()
                }, getLang("mail_close"), function() {
                    return o.hide()
                })
            }.bind(null, n.hash, e, _, t.get().gid),
            k = Object(a.mount)(e.bodyNode, b, function(t) {
                return {
                    changedMessageSelection: f.bind(null, e)
                }
            }),
            E = function(e, t, n) {
                var o = e.get().selectedMessages;
                Object(r.removeMessageSend)(o, 0, e.get().tabs[0].hash, "delete", e.get()), Object(i.removeMessagesWithRestore)(o, 0, "delete", t), p(e, t, n)
            }.bind(null, b, e.bodyNode, k),
            j = function(e, t, n) {
                var o = e.get().selectedMessages;
                Object(r.removeMessageSend)(o, 0, e.get().tabs[0].hash, "nospam", e.get()), o.map(function(e) {
                    return geByClass1("_im_mess_" + e)
                }).filter(function(e) {
                    return e
                }).forEach(function(e) {
                    var t = intval(domData(e, "peer")),
                        n = intval(domData(e, "msgid"));
                    val(e, Object(i.renderGoTo)(t, n)), addClass(e, "im-mess_light")
                }), p(e, t, n)
            }.bind(null, b, e.bodyNode, k),
            S = p.bind(null, b, e, k);
        return Object(i.ensureDomHasActions)(e.bodyNode), v(Object(o.createModule)({
            handlers: function(t, n) {
                t(g, "scroll", y), t(geByClass1(d, e.bodyNode), "click", E), t(geByClass1(l, e.bodyNode), "click", j), t(geByClass1("_im_spam_flush", e.bodyNode), "click", C), n(e.bodyNode, "click", "_im_mess_restore", w), n(e.bodyNode, "click", "_im_go_to", O), n(e.bodyNode, "click", i.DESELECT_ALL_CLASS, S)
            }
        }), k)
    }
}, , function(e, t) {
    var n;
    n = function() {
        return this
    }();
    try {
        n = n || Function("return this")() || (0, eval)("this")
    } catch (e) {
        "object" == typeof window && (n = window)
    }
    e.exports = n
}, function(e, t, n) {
    "use strict";
    var r = function(e) {};
    e.exports = function(e, t, n, i, o, a, s, c) {
        if (r(t), !e) {
            var u;
            if (void 0 === t) u = new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");
            else {
                var l = [n, i, o, a, s, c],
                    d = 0;
                (u = new Error(t.replace(/%s/g, function() {
                    return l[d++]
                }))).name = "Invariant Violation"
            }
            throw u.framesToPop = 1, u
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(151),
        o = n(77),
        a = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function s(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var c = function(e) {
        function t() {
            var n, r;
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            for (var i = arguments.length, o = Array(i), a = 0; a < i; a++) o[a] = arguments[a];
            return n = r = s(this, e.call.apply(e, [this].concat(o))), r.getRef = function(e) {
                r.element = e && e.element
            }, s(r, n)
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.className,
                n = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["className"]);
            return r.createElement(o.default, a({}, n, {
                className: Object(i.classNames)(t, "BlockSearchInput"),
                ref: this.getRef
            }))
        }, t
    }(r.Component);
    t.default = c, c.defaultProps = o.default.defaultProps
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(50);

    function i(e, t) {
        if (!t) return ls.get(e);
        ls.set(e, t)
    }
    t.default = function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
            t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
            n = debounce(i, 300),
            o = extend({}, e),
            a = [],
            s = [];
        return t.store && (o = ls.get(t.key) || o), {
            get: function() {
                return o
            },
            set: function(e) {
                var i = this,
                    a = Object(r.isWeirdLogging)() ? function(e) {
                        try {
                            var t = {};
                            return Error.captureStackTrace(t, e), t.stack
                        } catch (e) {
                            return ""
                        }
                    }(this.set) : null;
                return e(o).then(function(e) {
                    return o = e, t.store && n(t.key, e), i.emit(), i
                }).catch(function(e) {
                    return Object(r.imWeirdCatch)("store_set_catch", e, {
                        stack: a
                    })
                })
            },
            setState: function(e) {
                var t = this;
                return this.set(function(n) {
                    return n = extend(n, e), t.emit(), Promise.resolve(n)
                })
            },
            stash: function() {
                a.push(o), o = extend({}, e), this.emit()
            },
            reset: function() {
                o = extend({}, e), this.emit()
            },
            unmount: function() {
                o = {}, e = !1, s = []
            },
            pop: function() {
                a.length > 0 && (o = a.pop(), this.emit())
            },
            emit: function() {
                var e = this;
                s.length > 0 && s.forEach(function(t) {
                    return t(e)
                })
            },
            subscribe: function(e) {
                -1 === s.indexOf(e) && s.push(e)
            },
            unsubscribe: function(e) {
                s = s.filter(function(t) {
                    return t !== e
                })
            },
            mutate: function(e) {
                e(o), t.store && n(t.key, o), this.emit()
            }
        }
    }
}, function(e, t, n) {
    var r = n(35),
        i = n(150).set;
    e.exports = function(e, t, n) {
        var o, a = t.constructor;
        return a !== n && "function" == typeof a && (o = a.prototype) !== n.prototype && r(o) && i && i(e, o), e
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151)),
        o = n(144);
    var a = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.onError = function() {
                r.setState({
                    errored: !0
                })
            }, r.state = {}, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.getPhotoImage = function() {
            var e = this.props,
                t = e.size,
                n = e.photo,
                i = e.title;
            return r.createElement("img", {
                width: t,
                height: t,
                src: this.state.errored ? "/images/camera_c.gif" : n,
                alt: i,
                onError: this.onError,
                className: "Entity__photo"
            })
        }, t.prototype.render = function() {
            var e, t, n, a = this.props,
                s = a.className,
                c = a.style,
                u = a.size,
                l = a.photo,
                d = a.href,
                f = a.title,
                p = a.description,
                m = (n = !!u, (t = "Entity--size" + u) in (e = {}) ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e);
            return r.createElement("div", {
                className: Object(i.classNames)("Entity", s, m),
                style: c
            }, r.createElement("div", {
                className: "Entity__aside"
            }, "string" == typeof l ? d ? r.createElement("a", {
                href: d
            }, this.getPhotoImage()) : this.getPhotoImage() : l), r.createElement("div", {
                className: "Entity__main"
            }, f && d ? r.createElement("div", {
                className: "Entity__title"
            }, r.createElement(o.default, {
                href: d,
                dangerouslySetInnerHTML: {
                    __html: f
                }
            })) : r.createElement("div", {
                className: "Entity__title",
                dangerouslySetInnerHTML: {
                    __html: f
                }
            }), "string" != typeof p ? r.createElement("div", {
                className: "Entity__description"
            }, p) : r.createElement("div", {
                className: "Entity__description",
                dangerouslySetInnerHTML: {
                    __html: p
                }
            })))
        }, t
    }(r.PureComponent);
    t.default = a, a.defaultProps = {
        size: null,
        photo: "",
        title: "",
        description: "",
        href: ""
    }
}, function(e, t, n) {
    var r = n(124),
        i = n(4),
        o = n(44);
    e.exports = n(154) ? Object.defineProperties : function(e, t) {
        i(e);
        for (var n, a = o(t), s = a.length, c = 0; s > c;) r.f(e, n = a[c++], t[n]);
        return e
    }
}, function(e, t) {
    e.exports = function(e) {
        if (void 0 == e) throw TypeError("Can't call method on  " + e);
        return e
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "initQueue", function() {
        return f
    });
    var r = n(176),
        i = n(30);

    function o(e, t) {
        return t.queues[e].currEv = !1, Promise.resolve(t)
    }

    function a(e, t) {
        var n = t.queues[e].currEv;
        return n ? (t.queues[e].errored.push(n), o(e, t)) : Promise.resolve(t)
    }

    function s(e, t, n) {
        return n.queues[e] ? (n.queues[e].errored = t ? [] : n.queues[e].errored.concat(n.queues[e].evs), n.queues[e].evs = [], o(e, n)) : Promise.resolve(n)
    }

    function c(e, t, n, r) {
        var i = r.get().queues[e];
        if (i && !i.currEv && i.evs.length > 0 && !i.pause) {
            var s = c.bind(null, e, t, n, r),
                l = i.evs.shift();
            i.currEv = l, t(e, l).then(function() {
                r.get().opts.waitCommit || r.set(o.bind(null, e))
            }).then(s).catch(function(t) {
                return r.set(a.bind(null, e)).then(function() {
                    n(e, function(e, t) {
                        var n = u(e, t.get()).errored;
                        return n.length > 0 && n[n.length - 1]
                    }(e, r), t)
                }).then(s)
            })
        }
    }

    function u(e, t) {
        return t.queues[e] || (t.queues[e] = {
            evs: [],
            pause: !1,
            errored: [],
            currEv: !1
        }), t.queues[e]
    }

    function l(e, t, n) {
        return u(e, n).pause = t, Promise.resolve(n)
    }

    function d(e) {
        Object.keys(e.get().queues).forEach(function(t) {
            e.set(a.bind(null, t)), e.set(s.bind(null, t, !1))
        })
    }

    function f(e, t, n) {
        var a = Object(r.default)({
            queues: {},
            debug: n && n.debug,
            opts: extend({}, n)
        }, n);
        return n && n.store ? (a.setState(function(e) {
            for (var t = {}, n = Object.keys(e.queues), r = n.length, i = 0; i < r; i++) {
                var o = n[i],
                    a = e.queues[o];
                (a.currEv || a.evs.length || a.errored.length) && (t[o] = a)
            }
            return {
                queues: t,
                opts: e.opts
            }
        }(a.get())), d(a)) : d(a), {
            pushMessage: function(n, r) {
                return a.set(function(e, t, n) {
                    return t.ts = Date.now(), u(e, n).evs.push(t), Promise.resolve(n)
                }.bind(null, n, r)).then(function(r) {
                    c(n, e, t, r)
                })
            },
            resend: function(n, r) {
                return a.set(function(e, t, n) {
                    var r = n.queues[e];
                    return r.errored.filter(function(e) {
                        return e.mess.messageId === t
                    }).forEach(function(e) {
                        e.failed = !1, r.evs.push(e)
                    }), r.errored = r.errored.filter(function(e) {
                        return e.mess.messageId !== t
                    }), Promise.resolve(n)
                }.bind(null, n, r)).then(function(i) {
                    var o = a.get().queues[n].evs.filter(function(e) {
                        return e.mess.messageId === r
                    })[0];
                    return c(n, e, t, a), o
                })
            },
            reset: function(n) {
                return a.set(s.bind(null, n, !0)).then(function(r) {
                    c(n, e, t, r)
                })
            },
            setErrored: function(e, t) {
                return a.set(function(n) {
                    return u(e, n).errored = t, Promise.resolve(n)
                })
            },
            pause: function(e) {
                a.set(l.bind(null, e, !0))
            },
            isPaused: function(e) {
                return !!u(e, a.get()).pause
            },
            complete: function(n, r) {
                var i = a.get();
                i.queues[n].currEv && i.queues[n].currEv.rid === r && a.set(o.bind(null, n)).then(function() {
                    c(n, e, t, a)
                })
            },
            resume: function(n) {
                a.set(l.bind(null, n, !1)).then(Object(i.pause)(.1)).then(function() {
                    c(n, e, t, a)
                })
            },
            inspectQueue: function(e) {
                var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
                if (!a.get().queues[e]) return [];
                var n = a.get().queues[e];
                return (t && n.currEv ? [n.currEv] : []).concat(n.evs.slice()).concat(n.errored.slice().map(function(e) {
                    return extend({}, e, {
                        failed: !0
                    })
                })).sort(function(e, t) {
                    return e.ts - t.ts
                })
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = (n(195), n(151)),
        o = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.getRef = function(e) {
                r.element = e
            }, r.resize = function() {
                var e = r.element;
                if (e) {
                    var t = e.offsetHeight,
                        n = e.scrollHeight,
                        i = 0;
                    n + i <= t && (i = 0), e.value && r.setState({
                        height: n - i
                    }), r.setState({
                        height: 0
                    }, function() {
                        var t = e.scrollHeight - i;
                        r.setState({
                            height: t
                        }), r.props.onResize(e)
                    })
                }
            }, r.onChange = function(e) {
                r.props.grow && r.resize(), r.isControlledOutside || r.setState({
                    value: e.target.value
                }), r.props.onChange && r.props.onChange(e)
            }, r.state = {
                value: void 0 === n.value ? n.initialValue || "" : void 0
            }, void 0 !== n.value && (r.isControlledOutside = !0), r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentDidMount = function() {
            this.props.grow && this.resize()
        }, t.prototype.render = function() {
            var e = this.props,
                t = e.className,
                n = (e.initialValue, e.grow, e.style),
                a = (e.onResize, e.value),
                s = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["className", "initialValue", "grow", "style", "onResize", "value"]),
                c = this.isControlledOutside ? a : this.state.value,
                u = this.state.height || n.height || 66;
            return r.createElement("textarea", o({}, s, {
                value: c,
                onChange: this.onChange,
                onInput: this.onChange,
                onPaste: this.onChange,
                ref: this.getRef,
                style: Object.assign({
                    height: u
                }, n),
                className: Object(i.classNames)("Textarea", t)
            }))
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        initialValue: "",
        grow: !0,
        onResize: function() {},
        style: {}
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "MAX_SAFE_INTEGER", function() {
        return r
    }), n.d(t, "MAX_INTERGER", function() {
        return i
    }), n.d(t, "random", function() {
        return o
    });
    var r = 9007199254740991,
        i = 2147483647;

    function o() {
        try {
            if (window.crypto) {
                var e = new Int32Array(1);
                return crypto.getRandomValues(e), Math.abs(e.reduce(function(e, t) {
                    return e + t
                }))
            }
        } catch (e) {}
        return intval(rand(0, i).toFixed(0))
    }
}, function(e, t) {
    var n = e.exports = {
        version: "2.2.1"
    };
    "number" == typeof __e && (__e = n)
}, function(e, t, n) {
    var r = n(4),
        i = n(179),
        o = n(32),
        a = n(5)("IE_PROTO"),
        s = function() {},
        c = function() {
            var e, t = n(125)("iframe"),
                r = o.length;
            for (t.style.display = "none", n(196).appendChild(t), t.src = "javascript:", (e = t.contentWindow.document).open(), e.write("<script>document.F=Object<\/script>"), e.close(), c = e.F; r--;) delete c.prototype[o[r]];
            return c()
        };
    e.exports = Object.create || function(e, t) {
        var n;
        return null !== e ? (s.prototype = r(e), n = new s, s.prototype = null, n[a] = e) : n = c(), void 0 === t ? n : i(n, t)
    }
}, function(e, t, n) {
    "use strict";

    function r(e, t) {
        var n = void 0,
            r = void 0,
            i = function(i) {
                n = void 0 !== i.clientX ? i.clientX : i.touches[0].clientX, r = void 0 !== i.clientY ? i.clientY : i.touches[0].clientY, t.onDrag && t.onDrag.call(e, n, r)
            },
            o = function o(a) {
                t.onDrop && t.onDrop.call(e, n, r), removeEvent(document, "mouseup touchend mouseleave", o), removeEvent(document, "mousemove touchmove", i)
            },
            a = function(a) {
                (1 === a.which || a.touches && a.touches[0]) && (addEvent(document, "mouseup touchend mouseleave", o), addEvent(document, "mousemove touchmove", i), n = void 0 !== a.clientX ? a.clientX : a.touches[0].clientX, r = void 0 !== a.clientY ? a.clientY : a.touches[0].clientY, t.onStartDrag && t.onStartDrag.call(e, n, r), t.onDrag && t.onDrag.call(e, n, r), cancelEvent(a))
            };
        e.beginDragHandler = a, addEvent(e, "mousedown touchstart", a)
    }

    function i(e) {
        removeEvent(e, "mousedown touchstart", e.beginDragHandler)
    }
    n.r(t), n.d(t, "initDraggable", function() {
        return r
    }), n.d(t, "removeDraggable", function() {
        return i
    })
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE", function() {
        return c
    }), n.d(t, "MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_KICK", function() {
        return u
    }), n.d(t, "MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN", function() {
        return l
    }), n.d(t, "MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE", function() {
        return d
    }), n.d(t, "MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS", function() {
        return f
    }), n.d(t, "MAIL_CHAT_FLAG_ADMINS_CAN_INVITE_LINK", function() {
        return p
    }), n.d(t, "MAIL_CHATS_ACTION_SEE_INVITE_LINK", function() {
        return m
    }), n.d(t, "MAIL_CHATS_ACTION_CHANGE_INVITE_LINK", function() {
        return g
    }), n.d(t, "MAIL_CHATS_ACTION_INVITE_USER", function() {
        return h
    }), n.d(t, "MAIL_CHATS_ACTION_KICK_USER", function() {
        return _
    }), n.d(t, "MAIL_CHATS_ACTION_PIN_OR_UNPIN", function() {
        return v
    }), n.d(t, "MAIL_CHATS_ACTION_CHANGE_TITLE", function() {
        return b
    }), n.d(t, "MAIL_CHATS_ACTION_ADD_ADMIN", function() {
        return y
    }), n.d(t, "canSeeInviteLink", function() {
        return C
    }), n.d(t, "canChangeInviteLink", function() {
        return k
    }), n.d(t, "canAddAdmin", function() {
        return E
    }), n.d(t, "canInviteUser", function() {
        return j
    }), n.d(t, "canKickUser", function() {
        return S
    }), n.d(t, "canPinOrUnpin", function() {
        return T
    }), n.d(t, "canChangeTitle", function() {
        return I
    }), n.d(t, "canChangeAvatar", function() {
        return P
    }), n.d(t, "canSeeAllMessages", function() {
        return M
    }), n.d(t, "checkChatRights", function() {
        return x
    }), n.d(t, "doesChatTabHaveFlag", function() {
        return L
    }), n.d(t, "isUserAdminInChat", function() {
        return A
    }), n.d(t, "isUserOwnerInChat", function() {
        return N
    }), n.d(t, "isUserInvitedByMe", function() {
        return D
    });
    var r, i = n(148),
        o = n(7),
        a = n(54);

    function s(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    var c = 1,
        u = 2,
        l = 4,
        d = 8,
        f = 16,
        p = 32,
        m = "see_invite_link",
        g = "change_invite_link",
        h = "invite_user",
        _ = "kick_user",
        v = "pin_unpin",
        b = "change_title",
        y = "add_admin",
        w = (s(r = {}, m, p), s(r, g, p), s(r, y, f), s(r, h, c), s(r, _, u), s(r, v, l), s(r, b, d), r),
        O = 1;

    function C(e, t, n) {
        return x(e, m, t, n)
    }

    function k(e, t, n) {
        return x(e, g, t, n)
    }

    function E(e, t, n, r) {
        var a = Object(o.unpackStore)(e);
        return !N(Object(i.getTab)(a, n || a.peer), t) && x(e, y, n, r)
    }

    function j(e, t, n) {
        return x(e, h, t, n)
    }

    function S(e, t, n, r) {
        var a = Object(o.unpackStore)(e);
        if (function(e, t) {
                var n = Object(o.unpackStore)(e);
                return void 0 !== n.service && (n.service & t) > 0
            }(e, O)) return !0;
        var s = Object(i.getTab)(a, n || a.peer),
            c = x(e, _, n, r),
            l = L(s, u);
        return r = void 0 === r ? window.vk.id : r, !N(s, t) && (l || N(s, r) || A(s, r) ? c : c && !A(s, t) && D(s, t))
    }

    function T(e, t, n) {
        return x(e, v, t, n)
    }

    function I(e, t, n) {
        return x(e, b, t, n)
    }

    function P(e, t, n) {
        return I(e, t, n) && !Object(a.isFvkcomgroup)(e, t)
    }

    function M(e, t, n) {
        return !Object(i.isCommunityPeer)(n) || !!Object(i.getTab)(e, t).caccess[n]
    }

    function x(e, t, n, r) {
        var s = Object(o.unpackStore)(e);
        r = void 0 === r ? window.vk.id : r, n = void 0 === n ? s.peer : n;
        var c = Object(i.getTab)(s, n),
            u = !c.data.kicked && !c.data.closed,
            l = w[t];
        if (Object(a.isFvkcomgroup)(e, n)) switch (t) {
            case y:
            case h:
            case _:
                return !1;
            case m:
                return u;
            default:
                return s.gid > 0
        }
        switch (t) {
            case m:
            case g:
            case y:
                return L(c, l) ? A(c, r) && u : N(c, r);
            case h:
            case _:
            case v:
            case b:
                return L(c, l) ? A(c, r) && u : u
        }
        return !1
    }

    function L(e, t) {
        return ((e && e.data && e.data.flags || 0) & t) > 0
    }

    function A(e, t) {
        return (e && e.adminIds || []).indexOf(+t) > -1
    }

    function N(e, t) {
        return e.ownerId === t
    }

    function D(e, t) {
        return -1 !== e.invitedByMe.indexOf(t)
    }
}, function(e, t, n) {
    "use strict";
    e.exports = n(140)
}, function(e, t, n) {
    "use strict";

    function r(e) {
        var t = e.getBoundingClientRect(),
            n = document.body,
            r = document.documentElement,
            i = window.pageYOffset || r.scrollTop || n.scrollTop,
            o = window.pageXOffset || r.scrollLeft || n.scrollLeft,
            a = r.clientTop || n.clientTop || 0,
            s = r.clientLeft || n.clientLeft || 0;
        return {
            top: Math.round(t.top + i - a),
            left: Math.round(t.left + o - s),
            width: e.offsetWidth,
            height: e.offsetHeight
        }
    }
    n.r(t), n.d(t, "default", function() {
        return r
    })
}, function(e, t, n) {
    "use strict";
    var r = n(159);
    e.exports = n(206)("Map", function(e) {
        return function() {
            return e(this, arguments.length > 0 ? arguments[0] : void 0)
        }
    }, {
        get: function(e) {
            var t = r.getEntry(this, e);
            return t && t.v
        },
        set: function(e, t) {
            return r.def(this, 0 === e ? 0 : e, t)
        }
    }, r, !0)
}, function(e, t, n) {
    "use strict";
    n.r(t), t.default = {
        onNewMessagesChunk: function(e) {
            var t = geByClass("post");
            LongView.clearElemsCache && LongView.clearElemsCache(), t.forEach(function(e) {
                return LongView.register(e, "im")
            })
        },
        onHistoryScroll: function(e) {
            LongView.onScroll(e, window.innerHeight)
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return z
    });
    var r = n(194),
        i = n(102),
        o = n(54),
        a = n(18),
        s = n(148),
        c = n(26),
        u = n(11),
        l = n(160),
        d = n(158),
        f = n(78),
        p = n(187),
        m = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var g = "_im_action",
        h = "_im_page_peer_name",
        _ = "_ui_menu",
        v = "_im_dialog_action_wrapper",
        b = "_im_mess_actions",
        y = "_im_page_action",
        w = "_im_chat_topic_change_input",
        O = "_im_chat_verified",
        C = "im-page--chat-header_chat",
        k = "im-page--chat-header_vkcomgroup",
        E = "_im_page_peer_name",
        j = "_im_chat_members",
        S = "_im_chat_invite_link",
        T = '<a tabindex="0" role="link" class="ui_actions_menu_item ' + g + ' im-action im-action_%icon%" data-action="%action%">%name%</a>';

    function I(e, t, n) {
        return !e.map(function(e) {
            var r = Object(s.getMessage)(t, n, e);
            return Object(c.isImportant)(r)
        }).reduce(function(e, t) {
            return e && t
        }, !1)
    }

    function P(e, t) {
        var n = t.get(),
            r = n.peer,
            i = n.tabs[r].pinned;
        return 1 === e.length && i && e[0] === Object(s.parserMessage)(i).messageId
    }

    function M(e, t, n) {
        var r = getLang("mail_selected_shorted", t.length);
        A({
            actions: !0
        }, "im-page--chat-header"), val(geByClass1("im-page--selected-messages"), getTemplate("im_selected_messages", {
            label: r.replace("{count}", t.length),
            tip: getLang("mail_deselect_all")
        }));
        var i = Object(s.getTab)(n, n.get().peer),
            a = geByClass1(b, e),
            c = I(t, n, n.get().peer),
            u = P(t, n),
            l = Object(o.isChatPeer)(i.peerId) && Object(p.canPinOrUnpin)(n, i.peerId),
            d = Object(o.isFvkcomgroup)(n, i.peerId);
        toggleClass(a, "im-page--mess-actions_important", !c), toggleClass(a, "im-page--mess-actions_pinned", u), toggleClass(a, "im-page--mess-actions_vkcomgroup", d && !n.get().gid), toggleClass(a, "im-page--mess-actions_multiple-selection", t.length > 1), toggleClass(a, "im-page--mess-actions_no-pin-btn", !l);
        var f = c ? getLang("mail_im_toggle_important") : getLang("mail_im_toggle_important_off"),
            m = u ? getLang("mail_unpin") : getLang("mail_pin");
        attr(geByClass1("im-page-action_star", e), "aria-label", f), attr(geByClass1("im-page-action_pin", e), "aria-label", m)
    }

    function x(e, t, n) {
        var r = t.get(),
            a = r.peer,
            c = r.tabs[a],
            d = clean(stripHTML(unclean(c.tab))),
            f = geByClass1(O, e),
            p = geByClass1(o.PINNED_CONTAINER_CLASS),
            m = Object(o.isChatPeer)(a),
            g = m && Object(o.isFvkcomgroup)(t, a);
        f.tt = !1;
        var _ = Object(o.renderPhotosFromTab)(t, c, !0),
            y = getTemplate("im_simple_link", {
                href: g ? "/club" + -c.ownerId : c.href,
                content: getTemplate("im_peer_photo", {
                    online_class: "",
                    owner_photo: _,
                    modifier_class: "nim-peer_smaller"
                })
            });
        val(geByClass1("im-page--aside-photo", e), y);
        var w, C, k, E = m ? !c.data.closed && !c.data.kicked : 0,
            j = {
                muted: inArray(a, r.mutedPeers),
                verified: !!c.verified,
                chat: m,
                vkcomgroup: g,
                actions: !1,
                derelict: m && !E && !g,
                pinned: !1
            };
        if (m) {
            var S = Object(s.getPinnedMessage)(t),
                T = function(e) {
                    var t = Object(s.getPinnedMessage)(e);
                    if (!t || Object(u.oCacheGet)(e, t.userId)) return !1;
                    return t.userId
                }(t);
            S && Object(l.isPinnedMessageVisibleInTab)(t, a) && (T ? t.set(i.loadChatMember.bind(null, (w = {}, C = a, k = [T], C in w ? Object.defineProperty(w, C, {
                value: k,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : w[C] = k, w))).then(x.bind(null, e, t, n)) : j.pinned = !0)
        }
        var I = "";
        m ? I = g ? getTemplate("im_vkcomgroup_members", {
            name: getLang("mail_im_n_vkcomgroup_members", Object(o.getAliveMembersCount)(c))
        }) : E ? getTemplate("im_chat_members", {
            name: getLang("mail_im_n_chat_members", Object(o.getAliveMembersCount)(c))
        }) : "" : Object(o.isUserPeer)(a) && (I = Object(o.getLastSeenTextInHeader)(t, a));
        var P = getTemplate("im_simple_name", {
            name: c.tab,
            href: g ? "/club" + -c.ownerId : c.href,
            name_attr: d,
            ads_union: c.ad_union_ids_attr,
            online: I,
            more_cls: "" === I ? "im-page--title--1line" : ""
        });
        val(geByClass1("im-page--title-wrapper", e), P);
        var M = val(p) && !c.top_banner,
            N = L(t) && !c.top_banner,
            D = geByClass1(h, e);
        if (removeClass(D, o.DESELECT_ALL_CLASS), show(geByClass1(v, e)), removeClass(geByClass1(b, e), "im-page--mess-actions_visible"), removeClass(geByClass1(b, e), "im-page--mess-actions_all-sel"), function(e, t, n) {
                geByClass("_im_header_icon", e).forEach(function(e) {
                    if (n.length > 0) hide(e);
                    else if ("star" === domData(e, "type") && Object(o.isFoldersAvailable)(t) && (toggleClass(e, "im-page--header-icon_star-active", Object(o.isImportant)(t)), setStyle(e, {
                            display: "inline-block"
                        })), "answer" === domData(e, "type") && Object(o.isFoldersAvailable)(t) && (toggleClass(e, "im-page--header-icon_answer-shown", Object(o.isUnrespond)(t)), Object(o.isUnrespond)(t) ? setStyle(e, {
                            display: "inline-block"
                        }) : hide(e)), "search" === domData(e, "type") && !Object(o.isCommunityInterface)(t)) {
                        var r = Object(o.isFullyLoadedTab)(t, t.get().peer) && t.get().tabs[t.get().peer].offset;
                        setStyle(e, {
                            display: "inline-block"
                        }), toggleClass(e, "im-page-header-icon_search-shown", r)
                    }
                })
            }(e, t, []), Object(o.isClassicInterface)(t)) {
            var R = geByClass1("_im_page_back", e);
            attr(R, "href", Object(o.getBaseLink)(t) + "?tab=" + r.active_tab)
        }
        A(j, "im-page--chat-header"), Object(o.compensateHistoryHeightChange)(t, N, M, n)
    }

    function L(e) {
        var t = Object(s.getPinnedMessage)(e),
            n = geByClass1(o.PINNED_CONTAINER_CLASS);
        if (removeClass(n, "im-page--pinned_with-bar"), t && Object(c.isMoneyRequest)(t)) {
            if (void 0 === t.kludges.attach1_tr_amount) return;
            t.kludges.attach1_total_amount && addClass(n, "im-page--pinned_with-bar")
        }
        var r = Object(o.renderPinnedMessage)(e);
        return val(n, r), !!r
    }

    function A(e, t) {
        var n = geByClass1(t);
        Object.keys(e).forEach(function(r) {
            toggleClass(n, t + "_" + r, !!e[r])
        })
    }

    function N(e, t, n, r, o) {
        e.set(i.removeMessagesWithRestore.bind(null, n, o, r)).then(t().removeMessagesRestore.bind(null, n, o, r)), Object(i.removeMessageSend)(n, o, null, r, e.get())
    }

    function D(e, t, n) {
        if (Object(o.isChatPeer)(t)) {
            var r = e.get().tabs[t].name,
                a = function(e, t, n, r, o, a) {
                    if ("keydown" !== a.type || 13 === a.which) {
                        var s = trim(val(o));
                        return s ? (s !== n && e.set(i.updateChatTopic.bind(null, t, s)), !0) : (notaBene(o), !1)
                    }
                }.bind(null, e, t, r, n),
                s = showFastBox({
                    title: getLang("mail_chat_topic_change_title"),
                    dark: 1
                }, getTemplate("im_chat_change_topic", {
                    value: r
                }), getLang("global_save"), function(e, t) {
                    a(c, t) && s.hide()
                }, getLang("global_cancel"), function() {
                    s.hide()
                }),
                c = geByClass1(w, s.bodyNode);
            elfocus(c), addEvent(c, "keydown", function(e) {
                a(c, e) && s.hide()
            })
        }
    }

    function R(e, t, n, r, c, u) {
        var d = domData(u, "action"),
            f = geByClass1(_, r).parentNode,
            p = e.get().peer,
            g = Object(o.isFvkcomgroup)(e, p);
        switch (d) {
            case "clear":
                var h = Object(s.getTab)(e, p),
                    v = Object(o.showFlushDialog)(h, p, function() {
                        Object(o.cleanHistory)(e, v, t, i.flushHistory, e.get().peer)
                    });
                break;
            case "photos":
            case "media":
                showWiki({
                    w: "history" + Object(o.convertPeerToUrl)(p) + "_photo"
                }, null, {});
                break;
            case "topic":
                D(e, p, t);
                break;
            case "avatar":
                cur.recieveCropResult = void 0, Page.ownerPhoto(p, {
                    gid: e.get().gid
                });
                break;
            case "search":
                t().showSearch(e);
                break;
            case "block_community":
                e.set(i.toggleCommunityMessages.bind(null, !1, p)).then(function() {
                    e.get().longpoll.push([Object(a.resetPeer)()]), showDoneBox(getLang("mail_community_was_blocked"))
                });
                break;
            case "allow_community":
                e.set(i.toggleCommunityMessages.bind(null, !0, p)).then(function() {
                    n().changeActions(e)
                });
                break;
            case "block":
                Object(o.showBlacklistBox)(p, e).once("success", function(t) {
                    t.delta && (showDoneBox(t.msg), e.get().longpoll.push([Object(a.resetPeer)()]))
                });
                break;
            case "leave":
                var b = showFastBox({
                    title: g ? getLang("mail_vkcomgroup_leave_title") : getLang("mail_chat_leave_title"),
                    dark: 1
                }, g ? getLang("mail_vkcomgroup_leave_confirm") : getLang("mail_chat_leave_confirm"), g ? getLang("mail_leave_vkcomgroup") : getLang("mail_leave_chat"), function() {
                    e.set(i.leaveChat.bind(null, p)), e.set(i.unpinMessageOptimistic.bind(null, p)), b.hide(), e.get().longpoll.push([Object(a.resetPeer)()])
                }, getLang("global_cancel"), function() {
                    b.hide()
                });
                break;
            case "invite_link":
                var y = function(e, t, n) {
                        var r = showFastBox({
                            title: getLang("mail_chat_invite_link"),
                            dark: 1
                        }, getLang("mail_chat_reset_link_warning"), getLang("mail_chat_reset_link_confirm"), function(o) {
                            var a = gpeByClass("_im_invite_box", n.target),
                                s = geByClass1(S, a),
                                c = geByClass1("_im_invite_new", a);
                            lockButton(r.btns.ok[0]), Object(i.resetInviteLink)(t, e.get()).then(function(e) {
                                var t = m(e, 1)[0];
                                unlockButton(r.btns.ok[0]), s.value = t, unlockButton(c), addClass(a, "im-invite-box_reseted"), elfocus(s, 0, t.length), r.hide()
                            })
                        }, getLang("global_cancel"), function() {
                            r.hide()
                        })
                    }.bind(null, e, p),
                    w = !1,
                    O = !1,
                    C = !1,
                    k = function() {
                        elfocus(w, 0, w.value.length), document.execCommand("copy"), setStyle(O, {
                            opacity: 1
                        }), C && (C = clearTimeout(C)), C = setTimeout(function() {
                            return setStyle(O, {
                                opacity: 0
                            })
                        }, 2e3)
                    },
                    E = !1,
                    j = !1;
                showBox("al_im.php", {
                    act: "a_get_link",
                    gid: e.get().gid,
                    chat_id: p - 2e9,
                    markup: 1
                }, {
                    onDone: function(e) {
                        w = geByClass1(S, e.bodyNode), E = geByClass1("_im_reset_link", e.bodyNode), j = geByClass1("_im_invite_copy", e.bodyNode), O = geByClass1("_im_invite_copied", e.bodyNode), elfocus(w, 0, w.value.length), addEvent(E, "click", y), addEvent(j, "click", k)
                    },
                    params: {
                        hideButtons: !0,
                        onHide: function() {
                            removeEvent(E, "click", y), removeEvent(j, "click", k)
                        },
                        onShow: function() {
                            addEvent(E, "click", y), addEvent(j, "click", k)
                        }
                    }
                }, {});
                break;
            case "return":
                e.set(i.returnToChat.bind(null, p)).then(function(e) {
                    return e.set(i.getPinnedMessage.bind(null, p))
                }).then(t().updateChatTopic.bind(null, p)).catch(function(e) {
                    showFastBox(getLang("global_error"), e)
                });
                break;
            case "unmute":
            case "mute":
                e.set(i.toggleMutePeer.bind(null, p, "mute" === d)).then(t().updateState.bind(null, p));
                break;
            case "chat":
            case "invite":
                if (Object(o.isChatPeer)(p)) Object(o.inviteUser)(e, p, t, i.setCreationType);
                else if (Object(o.isUserPeer)(p)) {
                    var T = e.get().tabs[p],
                        I = [
                            [p, T.tab]
                        ];
                    e.set(i.setCreationType.bind(null, "chat", [])).then(function() {
                        return t().showCreation(e, I)
                    })
                }
                break;
            case "pin_hide":
                Object(l.pinnedMessageHide)(e, Object(s.getPeer)(e), t);
                break;
            case "pin_unhide":
                Object(l.pinnedMessageUnHide)(e, Object(s.getPeer)(e), t);
                break;
            case "unpin":
                Object(l.pinnedMessageUnpin)(e, Object(s.getPeer)(e), t);
                break;
            case "settings":
                n().showSettings(e)
        }
        uiActionsMenu.toggle(f, !1), t().cancelEditing()
    }

    function F(e, t, n) {
        var r = e.get().selectedMessages;
        e.set(i.cleanSelected).then(n().changedMessageSelection).then(t().cleanSelection.bind(null, r))
    }

    function B(e, t, n, r) {
        var i = Object(o.isClassicInterface)(e),
            a = void 0,
            s = void 0;
        switch (domData(r, "type")) {
            case "star":
                s = [4, 6], a = function() {
                    return Object(o.isImportant)(e) ? getLang("mail_im_toggle_important_off") : getLang("mail_im_toggle_important")
                };
                break;
            case "answer":
                s = [4, 6], a = getLang("mail_end_conversation");
                break;
            case "search":
                s = i ? [5, 6] : [4, -9], a = getLang("mail_search_in_peer")
        }
        showTooltip(r, {
            text: a || "",
            black: 1,
            shift: s,
            forcetoup: !0,
            appendParentCls: i ? "_im_dialog_actions" : "_im_mess_actions"
        })
    }

    function H(e, t, n) {
        var r = Object(o.isClassicInterface)(e),
            i = domData(n.target, "action");
        "respond" !== i && "forward" !== i && showTooltip(n.target, {
            text: function(e, t) {
                var n = e.get(),
                    r = n.selectedMessages,
                    i = n.peer;
                switch (t) {
                    case "pin":
                        return P(r, e) ? getLang("mail_unpin") : getLang("mail_pin");
                    case "star":
                        return I(r, e, i) ? getLang("mail_im_toggle_important") : getLang("mail_im_toggle_important_off");
                    case "delete":
                        return getLang("mail_delete");
                    case "spam":
                        return getLang("mail_im_mark_spam")
                }
            }.bind(null, e, i) || "",
            black: 1,
            shift: [2, r ? -4 : 11],
            forcetodown: !0,
            appendParentCls: "_im_dialog_actions"
        })
    }

    function U(e, t, n, a) {
        return {
            changeActions: function(t) {
                var n = geByClass1(_, e),
                    r = geByClass1(v, e),
                    o = t.get().curActions,
                    a = Object.keys(o).map(function(e, t) {
                        var n = "";
                        return 7 !== i.ACTION_PRIORITIES[e] && 10 !== i.ACTION_PRIORITIES[e] || 0 === t || (n = '<div class="ui_actions_menu_sep"></div>'), n + rs(T, {
                            name: o[e].name,
                            icon: o[e].icon,
                            action: e
                        })
                    }).join("");
                0 === Object.keys(o).length ? addClass(r, "im-page--header-more_loading") : (val(n, a), removeClass(r, "im-page--header-more_loading"))
            },
            showSettings: function(n) {
                var r = n.get(),
                    c = r.chatSettingsAllowed,
                    u = Object(s.getTab)(n, r.peer),
                    l = Object(o.isFvkcomgroup)(n, r.peer);
                c ? u.data.closed || u.data.kicked || Object(d.mount)(e, n, a) : l || Object(o.showChatMembers)(n, t, i.setCreationType)
            },
            showForward: function(t) {
                t.get().newForwardAllowed && Object(f.mount)(e, t, a)
            },
            renderPeer: function(n) {
                x(e, n, t)
            },
            reRenderPinned: function(e) {
                var t = Object(s.getCurrentTab)(e);
                t && t.pinned && L(e)
            },
            renderActions: function(t) {
                var n = t.get().selectedMessages || [];
                n.length > 0 && M(e, n, t)
            },
            hideActions: function(t) {
                if (!Object(o.isFullyLoadedTab)(t, t.get().peer)) {
                    var n = geByClass1(v, e);
                    addClass(n, "im-page--header-more_loading")
                }
            },
            changedMessageSelection: function(n) {
                if (0 !== n.get().peer) {
                    var r = n.get().selectedMessages || [];
                    r.length > 0 ? M(e, r, n) : x(e, n, t)
                }
            },
            updateLastSeen: function(t) {
                ! function(e, t) {
                    var n = e.get().peer,
                        r = geByClass1("_im_page_peer_online", t);
                    r && Object(o.isUserPeer)(n) && Object(s.getTab)(e, n) && Object(o.applyInnerHtml)(r, Object(o.getLastSeenTextInHeader)(e, n))
                }(t, e)
            },
            deselectAll: function(e) {
                F(e, t, a)
            },
            unmount: function() {
                Object(r.destroyModule)(n), cancelStackFilter("fowrward")
            }
        }
    }

    function z(e, t, n) {
        var c = Object(r.createMutations)(U),
            u = c.callMutations,
            l = c.bindMutations,
            d = function(e, t, n, r, c) {
                var u = e.get().selectedMessages,
                    l = domData(c, "action"),
                    d = e.get().peer,
                    f = !0;
                switch (l) {
                    case "delete":
                        var p = !(vk.id == d && !e.get().gid) && u.every(function(t) {
                            return Object(o.canMessageBeDeletedForAll)(e, Object(s.getMessage)(e, d, t))
                        });
                        if (p || u.length > 1) {
                            f = !1;
                            var m = Object(o.showMsgDeleteDialog)(d, u.length, p, function(r) {
                                F(e, t, n), m.hide(), cur.imDb.updateByKey("del_forall_checked", r), r ? Object(i.removeMessageSend)(u, d, null, "deleteforall", e.get()) : N(e, t, u, l, d)
                            })
                        } else N(e, t, u, l, d);
                        break;
                    case "spam":
                        N(e, t, u, l, d);
                        break;
                    case "forward":
                        var g = e.get();
                        Object(i.processFwd)(u, g.peer, e).then(function(t) {
                            return e.set(i.prepareForward.bind(null, t))
                        }).then(function() {
                            g.newForwardAllowed ? n().showForward(e) : Object(o.isClassicInterface)(e) ? (cancelStackPush("forward", function(t) {
                                e.set(i.prepareForward.bind(null, null)).then(function() {
                                    e.get().longpoll.push([Object(a.changePeer)(t)])
                                })
                            }.bind(null, e.get().peer)), e.get().longpoll.push([Object(a.resetPeer)(!0)])) : t().startForward(e)
                        }).catch(function(e) {
                            return console.error(e)
                        });
                        break;
                    case "star":
                        var h = I(u, e, d);
                        e.set(i.favMessage.bind(null, u, h, d)), e.get().longpoll.push(u.map(function(e) {
                            return {
                                type: h ? a.SET_FLAGS : a.RESET_FLAGS,
                                messageId: e,
                                peerId: d,
                                flags: a.FLAG_IMPORTANT
                            }
                        }));
                        break;
                    case "respond":
                        Object(i.processFwd)(u, e.get().peer, e).then(function(t) {
                            return e.set(i.forwardMessages.bind(null, t, e.get().tfdraft))
                        }).then(function() {
                            t().respond(e, d)
                        });
                        break;
                    case "pin":
                        var _ = Object(s.getLocalId)(e, u[0]),
                            v = P(u, e),
                            b = v ? i.unpinMessageOptimistic.bind(null, d) : i.pinMessageOptimistic.bind(null, _, d),
                            y = v ? i.unpinMessage.bind(null, d) : i.pinMessage.bind(null, _, d),
                            w = function(e, t, n) {
                                return e().updateChatTopic(t, n), n
                            }.bind(null, t, d);
                        e.set(i.checkChatMember.bind(null, e, _, d)).then(function(e) {
                            return e.set(b)
                        }).then(w).then(function(e) {
                            return e.set(y)
                        }).then(w)
                }
                f && F(e, t, n)
            }.bind(null, t, n, u),
            f = R.bind(null, t, n, u, e),
            p = F.bind(null, t, n, u),
            m = function(e, n) {
                return Object(o.showVerifiedTooltip)(n, t.get().peer)
            },
            h = B.bind(null, t, e),
            _ = H.bind(null, t, e),
            v = function(e, t, n, r, o) {
                switch (domData(o, "type")) {
                    case "star":
                        e.set(i.toggleDialogImportant.bind(null, e.get().peer)).then(function() {
                            setTimeout(function() {
                                return B(e, 0, 0, o)
                            }, 40)
                        });
                        break;
                    case "search":
                        n().showSearch(e), window.tooltips && tooltips.hide(o, {
                            fasthide: !0
                        });
                        break;
                    case "answer":
                        var c = Object(s.getTab)(e, e.get().peer);
                        c && (e.set(i.markDialogAnswered.bind(null, e.get().peer, c.lastmsg)), showDoneBox(getLang("mail_marked_as_answered"), {
                            out: 1e3
                        }), e.get().longpoll.push([Object(a.resetPeer)()]))
                }
            }.bind(null, t, e, n),
            b = function() {
                return u().showSettings(t)
            },
            w = function(t) {
                !gpeByClass(C, t.target, e) || gpeByClass(k, t.target, e) || checkEvent(t) || (b(), cancelEvent(t))
            },
            S = Object(r.createModule)({
                handlers: function(n, r) {
                    r(e, "click", y, d), r(e, "click", g, f), r(e, "click", o.DESELECT_ALL_CLASS, p), r(e, "mouseover", O, m), r(e, "mouseover", "_im_header_icon", h), r(e, "mouseover", y, _), r(e, "click", "_im_header_icon", v), r(e, "click", "_im_header_link", w), r(e, "click", E, w), r(e, "click", j, b), r(e, "click", "_im_page_back", function(e) {
                        checkEvent(e) || (t.get().longpoll.push([Object(a.resetPeer)()]), cancelEvent(e))
                    })
                }
            });
        return Object(o.isReservedPeer)(t.get().peer) || setTimeout(function() {
            t.set(i.setActions).then(u().changeActions)
        }), l(e, n, S, u)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "doesSearchResultContainConversations", function() {
        return c
    }), n.d(t, "mount", function() {
        return u
    });
    var r = n(194),
        i = n(102),
        o = n(54),
        a = n(18);

    function s(e, t) {
        return {
            isAll: function(e) {
                return Object(i.isSearchAllLoaded)(e.get().peer, e.get())
            },
            loadMore: function(e) {
                return function(e) {
                    return Object(i.isSearchAllLoaded)(e.get().peer, e.get()) ? Promise.resolve("") : Object(i.searchMessagesInplace)(e.get().peer, e.get())
                }(e)
            },
            unmount: function() {
                Object(r.destroyModule)(t)
            }
        }
    }

    function c(e) {
        return e.findIndex(function(e) {
            return "number" == typeof e.peerId && e.href
        }) > -1
    }

    function u(e, t) {
        var n = function(e, t, n) {
            var r = intval(domData(n, "msgid"));
            if (!getSelectionText() && !Object(o.checkSelectClick)(t)) {
                var s = intval(domData(n, "peer"));
                return e.set(i.cancelSearch.bind(null, s)), e.get().longpoll.push([Object(a.changePeer)(s, r)]), !1
            }
        }.bind(null, t);
        return s(0, Object(r.createModule)({
            handlers: function(t, r) {
                r(e, "click", "_im_mess", n)
            }
        }))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createMutations", function() {
        return c
    }), n.d(t, "createModule", function() {
        return u
    }), n.d(t, "destroyModule", function() {
        return l
    });
    var r = n(87);

    function i(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
            return n
        }
        return Array.from(e)
    }
    var o = window,
        a = o.addEvent,
        s = o.removeEvent;

    function c(e) {
        return {
            callMutations: function() {
                if ("function" == typeof e) throw console.trace(), new Error("Mutations are not initialized");
                return e
            },
            bindMutations: function() {
                if ("function" != typeof e) throw console.trace(), new Error("Mutations are already initialized");
                return e = e.apply(void 0, arguments)
            }
        }
    }

    function u(e) {
        var t = {
            _registeredHandlers: []
        };
        return e.handlers(function(e, t, n, r) {
            a(t, n, r), e._registeredHandlers.push(["bind", t, n, r])
        }.bind(null, t), function(e, t, n, i, o) {
            Object(r.addDelegateEvent)(t, n, i, o), e._registeredHandlers.push(["delegate", t, n, i, o])
        }.bind(null, t)), t
    }

    function l(e) {
        e._registeredHandlers.forEach(function(e) {
            var t = e.slice(1);
            "delegate" === e[0] ? r.removeDelegateEvent.apply(void 0, i(t)) : s.apply(void 0, i(t))
        }), e._registeredHandlers = []
    }
}, function(e, t, n) {
    e.exports = n(31)()
}, function(e, t, n) {
    e.exports = n(91).document && document.documentElement
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(109),
        o = n(33),
        a = n(64),
        s = n(101);
    var c = i.default.getLang,
        u = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onConfirm = function() {
                    r.state.loading || (r.setState({
                        loading: !0
                    }), r.props.onConfirm().then(function() {
                        r.setState({
                            loading: !1
                        }), r.props.onCancel()
                    }).catch(function() {
                        return r.setState({
                            loading: !1
                        })
                    }))
                }, r.state = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                return r.createElement("div", {
                    className: "ChatSettingsResetInvitationLink"
                }, r.createElement("div", {
                    className: "ChatSettingsResetInvitationLink__text",
                    dangerouslySetInnerHTML: {
                        __html: c("mail_chat_reset_link_warning")
                    }
                }), r.createElement(s.default, {
                    alignment: "right"
                }, r.createElement(o.default, {
                    appearance: "tertiary",
                    onClick: this.props.onCancel
                }, c("global_cancel")), r.createElement(a.default, {
                    onClick: this.onConfirm,
                    loading: this.state.loading
                }, c("mail_chat_reset_link_confirm"))))
            }, t
        }(r.Component);
    t.default = u
}, function(e, t, n) {
    e.exports = !n(154) && !n(145)(function() {
        return 7 != Object.defineProperty(n(125)("div"), "a", {
            get: function() {
                return 7
            }
        }).a
    })
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(151),
        o = n(109),
        a = n(144),
        s = n(85),
        c = n(38),
        u = n(6),
        l = n(203),
        d = n(187),
        f = n(54);
    var p = o.default.getLang,
        m = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onCopyInviteLink = function(e) {
                    r.input && (r.input.focus(), r.input.select(), document.execCommand("copy"), r.setState({
                        copied: !0
                    })), e.preventDefault(), e.stopPropagation()
                }, r.onBlinkTextHide = function() {
                    r.setState({
                        copied: !1
                    })
                }, r.getHiddenInput = function(e) {
                    r.input = e
                }, r.onShowInviteLink = function() {
                    Object(d.canChangeInviteLink)(r.props.store) && r.props.showInvitationLink()
                }, r.state = {
                    copied: !1
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.store,
                    n = e.flagsUpdated,
                    o = e.onHideStatus,
                    m = t.get(),
                    g = m.tabs[m.peer],
                    h = Object(f.isFvkcomgroup)(m, m.peer),
                    _ = g.inviteLink && Object(d.canSeeInviteLink)(t) || Object(d.canChangeInviteLink)(t),
                    v = Object(d.isUserOwnerInChat)(g, m.id) && !h,
                    b = Object(i.classNames)("ChatSettingsMenu", {
                        "ChatSettingsMenu--copied": this.state.copied
                    });
                return r.createElement("div", {
                    className: "ChatSettings__pane"
                }, r.createElement(s.default, {
                    className: b
                }, r.createElement(c.default, {
                    onClick: this.props.showAttachments,
                    chevron: !0
                }, r.createElement(l.default, {
                    type: "attach"
                }), p("mail_im_show_media_history"))), (_ || v) && r.createElement(s.default, {
                    className: b
                }, _ && r.createElement(c.default, {
                    onClick: this.onShowInviteLink,
                    chevron: Object(d.canChangeInviteLink)(t)
                }, r.createElement(l.default, {
                    type: "link"
                }), p(h ? "mail_vkcomgroup_invite_link" : "mail_chat_invite_link"), g.inviteLink && r.createElement("span", {
                    className: "ChatSettingsMenu__invite"
                }, r.createElement("span", {
                    className: "ChatSettingsMenu__hidden"
                }, r.createElement("input", {
                    type: "text",
                    readOnly: !0,
                    value: g.inviteLink,
                    ref: this.getHiddenInput
                })), r.createElement(u.default, {
                    className: "ChatSettingsMenu__copied",
                    shown: this.state.copied,
                    callback: this.onBlinkTextHide
                }, p("mail_invite_link_copied")), r.createElement(a.default, {
                    className: "ChatSettingsMenu__copy",
                    onClick: this.onCopyInviteLink
                }, p("mail_get_invite_link_copy")))), v && r.createElement(c.default, {
                    onClick: this.props.showSettings,
                    chevron: !0,
                    aside: r.createElement(u.default, {
                        shown: n,
                        callback: o
                    }, p("global_changes_saved"))
                }, r.createElement(l.default, {
                    type: "gear"
                }), p("mail_settings_options"))))
            }, t
        }(r.Component);
    t.default = m
}, function(e, t, n) {
    for (var r = n(14), i = n(61), o = n(91), a = n(34), s = n(107), c = n(68), u = c("iterator"), l = c("toStringTag"), d = s.Array, f = ["NodeList", "DOMTokenList", "MediaList", "StyleSheetList", "CSSRuleList"], p = 0; p < 5; p++) {
        var m, g = f[p],
            h = o[g],
            _ = h && h.prototype;
        if (_)
            for (m in _[u] || a(_, u, d), _[l] || a(_, l, g), s[g] = d, r) _[m] || i(_, m, r[m], !0)
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return a
    });
    var r = n(188),
        i = n(151),
        o = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function a(e) {
        var t = e.children,
            n = e.className,
            a = function(e, t) {
                var n = {};
                for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                return n
            }(e, ["children", "className"]);
        return r.createElement("div", o({}, a, {
            className: Object(i.classNames)("Stub", n)
        }), t || "No results.")
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return o
    });
    var r = n(188),
        i = n(151);

    function o(e) {
        return r.createElement("div", {
            className: Object(i.classNames)("ChatSettingsRoundedIcon", "ChatSettingsRoundedIcon--" + e.type)
        })
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "getNativeOption", function() {
        return o
    }), n.d(t, "setNativeOption", function() {
        return a
    }), n.d(t, "createScroll", function() {
        return l
    });
    var r = n(194);

    function i(e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
    }

    function o(e, t) {
        return bodyNode[e] || document.documentElement[e]
    }

    function a(e, t, n) {
        "scrollTop" === e && window.scrollTo(0, t)
    }
    var s = function() {
            function e(t, n) {
                var o = this;
                i(this, e), this.el = t, this.opts = n, this.module = Object(r.createModule)({
                    handlers: function(e, t) {
                        e(window, "scroll", o.onScroll.bind(o)), e(window, "resize", o.resize.bind(o))
                    }
                }), this.innerHeight = window.innerHeight, this.prevScroll = this.scrollTop()
            }
            return e.prototype.update = function() {}, e.prototype.resize = function() {
                this.innerHeight = window.innerHeight
            }, e.prototype.scrollTop = function(e) {
                if (void 0 === e) return o("scrollTop", this.el);
                a("scrollTop", e, this.el)
            }, e.prototype.contHeight = function() {
                return o("scrollHeight")
            }, e.prototype.smoothScroll = function(e) {
                scrollToY(e + this.scrollTop(), 300)
            }, e.prototype.getContainer = function() {
                return this.el
            }, e.prototype.scrollBottom = function(e) {
                if (void 0 === e) return this.contHeight() - this.scrollTop() - this.getScrollHeight();
                var t = this.contHeight() - e - this.getScrollHeight();
                this.scrollTop(t)
            }, e.prototype.scrollBottomFixSave = function(e) {
                var t = this,
                    n = Date.now();
                window.addEventListener("scroll", function r() {
                    Date.now() - n < 500 && t.scrollBottom(e), window.removeEventListener("scroll", r)
                }), this.scrollBottom(e)
            }, e.prototype.onScroll = function(e) {
                var t = this.scrollTop(),
                    n = t - this.prevScroll,
                    r = this.contHeight();
                this.opts.onScroll && this.opts.onScroll(-n, this), this.opts.scrollChange && this.opts.scrollChange(t), this.opts.more && r - t < 2 * this.innerHeight && this.opts.more(this), this.prevScroll = t
            }, e.prototype.getScrollHeight = function() {
                return this.innerHeight
            }, e.prototype.destroy = function() {
                Object(r.destroyModule)(this.module)
            }, e
        }(),
        c = function() {
            function e(t, n) {
                var r = this;
                i(this, e), this.prevTop = 0, this.scroll = new uiScroll(t, {
                    hidden: !0,
                    shadows: n.shadows,
                    stopScrollPropagation: !1,
                    theme: n.scrollTheme,
                    onmore: function() {
                        return n.more && n.more(r)
                    },
                    onscroll: function(e) {
                        var t = r.scrollTop(),
                            i = r.prevTop - t;
                        r.prevTop = t, n.scrollChange && n.scrollChange(t), n.onScroll && n.onScroll(i, r)
                    }
                })
            }
            return e.prototype.update = function() {
                this.scroll.update("sync")
            }, e.prototype.scrollTop = function(e) {
                return void 0 !== e ? this.scroll.scrollTop(e) : this.scroll.data.scrollTop
            }, e.prototype.getContainer = function() {
                return this.scroll.content
            }, e.prototype.contHeight = function() {
                return this.scroll.data.scrollHeight
            }, e.prototype.smoothScroll = function(e) {
                this.scroll.scrollTop(this.scrollTop() + e, 300)
            }, e.prototype.scrollBottom = function(e) {
                return void 0 !== e ? this.scroll.scrollBottom(e) : this.scroll.data.scrollBottom
            }, e.prototype.scrollBottomFixSave = function(e) {
                var t = this,
                    n = Date.now();
                this.scroll.emitter.addOnceListener("resize", function() {
                    Date.now() - n < 500 && t.scroll && t.scrollBottom(e)
                }), this.scrollBottom(e)
            }, e.prototype.getScrollHeight = function() {
                return this.scroll.data.viewportHeight
            }, e.prototype.destroy = function() {
                this.scroll.destroy()
            }, e
        }(),
        u = function() {
            function e(t, n) {
                i(this, e), this.el = t
            }
            return e.prototype.update = function() {}, e.prototype.getContainer = function() {
                return this.el
            }, e.prototype.scrollTop = function(e) {
                return 0
            }, e.prototype.contHeight = function() {
                return 0
            }, e.prototype.smoothScroll = function(e) {}, e.prototype.scrollBottom = function(e) {
                return 0
            }, e.prototype.scrollBottomFixSave = function(e) {}, e.prototype.getScrollHeight = function() {
                return 0
            }, e.prototype.destroy = function() {}, e
        }();

    function l(e, t) {
        return t.noScroll ? new u(e) : t.nativeScroll ? new s(e, t) : new c(e, t)
    }
}, function(e, t, n) {
    "use strict";
    var r = n(45);
    e.exports = function e(t, n) {
        return !(!t || !n) && (t === n || !r(t) && (r(n) ? e(t, n.parentNode) : "contains" in t ? t.contains(n) : !!t.compareDocumentPosition && !!(16 & t.compareDocumentPosition(n))))
    }
}, function(e, t, n) {
    "use strict";
    var r = n(91),
        i = n(20),
        o = n(61),
        a = n(104),
        s = n(15),
        c = n(25),
        u = n(93),
        l = n(35),
        d = n(145),
        f = n(47),
        p = n(41),
        m = n(177);
    e.exports = function(e, t, n, g, h, _) {
        var v = r[e],
            b = v,
            y = h ? "set" : "add",
            w = b && b.prototype,
            O = {},
            C = function(e) {
                var t = w[e];
                o(w, e, "delete" == e ? function(e) {
                    return !(_ && !l(e)) && t.call(this, 0 === e ? 0 : e)
                } : "has" == e ? function(e) {
                    return !(_ && !l(e)) && t.call(this, 0 === e ? 0 : e)
                } : "get" == e ? function(e) {
                    return _ && !l(e) ? void 0 : t.call(this, 0 === e ? 0 : e)
                } : "add" == e ? function(e) {
                    return t.call(this, 0 === e ? 0 : e), this
                } : function(e, n) {
                    return t.call(this, 0 === e ? 0 : e, n), this
                })
            };
        if ("function" == typeof b && (_ || w.forEach && !d(function() {
                (new b).entries().next()
            }))) {
            var k = new b,
                E = k[y](_ ? {} : -0, 1) != k,
                j = d(function() {
                    k.has(1)
                }),
                S = f(function(e) {
                    new b(e)
                }),
                T = !_ && d(function() {
                    for (var e = new b, t = 5; t--;) e[y](t, t);
                    return !e.has(-0)
                });
            S || ((b = t(function(t, n) {
                u(t, b, e);
                var r = m(new v, t, b);
                return void 0 != n && c(n, h, r[y], r), r
            })).prototype = w, w.constructor = b), (j || T) && (C("delete"), C("has"), h && C("get")), (T || E) && C(y), _ && w.clear && delete w.clear
        } else b = g.getConstructor(t, e, h, y), a(b.prototype, n), s.NEED = !0;
        return p(b, e), O[e] = b, i(i.G + i.W + i.F * (b != v), O), _ || g.setStrong(b, e, h), b
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createWorker", function() {
        return f
    });
    var r = n(3),
        i = n(30),
        o = new r,
        a = !1;

    function s(e) {
        return e.queue || e.key
    }

    function c() {
        o.forEach(function(e, t) {
            var n, r = e.onData,
                i = e.onUpdateKey,
                o = e.ts;
            n = t, window.curNotifier && !curNotifier.addQueues[s(n)] && Notifier.addKey(extend(t, {
                ts: o
            }), d.bind(null, r, i, t))
        })
    }

    function u() {
        a || (a = setInterval(c, 3e3))
    }

    function l(e) {
        ! function(e) {
            if (!window.curNotifier) return !1;
            delete curNotifier.addQueues[s(e)]
        }(e), o.delete(e), 0 === o.size && (clearInterval(a), a = !1)
    }

    function d(e, t, n, r, a) {
        if (a.failed) return l(n), void
        function(e, t, n, r) {
            var a = void 0;
            switch (e) {
                case 1:
                case 2:
                case 3:
                case 5:
                    a = r(t, e);
                    break;
                case 4:
                    a = Object(i.pause)(1).then(function() {
                        return t
                    });
                    break;
                default:
                    throw new Error("Unkonwn error from queue: " + e)
            }
            Object(i.pause)(3).then(function() {
                return a
            }).then(function(e) {
                o.set(e, {
                    onUpdateKey: r,
                    onData: n,
                    ts: e.ts
                }), c(), u()
            })
        }(a.err, n, e, t);
        o.set(n, {
            onData: e,
            onUpdateKey: t,
            ts: intval(a.ts)
        }), a.events.map(function(e) {
            return e.split("<!>")
        }).forEach(e)
    }

    function f(e, t, n) {
        return Notifier.addKey(e, d.bind(null, t, n, e)), o.set(e, {
            onData: t,
            onUpdateKey: n,
            ts: e.ts
        }), u(), {
            stop: l.bind(null, e)
        }
    }
}, , function(e, t, n) {
    var r = n(155),
        i = n(116),
        o = n(5)("IE_PROTO"),
        a = Object.prototype;
    e.exports = Object.getPrototypeOf || function(e) {
        return e = i(e), r(e, o) ? e[o] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? a : null
    }
}, function(e, t, n) {
    "use strict";
    e.exports = function(e) {
        if (void 0 === (e = e || ("undefined" != typeof document ? document : void 0))) return null;
        try {
            return e.activeElement || e.body
        } catch (t) {
            return e.body
        }
    }
}, function(e, t, n) {
    "use strict";
    e.exports = "SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188),
        i = n(109),
        o = n(77),
        a = n(33),
        s = n(6),
        c = n(144),
        u = n(54);
    var l = window.elfocus,
        d = i.default.getLang,
        f = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onCopy = function() {
                    r.input && (l(r.input, 0, r.input.value.length), document.execCommand("copy"), r.setState({
                        copied: !0
                    }))
                }, r.onBlinkTextHide = function() {
                    r.setState({
                        copied: !1
                    })
                }, r.getInputRef = function(e) {
                    e && e.element && (r.input = e.element)
                }, r.state = {
                    copied: !1
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                this.input && l(this.input, 0, this.input.value.length)
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.onReset,
                    n = e.invitationLink,
                    i = e.store,
                    l = d("mail_invite_link_reset_explainer").split("{reset_link}"),
                    f = !Object(u.isFvkcomgroup)(i, i.get().peer);
                return r.createElement("div", {
                    className: "ChatSettingsInvitationLink"
                }, this.props.reseted && r.createElement("div", {
                    className: "ChatSettingsInvitationLink__reseted"
                }, d("mail_invite_link_reseted_explainer")), r.createElement("p", null, d("mail_invite_link_explainer")), r.createElement("div", {
                    className: "ChatSettingsInvitationLink__main"
                }, r.createElement(o.default, {
                    ref: this.getInputRef,
                    readOnly: "readonly",
                    className: "ChatSettingsInvitationLink__input",
                    value: n
                }), r.createElement(a.default, {
                    onClick: this.onCopy
                }, d("mail_get_invite_link_copy")), r.createElement(s.default, {
                    className: "ChatSettingsInvitationLink__copied",
                    shown: this.state.copied,
                    callback: this.onBlinkTextHide
                }, d("mail_invite_link_copied"))), f && r.createElement("p", null, l[0], r.createElement(c.default, {
                    className: "ChatSettingsInvitationLink__reset",
                    onClick: t
                }, d("mail_invite_reset_link")), l[1]))
            }, t
        }(r.Component);
    t.default = f
}, function(e, t, n) {
    var r = n(149),
        i = n(180);
    e.exports = function(e) {
        return function(t, n) {
            var o, a, s = String(i(t)),
                c = r(n),
                u = s.length;
            return c < 0 || c >= u ? e ? "" : void 0 : (o = s.charCodeAt(c)) < 55296 || o > 56319 || c + 1 === u || (a = s.charCodeAt(c + 1)) < 56320 || a > 57343 ? e ? s.charAt(c) : o : e ? s.slice(c, c + 2) : a - 56320 + (o - 55296 << 10) + 65536
        }
    }
}, function(e, t, n) {
    var r = n(35);
    e.exports = function(e, t) {
        if (!r(e)) return e;
        var n, i;
        if (t && "function" == typeof(n = e.toString) && !r(i = n.call(e))) return i;
        if ("function" == typeof(n = e.valueOf) && !r(i = n.call(e))) return i;
        if (!t && "function" == typeof(n = e.toString) && !r(i = n.call(e))) return i;
        throw TypeError("Can't convert object to primitive value")
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(188);
    n(195);
    var i = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.id = Math.round(1e6 * Math.random()).toString(16), r.setSpinnerParams(n), r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentWillReceiveProps = function(e) {
            this.setSpinnerParams(e)
        }, t.prototype.setSpinnerParams = function(e) {
            this.offset = Math.round(Math.PI * e.size), this.c = .5 * e.size, this.animation = function(e, t) {
                if (!e || !t) return "";
                var n = Object.keys(t).map(function(e) {
                    return e + " {" + Object.keys(t[e]).map(function(n) {
                        return n + ":" + t[e][n]
                    }).join(";") + "}"
                }).join("");
                return "@-webkit-keyframes " + e + " {" + n + "} @keyframes " + e + " {" + n + "}"
            }("dash" + this.id, {
                "0%": {
                    "stroke-dashoffset": this.offset
                },
                "50%": {
                    "stroke-dashoffset": Math.round(.25 * this.offset),
                    transform: "rotate(135deg)"
                },
                "100%": {
                    "stroke-dashoffset": this.offset,
                    transform: "rotate(360deg)"
                }
            })
        }, t.prototype.render = function() {
            var e = this.props,
                t = e.style,
                n = e.color,
                i = e.size,
                o = e.duration,
                a = e.strokeWidth,
                s = this.id,
                c = this.offset,
                u = this.animation;
            return r.createElement("div", {
                className: "Spinner",
                style: t
            }, r.createElement("svg", {
                className: "Spinner__svg",
                width: i,
                height: i,
                viewBox: "0 0 " + i + " " + i,
                xmlns: "http://www.w3.org/2000/svg"
            }, r.createElement("g", {
                style: {
                    width: i,
                    height: i,
                    transformOrigin: .5 * i + "px " + .5 * i + "px"
                }
            }, r.createElement("style", {
                dangerouslySetInnerHTML: {
                    __html: u
                }
            }), r.createElement("circle", {
                className: "Spinner__path",
                fill: "none",
                stroke: n,
                strokeDasharray: c,
                strokeDashoffset: c,
                strokeWidth: a,
                style: {
                    animationName: "dash" + s,
                    animationTimingFunction: "ease-in-out",
                    animationDuration: o + "s",
                    animationIterationCount: "infinite"
                },
                cx: .5 * i,
                cy: .5 * i,
                r: .5 * i - .5 * a
            }))))
        }, t
    }(r.Component);
    t.default = i, i.defaultProps = {
        color: "#5181b8",
        size: 19,
        strokeWidth: 2,
        duration: 1.4
    }
}]);