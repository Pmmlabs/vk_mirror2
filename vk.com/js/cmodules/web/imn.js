! function(e) {
    function t(t) {
        for (var r, a, s = t[0], c = t[1], u = t[2], d = 0, _ = []; d < s.length; d++) a = s[d], i[a] && _.push(i[a][0]), i[a] = 0;
        for (r in c) Object.prototype.hasOwnProperty.call(c, r) && (e[r] = c[r]);
        for (l && l(t); _.length;) _.shift()();
        return o.push.apply(o, u || []), n()
    }

    function n() {
        for (var e, t = 0; t < o.length; t++) {
            for (var n = o[t], r = !0, s = 1; s < n.length; s++) {
                var c = n[s];
                0 !== i[c] && (r = !1)
            }
            r && (o.splice(t--, 1), e = a(a.s = n[0]))
        }
        return e
    }
    var r = {},
        i = {
            "web/imn": 0
        },
        o = [];

    function a(t) {
        if (r[t]) return r[t].exports;
        var n = r[t] = {
            i: t,
            l: !1,
            exports: {}
        };
        return e[t].call(n.exports, n, n.exports, a), n.l = !0, n.exports
    }
    a.m = e, a.c = r, a.d = function(e, t, n) {
        a.o(e, t) || Object.defineProperty(e, t, {
            enumerable: !0,
            get: n
        })
    }, a.r = function(e) {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
            value: "Module"
        }), Object.defineProperty(e, "__esModule", {
            value: !0
        })
    }, a.t = function(e, t) {
        if (1 & t && (e = a(e)), 8 & t) return e;
        if (4 & t && "object" == typeof e && e && e.__esModule) return e;
        var n = Object.create(null);
        if (a.r(n), Object.defineProperty(n, "default", {
                enumerable: !0,
                value: e
            }), 2 & t && "string" != typeof e)
            for (var r in e) a.d(n, r, function(t) {
                return e[t]
            }.bind(null, r));
        return n
    }, a.n = function(e) {
        var t = e && e.__esModule ? function() {
            return e.default
        } : function() {
            return e
        };
        return a.d(t, "a", t), t
    }, a.o = function(e, t) {
        return Object.prototype.hasOwnProperty.call(e, t)
    }, a.p = "";
    var s = window.webpackJsonp = window.webpackJsonp || [],
        c = s.push.bind(s);
    s.push = t, s = s.slice();
    for (var u = 0; u < s.length; u++) t(s[u]);
    var l = c;
    o.push([88, "7f81047508570d6456c7d33e2e3c0bc3", "9305f5418f2d9183dad188e98aaf94c7", "b459a6fdd4abe926f4e4ca100471ca63"]), n()
}({
    "+/AQ": function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return o
        }), n.d(t, "a", function() {
            return u
        });
        var r = n("N1NS");

        function i(e, t) {
            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }

        function o(e, t) {
            return bodyNode[e] || document.documentElement[e]
        }
        var a = function() {
                function e(t, n) {
                    var o = this;
                    i(this, e), this.el = t, this.opts = n, this.module = Object(r.a)({
                        handlers: function(e, t) {
                            e(window, "scroll", o.onScroll.bind(o)), e(window, "resize", o.resize.bind(o))
                        }
                    }), this.innerHeight = window.innerHeight, this.prevScroll = this.scrollTop()
                }
                return e.prototype.update = function() {}, e.prototype.resize = function() {
                    this.innerHeight = window.innerHeight
                }, e.prototype.scrollTop = function(e) {
                    if (void 0 === e) return o("scrollTop", this.el);
                    ! function(e, t, n) {
                        "scrollTop" === e && window.scrollTo(0, t)
                    }("scrollTop", e, this.el)
                }, e.prototype.contHeight = function() {
                    return o("scrollHeight")
                }, e.prototype.smoothScroll = function(e) {
                    scrollToY(e + this.scrollTop(), 300)
                }, e.prototype.getContainer = function() {
                    return this.el
                }, e.prototype.scrollBottom = function(e) {
                    if (void 0 === e) return this.contHeight() - this.scrollTop() - this.getScrollHeight();
                    var t = this.contHeight() - e - this.getScrollHeight();
                    this.scrollTop(t)
                }, e.prototype.scrollBottomFixSave = function(e) {
                    var t = this,
                        n = Date.now();
                    window.addEventListener("scroll", function r() {
                        Date.now() - n < 500 && t.scrollBottom(e), window.removeEventListener("scroll", r)
                    }), this.scrollBottom(e)
                }, e.prototype.onScroll = function(e) {
                    var t = this.scrollTop(),
                        n = t - this.prevScroll,
                        r = this.contHeight();
                    this.opts.onScroll && this.opts.onScroll(-n, this), this.opts.scrollChange && this.opts.scrollChange(t), this.opts.more && r - t < 2 * this.innerHeight && this.opts.more(this), this.prevScroll = t
                }, e.prototype.getScrollHeight = function() {
                    return this.innerHeight
                }, e.prototype.destroy = function() {
                    Object(r.c)(this.module)
                }, e
            }(),
            s = function() {
                function e(t, n) {
                    var r = this;
                    i(this, e), this.prevTop = 0, this.scroll = new uiScroll(t, {
                        hidden: void 0 === n.hidden || n.hidden,
                        shadows: n.shadows,
                        stopScrollPropagation: !1,
                        theme: n.scrollTheme,
                        onmore: function() {
                            return n.more && n.more(r)
                        },
                        onscroll: function(e) {
                            var t = r.scrollTop(),
                                i = r.prevTop - t;
                            r.prevTop = t, n.scrollChange && n.scrollChange(t), n.onScroll && n.onScroll(i, r)
                        }
                    })
                }
                return e.prototype.update = function() {
                    this.scroll.update("sync")
                }, e.prototype.scrollTop = function(e) {
                    return void 0 !== e ? this.scroll.scrollTop(e) : this.scroll.data.scrollTop
                }, e.prototype.getContainer = function() {
                    return this.scroll.content
                }, e.prototype.contHeight = function() {
                    return this.scroll.data.scrollHeight
                }, e.prototype.smoothScroll = function(e) {
                    this.scroll.scrollTop(this.scrollTop() + e, 300)
                }, e.prototype.scrollBottom = function(e) {
                    return void 0 !== e ? this.scroll.scrollBottom(e) : this.scroll.data.scrollBottom
                }, e.prototype.scrollBottomFixSave = function(e) {
                    var t = this,
                        n = Date.now();
                    this.scroll.emitter.addOnceListener("resize", function() {
                        Date.now() - n < 500 && t.scroll && t.scrollBottom(e)
                    }), this.scrollBottom(e)
                }, e.prototype.getScrollHeight = function() {
                    return this.scroll.data.viewportHeight
                }, e.prototype.destroy = function() {
                    this.scroll.destroy()
                }, e
            }(),
            c = function() {
                function e(t, n) {
                    i(this, e), this.el = t
                }
                return e.prototype.update = function() {}, e.prototype.getContainer = function() {
                    return this.el
                }, e.prototype.scrollTop = function(e) {
                    return 0
                }, e.prototype.contHeight = function() {
                    return 0
                }, e.prototype.smoothScroll = function(e) {}, e.prototype.scrollBottom = function(e) {
                    return 0
                }, e.prototype.scrollBottomFixSave = function(e) {}, e.prototype.getScrollHeight = function() {
                    return 0
                }, e.prototype.destroy = function() {}, e
            }();

        function u(e, t) {
            return t.noScroll ? new c(e) : t.nativeScroll ? new a(e, t) : new s(e, t)
        }
    },
    "+rLv": function(e, t, n) {
        e.exports = n("dyZX").document && document.documentElement
    },
    "0/R4": function(e, t) {
        e.exports = function(e) {
            return "object" == typeof e ? null !== e : "function" == typeof e
        }
    },
    "1+Fu": function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return _
        });
        var r = n("qKs0"),
            i = n("DM26"),
            o = new r,
            a = !1;

        function s(e) {
            return e.queue || e.key
        }

        function c() {
            o.forEach(function(e, t) {
                var n, r = e.onData,
                    i = e.onUpdateKey,
                    o = e.ts;
                n = t, window.curNotifier && !curNotifier.addQueues[s(n)] && Notifier.addKey(extend(t, {
                    ts: o
                }), d.bind(null, r, i, t))
            })
        }

        function u() {
            a || (a = setInterval(c, 3e3))
        }

        function l(e) {
            ! function(e) {
                if (!window.curNotifier) return !1;
                delete curNotifier.addQueues[s(e)]
            }(e), o.delete(e), 0 === o.size && (clearInterval(a), a = !1)
        }

        function d(e, t, n, r, a) {
            if (a.failed) return l(n), void
            function(e, t, n, r) {
                var a = void 0;
                switch (e) {
                    case 1:
                    case 2:
                    case 3:
                    case 5:
                        a = r(t, e);
                        break;
                    case 4:
                        a = Object(i.c)(1).then(function() {
                            return t
                        });
                        break;
                    default:
                        throw new Error("Unkonwn error from queue: " + e)
                }
                Object(i.c)(3).then(function() {
                    return a
                }).then(function(e) {
                    o.set(e, {
                        onUpdateKey: r,
                        onData: n,
                        ts: e.ts
                    }), c(), u()
                })
            }(a.err, n, e, t);
            o.set(n, {
                onData: e,
                onUpdateKey: t,
                ts: intval(a.ts)
            }), a.events.map(function(e) {
                return e.split("<!>")
            }).forEach(e)
        }

        function _(e, t, n) {
            return Notifier.addKey(e, d.bind(null, t, n, e)), o.set(e, {
                onData: t,
                onUpdateKey: n,
                ts: e.ts
            }), u(), {
                stop: l.bind(null, e)
            }
        }
    },
    "16Al": function(e, t, n) {
        "use strict";
        var r = n("ohE5"),
            i = n("2NuI"),
            o = n("WbBG");
        e.exports = function() {
            function e(e, t, n, r, a, s) {
                s !== o && i(!1, "Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")
            }

            function t() {
                return e
            }
            e.isRequired = e;
            var n = {
                array: e,
                bool: e,
                func: e,
                number: e,
                object: e,
                string: e,
                symbol: e,
                any: e,
                arrayOf: t,
                element: e,
                instanceOf: t,
                node: e,
                objectOf: t,
                oneOf: t,
                oneOfType: t,
                shape: t,
                exact: t
            };
            return n.checkPropTypes = r, n.PropTypes = n, n
        }
    },
    "17x9": function(e, t, n) {
        e.exports = n("16Al")()
    },
    "1TsA": function(e, t) {
        e.exports = function(e, t) {
            return {
                value: t,
                done: !!e
            }
        }
    },
    "1y80": function(e, t, n) {
        "use strict";

        function r(e, t, n, r, i) {
            return window.statlogsValueEvent(e, t, n, r, i)
        }

        function i(e) {
            return Math.random() < e
        }

        function o(e, t, n, o, a, s) {
            i(e) && r(t, n, o, a, s)
        }
        n.d(t, "c", function() {
            return r
        }), n.d(t, "a", function() {
            return i
        }), n.d(t, "b", function() {
            return o
        })
    },
    "2OiF": function(e, t) {
        e.exports = function(e) {
            if ("function" != typeof e) throw TypeError(e + " is not a function!");
            return e
        }
    },
    "3Lyj": function(e, t, n) {
        var r = n("KroJ");
        e.exports = function(e, t, n) {
            for (var i in t) r(e, i, t[i], n);
            return e
        }
    },
    "4LiD": function(e, t, n) {
        "use strict";
        var r = n("dyZX"),
            i = n("XKFU"),
            o = n("KroJ"),
            a = n("3Lyj"),
            s = n("Z6vF"),
            c = n("SlkY"),
            u = n("9gX7"),
            l = n("0/R4"),
            d = n("eeVq"),
            _ = n("XMVh"),
            f = n("fyDq"),
            p = n("Xbzi");
        e.exports = function(e, t, n, m, g, h) {
            var b = r[e],
                v = b,
                y = g ? "set" : "add",
                O = v && v.prototype,
                j = {},
                w = function(e) {
                    var t = O[e];
                    o(O, e, "delete" == e ? function(e) {
                        return !(h && !l(e)) && t.call(this, 0 === e ? 0 : e)
                    } : "has" == e ? function(e) {
                        return !(h && !l(e)) && t.call(this, 0 === e ? 0 : e)
                    } : "get" == e ? function(e) {
                        return h && !l(e) ? void 0 : t.call(this, 0 === e ? 0 : e)
                    } : "add" == e ? function(e) {
                        return t.call(this, 0 === e ? 0 : e), this
                    } : function(e, n) {
                        return t.call(this, 0 === e ? 0 : e, n), this
                    })
                };
            if ("function" == typeof v && (h || O.forEach && !d(function() {
                    (new v).entries().next()
                }))) {
                var E = new v,
                    k = E[y](h ? {} : -0, 1) != E,
                    C = d(function() {
                        E.has(1)
                    }),
                    x = _(function(e) {
                        new v(e)
                    }),
                    P = !h && d(function() {
                        for (var e = new v, t = 5; t--;) e[y](t, t);
                        return !e.has(-0)
                    });
                x || ((v = t(function(t, n) {
                    u(t, v, e);
                    var r = p(new b, t, v);
                    return void 0 != n && c(n, g, r[y], r), r
                })).prototype = O, O.constructor = v), (C || P) && (w("delete"), w("has"), g && w("get")), (P || k) && w(y), h && O.clear && delete O.clear
            } else v = m.getConstructor(t, e, g, y), a(v.prototype, n), s.NEED = !0;
            return f(v, e), j[e] = v, i(i.G + i.W + i.F * (v != b), j), h || m.setStrong(v, e, g), v
        }
    },
    "4R4u": function(e, t) {
        e.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")
    },
    "6aSF": function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("+/AQ")),
            o = n("pemR"),
            a = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };

        function s(e, t) {
            if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return !t || "object" != typeof t && "function" != typeof t ? e : t
        }
        var c = function(e) {
            function t() {
                var n, r;
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                for (var i = arguments.length, o = Array(i), a = 0; a < i; a++) o[a] = arguments[a];
                return n = r = s(this, e.call.apply(e, [this].concat(o))), r.getWrapperRef = function(e) {
                    r.wrapper = e
                }, s(r, n)
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                var e = this.props,
                    t = e.isNative,
                    n = e.isShadows,
                    r = e.neverHide;
                this.scroller || (this.scroller = Object(i.a)(this.wrapper, {
                    shadows: n,
                    nativeScroll: t,
                    hidden: !r
                }))
            }, t.prototype.componentDidUpdate = function() {
                this.scroller.update()
            }, t.prototype.componentWillUnmount = function() {
                this.scroller.destroy(), this.scroller = null
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.children,
                    n = (e.isNative, e.isShadows, e.neverHide, e.className),
                    i = void 0 === n ? "" : n,
                    s = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["children", "isNative", "isShadows", "neverHide", "className"]);
                return r.createElement("div", a({}, s, {
                    className: Object(o.a)("Scroll", i),
                    ref: this.getWrapperRef
                }), t)
            }, t
        }(r.Component);
        t.a = c, c.defaultProps = {
            isNative: !1,
            isShadows: !1,
            neverHide: !1
        }
    },
    "6raB": function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR")),
            o = n("KFTi"),
            a = n("Hx9h"),
            s = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };
        var c = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.needRecalcSize = !1, r.state = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.className,
                    n = e.loading,
                    c = e.children,
                    u = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["className", "loading", "children"]),
                    l = Object(i.a)("ButtonWithProgress", {
                        "ButtonWithProgress--loading": n
                    }, t);
                return r.createElement(a.a, s({}, u, {
                    className: l
                }), r.createElement("span", {
                    className: "ButtonWithProgress__content"
                }, c), n && r.createElement(o.a, {
                    inverted: "primary" === e.appearance,
                    className: "ButtonWithProgress__progress"
                }))
            }, t
        }(r.Component);
        t.a = c, c.defaultProps = {
            appearance: "primary",
            size: "m",
            wide: !1,
            loading: !1
        }
    },
    "7p7+": function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return a
        });
        var r = n("q1tI"),
            i = n("pemR"),
            o = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };

        function a(e) {
            var t = e.children,
                n = e.className,
                a = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["children", "className"]);
            return r.createElement("div", o({}, a, {
                className: Object(i.a)("Stub", n)
            }), t || "No results.")
        }
    },
    "86+7": function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return i
        }), n.d(t, "c", function() {
            return o
        }), n.d(t, "a", function() {
            return a
        });
        var r = n("aong");

        function i(e, t) {
            return t in Object(r.r)(e).oCache
        }

        function o(e, t) {
            var n = Object(r.r)(e).oCache[t];
            return n && !n._n && (! function(e) {
                if (!e.first_name) {
                    var t = e.name.split(" ", 2);
                    e.first_name = t[0], e.short_name = t[1] ? t[0] + " " + t[1].substr(0, 1) + "." : t[0]
                }
                e.inv_name || (e.inv_name = e.name), e.kick_name || (e.kick_name = e.inv_name)
            }(n), n._n = 1), n
        }

        function a(e, t) {
            var n = Object(r.r)(e);
            n.oCache || (n.oCache = {}), t.id && (n.oCache[t.id] = t)
        }
    },
    88: function(e, t, n) {
        e.exports = n("M24l")
    },
    "8h6g": function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return r
        }), n.d(t, "c", function() {
            return i
        }), n.d(t, "a", function() {
            return o
        });
        var r = "avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf".split(" "),
            i = 5,
            o = 4194304
    },
    "8oxB": function(e, t) {
        var n, r, i = e.exports = {};

        function o() {
            throw new Error("setTimeout has not been defined")
        }

        function a() {
            throw new Error("clearTimeout has not been defined")
        }

        function s(e) {
            if (n === setTimeout) return setTimeout(e, 0);
            if ((n === o || !n) && setTimeout) return n = setTimeout, setTimeout(e, 0);
            try {
                return n(e, 0)
            } catch (t) {
                try {
                    return n.call(null, e, 0)
                } catch (t) {
                    return n.call(this, e, 0)
                }
            }
        }! function() {
            try {
                n = "function" == typeof setTimeout ? setTimeout : o
            } catch (e) {
                n = o
            }
            try {
                r = "function" == typeof clearTimeout ? clearTimeout : a
            } catch (e) {
                r = a
            }
        }();
        var c, u = [],
            l = !1,
            d = -1;

        function _() {
            l && c && (l = !1, c.length ? u = c.concat(u) : d = -1, u.length && f())
        }

        function f() {
            if (!l) {
                var e = s(_);
                l = !0;
                for (var t = u.length; t;) {
                    for (c = u, u = []; ++d < t;) c && c[d].run();
                    d = -1, t = u.length
                }
                c = null, l = !1,
                    function(e) {
                        if (r === clearTimeout) return clearTimeout(e);
                        if ((r === a || !r) && clearTimeout) return r = clearTimeout, clearTimeout(e);
                        try {
                            r(e)
                        } catch (t) {
                            try {
                                return r.call(null, e)
                            } catch (t) {
                                return r.call(this, e)
                            }
                        }
                    }(e)
            }
        }

        function p(e, t) {
            this.fun = e, this.array = t
        }

        function m() {}
        i.nextTick = function(e) {
            var t = new Array(arguments.length - 1);
            if (arguments.length > 1)
                for (var n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
            u.push(new p(e, t)), 1 !== u.length || l || s(f)
        }, p.prototype.run = function() {
            this.fun.apply(null, this.array)
        }, i.title = "browser", i.browser = !0, i.env = {}, i.argv = [], i.version = "", i.versions = {}, i.on = m, i.addListener = m, i.once = m, i.off = m, i.removeListener = m, i.removeAllListeners = m, i.emit = m, i.prependListener = m, i.prependOnceListener = m, i.listeners = function(e) {
            return []
        }, i.binding = function(e) {
            throw new Error("process.binding is not supported")
        }, i.cwd = function() {
            return "/"
        }, i.chdir = function(e) {
            throw new Error("process.chdir is not supported")
        }, i.umask = function() {
            return 0
        }
    },
    "9AAn": function(e, t, n) {
        "use strict";
        var r = n("wmvG");
        e.exports = n("4LiD")("Map", function(e) {
            return function() {
                return e(this, arguments.length > 0 ? arguments[0] : void 0)
            }
        }, {
            get: function(e) {
                var t = r.getEntry(this, e);
                return t && t.v
            },
            set: function(e, t) {
                return r.def(this, 0 === e ? 0 : e, t)
            }
        }, r, !0)
    },
    "9gX7": function(e, t) {
        e.exports = function(e, t, n, r) {
            if (!(e instanceof t) || void 0 !== r && r in e) throw TypeError(n + ": incorrect invocation!");
            return e
        }
    },
    Afnz: function(e, t, n) {
        "use strict";
        var r = n("LQAc"),
            i = n("XKFU"),
            o = n("KroJ"),
            a = n("Mukb"),
            s = n("aagx"),
            c = n("hPIQ"),
            u = n("QaDb"),
            l = n("fyDq"),
            d = n("OP3Y"),
            _ = n("K0xU")("iterator"),
            f = !([].keys && "next" in [].keys()),
            p = function() {
                return this
            };
        e.exports = function(e, t, n, m, g, h, b) {
            u(n, t, m);
            var v, y, O, j = function(e) {
                    if (!f && e in C) return C[e];
                    switch (e) {
                        case "keys":
                        case "values":
                            return function() {
                                return new n(this, e)
                            }
                    }
                    return function() {
                        return new n(this, e)
                    }
                },
                w = t + " Iterator",
                E = "values" == g,
                k = !1,
                C = e.prototype,
                x = C[_] || C["@@iterator"] || g && C[g],
                P = x || j(g),
                M = g ? E ? j("entries") : P : void 0,
                T = "Array" == t && C.entries || x;
            if (T && (O = d(T.call(new e))) !== Object.prototype && (l(O, w, !0), r || s(O, _) || a(O, _, p)), E && x && "values" !== x.name && (k = !0, P = function() {
                    return x.call(this)
                }), r && !b || !f && !k && C[_] || a(C, _, P), c[t] = P, c[w] = p, g)
                if (v = {
                        values: E ? P : j("values"),
                        keys: h ? P : j("keys"),
                        entries: M
                    }, b)
                    for (y in v) y in C || o(C, y, v[y]);
                else i(i.P + i.F * (f || k), t, v);
            return v
        }
    },
    As6E: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = n("i8i4"),
            o = (n("17x9"), n("pemR")),
            a = n("clTp");
        var s = 80,
            c = 250,
            u = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.onClick = function() {
                        if (!r.state.dropdown || r.state.dropdown.removed) {
                            var e = r.props,
                                t = e.text,
                                n = e.position,
                                i = e.align,
                                o = e.marginTop,
                                s = e.marginLeft,
                                c = Object(a.a)(r.el);
                            r.update({
                                text: t,
                                position: n,
                                align: i,
                                rect: c,
                                marginTop: o,
                                marginLeft: s
                            })
                        } else r.update()
                    }, r.onMouseEnter = function(e) {
                        r.callerHovered = !0, r.timeouts.appear = setTimeout(function() {
                            if (r.el && r.callerHovered) {
                                var e = r.props,
                                    t = e.position,
                                    n = e.align,
                                    i = e.marginTop,
                                    o = e.marginLeft,
                                    s = Object(a.a)(r.el);
                                r.update({
                                    position: t,
                                    align: n,
                                    rect: s,
                                    marginTop: i,
                                    marginLeft: o
                                })
                            }
                        }, s)
                    }, r.onMouseLeave = function(e) {
                        r.callerHovered = !1, r.timeouts.callerDisappear = setTimeout(function() {
                            r.callerHovered || r.hovered || r.update()
                        }, c)
                    }, r.onDropdownMouseEnter = function() {
                        "hover" === r.props.trigger && (r.hovered = !0)
                    }, r.onDropdownMouseLeave = function(e) {
                        "hover" === r.props.trigger && (r.hovered = !1, r.timeouts.disappear = setTimeout(function() {
                            r.callerHovered || r.hovered || r.update()
                        }, c))
                    }, r.onDocumentClick = function(e) {
                        !r.state.dropdown || r.state.dropdown.removed || r.el.contains(e.target) || r.update()
                    }, r.onResize = function(e) {
                        if (r.state.dropdown && !r.state.dropdown.removed) {
                            var t = r.props,
                                n = t.text,
                                i = t.position,
                                o = t.align,
                                s = t.marginTop,
                                c = t.marginLeft,
                                u = Object(a.a)(r.el);
                            r.update({
                                text: n,
                                position: i,
                                align: o,
                                rect: u,
                                marginTop: s,
                                marginLeft: c
                            })
                        }
                    }, r.onTransitionEnd = function(e) {
                        "visibility" === e.propertyName && r.state.dropdown && r.state.dropdown.removed && r.setState({
                            dropdown: void 0
                        })
                    }, r.onItemClick = function(e, t) {
                        t.separator || (r.update(), t.onClick(e))
                    }, r.state = {}, r.timeouts = {}, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.componentDidMount = function() {
                    this.el = i.findDOMNode(this), "click" === this.props.trigger ? (this.el.addEventListener("click", this.onClick), document.addEventListener("mousedown", this.onDocumentClick), window.addEventListener("resize", this.onResize)) : (this.el.addEventListener("mouseenter", this.onMouseEnter), this.el.addEventListener("mouseleave", this.onMouseLeave))
                }, t.prototype.componentWillUnmount = function() {
                    var e = this;
                    Object.keys(this.timeouts).forEach(function(t) {
                        clearTimeout(e.timeouts[t])
                    }), "click" === this.props.trigger ? (this.el.removeEventListener("click", this.onClick), document.removeEventListener("mousedown", this.onDocumentClick), window.removeEventListener("resize", this.onResize)) : (this.el.removeEventListener("mouseenter", this.onMouseEnter), this.el.removeEventListener("mouseleave", this.onMouseLeave)), this.defaultNode && (this.defaultNode.parentNode.removeChild(this.defaultNode), delete this.defaultNode)
                }, t.prototype.update = function(e) {
                    if (!e) return this.setState({
                        dropdown: Object.assign({}, this.state.dropdown, {
                            removed: !0
                        })
                    });
                    var t = e.position,
                        n = e.align,
                        r = e.rect,
                        i = e.marginTop,
                        o = e.marginLeft,
                        a = r.left,
                        s = r.top;
                    switch (t) {
                        case "t":
                            a += .5 * r.width;
                            break;
                        case "r":
                            a += r.width, s += .5 * r.height;
                            break;
                        case "b":
                            a += .5 * r.width, s += r.height;
                            break;
                        case "l":
                            s += .5 * r.height
                    }
                    a = Math.round(a + o), s = Math.round(s + i), this.setState({
                        dropdown: {
                            position: t,
                            align: n,
                            x: a,
                            y: s
                        }
                    })
                }, t.prototype.renderDropdown = function() {
                    var e = this;
                    if (!this.state.dropdown) return null;
                    var t, n, i, a = this.state.dropdown,
                        s = a.x,
                        c = a.y,
                        u = a.position,
                        l = a.align,
                        d = a.removed,
                        _ = Object(o.a)("Dropdown", "Dropdown--" + u, (t = {
                            "Dropdown--removed": !!d
                        }, n = "Dropdown--align-" + l, i = "t" === u || "b" === u, n in t ? Object.defineProperty(t, n, {
                            value: i,
                            enumerable: !0,
                            configurable: !0,
                            writable: !0
                        }) : t[n] = i, t));
                    return r.createElement("div", {
                        className: _,
                        style: {
                            top: c,
                            left: s
                        },
                        onTransitionEnd: function(t) {
                            return e.onTransitionEnd(t)
                        },
                        onMouseEnter: this.onDropdownMouseEnter,
                        onMouseLeave: this.onDropdownMouseLeave
                    }, r.createElement("ul", {
                        className: "Dropdown__in"
                    }, this.props.data.map(function(t, n) {
                        return r.createElement("li", {
                            className: Object(o.a)("Dropdown__item", {
                                Dropdown__item_separator: t.separator
                            }),
                            onClick: function(n) {
                                return e.onItemClick(n, t)
                            },
                            key: t.id || n
                        }, t.text)
                    })))
                }, t.prototype.render = function() {
                    var e = this.renderDropdown();
                    return e ? (this.defaultNode || "undefined" == typeof window || (this.defaultNode = document.createElement("div"), document.body.appendChild(this.defaultNode)), r.createElement(r.Fragment, null, this.props.children, i.createPortal(e, this.defaultNode))) : this.props.children
                }, t
            }(r.Component);
        t.a = u, u.defaultProps = {
            position: "b",
            align: "center",
            marginTop: 0,
            marginLeft: 0,
            trigger: "click"
        }
    },
    AvRE: function(e, t, n) {
        var r = n("RYi7"),
            i = n("vhPU");
        e.exports = function(e) {
            return function(t, n) {
                var o, a, s = String(i(t)),
                    c = r(n),
                    u = s.length;
                return c < 0 || c >= u ? e ? "" : void 0 : (o = s.charCodeAt(c)) < 55296 || o > 56319 || c + 1 === u || (a = s.charCodeAt(c + 1)) < 56320 || a > 57343 ? e ? s.charAt(c) : o : e ? s.slice(c, c + 2) : a - 56320 + (o - 55296 << 10) + 65536
            }
        }
    },
    "BN/X": function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR")),
            o = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };
        var a = function(e) {
            function t() {
                return function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t),
                    function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.apply(this, arguments))
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.hovered,
                    n = e.className,
                    a = e.children,
                    s = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["hovered", "className", "children"]),
                    c = Object(i.a)("Link", {
                        "Link--hovered": !!t
                    }, n);
                return this.props.href ? r.createElement("a", o({}, s, {
                    className: c
                }), a) : r.createElement("span", o({}, s, {
                    className: c
                }), a)
            }, t
        }(r.Component);
        t.a = a, a.defaultProps = {
            href: void 0,
            hovered: !1
        }
    },
    Btvt: function(e, t, n) {
        "use strict";
        var r = n("I8a+"),
            i = {};
        i[n("K0xU")("toStringTag")] = "z", i + "" != "[object z]" && n("KroJ")(Object.prototype, "toString", function() {
            return "[object " + r(this) + "]"
        }, !0)
    },
    BxOC: function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return o
        }), n.d(t, "a", function() {
            return a
        });
        var r = window.ajax,
            i = 2;

        function o(e, t, n) {
            return t && (t.im_v = i), new Promise(function(i, o) {
                r.post(e, t, {
                    timeout: n,
                    onDone: function() {
                        i.apply(null, [
                            [].concat(Array.prototype.slice.call(arguments))
                        ])
                    },
                    onFail: function() {
                        return o.apply(null, arguments), !0
                    }
                })
            })
        }

        function a(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                i = void 0;
            return i = window.XDomainRequest ? new XDomainRequest : r._getreq(), {
                request: new Promise(function(r, o) {
                    var a = void 0,
                        s = Date.now(),
                        c = n.timeout || 60,
                        u = ajx2q(t);
                    if (window.XDomainRequest) i.open("get", e + "?" + u), i.ontimeout = function(e) {
                        o([e, {}])
                    }, i.onerror = function(e) {
                        o([e, {}])
                    }, i.onload = function() {
                        r([i.responseText, {}])
                    }, setTimeout(function() {
                        i.send()
                    }, 0);
                    else {
                        i.onreadystatechange = function() {
                            4 == i.readyState && (clearInterval(a), i.status >= 200 && i.status < 300 ? r([i.responseText, i]) : o([i.responseText, i]))
                        };
                        try {
                            i.open("GET", e + "?" + u, !0)
                        } catch (e) {
                            return o([e, i])
                        }
                        i.send()
                    }
                    a = setInterval(function() {
                        Date.now() - s > 1e3 * c && (o(["", {}]), clearInterval(a))
                    }, 1e3)
                }),
                cancel: function() {
                    i.abort()
                }
            }
        }
    },
    Cfrj: function(e, t, n) {
        var r = n("RYi7"),
            i = Math.max,
            o = Math.min;
        e.exports = function(e, t) {
            return (e = r(e)) < 0 ? i(e + t, 0) : o(e, t)
        }
    },
    DM26: function(e, t, n) {
        "use strict";

        function r(e, t) {
            return new Promise(function(n) {
                setTimeout(n.bind(null, t), 1e3 * e)
            })
        }

        function i(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null,
                i = 0;
            return function o() {
                for (var a = arguments.length, s = Array(a), c = 0; c < a; c++) s[c] = arguments[c];
                return Promise.resolve().then(function() {
                    return e.apply(void 0, s)
                }).catch(function(e) {
                    if (++i <= t) {
                        var a = "function" == typeof n ? n(i) : 0;
                        return 0 === a ? o.apply(void 0, s) : r(a).then(function() {
                            return o.apply(void 0, s)
                        })
                    }
                    throw e
                })
            }
        }

        function o(e, t, n) {
            var r = void 0,
                i = void 0;
            return function() {
                for (var o = arguments.length, a = Array(o), s = 0; s < o; s++) a[s] = arguments[s];
                return new Promise(function(e, o) {
                    var s = n && !r;
                    clearTimeout(r), i && i.reject("debounce"), r = setTimeout(function() {
                        r = null, i = null, n || e(a)
                    }, t), s ? e(a) : n && o("debounce"), i = {
                        resolve: e,
                        reject: o
                    }
                }).then(function(t) {
                    return e.apply(void 0, function(e) {
                        if (Array.isArray(e)) {
                            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                            return n
                        }
                        return Array.from(e)
                    }(t))
                })
            }
        }

        function a(e, t) {
            var n = void 0,
                r = new Promise(function(r) {
                    n = r, setTimeout(r.bind(null, t), 1e3 * e)
                });
            return {
                pause: function() {
                    return r
                },
                abort: function() {
                    n(t)
                }
            }
        }
        n.d(t, "c", function() {
            return r
        }), n.d(t, "d", function() {
            return i
        }), n.d(t, "b", function() {
            return o
        }), n.d(t, "a", function() {
            return a
        })
    },
    DVgA: function(e, t, n) {
        var r = n("zhAb"),
            i = n("4R4u");
        e.exports = Object.keys || function(e) {
            return r(e, i)
        }
    },
    E2g8: function(e, t, n) {
        (function(r, i) {
            var o;
            (function() {
                "use strict";

                function a(e) {
                    return "function" == typeof e
                }
                var s, c, u = Array.isArray ? Array.isArray : function(e) {
                        return "[object Array]" === Object.prototype.toString.call(e)
                    },
                    l = 0,
                    d = function(e, t) {
                        w[l] = e, w[l + 1] = t, 2 === (l += 2) && (c ? c(E) : b())
                    };
                var _ = "undefined" != typeof window ? window : void 0,
                    f = _ || {},
                    p = f.MutationObserver || f.WebKitMutationObserver,
                    m = void 0 !== r && "[object process]" === {}.toString.call(r),
                    g = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel;

                function h() {
                    return function() {
                        setTimeout(E, 1)
                    }
                }
                var b, v, y, O, j, w = new Array(1e3);

                function E() {
                    for (var e = 0; e < l; e += 2) {
                        (0, w[e])(w[e + 1]), w[e] = void 0, w[e + 1] = void 0
                    }
                    l = 0
                }
                m ? b = function() {
                    r.nextTick(E)
                } : p ? (y = 0, O = new p(E), j = document.createTextNode(""), O.observe(j, {
                    characterData: !0
                }), b = function() {
                    j.data = y = ++y % 2
                }) : g ? ((v = new MessageChannel).port1.onmessage = E, b = function() {
                    v.port2.postMessage(0)
                }) : b = void 0 === _ ? function() {
                    try {
                        var e = n(! function() {
                            var e = new Error("Cannot find module 'vertx'");
                            throw e.code = "MODULE_NOT_FOUND", e
                        }());
                        return s = e.runOnLoop || e.runOnContext,
                            function() {
                                s(E)
                            }
                    } catch (e) {
                        return h()
                    }
                }() : h();
                var k = function(e, t) {
                    var n = this._state;
                    if (n === M && !e || n === T && !t) return this;
                    var r = new this.constructor(x),
                        i = this._result;
                    if (n) {
                        var o = arguments[n - 1];
                        d(function() {
                            K(n, r, o, i)
                        })
                    } else N(this, r, e, t);
                    return r
                };
                var C = function(e) {
                    if (e && "object" == typeof e && e.constructor === this) return e;
                    var t = new this(x);
                    return B(t, e), t
                };

                function x() {}
                var P = void 0,
                    M = 1,
                    T = 2,
                    I = new W;

                function S(e) {
                    try {
                        return e.then
                    } catch (e) {
                        return I.error = e, I
                    }
                }

                function D(e, t, n) {
                    t.constructor === e.constructor && n === k && constructor.resolve === C ? function(e, t) {
                        t._state === M ? A(e, t._result) : t._state === T ? R(e, t._result) : N(t, void 0, function(t) {
                            B(e, t)
                        }, function(t) {
                            R(e, t)
                        })
                    }(e, t) : n === I ? R(e, I.error) : void 0 === n ? A(e, t) : a(n) ? function(e, t, n) {
                        d(function(e) {
                            var r = !1,
                                i = function(e, t, n, r) {
                                    try {
                                        e.call(t, n, r)
                                    } catch (e) {
                                        return e
                                    }
                                }(n, t, function(n) {
                                    r || (r = !0, t !== n ? B(e, n) : A(e, n))
                                }, function(t) {
                                    r || (r = !0, R(e, t))
                                }, e._label);
                            !r && i && (r = !0, R(e, i))
                        }, e)
                    }(e, t, n) : A(e, t)
                }

                function B(e, t) {
                    var n;
                    e === t ? R(e, new TypeError("You cannot resolve a promise with itself")) : "function" == typeof(n = t) || "object" == typeof n && null !== n ? D(e, t, S(t)) : A(e, t)
                }

                function L(e) {
                    e._onerror && e._onerror(e._result), U(e)
                }

                function A(e, t) {
                    e._state === P && (e._result = t, e._state = M, 0 !== e._subscribers.length && d(U, e))
                }

                function R(e, t) {
                    e._state === P && (e._state = T, e._result = t, d(L, e))
                }

                function N(e, t, n, r) {
                    var i = e._subscribers,
                        o = i.length;
                    e._onerror = null, i[o] = t, i[o + M] = n, i[o + T] = r, 0 === o && e._state && d(U, e)
                }

                function U(e) {
                    var t = e._subscribers,
                        n = e._state;
                    if (0 !== t.length) {
                        for (var r, i, o = e._result, a = 0; a < t.length; a += 3) r = t[a], i = t[a + n], r ? K(n, r, i, o) : i(o);
                        e._subscribers.length = 0
                    }
                }

                function W() {
                    this.error = null
                }
                var H = new W;

                function K(e, t, n, r) {
                    var i, o, s, c, u = a(n);
                    if (u) {
                        if ((i = function(e, t) {
                                try {
                                    return e(t)
                                } catch (e) {
                                    return H.error = e, H
                                }
                            }(n, r)) === H ? (c = !0, o = i.error, i = null) : s = !0, t === i) return void R(t, new TypeError("A promises callback cannot return that same promise."))
                    } else i = r, s = !0;
                    t._state !== P || (u && s ? B(t, i) : c ? R(t, o) : e === M ? A(t, i) : e === T && R(t, i))
                }
                var q = function(e) {
                    return new X(this, e).promise
                };
                var F = function(e) {
                    var t = new this(x);
                    if (!u(e)) return R(t, new TypeError("You must pass an array to race.")), t;
                    var n = e.length;

                    function r(e) {
                        B(t, e)
                    }

                    function i(e) {
                        R(t, e)
                    }
                    for (var o = 0; t._state === P && o < n; o++) N(this.resolve(e[o]), void 0, r, i);
                    return t
                };
                var z = function(e) {
                        var t = new this(x);
                        return R(t, e), t
                    },
                    V = 0;
                var Q = G;

                function G(e) {
                    this._id = V++, this._state = void 0, this._result = void 0, this._subscribers = [], x !== e && ("function" != typeof e && function() {
                        throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")
                    }(), this instanceof G ? function(e, t) {
                        try {
                            t(function(t) {
                                B(e, t)
                            }, function(t) {
                                R(e, t)
                            })
                        } catch (t) {
                            R(e, t)
                        }
                    }(this, e) : function() {
                        throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")
                    }())
                }
                G.all = q, G.race = F, G.resolve = C, G.reject = z, G._setScheduler = function(e) {
                    c = e
                }, G._setAsap = function(e) {
                    d = e
                }, G._asap = d, G.prototype = {
                    constructor: G,
                    then: k,
                    catch: function(e) {
                        return this.then(null, e)
                    }
                };
                var X = Y;

                function Y(e, t) {
                    this._instanceConstructor = e, this.promise = new e(x), Array.isArray(t) ? (this._input = t, this.length = t.length, this._remaining = t.length, this._result = new Array(this.length), 0 === this.length ? A(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(), 0 === this._remaining && A(this.promise, this._result))) : R(this.promise, this._validationError())
                }
                Y.prototype._validationError = function() {
                    return new Error("Array Methods must be provided an Array")
                }, Y.prototype._enumerate = function() {
                    for (var e = this.length, t = this._input, n = 0; this._state === P && n < e; n++) this._eachEntry(t[n], n)
                }, Y.prototype._eachEntry = function(e, t) {
                    var n = this._instanceConstructor,
                        r = n.resolve;
                    if (r === C) {
                        var i = S(e);
                        if (i === k && e._state !== P) this._settledAt(e._state, t, e._result);
                        else if ("function" != typeof i) this._remaining--, this._result[t] = e;
                        else if (n === Q) {
                            var o = new n(x);
                            D(o, e, i), this._willSettleAt(o, t)
                        } else this._willSettleAt(new n(function(t) {
                            t(e)
                        }), t)
                    } else this._willSettleAt(r(e), t)
                }, Y.prototype._settledAt = function(e, t, n) {
                    var r = this.promise;
                    r._state === P && (this._remaining--, e === T ? R(r, n) : this._result[t] = n), 0 === this._remaining && A(r, this._result)
                }, Y.prototype._willSettleAt = function(e, t) {
                    var n = this;
                    N(e, void 0, function(e) {
                        n._settledAt(M, t, e)
                    }, function(e) {
                        n._settledAt(T, t, e)
                    })
                };
                var J = function() {
                        var e;
                        if (void 0 !== i) e = i;
                        else if ("undefined" != typeof self) e = self;
                        else try {
                            e = Function("return this")()
                        } catch (e) {
                            throw new Error("polyfill failed because global object is unavailable in this environment")
                        }
                        var t = e.Promise;
                        t && "[object Promise]" === Object.prototype.toString.call(t.resolve()) && !t.cast || (e.Promise = Q)
                    },
                    Z = {
                        Promise: Q,
                        polyfill: J
                    };
                void 0 === (o = function() {
                    return Z
                }.call(t, n, t, e)) || (e.exports = o), J()
            }).call(this)
        }).call(this, n("8oxB"), n("yLpj"))
    },
    ERyv: function(e, t, n) {
        "use strict";
        n.d(t, "c", function() {
            return u
        }), n.d(t, "b", function() {
            return l
        }), n.d(t, "a", function() {
            return d
        }), n.d(t, "d", function() {
            return _
        }), n.d(t, "e", function() {
            return f
        });
        var r = n("BxOC"),
            i = n("DM26"),
            o = void 0,
            a = 1;

        function s(e, t, n, r, i) {
            if ("Script error." !== e) {
                var a = i ? i.stack || i.message : null;
                l("unhandled_error", a ? {
                    err: e,
                    stack: a
                } : {
                    err: e
                })
            }
            o && o.apply(this, arguments)
        }

        function c(e) {
            e.preventDefault()
        }

        function u() {
            return !!window.imwl
        }

        function l(e, t) {
            var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2];
            u() && (n && window.console && (console.error(e, t), console.trace && console.trace()), Object(i.d)(r.b, 3, function() {
                return 2
            })("al_im.php", {
                act: "a_weird_log",
                kind: e,
                data: JSON.stringify(extend({
                    errIdx: a++,
                    ua: navigator.userAgent
                }, t))
            }))
        }

        function d(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};
            return l(e, extend({
                err: t && t.message || t
            }, n)), Promise.reject(t)
        }

        function _() {
            o = window.onerror, window.onerror = s, window.addEventListener("unhandledrejection", c)
        }

        function f() {
            window.onerror = o, o = void 0, window.removeEventListener("unhandledrejection", c)
        }
    },
    EUzL: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return o
        });
        var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

        function i(e) {
            if (Array.isArray(e)) {
                for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                return n
            }
            return Array.from(e)
        }

        function o(e, t, n) {
            var o = 0,
                a = e,
                s = [],
                c = !1;

            function u() {
                !s.length || o > 0 || c || (t(s), s = [])
            }
            return {
                pause: function() {
                    o++
                },
                resume: function() {
                    o > 0 && (o--, u())
                },
                onLp: function(e, t, o) {
                    var l;
                    c || (a >= e ? (a = t, (l = s).push.apply(l, i(o)), u()) : n && (c = !0, n(a).then(function(e) {
                        var t, n = r(e, 3),
                            o = (n[0], n[1]),
                            l = n[2];
                        a = o, c = !1, (t = s).push.apply(t, i(l)), u()
                    })))
                }
            }
        }
    },
    EasH: function(__webpack_module__, __webpack_exports__, __webpack_require__) {
        "use strict";
        __webpack_require__.d(__webpack_exports__, "a", function() {
            return MessageBox
        }), __webpack_require__.d(__webpack_exports__, "b", function() {
            return showBox
        }), __webpack_require__.d(__webpack_exports__, "f", function() {
            return showTabbedBox
        }), __webpack_require__.d(__webpack_exports__, "d", function() {
            return showFastBox
        }), __webpack_require__.d(__webpack_exports__, "c", function() {
            return showCaptchaBox
        }), __webpack_require__.d(__webpack_exports__, "e", function() {
            return showReCaptchaBox
        });
        var _ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("v+DW"),
            _debug_tools__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("98sY"),
            _dom_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("Egk5"),
            _ui_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("ryw6"),
            _dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("zxIV"),
            _fx__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("7jxN"),
            _utils_common__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("t7n3"),
            _lang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("4+be"),
            _ajax__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("Kngp"),
            _box_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("kcIO"),
            _accessibility__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("QGEU");

        function MessageBox(_options) {
            var defaults = {
                    title: !1,
                    titleControls: "",
                    width: 450,
                    height: "auto",
                    animSpeed: 0,
                    bodyStyle: "",
                    grey: !1,
                    white: !1,
                    selfDestruct: !0,
                    progress: !1,
                    hideOnBGClick: !1,
                    hideButtons: !1,
                    onShow: !1,
                    onHideAttempt: !1,
                    onBeforeHide: !1,
                    onHide: !1,
                    onClean: !1,
                    onDestroy: !1
                },
                options = Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.i)(defaults, _options),
                guid = window._message_box_guid++,
                visible = !1,
                btns = {
                    ok: [],
                    cancel: []
                },
                boxTitleBck = void 0;
            options.progress || (options.progress = "box_progress" + guid);
            var controlsStyle = options.hideButtons ? ' style="display: none"' : "",
                boxContainer = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.e)("div", {
                    className: "popup_box_container" + (options.containerClass ? " " + options.containerClass : ""),
                    innerHTML: '\n<div class="box_layout" onclick="boxQueue.skip=true;">\n<div class="box_title_wrap">\n  <div class="box_x_button" aria-label="' + Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("global_close") + '" tabindex="0" role="button"></div>\n  <div class="box_title_controls"></div>\n  <div class="box_title"></div>\n</div>\n<div class="box_body" style="' + options.bodyStyle + '"></div>\n<div class="box_controls_wrap" ' + controlsStyle + '><div class="box_controls">\n<table cellspacing="0" cellpadding="0" class="fl_r"><tr></tr></table>\n<div class="progress" id="' + options.progress + '"></div>\n<div class="box_controls_text _box_controls_text">' + (options.textControls || "") + "</div>\n</div></div>\n</div>"
                }, {
                    display: "none"
                });
            Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(boxContainer);
            var boxLayout = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.u)(boxContainer),
                boxTitleWrap = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.u)(boxLayout),
                boxCloseButton = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.u)(boxTitleWrap),
                boxTitle = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.x)(boxTitleWrap),
                boxTitleControls = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.y)(boxCloseButton);
            options.noCloseButton && Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(boxCloseButton);
            var boxBody = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.y)(boxTitleWrap),
                boxControlsWrap = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.y)(boxBody),
                boxControls = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.u)(boxControlsWrap),
                boxButtons = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.u)(boxControls),
                boxProgress = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.y)(boxButtons),
                boxControlsText = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.y)(boxProgress);
            boxLayer.appendChild(boxContainer), boxContainer.setAttribute("tabindex", 0), boxContainer.focus(), refreshBox(), Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.a)(boxContainer);
            var emitter = new EventEmitter;

            function refreshBox() {
                boxTitleBck || (options.title ? (boxTitle.innerHTML = options.title, Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ha)(boxBody, "box_no_title"), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(boxTitleWrap)) : (Object(_dom__WEBPACK_IMPORTED_MODULE_4__.a)(boxBody, "box_no_title"), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(boxTitleWrap))), options.titleControls && (boxTitleControls.innerHTML = options.titleControls), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Va)(boxBody, "box_no_buttons", options.hideButtons), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Va)(boxTitleWrap, "box_grey", options.grey), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Va)(boxTitleWrap, "box_white", options.white), boxContainer.style.width = "string" == typeof options.width ? options.width : options.width + "px", boxContainer.style.height = "string" == typeof options.height ? options.height : options.height + "px"
            }

            function _addButton(e, t, n, r) {
                var i = "flat_button";
                "no" === n || "gray" === n ? (i += " secondary", n = "cancel") : n = "ok";
                var o = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.e)("button", {
                    className: i,
                    innerHTML: e,
                    id: r
                });
                return boxButtons.rows[0].insertCell(0).appendChild(o), Object(_ui__WEBPACK_IMPORTED_MODULE_0__.d)(o, function() {
                    emitter.emit(n, retBox), t.apply(null, arguments)
                }), btns[n].push(o), o
            }

            function setControlsText(e) {
                boxControlsText.innerHTML = e
            }

            function _removeButtons() {
                for (var e = boxButtons.rows[0]; e.cells.length;) Object(_dom__WEBPACK_IMPORTED_MODULE_4__.g)(e.cells[0]), e.deleteCell(0);
                btns.ok.length = btns.cancel.length = 0
            }
            var destroyMe = function() {
                    Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.v)(options.onClean) && options.onClean(), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.v)(options.onDestroy) && options.onDestroy(), _removeButtons(), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.g)(boxContainer, boxCloseButton, boxTitleWrap, boxControlsWrap), boxLayer.removeChild(boxContainer), delete window._message_boxes[guid]
                },
                hideMe = function(e, t, n) {
                    if (visible) {
                        visible = !1;
                        var r = !0 === e ? 0 : options.animSpeed;
                        options.hideOnBGClick && Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.h)(document, "click", boxQueue.hideBGClick), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.v)(options.onBeforeHide) && options.onBeforeHide();
                        var i = function() {
                            boxQueue.currHiding === _message_boxes[guid] && (boxQueue.currHiding = !1), _message_boxes[guid].shOther || e || layers.boxhide(), !t && options.selfDestruct ? destroyMe() : Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(boxContainer), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.v)(options.onHide) && options.onHide(n)
                        };
                        r > 0 ? (boxQueue.currHiding = _message_boxes[guid], Object(_fx__WEBPACK_IMPORTED_MODULE_5__.f)(boxContainer, r, i)) : i()
                    }
                };

            function showMe(e, t, n) {
                if (!visible && window._message_boxes[guid]) {
                    visible = !0;
                    var r = !0 === e || t ? 0 : options.animSpeed;
                    if (options.hideOnBGClick && Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.b)(document, "click", boxQueue.hideBGClick), t || layers.boxshow(), boxQueue.currHiding) {
                        boxQueue.currHiding.shOther = !0;
                        var i = boxQueue.currHiding.bodyNode.parentNode.parentNode;
                        Object(_dom__WEBPACK_IMPORTED_MODULE_4__.i)(i, "tween").stop(!0)
                    }
                    r > 0 ? Object(_fx__WEBPACK_IMPORTED_MODULE_5__.e)(boxContainer, r) : Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(boxContainer), Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.a)(boxContainer), options.onShow && options.onShow(n)
                }
            }
            Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.b)(boxCloseButton, "click", boxQueue.hideLast);
            var retBox = window._message_boxes[guid] = {
                guid: guid,
                _show: showMe,
                _hide: hideMe,
                bodyNode: boxBody,
                controlsTextNode: boxControlsText,
                titleWrap: boxTitleWrap,
                btns: btns,
                show: function() {
                    return boxQueue._show(guid), this
                },
                progress: boxProgress,
                showCloseProgress: _dom__WEBPACK_IMPORTED_MODULE_4__.a.pbind(boxTitleWrap, "box_loading"),
                hideCloseProgress: _dom__WEBPACK_IMPORTED_MODULE_4__.Ha.pbind(boxTitleWrap, "box_loading"),
                showProgress: function() {
                    Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(boxControlsText), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(boxProgress)
                },
                hideProgress: function() {
                    Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(boxProgress), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(boxControlsText)
                },
                hide: function(e) {
                    return !(Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.v)(options.onHideAttempt) && !options.onHideAttempt(e)) && (boxQueue._hide(guid), !0)
                },
                isVisible: function() {
                    return visible
                },
                bodyHeight: function() {
                    return Object(_dom__WEBPACK_IMPORTED_MODULE_4__.O)(boxBody, "height")
                },
                content: function(e) {
                    return options.onClean && options.onClean(), boxBody.innerHTML = e, Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.a)(boxContainer), boxContainer.focus(), refreshBox(), Object(_accessibility__WEBPACK_IMPORTED_MODULE_10__.c)(), this
                },
                emit: function(e, t) {
                    emitter.emit(e, t)
                },
                addButton: function(e, t, n, r, i) {
                    var o = _addButton(e, t || this.hide, n, i);
                    return r ? o : this
                },
                setButtons: function(e, t, n, r) {
                    var i = this.removeButtons();
                    return e ? (i.addButton(e, t), n && i.addButton(n, r, "no"), i) : i.addButton(Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("box_close"))
                },
                setControlsText: setControlsText,
                removeButtons: function() {
                    return _removeButtons(), this
                },
                setBackTitle: function(e) {
                    e ? (boxTitle.innerHTML = '<div class="back">' + Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("global_box_title_back") + "</div>", Object(_dom__WEBPACK_IMPORTED_MODULE_4__.H)("back", boxTitle).onclick = e, boxTitleBck = options.title, options.title = boxTitle.innerHTML) : boxTitleBck && (boxTitle.innerHTML = options.title = boxTitleBck, boxTitleBck = !1)
                },
                destroy: destroyMe,
                getOptions: function() {
                    return options
                },
                on: function(e, t) {
                    emitter.on(e, t)
                },
                once: function(e, t) {
                    emitter.once(e, t)
                },
                updateBoxCoords: function() {
                    Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.a)(boxContainer)
                },
                setOptions: function(e) {
                    if (options.hideOnBGClick && Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.h)(document, "click", boxQueue.hideBGClick), options = Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.i)(options, e), "bodyStyle" in e)
                        for (var t = options.bodyStyle.split(";"), n = 0, r = t.length; n < r; n++) {
                            var i = t[n].split(":");
                            i.length > 1 && i[0].length && (boxBody.style[Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.H)(i[0])] = Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.H)(i[1]), boxBody.style.setProperty && boxBody.style.setProperty(Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.H)(i[0]), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.H)(i[1]), ""))
                        }
                    return options.hideOnBGClick && Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.b)(document, "click", boxQueue.hideBGClick), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ua)(boxControlsWrap, !options.hideButtons), refreshBox(), options.noRefreshCoords || Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.a)(boxContainer), this
                },
                evalBox: function evalBox(js, url, params) {
                    var scr = "((function() { return function() { var box = this; " + (js || "") + ";}; })())";
                    if (__debugMode) {
                        var fn = eval(scr);
                        fn.apply(this, [url, params])
                    } else try {
                        var _fn = eval(scr);
                        _fn.apply(this, [url, params])
                    } catch (e) {
                        Object(_ui_util__WEBPACK_IMPORTED_MODULE_3__.c)(e, {
                            dt: 15,
                            type: 7,
                            url: url,
                            query: params ? Object(_ajax__WEBPACK_IMPORTED_MODULE_8__.b)(params) : void 0,
                            js: js
                        }), Object(_debug_tools__WEBPACK_IMPORTED_MODULE_1__.d)(e, scr)
                    }
                }
            };
            return retBox
        }

        function showBox(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                r = arguments[3];
            if (Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.d)(r)) return !1;
            var i = n.params || {};
            n.containerClass && (i.containerClass = n.containerClass);
            var o = new MessageBox(i),
                a = {
                    onDone: function(r, a, s, c) {
                        if (n.preOnDone && n.onDone && n.onDone(o), o.isVisible())
                            if (__debugMode) u();
                            else try {
                                u()
                            } catch (n) {
                                Object(_ui_util__WEBPACK_IMPORTED_MODULE_3__.c)(n, {
                                    dt: 15,
                                    type: 103,
                                    url: e,
                                    query: Object(_ajax__WEBPACK_IMPORTED_MODULE_8__.b)(t),
                                    answer: Array.prototype.slice.call(arguments).join("<!>")
                                }), o.isVisible() && o.hide()
                            } else n.onDone && n.onDone(o, c);

                        function u() {
                            Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(boxLayerBG), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.a)(bodyNode, "layers_shown"), o.setOptions({
                                title: r,
                                hideButtons: i.hideButtons || !1
                            }), n.showProgress ? o.show() : Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(o.bodyNode), o.content(a), o.evalBox(s, e, t), n.onDone && n.onDone(o, c)
                        }
                    },
                    onFail: function(e) {
                        if (o.failed = !0, setTimeout(o.hide, 0), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.v)(n.onFail)) return n.onFail(e)
                    },
                    cache: n.cache,
                    stat: n.stat,
                    fromBox: !0
                };
            return n.prgEl && (n.showProgress = _ui_util__WEBPACK_IMPORTED_MODULE_3__.a.pbind(n.prgEl, {
                cls: n.prgClass,
                w: n.prgW,
                h: n.prgH,
                hide: !0
            }), n.hideProgress = _dom__WEBPACK_IMPORTED_MODULE_4__.W.pbind("global_prg")), n.showProgress ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.i)(a, {
                showProgress: n.showProgress,
                hideProgress: n.hideProgress
            }) : (o.setOptions({
                title: !1,
                hideButtons: !0
            }).show(), boxQueue.count() < 2 && (Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(boxLayerBG), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ha)(bodyNode, "layers_shown")), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(o.bodyNode), a.showProgress = function() {
                Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(boxLoader), Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.a)(boxLoader)
            }, a.hideProgress = _dom__WEBPACK_IMPORTED_MODULE_4__.W.pbind(boxLoader)), o.removeButtons().addButton(Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("global_close")), ajax.post(e, t, a), o
        }

        function showTabbedBox(e, t, n, r) {
            return (n = n || {}).stat = n.stat || [], n.stat.push("box.js", "boxes.css"), showBox(e, t, n, r)
        }

        function showFastBox(e, t, n, r, i, o) {
            return new MessageBox("string" == typeof e ? {
                title: e
            } : e).content(t).setButtons(n, r, i, o).show()
        }

        function showCaptchaBox(e, t, n, r) {
            var i = function(t) {
                    if (!t || void 0 === t.keyCode || 10 === t.keyCode || 13 === t.keyCode) {
                        var i = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.J)("input", n.bodyNode);
                        if (Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.H)(i.value) || !0 === t) {
                            var o = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.J)("img", n.bodyNode)[0];
                            Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.h)(i), Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.h)(o), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(Object(_dom__WEBPACK_IMPORTED_MODULE_4__.H)("progress", n.bodyNode)), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(i), r.onSubmit(e, i.value)
                        } else Object(_dom__WEBPACK_IMPORTED_MODULE_4__.E)(i)
                    }
                },
                o = !!n,
                a = Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.r)(t) ? "" : "&s=1",
                s = r.imgSrc || "/captcha.php?sid=" + e + a;
            if (!o) {
                var c = '\n<div class="captcha">\n  <div><img src="' + s + '"/></div>\n  <div>\n    <input type="text" class="big_text" maxlength="7" placeholder="' + Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("global_captcha_input_here") + '" />\n    <div class="progress" /></div>\n  </div>\n</div>' + (r.addText || "");
                n = showFastBox({
                    title: Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("captcha_enter_code"),
                    width: 305,
                    onHide: r.onHide,
                    onDestroy: r.onDestroy || !1
                }, c, Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("captcha_send"), function() {
                    n.submit()
                }, Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("captcha_cancel"), function() {
                    var e = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.J)("input", n.bodyNode),
                        t = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.J)("img", n.bodyNode);
                    Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.h)(e), Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.h)(t), n.hide()
                })
            }
            n.submit = i.pbind(!0), n.changed = !0;
            var u = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.J)("input", n.bodyNode),
                l = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.J)("img", n.bodyNode);
            return o && (u.value = "", l.src = "/captcha.php?sid=" + e + a, Object(_dom__WEBPACK_IMPORTED_MODULE_4__.W)(Object(_dom__WEBPACK_IMPORTED_MODULE_4__.H)("progress", n.bodyNode))), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ta)(u), Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.b)(u, "keypress", i), Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.b)(l, "click", function() {
                this.src = "/captcha.php?sid=" + e + a + "&v=" + Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.s)(1e6, 2e6)
            }), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.E)(u), n
        }

        function showReCaptchaBox(e, t, n, r) {
            window.recaptchaResponse = function(e) {
                r.onSubmit(e)
            };
            var i = !!n,
                o = !!window.grecaptcha;
            if (!i) {
                o || (window.recaptchaCallback = function() {
                    var t = Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.b)();
                    if (t) {
                        var n = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.H)("recaptcha", t.bodyNode);
                        n && (Object(_dom__WEBPACK_IMPORTED_MODULE_4__.Ya)(n, ""), window.grecaptcha.render(n, {
                            sitekey: e,
                            callback: window.recaptchaResponse
                        }))
                    }
                }, headNode.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_4__.e)("script", {
                    type: "text/javascript",
                    src: "https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit&hl=" + t
                })));
                var a = '<div class="recaptcha"></div>' + (r.addText || "");
                n = showFastBox({
                    title: Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("global_recaptcha_title"),
                    width: 354,
                    onHide: r.onHide,
                    onDestroy: r.onDestroy || !1
                }, a, Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("captcha_cancel"));
                var s = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.H)("recaptcha", n.bodyNode);
                s.id = "recaptcha" + (n.guid ? n.guid : "0"), Object(_ui__WEBPACK_IMPORTED_MODULE_0__.u)(s)
            }
            return i && o ? window.grecaptcha.reset() : o && window.recaptchaCallback(), n.changed = !0, n
        }
    },
    EemH: function(e, t, n) {
        var r = n("UqcF"),
            i = n("RjD/"),
            o = n("aCFj"),
            a = n("apmT"),
            s = n("aagx"),
            c = n("xpql"),
            u = Object.getOwnPropertyDescriptor;
        t.f = n("nh4g") ? u : function(e, t) {
            if (e = o(e), t = a(t, !0), c) try {
                return u(e, t)
            } catch (e) {}
            if (s(e, t)) return i(!r.f.call(e, t), e[t])
        }
    },
    FABD: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR")),
            o = n("vRp6"),
            a = n("p+C8"),
            s = n("XpgC"),
            c = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };
        var u = 27,
            l = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.onRemoveToken = function(e) {
                        var t = r.searchContainer.offsetHeight;
                        r.props.onRemoveToken(e.target.getAttribute("data-id")).then(function() {
                            r.updateScroll(t)
                        })
                    }, r.onChange = function(e) {
                        var t = e.target.value;
                        t !== r.value && (r.value = t, r.props.onChange(e), r.scrollContainer.scrollTop = 0)
                    }, r.onSelect = function(e) {
                        var t = r.searchContainer.offsetHeight;
                        r.props.onSelect(e.currentTarget.getAttribute("data-id")).then(function() {
                            r.updateScroll(t)
                        })
                    }, r.onKeydown = function(e) {
                        e.keyCode === u && (r.input.value = "", r.input.blur(), r.props.onChange(e), e.stopPropagation())
                    }, r.updateScroll = function(e) {
                        var t = r.searchContainer.offsetHeight;
                        r.input.focus(), r.searchContainer.scrollTop = r.searchContainer.scrollHeight, e !== t && (r.scrollContainer.scrollTop = r.scrollContainer.scrollTop + t - e)
                    }, r.inputRef = function(e) {
                        r.input = e
                    }, r.searchContainerRef = function(e) {
                        r.searchContainer = e
                    }, r.scrollContainerRef = function(e) {
                        var t = e;
                        if (e && e.container)
                            for (t = e; t.container;) t = t.container;
                        r.scrollContainer = t
                    }, r.value = n.value, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.componentDidMount = function() {
                    this.input.addEventListener("keydown", this.onKeydown)
                }, t.prototype.componentWillUnmount = function() {
                    this.input.removeEventListener("keydown", this.onKeydown)
                }, t.prototype.render = function() {
                    var e = this,
                        t = this.props,
                        n = t.className,
                        u = t.tokens,
                        l = (t.onSelect, t.onRemoveToken, t.removeTokenPlaceholder),
                        d = t.value,
                        _ = t.placeholder,
                        f = t.useInfiniteScroll,
                        p = t.loadMore,
                        m = t.hasMore,
                        g = t.virtualized,
                        h = t.notFoundText,
                        b = t.children,
                        v = t.emptyText,
                        y = t.isSearching,
                        O = function(e, t) {
                            var n = {};
                            for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                            return n
                        }(t, ["className", "tokens", "onSelect", "onRemoveToken", "removeTokenPlaceholder", "value", "placeholder", "useInfiniteScroll", "loadMore", "hasMore", "virtualized", "notFoundText", "children", "emptyText", "isSearching"]),
                        j = f ? o.a : "div",
                        w = f ? {
                            loadMore: p,
                            hasMore: m,
                            virtualized: g,
                            useCapture: !1
                        } : {},
                        E = [].concat(b);
                    return r.createElement("div", {
                        className: Object(i.a)("MultiSelect", n)
                    }, r.createElement("div", {
                        className: "MultiSelect__search",
                        ref: this.searchContainerRef
                    }, u.map(function(t, n) {
                        return r.createElement("span", {
                            className: "MultiSelect__token",
                            key: t.id
                        }, r.createElement("span", {
                            className: "MultiSelect__tokenTitle"
                        }, t.text), l ? r.createElement(s.a, {
                            text: l
                        }, r.createElement("span", {
                            className: "MultiSelect__tokenRemove",
                            "data-id": t.id,
                            onClick: e.onRemoveToken
                        })) : r.createElement("span", {
                            className: "MultiSelect__tokenRemove",
                            "data-id": t.id,
                            onClick: e.onRemoveToken
                        }))
                    }), r.createElement("div", {
                        className: "MultiSelect__caret"
                    }, r.createElement("div", {
                        className: "MultiSelect__caretIn"
                    }, r.createElement("input", c({}, O, {
                        type: "text",
                        className: "MultiSelect__input",
                        placeholder: 0 === u.length ? _ : "",
                        onChange: this.onChange,
                        onInput: this.onChange,
                        onPaste: this.onChange,
                        value: d,
                        ref: this.inputRef
                    }))))), 0 === E.length && (d || v) && !y && r.createElement("div", {
                        className: "MultiSelect__empty"
                    }, r.createElement("div", {
                        className: "MultiSelect__emptyIn"
                    }, d ? h : v)), r.createElement(j, c({
                        className: "MultiSelect__scroll",
                        ref: this.scrollContainerRef
                    }, w), E.map(function(t) {
                        return r.createElement(a.a, {
                            className: "MultiSelect__suggestsItem",
                            "data-id": t.props["data-id"],
                            onClick: e.onSelect,
                            key: t.key
                        }, t)
                    })))
                }, t
            }(r.PureComponent);
        t.a = l, l.defaultProps = {
            removeTokenPlaceholder: "",
            placeholder: "",
            value: "",
            useInfiniteScroll: !1,
            notFoundText: "Not found"
        }
    },
    FJW5: function(e, t, n) {
        var r = n("hswa"),
            i = n("y3w9"),
            o = n("DVgA");
        e.exports = n("nh4g") ? Object.defineProperties : function(e, t) {
            i(e);
            for (var n, a = o(t), s = a.length, c = 0; s > c;) r.f(e, n = a[c++], t[n]);
            return e
        }
    },
    H6hf: function(e, t, n) {
        var r = n("y3w9");
        e.exports = function(e, t, n, i) {
            try {
                return i ? t(r(n)[0], n[1]) : t(n)
            } catch (t) {
                var o = e.return;
                throw void 0 !== o && r(o.call(e)), t
            }
        }
    },
    Hx9h: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR")),
            o = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };
        var a = function(e) {
            function t() {
                return function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t),
                    function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.apply(this, arguments))
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.className,
                    n = e.appearance,
                    a = e.wide,
                    s = e.overflow,
                    c = e.size,
                    u = (e.children, function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["className", "appearance", "wide", "overflow", "size", "children"])),
                    l = i.a.apply(void 0, ["Button"].concat(function(e) {
                        if (Array.isArray(e)) {
                            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                            return n
                        }
                        return Array.from(e)
                    }(Array.isArray(n) ? n.map(function(e) {
                        return "Button--" + e
                    }) : ["Button--" + n]), ["Button--size-" + c, {
                        "Button--wide": !!a,
                        "Button--overflow": !!s,
                        "Button--disabled": !!e.disabled
                    }, t]));
                return r.createElement("button", o({}, u, {
                    className: l
                }), e.children)
            }, t
        }(r.Component);
        t.a = a, a.defaultProps = {
            appearance: "primary",
            size: "m",
            wide: !1
        }
    },
    "I8a+": function(e, t, n) {
        var r = n("LZWt"),
            i = n("K0xU")("toStringTag"),
            o = "Arguments" == r(function() {
                return arguments
            }());
        e.exports = function(e) {
            var t, n, a;
            return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof(n = function(e, t) {
                try {
                    return e[t]
                } catch (e) {}
            }(t = Object(e), i)) ? n : o ? r(t) : "Object" == (a = r(t)) && "function" == typeof t.callee ? "Arguments" : a
        }
    },
    Iw71: function(e, t, n) {
        var r = n("0/R4"),
            i = n("dyZX").document,
            o = r(i) && r(i.createElement);
        e.exports = function(e) {
            return o ? i.createElement(e) : {}
        }
    },
    "J+6e": function(e, t, n) {
        var r = n("I8a+"),
            i = n("K0xU")("iterator"),
            o = n("hPIQ");
        e.exports = n("g3g5").getIteratorMethod = function(e) {
            if (void 0 != e) return e[i] || e["@@iterator"] || o[r(e)]
        }
    },
    K0xU: function(e, t, n) {
        var r = n("VTer")("wks"),
            i = n("ylqs"),
            o = n("dyZX").Symbol,
            a = "function" == typeof o;
        e.exports = function(e) {
            return r[e] || (r[e] = a && o[e] || (a ? o : i)("Symbol." + e))
        }
    },
    KFTi: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return o
        });
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR"));

        function o(e) {
            var t = Object(i.a)("Progress", {
                "Progress--inverted": e.inverted
            }, e.className);
            return r.createElement("div", {
                className: t
            }, r.createElement("div", {
                className: "Progress__item"
            }), r.createElement("div", {
                className: "Progress__item"
            }), r.createElement("div", {
                className: "Progress__item"
            }))
        }
        o.defaultProps = {
            inverted: !1
        }
    },
    Kngp: function(__webpack_module__, __webpack_exports__, __webpack_require__) {
        "use strict";
        __webpack_require__.d(__webpack_exports__, "d", function() {
            return locBase
        }), __webpack_require__.d(__webpack_exports__, "b", function() {
            return ajx2q
        }), __webpack_require__.d(__webpack_exports__, "f", function() {
            return q2ajx
        }), __webpack_require__.d(__webpack_exports__, "g", function() {
            return requestBox
        }), __webpack_require__.d(__webpack_exports__, "a", function() {
            return activateMobileBox
        }), __webpack_require__.d(__webpack_exports__, "h", function() {
            return validateMobileBox
        }), __webpack_require__.d(__webpack_exports__, "i", function() {
            return validatePassBox
        }), __webpack_require__.d(__webpack_exports__, "e", function() {
            return photoCaptchaBox
        }), __webpack_require__.d(__webpack_exports__, "c", function() {
            return initAjax
        });
        var _utils_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("t7n3"),
            _debug_tools__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("98sY"),
            _browser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("gdug"),
            _dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("zxIV"),
            _dom_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("Egk5"),
            _message_box__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("EasH"),
            _utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("aong"),
            _ui_util__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("ryw6"),
            _box_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("kcIO"),
            _lang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("4+be"),
            locBase = location.toString().replace(/#.+$/, ""),
            decodeErors = {},
            iframeTransport = void 0,
            iframeTO = 0;

        function ajx2q(e, t) {
            var n = [],
                r = function(e) {
                    if (decodeErors[e]) return e;
                    try {
                        return encodeURIComponent(e)
                    } catch (e) {
                        return ""
                    }
                };
            for (var i in e)
                if (null != e[i] && !Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.v)(e[i]))
                    if (Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.t)(e[i]))
                        for (var o = 0, a = 0, s = e[i].length; o < s; ++o) null == e[i][o] || Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.v)(e[i][o]) || (n.push(r(i) + "[" + a + "]=" + r(e[i][o])), ++a);
                    else n.push(r(i) + "=" + r(e[i]));
            return t || n.sort(), n.join("&")
        }

        function q2ajx(e) {
            if (!e) return {};
            var t = {},
                n = function(e) {
                    try {
                        return decodeURIComponent(e)
                    } catch (t) {
                        return decodeErors[e] = 1, e
                    }
                };
            return e = e.split("&"), Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.f)(e, function(e, r) {
                var i = r.split("=");
                if (i[0]) {
                    var o = n(i[1] + "");
                    if ("[]" === i[0].substr(i.length - 2)) {
                        var a = n(i[0].substr(0, i.length - 2));
                        t[a] || (t[a] = []), t[a].push(o)
                    } else t[n(i[0])] = o
                }
            }), t
        }

        function requestBox(e, t, n) {
            return e.setOptions({
                onDestroy: n
            }), e.onDone = function() {
                t && t.apply(null, arguments)
            }, e
        }

        function activateMobileBox(e) {
            return requestBox(Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.b)("activation.php", {
                act: "activate_mobile_box",
                hash: e.hash
            }), function() {
                vk.nophone = 0, e.onDone()
            }, e.onFail)
        }

        function validateMobileBox(e) {
            return requestBox(Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.b)("activation.php", {
                act: "validate_box",
                captcha: e.acceptCaptcha ? 1 : "",
                skip_push: e.skip_push ? e.skip_push : "",
                from: e.from || "",
                hash: e.hash,
                ahash: e.ahash
            }, {
                stat: ["uncommon.css"]
            }), e.onDone, e.onFail)
        }

        function validatePassBox(e) {
            return requestBox(Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.b)("activation.php", {
                act: "pass_validate_box",
                hash: e.hash
            }, {
                stat: ["uncommon.css"]
            }), e.onDone, e.onFail)
        }

        function photoCaptchaBox(e) {
            return requestBox(Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.b)("pcaptcha.php", {
                act: "box"
            }, {
                stat: ["pcaptcha.css", "pcaptcha.js"]
            }), e.onDone, e.onFail)
        }
        var ajax = {
            _init: function() {
                try {
                    if (new XMLHttpRequest) return void(ajax._req = function() {
                        return new XMLHttpRequest
                    })
                } catch (e) {}
                ajax._req || _browser__WEBPACK_IMPORTED_MODULE_2__.a.search_bot || location.replace("/badbrowser.php")
            },
            _getreq: function() {
                return ajax._req || ajax._init(), ajax._req()
            },
            _frameover: function(e, t) {
                if (iframeTransport) {
                    var n = iframeTransport.parentNode;
                    n.innerHTML = "", utilsNode.removeChild(n), iframeTransport = !1, (e || t) && ajax.framegot(!1, !1, e, t), ajax.framegot(!1), cur.onFrameBlocksDone && cur.onFrameBlocksDone(), ajax.tOver = (new Date).getTime()
                }
            },
            _receive: function _receive(cont, html, js, bench, params) {
                var container = cont && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.F)(cont);
                if (container && html && (container.firstChild ? container.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_3__.f)(html)) : Object(_dom__WEBPACK_IMPORTED_MODULE_3__.Ya)(container, html)), js) {
                    var scr = "(function(){" + js + ";})()";
                    if (__debugMode) eval(scr);
                    else try {
                        eval(scr)
                    } catch (e) {
                        Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.c)(e, {
                            dt: 15,
                            type: 8,
                            url: ajax._frameurl,
                            js: js,
                            answer: Array.prototype.slice.call(arguments).join("<!>")
                        }), Object(_debug_tools__WEBPACK_IMPORTED_MODULE_1__.d)(e, scr)
                    }
                    bench && (ajax.tModule = cur.module)
                }
                params && "leftads" in params && window.__adsSet && __adsSet(params.leftads, params.ads_section || "", params.ads_can_show, params.ads_showed), ajax._framenext()
            },
            framedata: !1,
            _framenext: function() {
                if ((ajax.framedata || {}).length) {
                    var e = ajax.framedata.shift();
                    !0 === e ? ajax._framenext() : !1 === e ? (ajax.framedata = !1, cur.onFrameBlocksDone && cur.onFrameBlocksDone()) : iframeTO = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.B)(ajax._receive.pbind(e[0], e[1], e[2], !0, e[3]), 0)
                }
            },
            framegot: function(e, t, n, r) {
                ajax.framedata && (ajax.framedata.push(void 0 === t && void 0 === n && void 0 === r ? e : [e, t, n, r]), 1 == ajax.framedata.length && ajax._framenext())
            },
            framepost: function(e, t, n, r) {
                clearTimeout(iframeTO), iframeTransport && ajax._frameover(), iframeTransport = utilsNode.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_3__.e)("div", {
                    innerHTML: "<iframe></iframe>"
                })).firstChild, ajax._framedone = n, ajax.framedata = [!0], e += "?" + ("string" != typeof t ? ajx2q(t, r && r.noSort) : t), e += ("?" != e.charAt(e.length - 1) ? "&" : "") + "_rndVer=" + Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.s)(0, 99999), ajax._frameurl = iframeTransport.src = e
            },
            plainpost: function(e, t, n, r, i, o, a, s) {
                var c = ajax._getreq(),
                    u = "string" != typeof t ? ajx2q(t, a && a.noSort) : t;
                c.onreadystatechange = function() {
                    4 === c.readyState && (c.status >= 200 && c.status < 300 ? n && n(c.responseText, c) : r && r(c.responseText, c))
                };
                try {
                    c.open("POST", e, !0)
                } catch (e) {
                    return !1
                }
                return o && Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.f)(o, function(e, t) {
                    c[e] = t
                }), i || (c.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), s || c.setRequestHeader("X-Requested-With", "XMLHttpRequest")), c.send(u), c
            },
            post: function(e, t, n) {
                "/" !== e.substr(0, 1) && "http" !== e.substr(0, 4) && (e = "/" + e);
                var r = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)({
                        _captcha: !1,
                        _box: !1
                    }, n || {}),
                    i = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)({
                        al: r.frame ? -1 : 1
                    }, t),
                    o = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.L)(),
                    a = vk.spentLastSendTS ? Math.round((o - vk.spentLastSendTS) / 1e3) : 0;
                if (vk.sampleUser >= 0 && window.cur && cur.module && a >= 1 && (window.curNotifier && curNotifier.idle_manager && !curNotifier.idle_manager.is_idle && (i._smt = cur.module + ":" + a), vk.spentLastSendTS = o), r.progress && (r.showProgress || (r.showProgress = function() {
                        var e = Object(_dom__WEBPACK_IMPORTED_MODULE_3__.F)(r.progress);
                        Object(_dom__WEBPACK_IMPORTED_MODULE_3__.V)(e, "pr") && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.Qa)(e, "opacity", 1), Object(_dom__WEBPACK_IMPORTED_MODULE_3__.Ta)(e)
                    }), r.hideProgress || (r.hideProgress = function() {
                        var e = Object(_dom__WEBPACK_IMPORTED_MODULE_3__.F)(r.progress);
                        Object(_dom__WEBPACK_IMPORTED_MODULE_3__.V)(e, "pr") && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.Qa)(e, "opacity", 0), Object(_dom__WEBPACK_IMPORTED_MODULE_3__.W)(e)
                    })), r.loader) {
                    var s = Object(_dom__WEBPACK_IMPORTED_MODULE_3__.Aa)(boxLayerWrap);
                    r.showProgress = function() {
                        boxRefreshCoords(boxLoader), Object(_dom__WEBPACK_IMPORTED_MODULE_3__.Ta)(boxLoader), s || Object(_dom__WEBPACK_IMPORTED_MODULE_3__.Ta)(boxLayerWrap)
                    }, r.hideProgress = function() {
                        Object(_dom__WEBPACK_IMPORTED_MODULE_3__.W)(boxLoader), s || Object(_dom__WEBPACK_IMPORTED_MODULE_3__.W)(boxLayerWrap)
                    }
                }
                return ajax._post(e, i, r)
            },
            preload: function(e, t, n) {
                "/" !== e.substr(0, 1) && (e = "/" + e), ajaxCache[e + "#" + ajx2q(t)] = n
            },
            invalidate: function(e, t) {
                void 0 === e ? ajaxCache = {} : delete ajaxCache[ajax._getCacheKey(e, t)]
            },
            _getCacheKey: function(e, t, n) {
                var r = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.d)(t);
                return delete r.al, delete r.al_ad, delete r.ads_section, delete r.ads_showed, delete r.captcha_sid, delete r.captcha_key, delete r._smt, delete r._preload, e + "#" + ajx2q(r, n && n.noSort)
            },
            _debugLog: function(e, t) {
                window.debuglogGot && window.debuglogGot(t, e)
            },
            _parseRes: function(e, t) {
                for (var n = e.length - 1; n >= 0; --n) {
                    var r = e[n];
                    if ("<!" === r.substr(0, 2)) {
                        var i = r.indexOf(">"),
                            o = r.substr(2, i - 2);
                        switch (r = r.substr(i + 1), o) {
                            case "json":
                                e[n] = Object(_utils__WEBPACK_IMPORTED_MODULE_6__.l)(r);
                                break;
                            case "int":
                                e[n] = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(r);
                                break;
                            case "float":
                                e[n] = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.k)(r);
                                break;
                            case "bool":
                                e[n] = !!Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(r);
                                break;
                            case "null":
                                e[n] = null;
                                break;
                            case "pageview_candidate":
                                e.pop();
                                break;
                            case "debug":
                                ajax._debugLog(r, t), e.pop()
                        }
                    }
                }
            },
            _post: function _post(url, query, options) {
                !query.captcha_sid && options.showProgress && options.showProgress();
                var cacheKey = !1,
                    statAct = void 0;
                window.__adsGetAjaxParams && Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(query, __adsGetAjaxParams(query, options)), options.cache && (cacheKey = ajax._getCacheKey(url, query, options));
                var hideBoxes = function() {
                        for (var e = 0, t = arguments.length; e < t; ++e) {
                            var n = arguments[e];
                            n && n.isVisible() && (n.setOptions({
                                onHide: !1,
                                onDestroy: !1
                            }), n.hide())
                        }
                        return !1
                    },
                    fail = function(e, t) {
                        if (options.hideProgress && options.hideProgress(), options._suggest && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.g)(options._suggest), options._box = hideBoxes(options._captcha, options._box), options._captcha = options._box, options._suggest = options._captcha, -1 !== e.indexOf("The page is temporarily unavailable") && __dev && Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.o)(vk.id, [100])) return ajax._post(url, query, options), !1;
                        options.onFail && !0 === options.onFail(e) || Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.c)(e, {
                            dt: 5,
                            type: 3,
                            status: t.status,
                            url: url,
                            query: query && ajx2q(query, options.noSort)
                        })
                    };
                options.local && (fail = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.K)(fail)), options.stat && (statAct = !1, stManager.add(options.stat, function() {
                    statAct && statAct(), options.stat = !1
                }));
                var _processResponse = function processResponse(code, answer) {
                    if (options.cache) {
                        var answ = ajaxCache[cacheKey];
                        answ && answ._loading && (setTimeout(function() {
                            for (var e in answ._callbacks) answ._callbacks.hasOwnProperty(e) && answ._callbacks[e](code, answer)
                        }, 0), delete ajaxCache[cacheKey])
                    }
                    if (options.stat) return options.stat = !1, statAct = _processResponse.pbind(code, answer), !1;
                    switch (options.cache && !options.forceGlobalCache && (code || (ajaxCache[cacheKey] = answer)), options.hideProgress && options.hideProgress(), 2 !== code && (options._captcha && (options._suggest && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.g)(options._suggest), options._captcha = hideBoxes(options._captcha), options._suggest = options._captcha), options._box = hideBoxes(options._box)), code) {
                        case 1:
                            Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.d)({
                                width: 520,
                                title: answer[0],
                                onDestroy: options.onFail
                            }, answer[1]);
                            break;
                        case 2:
                            var addText = "";
                            if (2 === Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(answer[1])) {
                                var resend = function(e) {
                                    var t = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(query, {
                                            recaptcha: e
                                        }),
                                        n = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(options, {
                                            cache: -1
                                        }) : options;
                                    ajax._post(url, t, n)
                                };
                                options._captcha = Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.e)(answer[0], answer[2], options._captcha, {
                                    onSubmit: resend,
                                    addText: addText,
                                    onDestroy: function() {
                                        options.onFail && options.onFail()
                                    }
                                })
                            } else {
                                var _resend = function(e, t) {
                                    var n = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(query, {
                                            captcha_sid: e,
                                            captcha_key: t
                                        }),
                                        r = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(options, {
                                            cache: -1
                                        }) : options;
                                    ajax._post(url, n, r)
                                };
                                options._captcha = Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.c)(answer[0], Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(answer[1]), options._captcha, {
                                    onSubmit: _resend,
                                    addText: addText,
                                    onDestroy: function() {
                                        options.onFail && options.onFail()
                                    }
                                })
                            }
                            options._suggest = Object(_dom__WEBPACK_IMPORTED_MODULE_3__.H)("phone_validation_link", options._captcha.bodyNode), options._suggest && Object(_dom_events__WEBPACK_IMPORTED_MODULE_4__.b)(options._suggest, "click", function() {
                                options._box = validateMobileBox({
                                    onDone: options._captcha.submit
                                })
                            });
                            break;
                        case 11:
                        case 12:
                            var newOptions = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(options, {
                                cache: -1
                            }) : options;
                            options._box = validateMobileBox({
                                acceptCaptcha: 11 === code,
                                onDone: function(e, t) {
                                    vk.nophone = 0, e && (options._captcha = Object(_box_utils__WEBPACK_IMPORTED_MODULE_8__.b)());
                                    var n = e ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(query, {
                                        captcha_sid: e,
                                        captcha_key: t
                                    }) : query;
                                    ajax._post(url, n, newOptions)
                                },
                                onFail: options.onFail,
                                hash: answer[0],
                                ahash: answer[1]
                            });
                            break;
                        case 14:
                            var _newOptions = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(options, {
                                cache: -1
                            }) : options;
                            options._box = photoCaptchaBox({
                                onDone: ajax._post.pbind(url, query, _newOptions),
                                onFail: options.onFail
                            });
                            break;
                        case 15:
                            var _newOptions2 = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(options, {
                                cache: -1
                            }) : options;
                            options._box = validatePassBox({
                                onDone: ajax._post.pbind(url, query, _newOptions2),
                                onFail: options.onFail,
                                hash: answer[0]
                            });
                            break;
                        case 3:
                            var _newOptions3 = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(options, {
                                cache: -1
                            }) : options;
                            window.onReLoginDone = ajax._post.pbind(url, query, _newOptions3), window.onReLoginFailed = function(e, t) {
                                t ? nav.go(t) : -1 === e ? location.href = location.href.replace(/^http:/, "https:") : e ? nav.go("/") : window.onReLoginDone()
                            }, utilsNode.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_3__.e)("iframe", {
                                src: vk.loginscheme + "://login.vk.com/?" + ajx2q({
                                    role: "al_frame",
                                    _origin: locProtocol + "//" + locHost,
                                    ip_h: answer[0] || vk.ip_h,
                                    to: answer[1] || ""
                                })
                            }));
                            break;
                        case 4:
                            Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(answer[1]) ? nav.go(answer[0], !1, {
                                nocur: "2" === answer[1],
                                noback: !0 === answer[1],
                                showProgress: options.showProgress,
                                hideProgress: options.hideProgress
                            }) : (hab.stop(), location.href = answer[0]);
                            break;
                        case 5:
                            nav.reload({
                                force: Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(answer[0]),
                                from: 1,
                                url: url,
                                query: query && ajx2q(query)
                            });
                            break;
                        case 6:
                            var _newOptions4 = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(options, {
                                cache: -1
                            }) : options;
                            options._box = activateMobileBox({
                                onDone: ajax._post.pbind(url, query, _newOptions4),
                                onFail: options.onFail,
                                hash: answer[0]
                            });
                            break;
                        case 7:
                            options.onFail && options.onFail(), Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.d)(answer[0], 10);
                            break;
                        case 8:
                            if (options.onFail && options.onFail(answer[0])) return;
                            Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.c)(answer[0] + (answer[2] ? " #" + answer[2] : ""), {
                                dt: answer[1] ? 0 : 10,
                                type: 4,
                                url: url,
                                query: query && ajx2q(query)
                            });
                            break;
                        case 9:
                            if ((options.fromBox || options.forceDone) && (options.onDone && options.onDone.apply(window, answer), options.fromBox)) break;
                            options._box = Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.d)({
                                title: Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.H)(answer[0])
                            }, answer[1]);
                            var _newOptions5 = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.d)(options), {
                                showProgress: options._box.showProgress,
                                hideProgress: options._box.hideProgress
                            });
                            options.cache && (_newOptions5.cache = -1), options._box = requestBox(options._box, function(e) {
                                Object(_dom__WEBPACK_IMPORTED_MODULE_3__.Aa)(options._box.progress) || (e || (e = {
                                    _votes_ok: 1
                                }), ajax._post(url, Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(query, e), _newOptions5))
                            }, options.onFail), options._box.evalBox(answer[2]);
                            break;
                        case 10:
                            options._box = Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.d)({
                                title: answer[0] || Object(_lang__WEBPACK_IMPORTED_MODULE_9__.d)("global_charged_zone_title"),
                                onHide: options.onFail
                            }, answer[1], Object(_lang__WEBPACK_IMPORTED_MODULE_9__.d)("global_charged_zone_continue"), function() {
                                var e = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)(query, {
                                    charged_confirm: answer[3]
                                });
                                ajax._post(url, e, options)
                            }, Object(_lang__WEBPACK_IMPORTED_MODULE_9__.d)("global_cancel"));
                            break;
                        case 13:
                            var evalString = "(function(){" + answer[0] + ";})()";
                            if (__debugMode) eval(evalString);
                            else try {
                                eval(evalString)
                            } catch (e) {
                                Object(_debug_tools__WEBPACK_IMPORTED_MODULE_1__.d)(e, evalString)
                            }
                            break;
                        default:
                            if (-1 === code || -2 === code || -3 === code) {
                                var adsShowed = answer.pop(),
                                    adsCanShow = answer.pop(),
                                    adsHtml = answer.pop(),
                                    adsProps = void 0; - 3 === code && (adsProps = answer.pop()), window.__adsSet && __adsSet(adsHtml, null, adsCanShow, adsShowed, null, adsProps)
                            }
                            options.onDone && options.onDone.apply(window, answer)
                    }
                    window.LazyLoad && LazyLoad.scanDelayed()
                };
                options.local && (_processResponse = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.K)(_processResponse));
                var done = function(e, t) {
                    options.bench && (ajax.tDone = (new Date).getTime()), e = e.replace(/^<!--/, "").replace(/-<>-(!?)>/g, "--$1>"), Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.H)(e).length || (t = [8, Object(_lang__WEBPACK_IMPORTED_MODULE_9__.d)("global_unknown_error")], e = stVersions.nav + "<!><!>" + vk.lang + "<!>" + stVersions.lang + "<!>8<!>" + t[1]);
                    var n = e.split("<!>"),
                        r = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.d)(n);
                    Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.f)(r, function(e, t) {
                        return r[e] = t.substr(0, 100)
                    }), ajax.lastResp = r.join("<!>");
                    var i = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(n.shift());
                    if (!i) return fail("<pre>" + e + "</pre>", {
                        status: -1
                    });
                    if (vk.version && vk.version !== i) i && n.length > 4 ? nav.reload({
                        force: !0,
                        from: 2,
                        url: url,
                        query: query && ajx2q(query)
                    }) : nav.strLoc ? location.replace(locBase) : Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.c)("Server error.", {
                        type: 100
                    });
                    else {
                        vk.version = !1;
                        var o = n.shift(),
                            a = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(n.shift()),
                            s = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(n.shift());
                        options.frame && (n = t);
                        var c = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(n.shift());
                        if (vk.lang !== a && options.canReload) nav.reload({
                            force: !0,
                            from: 3,
                            url: url,
                            query: query && ajx2q(query)
                        });
                        else {
                            var u = function() {
                                var e = ["common.css"];
                                if (o)
                                    for (var t = 0, r = (o = o.split(",")).length; t < r; ++t) e.push(o[t]);
                                if (stVersions.lang < s)
                                    for (var i in stVersions.lang = s, StaticFiles) /^lang\d/i.test(i) && e.push(i);
                                if (!options.frame) try {
                                    ajax._parseRes(n, options._reqid)
                                } catch (e) {
                                    Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.c)("<b>JSON Error:</b> " + e.message, {
                                        type: 5,
                                        answer: n.join("<!>"),
                                        url: url,
                                        query: query && ajx2q(query)
                                    })
                                }
                                stManager.add(e, _processResponse.pbind(c, n))
                            };
                            if (window.stVersions) {
                                if (i === stVersions.nav) return u();
                                headNode.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_3__.e)("script", {
                                    type: "text/javascript",
                                    src: "/js/loader_nav" + i + "_" + vk.lang + ".js"
                                })), setTimeout(function e() {
                                    if (i === stVersions.nav) return u();
                                    setTimeout(e, 100)
                                }, 0)
                            }
                        }
                    }
                };
                if (options.local && (done = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.K)(done)), options.cache > 0 || options.forceGlobalCache) {
                    var answer = ajaxCache[cacheKey];
                    if (answer && answer._loading) return void answer._callbacks.push(_processResponse);
                    if (answer && !options.forceGlobalCache) return _processResponse(0, answer), void(3 === options.cache && delete ajaxCache[cacheKey]);
                    if (answer = window.globalAjaxCache[cacheKey]) return -1 == answer || Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.v)(answer) ? window.globalAjaxCache[cacheKey] = options.onDone : options.onDone.apply(window, answer), void(options.hideProgress && options.hideProgress())
                }
                ajaxCache[cacheKey] = {
                    _loading: 1,
                    _callbacks: []
                }, window.debuglogSent ? (options._reqid = debuglogSent(url + (query ? ": " + ajx2q(query, options.noSort).replace(/&/g, "&amp;") : "")), options.frame && (window._lfrid = options._reqid)) : options._reqid = 0;
                var xhrOptions = {};
                return options.timeout && (xhrOptions.timeout = options.timeout), options.frame ? ajax.framepost(url, query, done, options) : ajax.plainpost(url, query, done, fail, !1, xhrOptions, options)
            },
            tGetParam: function() {
                if (ajax.tStart && ajax.tModule) {
                    var e = [ajax.tDone - ajax.tStart, ajax.tProcess - ajax.tDone, ajax.tRender - ajax.tProcess, ajax.tOver - ajax.tStart, ajax.tModule];
                    for (var t in e)
                        if (e.hasOwnProperty(t)) {
                            if (e[t] < 0) return !1;
                            if (!e[t] && 0 !== e[t]) return !1
                        }
                    return ajax.tStart = !1, e.join(",")
                }
            }
        };

        function initAjax() {
            window.ajaxCache = {}, window.globalAjaxCache = {}, window.ajax = ajax
        }
    },
    KroJ: function(e, t, n) {
        var r = n("dyZX"),
            i = n("Mukb"),
            o = n("aagx"),
            a = n("ylqs")("src"),
            s = Function.toString,
            c = ("" + s).split("toString");
        n("g3g5").inspectSource = function(e) {
            return s.call(e)
        }, (e.exports = function(e, t, n, s) {
            var u = "function" == typeof n;
            u && (o(n, "name") || i(n, "name", t)), e[t] !== n && (u && (o(n, a) || i(n, a, e[t] ? "" + e[t] : c.join(String(t)))), e === r ? e[t] = n : s ? e[t] ? e[t] = n : i(e, t, n) : (delete e[t], i(e, t, n)))
        })(Function.prototype, "toString", function() {
            return "function" == typeof this && this[a] || s.call(this)
        })
    },
    Kuth: function(e, t, n) {
        var r = n("y3w9"),
            i = n("FJW5"),
            o = n("4R4u"),
            a = n("YTvA")("IE_PROTO"),
            s = function() {},
            c = function() {
                var e, t = n("Iw71")("iframe"),
                    r = o.length;
                for (t.style.display = "none", n("+rLv").appendChild(t), t.src = "javascript:", (e = t.contentWindow.document).open(), e.write("<script>document.F=Object<\/script>"), e.close(), c = e.F; r--;) delete c.prototype[o[r]];
                return c()
            };
        e.exports = Object.create || function(e, t) {
            var n;
            return null !== e ? (s.prototype = r(e), n = new s, s.prototype = null, n[a] = e) : n = c(), void 0 === t ? n : i(n, t)
        }
    },
    LQAc: function(e, t) {
        e.exports = !1
    },
    LZWt: function(e, t) {
        var n = {}.toString;
        e.exports = function(e) {
            return n.call(e).slice(8, -1)
        }
    },
    M24l: function(e, t, n) {
        "use strict";
        n.r(t);
        var r = n("vT4u"),
            i = n("P13b"),
            o = n("rHUl"),
            a = n("MhhX"),
            s = n("N1NS"),
            c = n("f01n");

        function u(e, t) {
            return {
                isAll: function(e) {
                    return Object(r.X)(e.get().peer, e.get())
                },
                loadMore: function(e) {
                    return function(e) {
                        return Object(r.X)(e.get().peer, e.get()) ? Promise.resolve("") : Object(r.Hb)(e.get().peer, e.get())
                    }(e)
                },
                unmount: function() {
                    Object(s.c)(t)
                }
            }
        }

        function l(e) {
            return e.findIndex(function(e) {
                return "number" == typeof e.peerId && e.href
            }) > -1
        }

        function d(e, t) {
            var n = function(e, t, n) {
                var o = intval(domData(n, "msgid"));
                if (!getSelectionText() && !Object(i.E)(t)) {
                    var a = intval(domData(n, "peer"));
                    return e.set(r.m.bind(null, a)), e.get().longpoll.push([Object(c.Ba)(a, o)]), !1
                }
            }.bind(null, t);
            return u(0, Object(s.a)({
                handlers: function(t, r) {
                    r(e, "click", "_im_mess", n)
                }
            }))
        }
        var _ = n("h++7"),
            f = n("ERyv");

        function p(e, t) {
            if (!t) return ls.get(e);
            ls.set(e, t)
        }
        var m = function() {
                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                    t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                    n = debounce(p, 300),
                    r = extend({}, e),
                    i = [],
                    o = [];
                return t.store && (r = ls.get(t.key) || r), {
                    get: function() {
                        return r
                    },
                    set: function(e) {
                        var i = this,
                            o = Object(f.c)() ? function(e) {
                                try {
                                    var t = {};
                                    return Error.captureStackTrace(t, e), t.stack
                                } catch (e) {
                                    return ""
                                }
                            }(this.set) : null;
                        return e(r).then(function(e) {
                            return r = e, t.store && n(t.key, e), i.emit(), i
                        }).catch(function(e) {
                            return Object(f.a)("store_set_catch", e, {
                                stack: o
                            })
                        })
                    },
                    setState: function(e) {
                        var t = this;
                        return this.set(function(n) {
                            return n = extend(n, e), t.emit(), Promise.resolve(n)
                        })
                    },
                    stash: function() {
                        i.push(r), r = extend({}, e), this.emit()
                    },
                    reset: function() {
                        r = extend({}, e), this.emit()
                    },
                    unmount: function() {
                        r = {}, e = !1, o = []
                    },
                    pop: function() {
                        i.length > 0 && (r = i.pop(), this.emit())
                    },
                    emit: function() {
                        var e = this;
                        o.length > 0 && o.forEach(function(t) {
                            return t(e)
                        })
                    },
                    subscribe: function(e) {
                        -1 === o.indexOf(e) && o.push(e)
                    },
                    unsubscribe: function(e) {
                        o = o.filter(function(t) {
                            return t !== e
                        })
                    },
                    mutate: function(e) {
                        e(r), t.store && n(t.key, r), this.emit()
                    }
                }
            },
            g = n("aong"),
            h = n("+/AQ");

        function b(e, t, n) {
            return t in e ? Object.defineProperty(e, t, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = n, e
        }

        function v(e, t) {
            return Object(g.p)(e).find(function(e) {
                return domData(e, "list-id") === t
            })
        }

        function y(e, t) {
            return Object(g.p)(e).findIndex(function(e) {
                return domData(e, "list-id") === t
            })
        }

        function O(e, t, n, r) {
            if (n) {
                j(e, t, r);
                var i = domData(n, "list-id"),
                    o = i && v(t.children, i);
                o && r.forEach(function(e) {
                    return addClass(o, e)
                }), e.setState({
                    hoveredListItemId: i
                })
            }
        }

        function j(e, t, n) {
            var r = domQuery("." + n.join("."), t);
            r && Object(g.p)(r).forEach(function(e) {
                n.forEach(function(t) {
                    return removeClass(e, t)
                })
            }), e.setState({
                hoveredListItemId: null
            })
        }

        function w(e, t) {
            var n = t && domQuery("." + t.join("."), e)[0];
            return n ? domData(n, "list-id") : null
        }

        function E(e, t, n) {
            return e.map(t).reduce(function(e, t) {
                return e[t] = !0, e
            }, n)
        }

        function k(e, t, n) {
            return {
                ids: E(n.get().elements, e, {}),
                scrolls: t,
                activated: !0
            }
        }

        function C(e) {
            var t = {};
            return e.forEach(function(e) {
                "r" === e[0] && t["a," + e[1]] ? delete t["a," + e[1]] : t[e[0] + "," + e[1]] = e
            }), Object.keys(t).map(function(e) {
                return t[e]
            })
        }

        function x(e, t, n, r, i, o) {
            for (var a = 0; a < r; a++) e = domNS(e);
            var s = se(i(t));
            return domData(s, "list-id", n), e ? o.insertBefore(s, e) : o.appendChild(s), e
        }

        function P(e, t, n, r, i) {
            var o = r.get(),
                a = o.limit,
                s = o.offset,
                c = function(e, t) {
                    var n = t.get();
                    return !n._sortedEls && e && t.setState({
                        elements: n.elements.sort(e),
                        _sortedEls: !0
                    }), t.get().elements
                }(n().sortFn, r).slice(0, s + a),
                u = function(e, t) {
                    for (var n = [], r = Math.max(e.length, t.length), i = 0; i < r; i++) {
                        var o = e[i],
                            a = t[i];
                        !o && a ? n.push(["a", a, i]) : o && !a ? n.push(["r", o, i]) : o !== a && (n.push(["r", o, i]), n.push(["a", a, i]))
                    }
                    var s = C(n),
                        c = C(n.reverse());
                    return s.length > c.length ? c : s
                }(Object(g.p)(e.children).map(function(e) {
                    return domData(e, "list-id")
                }).filter(function(e) {
                    return !!e
                }), c.map(function(e) {
                    return n().idFn(e).toString()
                }));
            if (function(e, t, n, r) {
                    if (0 !== t.length) {
                        var i = (t = t.sort(function(e, t) {
                            return e[2] - t[2]
                        })).filter(function(e) {
                            return "a" === e[0]
                        });
                        if (t.filter(function(e) {
                                return "r" === e[0]
                            }).map(function(t) {
                                return e.children[t[2]]
                            }).forEach(function(e) {
                                return re(e)
                            }), 0 !== i.length)
                            for (var o = i.shift(), a = o[2], s = (x(e.children[a], n[o[2]], o[1], 0, r, e), 0); s < i.length; s++) o = i[s], x(e.children[a], n[o[2]], o[1], o[2] - a, r, e), a = o[2]
                    }
                }(e, u, c, n().renderFn), function(e, t) {
                    e.get().loading ? t.update(!1, !0) : (e.get().loading = !0, t.update(!1, !0), e.get().loading = !1)
                }(r, t), i) return u.filter(function(e) {
                return "a" == e[0]
            }).map(function(e) {
                return parseInt(e[1])
            })
        }

        function M(e, t, n, r) {
            var i = arguments.length > 4 && void 0 !== arguments[4] && arguments[4],
                o = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 0,
                a = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0,
                s = e.get(),
                c = t.getContainer().children,
                u = y(c, r || s.hoveredListItemId);
            if (!(u < 0)) {
                (s.limit + s.offset < u ? e.setState({
                    offset: u - s.limit + 1
                }).then(P.bind(null, t.getContainer(), t, n)) : Promise.resolve()).then(function() {
                    var e = c[u],
                        n = t.scrollTop(),
                        r = t.getScrollHeight(),
                        s = e.offsetHeight;
                    o = "center" === o ? -.5 * t.getScrollHeight() : o, a = "center" === a ? r / 2 : a;
                    var l = i ? function(e) {
                            t.smoothScroll(e - t.scrollTop())
                        } : t.scrollTop.bind(t),
                        d = n + o > e.offsetTop,
                        _ = s + e.offsetTop > n + r - a;
                    d ? l(e.offsetTop - o) : _ && l(e.offsetTop - r + s + a)
                })
            }
        }

        function T(e, t) {
            var n = e.get().pipeId;
            return !(void 0 !== n && void 0 !== t && n !== t)
        }

        function I(e, t, n, r, i, o) {
            return !!T(e, i) && e.setState(function(e, t, n) {
                var r = e.filter(function(e) {
                    return !n.ids[t(e)]
                });
                return {
                    _sortedEls: !1,
                    els: r,
                    ids: E(r, t, n.ids),
                    elements: n.elements.concat(r)
                }
            }(o, r().idFn, e.get())).then(P.bind(null, t, n, r))
        }

        function S(e, t, n) {
            var r = function(e, t) {
                    if (e.get().loading || e.get().stop || !e.get().activated) return Promise.resolve([]);
                    e.get().loading = !0;
                    for (var n = arguments.length, r = Array(n > 2 ? n - 2 : 0), i = 2; i < n; i++) r[i - 2] = arguments[i];
                    return t.apply(void 0, r).then(function() {
                        e.get().loading = !1
                    })
                }.bind(null, t, function(e, t, n, r) {
                    var o = e.get(),
                        a = o.elements,
                        s = r.getContainer(),
                        c = e.setState({
                            offset: o.offset + o.limit
                        }).then(function() {
                            var n = o.offset,
                                i = o.limit,
                                c = void 0;
                            return i + n > a.length ? c = t().more(n, i).then(function(t) {
                                return !1 === t ? [] : (0 === t.length && e.setState({
                                    stop: !0
                                }), t)
                            }).then(I.bind(null, e, s, r, t, o.pipeId)) : (c = Promise.resolve(), P(s, r, t, e)), c
                        });
                    if (!n) {
                        var u = a.length > 0 ? "im-preloader_fixed-bottom" : "im-preloader_fixed-center";
                        Object(i.lc)(s)(c, "bottom", u)
                    }
                    return c
                }.bind(null, t, n)),
                o = function(e, r) {
                    (t.get().activated || e) && (void 0 !== r && t.get().elements.length > 0 && t.setState({
                        scrolled: r
                    }), n().onScroll && n().onScroll())
                },
                a = Object(h.a)(e, {
                    noScroll: t.get().noScroll,
                    nativeScroll: t.get().nativeScroll,
                    scrollChange: o.bind(null, !1),
                    more: !!n().more && r.bind(null, !1)
                }),
                c = Object(s.a)({
                    handlers: function(r, i) {
                        i(e, "click", t.get().elCls, n().onClick)
                    }
                });
            return t.setState(k(n().idFn, {}, t)), {
                pipe: function(e, r) {
                    return t.setState({
                        pipeId: r
                    }), e.then(I.bind(null, t, a.getContainer(), a, n, r))
                },
                replacePreserveOrder: function(e) {
                    return t.set(function(e, t, n) {
                        var r = [];
                        n.elements = n.elements.map(function(n) {
                            var i = t(n),
                                o = e.filter(function(e) {
                                    return t(e) === i
                                })[0];
                            return r.push(i), o || n
                        });
                        var i = e.filter(function(e) {
                            return !inArray(t(e), r)
                        });
                        return n.elements = n.elements.concat(i), Promise.resolve(n)
                    }.bind(null, e, n().idFn)).then(P.bind(null, a.getContainer(), a, n))
                },
                pipeReplace: function(e, r) {
                    var i = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                    return t.setState({
                        pipeId: r,
                        stop: !1
                    }), e.then(function(e) {
                        if (T(t, r)) return t.setState({
                            elements: e,
                            _sortedEls: !1,
                            ids: E(e, n().idFn, {})
                        }).then(P.bind(null, a.getContainer(), a, n, t, i))
                    })
                },
                wipe: function() {
                    a.getContainer().innerHTML = ""
                },
                deactivate: function() {
                    t.setState({
                        activated: !1
                    })
                },
                activate: function() {
                    t.setState({
                        activated: !0
                    })
                },
                saveScroll: function(e, n) {
                    return t.set(function(e, t, n) {
                        return n.scrolls || (n.scrolls = {}), n.scrolls[e] && !t || (n.scrolls[e] = {
                            scrolled: n.scrolled || 0,
                            scrollItem: n.scrollItem
                        }), Promise.resolve(n)
                    }.bind(null, e, n))
                },
                updateScroll: function() {
                    a.update(!1, !0)
                },
                toTop: function(e) {
                    arguments.length > 1 && void 0 !== arguments[1] && arguments[1] ? a.smoothScroll(-a.scrollTop()) : a.scrollTop(0), e && o(e, 0)
                },
                scrollTop: function(e) {
                    return a.scrollTop(e)
                },
                restoreScroll: function(e) {
                    var n = t.get().scrolls,
                        r = n[e];
                    return r && (t.setState({
                        scrolls: extend({}, n, b({}, e, null))
                    }), a.scrollTop(r.scrolled)), !!r
                },
                unsetScroll: function(e) {
                    t.setState({
                        scrolls: extend({}, t.get().scrolls, b({}, e, null))
                    })
                },
                scrollPage: function(e, t) {
                    var n = a.scroll.scroller,
                        r = a.scrollTop(),
                        i = r + ("up" === e ? -1 : 1) * n.clientHeight;
                    t ? a.smoothScroll(i - r) : a.scrollTop(i)
                },
                scrollToElement: function(e, r, i, o) {
                    M(t, a, n, e, r, i, o)
                },
                checkMore: function(e) {
                    return t.get().elements.length < t.get().limit ? r(e, a) : Promise.resolve([])
                },
                add: function(e, r) {
                    return I(t, a.getContainer(), a, n, r, e)
                },
                hoverNextElement: function(e, r) {
                    var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                        o = a.getContainer(),
                        s = o.children,
                        c = y(s, t.get().hoveredListItemId || w(o, r)),
                        u = Object(g.p)(s).slice(c + 1).find(n().hoverableFn);
                    O(t, o, u, e), M(t, a, n, null, !1, i.top, i.bottom)
                },
                hoverPrevElement: function(e, r) {
                    var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                        o = a.getContainer(),
                        s = o.children,
                        c = y(s, t.get().hoveredListItemId || w(o, r)),
                        u = c >= 0 && Object(g.p)(s).slice(0, c).reverse().find(n().hoverableFn);
                    O(t, o, u, e), M(t, a, n, null, !1, i.top, i.bottom)
                },
                hoverFirstElement: function(e, r) {
                    var i = a.getContainer(),
                        o = i.children,
                        s = Object(g.p)(o).findIndex(n().hoverableFn),
                        c = o[s];
                    !t.get().hoveredListItemId && c && (O(t, i, c, e), M(t, a, n, s, !1, r.top, r.bottom))
                },
                hoverElement: function(e, r, i) {
                    var o = a.getContainer(),
                        s = o.children,
                        c = y(s, e),
                        u = s[c];
                    u && (O(t, o, u, r), M(t, a, n, c, !1, i.top, i.bottom))
                },
                unhoverElements: function(e) {
                    j(t, a.getContainer(), e)
                },
                reset: function() {
                    var e = t.get().scrolls;
                    t.reset(), t.setState(k(n().idFn, e, t))
                },
                getHoveredElement: function() {
                    return v(a.getContainer().children, t.get().hoveredListItemId)
                },
                getCurrentElements: function() {
                    return t.get().elements
                },
                isLoading: function() {
                    return t.get().loading
                },
                isEmpty: function() {
                    return 0 === t.get().elements.length
                },
                remove: function(e) {
                    t.set(function(e, t, n) {
                        return n.elements = n.elements.filter(function(n) {
                            return t(n) !== e
                        }), delete n.ids[e], Promise.resolve(n)
                    }.bind(null, e, n().idFn)).then(P.bind(null, a.getContainer(), a, n))
                },
                unmount: function() {
                    Object(s.c)(c), a.destroy()
                }
            }
        }
        var D = n("1y80"),
            B = n("86+7"),
            L = n("lJdi"),
            A = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }();

        function R(e, t, n) {
            return t in e ? Object.defineProperty(e, t, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = n, e
        }
        var N = 64,
            U = "_im_dialog_star",
            W = "_im_dialog_daction",
            H = ["_im_dialog_selected", "nim-dialog_selected"],
            K = ["_im_dialog_hovered", "nim-dialog_hovered"];

        function q(e) {
            return hasClass(e, "_im_search")
        }

        function F(e, t, n, a, s) {
            if (!gpeByClass("_im_peer_target", a.target)) {
                var u = t.get(),
                    l = q(s),
                    d = parseInt(domData(s, "peer"), 10),
                    _ = parseInt(domData(s, "msgid"), 10),
                    f = Object(o.t)(t, d),
                    p = "";
                if (Object(o.L)(t) && (p = "conversations_search"), Object(o.H)(t) && (p = "recent_searches"), hasClass(s, "_im_sugg_" + d) && (p = "popular_suggestions"), l && (p = "message_search"), checkEvent(a)) return window.open(function(e, t, n) {
                    var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                        o = Object(i.S)(e),
                        a = function() {
                            return o + "?sel=" + Object(i.H)(t.peerId) + (r && n ? "&msgid=" + n : "")
                        };
                    if (r) return a();
                    if (Object(i.fb)(t.peerId) || Object(i.Ka)(t.peerId)) return Object(i.Ia)(e) ? a() : t.href;
                    return a()
                }(t, f, _, l));
                if (n.saveScroll("list"), l && u.msgid !== _) u.longpoll.push([c.Ba(d, _, !1, !1, p)]);
                else if (d !== u.peer) {
                    u.longpoll.push([c.Ba(d, !1, !0, !0, p)]);
                    var m = Object(o.L)(t);
                    m && !hasClass(s, "_dont_add_recent") && Object(r.Bb)(d, cur.imDb), m && f && !Object(i.Ia)(t) && setTimeout(function() {
                        var e = f.message ? f.message.messageId : f.peerId;
                        n.scrollToElement(e.toString(), !0, 0, "center")
                    }, 100)
                } else d === u.peer && e().goToHistoryEnd();
                cancelEvent(a)
            }
        }

        function z(e, t, n, r) {
            var o = void 0;
            return !Object(i.Ha)(t) || "string" == typeof n.photo && "" !== n.photo ? (o = '<img src="' + n.photo + '" alt="">', r && (o = getTemplate("im_dialogs_link_img", {
                href: n.href,
                photo: o
            }))) : o = Object(i.xb)(e, n, !r), {
                photo: o,
                userLink: '<span class="_im_dialog_link">' + n.tab + "</span>"
            }
        }

        function V(e, t, n, r) {
            return n ? "" : r ? getTemplate("im_img_prebody", {
                photo: t
            }) : e + ":"
        }

        function Q(e, t, n) {
            return !!(n & c.m) && (!Object(i.ab)(t.peerId, e.get().gid) && (!(Object(i.Ha)(t.peerId) && t.data && t.data.closed) && (!t.unread && !(t.lastmsg <= t.out_up_to))))
        }

        function G(e) {
            var t = $(e);
            return (e.unread > 0 ? e.unread : "") > 0 && t
        }

        function X(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {},
                a = z(e, t.peerId, t, Object(i.Ia)(e)),
                s = a.photo,
                u = a.userLink,
                l = n || $(t);
            if (!l) return function(e, t, n, r) {
                var a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {},
                    s = [];
                return Object(i.Ia)(r) && s.push("nim-dialog_classic"), Object(o.H)(r) && s.push("nim-dialog_recent"), s.push("nim-dialog_empty"), a.search && s.push("_im_search"), getTemplate("im_drow", {
                    peer: e.peerId,
                    msg_id: "",
                    photo: t,
                    user_link: n,
                    date: "",
                    body: "",
                    unread: "",
                    more: s.join(" "),
                    is_star: "",
                    unread_message_string: "",
                    is_online: onlinePlatformClass(e.online),
                    is_unread: "",
                    is_unread_out: "",
                    is_selected: e.peerId == r.get().peer ? "nim-dialog_selected _im_dialog_selected" : ""
                })
            }(t, s, u, e, r);
            var d = l.flags,
                _ = Object(i.Pa)(e, t.peerId),
                f = Z(t, e, n),
                p = [];
            r.search && p.push("_im_search", "nim-dialog_search"), inArray(t.peerId, e.get().mutedPeers) && p.push("nim-dialog_muted"), t.verified && p.push("nim-dialog_verified"), Object(o.H)(e) && p.push("nim-dialog_recent"), -1 === l.messageId && p.push("nim-dialog_empty"), Object(i.Ia)(e) && p.push("nim-dialog_classic"), t.folders & c.q && p.push("nim-dialog_starred"), !r.search && Object(i.db)(e, t.peerId, t) && p.push("nim-dialog_unrespond"), _ && e.get().gid && p.push("nim-dialog_deny-remove");
            var m = e.get().timeshift,
                g = Q(e, t, d) ? "nim-dialog_unread-out" : "",
                h = t.unread > 0 ? getLang("mail_im_new_messages", t.unread) : "";
            return getTemplate("im_drow", {
                peer: t.peerId,
                msg_id: l.messageId,
                photo: s,
                user_link: u,
                date: l.date ? getShortDateOrTime(l.date, m, !0, getLang("months_sm_of", "raw")) : "",
                body: f,
                unread_message_string: h,
                tab_name: stripHTML(t.tab),
                unread: Object(i.bc)(t.unread),
                more: p.join(" "),
                is_online: onlinePlatformClass(t.online),
                is_unread: G(t) ? "nim-dialog_unread" : "",
                is_unread_out: g,
                is_selected: r.noselect || t.peerId != e.get().peer ? "" : "nim-dialog_selected _im_dialog_selected"
            })
        }

        function Y(e, t, n, r, a) {
            if (!t.deletedDialog)
                if (hasClass(e, "nim-conversation-search-row")) J(e, t, n);
                else {
                    var s = $(t),
                        u = s.flags,
                        l = Z(t, n),
                        d = z(n, t.peerId, t, Object(i.Ia)(n)).photo,
                        _ = n.get().timeshift,
                        f = s.date ? getShortDateOrTime(s.date, _, !0, getLang("months_sm_of", "raw")) : "";
                    le(e, t), val(geByClass1("_dialog_body", e), l), val(geByClass1("_im_dialog_date", e), f), val(geByClass1("_im_dialog_unread_ct", e), Object(i.bc)(t.unread)), val(geByClass1("_im_dialog_link", e), t.tab);
                    var p = geByClass1("_im_dialog_photo", e);
                    p.innerHTML !== d && val(p, d), toggleClass(e, "nim-dialog_verified", !!t.verified), toggleClass(e, "nim-dialog_starred", t.folders & c.q), toggleClass(e, "nim-dialog_muted", inArray(t.peerId, n.get().mutedPeers)), toggleClass(e, "nim-dialog_unrespond", Object(i.db)(n, t.peerId, t)), toggleClass(e, "nim-dialog_classic", Object(i.Ia)(n)), toggleClass(e, "nim-dialog_unread", G(t)), toggleClass(e, "nim-dialog_deny-remove", n.get().gid > 0 && Object(i.Pa)(n, t.peerId)), removeClass(e, "nim-dialog_failed"), removeClass(e, "nim-dialog_deleted"), addClass(e, "_im_dialog"), toggleOnline(geByClass1("_im_peer_online", e), t.online), toggleClass(e, "nim-dialog_recent", Object(o.H)(n)), toggleClass(e, "nim-dialog_empty", -1 === s.messageId), Q(n, t, u) && addClass(e, "nim-dialog_unread-out"), a && setTimeout(function() {
                        addClass(geByClass1("_im_dialog_" + t.peerId, r), "nim-dialog_injected")
                    }, 100)
                }
        }

        function J(e, t, n) {
            le(e, t), toggleClass(e, "nim-dialog_recent", Object(o.H)(n)), val(geByClass1("_im_dialog_unread_ct", e), Object(i.bc)(t.unread));
            var r = z(n, t.peerId, t, Object(i.Ia)(n)).photo,
                a = geByClass1("_im_dialog_photo", e);
            a.innerHTML !== r && val(a, r), toggleOnline(geByClass1("_im_peer_online", e), t.online), G(t) && addClass(e, "nim-dialog_unread")
        }

        function Z(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2] || $(e);
            if (Object(i.Va)(e.peerId, t)) {
                var r = t.get().block_states[e.peerId].name,
                    s = getLang("mail_community_answering").replace("{username}", r);
                return getTemplate("im_drow_prebody", {
                    prebody: s,
                    body: ""
                })
            }
            return Object(a.l)(n) ? Object(i.Bb)(t, n, e, !1) : function(e, t, n, r, a, s, u, l, d, _) {
                var f = "",
                    p = Object(o.y)(e, Object(o.t)(e, n));
                return t & c.m ? f = V(getLang("mail_by_you"), _, p, d) : Object(i.Ha)(n) && 0 !== r && (f = V(Object(B.c)(e, r).first_name, Object(B.c)(e, r).photo, p, d)), u = Object(i.Cb)(n, l, u, a, s), f ? getTemplate("im_drow_prebody", {
                    prebody: f,
                    body: u
                }) : u
            }(t, n.flags, e.peerId, n.userId, !0, n.attaches, n.text, n.subject, Object(i.Ia)(t), Object(B.c)(t, t.get().id).photo)
        }

        function $(e) {
            var t = e.lastmsg_meta;
            return isArray(t) && (t = Object(c.Z)([4].concat(t))), t || Object(c.Z)([4, -1, 0, e.peer, 0, "", {}, {}, -1, -1, 0])
        }

        function ee(e, t, n) {
            var o = Object(i.Rb)(e, t, function(a) {
                n().updateMenu(e), a && Object(i.F)(e, o, n, r.I, t), Object(i.Ha)(t) && e.set(r.Ca.bind(null, t)), o.hide()
            })
        }

        function te(e, t, n, o, a, s) {
            var c = gpeByClass("_im_dialog", s, n);
            if (cancelEvent(a), !c) return !1;
            var u = intval(domData(c, "peer")),
                l = t.get(),
                d = Object(i.Ka)(u) || Object(i.fb)(u);
            if (l.recentSearch) {
                var _ = Object(r.kb)(u, cur.imDb);
                re(c), 0 === _.length && pe(t, o, e)
            } else Object(i.Ia)(t) && d ? Object(r.y)(u, l).then(function(n) {
                var r = A(n, 2),
                    i = r[0],
                    o = r[1];
                i ? (! function(e, t, n, r, i) {
                    var o = geByClass1("_dialog_body", t);
                    addClass(t, "nim-dialog_deleted"), removeClass(t, "_im_dialog"), val(o, getTemplate("im_delete_actions", {
                        text: langNumeric(n, getLang("mail_im_X_message_deleted", "raw")),
                        peer: e,
                        spam_id: r
                    }))
                }(u, c, i, o), e().updateMenu(t)) : ee(t, u, e)
            }) : ee(t, u, e);
            return !1
        }

        function ne(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "",
                r = z(e, t.peerId, t, Object(i.Ia)(e)),
                a = r.photo,
                s = r.userLink,
                c = function(e) {
                    return !Object(i.Xa)(e)
                }(e),
                u = "" === n ? [] : [n];
            return Object(o.H)(e) && u.push("nim-dialog_recent"), Object(i.Ia)(e) && u.push("nim-csr_classic"), inArray(t.peerId, e.get().mutedPeers) && u.push("nim-dialog_muted"), getTemplate("im_conversation_search_row", {
                peer: t.peerId,
                msg_id: t.lastmsg || "",
                photo: a,
                user_link: s,
                unread: Object(i.bc)(t.unread),
                tab_name: stripHTML(t.tab),
                is_unread: G(t) ? "nim-dialog_unread" : "",
                is_online: onlinePlatformClass(t.online),
                is_selected: t.peerId == e.get().peer && c ? "nim-dialog_selected _im_dialog_selected" : "",
                more: u.join(" ")
            })
        }

        function ie(e, t) {
            return e.map(function(e) {
                return Object(c.Z)([4].concat(e))
            }).map(function(e) {
                return extend({}, t[e.peerId], {
                    message: e
                })
            })
        }

        function oe(e) {
            return {
                type: "empty",
                lang: e
            }
        }

        function ae(e, t) {
            var n = e.get().msg_local_ids_sort && e.get().msg_local_ids_sort[t.lastmsg];
            return void 0 !== n ? 2e9 + n : t.lastmsg
        }

        function ue(e, t, n, r) {
            showTooltip(r, {
                text: function() {
                    var n = gpeByClass("_im_dialog", r, t),
                        i = domData(n, "peer");
                    return e.get().tabs[i].folders & c.q ? getLang("mail_im_toggle_important_off") : getLang("mail_im_toggle_important")
                },
                black: 1,
                zIndex: 1,
                shift: [14, 8],
                toup: be(e, r.getBoundingClientRect().top)
            })
        }

        function le(e, t) {
            var n = t.unread > 0 ? getLang("mail_im_new_messages", t.unread) : "",
                r = geByClass1("_im_unread_blind_label", e);
            val(r, n)
        }

        function de(e) {
            var t = Object(o.L)(e),
                n = e.get().searchOnlyMessages;
            return Object(i.Ia)(e) ? {
                top: t && !n ? 96 : 60,
                bottom: Object(i.Ja)(e) ? 42 : 87
            } : {
                top: t && !n ? 36 : 0,
                bottom: 0
            }
        }

        function _e(e, t) {
            e.hoverFirstElement(K, de(t))
        }

        function fe(e) {
            e.unhoverElements(K)
        }

        function pe(e, t, n) {
            if (Object(o.c)(e)) {
                t.pipeReplace(Promise.resolve([{
                    type: "sep_popular"
                }, {
                    type: "popular_sugg"
                }])), t.toTop()
            } else n().cancelSearch(e), cancelStackFilter("im_search")
        }

        function me(e, t, n, r, a) {
            return {
                selectPeer: function(t, n) {
                    for (var r = geByClass("_im_dialog", e), i = n.get().peer, o = 0; o < r.length; o++) {
                        var a = r[o],
                            s = intval(domData(a, "peer")),
                            c = intval(domData(a, "msgid"));
                        s === i && (!q(a) || t === c && q(a)) ? (addClass(a, "nim-dialog_selected"), addClass(a, "_im_dialog_selected")) : hasClass(a, "_im_dialog_selected") && (removeClass(a, "nim-dialog_selected"), removeClass(a, "_im_dialog_selected"))
                    }
                },
                appendFastDialogs: function(t, r, a) {
                    removeClass(e.parentNode, "im-page--dialogs_with-mess"), n.saveScroll("list"), a ? (n.reset(), Object(i.Xa)(t) || Object(o.H)(t) || !l(r) ? Object(o.H)(t) && (l(r) && (r = [{
                        type: "clear_recent"
                    }].concat(r)), Object(o.c)(t) && (r = [{
                        type: "sep_popular"
                    }, {
                        type: "popular_sugg"
                    }].concat(r))) : r = [{
                        type: "sep_btn_search_msg"
                    }, {
                        type: "sep_conversations"
                    }].concat(r), t.setState({
                        searchOnlyMessages: !1
                    }), n.pipeReplace(Promise.resolve(r)).then(function() {
                        return _e(n, t)
                    })) : n.pipe(Promise.resolve(r)), Object(i.Ia)(t) && !Object(i.Ya)(t.get().peer) || n.toTop()
                },
                deactivate: function() {
                    n.deactivate()
                },
                activate: function() {
                    n.activate()
                },
                hoverFirstDialog: function(e) {
                    _e(n, e)
                },
                hoverNextDialog: function(e) {
                    n.hoverNextElement(K, H, de(e))
                },
                hoverPrevDialog: function(e) {
                    n.hoverPrevElement(K, H, de(e))
                },
                unhoverDialogs: fe.bind(n),
                selectHoveredDialog: function(t) {
                    var i = geByClass1("_im_dialog_hovered", e);
                    i || (i = geByClass1("_im_dialog", e)), i && F(r, t, n, {}, i)
                },
                appendSearch: function(t, r, i) {
                    var o = ie(i, r);
                    i.length > 0 ? (addClass(e.parentNode, "im-page--dialogs_with-mess"), n.pipe(Promise.resolve([{
                        type: "sep_messages"
                    }].concat(o))).then(function() {
                        return _e(n, t)
                    })) : (0 === n.getCurrentElements().length && n.pipeReplace(Promise.resolve([oe()])), removeClass(e.parentNode, "im-page--dialogs_with-mess"))
                },
                updateDialog: function(t, n) {
                    var r = geByClass1("_im_dialog_" + t);
                    r && !q(r) && Y(r, n.get().tabs[t], n, e)
                },
                focusOnSelected: function(e) {
                    var t = e.get().peer;
                    if (t) {
                        var r = geByClass1("_im_dialog_" + t);
                        r ? n.scrollTop(r.offsetTop - r.offsetHeight) : n.toTop()
                    }
                },
                restoreScroll: function(e) {
                    n.restoreScroll("list") || n.toTop()
                },
                restoreDialogs: function(t, o, a) {
                    removeClass(e.parentNode, "im-page--dialogs_with-mess"), t.setState({
                        searchOnlyMessages: !1
                    }), 0 !== he(t).length || n.isLoading() || (o = !0), o && n.reset(), a && n.wipe(), n.pipeReplace(Promise.resolve(he(t))).then(function(e) {
                        if (o && (!Object(i.Ia)(t) || !t.get().peer)) {
                            var a = function(e, t, n) {
                                return Object(i.Ia)(n) || t().toggleSettingsLoader(n, !0), e.checkMore(!Object(i.Ia)(n)).then(function() {
                                    Object(i.Ia)(n) || t().toggleSettingsLoader(n, !1)
                                })
                            }(n, r, t);
                            return n.toTop(), a
                        }
                    }).then(function() {
                        return fe(n)
                    })
                },
                appendDialogs: function(t, r) {
                    removeClass(e.parentNode, "im-page--dialogs_with-mess"), r.forEach(function(n) {
                        var r = geByClass1("_im_dialog_" + n.peerId, e);
                        r && J(r, n, t)
                    }), Object(i.Xa)(t) || Object(o.H)(t) || !l(r) || (r = [{
                        type: "sep_btn_search_msg"
                    }, {
                        type: "sep_conversations"
                    }].concat(r)), t.setState({
                        searchOnlyMessages: !1
                    }), n.isEmpty() && 0 === r.length && Object(i.Xa)(t) && (r = [oe(getLang("mail_im_search_empty_chats"))]), n.replacePreserveOrder(r)
                },
                updateCounter: function(t, n) {
                    var r = geByClass1("_im_dialog_" + n, e),
                        a = Object(o.t)(t, n);
                    if (r && !q(r) && (le(r, a), val(geByClass1("_im_dialog_unread_ct", r), Object(i.bc)(a.unread)), toggleClass(r, "nim-dialog_unread", a.unread > 0), toggleClass(r, "nim-dialog_unread-out", Q(t, a, $(a).flags))), Object(o.H)(t)) {
                        var s = geByClass1("_im_sugg_" + n);
                        s && (val(geByClass1("_sugg_unread_ct", s), Object(i.bc)(a.unread)), toggleClass(s, "sugg-is_unread", a.unread > 0))
                    }
                },
                removeDialog: function(e, t) {
                    n.remove(t)
                },
                updateOnline: function(t, n) {
                    var r = geByClass1("_im_dialog_" + t, e);
                    if (r) {
                        var i = n.get().tabs[t],
                            o = geByClass1("_im_peer_online", r);
                        toggleOnline(o, i.online)
                    }
                },
                setDialogFailed: function(t, n, r) {
                    var i = geByClass1("_im_dialog_" + t, e);
                    i && (r.get().tabs[t].lastmsg === n && (addClass(i, "nim-dialog_failed"), val(geByClass1("_im_dialog_unread_ct", i), "!")))
                },
                scrollUp: function(e) {
                    var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
                    n.toTop(e, t), n.saveScroll("list", !0)
                },
                saveScroll: function(e) {
                    n.saveScroll("list", !0)
                },
                promoteDialog: function(r, i) {
                    var a = geByClass1("_im_dialog_" + i, e);
                    a && !q(a) || !Object(o.L)(r) ? (n.pipeReplace(Promise.resolve(he(r)), void 0, !0).then(function(t) {
                        !inArray(i, t) && a && Y(a, Object(o.t)(r, i), r, e)
                    }), t().updateTyping(i, r)) : n.unsetScroll("list")
                },
                removeSelection: function(t) {
                    var r = t.get().peer.toString(),
                        o = "._im_dialog_" + r + "." + H.join("."),
                        a = domQuery(o, e)[0];
                    H.forEach(function(e) {
                        return removeClass(a, e)
                    }), Object(i.Ia)(t) || n.hoverElement(r, K, de(t))
                },
                updateScroll: function() {
                    n.updateScroll()
                },
                updateTyping: function(t, n) {
                    var r = geByClass1("_im_dialog_" + t, e);
                    if (r && !q(r) && !n.get().tabs[t].deletedDialog) {
                        var a = geByClass1("_im_dialog_typing", r),
                            s = !Object(i.Ia)(n),
                            c = Object(i.O)(Object(o.t)(n, t).activity, t, !Object(i.Ha)(t), n.get(), 1, s);
                        val(a, c), toggleClass(r, "nim-dialog_typing", c)
                    }
                },
                unmount: function() {
                    n.unmount(), Object(s.c)(a)
                }
            }
        }

        function he(e) {
            var t = e.get().active_tab,
                n = e.get().dialog_tabs[t],
                r = e.get().tabs,
                o = n.map(function(e) {
                    return r["" + e]
                }).sort(function(e, t, n) {
                    var r = void 0;
                    return t.message && n.message ? (r = n.message.messageId - t.message.messageId, r = Object(i.Za)(e) ? -r : r) : t.message && !n.message ? r = 1 : n.message && !t.message ? r = -1 : (r = ae(e, n) - ae(e, t), r = Object(i.Za)(e) ? -r : r), r
                }.bind(null, e));
            if (e.get().isIncomingMessageRequestsAllowed && n.length) {
                var a = Object(g.r)(e),
                    s = a.message_requests_cnt,
                    c = a.active_tab;
                if (c === _.k && o.unshift({
                        type: "message_request_notice"
                    }), !Object(i.Ia)(e)) switch (c) {
                    case _.h:
                        s && o.unshift({
                            type: "message_request_button_go"
                        });
                        break;
                    case _.k:
                        o.unshift({
                            type: "message_request_button_return"
                        })
                }
            }
            return o
        }

        function be(e, t) {
            return t > (e.get().gid ? 220 : 150) || Object(o.L)(e)
        }

        function ve(e, t, n) {
            var a = Object(s.b)(me),
                c = a.callMutations,
                u = a.bindMutations,
                l = function(e, n) {
                    var r;
                    showTooltip(n, (R(r = {
                        text: function() {
                            if (Object(o.H)(t)) return getLang("mail_hide_from_recent");
                            var e = Number(n.getAttribute("data-peer")),
                                r = Object(o.t)(t, e);
                            return Object(i.Ha)(e) ? Object(L.m)(Object(o.t)(t, e), 1024) ? getLang("mail_unfollow_channel") : r.data.closed || r.data.kicked ? getLang("mail_delete") : getLang("mail_leave_chat") : getLang("mail_delete")
                        },
                        black: 1
                    }, Object(i.Ia)(t) ? "center" : "needLeft", !0), R(r, "shift", Object(i.Ia)(t) ? [-4, 10] : [0, 10]), R(r, "toup", be(t, n.getBoundingClientRect().top)), R(r, "zIndex", 1), r))
                },
                d = function(e, n) {
                    showTooltip(n, {
                        text: getLang("mail_end_conversation"),
                        black: 1,
                        center: !0,
                        zIndex: 1,
                        shift: [1, 4],
                        toup: be(t, n.getBoundingClientRect().top)
                    })
                },
                f = ue.bind(null, t, e),
                p = function(e, t, n, i) {
                    var o = gpeByClass("_im_dialog", i, t),
                        a = intval(domData(o, "peer"));
                    return e.set(r.ic.bind(null, a)), setTimeout(function() {
                        ue(e, t, 0, i)
                    }, 100), cancelEvent(n), !1
                }.bind(null, t, e),
                g = function(e, t, n, i, a) {
                    var s = gpeByClass("_im_dialog", a, t),
                        c = intval(domData(s, "peer")),
                        u = e.get().tabs[c].lastmsg;
                    return e.set(r.Va.bind(null, c, u)).then(function() {
                        Y(s, e.get().tabs[c], e, t), Object(o.H)(e) || n().restoreDialogs(e)
                    }), showDoneBox(getLang("mail_marked_as_answered"), {
                        out: 1e3
                    }), cancelEvent(i), !1
                }.bind(null, t, e, c),
                h = geByClass1("_im_dialogs_search"),
                b = {
                    idFn: function(e) {
                        return function(e, t) {
                            return t.message ? t.message.messageId : Object(o.L)(e) && t.peerId ? t.peerId + "cr" : t.peerId || t.type
                        }(t, e)
                    },
                    hoverableFn: function(e) {
                        return hasClass(e, "_im_dialog")
                    },
                    renderFn: function(e, t) {
                        var n = e.get().isIncomingMessageRequestsAllowed;
                        switch (t.type) {
                            case "sep_btn_search_msg":
                                return Object(i.qb)(e);
                            case "sep_messages":
                                return Object(i.wb)();
                            case "sep_conversations":
                                return Object(i.sb)();
                            case "sep_popular":
                                return Object(i.zb)();
                            case "popular_sugg":
                                return Object(i.Ab)(e);
                            case "clear_recent":
                                return Object(i.rb)();
                            case "empty_dialogs":
                            case "empty_message_requests":
                                return getTemplate("im_dialogs_none", {
                                    msg: getLang("mail_dialogs_list_empty")
                                });
                            case "empty":
                                return getTemplate("im_dialogs_none", {
                                    msg: getLang("mail_im_search_empty")
                                });
                            case "message_request_notice":
                                return n ? getTemplate("im_dialogs_message_requests_notice", {
                                    msg: getLang("mail_message_request_tab_notice")
                                }) : "";
                            case "message_request_button_go":
                                return n ? getTemplate("im_dialogs_message_requests_button", {
                                    msg: getLang("mail_tab_mr")
                                }) : "";
                            case "message_request_button_return":
                                return n ? getTemplate("im_dialogs_message_requests_button", {
                                    msg: getLang("mail_go_to_all_tab")
                                }) : "";
                            default:
                                return t.message ? X(e, t, t.message, {
                                    noselect: !0,
                                    search: !0
                                }) : t.local_index || Object(o.L)(e) ? ne(e, t) : X(e, t)
                        }
                    }.bind(null, t),
                    more: function(e, t, n, a) {
                        if (Object(o.L)(e) && e.get().searchAllLoaded || Object(o.H)(e)) return Promise.resolve([]);
                        if (e.get().dialog_search_going || Object(i.Ia)(e) && 0 !== e.get().peer) return Promise.resolve(!1);
                        if (Object(o.L)(e)) return Object(r.Gb)(Object(o.r)(e), e.get()).then(function(e) {
                            var t = A(e, 2),
                                n = t[0];
                            return ie(t[1], n)
                        });
                        var s = e.get().active_tab,
                            c = e.get().dialog_tabs_all,
                            u = s === _.k;
                        return s !== _.k && c[_.h] && !Object(i.Za)(e) || c[s] ? 0 === he(e).length ? u ? Promise.resolve([{
                            type: "message_request_notice"
                        }, {
                            type: "empty_message_requests"
                        }]) : Promise.resolve([{
                            type: "empty_dialogs"
                        }]) : Promise.resolve([]) : e.set(r.Ia).then(function(t) {
                            var n = he(e);
                            return 0 === n.length ? u ? Promise.resolve([{
                                type: "message_request_notice"
                            }, {
                                type: "empty_message_requests"
                            }]) : [{
                                type: "empty_dialogs"
                            }] : n
                        })
                    }.bind(null, t, c),
                    onScroll: !!Object(i.Ia)(t) && function() {
                        (bodyNode.scrollTop || document.documentElement.scrollTop) <= 0 && !layers.visible && browser.safari ? addClass(h, "im-page--header_static") : removeClass(h, "im-page--header_static")
                    }
                },
                v = S(e, m({
                    limit: 40,
                    offset: 0,
                    nativeScroll: !!Object(i.Ia)(t),
                    height: N,
                    elements: he(t)
                }), function() {
                    return b
                }),
                y = F.bind(null, n, t, v),
                O = function(e, t, n) {
                    removeClass(t.parentNode, "im-page--dialogs_with-mess");
                    var r = n.getCurrentElements().filter(function(e) {
                        return e.message
                    });
                    n.toTop(), n.reset(), Object(D.b)(.01, "im_search_stat", 1, "search_messages_only"), r.length > 0 ? (r = [{
                        type: "sep_messages"
                    }].concat(r), e.setState({
                        searchOnlyMessages: !0
                    })) : r = [oe()], n.pipeReplace(Promise.resolve(r))
                }.bind(null, t, e, v),
                j = function(e, t, n, o, a, s) {
                    var c = intval(domData(s, "peer")),
                        u = domData(s, "action"),
                        l = domData(s, "sid"),
                        d = geByClass1("_im_dialog_" + c, t),
                        _ = intval(domData(s, "spam"));
                    switch (u) {
                        case "restore":
                            d && e.set(r.ub.bind(null, c, l, _)).then(function() {
                                addClass(d, "_im_dialog"), removeClass(d, "nim-dialog_deleted"), Y(d, e.get().tabs[c], e, t, !1), o().updateMenu(e)
                            });
                            break;
                        case "spam":
                            var f = getLang("mail_im_dialog_marked_spam") + '\n        <button type="button" class="nim-dialog--daction nim-dialog--daction_last _im_dialog_daction"\n          data-action="restore"\n          data-spam="1"\n          data-sid="' + l + '" data-peer="' + c + '">\n            ' + getLang("mail_restore") + "\n        </button>";
                            if (d) {
                                var p = geByClass1("_dialog_body", d);
                                val(p, f), Object(r.ac)(c, l, e.get())
                            }
                            break;
                        case "block":
                            (Object(i.Ja)(e) ? Object(i.Lb)(c, e) : Object(i.Mb)(c, e)).once("success", function() {
                                e.set(r.I.bind(null, c)).then(function() {
                                    n().restoreDialogs(e)
                                })
                            })
                    }
                    cancelEvent(a)
                }.bind(null, t, e, c, n),
                w = te.bind(null, n, t, e, v),
                E = function(e, t) {
                    Object(i.gc)(e, t, r.o)
                }.bind(null, t, n),
                k = Object(s.a)({
                    handlers: function(o, a) {
                        a(e, "click", "_im_dialog_close", w), a(e, "click", "_im_dialog_markre", g), a(e, "click", U, p), a(e, "click", "_im_dialog", y), a(e, "click", i.q, O), a(e, "mouseover", "_im_dialog_close", l), a(e, "mouseover", "_im_dialog_markre", d), a(e, "click", i.i, function() {
                            Object(r.sb)(cur.imDb), pe(t, v, n)
                        }), a(e, "click", i.u, E), a(e, "mouseover", U, f), a(e, "click", W, j), o(e, "mouseover", throttle(v.unhoverElements.bind(v, K), 100))
                    }
                });
            return u(e, c, v, n, k)
        }
        var ye = n("O8ze"),
            Oe = n("QOPk"),
            je = n("Wu9C"),
            we = n("q1tI"),
            Ee = n("i8i4"),
            ke = n("T/g7"),
            Ce = (n("17x9"), n("pemR"));

        function xe(e) {
            return we.createElement("header", {
                className: Object(Ce.a)("PopupHeader", e.className),
                style: e.style
            }, e.back && we.createElement("div", {
                className: "PopupHeader__back",
                onClick: e.onBackClick
            }, we.createElement("button", {
                className: "PopupHeader__backBtn",
                onClick: e.onBackClick
            }, e.back)), we.createElement("h2", {
                className: "PopupHeader__title"
            }, e.title), we.createElement("div", {
                className: "PopupHeader__close"
            }, we.createElement("button", {
                className: "PopupHeader__closeBtn",
                onClick: e.onCloseClick
            })))
        }
        xe.defaultProps = {
            back: null,
            title: "",
            onCloseClick: function() {}
        };
        var Pe = n("Hx9h"),
            Me = n("XpgC"),
            Te = n("WDXI");
        var Ie = window.unclean,
            Se = ke.a.getLang,
            De = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var i = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return i.onSaveTitle = function(e) {
                        var t = i.props.store,
                            n = t.get(),
                            o = e.value.trim().replace("\n", "");
                        o && o !== Ie(i.props.title) && (i.setState({
                            titleChanged: !1
                        }), t.set(r.qc.bind(null, n.peer, o)))
                    }, i.onChangeTitle = function(e) {
                        if (i.state.title !== e.target.value) {
                            var t = e.target.value.replace("\n", "");
                            i.setState({
                                title: t,
                                titleChanged: Ie(i.props.title) !== t
                            })
                        }
                    }, i.onValidateTitle = function(e) {
                        return !!e.trim().replace("\n", "")
                    }, i.onCancelTitle = function() {
                        i.setState({
                            title: Ie(i.props.title),
                            titleChanged: !1
                        })
                    }, i.onSaveDescription = function(e) {}, i.onPhotoUpload = function() {
                        var e = i.props.store,
                            t = e.get().peer;
                        Object(L.g)(e) && (cur.recieveCropResult = void 0, Page.ownerPhoto(t, {
                            gid: e.get().gid
                        }))
                    }, i.onPhotoRemove = function() {
                        var e = i.props.store,
                            t = e.get().peer;
                        Object(L.g)(e) && e.set(r.ib.bind(null, t)).then(function() {
                            return e.set(r.L.bind(null, t))
                        }).catch(function(e) {
                            return Object(f.a)("onPhotoRemove", e)
                        })
                    }, i.state = {
                        title: Ie(n.title),
                        titleChanged: !1
                    }, i
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.render = function() {
                    var e = this.props,
                        t = e.store,
                        n = e.photo,
                        r = e.title,
                        i = e.description,
                        o = e.grid,
                        a = e.meta,
                        s = Ie(r),
                        c = Object(L.g)(t),
                        u = Object(Ce.a)("ChatSettingsInfo", {
                            "ChatSettingsInfo--editable": c
                        }),
                        l = Object(Ce.a)("ChatSettingsInfo__title", {
                            "ChatSettingsInfo__title-service": 64 & this.props.flags
                        });
                    return we.createElement("div", {
                        className: u
                    }, we.createElement("header", {
                        className: "ChatSettingsInfo__header"
                    }, we.createElement("div", {
                        className: "ChatSettingsInfo__photo"
                    }, we.createElement("div", {
                        className: "ChatSettingsInfo__attach nim-peer nim-peer_larger",
                        "data-tip": Se("mail_settings_photo"),
                        onClick: this.onPhotoUpload
                    }, n ? we.createElement("img", {
                        src: n,
                        width: "80",
                        height: "80",
                        alt: s,
                        className: "ChatSettingsInfo__photoSelf"
                    }) : we.createElement("div", {
                        className: "nim-peer--photo-w"
                    }, we.createElement("div", {
                        className: "ChatSettingsInfo__photoGrid nim-peer--photo",
                        dangerouslySetInnerHTML: {
                            __html: o
                        }
                    }))), n && c && we.createElement(Me.a, {
                        text: Se("mail_settings_remove_photo"),
                        position: "t",
                        align: "left"
                    }, we.createElement("button", {
                        onClick: this.onPhotoRemove,
                        className: "ChatSettingsInfo__photoRemove"
                    }))), we.createElement("h3", {
                        className: l
                    }, c ? we.createElement(Te.a, {
                        value: this.state.title,
                        changed: this.state.titleChanged,
                        useEnter: !0,
                        onSave: this.onSaveTitle,
                        onChange: this.onChangeTitle,
                        onCancel: this.onCancelTitle,
                        validate: this.onValidateTitle
                    }) : s), we.createElement("div", {
                        className: "ChatSettingsInfo__meta"
                    }, a)), i && we.createElement("div", {
                        className: "ChatSettingsInfo__description"
                    }, c ? we.createElement(Te.a, {
                        value: i,
                        onSave: this.onSaveDescription
                    }) : i))
                }, t
            }(we.PureComponent),
            Be = n("dLHM"),
            Le = n("XTb9"),
            Ae = n("BN/X");
        var Re = window.elfocus,
            Ne = ke.a.getLang,
            Ue = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.onCopy = function() {
                        r.input && (Re(r.input, 0, r.input.value.length), document.execCommand("copy"), r.setState({
                            copied: !0
                        }))
                    }, r.onBlinkTextHide = function() {
                        r.setState({
                            copied: !1
                        })
                    }, r.getInputRef = function(e) {
                        e && e.element && (r.input = e.element)
                    }, r.state = {
                        copied: !1
                    }, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.componentDidMount = function() {
                    this.input && Re(this.input, 0, this.input.value.length)
                }, t.prototype.render = function() {
                    var e = this.props,
                        t = e.onReset,
                        n = e.invitationLink,
                        r = e.store,
                        o = Ne("mail_invite_link_reset_explainer").split("{reset_link}"),
                        a = !Object(i.Pa)(r, r.get().peer);
                    return we.createElement("div", {
                        className: "ChatSettingsInvitationLink"
                    }, this.props.reseted && we.createElement("div", {
                        className: "ChatSettingsInvitationLink__reseted"
                    }, Ne("mail_invite_link_reseted_explainer")), we.createElement("p", null, Ne("mail_invite_link_explainer")), we.createElement("div", {
                        className: "ChatSettingsInvitationLink__main"
                    }, we.createElement(Be.a, {
                        ref: this.getInputRef,
                        readOnly: "readonly",
                        className: "ChatSettingsInvitationLink__input",
                        value: n
                    }), we.createElement(Pe.a, {
                        onClick: this.onCopy
                    }, Ne("mail_get_invite_link_copy")), we.createElement(Le.a, {
                        className: "ChatSettingsInvitationLink__copied",
                        shown: this.state.copied,
                        callback: this.onBlinkTextHide
                    }, Ne("mail_invite_link_copied"))), a && we.createElement("p", null, o[0], we.createElement(Ae.a, {
                        className: "ChatSettingsInvitationLink__reset",
                        onClick: t
                    }, Ne("mail_invite_reset_link")), o[1]))
                }, t
            }(we.Component),
            We = n("6raB"),
            He = n("hIV1");
        var Ke = ke.a.getLang,
            qe = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.onConfirm = function() {
                        r.state.loading || (r.setState({
                            loading: !0
                        }), r.props.onConfirm().then(function() {
                            r.setState({
                                loading: !1
                            }), r.props.onCancel()
                        }).catch(function() {
                            return r.setState({
                                loading: !1
                            })
                        }))
                    }, r.state = {}, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.render = function() {
                    return we.createElement("div", {
                        className: "ChatSettingsResetInvitationLink"
                    }, we.createElement("div", {
                        className: "ChatSettingsResetInvitationLink__text",
                        dangerouslySetInnerHTML: {
                            __html: Ke("mail_chat_reset_link_warning")
                        }
                    }), we.createElement(He.a, {
                        alignment: "right"
                    }, we.createElement(Pe.a, {
                        appearance: "tertiary",
                        onClick: this.props.onCancel
                    }, Ke("global_cancel")), we.createElement(We.a, {
                        onClick: this.onConfirm,
                        loading: this.state.loading
                    }, Ke("mail_chat_reset_link_confirm"))))
                }, t
            }(we.Component),
            Fe = n("enZq"),
            ze = n("p+C8");

        function Ve(e) {
            return we.createElement("div", {
                className: Object(Ce.a)("ChatSettingsRoundedIcon", "ChatSettingsRoundedIcon--" + e.type)
            })
        }
        var Qe = ke.a.getLang,
            Ge = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.onCopyInviteLink = function(e) {
                        r.input && (r.input.focus(), r.input.select(), document.execCommand("copy"), r.setState({
                            copied: !0
                        })), e.preventDefault(), e.stopPropagation()
                    }, r.onBlinkTextHide = function() {
                        r.setState({
                            copied: !1
                        })
                    }, r.getHiddenInput = function(e) {
                        r.input = e
                    }, r.onShowInviteLink = function() {
                        Object(L.f)(r.props.store) && r.props.showInvitationLink()
                    }, r.state = {
                        copied: !1
                    }, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.render = function() {
                    var e = this.props,
                        t = e.store,
                        n = e.flagsUpdated,
                        r = e.onHideStatus,
                        o = t.get(),
                        a = o.tabs[o.peer],
                        s = Object(i.Pa)(o, o.peer),
                        c = a.inviteLink && Object(L.l)(t) || Object(L.f)(t),
                        u = Object(L.n)(a, o.id) && !s,
                        l = Object(Ce.a)("ChatSettingsMenu", {
                            "ChatSettingsMenu--copied": this.state.copied
                        });
                    return we.createElement("div", {
                        className: "ChatSettings__pane"
                    }, we.createElement(Fe.a, {
                        className: l
                    }, we.createElement(ze.a, {
                        onClick: this.props.showAttachments,
                        chevron: !0
                    }, we.createElement(Ve, {
                        type: "attach"
                    }), Qe("mail_im_show_media_history"))), (c || u) && we.createElement(Fe.a, {
                        className: l
                    }, c && we.createElement(ze.a, {
                        onClick: this.onShowInviteLink,
                        chevron: Object(L.f)(t)
                    }, we.createElement(Ve, {
                        type: "link"
                    }), Qe(s ? "mail_vkcomgroup_invite_link" : "mail_chat_invite_link"), a.inviteLink && we.createElement("span", {
                        className: "ChatSettingsMenu__invite"
                    }, we.createElement("span", {
                        className: "ChatSettingsMenu__hidden"
                    }, we.createElement("input", {
                        type: "text",
                        readOnly: !0,
                        value: a.inviteLink,
                        ref: this.getHiddenInput
                    })), we.createElement(Le.a, {
                        className: "ChatSettingsMenu__copied",
                        shown: this.state.copied,
                        callback: this.onBlinkTextHide
                    }, Qe("mail_invite_link_copied")), we.createElement(Ae.a, {
                        className: "ChatSettingsMenu__copy",
                        onClick: this.onCopyInviteLink
                    }, Qe("mail_get_invite_link_copy")))), u && we.createElement(ze.a, {
                        onClick: this.props.showSettings,
                        chevron: !0,
                        aside: we.createElement(Le.a, {
                            shown: n,
                            callback: r
                        }, Qe("global_changes_saved"))
                    }, we.createElement(Ve, {
                        type: "gear"
                    }), Qe("mail_settings_options"))))
                }, t
            }(we.Component),
            Xe = n("uW+i"),
            Ye = n("NsuH"),
            Je = n("As6E");

        function Ze(e, t) {
            if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return !t || "object" != typeof t && "function" != typeof t ? e : t
        }
        var $e = ke.a.getLang,
            et = function(e) {
                function t() {
                    var n, i;
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    for (var o = arguments.length, a = Array(o), s = 0; s < o; s++) a[s] = arguments[s];
                    return n = i = Ze(this, e.call.apply(e, [this].concat(a))), i.toggleAdmin = function() {
                        var e = i.props,
                            t = e.store,
                            n = e.mid,
                            o = e.adminMap,
                            a = t.get().peer,
                            s = !o[n];
                        t.set(r.ec.bind(null, a, n, s)), t.set(r.dc.bind(null, a, n, s))
                    }, i.kick = function() {
                        var e = i.props.store,
                            t = e.get().peer,
                            n = i.props.mid;
                        e.set(r.Ba.bind(null, t, n)), e.set(r.Aa.bind(null, t, n)).catch(function(e) {
                            Object(f.a)("ChatSettingsMemberEdit.kick", e)
                        })
                    }, i.changeAccess = function(e) {
                        var t = i.props.store,
                            n = t.get().peer,
                            o = i.props.mid;
                        t.set(r.n.bind(null, n, o, !e)).catch(function(e) {
                            Object(f.a)("ChatSettingsMemberEdit.changeAccess", e)
                        })
                    }, Ze(i, n)
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.getMemberRole = function(e, t) {
                    var n = this.props.storeData,
                        r = n.peer;
                    return t === n.tabs[r].ownerId ? $e("mail_settings_owner") : e[t] ? $e("mail_settings_admin") : null
                }, t.prototype.getActions = function(e) {
                    var t = window.vk.id,
                        n = this.props,
                        r = n.store,
                        i = n.mid,
                        a = [];
                    if (t === i) return [{
                        text: $e("mail_leave_chat"),
                        onClick: this.props.onLeave
                    }];
                    if (Object(L.e)(r, i) && a.push({
                            text: e[i] ? $e("mail_chat_remove_admin") : $e("mail_settings_appoint_admin"),
                            onClick: this.toggleAdmin
                        }), Object(L.i)(r, i) && a.push({
                            text: $e("mail_settings_kick"),
                            onClick: this.kick
                        }), Object(o.C)(i) && !e[i]) {
                        var s = Object(L.k)(r, r.get().peer, i),
                            c = s ? "mail_settings_community_mentions_only" : "mail_settings_community_full_access";
                        a.push({
                            text: $e(c),
                            onClick: this.changeAccess.bind(this, s)
                        })
                    }
                    return a
                }, t.prototype.render = function() {
                    var e = window.vk.id,
                        t = this.props,
                        n = t.adminMap,
                        r = t.storeData,
                        i = t.mid,
                        o = !!n[e],
                        a = this.getMemberRole(n, i),
                        s = e === i,
                        c = o && this.getActions(n);
                    return we.createElement(we.Fragment, null, a && we.createElement("span", {
                        className: "ChatSettingsMembersEdit__role"
                    }, a), c && c.length > 0 && we.createElement(Je.a, {
                        position: "b",
                        align: "right",
                        trigger: "hover",
                        marginTop: -8,
                        marginLeft: 1,
                        data: this.getActions(n)
                    }, we.createElement("span", {
                        className: "ChatSettingsMembersEdit__actions"
                    })), !o && !s && Object(L.i)(r, i) && we.createElement(Me.a, {
                        text: $e("mail_settings_kick"),
                        position: "t",
                        align: "right"
                    }, we.createElement("span", {
                        onClick: this.kick,
                        className: "ChatSettingsMembersEdit__kick"
                    })), !o && s && we.createElement(Me.a, {
                        text: $e("mail_leave_chat"),
                        position: "t",
                        align: "right"
                    }, we.createElement("span", {
                        onClick: this.props.onLeave,
                        className: "ChatSettingsMembersEdit__kick"
                    })))
                }, t
            }(we.Component);
        var tt = 50,
            nt = {
                appendParentCls: "ChatSettingsWrapper"
            },
            rt = window,
            it = rt.langSex,
            ot = rt.langNumeric,
            at = rt.getSmDate,
            st = ke.a.getLang,
            ct = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    ut.call(r);
                    var i = n.store.get(),
                        o = r.getMembers(i),
                        a = r.getAdmins(i);
                    return r.state = {
                        showSearch: !1,
                        searchQuery: "",
                        current: "all",
                        all: o,
                        allShowMore: o.length > tt,
                        admins: a,
                        adminsShowMore: a.length > tt
                    }, r.membersMap = o.reduce(function(e, t) {
                        return e[t] = !0, e
                    }, {}), r.searchIndexPromise = r.getSearchIndex(o).then(function(e) {
                        r.searchIndex = e
                    }), r.invitersCache = {}, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                    var t = this,
                        n = e.store.get(),
                        r = this.getMembers(n),
                        i = this.getAdmins(n),
                        o = {
                            removes: [],
                            additions: []
                        },
                        a = r.reduce(function(e, t) {
                            return e[t] = !0, e
                        }, {});
                    r.forEach(function(e) {
                        t.membersMap[e] || o.additions.push(e)
                    }), Object.keys(this.membersMap).forEach(function(e) {
                        a[e] || o.removes.push(e)
                    }), (o.removes.length || o.additions.length) && (this.updateSearchIndex(n, o), this.membersMap = a), this.setState({
                        all: r,
                        allShowMore: this.state.allShowMore && r.length > tt,
                        admins: i,
                        adminsShowMore: this.state.adminsShowMore && i.length > tt
                    })
                }, t.prototype.getMembers = function(e) {
                    var t = e.peer,
                        n = e.tabs[t],
                        r = -1 !== (n.memberIds || []).indexOf(n.ownerId),
                        i = (n.adminIds || []).reduce(function(e, t) {
                            return e[t] = !0, e
                        }, {});
                    return (r ? [n.ownerId] : []).concat((n.adminIds || []).filter(function(e) {
                        return e !== n.ownerId
                    }), (n.memberIds || []).filter(function(e) {
                        return e !== n.ownerId && !i[e]
                    }))
                }, t.prototype.getAdmins = function(e) {
                    var t = e.peer,
                        n = e.tabs[t];
                    return (-1 !== (n.memberIds || []).indexOf(n.ownerId) ? [n.ownerId] : []).concat((n.adminIds || []).filter(function(e) {
                        return e !== n.ownerId
                    }))
                }, t.prototype.getCurrentList = function() {
                    var e = this.props.store,
                        t = this.state,
                        n = t.current,
                        r = t.showSearch,
                        o = t.searchQuery;
                    if (r && o && this.searchIndex) return this.searchIndex.search(o);
                    var a = this.state[n],
                        s = Object(i.T)(e.get(), a);
                    return this.state[n + "ShowMore"] ? s.slice(0, tt) : s
                }, t.prototype.getSearchIndex = function(e) {
                    var t = window.vkIndexer,
                        n = Object(i.T)(this.props.store.get(), e);
                    return this.membersMap = n.reduce(function(e, t) {
                        return e[t.id] = !0, e
                    }, {}), new Promise(function(e, r) {
                        var i = new t(n, function(e) {
                            return e.name
                        }, function() {
                            e(i)
                        })
                    })
                }, t.prototype.updateSearchIndex = function(e, t) {
                    var n = Object(i.T)(e, t.removes),
                        r = Object(i.T)(e, t.additions);
                    (this.searchIndex ? Promise.resolve(this.searchIndex) : this.searchIndexPromise).then(function(e) {
                        n.forEach(function(t) {
                            e.remove(t)
                        }), r.forEach(function(t) {
                            e.add(t)
                        })
                    })
                }, t.prototype.componentDidMount = function() {
                    this.searchInput.addEventListener("keydown", this.onKeydown)
                }, t.prototype.componentWillUnmount = function() {
                    this.searchInput.removeEventListener("keydown", this.onKeydown)
                }, t.prototype.render = function() {
                    var e = this,
                        t = this.props,
                        n = t.store,
                        r = t.membersCount,
                        o = t.membersAdded,
                        a = t.onHideStatus,
                        s = this.state,
                        c = s.current,
                        u = s.showSearch,
                        l = s.searchQuery,
                        d = s.allShowMore,
                        _ = s.adminsShowMore,
                        f = n.get(),
                        p = f.peer,
                        m = f.tabs[p],
                        g = this.getCurrentList(),
                        h = this.isAddMemberWidgetShown() ? ["add"].concat(g) : g,
                        b = "all" === c ? d : _,
                        v = m.membersLastSeen,
                        y = {
                            "ChatSettingsMembersWidget--search": !!u
                        },
                        O = m.adminIds.reduce(function(e, t) {
                            return e[t] = !0, e
                        }, {});
                    return we.createElement("div", {
                        className: Object(Ce.a)("ChatSettingsMembersWidget", y)
                    }, we.createElement("header", {
                        className: "ChatSettingsMembersWidget__header"
                    }, we.createElement("input", {
                        placeholder: st("mail_members_search"),
                        className: "ChatSettingsMembersWidget__search",
                        onChange: this.onSearchChange,
                        onInput: this.onSearchChange,
                        onPaste: this.onSearchChange,
                        value: this.state.searchQuery,
                        ref: this.searchInputRef
                    }), we.createElement("button", {
                        className: "ChatSettingsMembersWidget__searchIcon",
                        onClick: this.onToggleSearch
                    }), we.createElement(Xe.a, {
                        className: "ChatSettingsMembersWidget__tabs",
                        onTabClick: this.onTabClick
                    }, we.createElement("span", {
                        key: "all"
                    }, st("mail_settings_everyone") + " ", we.createElement("span", {
                        className: "Tabs__desc"
                    }, Object(i.P)(m))), m.adminIds.length > 0 && we.createElement("span", {
                        key: "admins"
                    }, st("mail_settings_admins") + " ", we.createElement("span", {
                        className: "Tabs__desc"
                    }, m.adminIds.length)))), we.createElement("div", {
                        className: "ChatSettingsMembersWidget__list"
                    }, we.createElement(Fe.a, {
                        border: !1
                    }, h.length > 0 && h.map(function(t) {
                        if ("add" === t) return we.createElement(ze.a, {
                            selectable: !1,
                            border: !1,
                            key: "add",
                            onClick: e.props.showMembersSettings,
                            aside: we.createElement(Le.a, {
                                className: "ChatSettingsMembersWidget__blink",
                                shown: o,
                                callback: a
                            }, ot(r || 0, st("mail_settings_members_added", "raw")))
                        }, we.createElement("span", {
                            className: "ChatSettingsMembersWidget__add"
                        }, we.createElement("span", null, st("mail_settings_add_members"))));
                        var s = e.getInviter(t.id),
                            c = v && v[t.id] ? Object(i.V)(f, t.id, v[t.id], nt) : "";
                        return we.createElement(ze.a, {
                            selectable: !1,
                            border: !1,
                            aside: we.createElement(et, {
                                adminMap: O,
                                store: n,
                                storeData: f,
                                mid: t.id,
                                onLeave: e.props.onLeave
                            }),
                            key: t.id
                        }, we.createElement(Ye.a, {
                            photo: t.photo,
                            title: t.name,
                            description: we.createElement("span", {
                                title: s,
                                dangerouslySetInnerHTML: {
                                    __html: c
                                }
                            }),
                            href: t.link
                        }))
                    }), !h.length && u && l && we.createElement("div", {
                        className: "ChatSettingsMembersWidget__empty"
                    }, st("mail_settings_not_found")), !(u && l) && b && we.createElement("div", {
                        className: "ChatSettingsMembersWidget__more",
                        onClick: this.onShowMore
                    }, st("mail_settings_show_all_members")))))
                }, t
            }(we.Component),
            ut = function() {
                var e = this;
                this.onToggleSearch = function() {
                    e.state.showSearch ? e.setState({
                        showSearch: !1,
                        searchQuery: ""
                    }) : (e.setState({
                        showSearch: !0
                    }), requestAnimationFrame(function() {
                        e.searchInput.focus()
                    }))
                }, this.onSearchChange = function(t) {
                    t.target.value !== e.state.searchQuery && e.setState({
                        searchQuery: t.target.value
                    })
                }, this.onShowMore = function() {
                    var t = "all" === e.state.current ? "allShowMore" : "adminsShowMore";
                    e.state[t] && e.setState(function(e, t, n) {
                        return t in e ? Object.defineProperty(e, t, {
                            value: n,
                            enumerable: !0,
                            configurable: !0,
                            writable: !0
                        }) : e[t] = n, e
                    }({}, t, !1))
                }, this.onTabClick = function(t, n) {
                    t.preventDefault(), e.state.current !== n && e.setState({
                        current: n
                    })
                }, this.handleDocumentClick = function(t) {
                    !e.state.showSearch || e.state.searchQuery || t.target.closest(".ChatSettingsMembersWidget__search") || t.target.closest(".ChatSettingsMembersWidget__searchIcon") || e.setState({
                        showSearch: !1
                    })
                }, this.onKeydown = function(t) {
                    e.state.showSearch && 27 === t.keyCode && (e.searchInput.blur(), e.setState({
                        showSearch: !1,
                        searchQuery: ""
                    }), t.preventDefault(), t.stopPropagation())
                }, this.getInviter = function(t) {
                    if (e.invitersCache[t]) return e.invitersCache[t];
                    var n = e.props.store.get(),
                        r = n.peer,
                        o = n.tabs[r],
                        a = o.inviters;
                    if (!a[t]) return "";
                    var s = Object(i.T)(n, [a[t][0]])[0],
                        c = at(a[t][2], n.timeshift, !0);
                    if (Object(L.n)(o, t)) return e.invitersCache[t] = st("mail_settings_owner"), st("mail_settings_owner");
                    if (!s) return e.invitersCache[t] = c, c;
                    var u = it(a[t][1], st("mail_chat_member_invited_by_X", "raw")).replace(/{inviter}/, replaceEntities(s.name)) + " " + c;
                    return e.invitersCache[t] = u, u
                }, this.isAddMemberWidgetShown = function() {
                    var t = window.vk.id,
                        n = e.props.store,
                        r = n.get().peer,
                        i = e.state,
                        o = i.current,
                        a = i.showSearch,
                        s = i.searchQuery;
                    return "all" === o && !(a && "" !== s) && Object(L.h)(n, r, t)
                }, this.searchInputRef = function(t) {
                    e.searchInput = t
                }
            },
            lt = ct,
            dt = n("FABD"),
            _t = n("DM26");

        function ft(e, t, n) {
            return t in e ? Object.defineProperty(e, t, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = n, e
        }
        var pt = ke.a.getLang,
            mt = window,
            gt = mt.showFastBox,
            ht = mt.unclean,
            bt = function() {},
            vt = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var i = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return i.onChange = function(e) {
                        var t = i.props.store.get(),
                            n = e.target.value;
                        Object(r.Fb)(n, t).then(function(e) {
                            return i.setSearchResults({}, !1, n, e), n ? (i.isSearching = !0, i.serverSearch(n, e.map(function(e) {
                                return e.peerId
                            }))) : Promise.resolve([])
                        }).then(i.appendSearchResults).catch(function() {})
                    }, i.serverSearch = Object(_t.b)(function(e, t) {
                        var n = i.props.store;
                        return Object(r.Cb)(e, t, "friends", n.get())
                    }, 300), i.onRemoveToken = function(e) {
                        return new Promise(function(t) {
                            var n = i.state.selected.filter(function(t) {
                                return t !== e
                            });
                            i.selected = n.reduce(function(e, t) {
                                return e[t] = !0, e
                            }, {}), i.setState({
                                selected: n
                            }, t)
                        })
                    }, i.onSelect = function(e) {
                        return new Promise(function(t) {
                            var n = i.selected[e] ? i.state.selected.filter(function(t) {
                                return t !== e
                            }) : [].concat(i.state.selected, e).filter(function(e, t, n) {
                                return n.indexOf(e) === t
                            });
                            i.selected = n.reduce(function(e, t) {
                                return e[t] = !0, e
                            }, {}), i.resetSearch({
                                selected: n,
                                value: ""
                            }, t)
                        })
                    }, i.onAddPeople = function() {
                        var e = i.props.store,
                            t = e.get().peer,
                            n = i.state.selected.map(function(e) {
                                return parseInt(e)
                            });
                        i.setState({
                            loading: !0
                        }), e.set(r.i.bind(null, t, n)).then(function() {
                            return e.set(r.L.bind(null, t)).then(function() {
                                i.selected = {}, i.resetSearch({
                                    selected: [],
                                    loading: !1
                                }, function() {
                                    i.props.afterSave(n.length)
                                })
                            })
                        }).catch(function(e) {
                            i.selected = {}, i.resetSearch({
                                selected: [],
                                loading: !1
                            }), gt(pt("global_error"), e)
                        })
                    }, i.setSearchResults = function(e, t, n, r) {
                        var a = i.props.store.get(),
                            s = Object(o.t)(a, a.peer),
                            c = [];
                        r.forEach(function(e) {
                            i.data[e.peerId] || (i.data[e.peerId] = e), -1 === s.memberIds.indexOf(e.peerId) && c.push(e.peerId)
                        }), i.setState(Object.assign({}, e, {
                            found: c,
                            value: n
                        }), t || bt)
                    }, i.appendSearchResults = function(e) {
                        var t = i.props.store.get(),
                            n = Object(o.t)(t, t.peer),
                            r = i.state.found;
                        e.forEach(function(e) {
                            i.data[e.peerId] || (i.data[e.peerId] = e), -1 === n.memberIds.indexOf(e.peerId) && -1 === r.indexOf(e.peerId) && r.push(e.peerId)
                        }), i.isSearching = !1, i.setState({
                            found: r
                        })
                    }, i.state = {
                        selected: [],
                        value: "",
                        loading: !1,
                        found: []
                    }, i.data = {}, i.selected = {}, i
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.resetSearch = function(e, t) {
                    return Object(r.Fb)("", this.props.store.get()).then(this.setSearchResults.bind(this, e, t, ""))
                }, t.prototype.componentDidMount = function() {
                    this.resetSearch()
                }, t.prototype.render = function() {
                    var e, t = this,
                        n = Object.keys(this.state.selected).length;
                    return we.createElement("div", {
                        className: "ChatSettingsMembers"
                    }, we.createElement(dt.a, (ft(e = {
                        className: "ChatSettingsMembers__multiSelect",
                        tokens: this.state.selected.map(function(e) {
                            return {
                                text: ht(t.data[e].name),
                                id: e
                            }
                        }),
                        removeTokenPlaceholder: pt("mail_create_chat_remove_user"),
                        onRemoveToken: this.onRemoveToken,
                        placeholder: pt("mail_search_creation"),
                        value: this.state.value,
                        useInfiniteScroll: !1,
                        onChange: this.onChange,
                        onSelect: this.onSelect
                    }, "useInfiniteScroll", !0), ft(e, "hasMore", !1), ft(e, "virtualized", !0), ft(e, "loadMore", function() {}), ft(e, "notFoundText", pt("mail_not_found")), ft(e, "autoFocus", !0), ft(e, "isSearching", this.isSearching), e), this.state.found.map(function(e) {
                        return we.createElement("div", {
                            className: Object(Ce.a)("ChatSettingsMembers__entity", ft({}, "ChatSettingsMembers__entity--selected", t.selected[e])),
                            key: e,
                            "data-id": e
                        }, we.createElement(Ye.a, {
                            size: "34",
                            title: t.data[e].name,
                            photo: t.data[e].photo
                        }))
                    })), we.createElement(He.a, {
                        alignment: "right"
                    }, we.createElement(We.a, {
                        disabled: 0 === n,
                        onClick: this.onAddPeople,
                        loading: this.state.loading
                    }, pt(n < 2 ? "mail_append_chat" : "mail_im_create_chat_with"))))
                }, t
            }(we.Component),
            yt = n("mSoV");
        var Ot = Math.log2 || function(e) {
                return Math.log(e) / Math.LN2
            },
            jt = ke.a.getLang,
            wt = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.onChange = function(e) {
                        var t = e.name,
                            n = e.selected.value,
                            i = r.state.flags;
                        r.setState({
                            flags: n ? i | 1 << t : i & ~(1 << t)
                        })
                    }, r.onCancel = function() {
                        r.setState({
                            flags: r.props.tab.data.flags
                        }), r.props.back()
                    }, r.onSave = function() {
                        r.state.loading || (r.setState({
                            loading: !0
                        }), r.props.onSave(r.state.flags).then(function() {
                            r.setState({
                                loading: !1
                            }, r.props.afterSave)
                        }).catch(function(e) {
                            r.setState({
                                loading: !1,
                                flags: r.props.tab.data.flags
                            })
                        }))
                    }, r.state = {
                        flags: n.tab.data.flags,
                        loading: !1
                    }, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.render = function() {
                    var e = this,
                        t = this.props.tab,
                        n = this.state.flags,
                        r = [{
                            value: !0,
                            label: jt("mail_settings_only_admins")
                        }, {
                            value: !1,
                            label: jt("mail_settings_all_members")
                        }],
                        i = t.serverSettings;
                    return we.createElement("div", {
                        className: "ChatSettingsOptions"
                    }, we.createElement(Fe.a, null, we.createElement(ze.a, {
                        selectable: !1,
                        aside: we.createElement(yt.a, {
                            className: "ChatSettingsOptions__select",
                            onChange: this.onChange,
                            name: Ot(L.c),
                            options: r,
                            value: !!(n & L.c)
                        })
                    }, we.createElement(Ve, {
                        type: "plus"
                    }), jt("mail_settings_can_invite")), we.createElement(ze.a, {
                        selectable: !1,
                        aside: we.createElement(yt.a, {
                            className: "ChatSettingsOptions__select",
                            onChange: this.onChange,
                            name: Ot(L.b),
                            options: r,
                            value: !!(n & L.b)
                        })
                    }, we.createElement(Ve, {
                        type: "pencil"
                    }), jt("mail_settings_can_edit_info")), we.createElement(ze.a, {
                        selectable: !1,
                        aside: we.createElement(yt.a, {
                            className: "ChatSettingsOptions__select",
                            onChange: this.onChange,
                            name: Ot(L.d),
                            options: r,
                            value: !!(n & L.d)
                        })
                    }, we.createElement(Ve, {
                        type: "pin"
                    }), jt("mail_settings_can_pin")), we.createElement(ze.a, {
                        selectable: !1,
                        aside: we.createElement(yt.a, {
                            className: "ChatSettingsOptions__longselect",
                            onChange: this.onChange,
                            name: Ot(L.a),
                            options: [{
                                value: !1,
                                label: jt("mail_settings_only_owner")
                            }, {
                                value: !0,
                                label: jt("mail_settings_owner_and_admins")
                            }],
                            value: !!(n & L.a)
                        })
                    }, we.createElement(Ve, {
                        type: "user"
                    }), jt("mail_settings_admins_can_add_admins")), i.map(function(t) {
                        return we.createElement(ze.a, {
                            selectable: !1,
                            key: t.name,
                            aside: we.createElement(yt.a, {
                                className: "ChatSettingsOptions__select",
                                onChange: e.onChange,
                                name: Ot(t.bit),
                                options: t.options,
                                value: !!(n & t.bit)
                            })
                        }, we.createElement(Ve, {
                            type: t.icon
                        }), t.name)
                    })), we.createElement(He.a, {
                        alignment: "right"
                    }, we.createElement(Pe.a, {
                        appearance: "tertiary",
                        onClick: this.onCancel
                    }, jt("global_cancel")), we.createElement(We.a, {
                        onClick: this.onSave,
                        loading: this.state.loading
                    }, jt("global_save"))))
                }, t
            }(we.Component),
            Et = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }();
        var kt = 0,
            Ct = 2,
            xt = 300,
            Pt = ke.a.getLang,
            Mt = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var o = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return o.showInvitationLink = function() {
                        var e = o.props.store.get(),
                            t = e.peer;
                        return o.setState({
                            invitationLoading: !0
                        }), Object(r.M)(t - 2e9, e).then(function(e) {
                            var t = Et(e, 1)[0];
                            o.setState({
                                section: Ct,
                                invitationLoading: !1,
                                invitationLink: t
                            })
                        })
                    }, o.onUpdateFlags = function(e) {
                        var t = o.props.store.get(),
                            n = t.peer;
                        return Object(r.tc)(n, e, t)
                    }, o.afterUpdateFlags = function() {
                        o.go(kt, function() {
                            return o.setBlinkStatus({
                                flagsUpdated: !0
                            })
                        })
                    }, o.afterMembersAdded = function(e) {
                        o.go(kt, function() {
                            return o.setBlinkStatus({
                                membersAdded: !0,
                                membersCount: e
                            })
                        })
                    }, o.setBlinkStatus = function(e) {
                        o.timers.push(setTimeout(function() {
                            return o.setState(e)
                        }, xt))
                    }, o.onHideStatus = function() {
                        o.setState({
                            membersAdded: !1,
                            flagsUpdated: !1
                        })
                    }, o.onLeave = function() {
                        var e = o.props,
                            t = e.store,
                            n = e.closePopup,
                            a = t.get().peer,
                            s = Object(i.Pa)(t, a),
                            u = showFastBox({
                                title: Pt(s ? "mail_leave_channel" : "mail_chat_leave_title"),
                                dark: 1
                            }, Pt(s ? "mail_vkcomgroup_leave_confirm" : "mail_chat_leave_confirm"), Pt(s ? "mail_leave_channel" : "mail_leave_chat"), function() {
                                t.set(r.nc.bind(null, a)), t.set(r.Ca.bind(null, a)), u.hide(), n(), t.get().longpoll.push([Object(c.ab)()])
                            }, Pt("global_cancel"), function() {
                                u.hide()
                            })
                    }, o.onResetLink = function() {
                        var e = o.props.store.get(),
                            t = e.peer;
                        return Object(r.rb)(t, e).then(function(e) {
                            var t = Et(e, 1)[0];
                            o.setState({
                                invitationLink: t,
                                invitationLinkReseted: !0
                            })
                        })
                    }, o.onShowAttachments = function() {
                        var e = o.props.store.get().peer;
                        window.showWiki({
                            w: "history" + Object(i.H)(e) + "_photo"
                        }, null, {})
                    }, o.state = {
                        section: kt,
                        invitationLink: null,
                        invitationLinkReseted: !1,
                        membersAdded: !1,
                        flagsUpdated: !1
                    }, o.timers = [], o
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.go = function(e, t) {
                    var n = this;
                    this.setState({
                        section: e
                    }, function() {
                        n.props.updatePopup(), t && t()
                    })
                }, t.prototype.getPopupTitle = function() {
                    switch (this.state.section) {
                        case 1:
                            return Pt("mail_settings_add_members");
                        case Ct:
                        case 3:
                            return Pt("mail_chat_invite_link");
                        case 6:
                            return Pt("mail_settings_options");
                        default:
                            return Pt("mail_settings_title")
                    }
                }, t.prototype.componentWillReceiveProps = function(e) {
                    var t = this,
                        n = e.store.get(),
                        i = n.peer,
                        o = n.tabs[i];
                    o.photoLarge || o.photoGrid || this.resync || (this.resync = !0, e.store.set(r.L.bind(null, i)).then(function() {
                        t.resync = !0
                    }))
                }, t.prototype.componentDidMount = function() {
                    this.props.updatePopup()
                }, t.prototype.componentWillUnmount = function() {
                    this.timers.forEach(clearTimeout)
                }, t.prototype.render = function() {
                    var e = this,
                        t = this.props,
                        n = t.store,
                        r = t.closePopup,
                        o = n.get(),
                        a = o.peer,
                        s = o.tabs[a],
                        c = Object(i.Pa)(n, a),
                        u = !c || !n.get().gid,
                        l = Pt(c ? "mail_im_n_vkcomgroup_members" : "mail_im_n_chat_members", Object(i.P)(s));
                    return we.createElement("section", {
                        className: "ChatSettings"
                    }, we.createElement(xe, {
                        title: this.getPopupTitle(),
                        back: this.state.section !== kt ? Pt("global_back") : void 0,
                        onCloseClick: r,
                        onBackClick: function() {
                            return e.go(kt)
                        }
                    }), this.state.section === kt && we.createElement("div", {
                        className: "ChatSettings__content"
                    }, we.createElement(De, {
                        store: n,
                        photo: s.photoLarge,
                        grid: s.photoGrid,
                        title: s.name,
                        flags: s.data.flags,
                        meta: l,
                        description: ""
                    }), we.createElement(Ge, {
                        store: n,
                        showNotificationSettings: function() {},
                        showMembersSettings: function() {
                            return e.go(1)
                        },
                        showAttachments: this.onShowAttachments,
                        showInvitationLink: this.showInvitationLink,
                        showSettings: function() {
                            return e.go(6)
                        },
                        membersAdded: this.state.membersAdded,
                        membersCount: this.state.membersCount,
                        flagsUpdated: this.state.flagsUpdated,
                        onHideStatus: this.onHideStatus
                    }), c ? null : we.createElement("div", {
                        className: "ChatSettings__pane"
                    }, we.createElement(lt, {
                        store: n,
                        onLeave: this.onLeave,
                        showMembersSettings: function() {
                            return e.go(1)
                        },
                        membersAdded: this.state.membersAdded,
                        onHideStatus: this.onHideStatus,
                        membersCount: this.state.membersCount
                    })), u && we.createElement("div", {
                        className: "ChatSettings__pane"
                    }, we.createElement(Pe.a, {
                        appearance: ["link", "mobile"],
                        className: "ChatSettings__leave",
                        onClick: this.onLeave
                    }, Pt(c ? "mail_leave_channel" : "mail_settings_leave")))), 1 === this.state.section && we.createElement(vt, {
                        store: n,
                        afterSave: this.afterMembersAdded
                    }), 6 === this.state.section && we.createElement(wt, {
                        tab: s,
                        back: function() {
                            return e.go(kt)
                        },
                        onSave: this.onUpdateFlags,
                        afterSave: this.afterUpdateFlags
                    }), this.state.section === Ct && we.createElement(Ue, {
                        store: n,
                        onReset: function() {
                            return e.go(3)
                        },
                        reseted: this.state.invitationLinkReseted,
                        invitationLink: this.state.invitationLink
                    }), 3 === this.state.section && we.createElement(qe, {
                        onConfirm: this.onResetLink,
                        onCancel: function() {
                            return e.go(Ct)
                        }
                    }))
                }, t
            }(we.Component),
            Tt = window,
            It = Tt.MessageBox,
            St = Tt.show,
            Dt = Tt.hide,
            Bt = Tt.isVisible,
            Lt = Tt.boxRefreshCoords,
            At = void 0;

        function Rt(e) {
            var t = Wt();
            t && Ee.render(we.createElement(Mt, {
                store: e,
                closePopup: Nt,
                updatePopup: Ut
            }), t)
        }

        function Nt() {
            At && At.hide()
        }

        function Ut() {
            At && At.updateBoxCoords()
        }

        function Wt() {
            return document.querySelector("#ChatSettings")
        }

        function Ht(e) {
            var t = document.querySelector("#box_layer_wrap"),
                n = document.querySelector("#box_loader"),
                r = Bt(t);
            return {
                unmount: function() {
                    var t = Wt();
                    t && Ee.unmountComponentAtNode(t), Object(s.c)(e)
                },
                showLoader: function() {
                    Lt(n), St(n), r || St(t)
                },
                hideLoader: function() {
                    Dt(n), r || Dt(t)
                }
            }
        }

        function Kt(e, t, n) {
            var i = Object(s.b)(Ht).bindMutations,
                a = t.get(),
                c = Object(s.a)({
                    handlers: function(e, t) {}
                }),
                u = a.peer,
                l = i(c);
            var d = function(e, t) {
                    t.get().peer === u ? function(e) {
                        var t = Object(o.t)(e, e.get().peer);
                        t && t.data && !t.data.closed && !t.data.kicked ? Rt(e) : Nt()
                    }(t) : e.unmount()
                }.bind(null, l),
                _ = {
                    hideButtons: !0,
                    bodyStyle: "padding: 0; background: none;",
                    width: 560,
                    onShow: function() {
                        Rt(t), t.subscribe(d), requestAnimationFrame(function() {
                            return At.updateBoxCoords()
                        })
                    },
                    onHideAttempt: function() {
                        return t.unsubscribe(d), l.unmount(), !0
                    }
                };
            return l.showLoader(), t.set(r.L.bind(null, u)).then(function(e) {
                l.hideLoader();
                var t = Object(g.r)(e).peer;
                t && t === u ? At = new It(_).content('<div id="ChatSettings" class="ChatSettingsWrapper"></div>').show() : l.unmount()
            }), l
        }
        var qt = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

        function Ft(e, t) {
            if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return !t || "object" != typeof t && "function" != typeof t ? e : t
        }
        var zt = we.createContext(),
            Vt = zt.Provider,
            Qt = zt.Consumer,
            Gt = Vt;

        function Xt(e) {
            return function(t) {
                function n() {
                    var e, r;
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, n);
                    for (var i = arguments.length, o = Array(i), a = 0; a < i; a++) o[a] = arguments[a];
                    return e = r = Ft(this, t.call.apply(t, [this].concat(o))), r.onUpdate = function() {
                        r.setState({})
                    }, Ft(r, e)
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(n, t), n.prototype.componentDidMount = function() {
                    this.store.subscribe(this.onUpdate)
                }, n.prototype.componentWillUnmount = function() {
                    this.store.unsubscribe(this.onUpdate)
                }, n.prototype.render = function() {
                    var t = this;
                    return we.createElement(Qt, null, function(n) {
                        return t.store || (t.store = n), we.createElement(e, qt({}, t.props, {
                            store: n
                        }))
                    })
                }, n
            }(we.Component)
        }
        var Yt = n("vRp6"),
            Jt = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };

        function Zt(e, t) {
            if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return !t || "object" != typeof t && "function" != typeof t ? e : t
        }
        var $t = function(e) {
                function t() {
                    var n, r;
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    for (var i = arguments.length, o = Array(i), a = 0; a < i; a++) o[a] = arguments[a];
                    return n = r = Zt(this, e.call.apply(e, [this].concat(o))), r.getRef = function(e) {
                        r.element = e && e.element
                    }, Zt(r, n)
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.render = function() {
                    var e = this.props,
                        t = e.className,
                        n = function(e, t) {
                            var n = {};
                            for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                            return n
                        }(e, ["className"]);
                    return we.createElement(Be.a, Jt({}, n, {
                        className: Object(Ce.a)(t, "BlockSearchInput"),
                        ref: this.getRef
                    }))
                }, t
            }(we.Component),
            en = $t;
        $t.defaultProps = Be.a.defaultProps;
        var tn = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.onError = function() {
                        r.setState({
                            errored: !0
                        })
                    }, r.state = {}, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.render = function() {
                    var e = this.props,
                        t = e.photo,
                        n = e.title,
                        r = e.online;
                    return we.createElement("div", {
                        className: Object(Ce.a)("Avatar", {
                            "Avatar--online": r,
                            "Avatar--mobile": mobPlatforms[r]
                        })
                    }, we.createElement("div", {
                        className: "Avatar__wrapper"
                    }, we.createElement("img", {
                        onError: this.onError,
                        className: "Avatar__img",
                        src: this.state.errored ? "/images/camera_c.gif" : t,
                        alt: n
                    })))
                }, t
            }(we.Component),
            nn = n("ThPM"),
            rn = n("7p7+"),
            on = n("PjZB"),
            an = n("rjmT"),
            sn = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            },
            cn = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }();
        var un = Object(_t.b)(r.Cb, 300),
            ln = window,
            dn = ln.Emoji,
            _n = ln.langNumeric,
            fn = ke.a.getLang,
            pn = 38,
            mn = 27,
            gn = 40,
            hn = 13,
            bn = Xt(function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var a = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return a.toggleMode = function() {
                        var e = a.props.store;
                        if (Object(o.B)(e)) {
                            var t = 0 === a.state.mode ? 1 : 0,
                                n = 0 === t ? r.Eb : r.Ib;
                            a.setState({
                                value: "",
                                mode: t,
                                loading: !0,
                                selected: null,
                                found: []
                            }, function() {
                                return n("", e.get()).then(function(e) {
                                    return a.setSearchResults(a.filterResults(e))
                                }).then(function() {
                                    return a.searchInput.focus()
                                }).catch(function(e) {
                                    return console.error(e)
                                })
                            })
                        }
                    }, a.onChange = function(e) {
                        a.setState({
                            value: e.target.value,
                            loading: !0,
                            error: null
                        });
                        var t = e.target.value;
                        a.searchQuery !== t && (a.searchQuery = t, a.onSearch(t))
                    }, a.filterResults = function(e) {
                        var t = Object(o.B)(a.props.store) && 1 === a.state.mode;
                        return e.filter(function(e) {
                            var n = e.peerId;
                            return !(t && n < 0) && (!(t && n > 2e9 && !Object(L.m)(e, 1024)) && !(!t && n > 2e9 && Object(L.m)(e, 1024)))
                        })
                    }, a.onSearch = function(e) {
                        var t = a.props.store,
                            n = t.get(),
                            i = Object(o.B)(t) && 0 === a.state.mode,
                            s = i ? r.Eb : r.Ib;
                        return 1 === a.state.mode && "" === e ? a.emptySearch().then(function(e) {
                            a.setSearchResults(a.filterResults(e))
                        }) : s(e, n).then(function(t) {
                            var r = t.map(function(e) {
                                return e.peerId
                            });
                            return t = a.filterResults(t), a.setSearchResults(t, !1, !t.length), e ? un(e, r, "all", {
                                hidegid: i
                            }, n) : Promise.resolve([])
                        }).then(function(t) {
                            e === a.state.value && a.setSearchResults(a.filterResults(t), !0)
                        }).catch(function() {})
                    }, a.emptySearch = function() {
                        var e = a.props.store,
                            t = e.get(),
                            n = t.dialog_tabs.all,
                            i = {},
                            s = {};
                        return Object(r.Ib)("", t).then(function(r) {
                            return r.forEach(function(e) {
                                s[e.peerId] = e
                            }), [t.peer].concat(n.filter(function(e) {
                                return e != t.peer
                            })).map(function(t) {
                                var n = Object(o.t)(e, t);
                                return i[t] = !0, {
                                    name: s[t] && s[t].name || n.name,
                                    photo: s[t] && s[t].photo || n.photo,
                                    data: n.data,
                                    peerId: t
                                }
                            }).concat(r.filter(function(e) {
                                return !i[e.peerId]
                            }))
                        })
                    }, a.sendRecipient = function(e) {
                        var t = a.props.store,
                            n = t.get();
                        1 === a.state.mode ? (n.longpoll.push([Object(c.Ba)(e, !1, !0, !0, "forward_messages_popup")]), Object(ye.e)(t), Object(o.B)(t) && Object(ye.g)(t, !1)) : a.setState({
                            selected: e,
                            error: null
                        }, function() {
                            dn.focus(a.input)
                        })
                    }, a.cleanSelectedRecipient = function() {
                        a.setState({
                            activeElement: -1
                        })
                    }, a.scrollToSelectedUser = function() {
                        var e = a.state,
                            t = e.found,
                            n = e.activeElement,
                            r = a.scrollContainer;
                        if (r) {
                            var i = r.querySelector('[data-id="' + t[n].peerId + '"]');
                            if (i)
                                if (i.offsetTop < r.scrollTop) r.scrollTop = i.offsetTop;
                                else {
                                    var o = i.offsetTop + i.offsetHeight;
                                    o > r.scrollTop + r.offsetHeight && (r.scrollTop = o - r.offsetHeight)
                                }
                            else r.scrollTop = (r.childNodes[1].offsetHeight || 0) * n
                        }
                    }, a.selectRecipient = function(e) {
                        var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],
                            n = a.validateActiveElement(e);
                        a.state.activeElement !== n && a.setState({
                            activeElement: n
                        }, function() {
                            t && a.scrollToSelectedUser()
                        })
                    }, a.onClick = function(e) {
                        return a.sendRecipient(Number(e.currentTarget.getAttribute("data-id")))
                    }, a.loadMore = function() {}, a.setSearchResults = function(e, t) {
                        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                        if (!a.unmounted)
                            if (t) {
                                var r = e.filter(function(e) {
                                    return !a.found[e.peerId]
                                });
                                r.forEach(function(e) {
                                    a.found[e.peerId] = !0
                                }), a.setState({
                                    found: [].concat(a.state.found, r),
                                    loading: n
                                })
                            } else a.found = e.reduce(function(e, t) {
                                return e[t.peerId] = !0, e
                            }, {}), a.setState({
                                found: e,
                                loading: n,
                                activeElement: 0
                            })
                    }, a.getFormRef = function(e) {
                        a.form = e
                    }, a.getInputRef = function(e) {
                        a.input = e
                    }, a.getSearchRef = function(e) {
                        a.searchInput = e && e.element
                    }, a.getScrollContainerRef = function(e) {
                        a.scrollContainer = Ee.findDOMNode(e)
                    }, a.getEmojiButtonRef = function(e) {
                        a.emojiButton = e
                    }, a.onEmojiButtonMouseOver = function(e) {
                        e.persist(), dn.show(a.emojiButton, e)
                    }, a.onEmojiButtonMouseOut = function(e) {
                        e.persist(), dn.hide(a.emojiButton, e)
                    }, a.send = function() {
                        var e = a.props.store,
                            t = a.state.selected,
                            n = dn.val(a.input).trim(),
                            s = new an.a({}, 0),
                            c = e.get().pendingForward;
                        if (t && !Object(i.Sa)(val)) {
                            a.setState({
                                sending: !0
                            });
                            var u = Object(o.B)(e) && 0 === a.state.mode;
                            u || s.addAttach("mail", c.msgIds.join(";"), c.object || null);
                            var l = {
                                    message: n,
                                    attaches: s.dData.attaches.map(function(e) {
                                        return [e.type, e.id]
                                    }) || []
                                },
                                d = {
                                    hidegid: !0,
                                    external: {
                                        original_gid: e.get().id,
                                        fwd_group_msg_ids: u ? c.msgIds.join(";") : void 0
                                    }
                                };
                            new Promise(function(n) {
                                Object(r.Ja)([t], {
                                    hidegid: !0
                                }, e.get()).then(function(e) {
                                    var r = cn(e, 1)[0];
                                    return n(r[t])
                                })
                            }).then(function(n) {
                                return e.set(r.Lb.bind(null, t, l, sn({
                                    hash: n
                                }, d)))
                            }).then(function() {
                                Object(ye.g)(e, !0), e.setState({
                                    pendingForward: null
                                }), a.props.closePopup(), showDoneBox(fn("mail_send3"))
                            }).catch(function(e) {
                                a.unmounted || a.setState({
                                    sending: !1
                                }, function() {
                                    showFastBox(fn("mail_error"), e)
                                })
                            })
                        }
                    }, a.onSearchKeyDown = function(e) {
                        e.keyCode === mn && a.state.value && (a.searchInput.blur(), a.searchQuery = "", a.setState({
                            value: "",
                            loading: !0,
                            error: null
                        }, a.onSearch.bind(a, "")), e.stopPropagation())
                    }, a.onMessageInputKeyDown = function(e) {
                        e.keyCode === mn && (a.state.sending || (dn.val(a.input, ""), a.setState({
                            selected: null
                        }), a.searchInput.focus()), e.stopPropagation())
                    }, a.onKeydown = function(e) {
                        var t = a.state.activeElement;
                        switch (e.which || e.keyCode) {
                            case pn:
                                a.selectRecipient(t - 1), e.preventDefault();
                                break;
                            case gn:
                                a.selectRecipient(t + 1), e.preventDefault();
                                break;
                            case hn:
                                var n = a.state,
                                    r = n.found,
                                    i = n.activeElement;
                                r[i] && (a.sendRecipient(r[i].peerId), e.preventDefault())
                        }
                    }, a.state = {
                        value: "",
                        found: [],
                        mode: 1,
                        loading: !0,
                        sending: !1,
                        selected: null,
                        activeElement: 0
                    }, a.emptySearch().then(function(e) {
                        a.setSearchResults(a.filterResults(e))
                    }).catch(function(e) {
                        return console.error(e)
                    }), a
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.getMembersCount = function(e) {
                    if (!Object(i.Ha)(e)) return "";
                    var t = this.props.store,
                        n = Object(o.t)(t, e);
                    return n && n.membersCount ? _n(n.membersCount, fn("mail_im_n_chat_members", "raw")) : ""
                }, t.prototype.validateActiveElement = function(e) {
                    return e > this.state.found.length - 1 ? this.state.found.length - 1 : e < 0 ? 0 : e
                }, t.prototype.componentDidMount = function() {
                    this.props.updatePopup(), dn.init(this.input, {
                        noStickers: !0,
                        onSend: this.send
                    }), this.input.addEventListener("keydown", this.onMessageInputKeyDown), this.searchInput.addEventListener("keydown", this.onKeydown), this.searchInput.addEventListener("keydown", this.onSearchKeyDown)
                }, t.prototype.componentWillUnmount = function() {
                    this.input.removeEventListener("keydown", this.onMessageInputKeyDown), this.searchInput.removeEventListener("keydown", this.onKeydown), this.searchInput.removeEventListener("keydown", this.onSearchKeyDown), this.unmounted = !0
                }, t.prototype.render = function() {
                    var e = this,
                        t = this.props,
                        n = t.store,
                        r = t.closePopup,
                        i = this.state,
                        a = i.mode,
                        s = i.loading,
                        c = i.selected,
                        u = i.found,
                        l = i.sending,
                        d = i.activeElement;
                    return we.createElement("section", {
                        className: Object(Ce.a)("MessageForward", {
                            "MessageForward--form": 0 === a && !!c
                        })
                    }, we.createElement(xe, {
                        title: we.createElement(we.Fragment, null, we.createElement("span", {
                            className: "MessageForward__title"
                        }, fn("mail_forward_messages")), Object(o.B)(n) && we.createElement("span", {
                            className: "MessageForward__switch",
                            onClick: this.toggleMode
                        }, fn(0 === a ? "mail_forward_to_community_messages" : "mail_forward_to_im"))),
                        onCloseClick: r
                    }), we.createElement("div", {
                        className: "MessageForward__content",
                        onMouseLeave: this.cleanSelectedRecipient
                    }, we.createElement(en, {
                        value: this.state.value,
                        onChange: this.onChange,
                        placeholder: fn("mail_top_search"),
                        autoFocus: !0,
                        key: "search",
                        ref: this.getSearchRef
                    }), s && we.createElement("div", {
                        className: "MessageForward__results",
                        key: "loading"
                    }, we.createElement(rn.a, {
                        className: "MessageForward__stub"
                    }, we.createElement(on.a, null))), !s && 0 === u.length && we.createElement("div", {
                        className: "MessageForward__results",
                        key: "no-results"
                    }, we.createElement(rn.a, null, fn("mail_im_search_empty_chats"))), !s && u.length > 0 && we.createElement(Yt.a, {
                        virtualized: !0,
                        className: "MessageForward__results",
                        loadMore: this.loadMore,
                        hasMore: !1,
                        ref: this.getScrollContainerRef,
                        key: "results"
                    }, u.map(function(t, r) {
                        var i = t.peerId,
                            s = t.name,
                            u = t.photo,
                            l = t.online;
                        return we.createElement(ze.a, {
                            key: i,
                            "data-id": i,
                            onClick: e.onClick,
                            chevron: 1 === a,
                            active: r === d,
                            canBeHovered: !1,
                            onMouseEnter: e.selectRecipient.bind(null, r, !1),
                            aside: 0 === a ? we.createElement("span", {
                                className: Object(Ce.a)("MessageForward__radio", {
                                    "MessageForward__radio--selected": +c === i
                                })
                            }) : ""
                        }, we.createElement(Ye.a, {
                            size: "34",
                            title: s,
                            photo: Array.isArray(u) ? we.createElement(nn.a, {
                                photos: u
                            }) : we.createElement(tn, {
                                online: (Object(o.t)(n, i) || {}).online || l,
                                title: s,
                                photo: u
                            }),
                            description: e.getMembersCount(i)
                        }))
                    })), we.createElement("footer", {
                        className: "MessageForward__footer",
                        ref: this.getFormRef,
                        key: "footer"
                    }, we.createElement("div", {
                        className: "MessageForward__form _emoji_field_wrap"
                    }, we.createElement("div", {
                        className: "MessageForward__input",
                        tabIndex: "0",
                        contentEditable: !0,
                        role: "textbox",
                        "aria-multiline": !0,
                        ref: this.getInputRef,
                        placeholder: fn("mail_im_enter_msg")
                    }), we.createElement("div", {
                        className: "MessageForward__emoji emoji_smile_wrap _emoji_wrap"
                    }, we.createElement("div", {
                        ref: this.getEmojiButtonRef,
                        className: "emoji_smile _emoji_btn",
                        title: fn("global_emoji_hint"),
                        onMouseOver: this.onEmojiButtonMouseOver,
                        onMouseOut: this.onEmojiButtonMouseOut,
                        onClick: this.onEmojiButtonClick
                    }, we.createElement("div", {
                        className: "emoji_smile_icon_vector emoji_smile_icon"
                    })))), l ? we.createElement("div", {
                        className: "MessageForward__send-spinner"
                    }, we.createElement(on.a, null)) : we.createElement("button", {
                        className: "MessageForward__send",
                        onClick: this.send
                    }))))
                }, t
            }(we.Component)),
            vn = window,
            yn = vn.MessageBox,
            On = vn.show,
            jn = vn.hide,
            wn = vn.isVisible,
            En = vn.getLang,
            kn = vn.boxRefreshCoords,
            Cn = void 0;

        function xn() {
            Cn && Cn.hide()
        }

        function Pn() {
            Cn && Cn.updateBoxCoords()
        }

        function Mn() {
            return document.querySelector("#MessageForward")
        }

        function Tn(e) {
            var t = document.querySelector("#box_layer_wrap"),
                n = document.querySelector("#box_loader"),
                r = wn(t);
            return {
                unmount: function() {
                    var t = Mn();
                    t && Ee.unmountComponentAtNode(t), Object(s.c)(e)
                },
                showLoader: function() {
                    kn(n), On(n), r || On(t)
                },
                hideLoader: function() {
                    jn(n), r || jn(t)
                }
            }
        }

        function In(e, t, n) {
            var i = (0, Object(s.b)(Tn).bindMutations)(Object(s.a)({
                    handlers: function(e, t) {}
                })),
                o = {
                    hideButtons: !0,
                    bodyStyle: "padding: 0; background: none;",
                    width: 500,
                    onShow: function() {
                        ! function(e) {
                            var t = Mn();
                            t && Ee.render(we.createElement(Gt, {
                                value: e
                            }, we.createElement(bn, {
                                getLang: En,
                                closePopup: xn,
                                updatePopup: Pn
                            })), t)
                        }(t), requestAnimationFrame(function() {
                            return Cn.updateBoxCoords()
                        })
                    },
                    onHideAttempt: function() {
                        return t.set(r.cb.bind(null, null)), i.unmount(), !0
                    }
                };
            return i.showLoader(), Promise.resolve().then(function(e) {
                i.hideLoader(), Cn = new yn(o).content('<div id="MessageForward"></div>').show()
            }), i
        }
        var Sn = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
        var Dn = "_im_action",
            Bn = "_im_page_peer_name",
            Ln = "_ui_menu",
            An = "_im_dialog_action_wrapper",
            Rn = "_im_mess_actions",
            Nn = "_im_page_action",
            Un = "_im_chat_topic_change_input",
            Wn = "_im_chat_verified",
            Hn = "im-page--chat-header_chat",
            Kn = "im-page--chat-header_vkcomgroup",
            qn = "_im_page_peer_name",
            Fn = "_im_chat_members",
            zn = "_im_chat_invite_link",
            Vn = '<a tabindex="0" role="link" class="ui_actions_menu_item ' + Dn + ' im-action im-action_%icon%" data-action="%action%">%name%</a>';

        function Qn(e, t, n) {
            return !e.map(function(e) {
                var r = Object(o.m)(t, n, e);
                return Object(a.h)(r)
            }).reduce(function(e, t) {
                return e && t
            }, !0)
        }

        function Gn(e, t) {
            var n = t.get(),
                r = n.peer,
                i = n.tabs[r].pinned;
            return 1 === e.length && i && e[0] === Object(o.P)(i).messageId
        }

        function Xn(e, t, n) {
            var r = getLang("mail_selected_shorted", t.length);
            Zn({
                actions: !0
            }, "im-page--chat-header"), val(geByClass1("im-page--selected-messages"), getTemplate("im_selected_messages", {
                label: r.replace("{count}", t.length),
                tip: getLang("mail_deselect_all")
            }));
            var a = Object(o.t)(n, n.get().peer),
                s = e.querySelector("." + Rn),
                c = Qn(t, n, n.get().peer),
                u = Gn(t, n),
                l = Object(i.Ha)(a.peerId) && Object(L.j)(n, a.peerId),
                d = Object(i.Pa)(n, a.peerId),
                _ = e.querySelector("." + Nn + '[data-action="respond"]'),
                f = Boolean(Object(o.R)(a)),
                p = Boolean(Object(o.Q)(a));
            toggleClass(s, "im-page--mess-actions_important", !c), toggleClass(s, "im-page--mess-actions_pinned", u), toggleClass(s, "im-page--mess-actions_vkcomgroup", d && !n.get().gid), toggleClass(s, "im-page--mess-actions_multiple-selection", t.length > 1), toggleClass(s, "im-page--mess-actions_no-pin-btn", !l), toggleClass(s, "im-page--mess-actions_out-mr", f), toggleClass(s, "im-page--mess-actions_in-mr", p), t.length > 1 ? _.innerHTML = getLang("mail_forward_here") : _.innerHTML = getLang("mail_im_mark_reply");
            var m = c ? getLang("mail_im_toggle_important") : getLang("mail_im_toggle_important_off"),
                g = u ? getLang("mail_unpin") : getLang("mail_pin");
            attr(geByClass1("im-page-action_star", e), "aria-label", m), attr(geByClass1("im-page-action_pin", e), "aria-label", g)
        }

        function Yn(e, t, n) {
            var a = t.get(),
                s = a.peer,
                c = a.tabs[s],
                u = clean(stripHTML(unclean(c.tab))),
                l = geByClass1(Wn, e),
                d = geByClass1(i.r),
                _ = Object(i.Ha)(s),
                f = _ && Object(i.Pa)(t, s);
            l.tt = !1;
            var p = Object(i.xb)(t, c, !0),
                m = getTemplate("im_simple_link", {
                    href: f ? "/club" + -c.ownerId : c.href,
                    content: getTemplate("im_peer_photo", {
                        online_class: "",
                        owner_photo: p,
                        modifier_class: "nim-peer_smaller"
                    })
                });
            val(geByClass1("im-page--aside-photo", e), m);
            var g, h, b, v = _ ? !c.data.closed && !c.data.kicked : 0,
                y = {
                    muted: inArray(s, a.mutedPeers),
                    verified: !!c.verified,
                    chat: _,
                    vkcomgroup: f,
                    actions: !1,
                    derelict: _ && !v && !f,
                    pinned: !1
                };
            if (_) {
                var O = Object(o.p)(t),
                    j = function(e) {
                        var t = Object(o.p)(e);
                        if (!t || Object(B.c)(e, t.userId)) return !1;
                        return t.userId
                    }(t);
                O && Object(je.a)(t, s) && (j ? t.set(r.Ha.bind(null, (g = {}, h = s, b = [j], h in g ? Object.defineProperty(g, h, {
                    value: b,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : g[h] = b, g))).then(Yn.bind(null, e, t, n)) : y.pinned = !0)
            }
            var w = "";
            _ ? w = f ? getTemplate("im_vkcomgroup_members", {
                name: getLang("mail_im_n_vkcomgroup_members", Object(i.P)(c))
            }) : v ? getTemplate("im_chat_members", {
                name: getLang("mail_im_n_chat_members", Object(i.P)(c))
            }) : "" : Object(i.fb)(s) && (w = Object(i.W)(t, s));
            var E = getTemplate("im_simple_name", {
                name: c.tab,
                href: f ? "/club" + -c.ownerId : c.href,
                name_attr: u,
                ads_union: c.ad_union_ids_attr,
                online: w,
                more_cls: "" === w ? "im-page--title--1line" : ""
            });
            val(geByClass1("im-page--title-wrapper", e), E);
            var k = val(d) && !c.top_banner,
                C = Jn(t) && !c.top_banner,
                x = geByClass1(Bn, e);
            if (removeClass(x, i.k), show(geByClass1(An, e)), removeClass(geByClass1(Rn, e), "im-page--mess-actions_visible"), removeClass(geByClass1(Rn, e), "im-page--mess-actions_all-sel"), function(e, t, n) {
                    geByClass("_im_header_icon", e).forEach(function(e) {
                        if (n.length > 0) hide(e);
                        else if ("star" === domData(e, "type") && Object(i.Na)(t) && (toggleClass(e, "im-page--header-icon_star-active", Object(i.Qa)(t)), setStyle(e, {
                                display: "inline-block"
                            })), "answer" === domData(e, "type") && Object(i.Na)(t) && (toggleClass(e, "im-page--header-icon_answer-shown", Object(i.db)(t)), Object(i.db)(t) ? setStyle(e, {
                                display: "inline-block"
                            }) : hide(e)), "search" === domData(e, "type") && !Object(i.Ja)(t)) {
                            var r = Object(i.Oa)(t, t.get().peer) && t.get().tabs[t.get().peer].offset;
                            setStyle(e, {
                                display: "inline-block"
                            }), toggleClass(e, "im-page-header-icon_search-shown", r)
                        }
                    })
                }(e, t, []), Object(i.Ia)(t)) {
                var P = geByClass1("_im_page_back", e);
                attr(P, "href", Object(i.S)(t) + "?tab=" + a.active_tab)
            }
            Zn(y, "im-page--chat-header"), Object(i.G)(t, C, k, n)
        }

        function Jn(e) {
            var t = Object(o.p)(e),
                n = geByClass1(i.r);
            if (removeClass(n, "im-page--pinned_with-bar"), t && Object(a.j)(t)) {
                if (void 0 === t.kludges.attach1_tr_amount) return;
                t.kludges.attach1_total_amount && addClass(n, "im-page--pinned_with-bar")
            }
            var r = Object(i.yb)(e);
            return val(n, r), !!r
        }

        function Zn(e, t) {
            var n = geByClass1(t);
            Object.keys(e).forEach(function(r) {
                toggleClass(n, t + "_" + r, !!e[r])
            })
        }

        function $n(e, t, n, i, o) {
            e.set(r.ob.bind(null, n, o, i)).then(t().removeMessagesRestore.bind(null, n, o, i)), Object(r.lb)(n, o, null, i, e.get())
        }

        function er(e, t, n) {
            if (Object(i.Ha)(t)) {
                var o = e.get().tabs[t].name,
                    a = function(e, t, n, i, o, a) {
                        if ("keydown" !== a.type || 13 === a.which) {
                            var s = trim(val(o));
                            return s ? (s !== n && e.set(r.qc.bind(null, t, s)), !0) : (notaBene(o), !1)
                        }
                    }.bind(null, e, t, o, n),
                    s = showFastBox({
                        title: getLang("mail_chat_topic_change_title"),
                        dark: 1
                    }, getTemplate("im_chat_change_topic", {
                        value: o
                    }), getLang("global_save"), function(e, t) {
                        a(c, t) && s.hide()
                    }, getLang("global_cancel"), function() {
                        s.hide()
                    }),
                    c = geByClass1(Un, s.bodyNode);
                elfocus(c), addEvent(c, "keydown", function(e) {
                    a(c, e) && s.hide()
                })
            }
        }

        function tr(e, t, n, a, s, u) {
            var l = domData(u, "action"),
                d = geByClass1(Ln, a).parentNode,
                _ = e.get().peer;
            switch (l) {
                case "clear":
                    var f = Object(o.t)(e, _),
                        p = Object(i.Pb)(f, _, function() {
                            Object(i.F)(e, p, t, r.I, e.get().peer)
                        });
                    break;
                case "photos":
                case "media":
                    showWiki({
                        w: "history" + Object(i.H)(_) + "_photo"
                    }, null, {});
                    break;
                case "topic":
                    er(e, _, t);
                    break;
                case "avatar":
                    cur.recieveCropResult = void 0, Page.ownerPhoto(_, {
                        gid: e.get().gid
                    });
                    break;
                case "search":
                    t().showSearch(e);
                    break;
                case "block_community":
                    e.set(r.fc.bind(null, !1, _)).then(function() {
                        e.get().longpoll.push([Object(c.ab)()]), showDoneBox(getLang("mail_community_was_blocked"))
                    });
                    break;
                case "allow_community":
                    e.set(r.fc.bind(null, !0, _)).then(function() {
                        n().changeActions(e)
                    });
                    break;
                case "block":
                    Object(i.Lb)(_, e).once("success", function(t) {
                        t.delta && (showDoneBox(t.msg), e.get().longpoll.push([Object(c.ab)()]))
                    });
                    break;
                case "leave":
                    var m = Object(i.Rb)(e, _, function(n) {
                        n && Object(i.F)(e, m, t, r.I, _), e.set(r.Ca.bind(null, _)), e.set(r.nc.bind(null, _)), m.hide(), e.get().longpoll.push([Object(c.ab)()])
                    });
                    break;
                case "invite_link":
                    var g = function(e, t, n) {
                            var i = showFastBox({
                                title: getLang("mail_chat_invite_link"),
                                dark: 1
                            }, getLang("mail_chat_reset_link_warning"), getLang("mail_chat_reset_link_confirm"), function(o) {
                                var a = gpeByClass("_im_invite_box", n.target),
                                    s = geByClass1(zn, a),
                                    c = geByClass1("_im_invite_new", a);
                                lockButton(i.btns.ok[0]), Object(r.rb)(t, e.get()).then(function(e) {
                                    var t = Sn(e, 1)[0];
                                    unlockButton(i.btns.ok[0]), s.value = t, unlockButton(c), addClass(a, "im-invite-box_reseted"), elfocus(s, 0, t.length), i.hide()
                                })
                            }, getLang("global_cancel"), function() {
                                i.hide()
                            })
                        }.bind(null, e, _),
                        h = !1,
                        b = !1,
                        v = !1,
                        y = function() {
                            elfocus(h, 0, h.value.length), document.execCommand("copy"), setStyle(b, {
                                opacity: 1
                            }), v && (v = clearTimeout(v)), v = setTimeout(function() {
                                return setStyle(b, {
                                    opacity: 0
                                })
                            }, 2e3)
                        },
                        O = !1,
                        j = !1;
                    showBox("al_im.php", {
                        act: "a_get_link",
                        gid: e.get().gid,
                        chat_id: _ - 2e9,
                        markup: 1
                    }, {
                        onDone: function(e) {
                            h = geByClass1(zn, e.bodyNode), O = geByClass1("_im_reset_link", e.bodyNode), j = geByClass1("_im_invite_copy", e.bodyNode), b = geByClass1("_im_invite_copied", e.bodyNode), elfocus(h, 0, h.value.length), addEvent(O, "click", g), addEvent(j, "click", y)
                        },
                        params: {
                            hideButtons: !0,
                            onHide: function() {
                                removeEvent(O, "click", g), removeEvent(j, "click", y)
                            },
                            onShow: function() {
                                addEvent(O, "click", g), addEvent(j, "click", y)
                            }
                        }
                    }, {});
                    break;
                case "return":
                    e.set(r.zb.bind(null, _)).then(function(e) {
                        return e.set(r.Q.bind(null, _))
                    }).then(t().updateChatTopic.bind(null, _)).catch(function(e) {
                        showFastBox(getLang("global_error"), e)
                    });
                    break;
                case "unmute":
                case "mute":
                    e.set(r.kc.bind(null, _, "mute" === l)).then(t().updateState.bind(null, _));
                    break;
                case "chat":
                case "invite":
                    if (Object(i.Ha)(_)) Object(i.Ea)(e, _, t, r.Qb);
                    else if (Object(i.fb)(_)) {
                        var w = e.get().tabs[_],
                            E = [
                                [_, w.tab]
                            ];
                        e.set(r.Qb.bind(null, "chat", [])).then(function() {
                            return t().showCreation(e, E)
                        })
                    }
                    break;
                case "pin_hide":
                    Object(je.c)(e, Object(o.o)(e), t);
                    break;
                case "pin_unhide":
                    Object(je.d)(e, Object(o.o)(e), t);
                    break;
                case "unpin":
                    Object(je.e)(e, Object(o.o)(e), t);
                    break;
                case "settings":
                    n().showSettings(e)
            }
            uiActionsMenu.toggle(d, !1), t().cancelEditing()
        }

        function nr(e, t, n) {
            var i = e.get().selectedMessages;
            e.set(r.t).then(n().changedMessageSelection).then(t().cleanSelection.bind(null, i))
        }

        function rr(e, t, n, r) {
            var o = Object(i.Ia)(e),
                a = void 0,
                s = void 0;
            switch (domData(r, "type")) {
                case "star":
                    s = [4, 6], a = function() {
                        return Object(i.Qa)(e) ? getLang("mail_im_toggle_important_off") : getLang("mail_im_toggle_important")
                    };
                    break;
                case "answer":
                    s = [4, 6], a = getLang("mail_end_conversation");
                    break;
                case "search":
                    s = o ? [5, 6] : [4, -9], a = getLang("mail_search_in_peer")
            }
            showTooltip(r, {
                text: a || "",
                black: 1,
                shift: s,
                forcetoup: !0,
                appendParentCls: o ? "_im_dialog_actions" : "_im_mess_actions"
            })
        }

        function ir(e, t, n) {
            var r = Object(i.Ia)(e),
                o = domData(n.target, "action");
            "respond" !== o && "forward" !== o && showTooltip(n.target, {
                text: function(e, t) {
                    var n = e.get(),
                        r = n.selectedMessages,
                        i = n.peer;
                    switch (t) {
                        case "pin":
                            return Gn(r, e) ? getLang("mail_unpin") : getLang("mail_pin");
                        case "star":
                            return Qn(r, e, i) ? getLang("mail_im_toggle_important") : getLang("mail_im_toggle_important_off");
                        case "delete":
                            return getLang("mail_delete");
                        case "spam":
                            return getLang("mail_im_mark_spam")
                    }
                }.bind(null, e, o) || "",
                black: 1,
                shift: [2, r ? -4 : 11],
                forcetodown: !0,
                appendParentCls: "_im_dialog_actions"
            })
        }

        function or(e, t, n, a) {
            return {
                changeActions: function(t) {
                    var n = geByClass1(Ln, e),
                        i = geByClass1(An, e),
                        o = t.get().curActions,
                        a = Object.keys(o).map(function(e, t) {
                            var n = "";
                            return 7 !== r.a[e] && 10 !== r.a[e] || 0 === t || (n = '<div class="ui_actions_menu_sep"></div>'), n + rs(Vn, {
                                name: o[e].name,
                                icon: o[e].icon,
                                action: e
                            })
                        }).join("");
                    0 === Object.keys(o).length ? addClass(i, "im-page--header-more_loading") : (val(n, a), removeClass(i, "im-page--header-more_loading"))
                },
                showSettings: function(e) {
                    var t = e.get(),
                        n = Object(o.t)(e, t.peer);
                    n.data.closed || n.data.kicked || Kt(0, e)
                },
                showForward: function(e) {
                    In(0, e)
                },
                renderPeer: function(n) {
                    Yn(e, n, t)
                },
                reRenderPinned: function(e) {
                    var t = Object(o.g)(e);
                    t && t.pinned && Jn(e)
                },
                renderActions: function(t) {
                    var n = t.get().selectedMessages || [];
                    n.length > 0 && Xn(e, n, t)
                },
                hideActions: function(t) {
                    if (!Object(i.Oa)(t, t.get().peer)) {
                        var n = geByClass1(An, e);
                        addClass(n, "im-page--header-more_loading")
                    }
                },
                changedMessageSelection: function(n) {
                    if (0 !== n.get().peer) {
                        var r = n.get().selectedMessages || [];
                        r.length > 0 ? Xn(e, r, n) : Yn(e, n, t)
                    }
                },
                updateLastSeen: function(t) {
                    ! function(e, t) {
                        var n = e.get().peer,
                            r = geByClass1("_im_page_peer_online", t);
                        r && Object(i.fb)(n) && Object(o.t)(e, n) && Object(i.y)(r, Object(i.W)(e, n))
                    }(t, e)
                },
                deselectAll: function(e) {
                    nr(e, t, a)
                },
                unmount: function() {
                    Object(s.c)(n), cancelStackFilter("fowrward")
                }
            }
        }

        function ar(e, t, n) {
            var a = Object(s.b)(or),
                u = a.callMutations,
                l = a.bindMutations,
                d = function(e, t, n, a, s) {
                    var u = e.get().selectedMessages,
                        l = domData(s, "action"),
                        d = e.get().peer,
                        _ = !0,
                        f = Object(o.t)(e, d);
                    if ("star" !== l && Object(o.R)(f)) return nr(e, t, n);
                    switch (l) {
                        case "delete":
                            var p = !(vk.id == d && !e.get().gid) && u.every(function(t) {
                                return Object(i.B)(e, Object(o.m)(e, d, t))
                            });
                            if (p || u.length > 1) {
                                _ = !1;
                                var m = Object(i.Tb)(d, u.length, p, function(i) {
                                    nr(e, t, n), m.hide(), cur.imDb.updateByKey("del_forall_checked", i), i ? Object(r.lb)(u, d, null, "deleteforall", e.get()) : $n(e, t, u, l, d)
                                })
                            } else $n(e, t, u, l, d);
                            break;
                        case "spam":
                            $n(e, t, u, l, d);
                            break;
                        case "forward":
                            Object(r.eb)(u, e.get().peer, e).then(function(t) {
                                return e.set(r.cb.bind(null, t))
                            }).then(function() {
                                return n().showForward(e)
                            }).catch(function(e) {
                                return console.error(e)
                            });
                            break;
                        case "star":
                            var g = Qn(u, e, d);
                            e.set(r.G.bind(null, u, g, d)), e.get().longpoll.push(u.map(function(e) {
                                return {
                                    type: g ? c.U : c.Q,
                                    messageId: e,
                                    peerId: d,
                                    flags: c.l
                                }
                            }));
                            break;
                        case "respond":
                            var h = e.get(),
                                b = 1 === u.length;
                            Object(r.eb)(u, h.peer, e).then(function(t) {
                                return e.set(r.K.bind(null, t, h.tfdraft, b))
                            }).then(function() {
                                t().respond(e, d)
                            });
                            break;
                        case "pin":
                            var v = Object(o.l)(e, u[0]),
                                y = Gn(u, e),
                                O = y ? r.nc.bind(null, d) : r.ab.bind(null, v, d),
                                j = y ? r.mc.bind(null, d) : r.Za.bind(null, v, d),
                                w = function(e, t, n) {
                                    return e().updateChatTopic(t, n), n
                                }.bind(null, t, d);
                            e.set(r.r.bind(null, e, v, d)).then(function(e) {
                                return e.set(O)
                            }).then(w).then(function(e) {
                                return e.set(j)
                            }).then(w)
                    }
                    _ && nr(e, t, n)
                }.bind(null, t, n, u),
                _ = tr.bind(null, t, n, u, e),
                f = nr.bind(null, t, n, u),
                p = function(e, n) {
                    return Object(i.Zb)(n, t.get().peer)
                },
                m = rr.bind(null, t, e),
                g = ir.bind(null, t, e),
                h = function(e, t, n, i, a) {
                    switch (domData(a, "type")) {
                        case "star":
                            e.set(r.ic.bind(null, e.get().peer)).then(function() {
                                setTimeout(function() {
                                    return rr(e, 0, 0, a)
                                }, 40)
                            });
                            break;
                        case "search":
                            n().showSearch(e), window.tooltips && tooltips.hide(a, {
                                fasthide: !0
                            });
                            break;
                        case "answer":
                            var s = Object(o.t)(e, e.get().peer);
                            s && (e.set(r.Va.bind(null, e.get().peer, s.lastmsg)), showDoneBox(getLang("mail_marked_as_answered"), {
                                out: 1e3
                            }), e.get().longpoll.push([Object(c.ab)()]))
                    }
                }.bind(null, t, e, n),
                b = function() {
                    return u().showSettings(t)
                },
                v = function(t) {
                    !gpeByClass(Hn, t.target, e) || gpeByClass(Kn, t.target, e) || checkEvent(t) || (b(), cancelEvent(t))
                },
                y = Object(s.a)({
                    handlers: function(n, r) {
                        r(e, "click", Nn, d), r(e, "click", Dn, _), r(e, "click", i.k, f), r(e, "mouseover", Wn, p), r(e, "mouseover", "_im_header_icon", m), r(e, "mouseover", Nn, g), r(e, "click", "_im_header_icon", h), r(e, "click", "_im_header_link", v), r(e, "click", qn, v), r(e, "click", Fn, b), r(e, "click", "_im_page_back", function(e) {
                            checkEvent(e) || (t.get().longpoll.push([Object(c.ab)()]), cancelEvent(e))
                        })
                    }
                });
            return Object(i.Ya)(t.get().peer) || setTimeout(function() {
                t.set(r.Ob).then(u().changeActions)
            }), l(e, n, y, u)
        }
        var sr = n("g6Ay"),
            cr = 600,
            ur = browser.msie && intval(browser.version) < 10 ? window.XDomainRequest : window.XMLHttpRequest;

        function lr(e) {
            var t = e % 60;
            return parseInt(e / 60) + ":" + (t < 10 ? "0" : "") + t
        }
        var dr = void 0,
            _r = void 0,
            fr = void 0,
            pr = void 0,
            mr = void 0,
            gr = void 0,
            hr = void 0,
            br = void 0,
            vr = void 0,
            yr = void 0,
            Or = void 0,
            jr = void 0,
            wr = void 0,
            Er = void 0,
            kr = !1,
            Cr = !1,
            xr = 100;

        function Pr(e) {
            if (!Cr) {
                Cr = !0, Object(i.ib)(gr);
                var t = {
                    peer: br.get().peer,
                    from_place: cur.docsChooseFrom,
                    imhash: cur.docsChooseImHash,
                    blockPersonal: cur.docsChooseBlockPersonal,
                    mail_add: cur.docsChooseMailAdd
                };
                (function(e) {
                    return new Promise(function(t, n) {
                        for (var r = new FormData, i = [], o = 0; o < e.wave.length; o++) i.push(parseInt(31 * e.wave[o]));
                        r.append("waveform", JSON.stringify(i)), r.append("file", e.buffer, "voice_message." + function(e) {
                            var t = e.match(/.*\/(\w*).*/);
                            switch (t[1]) {
                                case "mpeg":
                                    return "mp3";
                                case "ogg":
                                case "webm":
                                case "wav":
                                    return t[1]
                            }
                            return ""
                        }(e.mimeType));
                        var a = new ur;
                        a.onload = a.onerror = function(e) {
                            var r = e.currentTarget.response;
                            200 == this.status && r.length > 0 && "{" == r[0] ? (r = JSON.parse(r), t(r)) : n()
                        }, a.open("POST", Er.upload_url, !0), a.send(r)
                    })
                })(e).then(function(e) {
                    return e.file ? new Promise(function(n, r) {
                        ajax.post("/docs.php", extend({
                            act: "a_save_doc",
                            from: "choose",
                            from_place: t.from_place,
                            imhash: t.imhash,
                            blockPersonal: t.blockPersonal,
                            mail_add: t.mail_add
                        }, e), {
                            onDone: function(e, r) {
                                Sr(), Or([
                                    ["doc", e + "_" + r, "audiomsg"]
                                ], {}, t.peer), Nr(), n()
                            },
                            onFail: function(e) {
                                r(e)
                            },
                            progress: null
                        })
                    }) : Promise.reject()
                }).then(function() {
                    Object(i.ic)(gr), Cr = !1
                }).catch(function() {
                    Cr = !1, Object(i.ic)(gr), showFastBox(getLang("global_error"), getLang("mail_audio_message_upload_error"))
                })
            }
        }

        function Mr() {
            wr(), _r.innerHTML = lr(kr.duration), kr.duration >= cr && Rr()
        }

        function Tr() {
            wr(), stManager.add(["voice_message_player.js", "speech.js"], function() {
                kr || (kr = Speech.newRecorder(), addEvent(kr, "progress", Mr)), AudioMessagePlayer.detachPlayer(), AudioMessagePlayer.pauseGlobalMedia(), kr.record().then(function() {
                    var e;
                    e = br, Er.isRecording = !0, cancelStackPush("audio_message_cancel", function(e) {
                        e.set(r.l).then(Lr)
                    }.bind(null, e)), hideProgress(geByClass1("im-audio-message-send-wrapper", dr)), show(gr), _r.innerHTML = "0:00", addClass(dr, "im-audio-message_recording"), removeClass(dr, "im-audio-message_recorded"), show(dr), hide(geByClass1("_im_chat_input_parent")), (yr = Speech.createVisualization("wave", kr.source, fr)).start();
                    var t = fr.getBoundingClientRect();
                    xr = (t.right - t.left) / 3
                }).catch(function(e) {
                    AudioMessagePlayer.resumeGlobalMedia();
                    var t = e.name;
                    switch (e.name) {
                        case "DevicesNotFoundError":
                        case "NotFoundError":
                            t = "mail_audio_message_device_error";
                            break;
                        case "PermissionDeniedError":
                        case "PermissionDismissedError":
                            t = "mail_audio_message_permission_error";
                            break;
                        case "Unsupported":
                            t = "mail_audio_message_unsupported_error"
                    }
                    showFastBox(getLang("global_error"), getLang(t)), console.error(e)
                })
            })
        }

        function Ir() {
            kr && kr.stop(), yr && (yr.destroy(), yr = null)
        }

        function Sr() {
            Er.isRecording = !1, cancelStackFilter("audio_message_cancel")
        }

        function Dr() {
            Br(), Pr(kr)
        }

        function Br() {
            var e;
            AudioMessagePlayer.loaded && AudioMessagePlayer.resumeGlobalMedia(), removeEvent(kr, "finish", Br), removeEvent(kr, "finish", Dr), e = URL.createObjectURL(kr.buffer), domData(vr, "duration", kr.duration), domData(vr, "ogg", e), domData(vr, "mp3", e), geByClass1("audio-msg-track--duration", vr).innerHTML = lr(kr.duration), geByClass1("audio-msg-track--wave-wrapper", vr).innerHTML = AudioMessagePlayer.getWave(kr.wave, xr), removeClass(dr, "im-audio-message_recording"), addClass(dr, "im-audio-message_recorded")
        }

        function Lr() {
            var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
            Sr(), AudioMessagePlayer.loaded && (AudioMessagePlayer.resumeGlobalMedia(), AudioMessagePlayer.detachPlayer()), removeEvent(kr, "finish", Br), removeEvent(kr, "finish", Dr), Ir(), Nr(), e && jr()
        }

        function Ar() {
            kr.isRecording ? (addEvent(kr, "finish", Dr), removeEvent(kr, "finish", Br), Ir()) : Pr(kr)
        }

        function Rr() {
            addEvent(kr, "finish", Br), removeEvent(kr, "finish", Dr), Ir()
        }

        function Nr() {
            removeClass(dr, "im-audio-message_recorded"), removeClass(dr, "im-audio-message_recording"), hide(dr), show(geByClass1("_im_chat_input_parent"))
        }

        function Ur() {
            ge("audiomsg_record"), vr = ge("audiomsg_player"), dr = geByClass1("im-audio-message-input"), _r = geByClass1("audio-msg-track--duration", dr), fr = geByClass1("audio-msg-track--wave", dr), mr = geByClass1("im-audio-message--cancel-btn", dr), gr = geByClass1("_im_audio_send", dr), hr = geByClass1("audio-msg-track--btn", dr), geByClass1("im-chat-input--text", geByClass1("im-page--chat-input"));
            var e = geByClass1("im-chat-input--textarea", geByClass1("im-page--chat-input"));
            addClass(e, "_voice_field_wrap"), addEvent(pr, "click", Tr), addEvent(mr, "click", Lr), addEvent(gr, "click", Ar), addEvent(hr, "click", Rr)
        }

        function Wr() {
            ! function() {
                kr && removeEvent(kr, "progress", Mr);
                removeEvent(pr, "click", Tr), removeEvent(mr, "click", Lr), removeEvent(gr, "click", Ar), removeEvent(hr, "click", Rr)
            }(), vr = dr = _r = fr = pr = mr = gr = hr = null
        }

        function Hr(e, t, n) {
            return {
                cancelRecording: Lr,
                start: function() {
                    Tr()
                },
                unmount: function() {
                    Lr(!1), Wr()
                }
            }
        }

        function Kr(e, t, n, o, a) {
            return br = t, Er = t.get().audio_msg, wr = function(e) {
                var t = e.get().peer;
                Object(i.Oa)(e, t) && !Object(i.Ga)(e) && Date.now() - (Object(i.Z)(e, t).lastTyping || 0) > 1e3 * r.b && e.set(r.Mb.bind(null, t))
            }.bind(null, t), Or = n, jr = a, Object(sr.a)(), Object(i.Q)().then(function(e) {
                var n = e.length > 0;
                n ? (Ur(), o()) : setCookie("remixvoice", "0", 7), t.set(r.Zb.bind(null, n))
            }).catch(function(e) {
                throw setCookie("remixvoice", "0", 7), e
            }), (0, Object(s.b)(Hr).bindMutations)(e, t, n)
        }
        var qr = n("6aSF"),
            Fr = n("nAFc"),
            zr = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };

        function Vr(e, t) {
            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }

        function Qr(e, t) {
            if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return !t || "object" != typeof t && "function" != typeof t ? e : t
        }

        function Gr(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }
        var Xr = function(e) {
                function t() {
                    return Vr(this, t), Qr(this, e.apply(this, arguments))
                }
                return Gr(t, e), t.prototype.render = function() {
                    var e = this.props,
                        t = e.color,
                        n = e.action,
                        r = function(e, t) {
                            var n = {};
                            for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                            return n
                        }(e, ["color", "action"]),
                        i = t.toLowerCase().replace("default", "secondary"),
                        o = Emoji.emojiToHTML(clean(Object(Fr.a)(n.label)).replace(/\n(\r)?/gi, " "), !0);
                    return we.createElement(Pe.a, zr({
                        wide: !0,
                        overflow: !0
                    }, r, {
                        appearance: i,
                        dangerouslySetInnerHTML: {
                            __html: o
                        }
                    }))
                }, t
            }(we.Component),
            Yr = Xt(function(e) {
                function t() {
                    return Vr(this, t), Qr(this, e.apply(this, arguments))
                }
                return Gr(t, e), t.prototype.render = function() {
                    var e = this,
                        t = Object(o.f)(this.props.store);
                    if (!t || !t.buttons) return null;
                    return we.createElement("div", {
                        className: Object(Ce.a)("Keyboard", {
                            "Keyboard--hidden": t.hide
                        })
                    }, we.createElement(qr.a, {
                        className: "Keyboard__scroll-wrapper"
                    }, we.createElement("div", {
                        className: "Keyboard__container"
                    }, t.buttons.map(function(t, n) {
                        return we.createElement("div", {
                            key: "row-" + n,
                            className: "Keyboard__row"
                        }, t.map(function(n, r) {
                            return we.createElement("div", {
                                className: "Keyboard__button",
                                key: "row-" + r,
                                style: {
                                    width: (i = t.length, "calc(100% / " + i + " - 10px)")
                                }
                            }, we.createElement(Xr, zr({
                                onClick: function() {
                                    return e.props.send(n)
                                }
                            }, n)));
                            var i
                        }))
                    }))))
                }, t
            }(we.Component));

        function Jr() {
            return document.getElementById("_im_keyboard_container")
        }

        function Zr(e, t, n) {
            return {
                init: function() {
                    var e = this;
                    return new Promise(function(r) {
                        e.isMounted = !0,
                            function(e, t, n) {
                                var r = Jr();
                                if (r) {
                                    var i = we.createElement(Gt, {
                                        value: e
                                    }, we.createElement(Yr, {
                                        send: t
                                    }));
                                    Ee.render(i, r, n)
                                }
                            }(t, n, r)
                    })
                },
                toggle: function(e, n, i) {
                    return t.set(r.jc.bind(null, e, n, i))
                },
                unmount: function() {
                    var t = Jr();
                    t && this.isMounted && Ee.unmountComponentAtNode(t), this.isMounted = !1, Object(s.c)(e)
                }
            }
        }
        var $r = ke.a.getLang,
            ei = Xt(function(e) {
                function t() {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    for (var n = arguments.length, r = Array(n), i = 0; i < n; i++) r[i] = arguments[i];
                    var o = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call.apply(e, [this].concat(r)));
                    return o.elementOnClick = function(e, t) {
                        t.preventDefault(), t.stopPropagation(), o.props.applyTemplate(e), o.toggleDropdown(!1)
                    }, o.toggleDropdown = function(e) {
                        o.setState({
                            isShowDropDown: e
                        })
                    }, o.state = {
                        isShowDropDown: !1
                    }, o
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.render = function() {
                    var e = this,
                        t = this.props,
                        n = t.getTemplates,
                        r = t.showSettingsPopup,
                        i = t.showCreatingTemplatePopup,
                        o = t.isNeededRendering,
                        a = this.state.isShowDropDown;
                    if (!o()) return null;
                    var s = n();
                    return we.createElement("div", {
                        className: "TemplatesDropDown",
                        onMouseOver: this.toggleDropdown.bind(this, !0),
                        onMouseOut: this.toggleDropdown.bind(this, !1)
                    }, we.createElement("div", {
                        className: Object(Ce.a)("TemplatesDropDown__wrapper", {
                            "TemplatesDropDown__wrapper--show": a
                        }),
                        "aria-hidden": a
                    }, we.createElement("div", {
                        className: "TemplatesDropDown__container"
                    }, we.createElement(qr.a, {
                        className: "TemplatesDropDown__scroll-wrapper"
                    }, we.createElement("div", null, " ", we.createElement("header", {
                        className: "TemplatesDropDown__header"
                    }, we.createElement("h2", {
                        className: "TemplatesDropDown__title"
                    }, $r("mail_community_templates")), we.createElement("a", {
                        role: "button",
                        className: "TemplatesDropDown__setting-button",
                        onClick: r
                    }, $r("mail_settings_configure"))), s.length ? we.createElement("ul", {
                        className: "TemplatesDropDown__list"
                    }, s.map(function(t) {
                        return we.createElement("li", {
                            key: t.id,
                            className: "TemplatesDropDown__item",
                            onMouseDown: e.elementOnClick.bind(null, t.id)
                        }, we.createElement("h3", {
                            className: "TemplatesDropDown__item-name",
                            dangerouslySetInnerHTML: {
                                __html: t.name
                            }
                        }), we.createElement("div", {
                            className: "TemplatesDropDown__item-content",
                            dangerouslySetInnerHTML: {
                                __html: t.text
                            }
                        }))
                    })) : we.createElement("div", {
                        className: "TemplatesDropDown__not-found-container"
                    }, we.createElement("span", null, $r("mail_community_templates_not_found")), we.createElement(Ae.a, {
                        onClick: i
                    }, $r("mail_add_community_template"))))))), we.createElement("button", {
                        className: "TemplatesDropDown__icon"
                    }))
                }, t
            }(we.Component)),
            ti = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };

        function ni(e, t) {
            var n = !!window.getSelection && window.getSelection(),
                r = !1;
            if (n && n.rangeCount) {
                var i = n.getRangeAt(0);
                r = i.commonAncestorContainer ? i.commonAncestorContainer : i.parentElement ? i.parentElement() : i.item(0)
            }
            for (var o = r; o && o != e;) o = o.parentNode;
            o || Emoji.editableFocus(e, !1, !0), Emoji.insertHTML(t)
        }
        var ri = function(e) {
            function t() {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                for (var n = arguments.length, r = Array(n), i = 0; i < n; i++) r[i] = arguments[i];
                var o = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call.apply(e, [this].concat(r)));
                return o.onChange = function() {
                    o.props.onChange && o.props.onChange(Emoji.val(o.container))
                }, o.containerRef = we.createRef(), o.state = {
                    value: o.props.initialValue
                }, o
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                if (this.container = this.containerRef.current, this.container && !this.isMount) {
                    this.isMount = !0;
                    var e = this.props.initialValue;
                    Emoji.val(this.container, Emoji.emojiToHTML(e)), Emoji.init(this.container, {
                        noStickers: !0,
                        onSend: function() {},
                        ctrlSend: function() {
                            return !0
                        },
                        onChange: this.onChange,
                        noLineBreaks: !this.props.isMultiLine
                    })
                }
            }, t.prototype.componentWillUnmount = function() {
                this.container && this.isMount && (this.isMount = !1)
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.tabIndex,
                    n = e.isMultiLine,
                    r = (e.initialValue, function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["tabIndex", "isMultiLine", "initialValue"]));
                return we.createElement("div", ti({
                    role: "textbox",
                    ref: this.containerRef,
                    tabIndex: t,
                    contentEditable: !0,
                    "aria-multiline": n
                }, r))
            }, t
        }(we.Component);
        ri.defaultProps = {
            isMultiLine: !1,
            tabIndex: 0,
            initialValue: ""
        };
        var ii = ri,
            oi = ke.a.getLang,
            ai = function() {
                return [{
                    id: "user name",
                    label: oi("mail_community_templates_hint_name"),
                    process: function(e) {
                        return Object(B.c)(e, Object(o.o)(e)).first_name
                    }
                }, {
                    id: "user surname",
                    label: oi("mail_community_templates_hint_last_name"),
                    process: function(e) {
                        var t = Object(B.c)(e, Object(o.o)(e));
                        return t.name.replace(t.first_name, "").trim()
                    }
                }, {
                    id: "admin name",
                    label: oi("mail_community_templates_hint_your_name"),
                    process: function(e) {
                        return Object(B.c)(e, vk.id).first_name
                    }
                }, {
                    id: "admin surname",
                    label: oi("mail_community_templates_hint_your_last_name"),
                    process: function(e) {
                        var t = Object(B.c)(e, vk.id);
                        return t.name.replace(t.first_name, "").trim()
                    }
                }, {
                    id: "community",
                    label: oi("mail_community_templates_hint_community"),
                    process: function(e) {
                        return Object(B.c)(e, e.get().id).name
                    }
                }, {
                    id: "greeting",
                    label: oi("mail_community_templates_hint_greeting"),
                    process: function(e) {
                        var t = (new Date).getHours();
                        return oi(t >= 3 && t < 12 ? "mail_greeting_good_morning" : t >= 12 && t < 17 ? "mail_greeting_good_afternoon" : t >= 17 && t <= 23 ? "mail_greeting_good_evening" : "mail_greeting_good_night")
                    }
                }]
            };
        var si = ke.a.getLang,
            ci = "main",
            ui = "edit",
            li = function(e) {
                function t() {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    for (var n = arguments.length, i = Array(n), o = 0; o < n; o++) i[o] = arguments[o];
                    var a = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call.apply(e, [this].concat(i)));
                    return a.setEditableMessage = function(e) {
                        var t = e.id,
                            n = e.name,
                            r = e.text;
                        return new Promise(function(e) {
                            return a.setState({
                                editableMessage: {
                                    id: t,
                                    name: n,
                                    text: r
                                }
                            }, e)
                        })
                    }, a.onChangeEditableMessage = function(e, t) {
                        return a.setEditableMessage(Object.assign({}, a.state.editableMessage, function(e, t, n) {
                            return t in e ? Object.defineProperty(e, t, {
                                value: n,
                                enumerable: !0,
                                configurable: !0,
                                writable: !0
                            }) : e[t] = n, e
                        }({}, e, Object(Fr.c)(t))))
                    }, a.deleteTemplate = function(e) {
                        return Promise.resolve().then(function() {
                            return a.state.section !== ci ? a.go(ci) : Promise.resolve()
                        }).then(function() {
                            return a.props.store.set(r.A.bind(null, e))
                        }).catch(function() {
                            showFastBox(si("mail_error"), si("mail_community_templates_delete_error"))
                        })
                    }, a.saveTemplate = function(e) {
                        e.preventDefault();
                        var t = a.state.editableMessage,
                            n = t.name,
                            r = t.text;
                        n.length > 200 || n.length < 2 || n.length > 2e3 || r.length < 5 ? showFastBox(si("mail_error"), si("mail_form_is_filled_in_incorrectly")) : a.props.saveTemplate(t).catch(function() {
                            showFastBox(si("mail_error"), si("mail_community_templates_save_error"))
                        }).then(function() {
                            return a.go(ci)
                        })
                    }, a.addHint = function(e, t) {
                        t.preventDefault();
                        var n = a.state.editableMessage,
                            r = n.id,
                            i = void 0 === r ? null : r,
                            o = n.name,
                            s = n.text;
                        return ni(a.textarea, "{" + e.id + "}"), a.setEditableMessage({
                            id: i,
                            name: o,
                            text: s + "{" + e.id + "} "
                        })
                    }, a.getTextAreaRef = function(e) {
                        a.textarea = (e || {}).container
                    }, a.state = {
                        section: a.props.section,
                        editableMessage: {
                            id: null,
                            name: "",
                            text: ""
                        }
                    }, a
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.go = function(e) {
                    var t = this,
                        n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                        r = n.id,
                        i = void 0 === r ? null : r,
                        o = n.name,
                        a = void 0 === o ? "" : o,
                        s = n.text,
                        c = void 0 === s ? "" : s;
                    return new Promise(function(n) {
                        t.state.section !== e ? t.setState({
                            section: e,
                            editableMessage: {
                                id: i,
                                name: a,
                                text: c
                            }
                        }, function() {
                            t.props.popup.updateBoxCoords(), n()
                        }) : n()
                    })
                }, t.prototype.render = function() {
                    var e = this,
                        t = this.props,
                        n = t.getTemplates,
                        r = t.closePopup,
                        i = this.state,
                        o = i.section,
                        a = i.editableMessage,
                        s = n();
                    return we.createElement("section", {
                        className: "TemplatesSettings"
                    }, we.createElement(xe, {
                        title: we.createElement("span", {
                            className: "TemplatesSettings__title"
                        }, o === ci && si("mail_community_templates"), o === ui && si("mail_add_community_template")),
                        onCloseClick: r
                    }), we.createElement("main", {
                        className: "TemplatesSettings__content"
                    }, o === ci && (s.length ? we.createElement(qr.a, {
                        className: "TemplatesSettings__scroll-wrapper"
                    }, we.createElement("div", {
                        className: "TemplatesSettings__list"
                    }, s.map(function(t) {
                        return we.createElement("section", {
                            key: t.id,
                            className: "TemplatesSettings__item"
                        }, we.createElement("h3", {
                            className: "TemplatesSettings__item-name",
                            dangerouslySetInnerHTML: {
                                __html: t.name
                            }
                        }), we.createElement("div", {
                            className: "TemplatesSettings__item-content",
                            dangerouslySetInnerHTML: {
                                __html: t.text
                            }
                        }), we.createElement("div", {
                            className: "TemplatesSettings__buttons-row"
                        }, we.createElement(Ae.a, {
                            onClick: function() {
                                return e.go(ui, t)
                            },
                            className: "TemplatesSettings__item-button"
                        }, si("mail_settings_edit")), we.createElement("span", {
                            className: "TemplatesSettings__buttons-splitter",
                            "aria-hidden": "true"
                        }, " · "), we.createElement(Ae.a, {
                            onClick: e.deleteTemplate.bind(null, t.id),
                            className: "TemplatesSettings__item-button"
                        }, si("mail_delete"))))
                    }))) : we.createElement("div", {
                        className: "TemplatesSettings__not-found-container"
                    }, we.createElement("span", null, si("mail_community_templates_not_found")), we.createElement(Ae.a, {
                        onClick: function() {
                            return e.go(ui)
                        }
                    }, si("mail_add_community_template")))), o === ui && we.createElement("form", {
                        className: "TemplatesSettings__form",
                        id: "create_template_form",
                        onSubmit: this.saveTemplate
                    }, we.createElement("div", {
                        className: "TemplatesSettings__form-row"
                    }, we.createElement("label", {
                        className: "TemplatesSettings__label",
                        htmlFor: "name"
                    }, si("mail_name"), ":"), we.createElement("div", {
                        className: "TemplatesSettings__input-container"
                    }, we.createElement(ii, {
                        id: "name",
                        type: "text",
                        initialValue: a.name,
                        className: "TemplatesSettings__input",
                        onChange: this.onChangeEditableMessage.bind(null, "name")
                    }), we.createElement("span", {
                        className: "TemplatesSettings__notice"
                    }, si("mail_community_templates_input_size").replace("{min}", 2).replace("{max}", "200")))), we.createElement("div", {
                        className: "TemplatesSettings__form-row"
                    }, we.createElement("label", {
                        className: "TemplatesSettings__label",
                        htmlFor: "text"
                    }, si("mail_text"), ":"), we.createElement("div", {
                        className: "TemplatesSettings__input-container"
                    }, we.createElement(ii, {
                        id: "text",
                        name: "text",
                        isMultiLine: !0,
                        ref: this.getTextAreaRef,
                        initialValue: a.text,
                        className: "TemplatesSettings__textarea",
                        onChange: this.onChangeEditableMessage.bind(null, "text")
                    }), we.createElement("span", {
                        className: "TemplatesSettings__notice"
                    }, si("mail_community_templates_input_size").replace("{min}", 5).replace("{max}", "2 000")))), we.createElement("div", {
                        className: "TemplatesSettings__form-row"
                    }, we.createElement("label", {
                        className: "TemplatesSettings__label"
                    }, si("mail_hints"), ":"), we.createElement("div", {
                        className: "TemplatesSettings__input-container"
                    }, ai().map(function(t) {
                        return we.createElement(Pe.a, {
                            type: "button",
                            onMouseDown: e.addHint.bind(null, t),
                            appearance: "secondary",
                            className: "TemplatesSettings__hint",
                            key: t.id
                        }, t.label)
                    }))))), we.createElement("footer", {
                        className: "TemplatesSettings__footer"
                    }, o === ci && we.createElement(we.Fragment, null, we.createElement(Ae.a, {
                        onClick: function() {
                            return e.go(ui)
                        }
                    }, si("mail_add_community_template")), we.createElement(Pe.a, {
                        onClick: r
                    }, si("mail_close"))), o === ui && we.createElement(we.Fragment, null, we.createElement("div", null, a.id && we.createElement(Ae.a, {
                        onClick: this.deleteTemplate.bind(null, a.id)
                    }, si("mail_delete_community_template"))), we.createElement("div", null, we.createElement(Pe.a, {
                        appearance: "tertiary",
                        onClick: function() {
                            return e.go(ci)
                        }
                    }, si("mail_cancel")), we.createElement(Pe.a, {
                        onClick: this.saveTemplate,
                        form: "create_template_form",
                        type: "submit"
                    }, si("mail_save"))))))
                }, t
            }(we.Component);
        li.defaultProps = {
            section: ci
        };
        var di = Xt(li),
            _i = window.MessageBox;

        function fi(e, t) {
            return ai().reduce(function(t, n) {
                return t.replace(new RegExp("({" + n.id + "})", "gi"), n.process(e))
            }, t).replace(/&lt;br&gt;/gi, "<br>")
        }

        function pi(e, t, n, i, a) {
            var s = void 0;
            return {
                closeSettingsPopup: function() {
                    s && s.hide()
                },
                showSettingsPopup: function(e) {
                    var n = this;
                    (s = new _i({
                        hideButtons: !0,
                        bodyStyle: "padding: 0; background: none;",
                        width: 500,
                        onShow: function() {
                            var r = document.getElementById("TemplatesSettings");
                            r && Ee.render(we.createElement(Gt, {
                                value: t
                            }, we.createElement(di, {
                                popup: s,
                                section: e,
                                getTemplates: function() {
                                    return Object(o.v)(t)
                                },
                                saveTemplate: n.saveTemplate.bind(n),
                                deleteTemplate: n.deleteTemplate.bind(n),
                                closePopup: n.closeSettingsPopup.bind(n)
                            })), r), requestAnimationFrame(function() {
                                return s.updateBoxCoords()
                            })
                        }
                    }).content('<div id="TemplatesSettings"></div>')).show()
                },
                applyTemplate: function(e) {
                    var n = Object(o.v)(t).find(function(t) {
                        return t.id === e
                    });
                    Object(ye.d)(t, n.id), i(fi(t, Object(Fr.d)(n.text)))
                },
                getPreparedTemplates: function() {
                    return Object(o.v)(t).map(function(e) {
                        return Object.assign({}, e, {
                            name: e.name,
                            text: fi(t, e.text)
                        })
                    })
                },
                saveTemplate: function(e) {
                    var n = Object(Fr.a)(e.name),
                        i = Object(Fr.a)(e.text);
                    return t.set(e.id ? r.Cc.bind(null, e.id, n, i) : r.x.bind(null, n, i))
                },
                deleteTemplate: function(e) {
                    return t.set(r.A.bind(null, e))
                },
                isNeedRenderTemplates: function() {
                    return !!Object(o.o)(t) && (!!Object(o.B)(t) && !(Object(o.o)(t) > 2e9 && Object(L.m)(Object(o.g)(t), 1024)))
                },
                toggleImText: function() {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : this.isNeedRenderTemplates();
                    a(e)
                },
                update: function() {
                    this.toggleImText()
                },
                unmount: function() {
                    this.toggleImText(!1)
                }
            }
        }

        function mi(e, t) {
            return t.queues[e].currEv = !1, Promise.resolve(t)
        }

        function gi(e, t) {
            var n = t.queues[e].currEv;
            return n ? (t.queues[e].errored.push(n), mi(e, t)) : Promise.resolve(t)
        }

        function hi(e, t, n) {
            return n.queues[e] ? (n.queues[e].errored = t ? [] : n.queues[e].errored.concat(n.queues[e].evs), n.queues[e].evs = [], mi(e, n)) : Promise.resolve(n)
        }

        function bi(e, t, n, r) {
            var i = r.get().queues[e];
            if (i && !i.currEv && i.evs.length > 0 && !i.pause) {
                var o = bi.bind(null, e, t, n, r),
                    a = i.evs.shift();
                i.currEv = a, t(e, a).then(function() {
                    r.get().opts.waitCommit || r.set(mi.bind(null, e))
                }).then(o).catch(function(t) {
                    return r.set(gi.bind(null, e)).then(function() {
                        n(e, function(e, t) {
                            var n = vi(e, t.get()).errored;
                            return n.length > 0 && n[n.length - 1]
                        }(e, r), t)
                    }).then(o)
                })
            }
        }

        function vi(e, t) {
            return t.queues[e] || (t.queues[e] = {
                evs: [],
                pause: !1,
                errored: [],
                currEv: !1
            }), t.queues[e]
        }

        function yi(e, t, n) {
            return vi(e, n).pause = t, Promise.resolve(n)
        }

        function Oi(e) {
            Object.keys(e.get().queues).forEach(function(t) {
                e.set(gi.bind(null, t)), e.set(hi.bind(null, t, !1))
            })
        }

        function ji(e, t, n) {
            var r = m({
                queues: {},
                debug: n && n.debug,
                opts: extend({}, n)
            }, n);
            return n && n.store ? (r.setState(function(e) {
                for (var t = {}, n = Object.keys(e.queues), r = n.length, i = 0; i < r; i++) {
                    var o = n[i],
                        a = e.queues[o];
                    (a.currEv || a.evs.length || a.errored.length) && (t[o] = a)
                }
                return {
                    queues: t,
                    opts: e.opts
                }
            }(r.get())), Oi(r)) : Oi(r), {
                pushMessage: function(n, i) {
                    return r.set(function(e, t, n) {
                        return t.ts = Date.now(), vi(e, n).evs.push(t), Promise.resolve(n)
                    }.bind(null, n, i)).then(function(r) {
                        bi(n, e, t, r)
                    })
                },
                resend: function(n, i) {
                    return r.set(function(e, t, n) {
                        var r = n.queues[e];
                        return r.errored.filter(function(e) {
                            return e.mess.messageId === t
                        }).forEach(function(e) {
                            e.failed = !1, r.evs.push(e)
                        }), r.errored = r.errored.filter(function(e) {
                            return e.mess.messageId !== t
                        }), Promise.resolve(n)
                    }.bind(null, n, i)).then(function(o) {
                        var a = r.get().queues[n].evs.filter(function(e) {
                            return e.mess.messageId === i
                        })[0];
                        return bi(n, e, t, r), a
                    })
                },
                reset: function(n) {
                    return r.set(hi.bind(null, n, !0)).then(function(r) {
                        bi(n, e, t, r)
                    })
                },
                setErrored: function(e, t) {
                    return r.set(function(n) {
                        return vi(e, n).errored = t, Promise.resolve(n)
                    })
                },
                pause: function(e) {
                    r.set(yi.bind(null, e, !0))
                },
                isPaused: function(e) {
                    return !!vi(e, r.get()).pause
                },
                complete: function(n, i) {
                    var o = r.get();
                    o.queues[n].currEv && o.queues[n].currEv.rid === i && r.set(mi.bind(null, n)).then(function() {
                        bi(n, e, t, r)
                    })
                },
                resume: function(n) {
                    r.set(yi.bind(null, n, !1)).then(Object(_t.c)(.1)).then(function() {
                        bi(n, e, t, r)
                    })
                },
                inspectQueue: function(e) {
                    var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
                    if (!r.get().queues[e]) return [];
                    var n = r.get().queues[e];
                    return (t && n.currEv ? [n.currEv] : []).concat(n.evs.slice()).concat(n.errored.slice().map(function(e) {
                        return extend({}, e, {
                            failed: !0
                        })
                    })).sort(function(e, t) {
                        return e.ts - t.ts
                    })
                }
            }
        }
        var wi = n("hOuX"),
            Ei = n("rCUf"),
            ki = "_im_upload_dropbox",
            Ci = "jpg jpeg png gif heic heif".split(" "),
            xi = ["application/vnd.rn-realmedia-vbr", "application/vnd.rn-realmedia"];

        function Pi(e) {
            var t = Ci.slice(0, Ci.length);
            if ("types" === e) {
                for (var n = t.length, r = 0; r < n; ++r) t.push(t[r].toUpperCase());
                return "*." + t.join(";*.")
            }
            return "accept" === e ? "." + Ci.join(",.") : "mask" === e ? Ci.join("|") : ""
        }

        function Mi(e, t, n) {
            var r = void 0 !== t.ind ? t.ind : t,
                i = t.fileName ? r + "_" + t.fileName : t;
            if (re("upload" + i + "_progress_wrap"), e().unchoose(i), !geByClass1("popup_box_container")) {
                var o = getLang("mail_add_doc_error");
                "photo" === Upload.options[r].file_name ? o = getLang("mail_add_photo_error") : "video_file" === Upload.options[r].file_name && (o = getLang("video_upload_error")), setTimeout(showFastBox({
                    title: getLang("global_error")
                }, o).hide, 2e3)
            }
            topError("Upload failed", {
                dt: -1,
                type: 102,
                url: (ge("file_uploader_form" + r) || {}).action
            }), Upload.embed(r)
        }

        function Ti(e) {
            var t = void 0 !== e.ind ? e.ind : e,
                n = (e.fileName || e.filename || "").replace(/[&<>"']/g, ""),
                r = n ? t + "_" + n : e,
                i = ge("upload" + r + "_progress_wrap");
            return i && hide(geByClass1("progress_x", i)), r
        }

        function Ii(e, t) {
            if (!e().canAddMedia()) return "none";
            if (!t.items || !t.items.length) return "media";
            var n = "^(" + Pi("mask") + ")";
            return [].slice.call(t.items).every(function(e) {
                var t = e.type.split("/");
                return new RegExp(n, "i").test(t[1])
            }) ? "photo" : [].slice.call(t.items).every(function(e) {
                return "video" === e.type.split("/")[0] || ~xi.indexOf(e.type)
            }) ? "video" : "doc"
        }

        function Si(e) {
            var t = geByClass1(ki),
                n = geByClass1("im-page--chat-header").getBoundingClientRect(),
                r = geByClass1("im-chat-input").getBoundingClientRect();
            (n.width < 10 || r.bottom - n.bottom < 10) && (e = "none"), t.style.top = n.bottom + "px", t.style.left = n.left + 1 + "px", t.style.width = n.width - 2 + "px", t.style.height = r.bottom - n.bottom + "px", t.setAttribute("data-mode", e), "none" !== e && show(t)
        }

        function Di() {
            var e = geByClass1(ki);
            hide(e)
        }

        function Bi(e, t, n) {
            return {
                loaded: t,
                total: n,
                fileName: e.fileName ? e.fileName.replace(/[&<>"']/g, "") : void 0
            }
        }

        function Li(e, t, n, r) {
            "string" == typeof t && t.indexOf("TERMINATED") > -1 || Upload.onUploadError(e), r().reHeight(n)
        }

        function Ai(e, t, n, r) {
            var i = t.get().upload_opts,
                o = geByClass1("_im_upload_photo"),
                a = geByClass1("_im_drop_photo");
            return Upload.init(o, i.url, i.params, {
                accept: Pi("accept"),
                file_name: "photo",
                file_size_limit: 26214400,
                file_types: Pi("types"),
                file_match: i.opts.ext_re,
                lang: i.opts.lang,
                multiple: 1,
                multi_progress: 1,
                max_files: 10,
                chooseBox: 1,
                clear: 1,
                type: "photo",
                max_attempts: 3,
                server: i.opts.server,
                error: i.opts.default_error,
                error_hash: i.opts.error_hash,
                dropbox: a,
                dragEl: bodyNode,
                onNoFilteredCallback: function(e) {
                    Upload.onFileApiSend(r, e)
                },
                onUploadStart: function(e, t) {
                    delete cur.notStarted, this.onUploadProgress(e, 0, 0)
                },
                onUploadComplete: function(e, r) {
                    var i = window.parseJSON(r);
                    i.photos ? function(e, t, n, r) {
                        var i = Ti(e);
                        ajax.post("al_photos.php", extend({
                            act: "choose_uploaded"
                        }, t), {
                            onDone: function(e, t) {
                                r().choose("photo", e, extend(t, {
                                    upload_ind: i
                                }))
                            },
                            onFail: Mi.bind(null, r, e)
                        })
                    }(e, i, 0, n) : Li(e, r, t, n)
                },
                onUploadProgress: function(e, t, r) {
                    var i = void 0 !== e.ind ? e.ind : e;
                    n().progress("photo", i, Bi(e, t, r))
                },
                onUploadError: function(e, t) {
                    statlogsValueEvent("upload_photo_fails", 1, i.opts.server, t), Mi(n, e)
                },
                onDragEnter: function(e) {
                    var t = geByClass1("im-audio-message_recording");
                    e.dataTransfer && !t && Si(Ii(n, e.dataTransfer))
                },
                onDragOut: function() {
                    Di()
                },
                onDrop: function() {
                    Di()
                }
            })
        }

        function Ri(e, t, n) {
            var r = t.get().upload_doc_opts,
                i = geByClass1("_im_upload_doc"),
                o = geByClass1("_im_drop_doc");
            return Upload.init(i, r.url, r.params, {
                file_name: "file",
                file_size_limit: 209715200,
                file_types: "*.*;",
                lang: r.opts.lang,
                multiple: 1,
                multi_progress: 1,
                max_files: 10,
                chooseBox: 1,
                clear: 1,
                type: "doc",
                max_attempts: 3,
                server: r.opts.server,
                error: r.opts.default_error,
                error_hash: r.opts.error_hash,
                dropbox: o,
                dragEl: bodyNode,
                onUploadStart: function(e, t) {
                    delete cur.notStarted, this.onUploadProgress(e, 0, 0)
                },
                onUploadComplete: function(e, i) {
                    var o = window.parseJSON(i);
                    o.file ? function(e, t, n, r) {
                        var i = Ti(e),
                            o = {
                                act: "a_save_doc",
                                from: "choose",
                                mail_add: 1
                            };
                        n.opts.imhash && (o = extend(o, {
                            from_place: "from_gim",
                            imhash: n.opts.imhash
                        })), ajax.post("docs.php", extend(o, t), {
                            onDone: function(e, t, n) {
                                r().choose("doc", e + "_" + t, extend(n, {
                                    upload_ind: i
                                }))
                            },
                            onFail: Mi.bind(null, r, e)
                        })
                    }(e, o, r, n) : Li(e, i, t, n)
                },
                onUploadProgress: function(e, t, r) {
                    var i = void 0 !== e.ind ? e.ind : e;
                    n().progress("doc", i, Bi(e, t, r))
                },
                onUploadError: function(e, t) {
                    statlogsValueEvent("upload_doc_fails", 1, r.opts.server, t), Mi(n, e)
                }
            })
        }

        function Ni(e, t, n) {
            removeEvent(bodyNode, "dragover dragenter");
            var i = Ri(0, t, n),
                o = function(e, t, n, i) {
                    var o = t.get().upload_video_params;
                    if (o) {
                        var a = geByClass1("_im_upload_video"),
                            s = geByClass1("_im_drop_video");
                        return o.options.visible_dropbox = !1, Object(Ei.b)(a, s, o, null, {
                            onUploadStart: function(e, t) {
                                delete cur.notStarted, this.onUploadProgress(e, 0, 0)
                            },
                            onUploadComplete: function(e, i) {
                                var o = window.parseJSON(i);
                                o.video_id ? Object(Ei.d)(e, o, t.get().textMediaSelector, function(e, n) {
                                    var i = document.querySelector('[data-video="' + n + '"]'),
                                        o = e.editable.sizes.x[0] || e.thumb;
                                    if (i && o) {
                                        i.style.backgroundImage = "url(" + o + ")";
                                        var a = gpeByClass("_im_mess", i);
                                        "im" === cur.module && a && Object(r.Ec)(t, a)
                                    }
                                }) : Li(e, i, t, n)
                            },
                            onUploadProgress: function(e, t, r) {
                                var i = void 0 !== e.ind ? e.ind : e;
                                n().progress("video", i, Bi(e, t, r))
                            },
                            onUploadError: function(e, t) {
                                statlogsValueEvent("upload_video_fails", 1, o.options.server, t), Mi(n, e)
                            },
                            onNoFilteredCallback: function(e) {
                                Upload.onFileApiSend(i, e)
                            },
                            onDragEnter: function(e) {
                                var t = geByClass1("im-audio-message_recording");
                                e.dataTransfer && !t && Si(Ii(n, e.dataTransfer))
                            },
                            onDragOut: function() {
                                Di()
                            },
                            onDrop: function() {
                                Di()
                            }
                        })
                    }
                }(0, t, n, i),
                a = Ai(0, t, n, o);
            cur.lang.attachments_limit = t.get().upload_opts.opts.lang.max_files_warning;
            var c = Object(s.a)({
                handlers: function(e) {
                    var t = ge("im_full_upload");
                    e(t, "change", function r(i) {
                        if (window.Upload && i.target.files) {
                            if (n().canAddMedia()) {
                                var u = Array.from(i.target.files),
                                    l = u.filter(function(e) {
                                        return Upload.checkFileType(e.name, Pi("types"))
                                    }),
                                    d = u.filter(function(e) {
                                        return Upload.checkFileType(e.name, Object(Ei.c)("types"))
                                    });
                                Upload.onFileApiSend(a, l), Upload.onFileApiSend(o, d)
                            } else showFastBox(getLang("global_error"), getLang("global_error"));
                            Object(s.c)(c);
                            var _ = t.cloneNode();
                            t.parentNode.replaceChild(_, t), e(t = _, "change", r)
                        }
                    })
                }
            });
            return {
                paste: function(e) {
                    Upload.onFileApiSend(a, e)
                },
                unmount: function() {
                    Object(s.c)(c), Upload.deinit(a), Upload.deinit(o), Upload.deinit(i)
                }
            }
        }
        var Ui = n("wSs/"),
            Wi = n("eTng");
        var Hi = 4,
            Ki = 5,
            qi = 6,
            Fi = 7,
            zi = 9,
            Vi = 11,
            Qi = 12,
            Gi = 13,
            Xi = 14,
            Yi = 16,
            Ji = 19,
            Zi = 20,
            $i = 23,
            eo = 2e3,
            to = "_im_media_selector",
            no = "_im_media_fwd",
            ro = "_im_replied_content",
            io = "_im_fwd_close",
            oo = "_im_remove_replied",
            ao = "_im_peer_mute_unmute",
            so = "_im_peer_return_to_chat",
            co = "_mr_button_accept",
            uo = "_mr_button_reject",
            lo = "_im_submit_btn",
            _o = "_im_media_preview",
            fo = "_im_chat_audio_input_parent";

        function po(e, t) {
            if (!e) return !1;
            window.tooltips && tooltips.hide(e, t)
        }

        function mo(e, t, n, r, o, a) {
            var s = !(arguments.length > 6 && void 0 !== arguments[6]) || arguments[6];
            if (Ro(t, r)) return Promise.resolve(!1);
            var u = jo(r);
            u.getBoundAttach(n.message) && (n.message = ""), n.share_url = u.getShareUrl(), n.cancelled_shares = u.getCancelledShares();
            var l, d = Object(wi.a)(),
                _ = {
                    peerId: t,
                    messageId: "rid" + d,
                    flags: c.m,
                    date: intval(Date.now() / 1e3) - r.get().timeshift,
                    subject: "",
                    text: Object(i.Fb)(clean(n.message)).replace(/\n/gi, "<br>"),
                    local: !0,
                    kludges: {
                        emoji: !0,
                        from_admin: r.get().gid ? vk.id : null
                    },
                    type: c.a,
                    attaches: (l = n.attaches, l.map(function(e) {
                        return {
                            id: e[1],
                            type: e[0],
                            kind: e[2] || null
                        }
                    }))
                };
            return n.rid = d, n.mess = _, e(t, n), r.get().longpoll.push([_]), s && a().clearText(t, r), o().newMessage(r), Promise.resolve(!0)
        }

        function go(e, t, n, r, i, o, a) {
            var s = arguments.length > 7 && void 0 !== arguments[7] && arguments[7];
            s || (s = e.get().peer);
            var c = jo(e),
                u = ho(c, a),
                l = u ? c.dData.attaches.map(function(e) {
                    return [e.type, e.id]
                }) : [],
                d = {
                    message: "",
                    attaches: [].concat(l, o)
                };
            a && extend(d, a), bo(e, t, !1).then(function() {
                return mo(n, s, d, e, t, r, !1).then(function(n) {
                    return u && Mo(e, i, t), Promise.resolve(n)
                })
            }).catch(function(t) {
                debugLog(t), Oo(e, i)
            })
        }

        function ho(e, t) {
            var n = e.dData,
                r = t && t.sticker_referrer,
                i = r && 0 === r.indexOf("suggestion");
            return (!n.txt.trim() || i) && 0 === n.attaches.filter(function(e) {
                return "reply" !== e.type
            }).length
        }

        function bo(e, t, n) {
            return e.get().tabs[e.get().peer].skipped > 0 ? (t().loadingPeer(e), e.setState({
                no_moving_down: !0
            }), e.set(r.p.bind(null, e.get().peer, !1, !1)).then(function() {
                return e.set(r.Sa.bind(null, e.get().peer, !0, -1, !1))
            }).then(function() {
                return t().changePeer(e, !1), e.setState({
                    no_moving_down: !1
                }), n
            })) : Promise.resolve(n)
        }

        function vo(e, t, n, i) {
            return !e.get().delayed_ts && setTimeout(function() {
                e.set(r.Tb.bind(null, !1, !1)).then(function() {
                    n.apply(void 0, function(e) {
                        if (Array.isArray(e)) {
                            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                            return n
                        }
                        return Array.from(e)
                    }(i))
                })
            }, t)
        }

        function yo() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : getLang("mail_send_error"),
                t = getLang("global_error");
            showFastBox({
                title: t
            }, e, getLang("mail_ok"), function() {
                nav.reload({
                    force: !0
                })
            })
        }

        function Oo(e, t) {
            document.activeElement && document.activeElement.blur(), yo();
            var n = geByClass1("_im_send", t);
            return e.set(r.lc.bind(null, !0)).then(function() {
                Object(i.ib)(n)
            })
        }

        function jo(e) {
            return e.get().tfdraft || new an.a
        }

        function wo(e, t, n, a, s, c) {
            var u = arguments,
                l = Object(o.o)(e),
                d = Object(o.f)(e) || {},
                _ = d.one_time,
                f = void 0 !== _ && _,
                p = d.author_id,
                m = geByClass1("_im_send", a);
            return Promise.resolve().then(function() {
                if (Object(o.N)(e)) {
                    if (Object(r.V)(e.get()) || !Object(i.Oa)(e, e.get().peer)) {
                        var a = vo(e, eo, wo, Object(g.p)(u));
                        return e.set(r.Tb.bind(null, !0, a)).then(function() {
                            Object(i.ib)(m)
                        })
                    }
                    return clearTimeout(e.get().delayed_ts), e.set(r.Tb.bind(null, !1, !1)).then(function() {
                        return Object(i.ic)(m)
                    }).then(bo.bind(null, e, t)).then(function() {
                        var r = Object(Fr.a)(c.action.label);
                        Object(i.Ha)(l) && (r = "@" + Object(B.c)(e, p).link.slice(1) + " " + r);
                        return Object(D.c)("message_send_from_keyboard", 0, e.get().id, l, p), mo(n, l, {
                            message: r,
                            attaches: [],
                            payload: Object(Fr.a)(c.action.payload)
                        }, e, t, s, !1)
                    }).then(function() {
                        return f ? e.set(r.z.bind(null, l)) : Promise.resolve()
                    }).then(function() {
                        return s().fixKeyboard()
                    })
                }
            }).catch(function(t) {
                debugLog(t), Oo(e, a)
            })
        }

        function Eo(e, t, n, a, s, u) {
            var l = arguments,
                d = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : [];
            return Promise.resolve().then(function() {
                var _ = geByClass1("_im_send", a);
                if (!Object(o.N)(e)) return !1;
                if (Object(r.V)(e.get()) || !Object(i.Oa)(e, e.get().peer)) {
                    var f = vo(e, eo, Eo, Object(g.p)(l));
                    return e.set(r.Tb.bind(null, !0, f)).then(function() {
                        Object(i.ib)(_)
                    })
                }
                clearTimeout(e.get().delayed_ts), s().saveText(e);
                var p = !1,
                    m = jo(e),
                    h = m.dData.attaches.map(function(e) {
                        if ("poll" == e.type) {
                            var t = u.pollData();
                            return t || (p = !0), [e.type, e.id, t]
                        }
                        return [e.type, e.id]
                    }).concat(d);
                if (p) return !1;
                var b = e.set(r.Tb.bind(null, !1, !1)).then(function() {
                        Object(i.ic)(_)
                    }),
                    v = Object(o.o)(e);
                return b.then(bo.bind(null, e, t)).then(function() {
                    var o = m.dData.txt,
                        u = t().getEditingMessage();
                    if (u || o || h.length) {
                        if (u) return o || h.length && !m.hasOnlyReplies(u) ? Object(i.Sa)(o) ? void showFastBox(getLang("global_error"), getLang("mail_err_edit_too_long")) : (t().cancelEditing(), void(Object(Ui.e)(e, u, m) && (Object(Ui.d)(e, u, o, h, m.getShareUrl(), m.getCancelledShares()), t().sendEditMessage(e, u), e.get().longpoll.push([Object(c.Ia)(u)])))) : void
                        function(e, t, n, i) {
                            var o = e.get(),
                                a = o.peer,
                                s = showFastBox({
                                    title: getLang("mail_dialog_msg_delete_title"),
                                    dark: 1
                                }, getLang("mail_dialog_msg_delete_for_all"), getLang("mail_delete"), function(e) {
                                    Object(r.lb)([i], a, null, "deleteforall", o), s.hide(), t().cancelEditing()
                                }, getLang("global_cancel"), function() {
                                    s.hide(), Co(geByClass1("_im_text", n))
                                })
                        }(e, t, a, u.messageId);
                        var l = Object(i.cc)(o, h).map(function(r) {
                            return mo(n, v, {
                                message: r.msgText || "",
                                attaches: r.attaches || []
                            }, e, t, s)
                        });
                        return Promise.all(l)
                    }
                })
            }).catch(function(t) {
                debugLog(t), Oo(e, a)
            })
        }

        function ko(e, t, n, a, s, c, u) {
            var l = void 0,
                d = debounce(function(e, t, n) {
                    var r = e.get().peer,
                        o = Emoji.val(n);
                    Object(i.Ya)(r) || jo(e).dData.txt == o || Ro(r, e) || (t.checkMessageURLs(o, !0, eo), jo(e).setText(o))
                }.bind(null, e, n), 500);
            var _ = Emoji.init(geByClass1("_im_text", t), {
                ttDiff: 93,
                rPointer: !0,
                ref: "im",
                onSend: function() {
                    return Ho(e, t).then(function(e) {
                        return e && a([])
                    })
                },
                controlsCont: t,
                forceTxt: !e.get().editable,
                checkEditable: function(n, a) {
                    var s = e.get().peer,
                        c = Emoji.val(a);
                    Object(i.Ya)(s) || Ro(s, e) || jo(e).dData.txt == c || !c || function(e) {
                        var t = e.get().peer;
                        Object(i.Oa)(e, t) && !Object(o.x)(e) && Date.now() - (Object(o.t)(e, t).lastTyping || 0) > 1e3 * r.b && e.set(r.Nb.bind(null, t))
                    }(e), Ko(e, t, c), d(a);
                    var _ = t.offsetHeight;
                    if (l && l !== _) {
                        var f = u().updateScroll();
                        u().scrollFix(e, e.get().peer, f)
                    }
                    l = _
                },
                onStickerSend: function(e, t, n) {
                    return s([
                        ["sticker", e, n]
                    ], {
                        sticker_referrer: t
                    })
                },
                uploadActions: c
            });
            return Emoji.emojiLoadMore(_), e.setState({
                emojiOptId: _
            }), _
        }

        function Co(e) {
            Emoji.focus(e, !0), setTimeout(Emoji.correctCaret.pbind(e), 10)
        }

        function xo(e, t, n, r) {
            var s = e.getFwdRaw(),
                c = t.querySelector("." + no),
                u = t.parentNode.querySelector("." + ro);
            if (!(Object(o.f)(r) || {}).hide && s && n.toggleKeyboard(!0), c.innerHTML = "", u.innerHTML = "", s) {
                var l = function(e, t) {
                        if (e.get().isEditing) {
                            var n = Object(i.X)(e);
                            return n && Object(a.c)(n)
                        }
                        return "reply" === t.type
                    }(r, s),
                    d = l ? u : c,
                    _ = s.object;
                d.innerHTML = l ? Po(_) : function(e, t, n, r) {
                    if (n.object && n.object.authorName) {
                        var o = Object(i.Cb)(0, "", r.text, !0, Object(Wi.a)(r.kludges, 0));
                        return getTemplate("im_attach_mess", {
                            messages: o,
                            text: r.authorName,
                            date: getSmDate(r.date, e.get().timeshift),
                            modifier: "im-fwd_msg"
                        })
                    }
                    return getTemplate("im_attach_mess", {
                        messages: getLang("mail_title_X_msgs", t.getFwdCount()),
                        text: getLang("mail_im_fwd_msgs_title"),
                        date: "",
                        modifier: ""
                    })
                }(r, e, s, _)
            }
        }

        function Po(e) {
            var t = Object(i.Cb)(0, "", e.text, !0, Object(Wi.a)(e.kludges, 0));
            return getTemplate("im_replied_message", {
                authorName: e.authorName,
                text: t
            })
        }

        function Mo(e, t, n) {
            e.set(r.K.bind(null, null, jo(e), !1)).then(function() {
                var r = t.querySelector("." + no),
                    i = t.parentNode.querySelector("." + ro),
                    o = document.querySelector("." + fo + " ." + ro);
                i && i.children.length && (i.innerHTML = "", To(e, n)), o && o.children.length && (o.innerHTML = "", To(e, n)), r && r.children.length && (r.innerHTML = "", To(e, n)), Ko(e, t)
            })
        }

        function To(e, t) {
            var n = t().updateScroll();
            t().scrollFix(e, e.get().peer, n)
        }
        var Io = "close",
            So = "open",
            Do = "hide";

        function Bo(e, t, n, r, a, s, c) {
            if (c !== Io && c !== So && c !== Do) throw new Error('Action "' + c + '" not found');
            var u = e.get(),
                l = Object(o.f)(e);
            (Object(i.Ja)(e) || !l || u.isEditing) && (c = Do);
            var d = c === Io || c === Do,
                _ = Promise.resolve();
            return d || n.isMounted || (_ = n.init()), _.then(function() {
                return toggleClass(t, "im-chat-input_open-keyboard", !d), toggleClass(t, "im-chat-input_close-keyboard", d && c !== Do), toggleClass(r, "im_chat-input--keyboard-button_hidden", c === Do), n.toggle(u.peer, d, s)
            }).then(function() {
                var t = a().updateScroll();
                return a().scrollFix(e, u.peer, t)
            })
        }

        function Lo(e, t, n, r, a, c, u, l, d, _, f, p, m) {
            return {
                restoreKeyboard: function() {
                    this.toggleKeyboard(!!(ls.get("is_keyboards_hide") || {})[Object(o.o)(e)])
                },
                toggleKeyboard: function() {
                    var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : !Object(o.f)(e).hide,
                        n = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                    return Bo(e, r, p, f, c, n, t ? Io : So)
                },
                initKeyboard: function() {
                    if (!e.get().peer || !Object(o.f)(e)) return Promise.resolve();
                    var t = !!(ls.get("is_keyboards_hide") || {})[Object(o.o)(e)];
                    return Bo(e, r, p, f, c, !0, t ? Io : So)
                },
                fixKeyboard: function() {
                    var t = Object(o.f)(e),
                        n = void 0;
                    return n = t ? t.hide ? Io : So : Do, Bo(e, r, p, f, c, !0, n)
                },
                hideKeyboard: function() {
                    return Bo(e, r, p, f, c, !1, Do)
                },
                restoreDraft: function(e, a) {
                    var s = this;
                    t.chosenMedias.length > 0 && (e.setState({
                        removingMedias: !0
                    }), t.unchooseMedia(), t.chosenMedias = [], e.setState({
                        removingMedias: !1
                    }));
                    var u = e.get().peer,
                        l = Object(i.fb)(u) && u != vk.id && !e.get().gid,
                        d = Object(i.fb)(u) && u != vk.id && !e.get().gid && !inArray(u, e.get().moneyTransferExcept) || Object(i.Ka)(u) && e.get().moneyTransferCommAvail && Object(o.g)(e).moneyTransferAvail && !e.get().gid || e.get().gid && e.get().moneyRequestAvail || Object(i.Ha)(u) && Object(o.g)(e).moneyRequestAvail;
                    if (toggle(geByClass1("ms_item_gift", r), l && !Object(o.x)(e)), toggle(geByClass1("ms_item_money", r), d && !Object(o.x)(e)), toggle(geByClass1("ms_item_poll", r), Object(i.Ha)(u)), Object(i.Ya)(u)) return Promise.resolve();
                    var _ = jo(e);
                    return Emoji.val(n) !== _.dData.txt ? function(e, t) {
                        Emoji.val(e, clean(t)), Co(e)
                    }(n, _.dData.txt) : Co(n), _.prepareObjects(e.get().gid, a && a.messageId).then(function() {
                        if (!Wo(e, u, n) && u == e.get().peer) {
                            for (var i = _.dData.attaches, o = 0; o < i.length; o++) t.chooseMedia(i[o].type, i[o].id, i[o].object || {});
                            xo(_, r, s, e);
                            var a = c().updateScroll();
                            c().scrollFix(e, u, a), Ko(e, r, _.dData.txt)
                        }
                    })
                },
                sendMessage: function() {
                    a([])
                },
                choose: function(e, n, r) {
                    t.chooseMedia(e, n, r)
                },
                updateChosenMedia: function(e, n, r) {
                    t.updateChosenMedia(e, n, r)
                },
                canAddMedia: function() {
                    return !t.hasRestrictingAttach() && !Ro(e.get().peer, e)
                },
                isEmpty: function(e) {
                    return !trim(Emoji.val(n)) && !jo(e).hasAttaches()
                },
                unchoose: function(e) {
                    t.unchooseMedia(e)
                },
                attachCount: function() {
                    return t.attachCount()
                },
                progress: function(e, n, r) {
                    show(_o), t.showMediaProgress(e, n, r)
                },
                updateState: function(e) {
                    this.restoreKeyboard(), Wo(e, e.get().peer, n)
                },
                focusOn: function(e) {
                    Emoji.editableFocus(n, !1, !0)
                },
                setDraft: function(e, t) {
                    var n = Object(o.t)(e, e.get().peer);
                    Object(L.m)(n, 1024) && !e.get().gid || (m.update(), e.setState({
                        tfdraft: t
                    }), t && this.restoreDraft(e, c().getEditingMessage()))
                },
                clearText: function(e, i) {
                    jo(i).clear(), t.cancelCheckUrl(), t.unchooseMedia(), t.chosenMedias = [], Emoji.val(n, ""), Mo(i, r, c);
                    var o = c().updateScroll();
                    c().scrollFix(i, i.get().peer, o)
                },
                attachMessages: function(e, t) {
                    if (e.get().peer === t) {
                        xo(jo(e), r, this, e);
                        var n = c().updateScroll();
                        c().scrollFix(e, t, n), Ko(e, r)
                    }
                },
                cancelRecording: function() {
                    _.cancelRecording()
                },
                reHeight: function(e) {
                    var t = c().updateScroll();
                    c().scrollFix(e, e.get().peer, t)
                },
                isBlocked: function() {
                    return Ro(e.get().peer, e)
                },
                toggleStickers: function(e, t) {
                    Emoji.toggleStickers(e.get().emojiOptId, !t)
                },
                saveText: function(e) {
                    jo(e).setText(Emoji.val(geByClass1("_im_text", r)))
                },
                unmount: function() {
                    Object(s.c)(d), t.destroy(), l.unmount(), p.unmount(), m.unmount(), Emoji.destroy(e.get().emojiOptId), _.unmount()
                }
            }
        }

        function Ao(e, t) {
            return !!Object(i.Ha)(e) && t.get().tabs[e].data.kicked
        }

        function Ro(e, t) {
            return Ao(e, t) || Object(o.t)(t, e) && Object(o.t)(t, e).block_error > 0 || Object(i.Ra)(t) && Object(i.Va)(e, t)
        }

        function No(e, t) {
            e.disabled = !0, e.contentEditable = "false", addClass(e, "im-chat-input--text_disabled"), addClass(t, "im-chat-input_error"), addClass(geByClass1("_im_page_history"), "is_tf_blocked")
        }

        function Uo(e, t) {
            e.disabled = !1, e.contentEditable = "true", removeClass(e, "im-chat-input--text_disabled"), removeClass(t, "im-chat-input_error"), removeClass(geByClass1("_im_page_history"), "is_tf_blocked")
        }

        function Wo(e, t, n) {
            var r = gpeByClass("_im_chat_input_parent", n),
                a = geByClass1("_im_chat_input_error", r),
                s = Object(o.t)(e, t);
            if (Ro(t, e)) {
                No(n, r);
                var c = function(e, t, n) {
                    switch (n.block_error) {
                        case Fi:
                        case Ki:
                            return getLang("mail_peer_deleted");
                        case Xi:
                            return getLang("mail_community_deleted");
                        case Vi:
                            return getLang("mail_group_banned_messages");
                        case Hi:
                        case qi:
                        case zi:
                        case Ji:
                        case Zi:
                        case Gi:
                            return Object(i.Ka)(t) ? getLang("mail_send_privacy_community_error") : getLang("mail_send_privacy_error");
                        case $i:
                            var r = Object(B.c)(e, t);
                            return langSex(r.sex, getLang("mail_blacklist_user", "raw")).replace("{user}", r.kick_name);
                        case Qi:
                            return getLang("mail_cant_send_messages_to_community");
                        case Yi:
                            return getLang("mail_chat_youre_kicked");
                        case 0:
                            if (Ao(t, e)) return getLang("mail_chat_youre_kicked");
                            var o = e.get().block_states[t].name;
                            return getLang("mail_community_answering").replace("{username}", o);
                        default:
                            return getLang("mail_send_privacy_error")
                    }
                }(e, t, s);
                if (Object(o.y)(e, Object(o.t)(e, t)) && addClass(geByClass1("_im_page_history"), "is_channel"), Object(i.Pa)(e, t) && !e.get().gid) {
                    addClass(r, "is-f-vkcomgroup");
                    var u = inArray(t, e.get().mutedPeers);
                    c = s.data.closed || s.data.kicked ? getTemplate("sImPeerReturnToChat", {
                        text: getLang("mail_return_to_vkcomgroup")
                    }) : getTemplate("sImPeerMuteUnmute", {
                        text: u ? getLang("mail_im_unmute") : getLang("mail_im_mute"),
                        cls: u ? "im-action_unmute" : "im-action_mute"
                    })
                } else removeClass(r, "is-f-vkcomgroup");
                return val(a, c), !0
            }
            return s && s.is_message_request ? (No(n, r), addClass(r, "is-message_request"), val(a, getTemplate("sImPeerAcceptOrRejectMessageRequest", {
                cls_accept: co,
                cls_reject: uo
            })), !0) : (r.classList.contains("is-message_request") && (Uo(n, r), removeClass(r, "is-message_request"), val(a, "")), n.disabled && (removeClass(r, "is-f-vkcomgroup"), removeClass(geByClass1("_im_page_history"), "is_channel"), Uo(n, r), removeClass(r, "is-message_request"), val(a, "")), !1)
        }

        function Ho(e, t, n) {
            return Object(i.gb)(e).then(function(r) {
                if (!r && !Object(o.x)(e)) return !0;
                var a = null != n ? n : Emoji.val(geByClass1("_im_text", t));
                if (trim(a)) return !Object(o.x)(e) || !Object(i.Sa)(a);
                var s = jo(e),
                    c = Object(i.X)(e);
                return s.hasAttaches() && !s.hasOnlyReplies(c)
            })
        }

        function Ko(e, t, n) {
            var r = geByClass1("_im_send", t.parentNode);
            po(r, {
                fasthide: !0
            }), Ho(e, t, n).then(function(t) {
                if (Object(o.x)(e)) toggleClass(r, "is_input_empty", !t), attr(r, "aria-label", getLang("mail_im_edit"));
                else {
                    toggleClass(r, "im-send-btn_audio", !t), toggleClass(r, "im-send-btn_send", t), t && removeClass(r, "im-send-btn_saudio");
                    var n = t ? getLang("mail_send2") : getLang("mail_added_audiomsg");
                    attr(r, "aria-label", n)
                }
            })
        }

        function qo(e, t, n, a, u) {
            cur.share_timehash = t.get().share_timehash;
            var l = Object(s.b)(Lo),
                d = l.callMutations,
                _ = l.bindMutations,
                f = Ni(0, t, d),
                p = function(e, t, n) {
                    return e.set(r.D.bind(null, t, n, {}))
                }.bind(null, t);
            ls.remove("im_send_queue_2" + vk.id), ls.remove("im_send_queue_1" + vk.id);
            var m = ji(p, function(e, t, n, r) {
                    e.get().longpoll.push([c.Ka(t, n.mess, r)])
                }.bind(null, t), {
                    store: "ls",
                    key: "im_send_queue_" + vk.id,
                    waitCommit: !0
                }),
                h = m.pushMessage,
                b = m.inspectQueue,
                v = m.resend,
                y = m.setErrored,
                O = m.complete,
                j = go.bind(null, t, u, h, d, e),
                w = function(e) {
                    var t = jo(e).getFwdRaw();
                    t && window.showForwardBox({
                        act: "a_show_forward_box",
                        will_fwd: t.id,
                        gid: e.get().gid
                    })
                }.bind(null, t);
            hide(geByClass1("ms_items_more_helper", e));
            var E = t.get().mediaTypes || [
                ["photo", getLang("mail_added_photo")],
                ["video", getLang("profile_wall_video")],
                ["audio", getLang("profile_wall_audio")],
                ["doc", getLang("profile_wall_doc")],
                ["map", getLang("profile_wall_map")],
                ["gift", getLang("profile_wall_gift")]
            ];
            (t.get().moneyTransferAvail || t.get().moneyRequestAvail) && E.push(["money", getLang("profile_wall_money")]);
            var k = new MediaSelector(geByClass1(to, e), _o, E, {
                    from: "message",
                    maxShown: 0,
                    vectorIcon: !0,
                    ignoreMobile: !0,
                    onAddMediaChange: function(n, i, o, a) {
                        return n && d().toggleKeyboard(!0),
                            function(e, t, n, i, o, a, s, c, u) {
                                if (!t.get().removingMedias) {
                                    if ("album" === o || "page" === o || "mail" === o || "reply" === o) return !1;
                                    if ("share" === o && !s.title) return !1;
                                    var l, d;
                                    show(_o), a && "string" == typeof o ? (c && jo(t).addBindUrl(c, o, a), jo(t).addAttach(o, a, s)) : (jo(t).syncWithSelector(u), "number" == typeof a && u.chosenMedias[a] && (l = u.chosenMedias[a], d = jo(t), "string" == typeof l[0] && "string" == typeof l[1] && l[1] && d.dData.cancelled.push(l[0] + "," + l[1])));
                                    var _ = e().updateScroll();
                                    if (e().scrollFix(t, t.get().peer, _), t.get().delayed_message && !Object(r.V)(t.get())) return n([]), !1;
                                    Ko(t, i)
                                }
                            }(u, t, C, e, n, i, o, a, k)
                    },
                    onMediaChange: function() {
                        return function(e, t, n, r, i) {
                            if (!t.get().removingMedias) {
                                var o = i.getMedias().find(function(e) {
                                    return "poll" === e[0]
                                });
                                o && jo(t).addAttach(o[0], o[1], i.pollData(!0, !0)), Ko(t, r)
                            }
                        }(0, t, 0, e, k)
                    },
                    editable: 1,
                    onChangedSize: function() {
                        var n, r, i = u().updateScroll();
                        u().scrollFix(t, t.get().peer, i), n = e, r = ge(_o).offsetHeight, toggleClass(n, "im-chat-input--overflowed", r > 400)
                    },
                    sortable: 1,
                    teWidth: 150,
                    mail: 1,
                    teHeight: 100,
                    forceToUp: !0,
                    toId: t.get().gid ? -t.get().gid : void 0,
                    blockPersonal: t.get().gid ? 1 : 0,
                    docParams: t.get().gid ? {
                        imhash: t.get().upload_doc_opts.opts.imhash,
                        from: "from_gim"
                    } : {}
                }),
                C = Eo.bind(null, t, u, h, e, d, k),
                x = function(e, t, n) {
                    var r = Emoji.val(geByClass1("_im_text", t));
                    Object(o.x)(e) && "" !== r || Ho(e, t).then(function(t) {
                        var i = intval(domData(n.target, "tttype"));
                        (2 === i && !0 !== t || 1 === i && !0 === t || 3 !== i && "" === r) && window.tooltips && tooltips.destroy(n.target, {
                            fasthide: !0
                        });
                        var a = jo(e).dData.attaches.length > 0;
                        if (Object(o.x)(e) && "" === r && !a) return domData(n.target, "tttype", 3), showTooltip(n.target, {
                            text: getLang("mail_delete_for_all"),
                            black: !0,
                            force: 3 !== i,
                            appendParentCls: "_im_chat_input_parent",
                            shift: [-8, -10]
                        });
                        if (!0 !== t) return domData(n.target, "tttype", 1), showTooltip(n.target, {
                            text: getLang("mail_added_audiomsg"),
                            black: !0,
                            force: 1 !== i,
                            appendParentCls: "_im_chat_input_parent",
                            shift: [-8, -10]
                        });
                        domData(n.target, "tttype", 2);
                        var s = e.get().ctrl_submit ? 1 : 0;
                        return showTooltip(n.target, {
                            text: getTemplate("ctrl_submit_hint", {
                                enter_on: s ? "" : "on",
                                ctrl_on: s ? "on" : ""
                            }),
                            dir: "down",
                            shift: [-28, -5],
                            needLeft: !0,
                            className: "im-chat-input--tt",
                            hasover: !0,
                            force: 2 !== i,
                            showdt: 700,
                            zIndex: 200,
                            hidedt: 700,
                            appendParentCls: "_im_chat_input_parent",
                            onCreate: function() {
                                radioBtns.im_submit = {
                                    els: Object(g.p)(geByClass(lo)),
                                    val: s
                                }
                            }
                        })
                    })
                }.bind(null, t, e),
                P = geByClass1("_im_send", e),
                M = go.bind(null, t, u, h, d, e),
                T = Kr(e, t, M, function() {
                    addClass(P, "im-send-btn_audio"), removeClass(P, "im-send-btn_static")
                }, function() {
                    d().restoreKeyboard()
                });
            toggle(geByClass1("ms_item_poll", e), Object(i.Ha)(Object(o.o)(t))),
                function(e, t) {
                    var n = geByClass1("_im_text", e);
                    Wall.initComposer(n, {
                        lang: {
                            introText: getLang("profile_mention_start_typing"),
                            noResult: getLang("profile_mention_not_found")
                        },
                        toup: !0,
                        getValue: function() {
                            return t.get().peer > 2e9 ? (window.Emoji && Emoji.editableVal || val)(n) : ""
                        },
                        onShow: function() {
                            addClass(e, "im_mention_shown");
                            var t = data(n, "composer");
                            if (t && t.wdd && t.wdd.shown) {
                                var r = 0,
                                    i = !1,
                                    o = function() {
                                        t.ignoredTerm = t.curTerm, t.curTerm = !1, val(t.wddInput, ""), Composer.toggleSelectList(t)
                                    };
                                each(t.wdd.shown, function() {
                                    this[0] && (r++, "@" + t.curTerm == this[2] && (i = !0))
                                }), !r || i && 1 == r ? o() : cancelStackPush("im_mention", o)
                            }
                        },
                        onHide: function() {
                            removeClass(e, "im_mention_shown"), cancelStackFilter("im_mention")
                        },
                        searchKeys: [1, 7],
                        wddOpts: {}
                    })
                }(e, t), t.get().textMediaSelector = k, t.set(r.T.bind(null, b, v, y, O));
            var I = geByClass1("_im_text", e);
            setTimeout(function() {
                Object(o.o)(t) && d().setDraft(t, Object(o.u)(Object(o.g)(t))), ko(t, e, k, C, j, f, u)
            }, 0);
            var S = Mo.bind(null, t, e, u),
                D = function(e, t, n) {
                    var i = Object(o.o)(e);
                    e.set(r.f.bind(null, i)).then(function() {
                        Wo(e, i, t), n()
                    }).catch(function() {
                        return yo()
                    })
                }.bind(null, t, I, function() {
                    var e = u().updateScroll();
                    u().scrollFix(t, Object(o.o)(t), e)
                }),
                B = function(e, t, n) {
                    var a = Object(o.o)(e);
                    e.set(r.gb.bind(null, a)).then(function() {
                        var t = e.get().tabbedPeers.filter(function(e) {
                            return e.peer !== a
                        });
                        return e.set(r.Bc.bind(null, t, !0))
                    }).then(function() {
                        Object(i.Ja)(e) && t(e), n(e, a), a === e.get().peer && e.get().longpoll.push([Object(c.ab)()])
                    }).catch(function() {
                        return yo()
                    })
                }.bind(null, t, n, a),
                L = function(e, t, n, i) {
                    var o = e.get().peer,
                        a = inArray(o, e.get().mutedPeers);
                    e.set(r.kc.bind(null, o, !a)).then(n().updateState.bind(null, o)), cancelEvent(i)
                }.bind(null, t, e, u),
                A = function(e, t, n, i) {
                    var o = e.get().peer;
                    e.set(r.zb.bind(null, o)).then(function(e) {
                        return e.set(r.Q.bind(null, o))
                    }).then(n().updateChatTopic.bind(null, o)), cancelEvent(i)
                }.bind(null, t, e, u),
                R = function(e, t, n) {
                    var i = !!intval(domData(n, "val"));
                    i !== cur.ctrl_submit && (cur.ctrl_submit = i, e.set(r.q.bind(null, i)))
                }.bind(null, t);
            Wo(t, t.get().peer, I);
            var N = e.querySelector("._im_keyboard_button"),
                U = function(e, t, n, r, i) {
                    return (0, Object(s.b)(Zr).bindMutations)(Object(s.a)({
                        handlers: function(e, t) {}
                    }), t, r)
                }(0, t, 0, wo.bind(null, t, u, h, e, d)),
                W = function(e, t, n, r) {
                    var i = (0, Object(s.b)(pi).bindMutations)(Object(s.a)({
                        handlers: function(e, t) {}
                    }), e, t, n, r);
                    i.toggleImText();
                    var o = we.createElement(Gt, {
                        value: e
                    }, we.createElement(ei, {
                        getTemplates: i.getPreparedTemplates,
                        applyTemplate: i.applyTemplate.bind(i),
                        isNeededRendering: i.isNeedRenderTemplates,
                        showSettingsPopup: i.showSettingsPopup.bind(i, ci),
                        showCreatingTemplatePopup: i.showSettingsPopup.bind(i, ui)
                    }));
                    return Ee.render(o, t), i
                }(t, e.querySelector("._message_templates_container"), function(e) {
                    return ni(I, e)
                }, function(t) {
                    return toggleClass(e, "im-chat-input--textarea_show-templates", t)
                }),
                H = Object(s.a)({
                    handlers: function(n, i) {
                        n(P, "click", function() {
                            Promise.resolve().then(function() {
                                return Ho(t, e)
                            }).then(function(e) {
                                if (e || Object(o.x)(t)) C([]);
                                else {
                                    var n = jo(t);
                                    ho(n) && function(e) {
                                        var t = document.querySelector("." + fo + " ." + ro),
                                            n = e.getFwdRaw();
                                        if (n) {
                                            var r = n.object;
                                            t && (t.innerHTML = Po(r))
                                        } else t.innerHTML = ""
                                    }(n), po(P, {
                                        fasthide: !0
                                    }), T.start(), setTimeout(function() {
                                        return removeClass(P, "im-send-btn_saudio")
                                    }, 300)
                                }
                            })
                        }), n(P, "mouseover", x), n(I, "focus", function() {
                            t.get().longpoll.push([c.eb("message")]), cur.focused = t.get().peer
                        }), n(I, "blur", function() {
                            var e = 0 === t.get().peer ? "search" : "default";
                            t.get().longpoll.push([c.eb(e)]), cur.focused = !1
                        }), n(N, "click", function() {
                            return d().toggleKeyboard(void 0)
                        }), n(N, "mouseover", function() {
                            showTooltip(N, {
                                text: function() {
                                    var e = Object(o.f)(t);
                                    return !e || e.hide ? getLang("mail_show_keyboard") : getLang("mail_hide_keyboard")
                                },
                                black: !0,
                                shift: [4, 5]
                            })
                        }), i(e.parentNode, "click", ao, L), i(e.parentNode, "click", so, A), i(e.parentNode, "click", oo, S), i(e.parentNode, "click", co, D), i(e.parentNode, "click", uo, B), i(e, "click", io, S), i(e, "click", "_im_will_fwd", w), i(e, "keydown", "_im_text", function(e) {
                            return function(e, t, n, i) {
                                if (38 === i.which && n().isEmpty(e) && !t().getEditingMessage() && !Emoji.shown && !hasAccessibilityMode() && !Object(r.V)(e.get())) {
                                    var a = Object(Ui.c)(e, Object(o.g)(e));
                                    a && t().startEditing(Object(o.m)(e, e.get().peer, a))
                                }
                            }(t, u, d, e)
                        }), i(bodyNode, "click", lo, R)
                    }
                }),
                K = _(t, k, I, e, C, u, b, f, H, T, N, U, W);
            return K.initKeyboard(), K
        }
        var Fo = "im_hist_search",
            zo = "_im_search_date",
            Vo = "_im_search_date_input",
            Qo = "_im_search_history_input",
            Go = "_im_start_inplace_search",
            Xo = "_im_cancel_inplace_search",
            Yo = "_im_clear_date";

        function Jo(e, t, n, r, i, o) {
            return {
                focus: function(e) {
                    uiSearch.focus(t),
                        function(e, t, n, r) {
                            cancelStackPush(Fo, $o.bind(null, e, t, n, r))
                        }(e, t, n, r)
                },
                changePeer: function(e, n) {
                    uiSearch.getFieldEl(t).value = n.get().tabs[e].searchText || ""
                },
                search: function() {
                    o({})
                },
                unmount: function() {
                    Object(s.c)(i), cancelStackFilter(Fo), r.then(function(e) {
                        return e.destroy()
                    })
                }
            }
        }

        function Zo(e, t, n) {
            var i = e.get().peer;
            uiSearch.showProgress(n), Object(r.Hb)(i, e.get()).then(function(r) {
                uiSearch.hideProgress(n), t().insertSearch(r, e)
            }).catch(function() {
                uiSearch.focus(n), uiSearch.hideProgress(n)
            })
        }

        function $o(e, t, n, i) {
            cancelStackFilter(Fo), i.then(function(e) {
                e.hide()
            }), e.set(r.m.bind(null, e.get().peer)).then(function() {
                uiSearch.getFieldEl(t).value = "", n().cancelSearch(e)
            })
        }

        function ea(e, t, n) {
            var i = geByClass1(Vo, e),
                o = geByClass1(Qo, e),
                a = function(e, t, n, r) {
                    var i = '<td class="im_cal_clear" colspan="7"><button type="button" class="im_cal_clear_lnk _im_clear_date">' + getLang("wall_clear_date_filter") + "</button></td>";
                    return new Promise(function(e) {
                        stManager.add(["ui_controls.js", "datepicker.js", "datepicker.css"], function() {
                            var t = new Datepicker(n, {
                                width: 140,
                                resfmt: "plain",
                                addRows: '<tr id="im_day_clear">' + i + "</tr>",
                                addRowsM: '<tr id="im_month_clear">' + i + "</tr>",
                                onUpdate: r,
                                pastActive: !0
                            });
                            e(t)
                        })
                    })
                }(0, 0, i, function(e, t, n, i) {
                    e.set(r.Sb.bind(null, e.get().peer, i.d + "." + i.m + "." + i.y)).then(Zo.bind(null, e, t, n))
                }.bind(null, t, n, o)),
                c = function(e, t) {
                    e.then(function(e) {
                        triggerEvent(geByClass1("datepicker_control", t), "mousedown", !1, !0)
                    })
                }.bind(null, a, e),
                u = function(e, t, n, i, o, a) {
                    if ("keyup" !== a.type || 13 == a.which) {
                        var s = clean(uiSearch.getFieldEl(t).value);
                        e.set(r.Rb.bind(null, s, e.get().peer)).then(o.bind(null, e, i, t))
                    }
                }.bind(null, t, o, i, n, debounce(Zo, 300)),
                l = $o.bind(null, t, o, n, a),
                d = function(e, t, n, i) {
                    n.then(function(e) {
                        e.hide()
                    }), e.set(r.v.bind(null, e.get().peer)).then(Zo.bind(null, e, t, i))
                }.bind(null, t, n, a, o),
                _ = Object(s.a)({
                    handlers: function(t, n) {
                        t(geByClass1(zo, e), "click", c), t(uiSearch.getFieldEl(o), "keyup", u), t(geByClass1(Go, e), "click", u), t(geByClass1(Xo, e), "click", l), n(e, "click", Yo, d)
                    }
                });
            return Jo(0, o, n, a, _, u)
        }
        var ta = "_im_mess_fav",
            na = "_im_mess_reply",
            ra = "_im_mess_forward",
            ia = "_im_mess_edit";

        function oa(e, t, n, r, a) {
            var s = Object(o.o)(e),
                c = Object(o.t)(e, s),
                u = 105 + (Object(je.a)(e, Object(o.o)(e)) || c && c.top_banner ? Object(i.Y)() : 0);
            showTooltip(t, {
                shift: [n, 10],
                black: 1,
                className: "_im_history_tooltip " + r,
                appendParentCls: "_im_mess_stack",
                toup: t.getBoundingClientRect().top > u + 37,
                text: a
            })
        }

        function aa(e, t, n, r) {
            var i = getLang("mail_im_toggle_important").length > 14;
            oa(e, r, i ? 84 : 34, i ? "im-star-tt_long" : "im-star-tt", function() {
                var t = domData(gpeByClass("_im_mess", r), "msgid"),
                    n = Object(o.m)(e, e.get().peer, t);
                return n ? Object(a.h)(n) ? getLang("mail_im_unmark_important") : getLang("mail_im_toggle_important") : ""
            })
        }

        function sa(e, t, n) {
            var u = aa.bind(null, t, 0),
                l = function(e, t, n) {
                    var i = gpeByClass("_im_mess", n),
                        s = intval(domData(i, "msgid")),
                        u = e.get().peer,
                        l = Object(o.m)(e, u, s),
                        d = !Object(a.h)(l);
                    return e.get().longpoll.push([{
                        peerId: u,
                        messageId: s,
                        type: d ? c.U : c.Q,
                        flags: c.l
                    }]), e.set(r.G.bind(null, [s], d, u)), aa(e, 0, 0, n), !1
                }.bind(null, t),
                d = function(e, t, n, r) {
                    oa(e, r, 18, "im-reply-tt", getLang("mail_im_mark_forward"))
                }.bind(null, t, 0),
                _ = function(e, t, n, i) {
                    var o = e.get().peer,
                        a = +domData(domClosest("im-mess", i.target), "msgid");
                    return Object(ye.f)(), Object(r.eb)([a], o, e).then(function(t) {
                        return e.set(r.cb.bind(null, t))
                    }).then(function() {
                        In(0, e)
                    }), !1
                }.bind(null, t, e.querySelector("_im_dialog_actions"), n),
                f = function(e, t, n, r) {
                    oa(e, r, 18, "im-reply-tt", getLang("mail_im_reply"))
                }.bind(null, t, 0),
                p = function(e, t, n) {
                    var i = e.get().peer,
                        o = +domData(domClosest("im-mess", n.target), "msgid");
                    return Object(r.eb)([o], i, e).then(function(t) {
                        return e.set(r.K.bind(null, t, e.get().tfdraft, !0))
                    }).then(function() {
                        return t().respond(e, i)
                    }), !1
                }.bind(null, t, n),
                m = function(e, t, n) {
                    oa(e, n, 18, "im-edit-tt", getLang("mail_im_edit"))
                }.bind(null, t),
                g = function(e, t, n, r) {
                    var i = intval(domData(gpeByClass("_im_mess", r), "msgid")),
                        a = Object(o.m)(e, e.get().peer, i);
                    return a && t().startEditing(a), !1
                }.bind(null, t, n),
                h = Object(s.a)({
                    handlers: function(t, n) {
                        n(e, "click", ta, l), n(e, "mouseover", ta, u), n(e, "click", ra, _), n(e, "mouseover", ra, d), n(e, "click", na, p), n(e, "mouseover", na, f), n(e, "click", ia, g), n(e, "mouseover", ia, m)
                    }
                });
            return function(e, t) {
                return {
                    markImportant: function(t, n, r) {
                        Object(i.kc)(t, n, e)
                    },
                    unmount: function() {
                        Object(s.c)(t)
                    }
                }
            }(e, h)
        }
        var ca = "_im_retry_media",
            ua = "_im_replied_message";

        function la(e, t, n, a, s) {
            if (!Object(r.Y)(e.get().peer, e.get()) && !(hasClass(s, i.l) || hasClass(s, i.t) || hasClass(s, "_im_mess_srv") || Object(i.E)(a, s) || Object(o.x)(e) || "A" === a.target.tagName || domClosest(ua, a.target) || a.target.classList.contains(ca))) {
                var c = intval(domData(s, "msgid")),
                    u = e.get().peer;
                if (!Object(i.Fa)(e, u, c)) {
                    var l = void 0,
                        d = void 0;
                    l = a.shiftKey ? Object(o.n)(e, u, c) : [c], e.set(r.j.bind(null, l)).then(function() {
                        var r = Object(o.s)(e),
                            i = !1;
                        l.forEach(function(e) {
                            var t = geByClass1("_im_mess_" + e, n);
                            if (t) {
                                var o = inArray(e, r);
                                i |= o, toggleClass(t, "im-mess_selected", o);
                                var a = o ? getLang("mail_deselect_message") : getLang("mail_select_message"),
                                    s = geByClass1("_im_mess_blind_label_select", t);
                                attr(s, "aria-label", a)
                            }
                        }), i && (window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty()), t().changedMessageSelection(e)
                    }).then(function() {
                        1 !== e.get().selectedMessages.length || d ? d && d.hide() : d = function(e) {
                            var t = e.get();
                            if (t.pinnedMessagesPromo && Object(i.Ha)(t.peer)) {
                                var n = geByClass1("_mess-action-promo"),
                                    o = new ElementTooltip(n, {
                                        autoShow: !1,
                                        appendTo: n,
                                        content: getTemplate("im_pinned_messages_promo", {
                                            content: getLang("mail_pinned_messages_promo_tooltip")
                                        }),
                                        forceSide: "bottom",
                                        cls: "feature_intro_tt",
                                        width: 260,
                                        onHide: function() {
                                            e.setState({
                                                pinnedMessagesPromo: !1
                                            }), Object(r.R)()
                                        }
                                    });
                                return o.show(), o
                            }
                        }(e)
                    })
                }
            }
        }

        function da(e, t, n) {
            var r = la.bind(null, t, n, e),
                i = Object(s.a)({
                    handlers: function(t, n) {
                        n(e, "click", "_im_mess", r)
                    }
                });
            return function(e, t) {
                return {
                    cleanSelection: function(t) {
                        t && Array.isArray(t) && t.length && t.map(function(t) {
                            return geByClass1("_im_mess_" + t, e)
                        }).filter(function(e) {
                            return e
                        }).forEach(function(e) {
                            return removeClass(e, "im-mess_selected")
                        })
                    },
                    unmount: function() {
                        Object(s.c)(t)
                    }
                }
            }(e, i)
        }
        var _a = {
                onNewMessagesChunk: function(e) {
                    var t = geByClass("post");
                    LongView.clearElemsCache && LongView.clearElemsCache(), t.forEach(function(e) {
                        return LongView.register(e, "im")
                    })
                },
                onHistoryScroll: function(e) {
                    LongView.onScroll(e, window.innerHeight)
                }
            },
            fa = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }();
        var pa = 68,
            ma = 32,
            ga = 300,
            ha = 20,
            ba = 68,
            va = 10,
            ya = 2e3,
            Oa = 100;

        function ja(e, t, n, r) {
            var i = e instanceof Array ? e : geByClass("_im_bar_date", e),
                o = t.contHeight();
            _a.onNewMessagesChunk();
            var a = i.reduce(function(e, t) {
                    return e[domData(t, "date")] = [t.offsetTop + va, o, t], e
                }, {}),
                s = !n && r.barMap ? r.barMap : {};
            return r.barMap = extend(s, a), r.barMapKeys = Object.keys(r.barMap).sort(), Promise.resolve(r)
        }

        function wa(e, t, n, r, o) {
            var a = e.get().barMap[t],
                s = Object(i.Ia)(o) ? ba : ha;
            return n - (a[0] + n - a[1]) + r - s
        }

        function Ea(e, t, n, r, i) {
            var o = e.get(),
                a = void 0,
                s = void 0,
                c = n - t;
            o.barMapKeys.forEach(function(t) {
                var o = wa(e, t, n, r, i);
                if (o >= c) {
                    var u = a ? wa(e, a, n, r, i) : n;
                    a = u > o ? t : a
                } else if (o < c) {
                    var l = s ? wa(e, s, n, r, i) : 0;
                    s = o > l ? t : s
                }
            });
            var u = {};
            return [
                [s, "prev"],
                [a, "cur"]
            ].forEach(function(t) {
                var o = fa(t, 2),
                    a = o[0],
                    s = o[1];
                a && (u[s + "Bar"] = function(e, t) {
                    var n = e.get().barMap[t][2];
                    return {
                        text: n.textContent,
                        date: domData(n, "date")
                    }
                }(e, a), u[s + "Left"] = wa(e, a, n, r, i) - c)
            }), u
        }

        function ka(e, t, n, o, a) {
            var s = e.get(),
                c = Object(r.W)(s),
                u = t.get(),
                l = a.scrollTop(),
                d = u.lastTop ? u.lastTop - l : 0;
            u.lastTop = l;
            var _, f, p, m = Object(je.a)(s, s.peer) ? Object(i.Y)() : 0,
                g = Object(r.Y)(s.peer, s) && s.tabs[s.peer] && s.tabs[s.peer].top_banner ? 50 : 0,
                h = (Object(i.Ia)(e) ? pa + m + g : 0) - ma / 2,
                b = Ea(t, l, a.contHeight(), h, e),
                v = b.prevBar,
                y = b.curBar,
                O = b.prevLeft,
                j = "translateY(0px)",
                w = !1,
                E = !1,
                k = !1;
            y || c || (y = function(e) {
                var t = geByClass1("_im_mess", e),
                    n = domData(t, "ts");
                return t && n ? {
                    text: getShortDate(intval(n), !1, !0, getLang("months_of", "raw")),
                    date: n
                } : null
            }(o)), y ? w = y : E = !0, v && y && O > -ma && O < 0 && (k = !0, E = !1, w = y, j = "translateY(" + (-ma - O) + "px)"), w && function(e, t) {
                domData(e, "ts") !== t.date && (e.innerHTML = t.text, domData(e, "ts", t.date), setStyle(e, {
                    visibility: "visible"
                }))
            }(n, w), k ? t.set(function(e, t, n, r) {
                return r.barTransition = r.barMap[t][2], n > 0 ? (addClass(r.barMap[t][2], "im-page--date-bar-transition-inverse"), addClass(e, "im-page--date-bar-transition-inverse")) : n < 0 && (removeClass(r.barMap[t][2], "im-page--date-bar-transition-inverse"), removeClass(e, "im-page--date-bar-transition-inverse")), addClass(r.barMap[t][2], "im-page--date-bar-transition"), addClass(e, "im-page--date-bar-transition"), Promise.resolve(r)
            }.bind(null, n, v.date, d)) : t.set(function(e, t) {
                return t.barTransition && (removeClass(t.barTransition, "im-page--date-bar-transition"), t.barTransition = null), removeClass(e, "im-page--date-bar-transition"), Promise.resolve(t)
            }.bind(null, n)), j && setStyle(n, (_ = {}, f = cssTransformProp, p = j, f in _ ? Object.defineProperty(_, f, {
                value: p,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : _[f] = p, _)), toggleClass(n, "im-page--top-date-bar_no-b", E)
        }

        function Ca(e, t) {
            var n = geByClass1("_im_top_date_bar"),
                r = m({
                    lastTop: !1,
                    barMap: {},
                    barMapKeys: []
                }),
                i = null,
                o = null,
                a = null,
                s = debounce(function(e) {
                    r.set(ja.bind(null, t, e, !1))
                }, 500);
            return {
                reset: function(i) {
                    r.set(ja.bind(null, t, i, !0)).then(function() {
                        ka(e, r, n, t, i)
                    })
                },
                disable: function() {
                    r.reset()
                },
                heightIncreased: function(e, t) {
                    return s(t), r.set(function(e, t) {
                        return t.barMapKeys.forEach(function(n) {
                            t.barMap[n][0] -= e
                        }), Promise.resolve(t)
                    }.bind(null, e))
                },
                parseMore: function(i, o) {
                    r.set(ja.bind(null, i, o, !1)).then(function() {
                        ka(e, r, n, t, o)
                    })
                },
                toggle: function(e) {
                    e ? setStyle(n, {
                        display: ""
                    }) : hide(n)
                },
                show: function() {
                    o = Date.now(), a || (addClass(geByClass1("_im_page_history"), "im-page--top-date-bar_visible"), a = setInterval(function() {
                        Date.now() - o > ya && (removeClass(geByClass1("_im_page_history"), "im-page--top-date-bar_visible"), clearInterval(a), a = null)
                    }, Oa))
                },
                update: function(o) {
                    i && (clearTimeout(i), i = null), i = setTimeout(function() {
                        ka(e, r, n, t, o)
                    }, ga), ka(e, r, n, t, o)
                }
            }
        }
        var xa = n("nyd8"),
            Pa = n("uytb"),
            Ma = "_im_top_banner_button",
            Ta = "_im_top_banner_hide";

        function Ia(e, t) {
            var n = geByClass1("_im_dialog_actions", e);
            toggleClass(n, "im-page--chat-header_top-banner", t)
        }

        function Sa(e, t) {
            var n = geByClass1(Ta, e);
            n && window.tooltips && tooltips.hide(n), Ia(e, !1), t.innerHTML = ""
        }

        function Da(e, t, n) {
            var a = geByClass1("_im_top_banner", e),
                c = Object(s.a)({
                    handlers: function(o, s) {
                        var c = geByClass1("_im_dialog_actions", e);
                        s(e, "click", Ta, function(o) {
                            t.set(r.S.bind(null, t.get().peer)), Sa(e, a);
                            var s = !!Object(i.yb)(t);
                            Object(i.G)(t, s, !0, n)
                        }), s(e, "click", Ma, function(o) {
                            var s = function(e, t, n, i) {
                                    var o = domData(e, "payload");
                                    return !!o && (t.set(r.k.bind(null, t.get().peer, o)), Sa(n, i), !0)
                                }(o.target, t, e, a),
                                c = !!Object(i.yb)(t);
                            Object(i.G)(t, c, !s, n)
                        }), s(c, "mouseover", Ta, function(e, t) {
                            showTooltip(t, {
                                text: getLang("mail_top_banner_hide"),
                                black: 1,
                                shift: [8, 4],
                                appendEl: bodyNode
                            })
                        })
                    }
                });
            return {
                renderPeer: function(t) {
                    var r, s, c, u = Object(o.t)(t, t.get().peer).top_banner,
                        l = a.children.length;
                    u && !Object(o.K)(t) ? (Ia(e, !0), a.innerHTML = (s = (r = u).icon ? getTemplate("im_top_banner_icon", {
                        icon: r.icon
                    }) : "", c = (c = (r.buttons || []).map(function(e) {
                        var t = "";
                        switch (e.layout) {
                            case "secondary":
                                t = "secondary";
                                break;
                            default:
                                t = "blue_button"
                        }
                        return "link" === e.type ? getTemplate("im_top_banner_button_link", {
                            link: e.link,
                            text: e.text,
                            css_class: t
                        }) : getTemplate("im_top_banner_button", {
                            callback_data: e.callback_data,
                            text: e.text,
                            css_class: t
                        })
                    })).concat([getTemplate("im_top_banner_hide_btn", {})]), getTemplate("im_top_banner", {
                        text: r.text,
                        icon: s,
                        buttons: c.join("")
                    }))) : a.children.length && Sa(e, a);
                    var d = a.children.length;
                    Object(i.G)(t, d, l, n)
                },
                unmount: function() {
                    Object(s.c)(c)
                }
            }
        }
        var Ba = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            La = 1e3,
            Aa = -30,
            Ra = 30,
            Na = 2e3,
            Ua = 700,
            Wa = 15,
            Ha = 47,
            Ka = "_im_to_end",
            qa = "_im_failed_action",
            Fa = "_im_mess_link",
            za = "_im_admin_name",
            Va = "_im_typer_c",
            Qa = "_im_error",
            Ga = "_im_join_cancel",
            Xa = "_im_retry_media",
            Ya = "im-audio-message_recorded",
            Ja = "im-audio-message_recording",
            Za = "_im_mess_srv",
            $a = "im_srv_mess_link",
            es = "_chat_invitation",
            ts = "_im_mess",
            ns = "_im_replied_message",
            is = "_im_replied_author_link",
            os = !1,
            as = {};

        function ss(e) {
            var t = Object(o.t)(e, e.get().peer);
            return !!Object(o.p)(e) || !!t.top_banner
        }

        function cs(e, t) {
            var n = Object(g.r)(e),
                r = Object(o.t)(n, t);
            return Object(i.Ha)(t) && Object(je.a)(n, t) || !!r.top_banner && !Object(o.K)(t, n)
        }

        function us(e, t) {
            return Object(i.Y)()
        }

        function ds(e, t) {
            var n = ge("page_header"),
                r = geByClass1("_im_chat_input_w", t),
                i = r.offsetHeight - r.clientHeight;
            return Math.min(window.clientHeight() - i, Math.max(Math.max(0, e), Ua + n.offsetHeight + t.offsetTop))
        }

        function _s(e, t) {
            return geByClass1("_im_mess_" + t, e)
        }

        function fs(e, t, n) {
            var r, o, a, s, c, u, l, d = geByClass1(e, t),
                _ = void 0,
                f = void 0;
            o = {
                onStartDrag: function(e, t) {
                    addClass(bodyNode, "cursor_ns_resize"), _ = t, f = t
                },
                onDrop: function() {
                    removeClass(bodyNode, "cursor_ns_resize")
                },
                onDrag: function(e, r) {
                    var o = ds(f - _ + r, t);
                    Object(i.Jb)(o), n().fixHeight()
                }
            }, a = void 0, s = void 0, c = function(e) {
                a = void 0 !== e.clientX ? e.clientX : e.touches[0].clientX, s = void 0 !== e.clientY ? e.clientY : e.touches[0].clientY, o.onDrag && o.onDrag.call(r, a, s)
            }, u = function e(t) {
                o.onDrop && o.onDrop.call(r, a, s), removeEvent(document, "mouseup touchend mouseleave", e), removeEvent(document, "mousemove touchmove", c)
            }, l = function(e) {
                (1 === e.which || e.touches && e.touches[0]) && (addEvent(document, "mouseup touchend mouseleave", u), addEvent(document, "mousemove touchmove", c), a = void 0 !== e.clientX ? e.clientX : e.touches[0].clientX, s = void 0 !== e.clientY ? e.clientY : e.touches[0].clientY, o.onStartDrag && o.onStartDrag.call(r, a, s), o.onDrag && o.onDrag.call(r, a, s), cancelEvent(e))
            }, (r = d).beginDragHandler = l, addEvent(r, "mousedown touchstart", l)
        }

        function ps(e, t) {
            var n;
            n = geByClass1(e, t), removeEvent(n, "mousedown touchstart", n.beginDragHandler)
        }

        function ms(e) {
            hide(e.target)
        }

        function gs(e, t, n) {
            var i = Object(o.t)(t, n),
                a = Object(r.bc)(i.history);
            toggleClass(e, "im-page--history_empty-hist", !a)
        }

        function hs(e) {
            return geByClass1("_im_peer_history", e)
        }

        function bs(e, t) {
            var n = t.contHeight(),
                r = e.scrollTop + (n - e.contHeight);
            t.scrollTop(r)
        }

        function vs(e, t, n, o, a, s, c, u) {
            var l = !(arguments.length > 8 && void 0 !== arguments[8]) || arguments[8],
                d = arguments.length > 9 && void 0 !== arguments[9] && arguments[9],
                _ = (t.get().tabs || {})[n];
            a().hideError(), s.renderPeer(t), u.renderPeer(t);
            var f = geByClass1("_im_peer_history", e);
            if (!t.get().tabHistoryNotChanged) {
                val(geByClass1("_im_page_peer_name", e), _.tab);
                var p = Object(r.bc)(_.history);
                gs(e, t, n), p || (p = getLang("mail_im_here_history")), val(f, p), getAudioPlayer().isPlaying() && getAudioPlayer().updateCurrentPlaying(), Object(i.Ia)(t) || Object(i.L)("_chat_body_wrap", e), Ss(t, o, e)
            }
            if (Object(r.Y)(n, t.get()) ? a().showSearch(t) : a().cancelSearch(t, !1), c.changePeer(n, t), t.get().msgid) ks(o, e, t.get().msgid, t);
            else if (_.scrollBottom && l) {
                bs(_, o);
                var m = Object(i.Ta)(t, e, o),
                    g = Ba(m, 1)[0];
                _.skipped || setTimeout(function() {
                    _.unread && !g && Ps(t, e, !0), Os(t, o, e)
                }, 100)
            } else Es(o, e, a, t, d) || o.scrollBottom(Aa);
            window.LazyLoad && window.LazyLoad.scan(!!o.scroll && o.scroll.scroller)
        }

        function ys(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2] || t.scrollTop(),
                i = t.scrollBottom(),
                o = t.contHeight(),
                a = e.get().peer;
            e.set(r.Ab.bind(null, a, n, i, o))
        }

        function Os(e, t, n) {
            var r = Object(o.F)(e),
                i = 4 * t.getScrollHeight();
            t.scrollBottom() > i && !r && Ps(e, n, !0, 2 * t.getScrollHeight())
        }

        function js(e, t, n, a, s, c, u, l) {
            var d = !(arguments.length > 8 && void 0 !== arguments[8]) || arguments[8];
            if ((e.get().history_init || (e.get().history_init = !0, !(l.scrollTop() > 0))) && !Oe.a.isFullscreen) {
                s.update(l), s.show();
                var _ = e.get().peer;
                if (0 !== _ && Object(i.Oa)(e.get(), _) && (_a.onHistoryScroll(l.scrollTop()), !layers.visible)) {
                    var f = Object(o.F)(e),
                        p = Object(o.t)(e, _);
                    p && !p.skipped && u < 0 ? Os(e, l, c) : u > 0 && !p.skipped && !p.unread && As(e, c), xs(e, l) && (f && p && !p.skipped && As(e, c), p.unread > 0 && ws(e));
                    var m = Object(i.lc)(n);
                    if (!Object(r.Y)(_, e.get()) && d && a(l), !os && (u < 0 || 0 === l.scrollBottom()) && l.scrollBottom() < La) {
                        if (Object(r.Y)(_, e.get())) return;
                        if (p.skipped > 0 && !e.get().no_moving_down) {
                            var g = gpeByClass("_im_page_history", g),
                                h = e.get();
                            os = !0;
                            var b = e.set(r.Ma).then(t().loadHistory.bind(null, h.peer, {
                                reversed: !0
                            })).then(function() {
                                ws(e), os = !1, Ps(e, g), p.skipped || e.set(r.p.bind(null, e.get().peer, !1, !1))
                            });
                            return Ts(g, !0), void b.then(Ts.bind(null, g, !1))
                        }
                    }
                    if (!os && l.scrollTop() < La) {
                        if (Object(r.Y)(_, e.get())) {
                            os = !0;
                            var v = t().getSearchResulstModule();
                            return v.isAll(e) ? void(os = !1) : void m(v.loadMore(e).then(function(n) {
                                os = !1, n && (t().loadHistory(e.get().peer, {}, e, n), a(l))
                            }), "up")
                        }
                        var y = e.get();
                        p.allShown || (os = !0, m(e.set(r.Qa.bind(null, 0, 0)).then(t().loadHistory.bind(null, y.peer, {})).then(function() {
                            os = !1, a(l)
                        }), "up"))
                    }
                    u < 0 && Ws(e, _, l.scrollBottom(), c, t), Object(r.Fc)()
                }
            }
        }

        function ws(e) {
            if (!(window.curNotifier && curNotifier.idle_manager && curNotifier.idle_manager.is_idle)) return e.set(r.fb.bind(null, e.get().peer))
        }

        function Es(e, t, n, r, o) {
            var a = geByClass1("_im_unread_bar_row", t);
            if (a) {
                var s = r.get(),
                    c = s.peer,
                    u = a.getBoundingClientRect(),
                    l = geByClass1("_im_chat_body_abs", t).getBoundingClientRect().top + 20;
                Object(i.Ia)(r) && (l += Ha + (cs(s, c) ? us() : 0));
                var d = e.scrollTop() - l + u.top;
                return e.scrollTop(d), ys(r, e, d), setTimeout(function() {
                    c === r.get().peer && js(r, n, hs(t), function() {}, o, t, 0, e)
                }, 80), ws(r), !0
            }
            return !1
        }

        function ks(e, t, n, r) {
            var o = _s(t, n);
            if (o) {
                var a = Object(i.Ia)(r),
                    s = r.get().peer,
                    c = a ? window.clientHeight() : geByClass1("_im_chat_body_abs", t).offsetHeight,
                    u = o.offsetTop + domPN(o).offsetTop + domPN(domPN(o)).offsetTop + domPN(domPN(domPN(o))).offsetTop;
                a && cs(r, s) && (u -= us(r.get())), e.scrollTop(u - e.getScrollHeight() / 2 + c / 2), addClass(o, "im-mess_light"), setTimeout(function() {
                    removeClass(o, "im-mess_light")
                }, Na)
            }
        }

        function Cs(e, t, n) {
            n.updateLastSeen(e)
        }

        function xs(e, t) {
            return Object(o.w)(e) >= intval(t.scrollBottom())
        }

        function Ps(e, t, n) {
            var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0,
                a = e.get().peer;
            if (!Object(i.Ya)(a)) {
                var s = e.get().tabs[a],
                    c = geByClass1(Ka, t),
                    u = geByClass1("_im_to_end_label", c);
                n && s.unread > 0 ? val(u, getLang("mail_im_new_messages", s.unread)) : val(u, getLang("mail_im_to_end_new"));
                var l = !1;
                (n || s.skipped > 0) && !Object(r.Y)(e.get().peer, e.get()) ? (l = !0, addClass(c, "im-to-end_shown")) : Ls(c, !0), e.set(r.vc.bind(null, [l, intval(o)]))
            }
        }

        function Ms(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
            return (0 !== e.scrollTop() || 0 !== e.scrollBottom()) && e.scrollBottom() < (t ? Ra + t : Ra)
        }

        function Ts(e, t) {
            var n = geByClass1(Ka, e);
            toggleClass(n, "im-to-end_loading", t)
        }

        function Is(e, t, n, i) {
            if (!t.get().tabs[t.get().peer].skipped) return i.scrollBottom(Aa), Ps(t, n), ws(t), void Ws(t, t.get().peer, 0, n, e);
            Ts(n, !0), t.set(r.p.bind(null, t.get().peer, !1, !1)).then(function() {
                return t.set(r.Sa.bind(null, t.get().peer, !0, -1, !1))
            }).then(function() {
                Ts(n, !1), e().changePeer(t, !1, !1), ws(t)
            })
        }

        function Ss(e, t, n) {
            var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
            if (Object(i.Ia)(e)) {
                var o = t.contHeight(),
                    a = geByClass1("_im_chat_input_w", n),
                    s = a.offsetHeight - a.clientHeight,
                    c = geByClass1("_im_chat_resize", n),
                    u = geByClass1("_im_chat_input_parent", n),
                    l = geByClass1("_im_chat_audio_input_parent", n);
                if (!1 !== (r = !1 !== r ? r : Object(i.U)()) && r > 0) {
                    var d = ds(r, n),
                        _ = d - (hasClass(l, Ja) || hasClass(l, Ya) ? l : u).offsetHeight;
                    c.style.height = window.clientHeight() - d - s + "px", setStyle(a, {
                        top: _ + "px",
                        bottom: "auto"
                    })
                } else c.style.height = "0px", setStyle(a, {
                    top: "auto",
                    bottom: "0px"
                });
                var f = geByClass1("_im_peer_history_w", n);
                return setStyle(f, {
                    borderBottomWidth: a.offsetHeight - Wa - 1
                }), t.contHeight() - o
            }
            Object(i.L)("_chat_body_wrap", n);
            var p = t.getScrollHeight();
            return t.update(!1, !0), p - t.getScrollHeight()
        }

        function Ds(e, t, n, r) {
            var i = t.offsetHeight;
            r(), e.heightIncreased(t.offsetHeight - i, n)
        }

        function Bs(e, t) {
            var n = t.getBoundingClientRect().top;
            showTooltip(t, {
                className: "im-page--admin-tt",
                text: getLang("mail_only_admin_see"),
                appendParentCls: "_chat_body_wrap",
                shift: [20, 5],
                dir: "auto",
                showdt: 400,
                noZIndex: !0,
                toup: n > 200
            })
        }

        function Ls(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
            hasClass(e, "im-to-end_shown") && (t && addClass(e, "im-to-end_fast"), removeClass(e, "im-to-end_shown"), t && (e.offsetHeight, removeClass(e, "im-to-end_fast")))
        }

        function As(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                i = geByClass1(Ka, t);
            e.set(r.vc.bind(null, [!1, 0])), Ls(i, n)
        }

        function Rs(e) {
            var t = Object(o.g)(e);
            Object(i.Ha)(t.peerId) && (t.pinHideId = cur.imDb.select(Pa.a, t.peerId))
        }

        function Ns(e, t, n, r, i) {
            e.setState({
                isEditing: !1
            }), removeClass(r, "im-mess_is_editing"), removeClass(geByClass1("_im_page_history"), "is_msg_editing"), cancelStackFilter("cancel_edit"), n.setDraft(e, Object(o.o)(e) ? Object(o.u)(Object(o.g)(e)) : null), n.toggleStickers(e, !0), n.restoreKeyboard(), Us(t)
        }

        function Us(e) {
            Object(g.p)(geByClass("_im_history_tooltip", e)).forEach(hide)
        }

        function Ws(e, t, n, i, a) {
            var s = Object(o.t)(e, t);
            if (!(Date.now() - (s.lastReset || 0) < 1e3) && (s && s.msgs && s.history && !os && s.offset > 300 && 0 == s.skipped && n < 50 && n >= 0 && 0 === (e.get().selectedMessages || []).length)) {
                var c = Object.keys(s.msgs).filter(function(e) {
                        return e > 0
                    }).sort(function(e, t) {
                        return e - t
                    }).slice(0, -50),
                    u = c.slice(-1)[0];
                e.mutate(r.tb.bind(null, t)), e.set(r.mb.bind(null, c, t)).then(function() {
                    return a().removeStartingFromMessage(u, t, e)
                })
            }
        }

        function Hs(e) {
            checkEvent(e) || cancelEvent(e)
        }

        function Ks(e, t, n, u, l, _, f, p, m, g, h, b, v, y, O, j) {
            var w = void 0,
                E = throttle(function() {
                    n.smoothScroll.apply(n, arguments)
                }, 300);
            return {
                fixKeyboard: function() {
                    l.fixKeyboard()
                },
                changePeer: function(e) {
                    var a = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],
                        s = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2];
                    if (0 === e.get().peer && O.disable(), revertLastInlineVideo(t), 0 === e.get().peer) return l.setDraft(e, null),
                        function(e) {
                            addClass(e, "im-page--history_empty"), hs(e).innerHTML = ""
                        }(t);
                    if (Object(i.Oa)(e.get(), e.get().peer)) {
                        removeClass(t, "im-page--history_search"), e.set(r.E), u.changeActions(e);
                        var c = e.get().peer,
                            d = e.get().prevPeer;
                        removeClass(t, "im-page--history_loading"), toggleClass(t, "im-page--history_vkcomgroup", Object(i.Pa)(e, c)), a ? l.setDraft(e, Object(o.u)(Object(o.g)(e))) : l.updateState(e), Ps(e, t), _().updateTyping(c, e), O.toggle(!0), Cs(e, 0, u), Object(i.Ya)(d) && !Object(i.Ya)(c) ? (! function(e, t, n, r, i, o, a, s, c, u) {
                            removeClass(e, "im-page--history_empty"), vs(e, t, n, r, i, o, a, s, c, u)
                        }(t, e, c, n, _, u, p, j, s, O), O.reset(n)) : Object(i.Ya)(d) || Object(i.Ya)(c) || (vs(t, e, c, n, _, u, p, j, s, O), O.reset(n)), Object(i.Ya)(c) || js(e, _, hs(t), v, O, t, 0, n), Object(i.K)(t)
                    }
                },
                preparePeer: function(e) {
                    var n = Object(o.o)(e);
                    Rs(e), l.setDraft(e, Object(o.u)(Object(o.t)(e, n))), _().updateTyping(n, e), _().hideError(), u.renderPeer(e), j.renderPeer(e), u.hideActions(e), p.changePeer(n, e), Cs(e, 0, u), O.toggle(!1), As(e, t, !0)
                },
                saveScroll: function(e) {
                    return ys(e, n)
                },
                loadingPeer: function(e) {
                    Object(r.V)(e.get()) || (removeClass(t, "im-page--history_empty"), addClass(t, "im-page--history_loading"))
                },
                stopLoading: function(e) {
                    removeClass(t, "im-page--history_loading")
                },
                deselectDialog: function(e) {
                    f().removeSelection(e)
                },
                replaceMessageAttrs: function(e, n) {
                    Object(i.Eb)(n.get(), hs(t), e)
                },
                cleanSelection: function(e) {
                    g.cleanSelection(e)
                },
                updateDialogFilters: function(e) {
                    f().updateDialogFilters(e)
                },
                getSearchResulstModule: function() {
                    return w
                },
                insertSearch: function(e, r) {
                    w || (u.deselectAll(r), w = d(t, r)), addClass(t, "im-page--history_search"), e ? (removeClass(t, "im-page--history_search-empty"), hs(t).innerHTML = e) : (addClass(t, "im-page--history_search-empty"), hs(t).innerHTML = Object(i.tb)()), Ss(r, n, t), n.scrollBottom(0), Ps(r, t), O.reset(n)
                },
                updateChatTopic: function(e, t) {
                    f().updateDialog(e, t), e === t.get().peer && (u.renderPeer(t), u.renderActions(t), j.renderPeer(t))
                },
                updateActions: function(e) {
                    u.changeActions(e)
                },
                updateChatPhoto: function(e, r, o) {
                    if (Object(i.Ua)(e.peerId, o.get())) {
                        u.renderPeer(o), j.renderPeer(o);
                        var a = Ms(n);
                        Object(i.w)(e, r, o.get(), hs(t)), a && n.scrollBottom(Aa)
                    }
                },
                markImportant: function(e, n, r) {
                    _s(t, e) && (u.changedMessageSelection(r), m.markImportant(e, n, r))
                },
                isNewMessagesVisible: function(e) {
                    return xs(e, n)
                },
                loadHistory: function(e, r, o) {
                    var a = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                        s = o.get();
                    if (Object(i.Ua)(e, s)) {
                        var c = a || s.tabs[e].historyToAppend;
                        if (!c) return;
                        var u = geByClass1("_im_peer_history", t),
                            l = domFC(u),
                            d = n.scrollBottom(),
                            _ = r.reversed ? function(e) {
                                return u.appendChild(e)
                            } : function(e) {
                                return u.insertBefore(e, l)
                            },
                            f = 0;
                        r.reversed && (f = u.offsetHeight);
                        var p = sech(c),
                            m = document.createDocumentFragment();
                        p.forEach(function(e) {
                            return m.appendChild(e)
                        }), _(m), r.reversed && O.heightIncreased(u.offsetHeight - f, n), r.reversed || n.scrollBottomFixSave(d), n.update(!1, !0);
                        var g = p.filter(function(e) {
                            return hasClass(e, "_im_bar_date")
                        });
                        O.parseMore(g, n), Object(i.K)(t)
                    }
                },
                sendMessage: function(e) {
                    0 !== e.get().peer && l.sendMessage()
                },
                editMessage: function(e, r) {
                    if (Object(i.Oa)(e, r.peerId) && Object(i.Ua)(r.peerId, e.get())) {
                        if (!_s(t, r.messageId)) return;
                        ys(e, n), Object(i.J)(e.get(), r, t), bs(Object(o.t)(e, r.peerId), n), u.reRenderPinned(e), O.reset(n)
                    }
                },
                addMessage: function(e, s) {
                    if (!Object(r.Y)(s.peerId, e.get()) && Object(i.Oa)(e, s.peerId) && Object(i.Ua)(s.peerId, e.get())) {
                        if (_s(t, s.messageId)) return;
                        var c = hs(t);
                        Ds(O, c, n, function() {
                            var r = Ms(n),
                                u = geByClass1("_im_unread_bar_row", t),
                                l = Object(i.Ta)(e, t, n),
                                d = Ba(l, 2),
                                f = d[0],
                                p = d[1];
                            Object(i.x)(e.get(), s, c, !0, !0, !f && !u), removeClass(t, "im-page--history_empty-hist");
                            var m = Object(o.t)(e, e.get().peer),
                                g = Object(a.l)(s) && s.userId === vk.id,
                                h = s.kludges && s.kludges.source_act,
                                b = g && h !== i.f && h !== i.h;
                            m.skipped || f || !Object(a.n)(m, s) || Object(a.k)(s) || Ps(e, t, !0, p), (s.local || r || b) && n.scrollBottom(0), _().updateTyping(s.peerId, e), Us(t)
                        });
                        var u = domPS(domLC(c));
                        if (hasClass(u, "_im_bar_date")) {
                            var l = ce("div");
                            l.innerHTML = u.outerHTML, O.parseMore(l, n)
                        }
                        _().hideError(), O.update(n), Object(r.yc)(e.get()), Ws(e, s.peerId, n.scrollBottom(), 0, _)
                    }
                },
                setMessageErrored: function(e, n, r, o) {
                    r && _().showError(r), Object(i.Kb)(e, n, t)
                },
                markMessagesAsRead: function(e, n) {
                    e.get().peer === n.peerId && Object(i.jb)(e.get(), n.peerId, t)
                },
                compensateHistoryHeightChange: function(e) {
                    n.scrollTop(n.scrollTop() + e * us(b.get(), b.get().peer))
                },
                updateTyping: function(e, n) {
                    if (!Object(r.Y)(e, n.get())) {
                        var a = n.get();
                        if (a.peer === e && Object(i.Oa)(a, e)) {
                            var s = Object(i.O)(Object(o.t)(n, e).activity, e, !1, a),
                                c = geByClass1(i.v, t);
                            if (c || s) {
                                if (!c) {
                                    var u = geByClass1(Va, t);
                                    val(u, getTemplate("im_typing", {
                                        cls: Object(i.Ia)(n) ? "im-activity_classic" : ""
                                    })), c = geByClass1(i.v, t)
                                }
                                val(geByClass1("_im_typing_name", c), s);
                                var l = Object(i.hb)(Object(o.t)(n, e).activity || {}) === r.c;
                                c.setAttribute("data-activity-type", l ? "recording" : "typing"), s ? (addClass(c, "im-page--typing_vis"), _().hideError()) : removeClass(c, "im-page--typing_vis")
                            }
                        }
                    }
                },
                scrollFix: function(e, t, r) {
                    O.heightIncreased(r, n), O.update(n), Object(i.Ua)(t, e.get()) && Ms(n, r) && n.scrollBottom(Aa)
                },
                goToEnd: function() {
                    var e = this;
                    Is(function() {
                        return e
                    }, b, t, n)
                },
                updateGoToEnd: function(e, r) {
                    var i = Object(o.t)(e, e.get().peer);
                    i && i.skipped ? Ps(e, t) : As(e, t, r), h(0, n, !1);
                    var a = e.get().peer;
                    setTimeout(function() {
                        e.get().peer === a && ys(e, n)
                    })
                },
                newMessage: function(e) {
                    f().newMessage(e), As(e, t, !0)
                },
                scroll: function(e, t) {
                    var r = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                        i = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
                    if (0 !== e.get().peer) {
                        var o = r ? n.getScrollHeight() : 40;
                        !0 === i && (o = n.contHeight()), o = "up" === t ? -o : o, r || i ? E(o, function() {
                            h(o, n)
                        }) : (n.scrollTop(n.scrollTop() + o), h(o, n))
                    }
                },
                showCreation: function(e, t) {
                    f().showCreation(e, t)
                },
                updateScroll: function() {
                    return Ss(b, n, t)
                },
                toggleBarDate: function(e) {
                    O.toggle(e)
                },
                changedMessageSelection: function(e) {
                    u.changedMessageSelection(e)
                },
                updateOnline: function(e, t) {
                    Object(i.bb)(t.get(), e) && e === t.get().peer && u.renderPeer(t)
                },
                isEmpty: function(e) {
                    return l.isEmpty(e)
                },
                replaceAttachmentPlaceholders: function(e, r) {
                    if (Object(i.Ua)(r.peerId, e.get())) Ds(O, hs(t), n, function() {
                        var a = Ms(n);
                        Object(i.Db)(t, r, e.get());
                        var s = Object(o.t)(e, r.peerId);
                        if (s.mediacontent[r.messageId].length >= 3 && s.mediacontent[r.messageId][2].pinned) {
                            var c = Object(o.P)(s.pinned);
                            c && c.messageId == r.messageId && (s.pinned = s.mediacontent[r.messageId][2].pinned, u.reRenderPinned(e))
                        }
                        a && n.scrollBottom(0)
                    }), O.update(n);
                    else if (Object(a.j)(r)) {
                        var s = Object(o.t)(e, r.peerId);
                        if (s.mediacontent[r.messageId].length >= 3 && s.mediacontent[r.messageId][2].pinned) {
                            var c = Object(o.P)(s.pinned);
                            c && c.messageId == r.messageId && (s.pinned = s.mediacontent[r.messageId][2].pinned)
                        }
                    }
                },
                removeMessages: function(e, r, o) {
                    o.get().peer === r && (Object(i.mb)(e, hs(t)), Ss(o, n, t), u.changedMessageSelection(o))
                },
                removeStartingFromMessage: function(e, r, o) {
                    if (o.get().peer === r) {
                        var a = hs(t),
                            s = geByClass1("_im_mess_" + e, a);
                        Object(i.ob)(s, a), Ss(o, n, t), u.changedMessageSelection(o)
                    }
                },
                hideGoToEnd: function(e) {
                    As(b, t, e)
                },
                removeMessagesRestore: function(e, n, r, o) {
                    o.get().peer === n && Object(i.nb)(e, n, r, hs(t))
                },
                updateState: function(e, t) {
                    f().updateState(e, t)
                },
                updateBanner: function(e) {
                    j.renderPeer(e)
                },
                updateChat: function(e, t) {
                    e.get().peer === t && (u.changeActions(e), u.renderPeer(e), u.renderActions(e), j.renderPeer(e), l.updateState(e), Object(r.yc)(e.get()))
                },
                focustTxt: function(e) {
                    l.focusOn(e)
                },
                startSearch: function(e) {
                    _().showSearch(e), p.changePeer(e.get().peer, e), p.search()
                },
                showSearch: function(e) {
                    addClass(t, "im-page--hisory_search-open"), e.setState({
                        searchShown: !0
                    }), ss(e) && this.updateChatTopic(e.get().peer, e), this.cancelEditing(), setTimeout(function() {
                        return p.focus(e)
                    }, 10)
                },
                cancelSearch: function(e) {
                    var o = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                    if (e.get().searchShown && (removeClass(t, "im-page--hisory_search-open"), removeClass(t, "im-page--history_search"), removeClass(t, "im-page--history_search-empty"), e.setState({
                            searchShown: !1
                        }), ss(e) && this.updateChatTopic(e.get().peer, e), u.changedMessageSelection(e)), o && !Object(i.Ya)(e.get().peer) && w) {
                        var a = e.get().tabs[e.get().peer];
                        hs(t).innerHTML = Object(r.bc)(a.history), Ss(e, n, t), n.scrollBottom(0), e.get().msgid && (ks(n, t, e.get().msgid, e), Ps(e, t)), v(n), O.reset(n)
                    }
                    w && (w.unmount(), w = !1, Object(i.K)(t))
                },
                updateHistory: function(e) {
                    0 !== b.get().peer && e(t)
                },
                focusOnMessage: function() {
                    ks(n, t, b.get().msgid, b)
                },
                sendEditMessage: function(e, t) {
                    e.set(r.C.bind(null, Object(o.t)(e, t.peerId), t)).catch(function(n) {
                        return e.get().longpoll.push([Object(c.Ka)(t.peerId, t, n)])
                    })
                },
                unmount: function() {
                    Object(s.c)(e), n.destroy(), clearInterval(y), l.unmount(), u.unmount(), m.unmount(), g.unmount(), p.unmount(), cancelStackFilter("forward"), ps("_im_chat_resize_track", t)
                },
                removePeer: function(e, t) {
                    f().removePeer(e, t)
                },
                restoreScroll: function(e, t) {
                    var r = e.get().tabs[t];
                    r.scrollBottom ? bs(r, n) : n.scrollBottom(Aa)
                },
                resendMessage: function(e, n) {
                    e === b.get().peer && Object(i.dc)(e, n, t)
                },
                respond: function(e, t) {
                    l.attachMessages(e, t), l.focusOn(e);
                    var r = Object(o.t)(e, t);
                    r && !r.skipped && (n.scrollBottom(Aa), v(n))
                },
                cancelRecording: function() {
                    l.cancelRecording()
                },
                hideError: function() {
                    hide(geByClass1(Qa, t))
                },
                showError: function(e) {
                    geByClass1(Qa, t).innerHTML = e, show(geByClass1(Qa, t)), n.scrollBottom(Aa)
                },
                startEditing: function(e) {
                    if (Object(r.V)(b.get())) Object(i.ac)();
                    else {
                        e = Object(o.P)(e);
                        var n = Object(i.X)(b);
                        if (!(l.isBlocked() || n && n.messageId == e.messageId)) {
                            n && this.cancelEditing(), Us(t), b.get().searchShown && this.cancelSearch(b);
                            var a = _s(t, e.messageId);
                            a && (this.cancelRecording(), function(e, t, n, r, i) {
                                e.setState({
                                    isEditing: !0
                                }), n.saveText(e), addClass(r, "im-mess_is_editing"), addClass(geByClass1("_im_page_history"), "is_msg_editing"), cancelStackPush("cancel_edit", function() {
                                    return Ns(e, t, n, r)
                                });
                                var o = new an.a;
                                o.dData.txt = Object(Ui.b)(i.text), o.dData.attaches = Object(Wi.a)(i.kludges, i.messageId), n.toggleStickers(e, !1), n.setDraft(e, o), setTimeout(function() {
                                    return n.focusOn(e)
                                }, 0)
                            }(b, t, l, a, e), l.hideKeyboard(), u.deselectAll(b))
                        }
                    }
                },
                cancelEditing: function() {
                    var e = Object(i.X)(b);
                    e && Ns(b, t, l, _s(t, e.messageId))
                },
                getEditingMessage: function() {
                    return Object(i.X)(b)
                },
                focusEditingMessage: function() {
                    var e = Object(i.X)(b);
                    e && ks(n, t, e.messageId, b), l.focusOn(b)
                }
            }
        }

        function qs(e, t, n, u, l) {
            var d = geByClass1("_im_peer_history_w", e);
            show(d), hasAccessibilityMode() && addClass(d, "history_a11y");
            var _, f, p, m = Object(s.b)(Ks),
                b = m.callMutations,
                v = m.bindMutations,
                y = (_ = ys.bind(null, t), f = debounce(_, 100), p = throttle(_, 100), function(e) {
                    f(e), p(e)
                }),
                O = Ca(t, e),
                j = js.bind(null, t, b, d, y, O, e),
                w = Object(h.a)(geByClass1("_im_chat_body_abs", e), {
                    onScroll: j,
                    nativeScroll: Object(i.Ia)(t),
                    shadows: !1
                });
            setTimeout(function() {
                t.get().peer && (Rs(t), (Object(o.g)(t).pinned || Object(o.g)(t).top_banner) && (b().updateChatTopic(t.get().peer, t), t.set(r.Ob), E.changeActions(t)), t.get().msgid ? ks(w, e, t.get().msgid, t) : Es(w, e, b, t, O) || w.scrollBottom(Aa), t.get().history_init = !1, O.reset(w), Ps(t, e), js(t, b, d, y, O, e, 0, w), Object(i.K)(e), nav.objLoc.st && (t.mutate(r.Vb.bind(null, nav.objLoc.st, t.get().peer)), b().startSearch(t)))
            }, 15);
            var E = ar(geByClass1("_im_dialog_actions", e), t, b),
                k = qo(geByClass1("_im_text_input", e), t, Object(i.Ia)(t) ? u.updateMenu : void 0, function(e, t) {
                    n.removeDialog(e, t), n.restoreDialogs(e, !0)
                }, b),
                C = ea(geByClass1("_im_dialog_actions", e), t, b),
                x = sa(e, t, b),
                P = da(e, t, function() {
                    return {
                        changedMessageSelection: E.changedMessageSelection
                    }
                });
            Object(je.b)(e, t, b);
            var M = Da(e, t, function() {
                return {
                    hidePinned: function() {
                        Object(je.c)(t, t.get().peer, b, !1)
                    },
                    compensateHistoryHeightChange: function(e) {
                        b().compensateHistoryHeightChange(e)
                    },
                    showPinned: function() {
                        Object(je.d)(t, t.get().peer, b, !1)
                    }
                }
            });
            Object(i.Ya)(t.get().peer) || t.set(r.vb.bind(null, t.get().peer)).then(function() {
                Object(i.Hb)(t.get().peer, t.get(), hs(e)), gs(e, t, t.get().peer)
            }), fs("_im_chat_resize_track", e, l);
            var T = function(e, t, n, r, i) {
                    var a = domData(i, "msgid"),
                        s = e.get().peer,
                        u = Object(o.m)(e, s, a);
                    u.type === c.g ? (n().sendEditMessage(e, u), n().resendMessage(s, a)) : e.get().imQueueResend(s, a).then(function(t) {
                        e.get().longpoll.push([Object(c.Xa)(s, t.mess)])
                    })
                }.bind(null, t, e, b),
                I = function(e, t, n, o, a) {
                    var s = intval(domData(a, "peer")),
                        c = intval(domData(gpeByClass("_im_mess", a), "msgid")),
                        u = e.get().tabs[s].hash;
                    return Object(r.xb)(c, s, u, e.get().gid), e.set(r.wb.bind(null, c, s)).then(i.Gb.bind(null, c, s, hs(t))).then(function() {
                        return Ss(e, n, t)
                    }), !1
                }.bind(null, t, e, w),
                S = function(e, t) {
                    e().showCreation(t)
                }.bind(null, l, t),
                D = Is.bind(null, b, t, e, w),
                B = function(e, t, n, r) {
                    if (hasClass(n.target, "_im_mess_marker")) {
                        var o = n.target;
                        window.tooltips && Object(g.p)(geByClass(i.l, t)).map(function(e) {
                            return geByClass1("_im_mess_marker", e)
                        }).filter(function(e) {
                            return e !== o
                        }).forEach(function(e) {
                            return tooltips.hide(e, {
                                fasthide: !0
                            })
                        });
                        var a = domData(r, "msgid");
                        showTooltip(o, {
                            content: getTemplate("im_failed_menu", {
                                id: a
                            }),
                            className: "im-page--failed-tt" + (a > 0 ? " no_delete" : ""),
                            appendParentCls: "_chat_body_wrap",
                            dir: "down",
                            noZIndex: !0,
                            shift: [12, 8],
                            hasover: !0
                        })
                    }
                }.bind(null, t, e),
                L = i.Nb.bind(null, t),
                A = i.Sb.bind(null, t),
                R = function(e, t, n, o, a) {
                    var s = domData(a, "action"),
                        c = domData(a, "msgid"),
                        u = geByClass1("_im_mess_marker", _s(n, c)),
                        l = Number(c) > 0 ? "edit" : "send";
                    switch (s) {
                        case "resend":
                            Object(ye.j)("retry", l), t(o, a);
                            break;
                        case "delete":
                            Object(ye.j)("delete", l), e.set(r.jb.bind(null, e.get().peer, c)).then(function() {
                                Object(i.mb)([c], hs(n))
                            })
                    }
                    tooltips.hide(u, {
                        fasthide: !0
                    })
                }.bind(null, t, T, e),
                N = function(e, t, n, i, o) {
                    if (checkEvent(i)) return !0;
                    var a = q2ajx(o.getAttribute("href")),
                        s = intval(a.msgid);
                    s && e.set(r.p.bind(null, e.get().peer, s, !1)).then(function() {
                        return ks(n, t, s, e)
                    }), cancelEvent(i)
                }.bind(null, t, e, w),
                U = function(e, t, n) {
                    Oe.a.isFullscreen || 0 === t.get().peer || Object(i.Ia)(t) || e().restoreScroll(t, t.get().peer)
                }.bind(null, b, t, w),
                W = function(e, t) {
                    var n = e.get(),
                        s = n.peer,
                        c = domClosest(Za, t.target),
                        u = intval(domData(c, "msgid")),
                        l = Object(o.m)(e, s, u),
                        d = l && Object(a.l)(l) && l.kludges.source_act;
                    if (d === i.f || d === i.h) {
                        var _ = c.querySelector("." + $a);
                        if (_ && "A" !== _.tagName) {
                            var f = l.kludges.source_chat_local_id;
                            if (!f || as[f]) return;
                            as[f] = Object(r.N)(s, f, n).then(function(e) {
                                var t = Ba(e, 1)[0];
                                if (t) {
                                    var n = "/im?sel=" + Object(i.H)(s) + "&msgid=" + t,
                                        r = _.innerHTML;
                                    domReplaceEl(_, Object(i.Ib)(n, r, !0, $a)), delete as[f]
                                }
                            })
                        }
                    }
                }.bind(null, t),
                H = function(e, t, n) {
                    var r = e.get(),
                        a = r.peer,
                        s = n.target.href && n.target.href.match(/msgid=([\d]+)/),
                        u = s && s[1];
                    "A" !== n.target.tagName || !u || Object(i.Fa)(e, a, u) || checkEvent(n) || (Object(o.m)(e, a, u) ? (e.setState({
                        msgid: u
                    }), Object(xa.b)({
                        msgid: u
                    }), t().focusOnMessage()) : r.longpoll.push([Object(c.Ba)(a, u)])), cancelEvent(n)
                }.bind(null, t, b),
                K = function(e, t, n, r) {
                    var o = r.target,
                        a = domClosest(ns, o),
                        s = Number(a.getAttribute("data-msgid")),
                        c = domClosest("im-mess", o),
                        u = Number(c.getAttribute("data-msgid")),
                        l = e.get().peer;
                    s && !Object(i.Fa)(e, l, s) ? (e.setState({
                        msgid: s
                    }), Object(xa.b)({
                        msgid: s
                    }), Object(i.M)(e, t().focusOnMessage, l, s)) : u && Object(i.Vb)(e, u, r)
                }.bind(null, t, b, e),
                q = Object(s.a)({
                    handlers: function(n, a) {
                        a(e, "click", i.s, I), a(e, "mouseover click", i.l, B), a(e, "mouseover", "_im_edit_time", L), a(e, "mouseover", "_im_page_info", A), a(e, "click", "_im_mess_susp", function(e, t) {
                            var n = intval(domData(t.target, "msgid")),
                                r = gpeByClass("_im_mess_" + n, t.target),
                                i = geByClass1("_im_log_body", r),
                                o = geByClass1("_im_mess_susp_cont", r);
                            i.innerHTML = o.innerHTML
                        }.bind(null, e)), a(e, "click", qa, R), a(e, "click", Fa, N), a(e, "mouseover", za, Bs), a(e, "mouseover", Za, W), a(e, "click", $a, H), a(e, "click", Qa, ms), a(e, "click", ns, K), a(e, "click", is, Hs), a(e, "click", es, function(e, n) {
                            if (checkEvent(e)) return !0;
                            if (!gpeByClass("wall_postlink_preview_btn", e.target) && !hasClass(e.target, "wall_postlink_preview_btn")) return !0;
                            var o = geByClass1("flat_button", n),
                                a = {
                                    invite_chat_id: domData(o, "inv-id"),
                                    invite_hash: domData(o, "hash")
                                };
                            Object(i.Qb)(t, a, r.Da), cancelEvent(e)
                        }), a(e, "click", Ga, function() {
                            return t.get().longpoll.push([Object(c.ab)()])
                        }), a(e, "click", Xa, function(e) {
                            return function(e, t, n) {
                                var a = e.get(),
                                    s = domClosest(ts, n.target),
                                    c = domData(s, "msgid"),
                                    u = Object(o.m)(a, a.peer, c),
                                    l = function(e) {
                                        return t().replaceAttachmentPlaceholders(e, u)
                                    };
                                u && (Object(ye.j)("retry_attach"), e.set(r.g.bind(null, u, [Object(i.vb)(e, u)])).then(l), e.set(r.Pa.bind(null, u)).then(l))
                            }(t, b, e)
                        }), n(geByClass1("_im_peer_history_w", e), "mousemove", O.show), n(geByClass1("_im_start_new", e), "click", S), n(geByClass1(Ka, e), "click", D), n(geByClass1("_im_cancel_edit", e), "click", function() {
                            return b().cancelEditing(), !1
                        }), n(geByClass1("_im_edit_focus_cur", e), "click", function() {
                            return b().focusEditingMessage(), !1
                        }), Oe.a.raw && n(document, Oe.a.raw.fullscreenchange, U), n(window, "im_goToMessage", function(e) {
                            var n = intval(e.msgid);
                            if (n) return window.statlogsValueEvent("im_links_to_attachments", 1, "to_message"), t.set(r.p.bind(null, e.sel, n, !1)).then(function() {
                                return Object(i.M)(t, b().focusOnMessage, t.get().peer, n)
                            })
                        })
                    }
                });
            curNotifier.recvClbks.pin_hide = [function(e) {
                e.hide ? Object(je.c)(t, e.peer, b, !1) : Object(je.d)(t, e.peer, b, !1)
            }], window.showForwardBox = function(e) {
                return function(e, t) {
                    Object(i.A)(showBox("al_im.php", t, {
                        dark: 1
                    }), e)
                }(t, e)
            };
            var F = setInterval(Cs.bind(null, t, e, E), 1e4);
            return v(q, e, w, E, k, b, l, C, x, P, j, t, y, F, O, M)
        }
        var Fs = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            zs = [],
            Vs = 0,
            Qs = !1;

        function Gs(e) {
            zs = zs.reduce(function(t, n) {
                var r = Fs(n, 2),
                    i = r[0],
                    o = r[1];
                return o(e) ? t : t.concat([
                    [i, o]
                ])
            }, [])
        }
        var Xs = function(e) {
                var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
                return Vs++, {
                    stop: function() {
                        Vs--,
                        function(e) {
                            zs = zs.filter(function(t) {
                                return Fs(t, 1)[0] !== e
                            }), 0 === Vs && (document.body.removeEventListener("click", Gs, !0), Qs = !1)
                        }(e)
                    },
                    replaceOrAdd: function(n) {
                        var r = zs.filter(function(t) {
                                var n = Fs(t, 1)[0];
                                return e === n
                            }),
                            i = function(e, t) {
                                return 0 === t.length ? function(t) {
                                    return e(t), !0
                                } : function(n) {
                                    var r = t.reduce(function(e, t) {
                                        return e && !domClosest(t, n.target)
                                    }, !0);
                                    return r && e(n), r
                                }
                            }(n, t);
                        r.length > 0 ? function(e, t) {
                            zs = zs.map(function(n) {
                                var r = Fs(n, 2),
                                    i = r[0],
                                    o = r[1];
                                return i === e ? [e, t] : [i, o]
                            })
                        }(e, i) : function(e, t) {
                            !1 === Qs && (Qs = !0, document.body.addEventListener("click", Gs, !0)), zs = zs.concat([
                                [e, t]
                            ])
                        }(e, i)
                    }
                }
            },
            Ys = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }();

        function Js(e, t, n, o) {
            var a = ge("box_layer_wrap"),
                u = t.get().longpoll,
                l = m({
                    peer: 0,
                    longpoll: u,
                    oCache: {},
                    tabs: Object(i.ec)(o.msgs, o.hash)
                }),
                _ = sa(e.bodyNode, l, function() {
                    return {}
                }),
                f = d(e.bodyNode, t);
            Object(i.K)(e.bodyNode);
            var p = function(e, t, n) {
                for (var i = arguments.length, o = Array(i > 3 ? i - 3 : 0), a = 3; a < i; a++) o[a - 3] = arguments[a];
                o.filter(function(e) {
                    return inArray(e.type, [c.U, c.Q, c.b])
                }).forEach(function(i) {
                    if (i.type !== c.b) {
                        if (i.flags === c.l) {
                            var o = i.type === c.U;
                            e.set(r.sc.bind(null, [i.messageId], 0, o)).then(function(n) {
                                t.markImportant(i.messageId, o, e)
                            })
                        }
                    } else n.hide()
                })
            }.bind(null, t, _, e);
            u.onData(p);
            var g = function(e, t, n, o) {
                    if (!e.loading && !e.all && n.scrollTop + window.innerHeight - n.scrollHeight > -300) {
                        var a = geByClass1("_im_peer_history", t.bodyNode);
                        e.loading = !0, Object(i.lc)(a)(Object(r.Ka)(e.offset).then(function(t) {
                            var n = Ys(t, 4),
                                s = (n[0], n[1]),
                                c = (n[2], n[3]);
                            e.all = c.all, e.offset = c.offset, e.all ? addClass(a, "im-important_all") : e.loading = !1, o.set(r.Ya.bind(null, Object(i.ec)(c.msgs, c.hash)));
                            var u = ce("div");
                            u.innerHTML = s, a.appendChild(u), Object(i.K)(a)
                        }), "bottom")
                    }
                }.bind(null, {
                    all: !1,
                    loading: o.all,
                    offset: o.offset
                }, e, a, l),
                h = Object(s.a)({
                    handlers: function(e, t) {
                        e(a, "scroll", g)
                    }
                });
            return {
                unmount: function() {
                    Object(s.c)(h), f.unmount(), _.unmount(), u.offData(p)
                }
            }
        }
        var Zs = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            $s = debounce(D.b, 1e3),
            ec = "_im_important_counter",
            tc = "_im_gim_mute";

        function nc(e) {
            return ge("im_dialogs_search", e)
        }

        function rc(e, t, n, i, a, s) {
            var c = trim(s);
            if (Object(o.M)(e, c)) {
                var u = sc.bind(null, e, n, a, t);
                c ? (e.setState({
                    recentSearch: !1
                }), a.stop()) : a.replaceOrAdd(u), cancelStackPush("im_search", u), c && e.set(r.Rb.bind(null, c, !1)).then(t), addClass(i, "im-page--dialogs-search_fill"), addClass(i, "_im_d_search")
            } else c || (a.stop(), e.set(r.Rb.bind(null, "", !1)).then(t), removeClass(i, "im-page--dialogs-search_fill"), removeClass(i, "_im_d_search"))
        }

        function ic(e, t, n) {
            return function() {
                Object(o.r)(t) === e && n.apply(void 0, arguments)
            }
        }

        function oc(e, t, n) {
            var i = Object(o.r)(n);
            return $s(.01, "im_search_stat", 1, "search_start"), Object(r.Ac)(i), n.setState({
                recentSearch: !1
            }), e().toggleSettingsButton(n, !!i), i ? (n.get().dialog_search_going = !0, function(e, t, n) {
                var i = ic(e, n, t().appendFastDialogs.bind(null, n));
                return Object(r.Ib)(e, n.get()).then(function(e) {
                    return i(e), e
                })
            }(i, e, n).then(function(r) {
                var o = r.map(function(e) {
                    return e.peerId
                });
                return t(i, e, o, n)
            }).then(function(e) {
                n.get().dialog_search_going = !1
            }).catch(function() {})) : (e().restoreDialogs(n, !1, !0), Promise.resolve(!1))
        }

        function ac(e, t, n, o) {
            var a = o.get(),
                s = ic(e, o, t().appendDialogs.bind(null, o)),
                c = ic(e, o, t().appendSearch);
            return Object(i.Xa)(o) ? Object(r.Cb)(e, n, "all", {}, a).then(s) : Promise.all([Object(r.Cb)(e, n, "all", {}, a).then(s), Object(r.Gb)(e, a)]).then(function(e) {
                var t = Zs(e, 2),
                    n = Zs(t[1], 2),
                    r = n[0],
                    i = n[1];
                c(o, r, i, !0)
            })
        }

        function sc(e, t, n, r) {
            cancelStackFilter("im_search");
            var i = nc(t);
            uiSearch.reset(i), e.setState({
                recentSearch: !1
            }), rc(e, r, t, i, n, i.value)
        }

        function cc(e, t) {
            return showTooltip(t, {
                appendEl: bodyNode,
                text: function() {
                    return Object(o.L)(e) ? getLang("mail_cancel") : getLang("mail_start_conversaion")
                },
                black: 1,
                shift: [3, -1],
                appendCls: "js-im-page"
            })
        }

        function uc(e, t, n) {
            var i = n.target;
            e.set(r.gc.bind(null, t)).then(function() {
                toggleClass(i, "im-page--gim-mute_muted", e.get().mute), t && lc(e, {
                    target: i
                })
            })
        }

        function lc(e, t) {
            var n = t.target;
            return showTooltip(n, {
                text: function() {
                    return e.get().mute ? getLang("mail_im_sound_off") : getLang("mail_im_sound_on")
                },
                black: 1,
                shift: [13, 9],
                appendCls: "js-im-page"
            })
        }

        function dc(e, t, n, r, i, o) {
            return {
                focusInput: function(t) {
                    uiSearch.focus(nc(e).parentNode)
                },
                createCanceled: function(e, n) {
                    removeClass(t, "im-dialog-select_rotated")
                },
                rotateCross: function(e) {
                    addClass(t, "im-dialog-select_rotated")
                },
                setSearch: function(t, n) {
                    var i = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                    ! function(e, t, n, r, i) {
                        var o = nc(t);
                        o.value = i, rc(e, r, t, o, n, o.value)
                    }(t, e, r, i ? o : function() {}, n)
                },
                clearSearch: function(t) {
                    sc(t, e, r, function() {})
                },
                updateImportantCnt: function(t) {
                    var n = t.get().important_cnt,
                        r = geByClass1(ec, e);
                    toggleClass(r, "im-page--stars_hidden", 0 === n), r.innerHTML = "<i></i> " + n
                },
                unmount: function() {
                    r.stop(), Object(s.c)(i), uiSearch.destroy(n), cancelStackFilter("im_search")
                }
            }
        }

        function _c(e, t, n) {
            var a = geByClass1("_im_search_croll", e),
                u = nc(e),
                l = Xs("im_search", ["_im_search_croll", "_im_page_dcontent", "_im_d_search", "_im_dialog"]),
                d = Object(_t.b)(ac, 300),
                _ = oc.bind(null, n, d),
                f = rc.bind(null, t, _, e, u, l),
                p = function(e, t, n, r, i, a) {
                    Object(o.L)(e) ? (sc(e, t, i, n), setTimeout(function() {
                        return cc(e, a)
                    }, 10)) : (window.tooltips && tooltips.hide(a, {
                        showsp: 0
                    }), function(e, t, n) {
                        n().showCreation(e)
                    }(e, 0, r))
                }.bind(null, t, e, _, n, l, a),
                m = function(e, t, n, r, o) {
                    return Object(i.Ob)(e, n, Js, r)
                }.bind(null, t, e, n),
                g = geByClass1("_im_dialogs_search_input", e);
            uiSearch.init(g, {
                onChange: f
            });
            var h = cc.bind(null, t, a),
                b = geByClass1(tc, e);
            u.value && f(u.value);
            var v = Object(s.a)({
                handlers: function(s, d) {
                    if (s(geByClass1("_im_av_time", e), "mouseover", function(e) {
                            showTooltip(e.target, {
                                text: getLang("mail_admin_av_time"),
                                dir: geByClass1("_im_top_notice") || geByClass1("im-page--dialogs--group-status") ? "down" : "up",
                                shift: [0, 8]
                            })
                        }), s(a, "click", p), s(a, "mouseover", h), s(geByClass1(ec, e), "click", m), Object(i.Ia)(t)) {
                        var _ = uc.bind(null, t, !0),
                            f = lc.bind(null, t);
                        s(b, "click", _), s(b, "mouseover", f)
                    }
                    s(u, "focus", function() {
                        t.get().longpoll.push([Object(c.eb)("search")])
                    }), s(u, "click", function() {
                        Object(o.L)(t) && n().toggleSettingsButton(t, !0),
                            function(e, t, n, a, s) {
                                if (!Object(o.L)(e)) {
                                    var c = cur.imDb.select(Pa.b);
                                    if (0 !== c.length || Object(o.c)(e)) {
                                        e.setState({
                                            recentSearch: !0
                                        }), rc(e, function() {
                                            Object(o.L)(e) || (a.stop(), s().toggleSettingsButton(e, !1), s().restoreDialogs(e, !1, !0))
                                        }, t, n, a, "");
                                        var u = c.filter(function(t) {
                                                return !Object(i.cb)(e.get(), t)
                                            }),
                                            l = c.filter(function(t) {
                                                return Object(i.cb)(e.get(), t)
                                            }).reduce(function(t, n) {
                                                return t[n] = Object(o.t)(e, n), t
                                            }, {});
                                        e.get().topConvTree.then(function(t) {
                                            var n = t.list.filter(function(e) {
                                                    return inArray(e[0], u)
                                                }).reduce(function(e, t) {
                                                    return e[t[0]] = Object(r.Ua)(t), e
                                                }, {}),
                                                i = extend({}, n, l);
                                            return s().appendFastDialogs(e, c.map(function(e) {
                                                return i[e]
                                            })), Object(r.Cb)(!1, Object.keys(n), !1, {}, e.get())
                                        }).then(function(t) {
                                            s().appendDialogs(e, t)
                                        })
                                    }
                                }
                            }(t, e, u, l, n)
                    }), s(u, "blur", function() {
                        var e = void 0;
                        e = 0 === t.get().peer ? "search" : Object(i.Xa)(t) ? "search" : "default", Object(o.L)(t) || n().toggleSettingsButton(t, !1), t.get().longpoll.push([Object(c.eb)(e)])
                    })
                }
            });
            return Object(i.Ia)(t) && uc(t, !1, {
                target: b
            }), dc(e, a, g, l, v, _)
        }
        var fc = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            pc = "_im_spam_not_spam",
            mc = "_im_spam_spam";

        function gc(e, t) {
            var n = t.get().selectedMessages,
                r = geByClass1("_im_spam_box", e.bodyNode),
                o = geByClass1("ui_tab_sel", e.bodyNode);
            if (n.length > 0) {
                var a = getLang("mail_selected", n.length);
                a = a.replace("{count}", n.length), val(o, a + '<button aria-label="' + getLang("mail_deselect_all") + '" type="button" class="im-deselect ' + i.k + '"></button>')
            } else val(o, getLang("mail_spam"));
            0 === n.length ? removeClass(r, "im-important-box_with-sel") : (addClass(r, "im-important-box_with-sel"), val(geByClass1(pc), getLang("mail_im_mark_notspam", n.length)), val(geByClass1(mc), getLang("mail_im_mark_delspam", n.length)))
        }

        function hc(e, t, n) {
            var i = e.get().selectedMessages;
            e.set(r.t).then(n.cleanSelection.bind(null, i)).then(function(n) {
                return gc(t, e)
            })
        }

        function bc(e, t) {
            return {
                unmount: function() {
                    t.unmount(), Object(s.c)(e)
                }
            }
        }

        function vc(e, t, n) {
            var o = ge("box_layer_wrap"),
                a = Object(s.b)(bc),
                u = a.callMutations,
                l = a.bindMutations,
                d = m({
                    peer: 0,
                    oCache: {},
                    tabs: Object(i.ec)(n.msgs, n.hash),
                    gid: t.get().gid
                }),
                _ = function(e, t, n, o) {
                    if (!e.loading && !e.all && n.scrollTop + window.innerHeight - n.scrollHeight > -300) {
                        var a = geByClass1("_im_peer_history", t.bodyNode);
                        e.loading = !0, Object(i.lc)(a)(Object(r.Ta)(e.offset, o.get().gid).then(function(t) {
                            var n = fc(t, 4),
                                s = (n[0], n[1]),
                                c = (n[2], n[3]);
                            e.all = c.all, e.offset = c.offset, e.all ? addClass(a, "im-important_all") : e.loading = !1, o.set(r.Ya.bind(null, Object(i.ec)(c.msgs, c.hash)));
                            var u = ce("div");
                            u.innerHTML = s, a.appendChild(u), Object(i.K)(a)
                        }), "bottom")
                    }
                }.bind(null, {
                    all: n.all,
                    loading: !1,
                    offset: n.offset
                }, e, o, d),
                f = function(e, t, n, o) {
                    var a = gpeByClass("_im_mess", o, t);
                    if (a) {
                        var s = intval(domData(a, "msgid"));
                        a && (Object(r.lb)([s], 0, e.get().tabs[0].hash, "undel", e.get()), Object(i.Gb)(s, 0, t))
                    }
                }.bind(null, d, e.bodyNode),
                p = function(e, t, n, r, i) {
                    var o = gpeByClass("_im_mess", i, t.bodyNode),
                        a = intval(domData(o, "peer")),
                        s = intval(domData(o, "msgid"));
                    return t.hide(), n().unmount(), e.get().longpoll.push([Object(c.Ba)(a, s)]), stopEvent(r), cancelEvent(r), !1
                }.bind(null, t, e, u),
                g = function(e, t, n, i) {
                    var o = showFastBox({
                        title: getLang("mail_deleteall1"),
                        dark: 1,
                        bodyStyle: "padding: 20px; line-height: 160%;"
                    }, getLang("mail_delete_all_spam"), getLang("mail_delete"), function() {
                        Object(r.J)(e, i).then(function(e) {
                            var t = fc(e, 2),
                                n = (t[0], t[1]);
                            showDoneBox(n)
                        }), o.hide(), t.hide(), n().unmount()
                    }, getLang("mail_close"), function() {
                        return o.hide()
                    })
                }.bind(null, n.hash, e, u, t.get().gid),
                h = da(e.bodyNode, d, function(t) {
                    return {
                        changedMessageSelection: gc.bind(null, e)
                    }
                }),
                b = function(e, t, n) {
                    var o = e.get().selectedMessages;
                    Object(r.lb)(o, 0, e.get().tabs[0].hash, "delete", e.get()), Object(i.nb)(o, 0, "delete", t), hc(e, t, n)
                }.bind(null, d, e.bodyNode, h),
                v = function(e, t, n) {
                    var o = e.get().selectedMessages;
                    Object(r.lb)(o, 0, e.get().tabs[0].hash, "nospam", e.get()), o.map(function(e) {
                        return geByClass1("_im_mess_" + e)
                    }).filter(function(e) {
                        return e
                    }).forEach(function(e) {
                        var t = intval(domData(e, "peer")),
                            n = intval(domData(e, "msgid"));
                        val(e, Object(i.ub)(t, n)), addClass(e, "im-mess_light")
                    }), hc(e, t, n)
                }.bind(null, d, e.bodyNode, h),
                y = hc.bind(null, d, e, h);
            return Object(i.K)(e.bodyNode), l(Object(s.a)({
                handlers: function(t, n) {
                    t(o, "scroll", _), t(geByClass1(mc, e.bodyNode), "click", b), t(geByClass1(pc, e.bodyNode), "click", v), t(geByClass1("_im_spam_flush", e.bodyNode), "click", g), n(e.bodyNode, "click", "_im_mess_restore", f), n(e.bodyNode, "click", "_im_go_to", p), n(e.bodyNode, "click", i.k, y)
                }
            }), h)
        }
        var yc = "_im_dialogs_cog_settings",
            Oc = "_im_settings_action",
            jc = "_im_to_unread";

        function wc() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "im_settings";
            return getTemplate(e, {
                sound: ls.get("sound_notify_off") ? getLang("mail_im_sound_off") : getLang("mail_im_sound_on"),
                browser: Ec() ? getLang("mail_im_notifications_on") : getLang("mail_im_notifications_off")
            })
        }

        function Ec() {
            return DesktopNotifications.supported() && !DesktopNotifications.checkPermission() && !ls.get("im_ui_notify_off")
        }

        function kc(e, t, n) {
            var a = function(e, t) {
                    showTooltip(t.target, {
                        content: wc("im_settings_pop"),
                        dir: "down",
                        shift: [220, 9],
                        hasover: !0,
                        showdt: 300
                    })
                }.bind(null, t),
                c = function(e, t, n, r, o) {
                    var a = domData(o, "action"),
                        s = gpeByClass("_im_settings_menu", o),
                        c = hasClass(s, "_im_settings_popup") ? "im_settings_pop" : "im_settings";
                    switch (a) {
                        case "spam":
                            Object(i.Wb)(e, vc, r);
                            break;
                        case "sound":
                            ls.get("sound_notify_off") ? ls.set("sound_notify_off", 0) : ls.set("sound_notify_off", 1), s.outerHTML = wc(c);
                            break;
                        case "browser":
                            Ec() ? (ls.set("im_ui_notify_off", 1), s.outerHTML = wc(c), Object(ye.a)()) : DesktopNotifications.checkPermission() ? DesktopNotifications.requestPermission(function() {
                                s.parentNode && (s.outerHTML = wc(c))
                            }) : (ls.set("im_ui_notify_off", 0), s.outerHTML = wc(c), Object(ye.b)())
                    }
                }.bind(null, t, n, e),
                u = function(e, o) {
                    if (Object(i.Yb)(t, n, r.o)) {
                        var a = t.get().active_tab === _.m;
                        val(o, getTemplate("im_filter", {
                            filter: a ? getLang("mail_to_all_dialogs") : getLang("mail_to_unread")
                        }))
                    }
                },
                l = Object(s.a)({
                    handlers: function(t, n) {
                        n(e, "mouseover", yc, a), n(e, "click", Oc, c), n(e, "click", jc, u)
                    }
                });
            return function(e, t) {
                return {
                    updateFilter: function(t) {
                        var n = t.get().active_tab === _.m,
                            r = void 0,
                            i = [];
                        Object(o.L)(t) && i.push("im-page--dialogs-filter_hidden"), t.get().unread_cnt > 0 ? r = n ? getLang("mail_to_all_dialogs") : getLang("mail_to_unread") : (r = getLang("mail_all_dialogs"), i.push("im-page--dialogs-filter_disabled")), val(geByClass1(jc, e), getTemplate("im_filter", {
                            filter: r,
                            cls: i.join(" ")
                        }))
                    },
                    toggleButton: function(t, n) {
                        var r = geByClass1("im-page--dialogs-filter", e);
                        toggleClass(r, "im-page--dialogs-filter_hidden", n)
                    },
                    toggleLoader: function(t, n) {
                        var r = geByClass1(yc, e);
                        toggleClass(r, "im-page--dialogs-settings_loading", n)
                    },
                    updateSettings: function(t) {
                        geByClass1("_im_settings_menu", e).outerHTML = wc()
                    },
                    unmount: function() {
                        Object(s.c)(t)
                    }
                }
            }(e, l)
        }
        var Cc = "_ui_multiselect_cancel";

        function xc(e) {
            return e.selection = [], Promise.resolve(e)
        }

        function Pc(e, t) {
            return t.selection = t.selection.filter(function(t) {
                return t.id !== e
            }), Promise.resolve(t)
        }

        function Mc(e, t, n, r) {
            e.set(xc).then(Tc.bind(null, t, n, e, r))
        }

        function Tc(e, t, n, r) {
            var i = n.get().selection,
                o = uiSearch.getFieldEl(e);
            uiSearch.focus(e), i.length > 0 ? attr(o, "placeholder", "") : attr(o, "placeholder", unclean(getLang("mail_search_creation"))), t.innerHTML = i.map(function(e) {
                return '<div class="token">\n      <div class="token_title">' + e.name + '</div>\n      <div data-peer="' + e.id + '" class="token_del ' + Cc + '"></div>\n    </div>'
            }).join(""), toggleClass(e, "ui_multiselect_has_selection", i.length > 0), domFC(e).scrollTop += 50, r()
        }

        function Ic(e, t) {
            return showTooltip(t, {
                text: getLang("mail_create_chat_remove_user"),
                black: 1,
                shift: [15, 8],
                appendParentCls: "_wrap"
            })
        }

        function Sc(e, t, n) {
            uiSearch.init(e, {
                onChange: function(e, t, n, i) {
                    e.set(r.Rb.bind(null, n, !1)).then(t().onChange)
                }.bind(null, t, n)
            });
            var i = uiSearch.getFieldEl(e),
                o = ce("div", {
                    className: "_ui_multiselection ui_multiselect_cnt"
                });
            i && i.parentNode.insertBefore(o, i);
            var a, c, u = (a = i, c = 0, function() {
                var e = a.offsetWidth;
                setStyle(a, {
                    width: 1
                });
                var t = a.offsetLeft;
                c !== t ? (c = t, e = a.parentNode.offsetWidth, setStyle(a, {
                    width: Math.max(30, e - t - 20)
                })) : setStyle(a, {
                    width: e
                })
            });
            t.set(xc);
            var l = function(e, t, n, r, i, o, a) {
                    var s = intval(domData(a, "peer"));
                    tooltips.hide(a), t.set(Pc.bind(null, s)).then(function(o) {
                        Tc(e, r, t, i), n().selectionDeleted(t, s)
                    })
                }.bind(null, e, t, n, o, u),
                d = function(t) {
                    document.activeElement !== i && uiSearch.focus(e)
                },
                _ = Object(s.a)({
                    handlers: function(t, n) {
                        n(e, "click", Cc, l), n(e, "mouseover", Cc, Ic), t(e, "click", d)
                    }
                });
            return {
                addSelection: function(n, r) {
                    return t.set(function(e, t) {
                        return t.selection || (t.selection = []), t.selection.push(e), Promise.resolve(t)
                    }.bind(null, {
                        id: n,
                        name: r
                    })).then(Tc.bind(null, e, o, t, u))
                },
                removeSelection: function(n) {
                    return t.set(Pc.bind(null, n)).then(Tc.bind(null, e, o, t, u))
                },
                resetSelection: function() {
                    Mc(t, e, o, u)
                },
                focus: function() {
                    uiSearch.focus(e)
                },
                save: function() {
                    t.stash(), Tc(e, o, t, u)
                },
                restore: function() {
                    t.pop(), Tc(e, o, t, u)
                },
                unmount: function() {
                    uiSearch.destroy(e), Object(s.c)(_)
                }
            }
        }
        var Dc = "_im_create_cancel",
            Bc = "_im_create_list",
            Lc = "_im_dialog",
            Ac = "_im_create_tab",
            Rc = "_im_dialogs_creation_name",
            Nc = "_im_create_select",
            Uc = "_im_create_avatar",
            Wc = "_im_create_remove_avatar",
            Hc = "_im_confirm_creation",
            Kc = "_im_cancel_creation",
            qc = "_im_avatar_img",
            Fc = ["im-creation--item_hovered"],
            zc = "olist_item_wrap_on",
            Vc = "ui_search_reset",
            Qc = 100;

        function Gc(e, t, n, i, o, a) {
            Object(r.hc)(!1), removeClass(t, "im-create_shown"), removeClass(t, "im-create_photo-attached"), setTimeout(Yc.bind(null, t, !1), 100), eu(a).map(function(e) {
                return geByClass1("_im_dialog" + e)
            }).forEach(function(e) {
                removeClass(e, zc)
            }), n().createCanceled(e, i), o.resetSelection(), "add_member" === e.get().creationType && e.set(r.Qb.bind(null, "chat", [])), e.set(r.db.bind(null, !1));
            var s = geByClass1(qc, t);
            Jc(e, a, t), uiSearch.reset(geByClass1(Rc, t)), uiSearch.reset(geByClass1(Nc, t)), s && s.parentNode.removeChild(s), Jc(e, a, t), cancelStackFilter("im_search");
            var u = 0 === e.get().peer ? "search" : "default";
            e.get().longpoll.push([Object(c.eb)(u)]), attr(t, "aria-hidden", "true")
        }

        function Xc(e, t, n) {
            return t && (n.current_create_peer_ids = {}, n.current_create_peers = []), n.current_create_peer_ids || (n.current_create_peer_ids = {}), n.current_create_peers || (n.current_create_peers = []), e.forEach(function(e) {
                e.then(function(e) {
                    e = e.filter(function(e) {
                        return !n.current_create_peer_ids[e.peerId]
                    }), n.current_create_peer_ids = e.reduce(function(e, t) {
                        return e[t.peerId] = !0, e
                    }, n.current_create_peer_ids), n.current_create_peers = n.current_create_peers.concat(e)
                })
            }), Promise.resolve(n)
        }

        function Yc(e, t) {
            toggleClass(e, "im-create_material", t)
        }

        function Jc(e, t, n) {
            var r = geByClass1(Hc, n),
                i = t.get().selection.length,
                o = "add_member" === e.get().creationType,
                a = i > 0,
                s = uiSearch.getFieldEl(geByClass1(Rc, n)).value.length > 0,
                c = !a && (o || !s),
                u = o ? 1 === i ? getLang("mail_append_chat") : getLang("mail_im_create_chat_with") : s || i > 1 ? getLang("mail_im_create_chat") : getLang("mail_im_go_to_dialog");
            val(r, u), toggleClass(r, "button_disabled", c)
        }

        function Zc(e, t, n, r, i, o, a) {
            if (a) {
                var s = intval(domData(a, "list-id")),
                    c = eu(o),
                    u = trim(a.textContent),
                    l = geByClass1(Nc, t),
                    d = getSize(l)[1],
                    _ = void 0;
                inArray(s, c) ? (_ = r.removeSelection(s, u), removeClass(a, zc)) : (_ = r.addSelection(s, u), addClass(a, zc)), _.then(function() {
                    var e = d - getSize(l)[1],
                        t = i.scrollTop();
                    i.scrollTop(t - e)
                }), Jc(e, o, t);
                var f = geByClass1(Nc, t);
                uiSearch.reset(f)
            }
        }

        function $c(e) {
            return Object(o.r)(e) || !1
        }

        function eu(e) {
            return e.get().selection.map(function(e) {
                return e.id
            })
        }

        function tu(e, t, n, r) {
            toggleClass(e, "im-create_chat", "chat" === r.get().creationType), toggleClass(e, "im-create_invite", "add_member" === r.get().creationType);
            var o = "chat" === r.get().creationType ? getLang("mail_im_group_dialog") : getLang("mail_im_friends_tab"),
                a = geByClass1("_im_create_title", e);
            val(a, o), val(geByClass1(Hc, e), "add_member" === r.get().creationType ? getLang("mail_im_create_chat_with") : getLang("mail_im_create_chat")), ru(e, r, t, !1, n.get().selection.map(function(e) {
                return e.id
            })), Object(i.L)("_im_create_wrap_safe", e)
        }

        function nu(e, t, n) {
            return e.then(function(e) {
                return e.filter(function(e) {
                    return e.is_friend && !inArray(e.peerId, n.get().creationFilter)
                })
            })
        }

        function ru(e, t, n, i, o) {
            var a = geByClass1(Nc, e),
                s = void 0,
                c = void 0,
                u = Object(r.Fb)(i, t.get()),
                l = n.hoverFirstElement.bind(n, Fc, au(t));
            t.get().creation_shown_all = !1, n.reset(), n.pipe(nu(u, 0, t), i), n.toTop(), i ? (c = Object(r.Ib)(i, t.get()), s = Object(r.Db)(i, [], "friends", t.get()), n.pipe(nu(s, 0, t), i).then(l), n.pipe(nu(c, 0, t), i).then(l)) : (s = Promise.resolve([]), c = Promise.resolve([])), t.set(Xc.bind(null, [u, c, s], !0)), uiSearch.showProgress(a), Promise.all([u, s, c]).then(function() {
                return uiSearch.hideProgress(a)
            })
        }

        function iu(e, t, n, r, i, o) {
            eu(t).map(function(e) {
                return geByClass1("_im_dialog" + e)
            }).forEach(function(e) {
                return removeClass(e, zc)
            }), t.reset(), ru(n, e, r, !1, eu(t)), i.resetSelection(), Gc(e, n, o, !1, i, t)
        }

        function ou(e, t, n, i, a, s, u) {
            var l = eu(t),
                d = e.get(),
                _ = geByClass1(Hc, n),
                f = uiSearch.getFieldEl(geByClass1(Rc, n)).value,
                p = "add_member" === e.get().creationType,
                m = !p && (f.length || l.length > 1);
            if (p) return e.set(r.i.bind(null, d.peer, l)).catch(function(e) {
                return showFastBox(getLang("global_error"), e)
            }), Gc(e, n, s, "", a, t);
            if (lockButton(_), !m) return g(l[0]);

            function g(r) {
                iu(e, t, n, i, a, s),
                    function(e, t, n, r, i, o) {
                        Gc(e, t, n, !1, i, o), e.get().longpoll.push([Object(c.Ba)(r, !1, !1, !1, "create_conversation")])
                    }(e, n, s, r, a, t), unlockButton(_), Object(o.L)(e) ? s().cancelSearch(e) : s().restoreDialogs(e)
            }
            e.set(r.w.bind(null, d.next_chat_avatar, l, f)).then(function() {
                return g(d.next_peer)
            }).catch(function(e) {
                unlockButton(_), topMsg(getLang("global_unknown_error"), 2, "#FFB4A3")
            })
        }

        function au(e, t) {
            var n = t && t.get().selection.length;
            return {
                top: -1,
                bottom: Object(i.Ia)(e) ? n > 0 ? 69 : 0 : -1
            }
        }

        function su(e, t, n) {
            var o = m({
                    selection: []
                }),
                a = S(geByClass1(Bc, e), m({
                    offset: 0,
                    limit: Qc,
                    elements: [],
                    elCls: Lc
                }), function() {
                    return {
                        idFn: function(e) {
                            return intval(e.peerId)
                        },
                        hoverableFn: function(e) {
                            return hasClass(e, "_im_dialog")
                        },
                        renderFn: function(e, t) {
                            var n = eu(e),
                                r = ["_im_dialog", "_im_dialog" + t.peerId, "im-creation--item"],
                                i = [];
                            return t.online && i.push("online"), mobPlatforms[t.online] && i.push("mobile"), inArray(t.peerId, n) && r.push(zc), getTemplate("im_owner_item", {
                                owner_id: t.peerId,
                                cls: " " + r.join(" "),
                                photo: t.photo,
                                name: t.name,
                                link: t.href,
                                img_cls: i.join(" ")
                            })
                        }.bind(null, o),
                        more: function(e, n) {
                            var i = void 0;
                            return t.get().shown ? (t.get().creation_shown_all || !1 !== $c(o) ? i = Promise.resolve([]) : (t.get().creation_shown_all = !0, i = Object(r.Ib)($c(o), t.get())), t.set(Xc.bind(null, [i], !1)), nu(i, $c(o), t)) : Promise.resolve(!1)
                        },
                        onClick: function(n, r) {
                            checkEvent(n) || (Zc(t, e, 0, u, a, o, r), cancelEvent(n))
                        }
                    }
                });
            t.get().creationQuery = !1, t.get().creationType = "chat";
            var u = Sc(geByClass1(Nc, e), o, function() {
                    return {
                        selectionDeleted: function(n, r) {
                            Jc(t, n, e), removeClass(geByClass1("_im_dialog" + r), zc)
                        },
                        onChange: function(e, t, n, r) {
                            var i = r.get(),
                                o = $c(i);
                            i.selection.map(function(e) {
                                return e.id
                            }), n.unhoverElements(Fc), e.get().creationQuery = o, ru(t, e, n, o)
                        }.bind(null, t, e, a)
                    }
                }),
                l = Gc.bind(null, t, e, n, "cross", u, o),
                d = function(e, t, n, i, o, a, s, c) {
                    uiTabs.switchTab(c.firstElementChild);
                    var u = domData(c, "type");
                    switch (u) {
                        case "chat":
                            a.restore()
                    }
                    e.set(r.Qb.bind(null, u, [])).then(tu.bind(null, t, i, o))
                }.bind(null, t, e, n, a, o, u),
                _ = function(e, t, n, i) {
                    var o = 2e9 + Math.round(rand(1e6, 2e6));
                    cur.recieveCropResult = function(n) {
                        cur.recieveCropResult = !1, curBox() && curBox().hide(), e.set(r.db.bind(null, n)), Object(r.P)(n, o).then(function(e) {
                            geByClass1(Uc, t).appendChild(ce("img", {
                                className: "im-chat-placeholder--img " + qc,
                                src: e
                            }))
                        }), addClass(t, "im-create_photo-attached")
                    }, Page.ownerPhoto(o)
                }.bind(null, t, e),
                f = function(e, t) {
                    geByClass1(Uc, t).innerHTML = "", e.set(r.db.bind(null, !1)), removeClass(t, "im-create_photo-attached")
                }.bind(null, t, e),
                p = iu.bind(null, t, o, e, a, u, n),
                g = ou.bind(null, t, o, e, a, u, n),
                h = function(e, t, n) {
                    Jc(e, t, n)
                }.bind(null, t, o, e),
                b = geByClass1(Dc, e),
                v = geByClass1(Rc, e),
                y = v.querySelector("." + Vc),
                O = Object(s.a)({
                    handlers: function(t, n) {
                        t(b, "click", l), t(b, "mouseover", function(e, t) {
                            return showTooltip(e, {
                                text: getLang("mail_cancel"),
                                black: 1,
                                zIndex: 1e3,
                                shift: [3, -2],
                                appendCls: "js-im-page"
                            })
                        }.bind(null, b)), t(geByClass1(Uc, e), "click", _), t(geByClass1(Wc, e), "click", f), t(geByClass1(Kc, e), "click", p), t(v, "change", h), t(v, "input", h), t(v, "paste", h), t(y, "click", h), t(geByClass1(Hc, e), "click", g), t(e, "mouseover", throttle(a.unhoverElements.bind(a, Fc), 100)), n(e, "click", Ac, d)
                    }
                });
            return function(e, t, n, r, o, a, u, l) {
                return {
                    show: function(t) {
                        var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
                        t.setState({
                            shown: !0
                        }), Yc(e, !0), cancelStackPush("im_create", u), addClass(e, "im-create_shown");
                        var a = r.get().selection.reduce(function(e, t) {
                            return e[t.id] = !0, e
                        }, {});
                        i && i.forEach(function(t) {
                            if (!a[t[0]]) {
                                var n = e.querySelector("._im_dialog" + t[0]);
                                o.addSelection(t[0], t[1]), n && !n.classList.contains(zc) && n.classList.add(zc)
                            }
                        }), tu(e, n, r, t), setTimeout(function() {
                            t.get().longpoll.push([Object(c.eb)("create")]), attr(e, "aria-hidden", "false"), o.focus()
                        }, 1)
                    },
                    focusSearch: function(e) {
                        o.focus()
                    },
                    confirmCreate: function(e) {
                        l()
                    },
                    hide: function(n) {
                        n.get().shown = !1, Gc(n, e, t, !1, o, r)
                    },
                    scroll: function(e) {
                        n.scrollPage(e, !0)
                    },
                    updateScroll: function() {
                        Object(i.L)("_im_create_wrap_safe", e), n.updateScroll()
                    },
                    selectElement: function(t) {
                        Zc(t, e, 0, o, n, r, n.getHoveredElement())
                    },
                    hoverPrevElement: function(e) {
                        n.hoverPrevElement(Fc, null, au(e, r))
                    },
                    hoverNextElement: function(e) {
                        n.hoverNextElement(Fc, null, au(e, r))
                    },
                    unmount: function() {
                        Object(s.c)(a), n.unmount(), o.unmount(), cancelStackFilter("im_create"), cur.recieveCropResult = void 0
                    }
                }
            }(e, n, a, o, u, O, l, g)
        }
        var cu = n("p3re");

        function uu(e, t, n, r, o) {
            switch (t) {
                case _.b:
                    Object(i.Ma)() || (r.scroll(o, "up"), cancelEvent(n));
                    break;
                case _.a:
                    Object(i.Ma)() || (r.scroll(o, "down"), cancelEvent(n));
                    break;
                case _.v:
                    n.ctrlKey || Object(i.Ia)(o) || (r.scroll(o, "up", !0), cancelEvent(n));
                    break;
                case _.u:
                    n.ctrlKey || Object(i.Ia)(o) || (r.scroll(o, "down", !0), cancelEvent(n));
                    break;
                case _.o:
                    Object(i.Ma)() || (r.scroll(o, "up", !1, !0), cancelEvent(n));
                    break;
                case _.d:
                    Object(i.Ma)() || (r.scroll(o, "down", !1, !0), cancelEvent(n));
                    break;
                case _.w:
                    r.focustTxt(e)
            }
        }

        function lu(e, t, n, r, o, a) {
            var s = m({
                state: t || "default"
            });
            return {
                signal: function(t, c) {
                    if (!(cur.storyLayer || cur.articleEditorLayer || window.isArticleLayerOpen())) switch (s.get().state) {
                        case "default":
                            return uu(s, t, c, r, e);
                        case "fwd":
                        case "search":
                            return function(e, t, n, r, o, a) {
                                switch (t) {
                                    case _.a:
                                        r.hoverNextDialog(a), cancelEvent(n);
                                        break;
                                    case _.b:
                                        r.hoverPrevDialog(a), cancelEvent(n);
                                        break;
                                    case _.e:
                                        Object(i.Ma)() && !gpeByClass("_im_dialogs_search_input", document.activeElement) || r.selectHoveredDialog(a);
                                        break;
                                    case _.w:
                                        o.focusInput(a)
                                }
                            }(0, t, c, n, o, e);
                        case "create":
                            return function(e, t, n, r, o) {
                                switch (t) {
                                    case _.v:
                                        !n.ctrlKey && Object(i.Ia)(o) && (r.scroll("up"), cancelEvent(n));
                                        break;
                                    case _.u:
                                        !n.ctrlKey && Object(i.Ia)(o) && (r.scroll("down"), cancelEvent(n));
                                        break;
                                    case _.a:
                                        r.hoverNextElement(o);
                                        break;
                                    case _.b:
                                        r.hoverPrevElement(o);
                                        break;
                                    case _.e:
                                        gpeByClass("_im_dialogs_creation_name", document.activeElement) ? r.confirmCreate(o) : gpeByClass("im-create--search", document.activeElement) && r.selectElement(o);
                                        break;
                                    case _.w:
                                        r.focusSearch(o)
                                }
                            }(0, t, c, a, e);
                        case "message":
                            return function(e, t, n, r, i) {
                                switch (t) {
                                    case _.o:
                                    case _.d:
                                        r.isEmpty(i) && uu(e, t, n, r, i);
                                        break;
                                    case _.v:
                                    case _.u:
                                        uu(e, t, n, r, i)
                                }
                            }(s, t, c, r, e);
                        default:
                            throw new Error("Unknown state: " + s.get().state)
                    }
                },
                transition: function(e) {
                    return s.set(function(e, t) {
                        return t.state = e, Promise.resolve(t)
                    }.bind(null, e))
                }
            }
        }
        var du = n("BxOC"),
            _u = n("iN1s"),
            fu = n("EUzL"),
            pu = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            mu = 202,
            gu = 4,
            hu = 5,
            bu = 3e4,
            vu = {},
            yu = Date.now();

        function Ou(e, t) {
            var n = Math.floor(t.status / 100);
            t.status && e.stat && (t.status >= 500 && t.status < 600 && statlogsValueEvent("im_longpoll", 1, n + "0x", t.getResponseHeader("x-frontend")), vu[n] = vu[n] ? vu[n] + 1 : 1, Date.now() - yu >= bu && (Object.keys(vu).forEach(function(e) {
                statlogsValueEvent("im_longpoll", vu[e], e + "0x", t.getResponseHeader("x-frontend"))
            }), vu = {}, yu = Date.now()))
        }

        function ju(e) {
            return e.updates.map(function(e) {
                switch (e[0]) {
                    case 0:
                        return c.Ga(e);
                    case 1:
                        return c.Va(e);
                    case 2:
                        return c.db(e);
                    case 3:
                        return c.Za(e);
                    case 4:
                        return c.Z(e);
                    case 5:
                        return c.Ha(e);
                    case 6:
                        return c.Pa(e);
                    case 7:
                        return c.Qa(e);
                    case 8:
                        return c.Ma(e);
                    case 9:
                        return c.La(e);
                    case 10:
                        return c.Ya(e);
                    case 11:
                        return c.Ua(e);
                    case 12:
                        return c.cb(e);
                    case 13:
                        return c.Fa(e);
                    case 18:
                        return c.Wa(e);
                    case 51:
                        return c.Da(e);
                    case 52:
                        return c.Ea(e);
                    case 63:
                        return c.fb(e);
                    case 64:
                        return c.Ra(e);
                    case 70:
                        return c.hb(e);
                    case 80:
                        return c.gb(e);
                    case 114:
                        return c.Oa(e);
                    case 116:
                        return c.Ta(e);
                    case -1:
                        return c.bb();
                    default:
                        return c.Ja(e)
                }
            })
        }

        function wu(e, t) {
            return Promise.resolve(extend({}, t, {
                timeout: e < 64 ? 2 * e : e
            }))
        }

        function Eu(e, t) {
            return t.pauses || (t.pauses = []), t.pauses.push(e), Promise.resolve(t)
        }

        function ku(e) {
            return e.pauses || (e.pauses = []), Object(g.i)("Aborting all pauses", "error"), e.pauses.forEach(function(e) {
                return e()
            }), e.pauses = [], Promise.resolve(e)
        }

        function Cu(e, t, n, i) {
            var o = i.failed ? Object(_t.a)(gu, e) : {},
                a = o.abort,
                s = o.pause;
            switch (i.failed) {
                case 1:
                    return Object(g.i)("Old timestamp, init resync", "error"), e.set(Eu.bind(null, a)), n([c.bb()]), e.set(r.Oa).then(s).then(xu.bind(null, e, t, n));
                case 2:
                    return Object(g.i)("Key is incorrect", "error"), e.set(Eu.bind(null, a)), e.set(r.Na).then(s).then(xu.bind(null, e, t, n));
                case 3:
                    throw Object(f.b)("im_longpoll_force_reload", i, !1), nav.reload({
                        force: !0
                    }), new Error("ts is very wrong");
                default:
                    return e.set(function(e, t) {
                        return Promise.resolve(extend({}, t, {
                            imTs: e
                        }))
                    }.bind(null, i.ts)).then(function() {
                        return i
                    })
            }
        }

        function xu(e, t, n) {
            if (e.get().stopped) return Promise.resolve({
                updates: []
            });
            if (t()) return Promise.reject(new Error("pause"));
            var r = e.get(),
                i = r.imUrl + "/" + r.imPart,
                o = Object(du.a)(i, {
                    act: "a_check",
                    key: r.imKey,
                    version: hu,
                    ts: r.imTs,
                    wait: 25,
                    mode: r.mode
                }),
                a = o.request,
                s = o.cancel;
            return e.set(function(e, t) {
                return t.cancelToken = e, Promise.resolve(t)
            }.bind(null, s)).then(function() {
                return a
            }).then(function(t) {
                var n = pu(t, 2),
                    i = n[0],
                    o = n[1];
                return o && Ou(r, o), e.set(wu.bind(null, 1)), JSON.parse(i)
            }).catch(function(e) {
                var t = pu(e, 2),
                    n = (t[0], t[1]);
                throw n && Ou(r, n), ""
            }).then(Cu.bind(null, e, t, n))
        }

        function Pu(e) {
            var t = e.id,
                n = e.gid,
                r = e.key,
                i = e.ts,
                o = e.url,
                a = e.lhost,
                s = e.lpstat,
                c = new EventEmitter,
                u = window.vk.lpConfig && window.vk.lpConfig.enabled && window.longpollTesting_onImEvents,
                l = ji(function(e, t) {
                    return u && window.longpollTesting_onImEvents(t), c.trigger("data", t), Promise.resolve({})
                }),
                d = l.pause,
                _ = l.resume,
                f = l.pushMessage,
                p = l.isPaused,
                h = l.reset,
                b = m({
                    id: t,
                    gid: n,
                    mode: mu,
                    timeout: 1,
                    imKey: r,
                    imTs: i,
                    imPart: o,
                    imUrl: a,
                    pause: !1,
                    stat: s
                });
            return function e(t, n, r) {
                t.get().stopped || (Object(g.i)("New request"), xu(t, r, n).then(ju).then(function(e) {
                    return Object(g.i)("Request success", "success"), e
                }).then(n).catch(function(e) {
                    if (!t.get().stopped) return Object(g.i)("Error, waiting: " + (e.message || "no message (probably browser reset)"), "error"), t.set(wu.bind(null, r() ? gu / 2 : t.get().timeout)).then(function() {
                        var e = Object(_t.a)(t.get().timeout, t),
                            n = e.abort,
                            r = e.pause;
                        return t.set(Eu.bind(null, n)).then(r)
                    });
                    Object(g.i)("Stopped longpoll")
                }).then(e.bind(null, t, n, r)))
            }(b, f.bind(null, "main"), p.bind(null, "main")), {
                onData: function(e) {
                    return c.on("data", e)
                },
                offData: function(e) {
                    return c.off("data", e)
                },
                abortWaiting: function() {
                    return b.set(ku)
                },
                stop: function(e) {
                    e.set(function(e) {
                        return Promise.resolve(extend({}, e, {
                            stopped: !0
                        }))
                    }).then(function() {
                        e.get().cancelToken()
                    })
                }.bind(null, b),
                pause: d.bind(null, "main"),
                resume: _.bind(null, "main"),
                reset: h.bind(null, "main"),
                push: function(e) {
                    return c.trigger("data", e)
                },
                isEnabled: function() {
                    return !b.get().pause && !b.get().stopped
                }
            }
        }
        var Mu = n("1+Fu");

        function Tu(e) {
            var t = e.get().tabbedPeers.map(function(t) {
                return e.get().tabs[t.peer] || e.get().mapped_index && e.get().mapped_index[t.peer]
            }).filter(function(e) {
                return e
            }).filter(function(e) {
                return !e.deletedDialog
            }).map(function(e) {
                return {
                    type: "peer",
                    peer: e.peerId
                }
            });
            return t.length > 0 && (t = [{
                type: "sep"
            }].concat(t)), t
        }

        function Iu(e, t) {
            return e.pipeReplace(Promise.resolve(Tu(t)))
        }

        function Su(e, t, n, r) {
            return {
                updateMenu: function(t) {
                    ! function(e, t) {
                        geByClass("_im_peer_tab", e).forEach(function(e) {
                            var n = q2ajx(attr(e, "href").split("?")[1]);
                            n.tab !== t.get().active_tab && attr(e, "href", Object(i.S)(t) + "?sel=" + n.sel + "&tab=" + t.get().active_tab)
                        })
                    }(e, t);
                    var r = gpeByClass("_im_right_menu", e);
                    Iu(n, t).then(function() {
                        var e = void 0;
                        (e = t.get().peer ? ge("ui_rmenu_peer_" + t.get().peer) : ge("ui_rmenu_" + t.get().active_tab)) && uiRightMenu.switchMenu(e, !0), uiRightMenu.hideProgress(r)
                    })
                },
                updateName: function(e, t) {
                    var n = ge("ui_rmenu_peer_" + e);
                    if (n) {
                        var r = geByClass1("_im_r_tx", n),
                            i = t.get().tabs[e].tab;
                        val(r, i)
                    }
                },
                updateCounter: function(e, t) {
                    var n = ge("ui_rmenu_peer_" + t);
                    if (n) {
                        var r = geByClass1("_im_r_ct", n),
                            i = e.get().tabs[t].unread;
                        val(r, i > 0 ? i : ""), toggleClass(n, "im-right-menu--unread", i > 0)
                    }
                },
                unmount: function() {
                    Object(s.c)(r), n.unmount()
                }
            }
        }

        function Du(e, t, n) {
            var o = S(e, m({
                    limit: 50,
                    offset: 0,
                    noScroll: !0,
                    elements: Tu(t)
                }), function() {
                    return {
                        idFn: function(e) {
                            return e.peer || "000"
                        },
                        renderFn: function(e, t) {
                            if ("sep" === t.type) return getTemplate("im_right_menu_sep", {});
                            var n = Object(i.S)(e) + "?sel=" + t.peer + "&tab=" + e.get().active_tab,
                                r = Object(i.R)(t.peer, e),
                                o = r.tab;
                            return o = getTemplate("im_right_menu_ct", {
                                name: o,
                                count: r.unread > 0 ? r.unread : ""
                            }), getTemplate("im_right_menu_tpl", {
                                href: n,
                                label: o,
                                peer: t.peer,
                                attrs: 'title="' + stripHTML(r.tab) + '"',
                                cls: r.unread > 0 ? "im-right-menu--unread" : ""
                            })
                        }.bind(null, t)
                    }
                }),
                a = function(e, t, n, i) {
                    var o = gpeByClass("_im_peer_tab", i),
                        a = intval(domData(o, "list-id")),
                        s = e.get().tabbedPeers.filter(function(e) {
                            return e.peer !== a
                        });
                    return e.set(r.Bc.bind(null, s, !0)).then(function() {
                        if (Iu(t, e), a === e.get().peer) e.get().longpoll.push([Object(c.ab)()]);
                        else if (0 !== e.get().peer) {
                            var n = gpeByClass("_im_right_menu", i);
                            uiRightMenu.hideSliding(n)
                        }
                    }), cancelEvent(n), !1
                }.bind(null, t, o),
                u = Object(s.a)({
                    handlers: function(n, r) {
                        r(e, "click", "_im_r_cl", a), r(e, "click", "_im_peer_tab", function(e, n) {
                            if (!checkEvent(e)) {
                                var r = intval(domData(n, "list-id"));
                                t.get().longpoll.push([Object(c.Ba)(r, !1, !0, !0)]), cancelEvent(e)
                            }
                        }), _.g.forEach(function(r) {
                            n(geByClass1("_ui_item_" + r, e.parentNode), "mousedown", function(e, t, n) {
                                1 === n.which && (e.get().peer && e.get().longpoll.push([Object(c.ab)()]), e.get().longpoll.push([Object(c.Ca)(t)]), cancelEvent(n))
                            }.bind(null, t, r))
                        })
                    }
                });
            return Su(e, 0, o, u)
        }
        var Bu = 5e3,
            Lu = 54e6,
            Au = 72e5;

        function Ru(e) {
            var t = setInterval(function(e) {
                var t = e.get().tabs,
                    n = e.get().peer,
                    o = Object.keys(t).filter(function(t) {
                        return Object(i.Oa)(e, t) && intval(t) !== n
                    }).map(function(e) {
                        return t[e]
                    });
                o.filter(function(e) {
                    return Date.now() - e.last_visited > Lu
                }).forEach(function(t) {
                    return e.set(r.u.bind(null, t.peerId))
                }), o.filter(function(t) {
                    return Object(i.Oa)(e, t.peerId) && "string" != typeof t.history && Date.now() - t.last_touched > Au
                }).forEach(function(t) {
                    return e.set(r.cc.bind(null, t.peerId))
                })
            }.bind(null, e), Bu);
            return {
                unmount: function() {
                    clearInterval(t)
                }
            }
        }

        function Nu(e) {
            return e.which || e.keyCode
        }

        function Uu(e, t, n, r) {
            var o = Nu(r);
            if (!layers.visible) {
                if (o >= 49 && o <= 57 && (r.ctrlKey || r.metaKey && browser.mac) && Object(i.Ia)(t)) return function(e, t) {
                    var n = e.get().tabbedPeers[t];
                    n && e.get().longpoll.push([Object(c.Ba)(n.peer, !1, !0, !0)])
                }(t, o - 49), cancelEvent(r);
                inArray(o, _.A) && e.signal(o, r)
            }
        }

        function Wu(e, t) {
            var n = browser.mozilla ? "keydown" : "keypress",
                o = m({
                    signalTimer: !1
                }),
                a = function(e, t, n) {
                    !n || inArray(Nu(n), _.z) || Object(r.Y)(e.get().peer, e.get()) || Object(i.Ma)() || n.ctrlKey || browser.mac && n.metaKey || n.key && 1 !== n.key.length || t.signal("printable", n)
                }.bind(null, e, t),
                c = Uu.bind(null, t, e, o),
                u = function(e, t, n) {
                    Nu(n) === _.e && e.signal(Nu(n), n)
                }.bind(null, t, o),
                l = Object(s.a)({
                    handlers: function(e, t) {
                        e(document, "keydown", c), e(document, "keyup", u), e(document, n, a)
                    }
                });
            return {
                unmount: function() {
                    Object(s.c)(l)
                }
            }
        }

        function Hu(e, t) {
            return -1 === (e ? e.indexOf(t) : 0) && (e.push(t), !0)
        }

        function Ku(e, t) {
            var n = e ? e.indexOf(t) : -1;
            return -1 !== n && (e.splice(n, 1), !0)
        }

        function qu(e, t, n) {
            if (Object(i.bb)(n.get(), e)) {
                var a = Object(o.t)(n, e);
                Hu(a.memberIds, t) && a.membersCount++, -1 === a.data.active.indexOf(t) && a.data.active.push(t), t === vk.id && (a.data.kicked = 0, a.data.closed = 0)
            }
            return n.set(r.Ha.bind(null, (s = {}, c = e, u = [t], c in s ? Object.defineProperty(s, c, {
                value: u,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : s[c] = u, s))).then(function(i) {
                if (t === vk.id && n.get().peer === e) return Promise.all([n.set(r.Q.bind(null, e)), n.set(r.La.bind(null, e))])
            });
            var s, c, u
        }

        function Fu(e, t, n, a, s, u) {
            var l = Object(o.t)(e, t);
            switch (n) {
                case c.t:
                case c.u:
                    return n === c.t ? Hu(l.adminIds, a) : Ku(l.adminIds, a), zu(e, t, s), !0;
                case c.x:
                    return l.data.flags = a, zu(e, t, s), !0;
                case c.A:
                    return delete l.pinHideId, cur.imDb.update(Pa.a, [l.peerId, void 0]), !1;
                case c.C:
                    return qu(t, a, e).then(function() {
                        return Vu(e, t, s, u), s.fixKeyboard()
                    }), !0;
                case c.E:
                case c.D:
                    return function(e, t, n, a, s) {
                        if (Object(i.bb)(a.get(), e)) {
                            var c = Object(o.t)(a, e);
                            Ku(c.memberIds, t) && c.membersCount--, c.data.active = c.data.active.filter(function(e) {
                                return e !== t
                            }), t === vk.id && (n ? c.data.kicked = 1 : c.data.closed = 1)
                        }
                        return t === vk.id && a.get().peer === e ? (s.cancelEditing(), a.set(r.nc.bind(null, e))) : Promise.resolve()
                    }(t, a, n === c.D, e, s).then(function() {
                        return Vu(e, t, s, u)
                    }), e.get().id !== a && (Object(o.j)(e, t) || {}).author_id !== a || e.set(r.z.bind(null, t)).then(function() {
                        return s.fixKeyboard()
                    }), !0;
                case c.w:
                    return e.set(r.Fa.bind(null, t)).then(function() {
                        return s.updateBanner(e)
                    }), !0;
                case c.y:
                case c.z:
                    return !0;
                default:
                    return !1
            }
        }

        function zu(e, t, n) {
            e.get().peer === t && (Object(r.Ob)(e.get()), n.updateActions(e))
        }

        function Vu(e, t, n, i) {
            e.get().peer === t && (Object(r.Ob)(e.get()), n.updateChat(e, t), i.updateDialog(t, e))
        }
        var Qu = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        i = !1,
                        o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        i = !0, o = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (i) throw o
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

        function Gu(e, t, n) {
            return t in e ? Object.defineProperty(e, t, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = n, e
        }
        var Xu = 30,
            Yu = 400,
            Ju = 250,
            Zu = 32,
            $u = 5 * Zu + 24 + 52,
            el = 3 * Zu + 24,
            tl = 10,
            nl = "._im_aside_notice";

        function rl(e, t) {
            "spam" === t ? Object(i.Wb)(e, vc, {}) : "fav" === t && Object(i.Ob)(e, {}, Js, {})
        }

        function il(e, t) {
            if (e.get().gid) {
                var n = t.parentNode,
                    r = geByClass("_im_right_menu_counter", n),
                    i = e.get().dialog_tab_cts;
                r.forEach(function(e) {
                    var t = domData(e, "tab");
                    val(e, i[t] || "")
                })
            }
        }

        function ol(e, t, n, o, a) {
            e.forEach(function(e) {
                switch (e.kludges.source_act) {
                    case i.d:
                    case i.e:
                        ! function(e, t, n, i) {
                            t.set(r.pc.bind(null, e)).then(function() {
                                var r = e.kludges.source_act;
                                n.updateDialog(e.peerId, t), i.updateChatPhoto(e, r, t)
                            })
                        }(e, t, n, o)
                }
            })
        }

        function al(e, t) {
            var n = e.get().longpoll.push.bind(null, [c.ab()]);
            cancelStackPush("im_peer", function r() {
                var i = e.get().selectedMessages;
                i && i.length ? (e.setState({
                    selectedMessages: []
                }).then(function() {
                    t.changedMessageSelection(e), t.cleanSelection(i)
                }), setTimeout(function() {
                    return cancelStackPush("im_peer", r)
                }, 0)) : n()
            })
        }

        function sl(e) {
            var t = e.attaches.filter(function(e) {
                return "sticker" !== e.type
            });
            return Object(a.l)(e) || 0 === t.length
        }

        function cl(e, t, n) {
            addClass(n, "im-page_history-show"), t.loadingPeer(e)
        }

        function ul(e, t) {
            var n = function(e, t) {
                var n = document.querySelector(nl),
                    r = Object(i.Ja)(e) ? $u : el,
                    o = n ? n.offsetHeight : 0;
                return r += tl, r += o, Math.floor((t.offsetHeight - r) / Zu)
            }(e, t);
            if (e.get().tabbedPeers.length > n) {
                var o = e.get().tabbedPeers.filter(function(t) {
                        var n = t.peer;
                        return intval(n) !== e.get().peer
                    }).map(function(t) {
                        var n = t.peer;
                        return e.get().tabs[n]
                    }).sort(function(e, t) {
                        return t.last_touched - e.last_touched
                    }),
                    a = [];
                0 !== e.get().peer && a.push(e.get().tabs[e.get().peer]);
                var s = a.concat(o).slice(n).map(function(e) {
                        return e.peerId
                    }),
                    c = e.get().tabbedPeers.filter(function(e) {
                        return !inArray(e.peer, s)
                    });
                return e.set(r.Bc.bind(null, c, !0))
            }
            return Promise.resolve(e)
        }

        function ll() {
            for (var e = curBox(); e;) e.hide(), e = curBox()
        }

        function dl(e, t, n, a, s, c, u, l, d) {
            e.get().audio_msg.isRecording && e.set(r.l).then(function() {
                a.cancelRecording()
            }), AudioMessagePlayer.detachPlayer(), Object(o.x)(e) && a.cancelEditing(), Object(o.L)(e) && t.cancelSearch && (s.clearSearch(e), n.restoreDialogs(e), d().toggleSettingsButton(e, !1)), _l(e, l, d), cl(e, a, c);
            var _ = e.get().peer;
            Object(r.yc)(e.get()), Object(r.Fc)(), Object(i.Oa)(e, t.peerId) && (t.msgid && !Object(o.m)(e, t.peerId, t.msgid) || !t.msgid && !Object(o.m)(e, t.peerId, Object(o.t)(e, t.peerId).lastmsg) || Object(o.t)(e, t.peerId).skipped) && e.mutate(function(e) {
                return Object(o.O)(e, t.peerId)
            });
            var p = e.set(r.p.bind(null, t.peerId, t.msgid, t.entryPoint)).then(function(e) {
                var n = e.get(),
                    i = r.Sa.bind(null, t.peerId, !1, t.msgid, !1, n);
                return n.tabs[t.peerId] ? Promise.resolve(n) : e.set(i)
            }).then(function() {
                n.selectPeer(t.msgid, e),
                    function(e, t) {
                        Object(i.Xa)(e) && (cancelStackFilter("forward"), e.set(r.K.bind(null, e.get().pendingForward, Object(o.u)(Object(o.t)(e, t)), !1)))
                    }(e, e.get().peer), window.tooltips && tooltips.hideAll(), ll(), a.preparePeer(e), al(e, a), Object(i.Ia)(e) && (n.deactivate(), ul(e, c).then(function() {
                        return u.updateMenu(e)
                    }))
            });
            return (p = t.msgid ? p.then(function() {
                return e.set(r.Kb.bind(null, t.peerId === _, _))
            }) : p.then(function() {
                return e.set(r.Jb.bind(null, !0))
            })).then(function() {
                if (e.get().peer === t.peerId) {
                    if (t.forward) {
                        var n = e.get().tabs[e.get().peer];
                        !n.scrollBottom && n.unread && e.set(r.fb.bind(null, e.get().peer))
                    }
                    Object(i.Ia)(e) && u.updateMenu(e), a.changePeer(e, !1), a.updateTyping(t.peerId, e), Object(r.yc)(e.get())
                }
            }).catch(function(e) {
                return Object(f.a)("applyNewPeer", e)
            })
        }

        function _l(e, t, n) {
            t && e.get().shown && (t.hide(e), n().createCanceled(e))
        }

        function fl(e, t, n) {
            Object(o.L)(e) && (t.clearSearch(e), n.restoreDialogs(e))
        }

        function pl(e, t, n, o, a, s, c) {
            Object(i.Ia)(e) && (a.saveScroll(e), s.saveScroll(e)), o.rotateCross(e), addClass(c, "im-page_creating"), e.setState({
                isCreating: !0
            }), n && n.show(e, t), Object(i.Ia)(e) && (setStyle(c, {
                height: hl(c, e).page
            }), setTimeout(function() {
                addClass(c, "im-page_cropped")
            }, 200)), Object(r.hc)(!0)
        }

        function ml(e, t, n, o, a) {
            o.activityType || (o.activityType = a);
            var s = function(e) {
                return function(e, t, n, r) {
                    Object(i.bb)(e.get(), r) && (t.updateTyping(r, e), n.updateTyping(r, e))
                }(e, t, n, o.peerId)
            };
            Object(i.ab)(o.peerId, e.get().gid) || (e.set(r.Pb.bind(null, o, a)).then(s), e.set(r.Gc.bind(null, o, a)).then(s))
        }

        function gl(e, t, n, u, l, d, f, p, m, g, h, b, v, y, O, j, w, E, k, C, x) {
            return {
                changePeer: function(e, n) {
                    t.selectPeer(e, n)
                },
                cancelSearch: function(e) {
                    fl(e, u, t)
                },
                loadingPeer: function(e) {
                    cl(e, n, l)
                },
                restoreDialogs: function(e, n, r) {
                    t.restoreDialogs(e, n, r)
                },
                toggleSettingsButton: function(e, t) {
                    h.toggleButton(e, t)
                },
                focusSearch: function(e) {
                    u.focusInput(e)
                },
                appendSearch: function(e, n, r, i) {
                    t.appendSearch(e, n, r, i)
                },
                appendDialogs: function(e, n) {
                    t.appendDialogs(e, n)
                },
                showCreation: function(e, r) {
                    pl(e, r, g, u, t, n, l)
                },
                updateState: function(e, r) {
                    t.updateDialog(e, r), r.get().peer === e && n.updateChat(r, e)
                },
                appendFastDialogs: function(e, n) {
                    t.appendFastDialogs(e, n, !0)
                },
                createCanceled: function(e, r) {
                    u.createCanceled(e, r), Object(i.Ia)(e) ? (setStyle(l, {
                        height: "auto"
                    }), removeClass(l, "im-page_cropped"), setTimeout(function() {
                        return u.focusInput(e)
                    }, 0), 0 === e.get().peer ? t.restoreScroll(e) : n.restoreScroll(e, e.get().peer)) : setTimeout(function() {
                        0 === e.get().peer ? u.focusInput(e) : n.focustTxt(e)
                    }, 0), removeClass(l, "im-page_creating"), e.setState({
                        isCreating: !1
                    })
                },
                updateMenu: function(e) {
                    j && j.updateMenu(e)
                },
                goToHistoryEnd: function() {
                    n.goToEnd()
                },
                updateDialog: function(e, n) {
                    t.updateDialog(e, n)
                },
                focusTxt: function(e) {
                    n.focustTxt(e)
                },
                resync: function(e) {
                    Object(o.L)(e) && u.clearSearch(e), t.restoreDialogs(e, !0, !0), t.focusOnSelected(e), g && g.hide(e), Object(i.Ja)(e) && il(e, l), Object(i.Ia)(e) && e.get().tabbedPeers.forEach(function(t) {
                        var n = t.peer;
                        j.updateCounter(e, n), j.updateName(n, e)
                    }), n.cleanSelection(e.get().selectedMessages || []), n.cancelSearch(e, !0), Object(i.Ya)(e.get().peer) || n.changePeer(e, !1);
                    var r = e.get().gid ? "l_mgid" + e.get().gid : "msg";
                    handlePageCount(r, e.get().unread_cnt)
                },
                toggleSettingsLoader: function(e, t) {
                    h.toggleLoader(e, t)
                },
                onUserActions: function(e, t) {
                    if (!Object(r.Y)(e.get().peer, e.get())) {
                        var a = e.get(),
                            s = a.peer;
                        if (Object(i.Oa)(a, s))
                            if (!d.is_idle)
                                if (Object(o.b)(e.get().peer, e.get()) > 0) !a.tabs[s].skipped && n.isNewMessagesVisible(e) && (n.hideGoToEnd(!0), e.set(r.fb.bind(null, s)))
                    }
                },
                removeSelection: function(e) {
                    t.removeSelection(e), u.focusInput(e)
                },
                route: function(e, o, a, s) {
                    if (void 0 !== e[0]) return !0;
                    e.box && (e = {
                        box: e.box
                    });
                    var d = !1;
                    return !(!e.invite_chat_id || !a.invite_hash) || (s && s.params && "left_nav" === s.params._ref && void 0 === e.sel && t.scrollUp(!0, !0), Object.keys(e).sort().forEach(function(e) {
                        switch (e) {
                            case "sel":
                                a.q || (d = !0);
                                var f = a.sel ? Object(i.hc)(a.sel) : 0,
                                    p = s.back;
                                0 === f ? b.get().longpoll.push([c.ab(!1, p)]) : f !== b.get().peer && b.get().longpoll.push([c.Ba(f, a.msgid || !1)]);
                                break;
                            case "invite_chat_id":
                            case "invite_hash":
                                ! function(e) {
                                    e.set(r.Da)
                                }(b);
                                break;
                            case "tab":
                                _l(b, g, m), d = !0;
                                var h = a.tab || _.h;
                                b.get().longpoll.push([c.Ca(h)]);
                                break;
                            case "act":
                                a.act && "create" === a.act ? pl(b, [], g, u, t, n, l) : function(e, t, n, r) {
                                    n && n.hide(e, t)
                                }(b, [], g);
                                break;
                            case "st":
                                a.st && a.sel ? (curBox() && curBox().hide(), b.mutate(r.Vb.bind(null, unescape(a.st), a.sel)), n.startSearch(b)) : (b.mutate(r.m.bind(null, o.sel)), n.cancelSearch(b, !0));
                                break;
                            case "q":
                                a.q ? (curBox() && curBox().hide(), u.setSearch(b, a.q, !0)) : u.clearSearch(b);
                                break;
                            case "box":
                                rl(b, a.box)
                        }
                    }), Object(i.Ia)(b) && void 0 === e.sel && j.updateMenu(b), d && fl(b, u, t), !1)
                },
                updateDialogFilters: function(e) {
                    Object(o.L)(e) || t.restoreDialogs(e), h.updateFilter(e)
                },
                removePeer: function(e, n) {
                    t.removeDialog(e, n), t.saveScroll(e), e.get().peer === n && e.get().longpoll.push([c.ab()]), Object(i.Ia)(e) && j.updateMenu(e)
                },
                newMessage: function(e) {
                    Object(i.Ia)(e) || t.scrollUp(!0)
                },
                onEvents: function(e, s) {
                    var d = function(e) {
                            for (var t = !1, n = e.length - 1; n >= 0; n--) e[n].type !== c.X || t ? e[n].type === c.X && e.splice(n, 1) : t = !0;
                            return e
                        }(s.filter(function(e) {
                            return e.type !== c.a || !(e.flags & c.o)
                        })),
                        b = s.filter(a.l),
                        y = s.filter(function(e) {
                            return e.type === c.a
                        });
                    ol(b, e, t, n);
                    var O = Object(r.s)(b, y, e),
                        w = Promise.resolve();
                    O.shouldLoad && (w = e.set(r.Ra.bind(null, O, f))), w.then(function() {
                        d.forEach(function(s) {
                            switch (s.type) {
                                case c.a:
                                    var d = Object(o.t)(e, s.peerId),
                                        f = !d || !d.msgs || 0 == d.msgs.length,
                                        b = Object(i.La)(s, e.get()),
                                        y = Object(o.A)(e, s.peerId);
                                    if (!e.get().isIncomingMessageRequestsAllowed && Object(o.Q)(d)) break;
                                    var O = null;
                                    if (s.kludges.keyboard) {
                                        var w = Object.assign(s.kludges.keyboard, {
                                            author_id: s.userId
                                        });
                                        O = e.set(r.Wb.bind(null, s.peerId, w))
                                    } else {
                                        var E = Object(o.j)(e, s.peerId);
                                        E && E.one_time && E.author_id !== Object(a.a)(e, s) && (O = e.set(r.z.bind(null, s.peerId)))
                                    }
                                    if (s.peerId === Object(o.o)(e) && O && O.then(function() {
                                            return n.fixKeyboard()
                                        }), 0 === b) e.set(r.h.bind(null, s)), ul(e, l),
                                        function(e, t) {
                                            var n = e.get().tabs[t.peerId],
                                                i = e.get().active_tab;
                                            return i === _.h || Object(r.H)(i)(n)
                                        }(e, s) && (s.flags & c.m || e.set(r.rc.bind(null, s.peerId, !0)), function(e, t) {
                                            var n = t.flags & c.m,
                                                r = inArray(t.peerId, e.get().mutedPeers),
                                                o = t.flags & c.j,
                                                a = e.get().gid;
                                            if (!n && !r && !o) {
                                                var s = function(e, t) {
                                                        return t < 2e9 && e && !e.match(/^\s*(Re(\(\d*\))?\:)?\s*\.\.\.\s*$/)
                                                    }(t.subject, t.peerId) || "",
                                                    u = (s ? s + " " : "") + t.text || "",
                                                    l = t.userId,
                                                    d = t.peerId,
                                                    _ = void 0,
                                                    f = void 0,
                                                    p = e.get().tabs[d];
                                                if (t.kludges && t.kludges.source_act && (u = stripHTML(Object(i.Bb)(e, t, p, !1))), (!e.get().notify_msg && !Object(i.Ha)(d) || a && !e.get().mute) && window.Notifier && Notifier.playSound({
                                                        author_id: d
                                                    }), !Object(i.Ha)(d)) return;
                                                u = trim(replaceEntities(stripHTML(u.replace(/<br>/g, "\n").replace(/<\*>.*$/, "")))), u = Object(cu.f)(u, function(e, t, n, r, i) {
                                                    return i
                                                }), Object(i.Ha)(d) ? (_ = Object(B.c)(e, l).name, p.tab && (_ += " » " + p.tab), f = Object(B.c)(e, l).photo) : (_ = p.tab, f = p.photo);
                                                var m = t.attaches[0];
                                                if (m && "mail" === m.type) u += "\n[" + getLang("mail_added_msgs") + "]";
                                                else if (m) {
                                                    var g = "doc" === m.type && "graffiti" === m.kind ? "graffiti" : m.type;
                                                    u += "\n[" + getLang("mail_added_" + g) + "]"
                                                }
                                                _ = trim(replaceEntities(stripHTML((_ || "").replace("&nbsp;", " ")))), window.Notifier && Notifier.proxyIm({
                                                    id: t.messageId,
                                                    text: u,
                                                    author_id: d,
                                                    title: _,
                                                    author_photo: f
                                                })
                                            }
                                        }(e, s), t.updateTyping(s.peerId, e), Object(o.L)(e) ? t.updateDialog(s.peerId, e) : t.promoteDialog(e, s.peerId)), !1 === Object(o.A)(e, s.peerId) && !0 === y && n.updateActions(e), Object(i.Ia)(e) && (j.updateCounter(e, s.peerId), j.updateMenu(e)), n.updateTyping(s.peerId, e), n.addMessage(e, s), Object(i.Ia)(e) || h.updateFilter(e), sl(s) || !Object(i.Oa)(e, s.peerId) || s.local || e.set(r.Pa.bind(null, s)).then(function(e) {
                                            n.replaceAttachmentPlaceholders(e, s), Object(r.Fc)()
                                        }), Object(ye.m)(e, s, "send", "opt_to_lp");
                                    else 2 === b ? (sl(s) || e.set(r.Pa.bind(null, s)).then(function(e) {
                                        n.replaceAttachmentPlaceholders(e, s)
                                    }), e.set(r.pb.bind(null, s)), n.replaceMessageAttrs(s, e), t.updateDialog(s.peerId, e), s.randomId && Object(ye.l)(e, s, "send", "opt_to_lp")) : Object(o.L)(e) || t.promoteDialog(e, s.peerId);
                                    d && f && d.peerId === Object(o.o)(e) && C();
                                    break;
                                case c.g:
                                case c.N:
                                    e.set(r.F.bind(null, s)).then(function(e) {
                                        t.updateDialog(s.peerId, e), n.updateTyping(s.peerId, e), n.editMessage(e, s), sl(s) || !Object(i.Oa)(e, s.peerId) || s.local || e.set(r.Pa.bind(null, s)).then(function(e) {
                                            n.replaceAttachmentPlaceholders(e, s)
                                        })
                                    });
                                    break;
                                case c.H:
                                    e.set(r.Wa.bind(null, s)).then(function(e) {
                                        t.updateCounter(e, s.peerId), n.updateGoToEnd(e, !0), Object(i.Ia)(e) && j.updateCounter(e, s.peerId), Object(o.L)(e) || t.restoreDialogs(e), h.updateFilter(e)
                                    });
                                    break;
                                case c.I:
                                    e.set(r.Xa.bind(null, s)).then(function(e) {
                                        t.updateCounter(e, s.peerId), n.markMessagesAsRead(e, s)
                                    });
                                    break;
                                case c.X:
                                    e.set(r.Dc.bind(null, s.count)).then(function() {
                                        var t = e.get().gid ? "l_mgid" + e.get().gid : "msg";
                                        handlePageCount(t, s.count), h.updateFilter(e), Object(i.Ia)(e) && il(e, l)
                                    });
                                    break;
                                case c.s:
                                case c.r:
                                    var k = s.type === c.s;
                                    e.set(r.zc.bind(null, s.userId, !!k && s.platform, s.lastSeenTs)).then(function(e) {
                                        Object(i.bb)(e.get(), s.userId) && (t.updateOnline(s.userId, e), n.updateOnline(s.userId, e))
                                    });
                                    break;
                                case c.U:
                                case c.M:
                                case c.Q:
                                    if (!(s.flags & c.j || s.flags & c.n) || s.type !== c.U || Object(i.Fa)(e, s.peerId, s.messageId) || e.get().blockedFlagUpdates[s.peerId] || p(s), s.flags === c.l) {
                                        var x = s.type === c.U;
                                        e.set(r.xc.bind(null, x ? 1 : -1, s.messageId)).then(function() {
                                            Object(i.Ia)(e) || u.updateImportantCnt(e)
                                        }), e.set(r.sc.bind(null, [s.messageId], s.peerId, x)).then(function() {
                                            n.markImportant(s.messageId, x, e)
                                        })
                                    }
                                    break;
                                case c.J:
                                    ml(e, n, t, s, r.c);
                                    break;
                                case c.W:
                                    ml(e, n, t, s, r.d);
                                    break;
                                case c.G:
                                    ! function(e, t, n, i) {
                                        e.set(r.Yb.bind(null, n, i)).then(t().updateState.bind(null, n))
                                    }(e, m, s.peerId, 0 !== s.disabledUntil);
                                    break;
                                case c.S:
                                    e.get().longpoll.pause(), e.set(r.yb).then(m().resync).then(function() {
                                        return e.get().longpoll.resume()
                                    });
                                    break;
                                case c.V:
                                    v.transition(s.state);
                                    break;
                                case c.R:
                                    if (s.removeActivePeer) {
                                        var P = e.get().tabbedPeers.filter(function(t) {
                                            var n = t.peer,
                                                r = t.type;
                                            return n !== e.get().peer && "perm" === r
                                        });
                                        e.setState({
                                            tabbedPeers: P
                                        })
                                    }! function(e, t, n, a) {
                                        e.set(r.l).then(function() {
                                            n.cancelRecording()
                                        }), AudioMessagePlayer.detachPlayer(), t.removeSelection(e), removeClass(a, "im-page_history-show"), n.stopLoading(), Object(o.x)(e) && n.cancelEditing();
                                        var s = e.get().peer;
                                        e.set(r.p.bind(null, 0, !1, !1)).then(function() {
                                            window.tooltips && window.tooltips.hideAll(), ll(), Object(i.Ia)(e) && t.activate(), n.changePeer(e), Object(i.Ia)(e) && t.restoreScroll(e), setTimeout(function() {
                                                e.get().longpoll.push([c.eb("search")])
                                            }, 13), Object(i.Ra)(e) && Object(i.Wa)(s, e) && e.set(r.hb.bind(null, s))
                                        })
                                    }(e, t, n, l), s.cancelSearch && fl(e, u, t), Object(i.Ia)(e) && j.updateMenu(e), u.focusInput(e);
                                    break;
                                case c.c:
                                    Object(i.C)(s.tab, e, m, r.o).then(function(e) {
                                        h.updateFilter(e)
                                    });
                                    break;
                                case c.P:
                                case c.T:
                                case c.L:
                                    if (s.mask === c.p) break;
                                    e.set(r.uc.bind(null, s.peerId, s.mask, s.type, s.local)).then(function(e) {
                                        Object(o.L)(e) || s.type === c.P && s.mask === c.q || s.type === c.L || t.restoreDialogs(e), t.updateDialog(s.peerId, e), il(e, l), e.get().peer === s.peerId && n.changedMessageSelection(e)
                                    });
                                    break;
                                case c.f:
                                    e.set(r.B.bind(null, s.peerId, Promise.resolve([]))).then(function() {
                                        m().removePeer(e, s.peerId), m().updateDialogFilters(e)
                                    });
                                    break;
                                case c.b:
                                    dl(e, s, t, n, u, l, j, g, m);
                                    break;
                                case c.F:
                                    var M = Gu({}, s.peerId, s),
                                        T = Object(i.Va)(s.peerId, e);
                                    e.set(r.oc.bind(null, M)).then(function() {
                                        t.updateDialog(s.peerId, e);
                                        var r = Object(i.Va)(s.peerId, e);
                                        Object(i.Oa)(e.get(), s.peerId) && T !== r && n.updateChat(e, s.peerId)
                                    });
                                    break;
                                case c.i:
                                    e.set(r.Xb.bind(null, s.peer, s.message)).then(function() {
                                        n.setMessageErrored(s.peer, s.message, s.error, e), t.setDialogFailed(s.peer, s.message.messageId, e)
                                    });
                                    break;
                                case c.O:
                                    var I = s.message.messageId;
                                    e.set(r.qb.bind(null, s.peerId, I, s.message)).then(function() {
                                        n.resendMessage(s.peerId, I), t.promoteDialog(e, s.peerId)
                                    });
                                    break;
                                case c.e:
                                    if (Object(i.bb)(e.get(), s.peerId)) Fu(e, s.peerId, s.updateType, s.updateArg, n, t) || m().reloadChatInfo(s.peerId)
                            }
                        })
                    })
                },
                updateHistory: function(e) {
                    return n.updateHistory(e)
                },
                reloadChatInfo: function(e) {
                    Object(i.bb)(b.get(), e) && b.set(r.Ga.bind(null, e)).then(function() {
                        return function(e, t, n, o, a) {
                            o.updateChatTopic(t, e), Object(i.Ia)(e) && a.updateName(t, e), e.get().peer == t && (Object(r.Ob)(e.get()), o.updateActions(e))
                        }(b, e, 0, n, j)
                    })
                },
                cancelRecording: function() {
                    return b.set(r.l).then(function() {
                        return n.cancelRecording()
                    })
                },
                fixHeight: function() {
                    C()
                },
                unmount: function() {
                    Object(s.c)(e), clearInterval(b.get().update_title_to), d.stop(), x(), t.unmount();
                    var o = window.devicePixelRatio >= 2 ? "_2x" : "";
                    setFavIcon("/images/icons/favicons/fav_logo" + o + ".ico"), n.unmount(), u.unmount(), cancelStackFilter("im_peer"), h.unmount(), g && g.unmount(), j && j.unmount(), w && w(), y && y(), Object(i.Ra)(b) && b.get().peer && b.set(r.hb.bind(null, b.get().peer)), E.unmount(), j && j.unmount(), k.unmount(), clearInterval(O), cur.imDb.unmount(), cur.imDb = !1
                }
            }
        }

        function hl(e, t) {
            var n = ge("page_header"),
                r = geByClass1("_im_page_history", e),
                o = window.clientHeight() - n.offsetHeight - Xu - 2,
                a = Object(i.Ia)(t) ? Ju : Yu,
                s = {
                    page: Math.max(o, a)
                };
            if (Object(i.Ia)(t)) {
                var c = Object(i.U)();
                c = c > 0 ? Math.min(c - n.offsetHeight - Xu - 2, o) : o;
                var u = hasClass(r, "im-page--history_empty-hist") ? c : o;
                s.history = Math.max(c, a), s.chat = Math.max(u, a)
            }
            return s
        }

        function bl(e, t, n, o, a) {
            var s = !(arguments.length > 5 && void 0 !== arguments[5]) || arguments[5],
                c = arguments.length > 6 && void 0 !== arguments[6] && arguments[6];
            if (!isFullScreen()) {
                var u = hl(e, t);
                if (setStyle(e, {
                        minHeight: u.page
                    }), Object(i.Ia)(t) && (void 0 === t.get().chatResizeInitialized && t.set(r.U), setStyle(e, {
                        height: t.get().isCreating ? u.page : "auto"
                    }), setStyle(geByClass1("_im_page_dialogs", e), {
                        minHeight: u.page,
                        position: "static",
                        top: 0
                    }), setStyle(geByClass1("_im_page_history", e), {
                        minHeight: u.history,
                        position: "relative",
                        top: 0
                    }), setStyle(geByClass1("_im_chat_body_abs", e), {
                        minHeight: u.chat,
                        height: u.chat,
                        position: "relative",
                        top: 0
                    })), browser.safari && c && "function" == typeof c && c(), o && o.updateScroll(), a && a.updateScroll(), n) {
                    var l = n.updateScroll();
                    n.scrollFix(t, t.get().peer, l)
                }
                s && setTimeout(function() {
                    return bl(e, t, n, o, a, !1)
                }, 100)
            }
        }

        function vl() {
            ! function(e) {
                var t = "safari-repaint";
                e.forEach(function(e) {
                    hasClass(e, t) && removeClass(e, t), addClass(e, t)
                }), setTimeout(function() {
                    e.forEach(function(e) {
                        removeClass(e, t)
                    })
                }, 100)
            }([geByClass1("_im_dialog_actions"), geByClass1("_im_chat_input_w"), ge("side_bar"), geByClass1("_im_right_menu"), geByClass1("_im_dialogs_settings"), geByClass1("_im_dialogs_search")])
        }

        function yl(e, t) {
            var n = t.get(),
                a = void 0,
                u = window.devicePixelRatio >= 2 ? "_2x" : "";
            setFavIcon("/images/icons/favicons/fav_im" + u + ".ico"), bl(e, t, !1, !1, !1, !0), show(e), Object(ye.c)();
            var l = Object(s.b)(gl),
                d = l.callMutations,
                _ = l.bindMutations,
                p = n.useFcLongpoll && vk.lpConfig.enabled && Notifier.getLpInstance && Notifier.getLpInstance(),
                m = p ? Notifier.getLpInstance() : t.get().gid ? function(e) {
                    Object(f.b)("im_start_longpoll_group", {}, !1);
                    var t = Object(fu.a)(e.ts, function(e) {
                            r.trigger("data", e)
                        }),
                        n = Object(_u.a)(e, t.onLp),
                        r = new window.EventEmitter;
                    return {
                        onData: function(e) {
                            return r.on("data", e)
                        },
                        offData: function(e) {
                            return r.off("data", e)
                        },
                        push: function(e) {
                            return r.trigger("data", e)
                        },
                        pause: t.pause.bind(t),
                        resume: t.resume.bind(t),
                        abortWaiting: n.abortWaiting.bind(n),
                        onLp: t.onLp.bind(t),
                        stop: n.stopConnection.bind(n),
                        isEnabled: function() {
                            return !(!n || n.isStopped())
                        }
                    }
                }(n.lpConfig) : Pu(n);

            function b() {
                for (var e = arguments.length, n = Array(e), r = 0; r < e; r++) n[r] = arguments[r];
                d().onEvents(t, n)
            }
            m.onData(b), p && Object(f.b)("im_use_fc_longpoll", {}, !1);
            var v = geByClass1("_im_dialogs_search", e),
                y = geByClass1("_im_dialogs_settings", e),
                O = ve(geByClass1("_im_page_dcontent", e), t, d),
                j = _c(v, t, d),
                w = kc(y, t, d),
                E = Ru(t);
            cur.imDb = Object(Pa.c)(t.get().gid ? -t.get().gid : vk.id), t.set(r.bb.bind(null, cur.imDb)), Object(i.Ia)(t) && w.updateSettings(t);
            var k = void 0,
                C = void 0;
            Object(i.Ia)(t) && (k = Du(geByClass1("_im_ui_peers_list", e.parentNode), t), C = function(e, t, n, r) {
                if (browser.mobile) return !1;
                var i = [t, n, geByClass1("_im_chat_input_w", r), geByClass1("_im_dialog_actions", r)],
                    o = null,
                    a = hasClass(e, "im-page--header_static"),
                    s = ge("im-group-online-disabled-notice");

                function c() {
                    var t = Object(h.b)("scrollLeft"),
                        n = hasClass(e, "im-page--header_static"),
                        r = [];
                    o !== t ? r = i.slice().concat([e]) : n !== a && (r = [e]), o = t, a = n, r.length > 0 && r.forEach(function(r) {
                        var i = e === r && n ? 0 : -t;
                        setStyle(r, Gu({}, cssTransformProp, 0 === i ? "unset" : "translateX(" + i + "px)"))
                    })
                }
                return s && i.push(s), i = i.concat(geByClass("_im_aside_notice"), geByClass("_im_aside_promo_block")), addEvent(window, "scroll", c), c(),
                    function() {
                        removeEvent(window, "scroll", c)
                    }
            }(v, y, geByClass1("_im_right_menu", e.parentNode), e));
            Object(i.Ia)(t) && n.peer && O.deactivate(), n.gid || (a = su(geByClass1("_im_dialogs_creation", e), t, d));
            var x = qs(geByClass1("_im_page_history", e), t, O, k, d),
                P = n.isCreating,
                M = P ? "create" : 0 === n.peer ? "search" : "default";
            P && a.show(t, []);
            var T = lu(t, M, O, x, j, a),
                I = Wu(t, T);
            x.updateScroll();
            var S = function(e, t, n, o) {
                var a = t.get();
                Object(i.Ya)(a.peer) || e().onUserActions(t, o), a.update_old_title && t.set(r.rc.bind(null, !1, !1))
            }.bind(null, d, t, T);
            Object(i.Ya)(n.peer) || setTimeout(function() {
                return al(t, x)
            }, 10);
            var D = new IdleManager({
                    id: "im",
                    element: document,
                    focusElement: window,
                    triggerEvents: "mouseover mousedown keypress"
                }),
                B = debounce(vl, 300),
                L = bl.bind(null, e, t, x, O, a, !1, B);
            t.setState({
                longpoll: m
            }), t.set(r.Ub.bind(null, [])), D.on("unidle", function() {
                m.abortWaiting(), S()
            }), D.start(), nav.objLoc.box && (rl(t, nav.objLoc.box), Object(xa.b)({
                box: null
            }));
            var A = function(e) {
                    var t = e.get();
                    return Object(i.Ra)(e) ? Object(Mu.a)(t.mutex_key, function(e) {
                        t.longpoll.push([c.Na(e)])
                    }, function(e, n) {
                        return Object(r.O)(t.gid).then(function(e) {
                            return Qu(e, 1)[0]
                        })
                    }).stop : null
                }(t),
                R = void 0;
            Object(i.Ra)(t) && (R = setInterval(i.z.bind(null, t, n.longpoll), 2e3)), t.get().invitation && Object(i.Qb)(t, t.get().invitation, r.Da);
            var N = Object(g.o)(function(e, t, n, i, a) {
                    var s = a.reduce(function(e, t) {
                        return e[t.peerId] || (e[t.peerId] = []), e[t.peerId].push(t.messageId), e
                    }, {});
                    Object.keys(s).forEach(function(a) {
                        var c = s[a];
                        e.set(r.mb.bind(null, c, a)).then(function() {
                            return e.set(r.nb.bind(null, c, a))
                        }).then(function() {
                            return t.removeMessages(c, +a, e)
                        }).then(function() {
                            var s = Object(o.t)(e, a);
                            s && c.some(function(e) {
                                return e >= s.lastmsg
                            }) && Object(r.Ea)(e, +a).then(function() {
                                n.promoteDialog(e, a), i && i.updateCounter(e, a), t.updateGoToEnd(e, !0)
                            })
                        })
                    })
                }.bind(null, t, x, O, k), 200),
                U = i.Ca.bind(null, t),
                W = i.Aa.bind(null, t);
            return _(Object(s.a)({
                handlers: function(t, n) {
                    t(document, "mousemove mousedown keypress", S), t(window, "resize", L), n(e, "click", i.o, U), n(gpeByClass("_im-page-wrap", e), "click", i.m, W), n(gpeByClass("_im-page-wrap", e), "click", i.n, i.Ba), n(gpeByClass("_im-page-wrap", e), "click", i.p, i.Da), browser.safari && t(document, "visibilitychange", vl)
                }
            }), O, x, j, e, D, m, N, d, a, w, t, T, A, R, k, C, E, I, L, function() {
                p ? m.offData(b) : m.stop()
            })
        }
        var Ol = window,
            jl = Ol.nav,
            wl = Ol.setStyle,
            El = Ol.getLang,
            kl = "._im_sick_reload",
            Cl = "._im_sick_timer",
            xl = 5e3,
            Pl = 6e5,
            Ml = 30,
            Tl = 400,
            Il = void 0,
            Sl = void 0;

        function Dl(e) {
            var t = ge("page_header"),
                n = window.clientHeight() - t.offsetHeight - Ml - 2,
                r = Tl;
            wl(e, {
                height: Math.max(n, r)
            })
        }

        function Bl(e) {
            var t = Object(i.N)(Math.floor(Math.max(e, 0) / 1e3), !0);
            return t ? El("mail_sick_timer").replace(/{timer}/gi, t) : ""
        }

        function Ll() {
            jl.reload({
                force: !0
            })
        }

        function Al(e) {
            return {
                unmount: function() {
                    clearInterval(Sl), clearTimeout(Il), Object(s.c)(e)
                }
            }
        }

        function Rl(e, t, n) {
            Dl(e);
            var r, i, o = (0, Object(s.b)(Al).bindMutations)(Object(s.a)({
                    handlers: function(t, n) {
                        t(e.querySelector(kl), "click", Ll), t(window, "resize", Dl.bind(null, e))
                    }
                })),
                a = (r = localStorage.getItem("im_sick_timer"), i = r ? Math.min(2 * parseInt(r), Pl) : xl, localStorage.setItem("im_sick_timer", i), i),
                c = e.querySelector(Cl),
                u = +new Date;
            return c.innerHTML = Bl(a), Sl = setInterval(function() {
                c.innerHTML = Bl(u + a - new Date)
            }, 500), Il = setTimeout(Ll, a), o
        }
        var Nl = n("E2g8"),
            Ul = n("f4YT"),
            Wl = Nl.Promise;
        window.IM = {
            init: function(e) {
                if (window.imwl = e.imwl, Object(f.d)(), addTemplates(Ul), window.Promise || (window.Promise = Wl), window.cur.lang.dont_attach = getLang("mail_dont_add_media"), e.failed) return Rl(geByClass1("im-sick", ge("page_body")));
                localStorage.removeItem("im_sick_timer"), e.tabbedPeers = (e.tabbedPeers || []).map(function(e) {
                    return {
                        peer: e,
                        type: "perm"
                    }
                }), cur.ctrl_submit = e.ctrl_submit, cur.module = "im", cur.mutedPeers = e.mutedPeers, cur.gid = e.gid, cur.peer = e.peer, e.blockedFlagUpdates = {}, e.msgid = intval(nav.objLoc.msgid), cur.options = {
                    blacklist_hash: e.thash
                };
                var t = -10800 - 60 * (new Date).getTimezoneOffset(),
                    n = e.timeshift;
                e.timeshift = n - t, e.oCache = {}, e.ref_id = nav.objLoc.ref, e.ref_source = nav.objLoc.ref_source;
                var o = e.owners;
                e.owners = void 0;
                var a = m(e);
                o.forEach(function(e) {
                    return Object(B.a)(a, e)
                }), o = void 0, Object(i.lb)(a, a.get().tabs), cur.imClassicInterface = Object(i.Ia)(a);
                var s = yl(geByClass1("js-im-page", ge("page_body")), a);
                Object(r.yc)(a.get()), window.IMBRIDGE = {
                    chatPhotoSaved: function(e) {
                        curBox() && curBox().hide();
                        var t = (e || {})[1];
                        return t ? (cur.pvShown && layers.fullhide(!0, !0), "im" != cur.module || a.get().peer != t ? nav.go("/im?sel=c" + (t - 2e9)) : void 0) : nav.reload()
                    },
                    updateHistory: function(e) {
                        a.set(r.wc.bind(null, e)).then(function() {
                            s.updateHistory(e)
                        })
                    },
                    activateTab: function(e) {
                        a.get().gid || a.get().longpoll.push([Object(c.Ba)(intval(e), !1, !1, !0)])
                    }
                };
                var u = !1;
                cur.nav.push(function() {
                    if (u) return !0;
                    a.get().audio_msg && a.get().audio_msg.isRecording && s.cancelRecording(), AudioMessagePlayer.detachPlayer();
                    var t = s.route.apply(null, arguments);
                    return !1 !== t && (s.unmount(), window.IMBRIDGE = void 0, a.unmount(), window.store = void 0, u = !0, e = !1, a = !1, s = !1, Object(f.e)()), t
                })
            }
        };
        try {
            stManager.done("imn.js")
        } catch (e) {}
    },
    M6Qj: function(e, t, n) {
        var r = n("hPIQ"),
            i = n("K0xU")("iterator"),
            o = Array.prototype;
        e.exports = function(e) {
            return void 0 !== e && (r.Array === e || o[i] === e)
        }
    },
    "MV/q": function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR")),
            o = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };
        var a = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.getRef = function(e) {
                    r.element = e
                }, r.resize = function() {
                    var e = r.element;
                    if (e) {
                        var t = e.offsetHeight,
                            n = e.scrollHeight,
                            i = 0;
                        n + i <= t && (i = 0), e.value && r.setState({
                            height: n - i
                        }), r.setState({
                            height: 0
                        }, function() {
                            var t = e.scrollHeight - i;
                            r.setState({
                                height: t
                            }), r.props.onResize(e)
                        })
                    }
                }, r.onChange = function(e) {
                    r.props.grow && r.resize(), r.isControlledOutside || r.setState({
                        value: e.target.value
                    }), r.props.onChange && r.props.onChange(e)
                }, r.state = {
                    value: void 0 === n.value ? n.initialValue || "" : void 0
                }, void 0 !== n.value && (r.isControlledOutside = !0), r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                this.props.grow && this.resize()
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.className,
                    n = (e.initialValue, e.grow, e.style),
                    a = (e.onResize, e.value),
                    s = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["className", "initialValue", "grow", "style", "onResize", "value"]),
                    c = this.isControlledOutside ? a : this.state.value,
                    u = this.state.height || n.height || 66;
                return r.createElement("textarea", o({}, s, {
                    value: c,
                    onChange: this.onChange,
                    onInput: this.onChange,
                    onPaste: this.onChange,
                    ref: this.getRef,
                    style: Object.assign({
                        height: u
                    }, n),
                    className: Object(i.a)("Textarea", t)
                }))
            }, t
        }(r.Component);
        t.a = a, a.defaultProps = {
            initialValue: "",
            grow: !0,
            onResize: function() {},
            style: {}
        }
    },
    MhhX: function(e, t, n) {
        "use strict";
        n.d(t, "n", function() {
            return o
        }), n.d(t, "l", function() {
            return a
        }), n.d(t, "e", function() {
            return s
        }), n.d(t, "k", function() {
            return c
        }), n.d(t, "c", function() {
            return u
        }), n.d(t, "g", function() {
            return d
        }), n.d(t, "d", function() {
            return _
        }), n.d(t, "m", function() {
            return f
        }), n.d(t, "f", function() {
            return p
        }), n.d(t, "i", function() {
            return m
        }), n.d(t, "j", function() {
            return g
        }), n.d(t, "o", function() {
            return h
        }), n.d(t, "h", function() {
            return b
        }), n.d(t, "b", function() {
            return v
        }), n.d(t, "a", function() {
            return y
        }), n.d(t, "p", function() {
            return O
        });
        var r = n("f01n"),
            i = n("aong");

        function o(e, t) {
            return "number" != typeof t.messageId || (c(t) ? t.messageId > e.out_up_to : t.messageId > e.in_up_to)
        }

        function a(e) {
            return e.kludges && void 0 !== e.kludges.source_act
        }

        function s(e) {
            return "call" == e.kludges.attach1_type
        }

        function c(e) {
            return e.flags & r.m
        }

        function u(e) {
            var t = e.attaches.filter(function(e) {
                return "mail" === e.type
            }).length > 0;
            return e.attaches.filter(function(e) {
                return "reply" === e.type
            }).length > 0 || e.flags & r.k && t
        }

        function l(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null,
                r = e.attaches[0];
            return r && (r.type === t || r.type === n)
        }

        function d(e) {
            return l(e, "doc") && "graffiti" === e.attaches[0].kind
        }

        function _(e) {
            return Boolean(e.attaches.find(function(e) {
                return "doc" === e.type && "audiomsg" === e.kind
            }))
        }

        function f(e) {
            return Boolean(e.attaches.find(function(e) {
                return "sticker" === e.type
            }))
        }

        function p(e) {
            return l(e, "gift")
        }

        function m(e) {
            return l(e, "money_transfer", "money_request")
        }

        function g(e) {
            return l(e, "money_request")
        }

        function h(e) {
            return l(e, "link", "vkpay") && 6217559 == e.kludges.attach1_app_id
        }

        function b(e) {
            return e.flags & r.l
        }

        function v(e) {
            return c(e) ? vk.id : e.userId
        }

        function y(e, t) {
            var n = Object(i.r)(e);
            return c(t) ? n.id : t.userId
        }

        function O(e) {
            return e.update_time > 0
        }
    },
    Mukb: function(e, t, n) {
        var r = n("hswa"),
            i = n("RjD/");
        e.exports = n("nh4g") ? function(e, t, n) {
            return r.f(e, t, i(1, n))
        } : function(e, t, n) {
            return e[t] = n, e
        }
    },
    N1NS: function(e, t, n) {
        "use strict";
        var r = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            i = new window.Map;

        function o(e) {
            var t = i.get(e.currentTarget);
            if (t) {
                var n = t[e.type];
                if (n)
                    for (var o = void 0, a = 0; a < n.length; a++) {
                        var s = r(n[a], 2),
                            c = s[0],
                            u = s[1],
                            l = void 0;
                        if (hasClass(e.target, c) ? l = u(e, e.target) : (o = gpeByClass(c, e.target, e.currentTarget)) && (l = u(e, o)), !1 === l) break
                    }
            }
        }

        function a(e) {
            if (Array.isArray(e)) {
                for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                return n
            }
            return Array.from(e)
        }
        n.d(t, "b", function() {
            return l
        }), n.d(t, "a", function() {
            return _
        }), n.d(t, "c", function() {
            return f
        });
        var s = window,
            c = s.addEvent,
            u = s.removeEvent;

        function l(e) {
            return {
                callMutations: function() {
                    if ("function" == typeof e) throw console.trace(), new Error("Mutations are not initialized");
                    return e
                },
                bindMutations: function() {
                    if ("function" != typeof e) throw console.trace(), new Error("Mutations are already initialized");
                    return e = e.apply(void 0, arguments)
                }
            }
        }

        function d(e, t, n, r, a) {
            ! function(e, t, n, r) {
                var a = i.get(e);
                a || (i.set(e, {}), a = i.get(e));
                for (var s = t.split(" "), c = 0; c < s.length; c++) {
                    var u = s[c];
                    a[u] || (a[u] = [], addEvent(e, u, o)), a[u].push([n, r])
                }
            }(t, n, r, a), e._registeredHandlers.push(["delegate", t, n, r, a])
        }

        function _(e) {
            var t = {
                _registeredHandlers: []
            };
            return e.handlers(function(e, t, n, r) {
                c(t, n, r), e._registeredHandlers.push(["bind", t, n, r])
            }.bind(null, t), d.bind(null, t)), t
        }

        function f(e) {
            e._registeredHandlers.forEach(function(e) {
                var t = e.slice(1);
                "delegate" === e[0] ? function(e, t, n, r) {
                    var a = i.get(e);
                    a && (t.split(" ").forEach(function(t) {
                        a[t] && (a[t] = a[t].filter(function(e) {
                            return e[0] !== n || e[1] !== r
                        }), 0 === a[t].length && removeEvent(e, t, o))
                    }), 0 === Object.keys(a).map(function(e) {
                        return a[e].length
                    }).reduce(function(e, t) {
                        return e + t
                    }) && i.delete(e))
                }.apply(void 0, a(t)) : u.apply(void 0, a(t))
            }), e._registeredHandlers = []
        }
    },
    NsuH: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR")),
            o = n("BN/X");
        var a = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onError = function() {
                    r.setState({
                        errored: !0
                    })
                }, r.state = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.getPhotoImage = function() {
                var e = this.props,
                    t = e.size,
                    n = e.photo,
                    i = e.title;
                return r.createElement("img", {
                    width: t,
                    height: t,
                    src: this.state.errored ? "/images/camera_c.gif" : n,
                    alt: i,
                    onError: this.onError,
                    className: "Entity__photo"
                })
            }, t.prototype.render = function() {
                var e, t, n, a = this.props,
                    s = a.className,
                    c = a.style,
                    u = a.size,
                    l = a.photo,
                    d = a.href,
                    _ = a.title,
                    f = a.description,
                    p = a.target,
                    m = (n = !!u, (t = "Entity--size" + u) in (e = {}) ? Object.defineProperty(e, t, {
                        value: n,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : e[t] = n, e);
                return r.createElement("div", {
                    className: Object(i.a)("Entity", s, m),
                    style: c
                }, r.createElement("div", {
                    className: "Entity__aside"
                }, "string" == typeof l ? d ? r.createElement("a", {
                    href: d
                }, this.getPhotoImage()) : this.getPhotoImage() : l), r.createElement("div", {
                    className: "Entity__main"
                }, _ && d ? r.createElement("div", {
                    className: "Entity__title"
                }, r.createElement(o.a, {
                    href: d,
                    dangerouslySetInnerHTML: {
                        __html: _
                    },
                    target: p
                })) : r.createElement("div", {
                    className: "Entity__title",
                    dangerouslySetInnerHTML: {
                        __html: _
                    }
                }), "string" != typeof f ? r.createElement("div", {
                    className: "Entity__description"
                }, f) : r.createElement("div", {
                    className: "Entity__description",
                    dangerouslySetInnerHTML: {
                        __html: f
                    }
                })))
            }, t
        }(r.PureComponent);
        t.a = a, a.defaultProps = {
            size: null,
            photo: "",
            title: "",
            description: "",
            href: "",
            target: null
        }
    },
    O8ze: function(e, t, n) {
        "use strict";
        n.d(t, "e", function() {
            return a
        }), n.d(t, "g", function() {
            return s
        }), n.d(t, "d", function() {
            return c
        }), n.d(t, "f", function() {
            return u
        }), n.d(t, "k", function() {
            return d
        }), n.d(t, "m", function() {
            return _
        }), n.d(t, "l", function() {
            return f
        }), n.d(t, "h", function() {
            return p
        }), n.d(t, "i", function() {
            return g
        }), n.d(t, "j", function() {
            return h
        }), n.d(t, "c", function() {
            return b
        }), n.d(t, "b", function() {
            return v
        }), n.d(t, "a", function() {
            return y
        });
        var r = n("1y80"),
            i = n("aong"),
            o = {};

        function a(e) {
            Object(r.b)(.1, "im_forward_stat", l(e), !!e.get().gid)
        }

        function s(e, t) {
            Object(r.b)(.1, "im_forward_from_community_stat", l(e), !!e.get().gid, +t)
        }

        function c() {
            Object(r.b)(1, "im_apply_community_template_stat", 1)
        }

        function u() {
            Object(r.b)(1, "messages_channel_forward_click", 1)
        }

        function l(e) {
            var t = e.get().pendingForward;
            return +(t && t.msgIds && t.msgIds.length)
        }

        function d(e, t, n) {
            var i = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
            if (!Object(r.a)(1)) return function() {};
            var o = +new Date,
                a = m(e);
            return function() {
                var e = +new Date - o;
                Object(r.c)("messages_send_time_web", e, t, n, a, i)
            }
        }

        function _(e, t, n, r) {
            if (t.messageId && -1 !== String(t.messageId).indexOf("rid")) {
                var i = [t.messageId.replace("rid", ""), n, r].join("_"),
                    a = t.attaches.length > 0;
                o[i] = d(e, n, r, a)
            }
        }

        function f(e, t, n, r) {
            var i = [t.randomId, n, r].join("_"),
                a = o[i];
            a && (a(), delete o[i])
        }

        function p(e, t, n, i) {
            var o = m(e),
                a = "" === t ? "network" : "unknown";
            Object(r.a)(1) && Object(r.c)("messages_send_errors_web", a, n, i, o)
        }

        function m(e) {
            var t = Object(i.r)(e);
            return Boolean(t.longpoll && t.longpoll.isEnabled && t.longpoll.isEnabled())
        }

        function g(e) {
            var t = Object(i.r)(e),
                n = t.imQueue(t.peer).length;
            Object(r.a)(1) && Object(r.c)("messages_send_queue_size", n)
        }

        function h(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "unknown";
            Object(r.a)(1) && Object(r.c)("messages_send_retry", 1, t, e)
        }

        function b() {
            var e = "im_browser_notifications_users";
            ls.get(e) || ls.get("im_ui_notify_off") || (ls.set(e, 1), Object(r.c)(e, 1))
        }

        function v() {
            Object(r.b)(1, "im_browser_notifications_on", 1)
        }

        function y() {
            Object(r.b)(1, "im_browser_notifications_off", 1)
        }
    },
    OP3Y: function(e, t, n) {
        var r = n("aagx"),
            i = n("S/j/"),
            o = n("YTvA")("IE_PROTO"),
            a = Object.prototype;
        e.exports = Object.getPrototypeOf || function(e) {
            return e = i(e), r(e, o) ? e[o] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? a : null
        }
    },
    "P+eJ": function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return o
        }), n.d(t, "a", function() {
            return _
        });
        var r = n("ERyv");

        function i(e) {
            if (Array.isArray(e)) {
                for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                return n
            }
            return Array.from(e)
        }

        function o(e, t) {
            var n;
            if (window.vk.lpConfig.debug) {
                for (var r = "background: " + e + "; color: white", i = new Date, o = function(e) {
                        return e < 10 ? "0" + e : e
                    }, a = arguments.length, s = Array(a > 2 ? a - 2 : 0), c = 2; c < a; c++) s[c - 2] = arguments[c];
                (n = console).log.apply(n, ["%c " + i.getHours() + ":" + o(i.getMinutes()) + ":" + o(i.getSeconds()) + ":" + i.getMilliseconds() + " " + t + " ", r].concat(s))
            }
        }

        function a() {
            return window.lpBufferFc || (window.lpBufferFc = []), window.lpBufferFc
        }

        function s() {
            return window.lpBufferIm || (window.lpBufferIm = []), window.lpBufferIm
        }

        function c(e, t) {
            window.lpWeird || (window.lpWeird = []), window.lpWeird.push({
                msg: e,
                ev: t,
                is_master: window.curNotifier.is_server
            }), setTimeout(u, 1e4)
        }

        function u() {
            window.lpWeird.length && (Object(r.b)("fc_im_differ", {
                diff: window.lpWeird
            }, !1), window.lpWeird = [])
        }

        function l() {
            return "im" === window.cur.module && window.store && window.store.get().longpoll && !window.store.get().stopped
        }

        function d() {
            var e;
            l() && (s().forEach(function(e) {
                !a().find(function(t) {
                    return e.ev === t.ev
                }) && e.time < Date.now() - 1e3 && !e.warned && (e.warned = !0, o("red", "im not fc", e.ev), Object(r.c)() && c("im not fc", e.ev))
            }), a().forEach(function(e) {
                var t = s().find(function(t) {
                    return t.ev === e.ev
                });
                t && t.warned && !e.warned && (e.warned = !0, o("red", "now fc like im", e.ev), Object(r.c)() && c("now fc like im", e.ev))
            })), e = Date.now() - 3e4, window.lpBufferFc = a().filter(function(t) {
                return t.time > e
            }), window.lpBufferIm = s().filter(function(t) {
                return t.time > e
            })
        }

        function _(e) {
            var t;
            l() && ((t = a()).push.apply(t, i(e.map(function(e) {
                return {
                    time: Date.now(),
                    ev: JSON.stringify(e),
                    warned: !1
                }
            }))), setTimeout(d, 0));
            o.apply(void 0, ["green", "fc"].concat(i(e)))
        }
        window.longpollTesting_onImEvents = function(e) {
            var t;
            l() && ((t = s()).push.apply(t, i(e.map(function(e) {
                return {
                    time: Date.now(),
                    ev: JSON.stringify(e),
                    warned: !1
                }
            }))), setTimeout(d, 1100)), o.apply(void 0, ["blue", "im"].concat(i(e)))
        }
    },
    P13b: function(e, t, n) {
        "use strict";
        var r = n("f01n"),
            i = n("h++7"),
            o = n("nyd8"),
            a = n("rHUl"),
            s = n("MhhX"),
            c = n("p3re"),
            u = n("eTng"),
            l = n("vT4u"),
            d = n("N1NS"),
            _ = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            f = "_im_join_chat";

        function p(e, t) {
            var n = Object(d.a)({
                handlers: function(n, i) {
                    i(e, "click", f, function(e) {
                        return function(e, t) {
                            var n = domData(t, "chat-id"),
                                i = domData(t, "hash");
                            return lockButton(t), Object(l.Z)(n, i, e.get()).then(function(n) {
                                var i = _(n, 1)[0];
                                unlockButton(t), e.get().longpoll.push([Object(r.Ba)(i)])
                            }).catch(function(e) {
                                showFastBox(getLang("mail_join_invite_error_title"), e), unlockButton(t)
                            })
                        }(t, e.target)
                    })
                }
            });
            return {
                unmount: function() {
                    Object(d.c)(n)
                }
            }
        }
        var m = n("aong"),
            g = n("86+7"),
            h = n("Wu9C"),
            b = n("wSs/"),
            v = n("ERyv"),
            y = n("lJdi"),
            O = n("t7n3");
        n.d(t, "t", function() {
            return k
        }), n.d(t, "l", function() {
            return C
        }), n.d(t, "s", function() {
            return P
        }), n.d(t, "v", function() {
            return M
        }), n.d(t, "j", function() {
            return T
        }), n.d(t, "g", function() {
            return I
        }), n.d(t, "b", function() {
            return S
        }), n.d(t, "c", function() {
            return D
        }), n.d(t, "e", function() {
            return B
        }), n.d(t, "d", function() {
            return L
        }), n.d(t, "f", function() {
            return A
        }), n.d(t, "h", function() {
            return R
        }), n.d(t, "a", function() {
            return N
        }), n.d(t, "k", function() {
            return U
        }), n.d(t, "o", function() {
            return W
        }), n.d(t, "m", function() {
            return H
        }), n.d(t, "n", function() {
            return K
        }), n.d(t, "p", function() {
            return q
        }), n.d(t, "i", function() {
            return F
        }), n.d(t, "u", function() {
            return z
        }), n.d(t, "q", function() {
            return V
        }), n.d(t, "r", function() {
            return Q
        }), n.d(t, "U", function() {
            return Xe
        }), n.d(t, "Jb", function() {
            return Ye
        }), n.d(t, "L", function() {
            return Je
        }), n.d(t, "y", function() {
            return Ze
        }), n.d(t, "G", function() {
            return $e
        }), n.d(t, "Fa", function() {
            return tt
        }), n.d(t, "Eb", function() {
            return nt
        }), n.d(t, "gb", function() {
            return rt
        }), n.d(t, "Q", function() {
            return it
        }), n.d(t, "I", function() {
            return at
        }), n.d(t, "jc", function() {
            return st
        }), n.d(t, "J", function() {
            return ct
        }), n.d(t, "vb", function() {
            return lt
        }), n.d(t, "K", function() {
            return dt
        }), n.d(t, "x", function() {
            return ft
        }), n.d(t, "Hb", function() {
            return pt
        }), n.d(t, "jb", function() {
            return mt
        }), n.d(t, "Db", function() {
            return gt
        }), n.d(t, "La", function() {
            return ht
        }), n.d(t, "Ua", function() {
            return bt
        }), n.d(t, "Pa", function() {
            return vt
        }), n.d(t, "bb", function() {
            return yt
        }), n.d(t, "cb", function() {
            return Ot
        }), n.d(t, "H", function() {
            return Ct
        }), n.d(t, "hc", function() {
            return xt
        }), n.d(t, "bc", function() {
            return Pt
        }), n.d(t, "D", function() {
            return Mt
        }), n.d(t, "xb", function() {
            return Dt
        }), n.d(t, "qb", function() {
            return Bt
        }), n.d(t, "wb", function() {
            return Lt
        }), n.d(t, "sb", function() {
            return At
        }), n.d(t, "zb", function() {
            return Rt
        }), n.d(t, "rb", function() {
            return Nt
        }), n.d(t, "Ab", function() {
            return Ut
        }), n.d(t, "Kb", function() {
            return Wt
        }), n.d(t, "dc", function() {
            return Ht
        }), n.d(t, "mb", function() {
            return Kt
        }), n.d(t, "ob", function() {
            return Ft
        }), n.d(t, "nb", function() {
            return zt
        }), n.d(t, "Gb", function() {
            return Vt
        }), n.d(t, "O", function() {
            return Qt
        }), n.d(t, "hb", function() {
            return Gt
        }), n.d(t, "tb", function() {
            return Yt
        }), n.d(t, "Ib", function() {
            return Jt
        }), n.d(t, "Bb", function() {
            return Zt
        }), n.d(t, "w", function() {
            return $t
        }), n.d(t, "Fb", function() {
            return en
        }), n.d(t, "ab", function() {
            return tn
        }), n.d(t, "Zb", function() {
            return nn
        }), n.d(t, "lc", function() {
            return rn
        }), n.d(t, "ec", function() {
            return on
        }), n.d(t, "E", function() {
            return an
        }), n.d(t, "ub", function() {
            return sn
        }), n.d(t, "Pb", function() {
            return cn
        }), n.d(t, "Rb", function() {
            return un
        }), n.d(t, "Xb", function() {
            return ln
        }), n.d(t, "Tb", function() {
            return dn
        }), n.d(t, "F", function() {
            return _n
        }), n.d(t, "Ea", function() {
            return fn
        }), n.d(t, "gc", function() {
            return pn
        }), n.d(t, "Yb", function() {
            return mn
        }), n.d(t, "C", function() {
            return gn
        }), n.d(t, "Qa", function() {
            return hn
        }), n.d(t, "db", function() {
            return bn
        }), n.d(t, "Va", function() {
            return vn
        }), n.d(t, "Xa", function() {
            return yn
        }), n.d(t, "Wa", function() {
            return On
        }), n.d(t, "z", function() {
            return jn
        }), n.d(t, "Wb", function() {
            return wn
        }), n.d(t, "W", function() {
            return En
        }), n.d(t, "V", function() {
            return kn
        }), n.d(t, "Mb", function() {
            return xn
        }), n.d(t, "Lb", function() {
            return Pn
        }), n.d(t, "S", function() {
            return Mn
        }), n.d(t, "Ob", function() {
            return Tn
        }), n.d(t, "Ma", function() {
            return In
        }), n.d(t, "kc", function() {
            return Sn
        }), n.d(t, "pb", function() {
            return Dn
        }), n.d(t, "Ta", function() {
            return Bn
        }), n.d(t, "Ca", function() {
            return Ln
        }), n.d(t, "Aa", function() {
            return An
        }), n.d(t, "Ba", function() {
            return Rn
        }), n.d(t, "Da", function() {
            return Nn
        }), n.d(t, "Cb", function() {
            return Un
        }), n.d(t, "ib", function() {
            return Hn
        }), n.d(t, "ic", function() {
            return Kn
        }), n.d(t, "yb", function() {
            return qn
        }), n.d(t, "Sb", function() {
            return Fn
        }), n.d(t, "Nb", function() {
            return zn
        }), n.d(t, "Y", function() {
            return Vn
        }), n.d(t, "A", function() {
            return Qn
        }), n.d(t, "Ub", function() {
            return Gn
        }), n.d(t, "Vb", function() {
            return Xn
        }), n.d(t, "eb", function() {
            return Yn
        }), n.d(t, "P", function() {
            return Jn
        }), n.d(t, "kb", function() {
            return Zn
        }), n.d(t, "lb", function() {
            return $n
        }), n.d(t, "cc", function() {
            return er
        }), n.d(t, "Sa", function() {
            return tr
        }), n.d(t, "Qb", function() {
            return nr
        }), n.d(t, "ac", function() {
            return rr
        }), n.d(t, "B", function() {
            return ir
        }), n.d(t, "T", function() {
            return or
        }), n.d(t, "N", function() {
            return ar
        }), n.d(t, "M", function() {
            return sr
        }), n.d(t, "X", function() {
            return cr
        }), n.d(t, !1, function() {
            return a.h
        }), n.d(t, !1, function() {
            return a.K
        }), n.d(t, !1, function() {
            return a.o
        }), n.d(t, !1, function() {
            return a.f
        }), n.d(t, !1, function() {
            return a.j
        }), n.d(t, "Z", function() {
            return a.t
        }), n.d(t, !1, function() {
            return a.g
        }), n.d(t, !1, function() {
            return a.s
        }), n.d(t, !1, function() {
            return a.n
        }), n.d(t, !1, function() {
            return a.b
        }), n.d(t, !1, function() {}), n.d(t, !1, function() {
            return a.J
        }), n.d(t, !1, function() {
            return a.l
        }), n.d(t, !1, function() {
            return a.k
        }), n.d(t, !1, function() {
            return a.P
        }), n.d(t, !1, function() {
            return a.d
        }), n.d(t, !1, function() {
            return a.m
        }), n.d(t, !1, function() {
            return a.q
        }), n.d(t, "Ia", function() {
            return a.z
        }), n.d(t, "Ra", function() {
            return a.G
        }), n.d(t, "Na", function() {
            return a.D
        }), n.d(t, "Ja", function() {
            return a.B
        }), n.d(t, !1, function() {
            return a.y
        }), n.d(t, "R", function() {
            return a.e
        }), n.d(t, "Za", function() {
            return a.I
        }), n.d(t, "Oa", function() {
            return a.E
        }), n.d(t, !1, function() {
            return a.O
        }), n.d(t, !1, function() {
            return a.F
        }), n.d(t, !1, function() {
            return a.w
        }), n.d(t, !1, function() {
            return a.N
        }), n.d(t, "Ka", function() {
            return a.C
        }), n.d(t, !1, function() {
            return a.A
        }), n.d(t, !1, function() {
            return a.a
        }), n.d(t, !1, function() {
            return a.L
        }), n.d(t, !1, function() {
            return a.r
        }), n.d(t, !1, function() {
            return a.M
        }), n.d(t, !1, function() {
            return a.H
        }), n.d(t, !1, function() {
            return a.p
        }), n.d(t, !1, function() {
            return a.c
        }), n.d(t, "Ga", function() {
            return a.x
        }), n.d(t, !1, function() {
            return a.i
        }), n.d(t, !1, function() {
            return a.u
        }), n.d(t, !1, function() {
            return a.v
        }), n.d(t, "fc", function() {
            return a.Q
        }), n.d(t, !1, function() {
            return a.R
        }), n.d(t, "Ha", function() {
            return u.b
        }), n.d(t, "fb", function() {
            return u.d
        }), n.d(t, "Ya", function() {
            return u.c
        });
        var j = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            w = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            } : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            };

        function E(e, t, n) {
            return t in e ? Object.defineProperty(e, t, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = n, e
        }
        var k = "_im_mess_sending",
            C = "_im_mess_failed",
            x = "_im_mess_original",
            P = "_im_mess_restore",
            M = "_im_typing",
            T = "chat_create",
            I = "chat_title_update",
            S = "chat_invite_user",
            D = "chat_kick_user",
            B = "chat_photo_update",
            L = "chat_photo_remove",
            A = "chat_pin_message",
            R = "chat_unpin_message",
            N = "chat_invite_user_by_link",
            U = "_im_deselect_all",
            W = "_im_top_notice_hide",
            H = "_im_aside_notice_hide",
            K = "_im_aside_promo_block_hide",
            q = "_im_vkadmin_promo_link",
            F = "_im_clear_recent",
            z = "_im_toggle_mr_tab",
            V = "_im_mess_search",
            Q = "_im_pinned",
            G = window,
            X = G.vk,
            Y = G.ls,
            J = G.se,
            Z = G.re,
            $ = G.rs,
            ee = G.sech,
            te = G.inArray,
            ne = G.intval,
            re = G.trim,
            ie = G.stripHTML,
            oe = G.domFC,
            ae = G.domPS,
            se = G.domLC,
            ce = G.domChildren,
            ue = G.domClosestSibling,
            le = G.domData,
            de = G.geByClass,
            _e = G.geByClass1,
            fe = G.gpeByClass,
            pe = G.addClass,
            me = G.removeClass,
            ge = G.toggleClass,
            he = G.hasClass,
            be = G.attr,
            ve = G.setStyle,
            ye = G.val,
            Oe = G.getTemplate,
            je = G.getLang,
            we = G.langSex,
            Ee = G.langDate,
            ke = G.langNumeric,
            Ce = G.getDateText,
            xe = G.getSmDate,
            Pe = G.getShortDate,
            Me = G.isSameDate,
            Te = G.isToday,
            Ie = G.ajax,
            Se = G.showBox,
            De = G.showFastBox,
            Be = G.showTabbedBox,
            Le = G.showTooltip,
            Ae = G.mobPlatforms,
            Re = G.onlinePlatformClass,
            Ne = G.AudioMessagePlayer,
            Ue = G.Emoji,
            We = G.slideUp,
            He = G.fadeOut,
            Ke = G.cancelEvent,
            qe = G.fifaReplaceText,
            Fe = 4096,
            ze = 100,
            Ve = 8,
            Qe = 52,
            Ge = "chatPosition";

        function Xe() {
            return Y.get(Ge) || 0
        }

        function Ye(e) {
            e >= window.clientHeight() - 30 && (e = 0), Y.set(Ge, e)
        }

        function Je(e, t) {
            var n = _e(e, t);
            n.firstElementChild.offsetHeight !== n.parentNode.offsetHeight && ve(n.firstElementChild, {
                height: n.parentNode.offsetHeight
            })
        }

        function Ze(e, t) {
            e && e.innerHTML !== t && (e.innerHTML = t)
        }

        function $e(e, t, n, r) {
            var i = t && !n ? 1 : !t && n ? -1 : 0;
            i && !Object(a.z)(e) && r().compensateHistoryHeightChange(i)
        }

        function et(e, t, n, r) {
            var i = window.devicePixelRatio >= 2 ? "256" : "128",
                o = "animation" === n,
                a = "im_gift";
            o && (a += " sticker_img");
            var s = '<img height="128" class="' + a + '" src="' + Stickers.getStickerUrl(ne(e), i) + '"/>';
            if (o) {
                var c = "animatedSticker" + r;
                s = '<div id="' + c + '" data-loop-count=3 data-animation-path="' + ("/stickers.php?act=proxy_animation&product_id=" + t + "&sticker_id=" + e) + '" onmouseenter="StickersAnimation.loadAndPlaySticker(this);"\n     data-uniq-id="' + r + '" data-sticker-id="' + ne(e) + '" class="sticker_animation sticker_animation_128 im_gift">' + s + "</div>";
                var u = !1;
                browser.msie ? (0 ^ r) === r && (u = !0) : u = Number.isInteger(r), u && window.StickersSettings.getAutoplay() && window.StickersAnimation && window.StickersAnimation.loadAndPlayStickerWithTimer(c, 10)
            }
            return t && (s = '<a onmouseover="return Emoji.stickerOver(' + ne(e) + ', this);"\n        onclick="return Emoji.clickSticker(' + ne(t) + ', this, event);">' + s + "</a>"), s = '<div class="im_sticker_row">' + s + "</div>"
        }

        function tt(e, t, n) {
            var r = e.get ? e.get() : e;
            if (yt(r, t)) {
                var i = r.tabs[t].deleted || [];
                return te(n, i)
            }
            return !1
        }

        function nt(e, t, n) {
            var r = n.randomId,
                i = _e("_im_mess_rid" + r, t);
            return i && (t = ft(e, n, t = qt([i], t), !0, !1)), t
        }

        function rt(e) {
            var t = Object(a.a)(e);
            return browser.mobile && browser.safari ? Promise.resolve(!1) : void 0 !== t ? Promise.resolve(t) : it().then(function(e) {
                return e.length > 0
            }).catch(function(e) {
                return !1
            })
        }

        function it() {
            return window.AudioContext && navigator.mediaDevices ? navigator.mediaDevices.enumerateDevices().then(function(e) {
                for (var t = [], n = 0; n < e.length; n++) "audioinput" == e[n].kind && t.push(e[n]);
                return t
            }) : Promise.reject(new Error("NotSupported"))
        }

        function ot(e) {
            return Oe("im_preloader", {
                preloader: $(X.pr_tpl, {
                    id: ""
                }),
                cls: "im-preloader_attach im-preloader_visible im-preloader_" + e
            })
        }

        function at(e) {
            var t = e.split(".");
            return (t[0] < 10 ? "0" : "") + t[0] + (t[1] < 10 ? "0" : "") + t[1] + t[2]
        }

        function st(e, t, n) {
            var r = le(n, "msgid"),
                i = _e("_im_mess_" + r, t),
                o = n.cloneNode(!0);
            return i && (i.parentNode.replaceChild(o, i), dt(t)), t
        }

        function ct(e, t, n) {
            var r = ut(e, t),
                i = _e("_im_mess_" + t.messageId, n);
            return i && (i.parentNode.replaceChild(J(r), i), dt(n)), n
        }

        function ut(e, t) {
            var n = ["_im_mess"],
                r = Object(s.n)(e.tabs[t.peerId], t),
                i = Object(s.c)(t) ? Oe("im_message_media", {
                    type: "reply",
                    messageId: t.messageId,
                    attaches: ot("reply"),
                    text: ""
                }) : "";
            Object(s.k)(t) && r && n.push("im-mess_unread _im_mess_unread"), Object(s.k)(t) && n.push("im-mess_out"), Object(s.p)(t) && n.push("im-mess_was_edited"), Object(b.a)(e, t) && n.push("im-mess_editable"), Object(s.h)(t) && n.push("im-mess_fav"), -1 != (e.selectedMessages || []).indexOf(t.messageId) && n.push("im-mess_selected");
            var o = Date.now() - 1e3 * t.date > 1e3;
            t.local && o && n.push("im-mess_sending"), t.local && n.push("" + k), t.local && Object(s.p)(t) && !r && n.push("im-mess_unread im-mess_nobg"), t.failed && n.push("im-mess_failed " + C), Object(s.f)(t) && n.push("im-mess_gift");
            var l = lt(t),
                d = function(e, t) {
                    var n = "",
                        r = Object(m.r)(e).sourceEnabled && t.kludges && t.kludges.from_widget && t.kludges.ref_source;
                    Object(s.p)(t) && (n += Oe("sImLblWasEdited", {
                        update_time: t.update_time
                    }));
                    if (Object(a.B)(e) && r) {
                        var i = t.kludges.ref_source,
                            o = {};
                        try {
                            (o = JSON.parse(Object(O.I)(i))).link && o.info && (o.link = Object(c.e)(Object(O.c)(o.link), c.b.bind(null, !1)), o = Object(O.c)(langStr(je("mail_source_info"), "link", o.link, "info", Object(O.c)(o.info))), n += Oe("sImLblWasSourceInfo", {
                                source: o
                            }))
                        } catch (e) {}
                    }
                    return n
                }(e, t),
                _ = i + kt(e, t.text, t.kludges, !1, t.peerId);
            "" != _ && (_ += d), t.subject && "..." !== t.subject.trim() && !Object(u.b)(t.peerId) && (_ = Oe("im_topic", {
                topic: t.subject
            }) + _);
            var f = Oe("im_message_media", {
                type: "media",
                messageId: t.messageId,
                attaches: l.join(""),
                text: Object(s.f)(t) ? '<div class="im-mess--gift-lbl">' + _ + "</div>" : ""
            });
            return Object(s.f)(t) || (f = _ + f), "" == _ && (f += d), Oe("im_msg_row", {
                msg_id: t.messageId,
                from_id: t.peerId,
                aria_hidden: t.local && !t.failed ? "true" : "false",
                ts: t.date,
                marker_params: t.failed ? 'aria-label="' + je("mail_send_message_error") + '" role="link"' : "",
                unread_params: r ? 'aria-label="' + je("mail_unread_message") + '"' : "",
                cls: n.join(" ")
            }).replace("%text%", function() {
                return f
            })
        }

        function lt(e) {
            return e.attaches.reduce(function(t, n) {
                return !Object(s.c)(e) || "mail" !== n.type && "reply" !== n.type ? ("sticker" === n.type ? e.messageId ? t.push(et(n.id, n.productId, n.kind, e.messageId)) : t.push(et(n.id, n.productId)) : t.push(ot(n.type)), t) : t
            }, [])
        }

        function dt(e) {
            for (var t = e.getElementsByClassName("_im_mess_noa"), n = t.length; n--;) he(t[n], "im-mess_fwd") || t[n].insertAdjacentHTML("afterbegin", Oe("sImHistoryRowActions")), me(t[n], "_im_mess_noa")
        }

        function _t(e, t, n) {
            var r, i, o, a, s, c = X.id,
                u = e.attaches[0],
                l = u.initiatorId,
                d = u.state,
                _ = u.receiverId,
                f = void 0;
            switch (d) {
                case "reached":
                    f = je(c === l ? "mail_call_outgoing" : "mail_call_incoming");
                    var p = t ? "" : (r = u.duration, i = Math.floor(r / 3600), o = Math.floor(r / 60) - 60 * i, a = !1, s = !1, [i, o, r - 3600 * i - 60 * o].reduce(function(e, t) {
                        return 0 !== t || s ? (a && (t = t < 10 ? "0" + t : t), a = !0, s = !0, e + ("" !== e ? ":" : "") + t) : (s = !0, e)
                    }, ""));
                    f = f.replace("{duration}", p);
                    break;
                case "canceled_by_initiator":
                    f = je(c === l ? "mail_call_canceled" : "mail_call_missed");
                    break;
                case "canceled_by_receiver":
                    if (c === l) {
                        if (t) return je("mail_call_declined");
                        var m = Object(g.c)(n, _);
                        return m ? we(m.sex, je("mail_call_declined_by", "raw")).replace("{user_name}", m.first_name) : je("mail_call_declined")
                    }
                    return je("mail_call_canceled");
                default:
                    f = je("mail_added_call")
            }
            return Oe("im_calls_link", {
                text: f
            })
        }

        function ft(e, t, n) {
            !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3];
            var r = !(arguments.length > 4 && void 0 !== arguments[4]) || arguments[4],
                i = !(arguments.length > 5 && void 0 !== arguments[5]) || arguments[5],
                o = Date.now() - 1e3 * t.date > 1e3,
                c = e.tabs[t.peerId];
            if (!n || _e("_im_mess", n) || _e("_im_bar_date", n) || (n.innerHTML = ""), c.skipped > 0) return n;
            var l = [];
            t.local || (l = e.imQueue(t.peerId, r)), l.length > 0 && qt(l.map(function(e) {
                return _e("_im_mess_rid" + e.rid, n)
            }, n).filter(function(e) {
                return e
            }));
            var d = ut(e, t),
                _ = se(n);
            he(_, "_im_mess_stack") || (_ = ue(_, "._im_mess_stack", -1));
            for (var f = Object(a.k)(e, t.peerId, t.messageId); t.peerId === e.peer && f && !_e("_im_mess_" + f.messageId);) f = Object(a.k)(e, t.peerId, f.messageId);
            var p = _e("_im_unread_bar_row", n),
                h = Object(s.b)(t),
                b = f ? jt(f.date, e) : 0;
            if (!f || wt(c, f, t, e, i)) {
                var v = "",
                    y = !1;
                if (p && Object(s.k)(t) && Dn(e, n, t.peerId), 1 === c.unread && !Object(s.k)(t) && i && (v += Oe("im_mess_bar", {}), y = !0, Dn(e, n, t.peerId)), !Te(new Date(b))) {
                    var O = new Date,
                        j = y ? "im-page--history-new-bar_hide _im_invisible_bar" : "";
                    v += Oe("im_day_bar", {
                        day: Pe(t.date, e.timeshift, !0, je("months_of", "raw"), !0),
                        date: t.date,
                        day_class: O.getDate() + O.getMonth() + O.getFullYear() + " " + j
                    })
                }
                if (Object(s.l)(t)) v += Oe("im_service_row", {
                    text: Zt(e, t, c),
                    type: "",
                    date: t.date,
                    from_id: "",
                    message_id: t.messageId
                });
                else if (Object(s.e)(t)) v += Oe("im_service_row", {
                    text: Jt("", _t(t, !1, e), ""),
                    type: "",
                    date: t.date,
                    from_id: "",
                    message_id: t.messageId
                });
                else {
                    var w = e.gid && Object(s.k)(t) ? ne(t.kludges.from_admin) || -e.gid : 0,
                        E = Object(g.c)(e, w ? -e.gid : h) || c,
                        C = Object(u.b)(t.peerId) ? E.name : E.first_name,
                        x = E.link || c.href,
                        P = Oe("im_mess_stack_name", {
                            name: C,
                            link: x,
                            class: Object(s.i)(t) ? " im-mess-stack--lnk-money-transfer" : ""
                        });
                    if (Object(s.f)(t)) {
                        var M = je("mail_gift_message_sent", "raw");
                        P += ' <span class="im-mess-stack--gift">' + we(E.sex || 0, M) + "</span>"
                    }
                    if (Object(s.i)(t)) {
                        var T = Object(s.j)(t) ? je("mail_money_request_message_sent", "raw") : je("mail_money_tranfer_message_sent", "raw");
                        P += ' <span class="im-mess-stack--money-transfer">' + we(E.sex || 0, T) + "</span>"
                    }
                    var I = e.gid ? "/gim" + e.gid : "/im",
                        S = void 0;
                    if (S = t.local ? Et(t.date, e.timeshift) : Oe("im_stack_date", {
                            date: Et(t.date, e.timeshift),
                            link: I + "?sel=" + t.peerId + "&msgid=" + t.messageId
                        }), w && e.admins[w]) {
                        var D = e.admins[w],
                            B = w === X.id ? je("mail_by_you") : D[0];
                        S = S + " " + Oe("im_admin_link", {
                            name: B,
                            href: D[1]
                        })
                    }
                    v += Oe("im_mess_stack", {
                        photo: E.photo,
                        href: x,
                        cls: "",
                        date_attr: "",
                        link: "/im?sel=" + t.peerId + "&msgid=" + t.messageId,
                        name: ie(P),
                        stack_name: P,
                        peerId: h,
                        date: S,
                        messages: d,
                        admin: t.kludges.from_admin || 0
                    })
                }
                Object(m.p)(ee(v)).forEach(function(e) {
                    return n && n.appendChild(e)
                })
            } else p && e.peer === t.peerId && !c.inplaceSearch && Object(s.k)(t) && Dn(e, n, t.peerId), _e("_im_stack_messages", _).appendChild(J(d));
            return Object(s.k)(t) && !o && setTimeout(function() {
                var e = _e("_im_mess_" + t.messageId, n);
                he(e, k) && pe(e, "im-mess_sending")
            }, 500), l = l.filter(function(e) {
                return e.rid !== t.randomId
            }), dt(n), pt(l, e, n)
        }

        function pt(e, t, n) {
            var r = void 0;
            return (r = "object" === (void 0 === e ? "undefined" : w(e)) ? e : t.imQueue(e, !1)).length > 0 && r.map(function(e) {
                return e.mess.failed = !!e.failed, e.mess
            }).filter(function(e) {
                return Object(a.m)(t, e.peerId, e.messageId)
            }).forEach(function(e) {
                return ft(t, e, n, !1)
            }), n
        }

        function mt(e, t, n) {
            var r = e.tabs[t];
            return Object(m.p)(de("_im_mess_unread", n)).forEach(function(e) {
                var t, n = ne(le(e, "msgid"));
                n > 0 && r.out_up_to >= n && (me(e, "_im_mess_unread"), me(e, "im-mess_unread"), (t = _e("_im_mess_blind_unread_marker", e)) && (t.removeAttribute("aria-label"), t.removeAttribute("role"), t.removeAttribute("tabindex")))
            }), n
        }

        function gt(e, t, n) {
            var r = t.peerId,
                i = t.messageId,
                o = _e("_im_msg_reply" + i, e),
                a = _e("_im_msg_media" + i, e),
                s = n.tabs[r].mediacontent[i][0];
            return o && (o.innerHTML = s[0]), a && (a.innerHTML = s[1]), e
        }

        function ht(e, t) {
            if (!Object(a.E)(t, e.peerId)) return 0;
            var n = t.tabs[e.peerId];
            return n.msgs[e.messageId] ? 1 : n.msgs["rid" + e.randomId] ? 2 : 0
        }

        function bt(e, t) {
            return e === t.peer
        }

        function vt(e, t) {
            return Object(y.m)(Object(a.t)(e, t), 1024)
        }

        function yt(e, t) {
            return !!e.tabs[t]
        }

        function Ot(e, t) {
            return !!yt(e, t) && null !== e.tabs[t].lastmsg
        }

        function jt(e, t) {
            return 1e3 * e + 1e3 * t.timeshift
        }

        function wt(e, t, n, r, i) {
            if (Object(s.b)(t) !== Object(s.b)(n)) return !0;
            var o = jt(t.date, r),
                c = jt(n.date, r);
            return !Me(o, c) || (!(!Object(a.B)(r) || ne(t.kludges.from_admin) === ne(n.kludges.from_admin)) || (n.date - t.date > 300 || (!(!Object(s.l)(t) && !Object(s.l)(n)) || (!(!Object(s.e)(n) && !Object(s.e)(t)) || (!(!Object(s.f)(t) && !Object(s.f)(n)) || (!(!Object(s.g)(t) && !Object(s.g)(n)) || (!!Object(s.c)(n) || !(Object(s.n)(e, t) === Object(s.n)(e, n) || !i || Object(s.k)(n) || tn(n.peerId, r.gid)))))))))
        }

        function Et(e, t) {
            return Ee(1e3 * e, "{hour}:{minute} {am_pm}", 1e3 * t, [], !0)
        }

        function kt(e, t, n) {
            var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                i = arguments.length > 4 && void 0 !== arguments[4] && arguments[4],
                o = Math.round(1e9 * Math.random()).toString(16),
                s = {},
                u = 0;
            return t = (t = Object(c.e)(t || "", c.b.bind(null, r))).replace(/(<a.+?<\/a>)/gi, function(e) {
                var t = "!link_" + u + "_" + o + "!";
                return s[t] = e, u++, t
            }), t = Object(c.f)(t), t = Object(c.c)(t), t = Object(c.d)(t, function(t) {
                var n = Object(a.i)(e);
                return '<a href="/' + (n ? "gim" + n : "im") + "?sel=" + (i || Object(a.o)(e)) + "&st=" + encodeURIComponent(t) + '">' + t + "</a>"
            }), Object.keys(s).forEach(function(e) {
                t = t.replace(e, function() {
                    return s[e]
                })
            }), n.emoji && (t = Ue.emojiToHTML(t, !0)), qe && (t = qe(t)), t
        }

        function Ct(e) {
            return Object(u.b)(e) ? "c" + (e - 2e9) : e < -2e9 ? "e" + Math.abs(e + 2e9) : function(e) {
                return e > 19e8 && e < 2e9
            }(e) ? "mr" + (e - 19e8) : e
        }

        function xt(e) {
            switch (e.substr(0, 1)) {
                case "e":
                    return -2e9 - ne(e.substr(1));
                case "c":
                    return 2e9 + ne(e.substr(1));
                default:
                    return ne(e)
            }
        }

        function Pt(e) {
            return e > 9999999 ? Math.floor(e / 1e6) + "M" : e > 9999 ? Math.floor(e / 1e3) + "K" : e > 0 ? e.toString() : ""
        }

        function Mt(e, t) {
            return {
                search: {
                    name: je("mail_im_peer_search"),
                    icon: "search"
                },
                block_community: {
                    icon: "block",
                    name: je("mail_block_comm_messages")
                },
                allow_community: {
                    icon: "unblock",
                    name: je("mail_allow_comm_messages")
                },
                clear: {
                    name: e.peer < -2e9 ? je("mail_im_delete_email_contact") : je("mail_im_delete_all_history"),
                    icon: "clear"
                },
                chat: {
                    name: je("mail_im_create_chat_with"),
                    icon: "invite"
                },
                mute: {
                    name: je("mail_im_mute"),
                    icon: "mute"
                },
                unmute: {
                    name: je("mail_im_unmute"),
                    icon: "unmute"
                },
                photos: {
                    name: e.gid ? je("mail_im_show_media_history_group") : je("mail_im_show_media_history"),
                    icon: "media"
                },
                avatar: {
                    icon: "avatar",
                    name: je("mail_update_photo_red")
                },
                block: {
                    icon: "block",
                    name: je("mail_block_user")
                },
                invite: {
                    icon: "invite",
                    name: je("mail_im_create_chat_with")
                },
                invite_link: {
                    icon: "invite-link",
                    name: je(t ? "mail_vkcomgroup_invite_link" : "mail_chat_invite_link")
                },
                leave: {
                    icon: "leave",
                    name: je(t ? "mail_leave_channel" : "mail_leave_chat")
                },
                topic: {
                    icon: "topic",
                    name: je("mail_change_topic")
                },
                return: {
                    icon: "return",
                    name: je(t ? "mail_return_to_vkcomgroup" : "mail_return_to_chat")
                },
                pin_hide: {
                    icon: "pin_hide",
                    name: je("mail_menu_pin_hide")
                },
                pin_unhide: {
                    icon: "pin_unhide",
                    name: je("mail_menu_pin_show")
                },
                unpin: {
                    icon: "unpin",
                    name: je("mail_menu_unpin")
                },
                settings: {
                    icon: "settings",
                    name: je(t ? "mail_vkcomgroup_settings" : "mail_settings")
                }
            }
        }

        function Tt(e, t) {
            var n = '<img src="' + e + '" alt="" class="dialogs_inline_chatter dialogs_inline_chatter_half"/>';
            return t && (n = Oe("im_dialogs_link", {
                href: t,
                photo: n
            })), '<div class="im_grid">\n    <div class="dialogs_inline_chatter dialogs_inline_chatter_half">\n      ' + n + "\n    </div>\n  </div>"
        }

        function It(e, t) {
            var n = '<img src="' + e + '" alt="" class="dialogs_inline_chatter"/>';
            return t && (n = Oe("im_dialogs_link", {
                href: t,
                photo: n
            })), '<div class="im_grid">\n    <div class="dialogs_inline_chatter">\n      ' + n + "\n    </div>\n  </div>"
        }

        function St(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
            if ("string" == typeof e) return '<div class="im_grid"><img src="' + e + '" alt=""/></div>';
            switch (e.length) {
                case 1:
                    return '<div class="im_grid"><img src="' + e[0] + '" alt=""/></div>';
                case 2:
                    return e.map(function(e, n) {
                        return Tt(e, t[n])
                    }).join("");
                case 3:
                    return Tt(e[0], t[0]) + e.slice(1).map(function(e, n) {
                        return It(e, t[n + 1])
                    }).join("");
                case 4:
                    return e.map(function(e, n) {
                        return It(e, t[n])
                    }).join("")
            }
        }

        function Dt(e, t, n) {
            if ("string" == typeof t.photo && t.photo) return '<div class="im_grid"><img src="' + t.photo + '" alt=""></div>';
            if (Object(u.b)(t.peerId) && t.membersCount < 2) return '<div class="im_grid"><img src="' + e.get().default_chat_photo + '" alt=""></div>';
            if (Array.isArray(t.photo)) return St(t.photo);
            var r = t.data.active.slice(0, 4).map(g.c.bind(null, e));
            return St(r.map(function(e) {
                return e.photo
            }), n ? [] : r.map(function(e) {
                return e.link
            }))
        }

        function Bt(e) {
            var t = e.get().gid ? je("mail_search_only_messages_comm") : je("mail_search_only_messages");
            return '<li class="im-page--mess-search-w">\n    <div class="im-page--mess-search ' + V + '">\n      <button type="button" class="im-i--messages-search"></button>' + t + "\n    </div>\n  </li>"
        }

        function Lt() {
            return '<li class="im-search-results-head">' + je("mail_search_messages") + "</li>"
        }

        function At() {
            return '<li class="im-search-results-head">' + je("mail_search_conversations_sep") + "</li>"
        }

        function Rt() {
            return '<li class="im-search-results-head">' + je("mail_search_dialogs_sep") + "</li>"
        }

        function Nt() {
            return '<li class="im-search-results-head _im_recent_bar">\n    ' + je("mail_recent_searches") + '\n    <button type="button" class="' + F + ' im-page--clear-recent">' + je("mail_clear_recent") + "</button>\n  </li>"
        }

        function Ut(e) {
            var t = e.get().popular_sugg,
                n = Object(a.z)(e) ? 8 : 5;
            return t.length > n && (t = t.slice(0, n)), '<li class="im-popular clear_fix">' + t.map(function(t) {
                var n = t.peerId,
                    r = Object(g.c)(e, n) || t,
                    i = e.get().tabs[n] || t,
                    o = (e.get().mutedPeers || []).indexOf(n) >= 0;
                return '<div class="' + ["im-popular--item", "fl_l", "_im_dialog", "_dont_add_recent", "_im_sugg_" + n, i.unread > 0 && "sugg-is_unread", o && "sugg-is_muted"].filter(function(e) {
                    return !!e
                }).join(" ") + '" data-peer="' + n + '">\n    <a class="im-popular--avatar-w ' + Re(i.online) + '" href="' + r.link + '"><img class="im-popular--avatar" src="' + r.photo + '"/></a>\n    <div class="im-popular--name-w"><a class="im-popular--name" href="' + r.link + '">' + (r.first_name || r.name) + '</a></div>\n    <span class="im-popular--unread _sugg_unread_ct">' + Pt(i.unread) + "</span>\n</div>"
            }).join("") + "</li>"
        }

        function Wt(e, t, n) {
            var r = _e("_im_mess_" + t.messageId, n);
            if (r) {
                be(r, "aria-hidden", "false"), pe(r, "im-mess_failed " + C);
                var i = _e("_im_mess_marker", r);
                be(i, "aria-label", je("mail_send_message_error")), be(i, "role", "link")
            }
            return n
        }

        function Ht(e, t, n) {
            var r = _e("_im_mess_" + t, n);
            if (r) {
                me(r, "im-mess_failed"), be(r, "aria-hidden", "true"), me(r, C);
                var i = _e("_im_mess_marker", r);
                be(i, "aria-label", ""), be(i, "role", "")
            }
            return n
        }

        function Kt(e, t) {
            return qt(e.map(function(e) {
                return _e("_im_mess_" + e, t)
            }).filter(function(e) {
                return e
            }), t)
        }

        function qt(e, t) {
            var n = e.filter(function(e) {
                return !he(e, "im-mess_srv")
            }).map(function(e) {
                return e.parentNode
            });
            return e.forEach(function(e) {
                he(e, "im-mess_srv") ? e.parentNode.parentNode.removeChild(e.parentNode) : e.parentNode.removeChild(e)
            }), n.filter(function(e) {
                return 0 === ce(e).length
            }).map(function(e) {
                return fe("_im_mess_stack", e)
            }).forEach(function(e) {
                he(ae(e), "_im_bar_date") && Z(ae(e)), he(ae(e), "_im_unread_bar_row") && Z(ae(e)), Z(e)
            }), t
        }

        function Ft(e) {
            for (var t = e; t;) {
                var n = t;
                if (null === (t = t.previousElementSibling)) {
                    he(n, "mess_srv") && (t = n.parentNode);
                    var r = fe("_im_mess_stack", n);
                    r && (t = r.previousElementSibling, 1 === ce(n.parentNode).length && r.parentNode.removeChild(r))
                }
                he(n, "_im_unread_bar_row") || n.parentNode.removeChild(n)
            }
        }

        function zt(e, t, n, r) {
            return e.map(function(e) {
                return _e("_im_mess_" + e, r)
            }).filter(function(e) {
                return e
            }).forEach(function(e) {
                ye(e, function(e, t, n) {
                    var r = t.innerHTML;
                    return '<div class="im-mess--text">\n    ' + je("delete" === n ? "mail_deleted_stop" : "mail_marked_as_spam") + ' <button type="button" data-peer="' + e + '" class="' + P + ' im-mess--btn">' + je("mail_restore") + '</button>\n    <div class="' + x + ' im-mess--original">' + r + "</div>\n  </div>"
                }(t, e, n)), pe(e, "im-mess_light")
            }), r
        }

        function Vt(e, t, n) {
            var r = _e("_im_mess_" + e, n);
            if (r) {
                var i = _e(x, r);
                ye(r, i.innerHTML), me(r, "im-mess_light")
            }
            return n
        }

        function Qt() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                t = arguments[1],
                n = arguments[2],
                r = arguments[3],
                i = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 2;
            if (arguments.length > 5 && void 0 !== arguments[5] && arguments[5]) return Xt(e, t, n, r, !0, i);
            var o = Xt(e, t, n, r, !1, i);
            return o.length > 60 ? Xt(e, t, n, r, !0, i) : o
        }

        function Gt(e) {
            var t, n = (E(t = {}, l.d, 1), E(t, l.c, 2), t),
                r = Object.keys(e).sort(function(e, t) {
                    return n[t] - n[e]
                }),
                i = {},
                o = r.reduce(function(t, n) {
                    var r = (e[n] || {}).userIds;
                    return (void 0 === r ? [] : r).forEach(function(e) {
                        i[e] || (i[e] = !0, t[n] = !0)
                    }), t
                }, {}),
                a = r.filter(function(e) {
                    return !!o[e]
                });
            return a.length > 1 ? "" : a[0]
        }

        function Xt(e, t, n, r, i, o) {
            var s = function(e, t, n) {
                var r = [],
                    i = {};
                return Object.keys(t).map(function(n) {
                    ((t[n] || {}).userIds || []).forEach(function(t) {
                        Object(g.b)(e, t) ? parseInt(t, 10) !== e.id && (i[t] = n) : r.push(t)
                    })
                }), r.length && Object(l.Ha)(E({}, n, r), e), Object.keys(i).sort(function(e, n) {
                    return t[i[e]].ts - t[i[n]].ts
                })
            }(r, e, t);
            if (0 === s.length) return "";
            var c = Object(u.d)(t) || Object(a.C)(t) ? "first_name" : i ? "short_name" : "name",
                d = Gt(e),
                _ = "";
            d === l.c ? _ = je("mail_recording_audio_several", s.length) : d === l.d && (_ = je("mail_typing_several", s.length));
            var f = s.slice(0, Math.min(s.length - 1, o)),
                p = f.map(function(e) {
                    return Object(g.c)(r, e)[c]
                }).join(", ");
            if (s.length > o + 1) {
                var m = function(e) {
                    var t = {};
                    return Object.keys(e).forEach(function(n) {
                        var r = e[n].userIds;
                        (void 0 === r ? [] : r).forEach(function(e) {
                            t[e] = 1
                        })
                    }), Object.keys(t).length
                }(e);
                p += " " + je("mail_and_peer").replace("{count}", m - o).replace("{typing}", _)
            } else {
                if (s.length > 1 && (p += " " + je("mail_and_peer_one")), !Object(u.b)(t) && n) p += " " + _;
                else p += " " + Object(g.c)(r, s[f.length])[c] + " " + _
            }
            return p.trim()
        }

        function Yt() {
            return '<div class="im-page--chat-search-empty">\n    ' + je("mail_im_search_empty") + "\n  </div>"
        }

        function Jt(e, t, n) {
            var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "";
            return n ? '<a class="im_srv_lnk ' + r + '" target="_blank" href="' + e + '">' + t + "</a>" : '<span class="' + r + '">' + t + "</span>"
        }

        function Zt(e, t, n) {
            var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
                i = t.kludges,
                o = i.source_act,
                a = ne(i.source_mid),
                s = t.userId,
                c = Object(g.c)(e, s),
                u = "",
                l = s === a;
            switch (o) {
                case T:
                    u = "mail_im_chat_created";
                    break;
                case I:
                    u = i.source_is_channel ? "mail_im_title_updated_channel" : "mail_im_title_updated_dot";
                    break;
                case S:
                    u = l ? "mail_im_returned_to_chat" : "mail_im_invited";
                    break;
                case D:
                    u = l ? "mail_im_left" : "mail_im_kicked_from_chat";
                    break;
                case B:
                    u = "mail_im_photo_set";
                    break;
                case L:
                    u = i.source_is_channel ? "mail_im_photo_removed_channel" : "mail_im_photo_removed";
                    break;
                case A:
                    u = i.source_message ? "mail_im_pin_message" : "mail_im_pin_message_empty2";
                    break;
                case R:
                    u = i.source_message ? "mail_im_unpin_message" : "mail_im_unpin_message_empty2";
                    break;
                case N:
                    u = "mail_im_invite_by_link";
                    break;
                default:
                    return "mail_no_support"
            }
            if (u = (u = we(c.sex, je(u, "raw"))).replace("{from}", Jt(c.link, c.name, r)), a && a !== s) {
                var d = i.source_email;
                if (d) u = u.replace("{user}", Jt("/im?email=" + encodeURIComponent(d), "email", r));
                else {
                    var _ = Object(g.c)(e, a),
                        f = o === D ? _.inv_name : _.kick_name;
                    u = u.replace("{user}", Jt(_.link, f, r))
                }
            }
            if (i.source_text) {
                var p = i.source_old_text ? '«<b class="im_srv_lnk">' + i.source_old_text + "</b>» &rarr; " : "";
                u = u.replace("{title}", p + '«<b class="im_srv_lnk">' + i.source_text + "</b>»")
            }
            if (i.source_act === A || i.source_act === R)
                if (i.source_message) {
                    var m = Jt("", en(Ue.emojiToHTML(ie(i.source_message.replace(/<br\s?\/?>/gi, " ")), !0)), !1, "im_srv_mess_link");
                    u = u.replace("{msg}", m)
                } else u = u.replace(/{link}(.+){\/link}/i, function(e, t) {
                    return Jt("", t, !1, "im_srv_mess_link")
                });
            return u
        }

        function $t(e, t, n, r) {
            if (t === B) {
                var i = _e("_im_mess_" + e.messageId, r);
                if (i) {
                    var o = n.tabs[e.peerId];
                    i.parentNode.innerHTML = Oe("im_msg_row", {
                        msg_id: e.messageId,
                        from_id: e.peerId,
                        text: Zt(n, e, o) + n.chat_photo_msg,
                        ts: e.date,
                        cls: "im-mess_srv"
                    })
                }
            }
            return r
        }

        function en(e) {
            return e.replace(/&lt;&lt;/g, "&laquo;").replace(/&gt;&gt;/g, "&raquo;").replace(/ \-\-/g, " &mdash;").replace(/\-\- /g, "&mdash; ").replace(i.r, "$1$4")
        }

        function tn(e, t) {
            return !t && e === X.id
        }

        function nn(e, t) {
            return Le(e, {
                url: Object(a.C)(t) ? "al_groups.php" : "al_profile.php",
                params: {
                    act: "verified_tt",
                    mid: t,
                    gid: t
                },
                slide: 15,
                ajxdt: 200,
                showdt: 200,
                hidedt: 200,
                dir: "auto",
                shift: [94, 7, 7],
                className: "verified_tt"
            })
        }

        function rn(e) {
            return function(t) {
                var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "bottom",
                    r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "",
                    i = J(Oe("im_preloader", {
                        preloader: $(X.pr_tpl, {
                            id: ""
                        }),
                        cls: ["bottom" === n ? "im-preloader_bottom" : "im-preloader_top", r].join(" ")
                    })),
                    o = !1;

                function a() {
                    o = !0, me(i, "im-preloader_visible"), i.parentNode && i.parentNode.removeChild(i)
                }
                setTimeout(function() {
                    o || ("bottom" === n ? e.appendChild(i) : e.insertBefore(i, oe(e)), pe(i, "im-preloader_visible"))
                }, 0), t.then(a).catch(function(e) {
                    Object(v.a)("wrapLoading", e), a()
                })
            }
        }

        function on(e, t) {
            return {
                0: {
                    msgs: e.reduce(function(e, t) {
                        return e[t] = [t, r.l, 0, 0, "", {}, {}, 0, 0, 0], e
                    }, {}),
                    hash: t,
                    history: 1
                }
            }
        }

        function an(e, t) {
            if (!t && !e) return !1;
            var n = e.target || e.srcElement,
                r = Ve,
                i = !1,
                o = /_im_mess|im_log_act|im_log_ract|_im_log_body|im_log_rspacer|_im_graffiti_w|_wall_post_cont/;
            do {
                if (!n || n.onclick || n.onmousedown || "A" == n.tagName || he(n, "_im_no_select") || he(n, "im_msg_media_link") || "IMG" == n.tagName && !he(n, "_im_graffiti") && !he(n, "emoji") && !he(n, "emoji_css") && !he(n, "im_gift") || "TEXTAREA" == n.tagName || he(n, "play_new") || he(n, "videoplayer") || (i = o.test(n.className))) break
            } while (r-- && (n = n.parentNode));
            return !i || !!re((window.getSelection && window.getSelection() || document.getSelection && document.getSelection() || "").toString())
        }

        function sn(e, t) {
            return '<div class="im-mess--text">\n      <span>' + je("mail_restored") + '</span>\n      <a class="_im_go_to" href="/im?sel=' + Ct(e) + "&msgid=" + t + '">' + je("mail_im_goto_conversation") + "</a>\n    </div>"
        }

        function cn(e, t, n) {
            var r = je("mail_deleteall1"),
                i = je("mail_sure_to_delete_all"),
                o = je("mail_delete");
            return Object(u.b)(t) && (Object(y.m)(e, 1024) ? (r = je("mail_leave_channel"), i = je("mail_unfollow_channel_confirmation"), o = je("mail_unfollow_channel")) : i = je("mail_chat_sure_to_delete_all")), Object(a.C)(t) && (i = je("mail_group_sure_to_delete_all")), De(r, i, o, n, je("global_cancel"))
        }

        function un(e, t, n) {
            var r = Object(a.t)(e, t),
                i = Object(u.b)(t),
                o = i && Object(y.m)(r, 1024),
                s = je("mail_deleteall1"),
                c = je("mail_sure_to_delete_all"),
                l = je("mail_delete");
            if (i) {
                if (r.data.closed || r.data.kicked) return cn(r, t, n.bind(null, !0));
                o ? (s = je("mail_leave_channel"), c = je("mail_vkcomgroup_leave_confirm"), l = je("mail_leave_channel")) : (s = je("mail_leave_chat"), c = je("mail_chat_leave_confirm"), l = je("mail_leave_chat"))
            }
            Object(a.C)(t) && (c = je("mail_group_sure_to_delete_all"));
            var d = new MessageBox({
                title: s,
                width: o ? 450 : 500
            }).content(c).setButtons(l, function() {
                return n(!!isChecked(_e("_check_is_delete")) || !i)
            }, je("global_cancel")).show();
            return i && !o && d.setControlsText('<div class="checkbox im-delete-forall-checkbox _check_is_delete" onclick="checkbox(this);" role="checkbox" aria-checked="false">' + je("mail_deleteall1") + "</div>"), d
        }

        function ln(e) {
            return De(je("mail_unpin_title"), je("mail_unpin_text"), je("mail_unpin"), e, je("global_cancel"))
        }

        function dn(e, t, n, r) {
            var i = je("mail_dialog_msg_delete_N", t),
                o = De(je("mail_dialog_msg_delete_title"), i, je("mail_delete"), function() {
                    return r(isChecked(_e("_check_forall")))
                }, je("global_cancel")),
                a = "",
                s = !1;
            return n && (a = '<div class="checkbox im-delete-forall-checkbox _check_forall" onclick="checkbox(this);" role="checkbox" aria-checked="false">' + je("mail_delete_for_all") + "</div>", s = cur.imDb.selectByKey("del_forall_checked")), o.setControlsText(a), s && checkbox(_e("_check_forall")), o
        }

        function _n(e, t, n, r, i) {
            t.showProgress(), e.set(r.bind(null, i)).then(function() {
                t.hideProgress(), t.hide(), n().removePeer(e, i), n().updateDialogFilters(e)
            })
        }

        function fn(e, t, n, r) {
            var i = e.get().tabs[t].memberIds;
            e.set(r.bind(null, "add_member", i)).then(n().showCreation)
        }

        function pn(e, t, n) {
            var r = e.get();
            if (r.active_tab === i.h && 0 === r.message_requests_cnt) return !1;
            var o = r.active_tab === i.k ? i.h : i.k;
            return e.set(n.bind(null, o)).then(function(e) {
                t().restoreDialogs(e, !0)
            })
        }

        function mn(e, t, n) {
            if (e.get().active_tab === i.h && 0 === e.get().unread_cnt) return !1;
            var r = e.get().active_tab === i.m ? i.h : i.m;
            return e.set(n.bind(null, r)).then(function(e) {
                t().restoreDialogs(e, !0)
            })
        }

        function gn(e, t, n, r) {
            if (t.get().active_tab === e) return Promise.resolve(t);
            var i = Object(a.I)(t);
            return t.set(r.bind(null, e)).then(function(e) {
                return n().restoreDialogs(e, !0, i !== Object(a.I)(e)), e
            })
        }

        function hn(e, t) {
            void 0 === t && (t = e.get().peer);
            var n = e.get().tabs[t];
            return i.j[i.i] & n.folders
        }

        function bn(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
            if (void 0 === t && (t = e.get().peer), !Object(a.D)(e)) return !1;
            var r = n || e.get().tabs[t];
            return i.j[i.n] & r.folders
        }

        function vn(e, t) {
            return !1 === ((t.get().block_states || {})[e] || {}).free
        }

        function yn(e) {
            return null != e.get().pendingForward
        }

        function On(e, t) {
            return (t.get().block_states[e] || {}).who === X.id
        }

        function jn(e, t) {
            var n = e.get().block_states;
            Object.keys(n).forEach(function(i) {
                n[i].time ? !1 === n[i].free && Date.now() - n[i].time >= 5e4 && t.push([r.Na([, 1, "gim" + e.get().gid, i, 0, ""])]) : n[i].time = Date.now()
            })
        }

        function wn(e, t, n) {
            var r = void 0;
            return !Be("al_im.php", {
                act: "a_spam",
                offset: "0",
                gid: e.get().gid
            }, {
                onDone: function(n, i) {
                    i && (r = t(n, e, i))
                },
                params: {
                    width: 638,
                    onHide: function() {
                        Ne.loaded && Ne.detachPlayer(!0), r.unmount()
                    }
                }
            }, n)
        }

        function En(e, t) {
            return kn(e.get(), t, Object(a.t)(e, t).last_seen)
        }

        function kn(e, t, n, r) {
            if (n[0]) return je("mail_header_online_status") + (Ae[n[0]] ? Cn(t, !1, !1, !0) : "");
            if (!n[1]) return "";
            var i = Ce(n[1], e.timeshift),
                o = we(Object(g.c)(e, t).sex, je("mail_last_activity_tip", "raw")).replace("{user}", "").replace("{time}", i);
            return n[2] && (o += Cn(t, !1, !1, r)), o
        }

        function Cn(e, t, n, r) {
            var i = {
                mid: e
            };
            n || (i.was = 1), t ? i.forcetoup = !0 : i.forcetodown = !0, i = Object.assign(i, r);
            var o = JSON.stringify(i).slice(1, -1).replace(/"/g, "&quot;");
            return Oe("im_wrap_mobile", {
                class: "im_status_mob_onl",
                params: o
            })
        }

        function xn(e, t) {
            var n = t.get().tabs[e];
            return Se("al_settings.php", {
                act: "blacklist_box",
                q: n.href
            }, {
                stat: ["settings.js", "settings.css"],
                dark: 1
            })
        }

        function Pn(e, t) {
            return Se("groupsedit.php", {
                act: "bl_edit",
                name: "/id" + e,
                gid: t.get().gid
            }, {
                stat: ["page.css", "ui_controls.js", "ui_controls.css"],
                dark: 1
            })
        }

        function Mn(e) {
            return e.get().gid ? "/gim" + e.get().gid : "/im"
        }

        function Tn(e, t, n, r) {
            var i = void 0;
            Qn(Be("al_im.php", {
                act: "a_important",
                offset: "0"
            }, {
                onDone: function(r, o) {
                    o && (i = n(r, e, t, o))
                },
                params: {
                    width: 638,
                    onHide: function() {
                        Ne.loaded && Ne.detachPlayer(!0)
                    },
                    onDestroy: function() {
                        i && i.unmount()
                    }
                }
            }, r), e)
        }

        function In() {
            var e = document.activeElement;
            return null !== e && ("INPUT" === e.tagName || "TEXTAREA" === e.tagName || e.getAttribute("contenteditable"))
        }

        function Sn(e, t, n) {
            var r = _e("_im_mess_" + e, n);
            return r && ge(r, "im-mess_fav", t), n
        }

        function Dn(e, t, n) {
            var r = _e("_im_unread_bar_row", t);
            if (!r) return t;
            var i, o = ue(r, "._im_mess_stack", -1),
                s = ue(r, "._im_mess_stack"),
                c = o ? de("_im_mess", o).pop() : null,
                u = s ? _e("_im_mess", s) : null;
            if (Z(r), (i = _e("_im_invisible_bar", t)) && (me(i, "_im_invisible_bar"), me(i, "im-page--history-new-bar_hide")), !u || !c) return t;
            var l = le(u, "msgid"),
                d = Object(a.q)(e, n, l),
                _ = Object(a.m)(e, n, l);
            if (!d || wt(e.tabs[n], d, _, e)) return t;
            var f = _e("_im_stack_messages", o),
                p = _e("_im_stack_messages", s).children;
            return Object(m.p)(p).forEach(function(e) {
                Z(e), f.appendChild(e)
            }), Z(s), t
        }

        function Bn(e, t, n) {
            var r = Object(a.h)(e, e.get().peer);
            if (!r) return [!1, 0];
            var i = _e("_im_mess_" + r, t);
            if (!i) {
                var o = Object(a.k)(e, e.get().peer, r);
                if (!o) return [!0, 0];
                i = _e("_im_mess_" + o.messageId, t)
            }
            var s = he(i, "_im_mess_srv") ? i : fe("_im_mess_stack", i);
            if (!s) return [!0, 0];
            var c = i ? i.offsetTop : 0,
                u = s.offsetTop + c,
                l = n.contHeight();
            return u <= n.scrollTop() + n.getScrollHeight() ? [!0, 0] : [!1, Math.max(0, l - u)]
        }

        function Ln(e, t, n) {
            Ke(t);
            var r = fe("_im_top_notice", n);
            He(r, 200, Z.pbind(r));
            var i = fe("_im_page_dialogs", r);
            i && he(i, "im-page--dialogs-notice") && me(i, "im-page--dialogs-notice"), Ie.post("al_im.php", {
                act: "a_hide_top_notice",
                type: r.getAttribute("data-type"),
                hash: r.getAttribute("data-hash")
            })
        }

        function An(e, t, n) {
            Ke(t);
            var r = fe("_im_aside_notice", n);
            We(r, 200, Z.pbind(r)), Ie.post("al_im.php", {
                act: "a_hide_top_notice",
                type: r.getAttribute("data-type"),
                hash: r.getAttribute("data-hash")
            })
        }

        function Rn(e, t) {
            Ke(e);
            var n = fe("_im_aside_promo_block", t);
            We(n, 200, Z.pbind(n)), Ie.post("al_im.php", {
                act: "a_hide_promo_block",
                type: n.getAttribute("data-type"),
                hash: n.getAttribute("data-hash")
            })
        }

        function Nn(e, t) {
            fe("_im_aside_promo_block", t).classList.add("--action-called"), Ie.post("al_im.php", {
                act: "a_vkadmin_app_install",
                hash: le(t, "hash"),
                platform: le(t, "platform")
            })
        }

        function Un(e, t, n, r, i) {
            return n = n.replace(/\<br\s*\/?\>(\n)?/gi, " ").replace(/[\n\r]/gi, " "), n = Object(c.f)(n, function(e, t, n, r, i) {
                return i
            }), r && (n = Ue.emojiToHTML(n, !0)), t && "..." !== t.trim() && !Object(u.b)(e) && (n = Oe("im_topic", {
                topic: t,
                cls: "im-topic_dialog"
            }) + n), !n && i.length > 0 && (n = Oe("im_dialog_media", {
                name: Wn(i[0], i)
            })), n
        }

        function Wn(e, t) {
            var n = {
                photo: je("mail_added_photos", "raw"),
                video: je("mail_added_videos", "raw"),
                audio: je("mail_added_audios", "raw")
            };
            switch (e.type) {
                case "mail":
                case "respond":
                    var r = e.object ? e.object.fwd_count : e.id.split(";").length;
                    return ke(r, je("mail_fwd_msgs", "raw"), !0);
                case "photo":
                case "video":
                case "audio":
                    var i = t.filter(function(t) {
                        return t.type === e.type
                    }).length;
                    return ke(i, n[e.type], !0);
                case "audio_playlist":
                    return "audio_album" === e.kind ? je("mail_added_audio_album") : je("mail_added_audio_playlist");
                case "artist":
                    return je("mail_added_artist");
                case "doc":
                    switch (e.kind) {
                        case "graffiti":
                            return je("mail_added_graffiti");
                        case "audiomsg":
                            return je("mail_added_audiomsg");
                        default:
                            return je("mail_added_docs")
                    }
                case "geo":
                case "map":
                    return je("mail_added_geo");
                case "wall":
                    return je("mail_added_wall");
                case "wall_reply":
                    return je("mail_added_wall_reply");
                case "gift":
                    return je("mail_added_gift");
                case "link":
                case "share":
                    return je("mail_added_link");
                case "sticker":
                    return je("mail_added_sticker");
                case "market":
                    return je("mail_added_market_item");
                case "money_transfer":
                    return je("mail_added_money_transfer");
                case "money_request":
                    return je("mail_added_money_request");
                case "story":
                    return je("mail_added_story");
                case "mask":
                    return je("mail_added_mask");
                case "article":
                    return je("mail_added_article");
                case "call":
                    return je("mail_added_call");
                case "poll":
                    return je("mail_added_poll");
                case "podcast":
                    return je("mail_added_podcast");
                default:
                    return je("mail_added_" + e.type)
            }
            return ""
        }

        function Hn(e) {
            pe(e, "im-send-btn_loading")
        }

        function Kn(e) {
            me(e, "im-send-btn_loading")
        }

        function qn(e) {
            var t = e.get(),
                n = Object(a.p)(e);
            if (!n || !Object(h.a)(e, Object(a.o)(e))) return "";
            var r = Object(g.c)(e, n.userId);
            if (!r) return "";
            var i = function(e, t) {
                var n = "";
                if (t && Object(s.j)(t) && void 0 !== t.kludges.attach1_tr_amount) {
                    var r = "%s " + t.kludges.attach1_currency;
                    if ("RUB" === t.kludges.attach1_currency && (r = je("mail_money_amount_rub", "raw")), t.kludges.attach1_total_amount) {
                        var i = ke(t.kludges.attach1_tr_amount / 1e3, "%s", !0),
                            o = ke(t.kludges.attach1_total_amount / 1e3, r, !0);
                        n = je("mail_money_request_collected_amount_from").replace("{amount}", i).replace("{total_amount}", o)
                    } else {
                        var a = ke(t.kludges.attach1_tr_amount / 1e3, r, !0);
                        n = je("mail_money_request_collected_amount").replace("{amount}", a)
                    }
                    if (ne(t.kludges.attach1_held_amount)) {
                        var c = ke(t.kludges.attach1_held_amount / 1e3, r, !0);
                        n += " " + je("mail_money_request_held_amount").replace("{amount}", c)
                    }
                    t.text && (n += '<span class="divider"></span>' + kt(e, t.text, t.kludges)), t.kludges.attach1_total_amount && (n += Oe("im_pinned_message_media_bar", {
                        percent: Math.min(100, Math.floor(t.kludges.attach1_tr_amount / t.kludges.attach1_total_amount * 100))
                    }))
                }
                return n
            }(e, n);
            return i || (i = !(i = n.text) && n.attaches.length ? Oe("im_pinned_message_media", {
                text: Wn(n.attaches[0], n.attaches)
            }) : kt(e, i, n && n.kludges || {}) || ""), i = i.replace(/<br\s?\/?>/gi, " "), Oe("im_pinned_message", {
                date: xe(n.date, t.timeshift),
                content: i,
                link: r.link,
                name: r.name
            })
        }

        function Fn(e, t, n) {
            var r = n.getAttribute("data-info");
            r && Le(n, {
                text: r,
                className: "_im_history_tooltip",
                appendParentCls: "_im_mess_stack",
                black: 1,
                hidedt: 1e3,
                shift: [0, 4]
            })
        }

        function zn(e, t, n) {
            var r = +n.getAttribute("data-time");
            r && Le(n, {
                text: je("mail_message_edited") + " " + xe(r, e.get().timeshift),
                className: "_im_history_tooltip",
                appendParentCls: "_im_mess_stack",
                black: 1,
                shift: [0, 4]
            })
        }

        function Vn() {
            var e = getSize(_e(Q))[1];
            return e || (e = Qe), e
        }

        function Qn(e, t) {
            e.bodyNode.addEventListener("mouseover", function(e) {
                he(e.target, "_im_edit_time") ? zn(t, 0, e.target) : he(e.target, "_im_page_info") && Fn(0, 0, e.target)
            })
        }

        function Gn(e, t, n, r, i) {
            var o = e.get(),
                a = void 0;
            Qn(Be("al_im.php", {
                act: "a_get_pinned_message_box",
                chat: n,
                gid: e.get().gid,
                hash: o.tabs[n].hash
            }, {
                onDone: function(n, i) {
                    i && (a = r(n, e, t, i))
                },
                params: {
                    width: 638,
                    onHide: function() {
                        Ne.loaded && Ne.detachPlayer(!0)
                    },
                    onDestroy: function() {
                        a && a.unmount()
                    }
                }
            }, i), e)
        }

        function Xn(e, t, n) {
            var r = e.get();
            Qn(Be("al_im.php", {
                act: "a_get_replied_message_box",
                chat: r.peer,
                msgid: t,
                gid: r.gid,
                hash: r.tabs[r.peer].hash
            }, {
                onDone: function(e, t) {},
                params: {
                    width: 638,
                    onHide: function() {
                        Ne.loaded && Ne.detachPlayer(!0)
                    },
                    onDestroy: function() {}
                }
            }, n), e)
        }

        function Yn(e, t) {
            return !(!Object(u.b)(e.peerId) || !e.memberIds) && e.memberIds.indexOf(t) >= 0
        }

        function Jn(e) {
            return !Object(u.b)(e.peerId) || e.data.kicked ? 0 : e.membersCount
        }

        function Zn(e, t) {
            var n = Object(g.c)(e, t.peerId),
                r = Object(a.t)(e, t.peerId) || {};
            return n && (t.photo = t.photo || n.photo, t.name = t.name || n.name, t.href = t.link || n.link, t.sex = t.sex || n.sex), t.last_touched = r.last_touched || 0, t.verified = !!t.verified, t.lastmsg = t.lastmsg || t.lastmsg_meta && t.lastmsg_meta[0] || !1, t.folders = t.folders || null, t.unread = t.unread || 0, t.last_seen = t.last_seen || [0, 0, 0], t.online = t.last_seen && t.last_seen[0] || 0, t.out_up_to = null != t.out_up_to ? t.out_up_to : t.in_up_to || 0, Object(u.b)(t.peerId) && (t.memberIds = t.memberIds || r.memberIds || null), t
        }

        function $n(e, t) {
            for (var n in t) t.hasOwnProperty(n) && Zn(e, t[n])
        }

        function er(e, t) {
            var n = [],
                r = t.find(function(e) {
                    return "mail" === e[0]
                }),
                i = r ? r[1].split(";") : [];
            for (i.length > ze && (r[1] = i.slice(0, ze).join(";")); e.length > Fe;) {
                var o = e.substr(0, Fe).lastIndexOf(" "); - 1 == o && (o = Fe), n.push({
                    msgText: re(e.substr(0, o))
                }), e = re(e.substr(o))
            }
            for (e.length && n.push({
                    msgText: e,
                    attaches: t
                }), n.length || n.push({
                    attaches: t
                }), i = i.slice(ze); i.length; i = i.slice(ze)) n.push({
                attaches: [
                    ["mail", i.slice(0, ze).join(";")]
                ]
            });
            return n
        }

        function tr(e) {
            return e.length > Fe
        }

        function nr(e, t, n) {
            var r = !1;
            Se("al_im.php", {
                act: "a_chat_preview",
                chat_id: t.invite_chat_id,
                hash: t.invite_hash
            }, {
                stat: ["boxes.css"],
                params: {
                    dark: 1,
                    hideButtons: !0,
                    onHide: function() {
                        e.set(n), r && r.unmount()
                    }
                },
                onFail: function(e) {
                    return setTimeout(function() {
                        return De(je("global_error"), e)
                    }, 0), !0
                },
                onDone: function(t, n) {
                    r = p(t.bodyNode, e)
                }
            }, {})
        }

        function rr() {
            De(je("global_error"), je("mail_message_wait_until_uploaded"))
        }

        function ir(e, t) {
            var n = Object(a.t)(e, t.peerId) || {};
            if (!t || !Object(s.k)(t)) return !1;
            if (333 == t.peerId) return !1;
            if (Date.now() / 1e3 - t.date > 86400) return !1;
            if (tt(e, t.peerId, t.messageId)) return !1;
            if (Object(u.b)(t.peerId)) {
                if (n.data.kicked || n.data.closed) return !1
            } else if (n.block_error > 0) return !1;
            return !0
        }

        function or(e, t) {
            return t.map(function(t) {
                return Object(g.c)(e, t)
            })
        }

        function ar(e, t) {
            if ("number" != typeof e || 0 === e) return "";
            var n, r = e,
                i = [];
            if ([
                    [31536e3, je(t ? "global_years_accusative" : "global_age_years", "raw")],
                    [2592e3, je(t ? "global_months_accusative" : "global_age_months", "raw")],
                    [604800, je(t ? "global_weeks_accusative" : "global_age_weeks", "raw")],
                    [86400, je(t ? "global_days_accusative" : "global_age_days", "raw")],
                    [3600, je(t ? "global_hours_accusative" : "global_hours", "raw")],
                    [60, je(t ? "global_minutes_accusative" : "global_minutes", "raw")],
                    [1, je(t ? "global_seconds_accusative" : "global_age_seconds", "raw")]
                ].forEach(function(e) {
                    var t = j(e, 2),
                        n = t[0],
                        o = t[1],
                        a = Math.floor(r / n);
                    r %= n, a >= 1 && i.push(ke(a, o))
                }), 1 === (n = i.length)) return i.pop();
            var o = i.slice(0, n - 1).join(", "),
                a = i.pop();
            return je("global_and").replace(/{before}/gi, o).replace(/{after}/gi, a)
        }

        function sr(e, t, n, i) {
            i && !tt(e, n, i) && (Object(a.m)(e, n, i) ? (e.setState({
                msgid: i
            }), Object(o.b)({
                msgid: i
            }), t()) : e.get().longpoll.push([Object(r.Ba)(n, i)]))
        }

        function cr(e) {
            var t = _e("im-mess_is_editing");
            if (!t) return null;
            var n = e.get().tabs[e.get().peer],
                r = Object(a.P)(n.msgs[le(t, "msgid")]);
            return r && r.peerId == e.get().peer ? r : null
        }
    },
    PjZB: function(e, t, n) {
        "use strict";
        var r = n("q1tI");
        n("17x9");
        var i = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.id = Math.round(1e6 * Math.random()).toString(16), r.setSpinnerParams(n), r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                this.setSpinnerParams(e)
            }, t.prototype.setSpinnerParams = function(e) {
                this.offset = Math.round(Math.PI * e.size), this.c = .5 * e.size, this.animation = function(e, t) {
                    if (!e || !t) return "";
                    var n = Object.keys(t).map(function(e) {
                        return e + " {" + Object.keys(t[e]).map(function(n) {
                            return n + ":" + t[e][n]
                        }).join(";") + "}"
                    }).join("");
                    return "@-webkit-keyframes " + e + " {" + n + "} @keyframes " + e + " {" + n + "}"
                }("dash" + this.id, {
                    "0%": {
                        "stroke-dashoffset": this.offset
                    },
                    "50%": {
                        "stroke-dashoffset": Math.round(.25 * this.offset),
                        transform: "rotate(135deg)"
                    },
                    "100%": {
                        "stroke-dashoffset": this.offset,
                        transform: "rotate(360deg)"
                    }
                })
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.style,
                    n = e.color,
                    i = e.size,
                    o = e.duration,
                    a = e.strokeWidth,
                    s = this.id,
                    c = this.offset,
                    u = this.animation;
                return r.createElement("div", {
                    className: "Spinner",
                    style: t
                }, r.createElement("svg", {
                    className: "Spinner__svg",
                    width: i,
                    height: i,
                    viewBox: "0 0 " + i + " " + i,
                    xmlns: "http://www.w3.org/2000/svg"
                }, r.createElement("g", {
                    style: {
                        width: i,
                        height: i,
                        transformOrigin: .5 * i + "px " + .5 * i + "px"
                    }
                }, r.createElement("style", {
                    dangerouslySetInnerHTML: {
                        __html: u
                    }
                }), r.createElement("circle", {
                    className: "Spinner__path",
                    fill: "none",
                    stroke: n,
                    strokeDasharray: c,
                    strokeDashoffset: c,
                    strokeWidth: a,
                    style: {
                        animationName: "dash" + s,
                        animationTimingFunction: "ease-in-out",
                        animationDuration: o + "s",
                        animationIterationCount: "infinite"
                    },
                    cx: .5 * i,
                    cy: .5 * i,
                    r: .5 * i - .5 * a
                }))))
            }, t
        }(r.Component);
        t.a = i, i.defaultProps = {
            color: "#5181b8",
            size: 19,
            strokeWidth: 2,
            duration: 1.4
        }
    },
    QGEU: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return s
        }), n.d(t, "d", function() {
            return c
        }), n.d(t, "b", function() {
            return u
        }), n.d(t, "c", function() {
            return d
        });
        var r = n("v+DW"),
            i = n("t7n3"),
            o = n("zxIV"),
            a = n("4+be");

        function s() {
            return !(!window.vk || !vk.a11y)
        }

        function c() {
            clearTimeout(cur.updateOnlineTO), cur.updateOnlineTO = setTimeout(function() {
                Object(i.f)(Object(o.G)("_online"), function() {
                    var e = Object(o.H)("_online_reader", this) || this,
                        t = Object(o.V)(this, "online"),
                        n = Object(o.V)(this, "mobile"),
                        r = Object(o.I)("img", e),
                        s = function(e) {
                            var t = Object(o.n)("_post", e),
                                n = t && Object(o.j)(t, "author");
                            return n ? n.innerText || n.textContent : ""
                        };
                    if (t) {
                        var c = "";
                        Object(i.f)(r, function() {
                            var e = Object(o.c)(this, "alt") || Object(o.c)(this, "data-alt") || s(this);
                            e && (c = Object(i.H)(c + " " + e), this.setAttribute("data-alt", e), this.removeAttribute("alt"))
                        }), c = Object(i.H)(c + " " + (n ? Object(a.d)("global_user_is_online_mobile") : Object(a.d)("global_user_is_online"))), e.setAttribute("aria-label", c)
                    } else Object(i.f)(r, function() {
                        var e = Object(o.c)(this, "data-alt") || s(this);
                        e && (this.setAttribute("alt", e), this.removeAttribute("data-alt"))
                    }), e.removeAttribute("aria-label")
                })
            }, 100)
        }

        function u() {
            clearTimeout(cur.updateChkBoxTO), cur.updateChkBoxTO = setTimeout(function() {
                var e = [];
                Object(i.f)(["checkbox", "checkbox_pic"], function() {
                    e = e.concat(Object(o.G)(this))
                }), Object(i.f)(e, function() {
                    "DIV" !== this.tagName || this.getAttribute("role") || (this.setAttribute("role", "checkbox"), this.setAttribute("aria-checked", Object(r.l)(this) ? "true" : "false"), this.setAttribute("tabindex", 0))
                })
            }, 100)
        }

        function l() {
            clearTimeout(cur.updateRadioBtnsTO), cur.updateRadioBtnsTO = setTimeout(function() {
                var e = [],
                    t = Object(o.G)("radiobtn");
                Object(i.f)(t, function() {
                    if ("DIV" === this.tagName && !this.getAttribute("role")) {
                        var t = Object(r.l)(this);
                        this.setAttribute("role", "radio"), this.setAttribute("aria-checked", t ? "true" : "false"), this.setAttribute("tabindex", t ? 0 : -1);
                        var n = function(e) {
                            var t = 0,
                                n = e;
                            for (; t < 5 && n !== document;) {
                                n = Object(o.z)(n);
                                var r = Object(o.G)("radiobtn", n);
                                if (r.length > 1) break;
                                t++
                            }
                            return n
                        }(this);
                        ~e.indexOf(n) || e.push(n)
                    }
                }), Object(i.f)(e, function() {
                    if (!Object(o.G)("on", this).length) {
                        var e = Object(o.G)("radiobtn", this);
                        e.length && e[0].setAttribute("tabindex", 0)
                    }
                })
            }, 100)
        }

        function d() {
            c(), u(), l()
        }
    },
    QOPk: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return r
        });
        var r = function() {
            var e = function() {
                    for (var e = void 0, t = void 0, n = [
                            ["requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror"],
                            ["webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror"],
                            ["mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror"],
                            ["msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError"]
                        ], r = 0, i = n.length, o = {}; r < i; r++)
                        if ((e = n[r]) && e[1] in document) {
                            for (r = 0, t = e.length; r < t; r++) o[n[0][r]] = e[r];
                            return o
                        }
                    return !1
                }(),
                t = {
                    request: function(t) {
                        var n = e.requestFullscreen;
                        (t = t || document.documentElement)[n]()
                    },
                    exit: function() {
                        document[e.exitFullscreen]()
                    },
                    toggle: function(e) {
                        this.isFullscreen ? this.exit() : this.request(e)
                    },
                    raw: e
                };
            return !!e && (Object.defineProperties(t, {
                isFullscreen: {
                    get: function() {
                        return Boolean(document[e.fullscreenElement])
                    }
                },
                element: {
                    enumerable: !0,
                    get: function() {
                        return document[e.fullscreenElement]
                    }
                },
                enabled: {
                    enumerable: !0,
                    get: function() {
                        return Boolean(document[e.fullscreenEnabled])
                    }
                }
            }), t)
        }()
    },
    QaDb: function(e, t, n) {
        "use strict";
        var r = n("Kuth"),
            i = n("RjD/"),
            o = n("fyDq"),
            a = {};
        n("Mukb")(a, n("K0xU")("iterator"), function() {
            return this
        }), e.exports = function(e, t, n) {
            e.prototype = r(a, {
                next: i(1, n)
            }), o(e, t + " Iterator")
        }
    },
    RYi7: function(e, t) {
        var n = Math.ceil,
            r = Math.floor;
        e.exports = function(e) {
            return isNaN(e = +e) ? 0 : (e > 0 ? r : n)(e)
        }
    },
    "RjD/": function(e, t) {
        e.exports = function(e, t) {
            return {
                enumerable: !(1 & e),
                configurable: !(2 & e),
                writable: !(4 & e),
                value: t
            }
        }
    },
    "S/j/": function(e, t, n) {
        var r = n("vhPU");
        e.exports = function(e) {
            return Object(r(e))
        }
    },
    SlkY: function(e, t, n) {
        var r = n("m0Pp"),
            i = n("H6hf"),
            o = n("M6Qj"),
            a = n("y3w9"),
            s = n("ne8i"),
            c = n("J+6e");
        e.exports = function(e, t, n, u, l) {
            var d, _, f, p = l ? function() {
                    return e
                } : c(e),
                m = r(n, u, t ? 2 : 1),
                g = 0;
            if ("function" != typeof p) throw TypeError(e + " is not iterable!");
            if (o(p))
                for (d = s(e.length); d > g; g++) t ? m(a(_ = e[g])[0], _[1]) : m(e[g]);
            else
                for (f = p.call(e); !(_ = f.next()).done;) i(f, m, _.value, t)
        }
    },
    "T/g7": function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return s
        });
        var r = n("nAFc"),
            i = {},
            o = window.getLang,
            a = window.langNumeric;

        function s(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
                n = arguments[2],
                s = "number" == typeof t,
                c = e + (t || s ? ".raw" : "");
            if (void 0 === i[c]) {
                var u = t || s ? o(e, "raw") : o(e);
                "string" == typeof u ? i[c] = Object(r.a)(u) : Array.isArray(u) && (i[c] = u.map(r.a))
            }
            return s ? a(t, i[c], n) : i[c] || ""
        }
        t.a = {
            getLang: s
        }
    },
    ThPM: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR"));
        var o = function(e) {
            function t() {
                return function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t),
                    function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.apply(this, arguments))
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.photos,
                    n = e.links,
                    o = e.className,
                    a = Object(i.a)("MembersGrid", "MembersGrid--" + Math.min(t.length, 4), o);
                return r.createElement("div", {
                    className: a
                }, t.map(function(e, t) {
                    var i = n && n[t] ? n[t] : void 0,
                        o = i ? "a" : "span";
                    return r.createElement(o, {
                        key: t,
                        href: i,
                        className: "MembersGrid__i",
                        style: {
                            backgroundImage: "url(" + e + ")"
                        }
                    })
                }))
            }, t
        }(r.Component);
        t.a = o, o.defaultProps = {
            links: [],
            className: ""
        }
    },
    UqcF: function(e, t) {
        t.f = {}.propertyIsEnumerable
    },
    VTer: function(e, t, n) {
        var r = n("dyZX"),
            i = r["__core-js_shared__"] || (r["__core-js_shared__"] = {});
        e.exports = function(e) {
            return i[e] || (i[e] = {})
        }
    },
    WDXI: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = n("i8i4"),
            o = (n("17x9"), n("pemR")),
            a = n("MV/q");
        var s = window.elfocus,
            c = {
                height: "auto"
            },
            u = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.onChange = function(e) {
                        r.props.onChange ? r.props.onChange(e) : r.setState({
                            value: e.target.value,
                            changed: r.props.value !== r.state.value
                        })
                    }, r.onClick = function() {
                        r.setState({
                            editing: !0
                        }, function() {
                            r.textarea && s(r.textarea)
                        })
                    }, r.onBlur = function() {
                        r.state.changed || r.setState({
                            editing: !1
                        })
                    }, r.onSave = function() {
                        r.props.validate && !r.props.validate(r.state.value) || (r.setState({
                            editing: !1,
                            changed: !1
                        }), r.props.onSave && r.props.onSave({
                            value: r.state.value
                        }))
                    }, r.onKeydown = function(e) {
                        r.state.editing && (27 === e.keyCode && (r.props.onCancel && r.props.onCancel(), r.setState({
                            editing: !1,
                            changed: !1,
                            value: r.props.value
                        }), e.preventDefault(), e.stopPropagation()), r.props.useEnter && 13 === e.keyCode && (r.onSave(), e.preventDefault(), e.stopPropagation()))
                    }, r.getRef = function(e) {
                        e && e.element && (r.textarea = e.element)
                    }, r.state = {
                        value: n.value,
                        editing: !1,
                        changed: !!n.onChange && n.changed
                    }, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                    this.setState({
                        value: e.value,
                        changed: e.onChange ? e.changed : e.value === this.state.value
                    })
                }, t.prototype.componentDidMount = function() {
                    this.el = i.findDOMNode(this), this.el.addEventListener("keydown", this.onKeydown)
                }, t.prototype.componentWillUnmount = function() {
                    this.el.removeEventListener("keydown", this.onKeydown)
                }, t.prototype.render = function() {
                    var e = this.props,
                        t = e.className,
                        n = e.validate,
                        i = this.state,
                        s = i.editing,
                        u = i.changed,
                        l = i.value,
                        d = Object(o.a)("EditableLabel", {
                            "EditableLabel--editing": s,
                            "EditableLabel--changed": u,
                            "EditableLabel--invalid": n && !n(l)
                        }, t);
                    return r.createElement("div", {
                        className: d
                    }, s ? r.createElement(r.Fragment, null, r.createElement(a.a, {
                        className: "EditableLabel__textarea",
                        onChange: this.onChange,
                        onInput: this.onChange,
                        onPaste: this.onChange,
                        value: l,
                        onBlur: this.onBlur,
                        style: c,
                        rows: "1",
                        ref: this.getRef
                    }), u && r.createElement("button", {
                        className: "EditableLabel__save",
                        onClick: this.onSave
                    })) : r.createElement("div", {
                        className: "EditableLabel__text",
                        onClick: this.onClick
                    }, l))
                }, t
            }(r.Component);
        t.a = u, u.defaultProps = {
            value: "",
            changed: !1,
            useEnter: !1
        }
    },
    WbBG: function(e, t, n) {
        "use strict";
        e.exports = "SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"
    },
    Wu9C: function(e, t, n) {
        "use strict";
        var r = n("N1NS"),
            i = n("vT4u");

        function o(e) {
            return {
                unmount: function() {
                    Object(r.c)(e)
                }
            }
        }

        function a(e, t, n) {
            return (0, Object(r.b)(o).bindMutations)(Object(r.a)({
                handlers: function(e, t) {}
            }))
        }
        var s = n("P13b"),
            c = n("rHUl"),
            u = n("aong"),
            l = n("uytb");
        n.d(t, "a", function() {
            return f
        }), n.d(t, "c", function() {
            return p
        }), n.d(t, "d", function() {
            return m
        }), n.d(t, "e", function() {
            return g
        }), n.d(t, "b", function() {
            return v
        });
        var d = "_im_pin_hide",
            _ = "_im_pinned_message";

        function f(e, t) {
            if (Object(u.r)(e).searchShown) return !1;
            var n = Object(c.t)(e, t),
                r = n && Object(c.P)(n.pinned);
            return !!r && n.pinHideId != r.chat_local_id
        }

        function p(e, t, n) {
            var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
                i = Object(c.t)(e, t),
                o = i && Object(c.P)(i.pinned);
            i && o && (i.pinHideId = o.chat_local_id, cur.imDb.update(l.a, [i.peerId, i.pinHideId]), h(n, t, e), re(geByClass1("_im_pinned_tt")), r && window.Notifier && Notifier.lcSend("pin_hide", {
                hide: 1,
                peer: t
            }), statlogsValueEvent("im_pinned_messages", "hide"))
        }

        function m(e, t, n) {
            var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
                i = Object(c.t)(e, t);
            i && i.pinHideId && (delete i.pinHideId, cur.imDb.update(l.a, [i.peerId, void 0]), h(n, t, e), r && window.Notifier && Notifier.lcSend("pin_hide", {
                hide: 0,
                peer: t
            }), statlogsValueEvent("im_pinned_messages", "show"))
        }

        function g(e, t, n) {
            var r = h.bind(null, n, t),
                o = Object(s.Xb)(function() {
                    o.hideProgress(), o.hide(), e.set(i.nc.bind(null, t)).then(r).then(function(e) {
                        return e.set(i.mc.bind(null, t))
                    }).then(r)
                })
        }

        function h(e, t, n) {
            return e().updateChatTopic(t, n), Object(i.Ob)(n.get()), e().updateActions(n), n
        }

        function b(e) {
            return {
                unmount: function() {
                    Object(r.c)(e)
                }
            }
        }

        function v(e, t, n) {
            var i = Object(r.b)(b).bindMutations,
                o = function(e, t, n) {
                    var r = e.get().peer,
                        i = Object(c.P)(Object(c.t)(e, r).pinned);
                    if (n.target.classList.contains(d)) i && p(e, r, t);
                    else if ("A" !== n.target.tagName) {
                        var o = i && i.messageId;
                        o && !Object(s.Fa)(e, r, o) ? Object(s.M)(e, t().focusOnMessage, r, o) : Object(s.Ub)(e, t, r, a, n), statlogsValueEvent("im_pinned_messages", "open")
                    }
                }.bind(null, t, n),
                u = function(e) {
                    showTooltip(e.target, {
                        text: getLang("mail_hide_unpin_hover"),
                        black: 1,
                        needLeft: 1,
                        shift: [8, 4],
                        forcetoup: !0,
                        className: "_im_pinned_tt",
                        appendEl: bodyNode
                    })
                }.bind(null);
            return i(Object(r.a)({
                handlers: function(t, n) {
                    n(e, "click", _, o), n(e, "mouseover", d, u)
                }
            }))
        }
    },
    XKFU: function(e, t, n) {
        var r = n("dyZX"),
            i = n("g3g5"),
            o = n("Mukb"),
            a = n("KroJ"),
            s = n("m0Pp"),
            c = function(e, t, n) {
                var u, l, d, _, f = e & c.F,
                    p = e & c.G,
                    m = e & c.S,
                    g = e & c.P,
                    h = e & c.B,
                    b = p ? r : m ? r[t] || (r[t] = {}) : (r[t] || {}).prototype,
                    v = p ? i : i[t] || (i[t] = {}),
                    y = v.prototype || (v.prototype = {});
                for (u in p && (n = t), n) d = ((l = !f && b && void 0 !== b[u]) ? b : n)[u], _ = h && l ? s(d, r) : g && "function" == typeof d ? s(Function.call, d) : d, b && a(b, u, d, e & c.U), v[u] != d && o(v, u, _), g && y[u] != d && (y[u] = d)
            };
        r.core = i, c.F = 1, c.G = 2, c.S = 4, c.P = 8, c.B = 16, c.W = 32, c.U = 64, c.R = 128, e.exports = c
    },
    XMVh: function(e, t, n) {
        var r = n("K0xU")("iterator"),
            i = !1;
        try {
            var o = [7][r]();
            o.return = function() {
                i = !0
            }, Array.from(o, function() {
                throw 2
            })
        } catch (e) {}
        e.exports = function(e, t) {
            if (!t && !i) return !1;
            var n = !1;
            try {
                var o = [7],
                    a = o[r]();
                a.next = function() {
                    n = !0
                }, o[r] = function() {
                    return a
                }, e(o)
            } catch (e) {}
            return n
        }
    },
    XTb9: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR")),
            o = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };
        var a = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onTransitionEnd = function(e) {
                    r.state.shown && "opacity" === e.propertyName && (r.timeout = setTimeout(function() {
                        r.setState({
                            shown: !1
                        }), r.props.callback()
                    }, r.props.duration))
                }, r.state = {
                    shown: n.shown
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                !this.props.shown && e.shown && this.setState({
                    shown: !0
                })
            }, t.prototype.componentWillUnmount = function() {
                this.timeout && clearTimeout(this.timeout)
            }, t.prototype.render = function() {
                var e = this.props,
                    t = (e.shown, e.callback, e.duration, e.className),
                    n = e.children,
                    a = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["shown", "callback", "duration", "className", "children"]),
                    s = Object(i.a)("BlinkText", {
                        "BlinkText--shown": this.state.shown
                    }, t);
                return r.createElement("span", o({}, a, {
                    className: s,
                    onTransitionEnd: this.onTransitionEnd,
                    "aria-hidden": !0
                }), n)
            }, t
        }(r.Component);
        t.a = a, a.defaultProps = {
            duration: 2e3
        }
    },
    Xbzi: function(e, t, n) {
        var r = n("0/R4"),
            i = n("i5dc").set;
        e.exports = function(e, t, n) {
            var o, a = t.constructor;
            return a !== n && "function" == typeof a && (o = a.prototype) !== n.prototype && r(o) && i && i(e, o), e
        }
    },
    XfO3: function(e, t, n) {
        "use strict";
        var r = n("AvRE")(!0);
        n("Afnz")(String, "String", function(e) {
            this._t = String(e), this._i = 0
        }, function() {
            var e, t = this._t,
                n = this._i;
            return n >= t.length ? {
                value: void 0,
                done: !0
            } : (e = r(t, n), this._i += e.length, {
                value: e,
                done: !1
            })
        })
    },
    XpgC: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = n("i8i4"),
            o = (n("17x9"), n("pemR")),
            a = n("clTp");
        var s = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var i = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return i.onMouseEnter = function(e) {
                    if (i.el) {
                        var t = i.props,
                            n = t.text,
                            r = t.position,
                            o = t.align,
                            s = t.marginTop,
                            c = t.marginLeft,
                            u = Object(a.a)(i.el);
                        i.update({
                            text: n,
                            position: r,
                            align: o,
                            rect: u,
                            marginTop: s,
                            marginLeft: c
                        })
                    }
                }, i.onMouseLeave = function(e) {
                    return i.update()
                }, i.onTransitionEnd = function(e) {
                    "visibility" === e.propertyName && i.state.tooltip && i.setState({
                        tooltip: void 0
                    })
                }, i.renderTooltip = function() {
                    if (!i.state.tooltip) return null;
                    var e, t, n, a = i.state.tooltip,
                        s = a.x,
                        c = a.y,
                        u = a.position,
                        l = a.align,
                        d = a.text,
                        _ = a.removed,
                        f = Object(o.a)("Tooltip", "Tooltip--" + u, (e = {
                            "Tooltip--removed": !!_
                        }, t = "Tooltip--align-" + l, n = "t" === u || "b" === u, t in e ? Object.defineProperty(e, t, {
                            value: n,
                            enumerable: !0,
                            configurable: !0,
                            writable: !0
                        }) : e[t] = n, e));
                    return r.createElement("div", {
                        className: f,
                        style: {
                            top: c,
                            left: s
                        },
                        onTransitionEnd: i.onTransitionEnd
                    }, r.createElement("div", {
                        className: "Tooltip__in",
                        dangerouslySetInnerHTML: {
                            __html: d
                        }
                    }))
                }, i.state = {}, i
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                this.el = i.findDOMNode(this), this.el.addEventListener("mouseenter", this.onMouseEnter), this.el.addEventListener("mouseleave", this.onMouseLeave)
            }, t.prototype.componentWillUnmount = function() {
                this.el.removeEventListener("mouseenter", this.onMouseEnter), this.el.removeEventListener("mouseleave", this.onMouseLeave)
            }, t.prototype.update = function(e) {
                if (!e) return this.setState({
                    tooltip: Object.assign({}, this.state.tooltip, {
                        removed: !0
                    })
                });
                var t = e.position,
                    n = e.align,
                    r = e.text,
                    i = e.rect,
                    o = e.marginTop,
                    a = e.marginLeft,
                    s = i.left,
                    c = i.top;
                switch (t) {
                    case "t":
                        s += .5 * i.width;
                        break;
                    case "r":
                        s += i.width, c += .5 * i.height;
                        break;
                    case "b":
                        s += .5 * i.width, c += i.height;
                        break;
                    case "l":
                        c += .5 * i.height
                }
                s = Math.round(s + a), c = Math.round(c + o), this.setState({
                    tooltip: {
                        position: t,
                        align: n,
                        text: r,
                        x: s,
                        y: c
                    }
                })
            }, t.prototype.render = function() {
                var e = this.renderTooltip();
                return e ? (this.defaultNode || "undefined" == typeof window || (this.defaultNode = document.createElement("div"), document.body.appendChild(this.defaultNode)), r.createElement(r.Fragment, null, this.props.children, i.createPortal(e, this.defaultNode))) : this.props.children
            }, t
        }(r.Component);
        t.a = s, s.defaultProps = {
            position: "b",
            align: "center",
            marginTop: 0,
            marginLeft: 0
        }
    },
    YTvA: function(e, t, n) {
        var r = n("VTer")("keys"),
            i = n("ylqs");
        e.exports = function(e) {
            return r[e] || (r[e] = i(e))
        }
    },
    Ymqv: function(e, t, n) {
        var r = n("LZWt");
        e.exports = Object("z").propertyIsEnumerable(0) ? Object : function(e) {
            return "String" == r(e) ? e.split("") : Object(e)
        }
    },
    Z6vF: function(e, t, n) {
        var r = n("ylqs")("meta"),
            i = n("0/R4"),
            o = n("aagx"),
            a = n("hswa").f,
            s = 0,
            c = Object.isExtensible || function() {
                return !0
            },
            u = !n("eeVq")(function() {
                return c(Object.preventExtensions({}))
            }),
            l = function(e) {
                a(e, r, {
                    value: {
                        i: "O" + ++s,
                        w: {}
                    }
                })
            },
            d = e.exports = {
                KEY: r,
                NEED: !1,
                fastKey: function(e, t) {
                    if (!i(e)) return "symbol" == typeof e ? e : ("string" == typeof e ? "S" : "P") + e;
                    if (!o(e, r)) {
                        if (!c(e)) return "F";
                        if (!t) return "E";
                        l(e)
                    }
                    return e[r].i
                },
                getWeak: function(e, t) {
                    if (!o(e, r)) {
                        if (!c(e)) return !0;
                        if (!t) return !1;
                        l(e)
                    }
                    return e[r].w
                },
                onFreeze: function(e) {
                    return u && d.NEED && c(e) && !o(e, r) && l(e), e
                }
            }
    },
    aCFj: function(e, t, n) {
        var r = n("Ymqv"),
            i = n("vhPU");
        e.exports = function(e) {
            return r(i(e))
        }
    },
    aagx: function(e, t) {
        var n = {}.hasOwnProperty;
        e.exports = function(e, t) {
            return n.call(e, t)
        }
    },
    aong: function(__webpack_module__, __webpack_exports__, __webpack_require__) {
        "use strict";
        __webpack_require__.d(__webpack_exports__, "o", function() {
            return throttleAccumulate
        }), __webpack_require__.d(__webpack_exports__, "i", function() {
            return lplog
        }), __webpack_require__.d(__webpack_exports__, "p", function() {
            return toArray
        }), __webpack_require__.d(__webpack_exports__, "a", function() {
            return arrayUnique
        }), __webpack_require__.d(__webpack_exports__, "r", function() {
            return unpackStore
        }), __webpack_require__.d(__webpack_exports__, "c", function() {
            return debounce
        }), __webpack_require__.d(__webpack_exports__, "n", function() {
            return throttle
        }), __webpack_require__.d(__webpack_exports__, "m", function() {
            return shuffle
        }), __webpack_require__.d(__webpack_exports__, "k", function() {
            return parallel
        }), __webpack_require__.d(__webpack_exports__, "g", function() {
            return hashCode
        }), __webpack_require__.d(__webpack_exports__, "l", function() {
            return parseJSON
        }), __webpack_require__.d(__webpack_exports__, "b", function() {
            return checkTextLength
        }), __webpack_require__.d(__webpack_exports__, "d", function() {
            return getSelectionText
        }), __webpack_require__.d(__webpack_exports__, "e", function() {
            return goAway
        }), __webpack_require__.d(__webpack_exports__, "h", function() {
            return isFullScreen
        }), __webpack_require__.d(__webpack_exports__, "s", function() {
            return updateMoney
        }), __webpack_require__.d(__webpack_exports__, "q", function() {
            return toggleOnline
        }), __webpack_require__.d(__webpack_exports__, "j", function() {
            return onlinePlatformClass
        }), __webpack_require__.d(__webpack_exports__, "f", function() {
            return handleScroll
        });
        var _utils_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("t7n3"),
            _ui_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("ryw6"),
            _debug_tools__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("98sY"),
            _cookies__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("kMSP"),
            _ajax__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("Kngp"),
            _message_box__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("EasH"),
            _dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("zxIV"),
            _lang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("4+be"),
            _browser__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("gdug"),
            _accessibility__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("QGEU"),
            _dom_events__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("Egk5"),
            _scroll__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("lXE5");

        function throttleAccumulate(e, t) {
            var n = [],
                r = 0;
            return function(i) {
                n.push(i), r || (r = setTimeout(function() {
                    r = !1, e(n), n = []
                }, t))
            }
        }

        function executionStackPop(e) {
            return e.length > 0 && e.pop().func(), e
        }

        function lplog(e, t) {
            var n = void 0,
                r = void 0;
            if (window.__debugMode) {
                switch (t) {
                    case "error":
                        n = "color: red", r = "background: red; color: white";
                        break;
                    case "success":
                        n = "color: green", r = "background: green; color: white";
                        break;
                    default:
                        n = "color: blue;", r = "background: #000; color: #fff;"
                }
                try {
                    var i = new Date;
                    console.debug("%cLP:[" + i.getHours() + ":" + i.getMinutes() + ":" + i.getSeconds() + ":" + i.getMilliseconds() + "]%c " + e, r, n)
                } catch (e) {}
            }
        }

        function toArray(e) {
            var t = [];
            if (void 0 === e.length) return Object.keys(e).map(function(t) {
                return e[t]
            });
            for (var n = 0; n < e.length; n++) t.push(e[n]);
            return t
        }

        function arrayUnique(e) {
            for (var t = {}, n = [], r = 0; r < e.length; r++) t[e[r]] || (n.push(e[r]), t[n[r]] = 1);
            return n
        }

        function unpackStore(e) {
            return e.get ? e.get() : e
        }

        function debounce(e, t, n) {
            var r = void 0;
            return function() {
                var i = this,
                    o = arguments,
                    a = n && !r;
                clearTimeout(r), r = setTimeout(function() {
                    r = null, n || e.apply(i, o)
                }, t), a && e.apply(this, o)
            }
        }

        function throttle(e, t) {
            var n = void 0;
            return function() {
                n || (e.apply(this, arguments), n = setTimeout(function() {
                    n = !1
                }, t))
            }
        }

        function shuffle(e) {
            for (var t = e.length; t > 0;) {
                var n = Math.floor(Math.random() * t),
                    r = e[--t];
                e[t] = e[n], e[n] = r
            }
            return e
        }

        function parallel() {
            var e = [].slice.call(arguments),
                t = e.pop(),
                n = new CallHub(t, e.length);
            Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.f)(e, function(e, t) {
                return t(function() {
                    return n.done()
                })
            })
        }

        function hashCode(e) {
            var t = 0;
            if (0 === e.length) return t;
            for (var n = 0, r = e.length; n < r; n++) {
                t = (t << 5) - t + e.charCodeAt(n), t |= 0
            }
            return t
        }

        function parseJSON(obj) {
            if (window.JSON && JSON.parse) try {
                return JSON.parse(obj)
            } catch (e) {
                Object(_ui_util__WEBPACK_IMPORTED_MODULE_1__.c)("<b>parseJSON:</b> " + e.message, {
                    dt: -1,
                    type: 5,
                    answer: obj
                });
                var evalString = "(" + obj + ")";
                try {
                    return eval(evalString)
                } catch (e) {
                    if (__debugMode) throw e;
                    Object(_debug_tools__WEBPACK_IMPORTED_MODULE_2__.d)(e, evalString)
                }
            } else {
                var _evalString = "(" + obj + ")";
                try {
                    return eval(_evalString)
                } catch (e) {
                    if (__debugMode) throw e;
                    Object(_debug_tools__WEBPACK_IMPORTED_MODULE_2__.d)(e, _evalString)
                }
            }
        }

        function checkTextLength(e, t, n, r, i, o, a) {
            var s = t.getValue ? t.getValue() : t.value,
                c = t.lastLen || 0;
            if (t.lastLen !== s.length || o) {
                t.lastLen = s.length;
                var u = {
                        "&": 5,
                        "<": 4,
                        ">": 4,
                        '"': 6,
                        "\n": r ? 1 : 4,
                        "\r": 0,
                        "!": 5,
                        "'": 5,
                        $: 6,
                        "\\": 6
                    },
                    l = {
                        1168: 1,
                        1169: 1,
                        8211: 1,
                        8212: 1,
                        8216: 1,
                        8217: 1,
                        8218: 1,
                        8230: 1,
                        8240: 1,
                        8249: 1,
                        8250: 1,
                        8364: 1,
                        8470: 1,
                        8482: 1,
                        65533: 1
                    },
                    d = {
                        1037: 1,
                        1104: 1,
                        1117: 1
                    };
                i && (u[","] = 5);
                var _ = function(e) {
                    for (var t = 0, n = 0, r = e.length; n < r; n++) {
                        var i = u[e.charAt(n)],
                            o = e.charCodeAt(n);
                        t += void 0 !== i ? i : !a && o >= 128 && (o < 1025 || d[o] || o > 1119) && !l[o] && (o < 8220 || o > 8222) && (o < 8224 || o > 8226) ? ("&#" + o + ";").length : 1
                    }
                    return t
                }(s);
                if (n = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.F)(n), _ > Math.max(e - 100, .75 * e))
                    if (Object(_dom__WEBPACK_IMPORTED_MODULE_6__.Ta)(n), _ > e)
                        if (i) {
                            var f = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.Ya)(t, function(e, t) {
                                for (var n = 0, r = "", i = 0, o = e.length; i < o; i++) {
                                    var s = e.charAt(i),
                                        c = u[s],
                                        _ = e.charCodeAt(i);
                                    if ((n += void 0 !== c ? c : !a && _ >= 128 && (_ < 1025 || d[_] || _ > 1119) && !l[_] && (_ < 8220 || _ > 8222) && (_ < 8224 || _ > 8226) ? ("&#" + _ + ";").length : 1) > t) break;
                                    r += s
                                }
                                return r
                            }(s, Math.min(e, c)));
                            t.lastLen = f.length, n.innerHTML = Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("text_N_symbols_remain", 0)
                        } else n.innerHTML = Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("text_exceeds_symbol_limit", _ - e);
                else n.innerHTML = Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("text_N_symbols_remain", e - _);
                else Object(_dom__WEBPACK_IMPORTED_MODULE_6__.W)(n)
            }
        }

        function getSelectionText() {
            var e = "";
            return window.getSelection ? e = window.getSelection().toString() : document.selection && "Control" !== document.selection.type && (e = document.selection.createRange().text), e
        }

        function goAway(e, t, n) {
            if (-1 !== (t || {}).h || Object(_dom_events__WEBPACK_IMPORTED_MODULE_10__.d)(n)) return !0;
            if (-1 !== (t || {}).h) {
                var r = e.match(/https?:\/\/([a-zA-Z0-9\-_\.]+\.)?(vk\.com|vkontakte\.ru)(\/|$)/i);
                if (r && "api." !== r[1].toLowerCase()) return location.href = e, !1;
                var i = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.r)(Object(_cookies__WEBPACK_IMPORTED_MODULE_3__.a)("remixsettings_bits"));
                if (/https?:\/\/([a-zA-Z0-9\-_]+\.)(vk\.com|vkontakte\.ru)(\/|$)/i.test(_ajax__WEBPACK_IMPORTED_MODULE_4__.d) || 1 & i) return window.open("/away.php?to=" + encodeURIComponent(e) + (t && void 0 !== t.h ? "&h=" + t.h : ""), "_blank"), !1
            }
            var o = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.i)({
                act: "a_go",
                to: e
            }, t || {});
            return !Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.b)("away.php", o, {}, n)
        }

        function isFullScreen() {
            return !!(document.fullscreenElement || document.fullScreenElement || document.msFullscreenElement || document.mozFullScreen || document.webkitIsFullScreen || cur.pvPartScreen)
        }

        function updateMoney(e, t) {
            if (void 0 !== e && !1 !== e) {
                var n = "";
                !0 === t ? (vk.balanceEx = e, n = "_ex") : vk.balance = e;
                var r = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.G)("votes_balance_nom" + n);
                Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.f)(r, function(t, n) {
                    return n.innerHTML = e + " " + Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("votes_flex", e)
                });
                var i = e * (vk.vcost || 7),
                    o = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.G)("money_balance_nom" + n);
                Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.f)(o, function(e, t) {
                    return t.innerHTML = Object(_lang__WEBPACK_IMPORTED_MODULE_7__.d)("global_money_amount_rub", i, !0)
                }), void 0 !== t && !1 !== t && !0 !== t && updateMoney(t, !0)
            }
        }

        function toggleOnline(e, t) {
            var n = onlinePlatformClass(t).split(" "),
                r = [];
            ["online", "mobile", "_online"].forEach(function(t) {
                Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.o)(t, n) && !Object(_dom__WEBPACK_IMPORTED_MODULE_6__.V)(e, t) ? r.push(t) : !Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.o)(t, n) && Object(_dom__WEBPACK_IMPORTED_MODULE_6__.V)(e, t) && Object(_dom__WEBPACK_IMPORTED_MODULE_6__.Ha)(e, t)
            }), r.length > 0 && Object(_dom__WEBPACK_IMPORTED_MODULE_6__.a)(e, r.join(" "))
        }

        function onlinePlatformClass(e) {
            var t = " _online";
            return e && (t += " online"), _browser__WEBPACK_IMPORTED_MODULE_8__.d[e] && (t += " mobile"), Object(_accessibility__WEBPACK_IMPORTED_MODULE_9__.d)(), t
        }

        function handleScroll(e) {
            e = e.split(",");
            var t = cur.named || {},
                n = e[0] && (t[e[0]] || Object(_dom__WEBPACK_IMPORTED_MODULE_6__.F)(e[0])) || !1,
                r = e[1] && (t[e[1]] || Object(_dom__WEBPACK_IMPORTED_MODULE_6__.F)(e[1])) || !1;
            if (!n && !r) {
                if (!(n = document.getElementsByName(e[0])[0])) return;
                n = n.nextSibling
            }
            var i = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.F)("page_header_wrap") || Object(_dom__WEBPACK_IMPORTED_MODULE_6__.F)("dev_top_nav_wrap");
            setTimeout(function() {
                n && Object(_scroll__WEBPACK_IMPORTED_MODULE_11__.g)(Object(_dom__WEBPACK_IMPORTED_MODULE_6__.Q)(n)[1] - (i ? Object(_dom__WEBPACK_IMPORTED_MODULE_6__.N)(i)[1] : 0), 0), r && Object(_dom__WEBPACK_IMPORTED_MODULE_6__.E)(r)
            }, 300)
        }
    },
    apmT: function(e, t, n) {
        var r = n("0/R4");
        e.exports = function(e, t) {
            if (!r(e)) return e;
            var n, i;
            if (t && "function" == typeof(n = e.toString) && !r(i = n.call(e))) return i;
            if ("function" == typeof(n = e.valueOf) && !r(i = n.call(e))) return i;
            if (!t && "function" == typeof(n = e.toString) && !r(i = n.call(e))) return i;
            throw TypeError("Can't convert object to primitive value")
        }
    },
    clTp: function(e, t, n) {
        "use strict";

        function r(e) {
            var t = e.getBoundingClientRect(),
                n = document.body,
                r = document.documentElement,
                i = window.pageYOffset || r.scrollTop || n.scrollTop,
                o = window.pageXOffset || r.scrollLeft || n.scrollLeft,
                a = r.clientTop || n.clientTop || 0,
                s = r.clientLeft || n.clientLeft || 0;
            return {
                top: Math.round(t.top + i - a),
                left: Math.round(t.left + o - s),
                width: e.offsetWidth,
                height: e.offsetHeight
            }
        }
        n.d(t, "a", function() {
            return r
        })
    },
    dLHM: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR")),
            o = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            };
        var a = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onChange = function(e) {
                    r.isControlledOutside || r.setState({
                        value: e.target.value
                    }), r.props.onChange && r.props.onChange(e)
                }, r.getRef = function(e) {
                    r.element = e
                }, void 0 !== n.value || n.isControlledOutside ? r.isControlledOutside = !0 : r.state = {
                    value: n.initialValue || ""
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.alignment,
                    n = e.value,
                    a = (e.onChange, e.initialValue, e.className),
                    s = (e.isControlledOutside, function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["alignment", "value", "onChange", "initialValue", "className", "isControlledOutside"])),
                    c = {
                        "Input--left": "left" === t,
                        "Input--center": "center" === t,
                        "Input--right": "right" === t
                    };
                return r.createElement("input", o({}, s, {
                    className: Object(i.a)("Input", c, a),
                    ref: this.getRef,
                    value: this.isControlledOutside ? n : this.state.value,
                    onChange: this.onChange
                }))
            }, t
        }(r.Component);
        t.a = a, a.defaultProps = {
            type: "text",
            initialValue: "",
            alignment: "left"
        }
    },
    dyZX: function(e, t) {
        var n = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")();
        "number" == typeof __g && (__g = n)
    },
    eTng: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return c
        }), n.d(t, "c", function() {
            return u
        }), n.d(t, "d", function() {
            return l
        }), n.d(t, "b", function() {
            return d
        });
        var r = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            i = window.intval;

        function o(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [],
                n = e.split("_"),
                i = r(n, 2);
            return [i[0], i[1], t]
        }
        var a = {};

        function s(e) {
            if (a[e]) return a[e];
            for (var t = e ? e.length : 0, n = [], i = [], s = "", c = 0; c < t; c++) {
                var u = e[c],
                    l = u.charCodeAt(0);
                l >= 48 && l <= 57 || "_" === u || "-" === u ? s += u : "(" !== u && ")" !== u && ":" !== u && "," !== u || ("" !== s && (i.push(s), n.push("id"), s = ""), i.push(u), n.push(u))
            }
            s.length > 0 && (i.push(s), n.push("id"));
            var d = function e(t, n) {
                    var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0,
                        a = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0;
                    if (a > 50) return [
                        [], t.length
                    ];
                    for (var s = [], c = ""; i < t.length;) {
                        var u = t[i];
                        if ("id" === u) c = n[i];
                        else if ("," === u && c) s.push(o(c)), c = "";
                        else if ("(" === u) {
                            var l = e(t, n, i + 1, a + 1),
                                d = r(l, 2),
                                _ = d[0];
                            i = d[1], s.push(o(c, _)), c = ""
                        } else if (")" === u) return "" !== c && s.push(o(c)), [s, i];
                        i++
                    }
                    return c && s.push(o(c)), [s, i]
                }(n, i),
                _ = r(d, 1)[0];
            return Object.keys(a).length > 300 && (a = {}), a[e] = _, _
        }

        function c(e, t) {
            var n = [];
            e.fwd_count ? n.push({
                type: "mail",
                id: -t,
                object: {
                    fwd_count: e.fwd_count
                }
            }) : e.fwd && n.push({
                type: "mail",
                id: -t,
                object: {
                    fwd_count: s(e.fwd).length
                }
            });
            for (var r = 1; e["attach" + r + "_type"]; ++r) "call" === e["attach" + r + "_type"] ? n.push({
                type: e["attach" + r + "_type"],
                id: e["attach" + r],
                initiatorId: i(e["attach" + r + "_call_initiator_id"]),
                state: e["attach" + r + "_call_state"],
                duration: i(e["attach" + r + "_call_duration"]),
                receiverId: i(e["attach" + r + "_call_receiver_id"])
            }) : n.push({
                type: e["attach" + r + "_type"],
                id: e["attach" + r],
                kind: e["attach" + r + "_kind"],
                productId: e["attach" + r + "_product_id"]
            });
            return e.geo && n.push({
                type: "geo",
                id: e.geo
            }), n
        }

        function u(e) {
            return 0 == e
        }

        function l(e) {
            return e > 0 && e < 2e9
        }

        function d(e) {
            return e > 2e9
        }
    },
    eeVq: function(e, t) {
        e.exports = function(e) {
            try {
                return !!e()
            } catch (e) {
                return !0
            }
        }
    },
    elZq: function(e, t, n) {
        "use strict";
        var r = n("dyZX"),
            i = n("hswa"),
            o = n("nh4g"),
            a = n("K0xU")("species");
        e.exports = function(e) {
            var t = r[e];
            o && t && !t[a] && i.f(t, a, {
                configurable: !0,
                get: function() {
                    return this
                }
            })
        }
    },
    enZq: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return o
        });
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR"));

        function o(e) {
            var t = {
                "List--border": !!e.border
            };
            return r.createElement("ul", {
                className: Object(i.a)("List", t, e.className),
                style: e.style
            }, e.children)
        }
        o.defaultProps = {
            border: !0
        }
    },
    f01n: function(e, t, n) {
        "use strict";
        n.d(t, "U", function() {
            return a
        }), n.d(t, "M", function() {
            return s
        }), n.d(t, "Q", function() {
            return c
        }), n.d(t, "a", function() {
            return u
        }), n.d(t, "H", function() {
            return l
        }), n.d(t, "I", function() {
            return d
        }), n.d(t, "s", function() {
            return _
        }), n.d(t, "r", function() {
            return f
        }), n.d(t, "d", function() {
            return p
        }), n.d(t, "e", function() {
            return m
        }), n.d(t, "W", function() {
            return g
        }), n.d(t, "J", function() {
            return h
        }), n.d(t, "Y", function() {
            return b
        }), n.d(t, "X", function() {
            return v
        }), n.d(t, "G", function() {
            return y
        }), n.d(t, "h", function() {
            return O
        }), n.d(t, "P", function() {
            return j
        }), n.d(t, "L", function() {
            return w
        }), n.d(t, "T", function() {
            return E
        }), n.d(t, "S", function() {
            return k
        }), n.d(t, "K", function() {
            return C
        }), n.d(t, "V", function() {
            return x
        }), n.d(t, "R", function() {
            return P
        }), n.d(t, "F", function() {
            return M
        }), n.d(t, "b", function() {
            return T
        }), n.d(t, "c", function() {
            return I
        }), n.d(t, "i", function() {
            return S
        }), n.d(t, "O", function() {
            return D
        }), n.d(t, "f", function() {
            return B
        }), n.d(t, "g", function() {
            return L
        }), n.d(t, "N", function() {
            return A
        }), n.d(t, "m", function() {
            return N
        }), n.d(t, "l", function() {
            return U
        }), n.d(t, "n", function() {
            return W
        }), n.d(t, "j", function() {
            return H
        }), n.d(t, "o", function() {
            return K
        }), n.d(t, "k", function() {
            return q
        }), n.d(t, "q", function() {
            return F
        }), n.d(t, "p", function() {
            return z
        }), n.d(t, "B", function() {
            return V
        }), n.d(t, "v", function() {
            return Q
        }), n.d(t, "t", function() {
            return G
        }), n.d(t, "x", function() {
            return X
        }), n.d(t, "A", function() {
            return Y
        }), n.d(t, "C", function() {
            return J
        }), n.d(t, "E", function() {
            return Z
        }), n.d(t, "D", function() {
            return $
        }), n.d(t, "u", function() {
            return ee
        }), n.d(t, "w", function() {
            return te
        }), n.d(t, "y", function() {
            return ne
        }), n.d(t, "z", function() {
            return re
        }), n.d(t, "Ga", function() {
            return ie
        }), n.d(t, "Va", function() {
            return oe
        }), n.d(t, "db", function() {
            return ae
        }), n.d(t, "Za", function() {
            return se
        }), n.d(t, "Z", function() {
            return ce
        }), n.d(t, "Ha", function() {
            return ue
        }), n.d(t, "Wa", function() {
            return le
        }), n.d(t, "Ia", function() {
            return de
        }), n.d(t, "Pa", function() {
            return _e
        }), n.d(t, "Qa", function() {
            return fe
        }), n.d(t, "Ma", function() {
            return pe
        }), n.d(t, "La", function() {
            return me
        }), n.d(t, "Ya", function() {
            return ge
        }), n.d(t, "Ua", function() {
            return he
        }), n.d(t, "cb", function() {
            return be
        }), n.d(t, "Fa", function() {
            return ve
        }), n.d(t, "Da", function() {
            return ye
        }), n.d(t, "Ea", function() {
            return Oe
        }), n.d(t, "fb", function() {
            return je
        }), n.d(t, "Ra", function() {
            return we
        }), n.d(t, "hb", function() {
            return Ee
        }), n.d(t, "gb", function() {
            return ke
        }), n.d(t, "Oa", function() {
            return Ce
        }), n.d(t, "Ta", function() {
            return xe
        }), n.d(t, "Aa", function() {
            return Pe
        }), n.d(t, "Ja", function() {
            return Me
        }), n.d(t, "eb", function() {
            return Te
        }), n.d(t, "bb", function() {
            return Ie
        }), n.d(t, "Sa", function() {
            return Se
        }), n.d(t, "ab", function() {
            return De
        }), n.d(t, "Ba", function() {
            return Be
        }), n.d(t, "Ca", function() {
            return Le
        }), n.d(t, "Ka", function() {
            return Ae
        }), n.d(t, "Na", function() {
            return Re
        }), n.d(t, "Xa", function() {
            return Ne
        });
        var r = n("eTng"),
            i = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            o = "event_delete",
            a = "event_set_flags",
            s = "event_replace_flags",
            c = "event_reset_flags",
            u = "event_add_message",
            l = "event_read_inbound",
            d = "event_read_outbound",
            _ = "event_got_online",
            f = "event_got_offline",
            p = "event_chat_changed",
            m = "event_chat_updated",
            g = "event_typing",
            h = "event_recoding_audio",
            b = "event_video_call",
            v = "event_unread_count",
            y = "event_notify_settings_changed",
            O = "event_empty",
            j = "event_reset_directories",
            w = "event_replace_directories",
            E = "event_set_directories",
            k = "event_resync",
            C = "event_refresh_lp_key",
            x = "transition_event",
            P = "reset_peer",
            M = "mutex",
            T = "change_peer",
            I = "event_change_tab",
            S = "event_failed_message",
            D = "event_resend",
            B = "event_delete_dialog",
            L = "event_edit_message",
            A = "event_replace_message",
            R = "event_audio_start",
            N = 2,
            U = 8,
            W = 64,
            H = 128,
            K = 65536,
            q = 1 << 21,
            F = 1,
            z = 8,
            V = 1,
            Q = 2,
            G = 3,
            X = 4,
            Y = 5,
            J = 6,
            Z = 7,
            $ = 8,
            ee = 9,
            te = 10,
            ne = 11,
            re = 12;

        function ie(e) {
            var t = i(e, 2)[1];
            return {
                type: o,
                localId: t
            }
        }

        function oe(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: s,
                messageId: n,
                mask: r,
                peerId: o
            }
        }

        function ae(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: a,
                messageId: n,
                flags: r,
                peerId: o
            }
        }

        function se(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: c,
                messageId: n,
                flags: r,
                peerId: o
            }
        }

        function ce(e) {
            var t = i(e, 11),
                n = t[1],
                o = t[2],
                a = t[3],
                s = t[4],
                c = t[5],
                l = t[6],
                d = t[7],
                _ = t[8],
                f = t[9],
                p = t[10],
                m = extend(l, d || void 0);
            return {
                type: u,
                messageId: intval(n),
                flags: intval(o),
                peerId: intval(a),
                date: intval(s),
                attaches: Object(r.a)(m, n),
                subject: l.title || "",
                text: c,
                kludges: m,
                randomId: intval(_),
                userId: Object(r.b)(a) ? intval(m.from) : intval(a),
                update_time: p,
                chat_local_id: f
            }
        }

        function ue(e) {
            var t = ce(e);
            return t.type = L, t
        }

        function le(e) {
            var t = ce(e);
            return t.type = A, t
        }

        function de(e) {
            return extend({}, e, {
                type: L
            })
        }

        function _e(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: l,
                peerId: n,
                upToId: r,
                unread: o
            }
        }

        function fe(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: d,
                peerId: n,
                upToId: r,
                unread: o
            }
        }

        function pe(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: _,
                userId: -n,
                platform: r,
                lastSeenTs: o
            }
        }

        function me(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: f,
                userId: -n,
                reason: r,
                lastSeenTs: o
            }
        }

        function ge(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: j,
                peerId: n,
                mask: r,
                local: void 0 !== o && o
            }
        }

        function he(e) {
            var t = i(e, 3),
                n = t[1],
                r = t[2];
            return {
                type: w,
                peerId: n,
                mask: r
            }
        }

        function be(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: E,
                peerId: n,
                mask: r,
                local: void 0 !== o && o
            }
        }

        function ve(e) {
            var t = i(e, 3),
                n = t[1],
                r = t[2];
            return {
                type: B,
                peerId: n,
                localId: r
            }
        }

        function ye(e) {
            var t = i(e, 3),
                n = t[1],
                r = t[2];
            return {
                type: p,
                chatId: n,
                self: r
            }
        }

        function Oe(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: m,
                peerId: r,
                updateType: n,
                updateArg: o
            }
        }

        function je(e) {
            var t = i(e, 5),
                n = t[1],
                r = t[2],
                o = t[3],
                a = t[4];
            return {
                type: g,
                peerId: n,
                userIds: r,
                totalCount: o,
                ts: a
            }
        }

        function we(e) {
            var t = i(e, 5),
                n = t[1],
                r = t[2],
                o = t[3],
                a = t[4];
            return {
                type: h,
                peerId: n,
                userIds: r,
                totalCount: o,
                ts: a
            }
        }

        function Ee(e) {
            var t = i(e, 3),
                n = t[1],
                r = t[2];
            return {
                type: b,
                userId: n,
                callId: r
            }
        }

        function ke(e) {
            var t = i(e, 4),
                n = t[1],
                r = t[2],
                o = t[3];
            return {
                type: v,
                count: n,
                countNotMuted: r,
                showOnlyNotMuted: o
            }
        }

        function Ce(e) {
            var t = i(e, 2)[1],
                n = void 0 === t ? {} : t;
            return {
                type: y,
                peerId: n.peer_id,
                sound: n.sound,
                disabledUntil: n.disabled_until
            }
        }

        function xe(e) {
            var t = i(e, 2)[1],
                n = void 0 === t ? {} : t,
                r = ce([!1, n.id, n.flags, n.peer_id, n.date, n.message, extend(n.kludges, {
                    title: n.title || ""
                }), {}, n.random_id, n.chat_local_id, n.update_time]);
            return r.type = L, r
        }

        function Pe(e) {
            var t = i(e, 2)[1],
                n = void 0 === t ? {} : t;
            return {
                type: R,
                uuid: n.uuid,
                deviceName: n.device_name || ""
            }
        }

        function Me(e) {
            return {
                type: O,
                params: e
            }
        }

        function Te(e) {
            return {
                type: x,
                state: e
            }
        }

        function Ie() {
            return {
                type: k
            }
        }

        function Se(e) {
            var t = i(e, 3),
                n = t[1],
                r = t[2];
            return {
                type: C,
                key: n,
                url: r
            }
        }

        function De() {
            var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
                t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
            return {
                type: P,
                cancelSearch: e,
                removeActivePeer: t
            }
        }

        function Be(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
                n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                i = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : "";
            return {
                type: T,
                peerId: e,
                msgid: t,
                forward: n,
                cancelSearch: r,
                entryPoint: i
            }
        }

        function Le(e) {
            return {
                type: I,
                tab: e
            }
        }

        function Ae(e, t, n) {
            return {
                type: S,
                message: t,
                peer: e,
                error: n
            }
        }

        function Re(e) {
            var t = i(e, 6),
                n = (t[0], t[1]),
                r = t[2],
                o = t[3],
                a = t[4],
                s = t[5];
            return {
                type: M,
                free: !!intval(n) || intval(a) === vk.id,
                resource: r,
                peerId: intval(o),
                who: intval(a),
                name: s
            }
        }

        function Ne(e, t) {
            return {
                type: D,
                message: t,
                peerId: e
            }
        }
    },
    f4YT: function(e, t) {
        e.exports = {
            im_img_prebody: '<div class="im-prebody"> <img alt="" src="%photo%" /> </div>',
            im_admin_link: ' (<a href="%href%" class="_im_admin_name" target="_blank">%name%</a>)',
            im_right_menu_tpl: '<a id="ui_rmenu_peer_%peer%" href="%href%" class="_im_peer_tab ui_rmenu_item %cls%"%attrs%>\n  <span>%label%</span>\n</a>',
            im_right_menu_sep: '<div class="ui_rmenu_sep"></div>',
            im_right_menu_ct: '<span class="ui_rmenu_count im-right-menu--count _im_r_ct">%count%</span> <button type="button" class="im-right-menu--close _im_r_cl"></button><span class="im-right-menu--text _im_r_tx">%name%</span>',
            im_dialogs_link_img: '<a href="%href%" class="_im_peer_target _online_reader" target="_blank"><div class="im_grid">%photo%</div></a>',
            im_dialogs_link: '<a href="%href%" class="_im_peer_target _online_reader" target="_blank">%photo%</a>',
            im_peer_photo: '<div class="nim-peer %online_class% %modifier_class%"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo"> %owner_photo% </div> </div> </div>',
            im_owner_item: '<a href="%link%" class="olist_item_wrap%cls%" id="olist_item_wrap%owner_id%" >\n  <div class="olist_item clear_fix">\n    <div class="olist_item_photo_wrap %img_cls%">\n      <img class="olist_item_photo" src="%photo%"/>\n    </div>\n    <div class="olist_item_name">%name%</div>\n    <div class="olist_checkbox"></div>\n  </div>\n</a>',
            im_simple_name: '<div class="im-page--title %more_cls%"> <span class="im-page--title-main" title="%name_attr%" %ads_union%><span class="im-page--title-main-in"><a href="%href%" target="_blank" class="im-page--title-main-inner _im_page_peer_name">%name%</a><span class="im-page--title-main-verified _im_chat_verified"></span></span></span> <span class="im-page--title-meta _im_page_peer_online">%online%</span> </div>',
            im_simple_link: '<a href="%href%" class="_im_header_link" target="_blank">%content%</a>',
            im_selected_messages: '<span class="im-page--selected-messages-count">%label%</span> <button aria-label="%tip%" type="button" class="im-page--selected-messages-remove"></button>',
            im_topic: "<div class='im-topic %cls%'>%topic%</div>",
            im_stack_date: ' <a href="%link%" class="_im_mess_link" >%date%</a>',
            im_dialogs_none: '<li data-list-id="002300" class="im-page--dialogs-empty"> %msg%</li>',
            im_dialogs_message_requests_button: '<li class="im-page--dialogs-message-requests-button _im_toggle_mr_tab" data-list-id="%list_id%"> %msg%</li>',
            im_dialogs_message_requests_notice: '<li class="im-page--dialogs-message-requests-notice-w" data-list-id="message_request_notice"> <div class="im-page--dialogs-message-requests-notice"> %msg% </div> </li>',
            im_filter: '<a class="im-page--dialogs-filter %cls%">%filter%</a>',
            im_drow_prebody: '<span class="nim-dialog--who">%prebody%</span> <span class="nim-dialog--inner-text">%body%</span>',
            im_attach_mess: ' <div class="im-fwd %modifier%"> <span class="im-fwd--title"> <span class="im-fwd--title-name">%text%</span> <span class="im-fwd--date">%date%</span></span> <span class="im-fwd--close _im_fwd_close"></span> <div rel="button" tab-index="0" type="button" class="im-fwd--messages _im_will_fwd">%messages%</div> </div>',
            im_preloader: '<div class="im-preloader %cls%"> %preloader%</div>',
            im_service_row: '<ul class="ui_clean_list"> <li class="im-mess im-mess_srv _im_mess _im_mess_srv _im_mess_%message_id%" data-msgid="%message_id%" data-from="%from_id%" data-ts="%date%"> <div class="im-mess--text">%text%</div> </li> </ul>',
            im_chat_members: '<button type="button" class="_im_chat_members im-page--members">%name%</button>',
            im_vkcomgroup_members: '<span class="im-page--members im-page--members--nohover">%name%</span>',
            im_mess_stack: '<div class="im-mess-stack _im_mess_stack %cls%" data-peer="%peerId%" data-admin="%admin%"> <div class="im-mess-stack--photo"> <div class="nim-peer nim-peer_small fl_l"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo"> <a target="_blank" class="im_grid" href="%href%"><img alt="%name%" src="%photo%" /></a> </div> </div> </div> </div> <div class="im-mess-stack--content"> <div class="im-mess-stack--info"> <div class="im-mess-stack--pname"> %stack_name% <span class="im-mess-stack--tools">%date%</span> </div> </div> <ul class="ui_clean_list im-mess-stack--mess _im_stack_messages"> %messages% </ul> </div> </div>',
            im_mess_stack_name: '<a href="%link%" class="im-mess-stack--lnk%class%" title="" target="_blank">%name%</a>',
            im_message_media: '<div class="_im_msg_%type%%messageId%" class="wall_module">%attaches%</div>%text%',
            im_dialog_media: '<span class="nim-dialog--preview nim-dialog--preview-attach">%name%</span>',
            im_typing: '<div class="im-page--typing _im_typing"> <div class="im-activity %cls%"><div class="pr im-activity--icon"><div class="pr_bt"></div><div class="pr_bt"></div><div class="pr_bt"></div></div><span class="_im_typing_name">&nbsp;</span></div> </div>',
            ctrl_submit_hint: function() {
                return '<div class="reply_submit_hint_wrap" >\n  <div class="reply_submit_hint_title">' + getLang("wall_reply_submit_settings") + '</div>\n  <div class="reply_submit_hint_opts" id="">\n    <div class="radiobtn %enter_on% _im_submit_btn" data-val="0" onclick="radiobtn(this, 0, \'im_submit\'); "><div class="radiobtn_label">' + getLang("wall_reply_submit_settings_1") + '</div></div>\n    <div class="radiobtn %ctrl_on% _im_submit_btn" data-val="1" onclick="radiobtn(this, 1, \'im_submit\'); "><div class="radiobtn_label">' + getLang("wall_reply_submit_settings_2") + "</div></div>\n  </div>\n</div>"
            },
            im_day_bar: '<h5 class="im-page--history-new-bar im-page--history-new-bar_days _im_bar_date %day_class%" data-date="%date%"><span>%day%</span></h5>',
            im_mess_bar: function() {
                return '<h4 class="im-page--history-new-bar _im_unread_bar_row"><span>' + getLang("mail_new_unread_msgs") + "</span></h4>"
            },
            im_replied_message: '<div class="im-replied"> <div class="im-replied--photo-wrapper"></div> <div class="im-replied--content"> <div class="im-replied--author"> <span class="im-replied--author-link">%authorName%</span> </div> <div class="im-replied--text">%text%</div> </div> </div>',
            im_drow: function() {
                return '<li data-list-id="%peer%" class="nim-dialog _im_dialog _im_dialog_%peer% %is_unread% %is_unread_out% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer %is_online% _im_peer_online"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo _im_dialog_photo"> %photo% </div> </div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="' + getLang("mail_im_to_multidialog") + ': %tab_name%"></span> <div class="nim-dialog--date _im_dialog_date">%date%</div> <button type="button" class="nim-dialog--close _im_dialog_close" data-peer="%peer%"></button> <button type="button" class="nim-dialog--markre _im_dialog_markre"></button> <div class="nim-dialog--name"> <span class="nim-dialog--name-w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--verfifed _im_dialog_verified"></span> <span class="nim-dialog--mute"></span> <button type="button" class="nim-dialog--star _im_dialog_star"></button> </div> <div class="nim-dialog--text-preview"> <span class="nim-dialog--preview _dialog_body" tabindex="0">%body%</span> <span class="nim-dialog--typing _im_dialog_typing"></span><span class="nim-dialog--typer-el"></span> </div> <label class="blind_label _im_unread_blind_label">%unread_message_string%</label> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </li>'
            },
            im_conversation_search_row: function() {
                return '<li data-list-id="%peer%" class="nim-dialog nim-conversation-search-row _im_dialog _im_dialog_%peer% %is_unread% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer nim-peer_search %is_online% _im_peer_online"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo _im_dialog_photo"> %photo% </div> </div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="' + getLang("mail_im_to_multidialog") + ': %tab_name%"></span> <button type="button" class="nim-dialog--close _im_dialog_close" data-peer="%peer%"></button> <div class="nim-dialog--name"> <span class="nim-dialog--name-w" aria-hidden="true"> %user_link% </span> </div> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </li>'
            },
            im_delete_actions: function() {
                return '<span class="nim-dialog--who">%text%</span> <button class="nim-dialog--daction ui_bullet _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="restore" type="button">' + getLang("mail_restore") + '</button> <button class="nim-dialog--daction ui_bullet _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="spam" type="button">' + getLang("mail_im_mark_spam") + '</button> <button class="nim-dialog--daction nim-dialog--daction_last _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="block" type="button">' + getLang("mail_user_black_list") + "</button>"
            },
            im_chat_change_topic: function() {
                return '<div class="im_change_topic_wrap clear_fix"> <div class="im_change_topic_label fl_l ta_r">' + getLang("mail_chat_topic_change_label") + '</div> <div class="im_change_topic_labeled fl_l"> <input class="text _im_chat_topic_change_input" value="%value%"/> </div> </div>'
            },
            im_msg_row: function() {
                return '<li class="im-mess %cls% _im_mess_noa _im_mess_%msg_id%" aria-hidden="%aria_hidden%" data-ts="%ts%" data-msgid="%msg_id%" data-peer="%from_id%"> <div class="im-mess--text wall_module _im_log_body">%text%</div> <span tabindex="0" role="link" aria-label="' + getLang("mail_select_message") + '" class="blind_label im-mess--blind-select _im_mess_blind_label_select"></span> <span class="blind_label im-mess--blind-read _im_mess_blind_unread_marker" %unread_params%></span> <span class="im-mess--marker _im_mess_marker" %marker_params%></span> </li>'
            },
            sImHistoryRowActions: function() {
                return '<div class="im-mess--actions"> <span role="link" aria-label="' + getLang("mail_im_mark_forward") + '" class="im-mess--forward _im_mess_forward"></span> <span role="link" aria-label="' + getLang("mail_im_reply") + '" class="im-mess--reply _im_mess_reply"></span> <span role="link" aria-label="' + getLang("mail_im_edit") + '" class="im-mess--edit _im_mess_edit"></span> <span role="link" aria-label="' + getLang("mail_important_message") + '" class="im-mess--fav _im_mess_fav"></span> </div> <div class="im-mess--check fl_l"></div>'
            },
            im_wrap_mobile: '<b class="mob_onl %class%" %attrs% onmouseover="mobileOnlineTip(this, {%params%})"></b>',
            im_pinned_message: '<div class="im-page-pinned _im_pinned_message"> <button class="im-page-pinned--hide _im_pin_hide"></button> <div class="im-page-pinned--meta"> <a href="%link%" target="_blank" class="im-page-pinned--name">%name%</a> <span class="im-page-pinned--date">%date%</span> </div> <div class="im-page-pinned--content">%content%</div> </div>',
            im_pinned_message_media: '<span class="im-page-pinned--media">%text%</span>',
            im_pinned_message_media_bar: '<div class="im-page-pinned--media-bar">\n  <div class="im-page-pinned--media-bar_progress" style="width: %percent%%;"></div>\n</div>',
            im_pinned_messages_promo: '<div class="im-page--mess-actions-promo-content">%content%</div>',
            im_retry_link: function() {
                return '<button class="im-page--retry _im_retry_media">' + getLang("mail_retry") + "</button>"
            },
            sImLblWasEdited: function() {
                return " <span class='im-mess--lbl-was-edited _im_edit_time' data-time='%update_time%'>" + getLang("mail_was_edited_short") + "</span>"
            },
            sImLblWasSourceInfo: function() {
                return " <span class='im-mess--lbl-was-edited _im_page_info' data-info='%source%'>" + getLang("mail_was_source_short") + "</span>"
            },
            im_top_banner: '<div class="im-top-banner">\n  %icon%\n  <div class="im-top-banner--text"><div>%text%</div></div>\n  <div class="im-top-banner--buttons">%buttons%</div>\n</div>',
            im_top_banner_icon: '<div class="im-top-banner--icon">\n  <img src="%icon%" alt=""/>\n</div>',
            im_top_banner_button_link: '<a href="%link%" target="_blank" class="_im_top_banner_button im-top-banner--button %css_class% flat_button">%text%</a>',
            im_top_banner_button: '<button class="_im_top_banner_button im-top-banner--button %css_class% flat_button" data-payload="%callback_data%">%text%</button>',
            im_top_banner_hide_btn: '<button class="im-top-banner--button im-top-banner--button_hide _im_top_banner_hide"></button>',
            im_calls_link: '<a href="/calls" class="im_srv_lnk_light" onclick="return showWiki({ w: \'calls\'});">%text%</a>',
            sImPeerMuteUnmute: '<a href="#" class="_im_peer_mute_unmute ui_actions_menu_item im-action nohover %cls%">%text%</a>',
            sImPeerAcceptOrRejectMessageRequest: function() {
                return "<p>" + getLang("mail_message_request_user_notice") + '</p> <p> <button type="button" class="flat_button %cls_accept%">' + getLang("mail_message_request_accept") + '</button> <button type="button" class="flat_button secondary %cls_reject%">' + getLang("mail_message_request_reject") + "</button> </p>"
            },
            sImPeerReturnToChat: '<a href="#" class="_im_peer_return_to_chat">%text%</a>'
        }
    },
    fyDq: function(e, t, n) {
        var r = n("hswa").f,
            i = n("aagx"),
            o = n("K0xU")("toStringTag");
        e.exports = function(e, t, n) {
            e && !i(e = n ? e : e.prototype, o) && r(e, o, {
                configurable: !0,
                value: t
            })
        }
    },
    g3g5: function(e, t) {
        var n = e.exports = {
            version: "2.2.1"
        };
        "number" == typeof __e && (__e = n)
    },
    g6Ay: function(e, t, n) {
        "use strict";

        function r() {
            var e = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || window.MediaDevices && window.MediaDevices.getUserMedia;
            e && !navigator.mediaDevices && (navigator.mediaDevices = navigator.mediaDevices || {}), navigator.mediaDevices && (navigator.mediaDevices.getUserMedia || (navigator.mediaDevices.getUserMedia = function(t) {
                return new Promise(function(n, r) {
                    e ? e.call(navigator, t, n, r) : r(new Error("NotSupported"))
                })
            }), navigator.mediaDevices.enumerateDevices || (navigator.mediaDevices.enumerateDevices = function() {
                return new Promise(function(e, t) {
                    if (MediaStreamTrack && MediaStreamTrack.getSources) {
                        var n = {
                            audio: "audioinput",
                            video: "videoinput"
                        };
                        return MediaStreamTrack.getSources(function(t) {
                            e(t.map(function(e) {
                                return {
                                    label: e.label,
                                    kind: n[e.kind],
                                    deviceId: e.id,
                                    groupId: ""
                                }
                            }))
                        })
                    }
                    t(new Error("NotSupported"))
                })
            })), window.AudioContext = window.AudioContext || window.webkitAudioContext, window.AudioContext && (window.AudioContext.prototype.createScriptProcessor = window.AudioContext.prototype.createScriptProcessor || window.AudioContext.prototype.createJavaScriptNode)
        }
        n.d(t, "a", function() {
            return r
        })
    },
    "h++7": function(e, t, n) {
        "use strict";
        var r;

        function i(e, t, n) {
            return t in e ? Object.defineProperty(e, t, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = n, e
        }
        n.d(t, "t", function() {
            return o
        }), n.d(t, "f", function() {
            return a
        }), n.d(t, "B", function() {
            return s
        }), n.d(t, "q", function() {
            return c
        }), n.d(t, "r", function() {
            return u
        }), n.d(t, "b", function() {
            return l
        }), n.d(t, "a", function() {
            return d
        }), n.d(t, "v", function() {
            return _
        }), n.d(t, "u", function() {
            return f
        }), n.d(t, "d", function() {
            return p
        }), n.d(t, "o", function() {
            return m
        }), n.d(t, "e", function() {
            return g
        }), n.d(t, "z", function() {
            return h
        }), n.d(t, "A", function() {
            return b
        }), n.d(t, "w", function() {
            return v
        }), n.d(t, "m", function() {
            return y
        }), n.d(t, "h", function() {
            return O
        }), n.d(t, "n", function() {
            return j
        }), n.d(t, "i", function() {
            return w
        }), n.d(t, "k", function() {
            return E
        }), n.d(t, "l", function() {
            return k
        }), n.d(t, "g", function() {
            return C
        }), n.d(t, "j", function() {
            return x
        }), n.d(t, "y", function() {
            return P
        }), n.d(t, "p", function() {
            return M
        }), n.d(t, "c", function() {
            return T
        }), n.d(t, "s", function() {
            return I
        }), n.d(t, "x", function() {
            return S
        });
        var o = /^([a-zA-Z0-9\.\_\-]+\.)?(vkontakte\.ru|vk\.com|vkadre\.ru|vshtate\.ru|userapi\.com|vk\.me)$/,
            a = /([^a-zA-Z0-9#%;_\-.\/?&=\[\]])/g,
            s = /^(?:https?:\/\/)?(?:vk\.com|vkontakte\.ru)?\/([a-zA-Z0-9\._]+)\??$/,
            c = /\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,
            u = /(^|[\s.,:\'\";>\)\(])(\*|@)([A-Za-z0-9_\.]{2,32})\s*\((.+?)\)/g,
            l = 38,
            d = 40,
            _ = 33,
            f = 34,
            p = 35,
            m = 36,
            g = 13,
            h = [l, d, _, f, g, 27, p, m],
            b = [_, f, d, l, m, p],
            v = "printable",
            y = "unread",
            O = "all",
            j = "unrespond",
            w = "important",
            E = "mr",
            k = "mr_rejected",
            C = [O, y, j, w, E],
            x = (i(r = {}, j, 2), i(r, w, 1), i(r, E, 256), i(r, k, 512), r),
            P = [].concat("aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","), "бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","), "qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map(function(e) {
                return "xn--" + e
            })),
            M = P.reduce(function(e, t) {
                return Math.max(e, t.length)
            }, 0),
            T = new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})))", "ig"),
            I = new RegExp("(https?:\\/\\/)?(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})(?:\\:(\\d{2,5}))?)(([\\/?#])(?:\\&amp;|\\&#\\d{2,6};|,[_%]|!|,*[\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$.~=;:'ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ　-〿＀-￯*]+|(?:\\(|\\[)[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\d&#%;,]+(?:\\)|\\])){0,200})?", "ig"),
            S = "(^|[s.,:'\";>)(]?)((#(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)){0,100}(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?))(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)){0,100}))(@((?:[a-z0-9_]*[a-z0-9])?(?:(?:.[a-z](?:[a-z0-9_]+[a-z0-9])?)*.[a-z][a-z0-9_]{2,40}[a-z0-9])?))?(?=$|[s.,:'\"&;?<)(]?)"
    },
    hIV1: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return o
        });
        var r = n("q1tI"),
            i = n("pemR");

        function o(e) {
            var t = {
                "SubmitArea--left": !e.alignment || "left" === e.alignment,
                "SubmitArea--center": "center" === e.alignment,
                "SubmitArea--right": "right" === e.alignment
            };
            return r.createElement("div", {
                className: Object(i.a)("SubmitArea", t),
                style: e.style
            }, e.children)
        }
    },
    hOuX: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return i
        });
        var r = 2147483647;

        function i() {
            try {
                if (window.crypto) {
                    var e = new Int32Array(1);
                    return crypto.getRandomValues(e), Math.abs(e.reduce(function(e, t) {
                        return e + t
                    }))
                }
            } catch (e) {}
            return intval(rand(0, r).toFixed(0))
        }
    },
    hPIQ: function(e, t) {
        e.exports = {}
    },
    hswa: function(e, t, n) {
        var r = n("y3w9"),
            i = n("xpql"),
            o = n("apmT"),
            a = Object.defineProperty;
        t.f = n("nh4g") ? Object.defineProperty : function(e, t, n) {
            if (r(e), t = o(t, !0), r(n), i) try {
                return a(e, t, n)
            } catch (e) {}
            if ("get" in n || "set" in n) throw TypeError("Accessors not supported!");
            return "value" in n && (e[t] = n.value), e
        }
    },
    i5dc: function(e, t, n) {
        var r = n("0/R4"),
            i = n("y3w9"),
            o = function(e, t) {
                if (i(e), !r(t) && null !== t) throw TypeError(t + ": can't set as prototype!")
            };
        e.exports = {
            set: Object.setPrototypeOf || ("__proto__" in {} ? function(e, t, r) {
                try {
                    (r = n("m0Pp")(Function.call, n("EemH").f(Object.prototype, "__proto__").set, 2))(e, []), t = !(e instanceof Array)
                } catch (e) {
                    t = !0
                }
                return function(e, n) {
                    return o(e, n), t ? e.__proto__ = n : r(e, n), e
                }
            }({}, !1) : void 0),
            check: o
        }
    },
    iN1s: function(e, t, n) {
        "use strict";
        var r = n("DM26"),
            i = n("BxOC"),
            o = n("f01n"),
            a = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            s = 202,
            c = 6,
            u = 4;

        function l(e, t) {
            e.waitAbortFns.push(t)
        }

        function d(e) {
            if (e.isStoppedFn()) return Promise.resolve({
                ts: 0,
                updates: []
            });
            var t = Object(i.a)(e.url, {
                    act: "a_check",
                    key: e.key,
                    version: e.version,
                    ts: e.ts,
                    wait: 25,
                    mode: e.mode
                }),
                n = t.request,
                o = t.cancel;
            return e.stopFn = o, n.then(function(t) {
                var n = a(t, 2),
                    r = n[0],
                    i = n[1];
                return e.onData(e, i), e.waitTimeout = 2, JSON.parse(r)
            }).catch(function(t) {
                var n = a(t, 2),
                    r = (n[0], n[1]);
                throw e.onData(e, r), ""
            }).then(function(t) {
                return function(e, t) {
                    var n = t.failed ? Object(r.a)(u, null) : {},
                        i = n.abort,
                        o = n.pause;
                    switch (t.failed) {
                        case 1:
                            return l(e, i), e.onHistoryLost(e, t).then(function() {
                                return e.onResult({
                                    ts: t.ts,
                                    updates: [
                                        [-1]
                                    ]
                                })
                            }).then(o).then(function() {
                                return d(e)
                            });
                        case 2:
                            return l(e, i), e.onKeyExpired(e, t).then(function(t) {
                                var n = a(t, 4),
                                    r = n[0],
                                    i = n[1],
                                    o = n[2],
                                    s = n[3];
                                return e.onResult({
                                    ts: +s,
                                    updates: [
                                        [-2, r, i + "/" + o],
                                        [-1]
                                    ]
                                })
                            }).then(o).then(function() {
                                return d(e)
                            });
                        case 3:
                            return e.onLpBroken(e, t);
                        default:
                            return t
                    }
                }(e, t)
            })
        }

        function _(e) {
            e.isStoppedFn() || d(e).then(e.onResult).catch(function(t) {
                return function(e, t) {
                    if (e.isStoppedFn()) return;
                    e.onRequestError(t), e.waitTimeout = Math.min(64, 2 * e.waitTimeout);
                    var n = Object(r.a)(e.waitTimeout, null),
                        i = n.abort,
                        o = n.pause;
                    return l(e, i), o()
                }(e, t)
            }).then(function() {
                return _(e)
            })
        }

        function f(e, t) {
            var n = !!e.stopped,
                r = {
                    id: e.id,
                    key: e.key,
                    ts: e.ts,
                    url: e.url,
                    lpstat: e.lpstat || 0,
                    version: e.version || c,
                    mode: s,
                    waitTimeout: 2,
                    waitAbortFns: [],
                    isStoppedFn: function() {
                        return n
                    },
                    onResult: function(e) {
                        e.ts && a(r.ts, e.ts, e.updates.map(function(e) {
                            switch (e[0]) {
                                case 0:
                                    return o.Ga(e);
                                case 1:
                                    return o.Va(e);
                                case 2:
                                    return o.db(e);
                                case 3:
                                    return o.Za(e);
                                case 4:
                                    return o.Z(e);
                                case 5:
                                    return o.Ha(e);
                                case 6:
                                    return o.Pa(e);
                                case 7:
                                    return o.Qa(e);
                                case 8:
                                    return o.Ma(e);
                                case 9:
                                    return o.La(e);
                                case 10:
                                    return o.Ya(e);
                                case 11:
                                    return o.Ua(e);
                                case 12:
                                    return o.cb(e);
                                case 13:
                                    return o.Fa(e);
                                case 18:
                                    return o.Wa(e);
                                case 51:
                                    return o.Da(e);
                                case 52:
                                    return o.Ea(e);
                                case 63:
                                    return o.fb(e);
                                case 64:
                                    return o.Ra(e);
                                case 70:
                                    return o.hb(e);
                                case 80:
                                    return o.gb(e);
                                case 114:
                                    return o.Oa(e);
                                case 116:
                                    return o.Ta(e);
                                case 117:
                                    return o.Aa(e);
                                case -1:
                                    return o.bb();
                                case -2:
                                    return o.Sa(e);
                                default:
                                    return o.Ja(e)
                            }
                        }))
                    },
                    onData: p(t.onData),
                    onRequestError: p(t.onRequestError),
                    onHistoryLost: m(t.onHistoryLost),
                    onKeyExpired: m(t.onKeyExpired),
                    onLpBroken: m(t.onHistoryLost)
                },
                i = t.onEvents;

            function a(e, t, n) {
                r.ts = t;
                for (var a = 0; a < n.length; ++a) n[a].type === o.K && (r.key = n[a].key, r.url = n[a].url);
                i(e, t, n)
            }
            var u = {
                options: r,
                isStopped: function() {
                    return n
                },
                stopConnection: function() {
                    n = !0, r.stopFn && r.stopFn(), r.stopFn = void 0, this.abortWaiting()
                },
                reinitConnection: function() {
                    this.stopConnection(), n = !1, _(r)
                },
                abortWaiting: function() {
                    r.waitAbortFns.forEach(function(e) {
                        return e()
                    }), r.waitAbortFns = [], r.waitTimeout = 2
                },
                onLp: a
            };
            return _(r), u
        }

        function p(e) {
            return e || function() {}
        }

        function m(e) {
            return e ? function() {
                return Promise.resolve(e.apply(void 0, arguments))
            } : function() {
                return Promise.reject()
            }
        }
        var g = n("P+eJ"),
            h = n("vT4u");

        function b(e, t) {
            return f(e, {
                onEvents: t,
                onData: j,
                onRequestError: w,
                onHistoryLost: E,
                onKeyExpired: k,
                onLpBroken: C
            })
        }
        n.d(t, "a", function() {
            return b
        });
        var v = 3e4,
            y = {},
            O = Date.now();

        function j(e, t) {
            if (t && t.status && e.lpstat) {
                var n = Math.floor(t.status / 100);
                t.status >= 500 && t.status < 600 && statlogsValueEvent("fc_longpoll", 1, n + "0x", t.getResponseHeader("x-frontend")), y[n] = n in y ? y[n] + 1 : 1, Date.now() - O >= v && (Object.keys(y).forEach(function(e) {
                    statlogsValueEvent("fc_longpoll", y[e], e + "0x", t.getResponseHeader("x-frontend"))
                }), y = {}, O = Date.now())
            }
        }

        function w(e) {
            Object(g.b)("red", "LP error", e.message || "no message (probably browser reset)")
        }

        function E(e, t) {
            Object(g.b)("red", "LP failed: old timestamp; resync, next ts", t.ts)
        }

        function k(e) {
            return Object(g.b)("red", "LP failed: key is incorrect; refresh key"), Object(i.b)(h.e, {
                act: "a_get_key",
                uid: e.id,
                gid: e.id < 0 ? -e.id : 0
            })
        }

        function C() {
            throw window.nav.reload({
                force: !0
            }), new Error("ts is very wrong")
        }
    },
    kMSP: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return i
        }), n.d(t, "d", function() {
            return o
        }), n.d(t, "b", function() {
            return a
        }), n.d(t, "c", function() {
            return s
        });
        var r = n("zxIV");

        function i(e) {
            return function() {
                window._cookies = {};
                for (var e = document.cookie.split(";"), t = /^[\s]*([^\s]+?)$/i, n = 0, r = e.length; n < r; n++) {
                    var i = e[n].split("=");
                    2 === i.length && (_cookies[i[0].match(t)[1]] = unescape(i[1].match(t) ? i[1].match(t)[1] : ""))
                }
            }(), _cookies[e]
        }

        function o(e, t, n, r) {
            var i = "";
            if (n) {
                var o = new Date;
                o.setTime(o.getTime() + 24 * n * 60 * 60 * 1e3), i = "; expires=" + o.toGMTString()
            }
            var a = window.locDomain;
            document.cookie = e + "=" + escape(t) + i + "; path=/" + (a ? "; domain=." + a : "") + (r && "https:" === locProtocol ? "; secure" : "")
        }

        function a() {
            Object(r.Fa)("cookies_policy_wrap"), ajax.post("/settings", {
                act: "a_hide_cookies_policy"
            })
        }

        function s() {
            window._cookies = {}
        }
    },
    kcIO: function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return u
        }), n.d(t, "d", function() {
            return l
        }), n.d(t, "a", function() {
            return d
        }), n.d(t, "e", function() {
            return _
        }), n.d(t, "c", function() {
            return f
        });
        var r = n("Egk5"),
            i = n("t7n3"),
            o = n("zxIV"),
            a = n("7jxN"),
            s = n("gdug"),
            c = {
                hideAll: function(e, t) {
                    if (e)
                        for (; c.count();) c.hideLast();
                    else {
                        if (c.count()) {
                            var n = _message_boxes[c._boxes.pop()];
                            n._in_queue = !1, n._hide(!1, !1, t)
                        }
                        for (; c.count();) {
                            _message_boxes[c._boxes.pop()]._in_queue = !1
                        }
                    }
                },
                hideLast: function(e, t) {
                    if (c.count()) {
                        var n = window._message_boxes[c._boxes[c.count() - 1]];
                        if (!0 === e && (n.changed || c.skip || t && t.target && t.target.tagName && "input" !== t.target.tagName.toLowerCase() && cur.__mdEvent && t.target !== cur.__mdEvent.target)) return void(c.skip = !1);
                        n.hide()
                    }
                    if (t && "click" === t.type) return Object(r.c)(t)
                },
                hideBGClick: function(e) {
                    e && e.target && /^box_layer/.test(e.target.id) && c.hideLast()
                },
                count: function() {
                    return c._boxes.length
                },
                _show: function(e) {
                    var t = _message_boxes[e];
                    if (t && !t._in_queue) {
                        c.count() ? _message_boxes[c._boxes[c.count() - 1]]._hide(!0, !0) : window.tooltips && tooltips.hideAll(), t._in_queue = !0;
                        var n = !!c.count();
                        c.curBox = e, t._show(n || c.currHiding, n), c._boxes.push(e)
                    }
                },
                _hide: function(e) {
                    var t = _message_boxes[e];
                    if (t && t._in_queue && c._boxes[c.count() - 1] === e && t.isVisible() && (t._in_queue = !1, c._boxes.pop(), t._hide(!!c.count()), c.count())) {
                        var n = c._boxes[c.count() - 1];
                        c.curBox = n, _message_boxes[n]._show(!0, !0, !0)
                    }
                },
                _boxes: [],
                curBox: 0
            };

        function u() {
            var e = window._message_boxes[c.curBox];
            return e && e.isVisible() ? e : null
        }

        function l() {
            c.hideLastCheck = c.hideLast.pbind(!0), window._message_box_guid = 0, window._message_boxes = []
        }

        function d(e) {
            var t = window.innerHeight || document.documentElement.clientHeight || boxLayerBG.offsetHeight,
                n = s.a.mobile ? Object(i.r)(window.pageYOffset) : 0,
                r = Object(o.N)(e);
            e.style.marginTop = Math.max(10, n + (t - r[1]) / 3) + "px"
        }

        function _(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                n = (t.w || 380) + 20,
                c = t.w ? ' style="width: ' + t.w + 'px;"' : "",
                u = bodyNode.offsetWidth,
                l = Object(o.e)("div", {
                    className: "top_result_baloon_wrap fixed " + (t.className || ""),
                    innerHTML: '<div class="top_result_baloon"' + c + ">" + e + "</div>"
                }, {
                    left: (u - n) / 2
                });
            t.parentEl ? Object(o.H)(t.parentEl).appendChild(l) : bodyNode.insertBefore(l, pageNode);
            var d = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : boxLayerBG.offsetHeight,
                _ = s.a.mobile ? Object(i.r)(window.pageYOffset) : 0,
                f = Object(o.N)(l);
            l.style.top = Math.max(10, _ + (d - f[1]) / 3) + "px";
            var p = t.out || 2e3,
                m = new Date,
                g = function e() {
                    p < 0 || (window.doneBoxTO = setTimeout(function() {
                        !t.permit || t.permit() ? Object(a.f)(l.firstChild, 500, function() {
                            Object(o.Fa)(l), t.callback && t.callback()
                        }) : e()
                    }, p))
                };
            return Object(r.b)(l, "mouseenter", function() {
                clearTimeout(window.doneBoxTO), p -= new Date - m
            }), Object(r.b)(l, "mouseleave", function() {
                m = new Date, g()
            }), g(), l
        }

        function f() {
            return c
        }
    },
    lJdi: function(e, t, n) {
        "use strict";
        n.d(t, "c", function() {
            return c
        }), n.d(t, "d", function() {
            return u
        }), n.d(t, "b", function() {
            return l
        }), n.d(t, "a", function() {
            return d
        }), n.d(t, "l", function() {
            return y
        }), n.d(t, "f", function() {
            return O
        }), n.d(t, "e", function() {
            return j
        }), n.d(t, "h", function() {
            return w
        }), n.d(t, "i", function() {
            return E
        }), n.d(t, "j", function() {
            return k
        }), n.d(t, "g", function() {
            return C
        }), n.d(t, "k", function() {
            return x
        }), n.d(t, "m", function() {
            return M
        }), n.d(t, "n", function() {
            return I
        });
        var r, i = n("rHUl"),
            o = n("aong"),
            a = n("P13b");

        function s(e, t, n) {
            return t in e ? Object.defineProperty(e, t, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = n, e
        }
        var c = 1,
            u = 4,
            l = 8,
            d = 16,
            _ = "see_invite_link",
            f = "change_invite_link",
            p = "invite_user",
            m = "pin_unpin",
            g = "change_title",
            h = "add_admin",
            b = (s(r = {}, _, 32), s(r, f, 32), s(r, h, d), s(r, p, c), s(r, m, u), s(r, g, l), r),
            v = 1;

        function y(e, t, n) {
            return P(e, _, t, n)
        }

        function O(e, t, n) {
            return P(e, f, t, n)
        }

        function j(e, t, n, r) {
            var a = Object(o.r)(e);
            return !I(Object(i.t)(a, n || a.peer), t) && P(e, h, n, r)
        }

        function w(e, t, n) {
            return P(e, p, t, n)
        }

        function E(e, t, n, r) {
            var s = Object(o.r)(e);
            if (function(e, t) {
                    var n = Object(o.r)(e);
                    return void 0 !== n.service && (n.service & t) > 0
                }(e, v)) return !0;
            var c = Object(i.t)(s, n || s.peer);
            return !(c.data.kicked && !c.data.closed) && (!Object(a.Pa)(e, n) && (!I(c, t) && (!!I(c, r = void 0 === r ? window.vk.id : r) || (T(c, r) ? !T(c, t) : function(e, t) {
                return -1 !== e.invitedByMe.indexOf(t)
            }(c, t) && !T(c, t)))))
        }

        function k(e, t, n) {
            return P(e, m, t, n)
        }

        function C(e, t, n) {
            return P(e, g, t, n)
        }

        function x(e, t, n) {
            return !Object(i.C)(n) || !!Object(i.t)(e, t).caccess[n]
        }

        function P(e, t, n, r) {
            var s = Object(o.r)(e);
            r = void 0 === r ? window.vk.id : r, n = void 0 === n ? s.peer : n;
            var c = Object(i.t)(s, n),
                u = !c.data.kicked && !c.data.closed,
                l = b[t];
            if (Object(a.Pa)(e, n)) switch (t) {
                case h:
                case p:
                    return !1;
                case _:
                    return u;
                default:
                    return s.gid > 0
            }
            switch (t) {
                case _:
                case f:
                case h:
                    return M(c, l) ? T(c, r) && u : I(c, r);
                case p:
                case m:
                case g:
                    return M(c, l) ? T(c, r) && u : u
            }
            return !1
        }

        function M(e, t) {
            return ((e && e.data && e.data.flags || 0) & t) > 0
        }

        function T(e, t) {
            return (e && e.adminIds || []).indexOf(+t) > -1
        }

        function I(e, t) {
            return e.ownerId === t
        }
    },
    lXE5: function(e, t, n) {
        "use strict";
        n.d(t, "g", function() {
            return a
        }), n.d(t, "f", function() {
            return s
        }), n.d(t, "d", function() {
            return c
        }), n.d(t, "e", function() {
            return u
        }), n.d(t, "a", function() {
            return l
        }), n.d(t, "b", function() {
            return d
        }), n.d(t, "c", function() {
            return _
        });
        var r = n("v+DW"),
            i = n("7jxN"),
            o = n("zxIV");

        function a(e, t, n, s) {
            if (void 0 == t && (t = 400), "ontouchstart" in document.documentElement && (t = 0), s || (e = Math.max(0, e - (vk.staticheader ? 0 : Object(o.N)("page_header_cont")[1]))), Object(o.i)(bodyNode, "tween") && Object(o.i)(bodyNode, "tween").stop(!1), Object(o.i)(htmlNode, "tween") && Object(o.i)(htmlNode, "tween").stop(!1), window.scrollAnimation = !1, t) {
                var l = function() {
                    window.scrollAnimation = !1, 2 === n && ("profile" != cur.module && "public" != cur.module && "group" != cur.module && "groups" != cur.module && "event" != cur.module || !window.Wall || Wall.scrollCheck(!1, void 0, !0), Object(r.y)())
                };
                window.scrollAnimation = !0, Object(i.b)(htmlNode, {
                    scrollTop: e
                }, {
                    duration: t,
                    transition: i.a.Transitions.sineInOut,
                    onComplete: l
                }), Object(i.b)(bodyNode, {
                    scrollTop: e
                }, {
                    duration: t,
                    transition: i.a.Transitions.sineInOut,
                    onComplete: l
                })
            } else {
                if (n && 2 !== n) {
                    "profile" != cur.module && "public" != cur.module && "group" != cur.module && "event" != cur.module || !window.Wall || Wall.scrollCheck(!1, e, !0);
                    var d = u() - e;
                    return Math.abs(d) > 6 && a(e + (d > 0 ? 6 : -6), 0, 2, !0), Object(r.y)(), clearTimeout(window.scrlToTO), void(window.scrlToTO = setTimeout(a.pbind(e, 100, 2, !0), 0))
                }
                window.scroll(c(), e), n || Object(r.y)()
            }
        }

        function s(e) {
            return a(0, e)
        }

        function c() {
            return window.pageXOffset || scrollNode.scrollLeft || document.documentElement.scrollLeft
        }

        function u() {
            return window.pageYOffset || scrollNode.scrollTop || document.documentElement.scrollTop
        }

        function l() {
            bodyNode.style.overflow = "hidden"
        }

        function d() {
            bodyNode.style.overflow = "auto"
        }

        function _() {
            return "hidden" !== bodyNode.style.overflow
        }
    },
    m0Pp: function(e, t, n) {
        var r = n("2OiF");
        e.exports = function(e, t, n) {
            if (r(e), void 0 === t) return e;
            switch (n) {
                case 1:
                    return function(n) {
                        return e.call(t, n)
                    };
                case 2:
                    return function(n, r) {
                        return e.call(t, n, r)
                    };
                case 3:
                    return function(n, r, i) {
                        return e.call(t, n, r, i)
                    }
            }
            return function() {
                return e.apply(t, arguments)
            }
        }
    },
    mSoV: function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("i8i4")),
            o = n("pemR"),
            a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            } : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            };
        var s = "Select...",
            c = function(e) {
                function t(n) {
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, t);
                    var r = function(e, t) {
                        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !t || "object" != typeof t && "function" != typeof t ? e : t
                    }(this, e.call(this, n));
                    return r.handleMouseDown = function(e) {
                        r.props.onFocus && "function" == typeof r.props.onFocus && r.props.onFocus(r.state.opened), "mousedown" === e.type && 0 !== e.button || (e.stopPropagation(), e.preventDefault(), r.props.disabled || r.setState({
                            opened: !r.state.opened
                        }))
                    }, r.setValue = function(e, t) {
                        var n = {
                            selected: {
                                value: e,
                                label: t
                            },
                            opened: !1
                        };
                        r.fireChangeEvent(n), r.setState(n)
                    }, r.fireChangeEvent = function(e) {
                        e.selected !== r.state.selected && r.props.onChange && r.props.onChange({
                            name: r.props.name,
                            selected: e.selected
                        })
                    }, r.handleDocumentClick = function(e) {
                        r.mounted && r.state.opened && !r.el.contains(e.target) && r.setState({
                            opened: !1
                        })
                    }, r.state = {
                        selected: void 0 !== n.value ? r.getOptionByValue(n.options, n.value) : {
                            label: n.placeholder || s,
                            value: ""
                        },
                        opened: !1
                    }, r.mounted = !0, r
                }
                return function(e, t) {
                    if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                    void 0 !== e.value && e.value !== this.state.selected ? this.setState({
                        selected: this.getOptionByValue(e.options, e.value)
                    }) : void 0 === e.value && this.setState({
                        selected: {
                            label: e.placeholder || s,
                            value: ""
                        }
                    })
                }, t.prototype.componentDidMount = function() {
                    this.el = i.findDOMNode(this), document.addEventListener("click", this.handleDocumentClick, !1), document.addEventListener("touchend", this.handleDocumentClick, !1)
                }, t.prototype.componentWillUnmount = function() {
                    this.mounted = !1, document.removeEventListener("click", this.handleDocumentClick, !1), document.removeEventListener("touchend", this.handleDocumentClick, !1)
                }, t.prototype.getOptionByValue = function(e, t) {
                    return e.find(function(e) {
                        return "object" !== (void 0 === e ? "undefined" : a(e)) ? e === t : e.value === t
                    })
                }, t.prototype.renderOption = function(e) {
                    var t = this,
                        n = Object(o.a)("Select__option", {
                            "Select__option--selected": e === this.state.selected
                        }),
                        i = void 0 !== e.value ? e.value : e.label || e,
                        a = void 0 !== e.label ? e.label : e;
                    return r.createElement("div", {
                        key: i,
                        className: n,
                        onMouseDown: function() {
                            return t.setValue(i, a)
                        },
                        onClick: function() {
                            return t.setValue(i, a)
                        }
                    }, a)
                }, t.prototype.buildMenu = function() {
                    var e = this,
                        t = this.props.options.map(function(t) {
                            return "group" === t.type ? r.createElement("div", {
                                className: "Select__group",
                                key: t.name
                            }, t.name && r.createElement("div", {
                                className: "Select__title"
                            }, t.name), t.items.map(function(t) {
                                return e.renderOption(t)
                            })) : e.renderOption(t)
                        });
                    return t.length ? t : r.createElement("div", {
                        className: "Select__noresults"
                    }, "No options found")
                }, t.prototype.render = function() {
                    var e = this.props,
                        t = e.className,
                        n = e.style,
                        i = Object(o.a)("Select", t, {
                            "Select--opened": this.state.opened,
                            "Select--disabled": this.props.disabled
                        });
                    return r.createElement("div", {
                        className: i,
                        style: n
                    }, r.createElement("div", {
                        className: "Select__control",
                        onClick: this.handleMouseDown
                    }, r.createElement("div", {
                        className: "Select__placeholder"
                    }, "string" == typeof this.state.selected ? this.state.selected : this.state.selected.label), r.createElement("span", {
                        className: "Select__arrow"
                    })), this.state.opened && r.createElement("div", {
                        className: "Select__menu"
                    }, this.buildMenu()))
                }, t
            }(r.Component);
        t.a = c
    },
    nAFc: function(e, t, n) {
        "use strict";
        n.d(t, "c", function() {
            return a
        }), n.d(t, "a", function() {
            return s
        }), n.d(t, "b", function() {
            return c
        }), n.d(t, "d", function() {
            return u
        });
        var r = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            i = window.Emoji,
            o = [
                ["&amp;", "&"],
                ["&lt;", "<"],
                ["&gt;", ">"],
                ["&quot;", '"']
            ];

        function a(e) {
            return o.reduce(function(e, t) {
                var n = r(t, 2),
                    i = n[0],
                    o = n[1];
                return e.replace(new RegExp(o, "ig"), i)
            }, e)
        }

        function s(e) {
            return o.reduce(function(e, t) {
                var n = r(t, 2),
                    i = n[0],
                    o = n[1];
                return e.replace(new RegExp(i, "ig"), o)
            }, e).replace(/&#(\d+);/g, function(e, t) {
                return String.fromCodePoint(t)
            })
        }

        function c(e) {
            return a(e).replace(/[\u00A0-\u9999<>\&]/gim, function(e) {
                return "&#" + e.charCodeAt(0) + ";"
            })
        }

        function u(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                n = t.lineBreak,
                r = void 0 !== n && n,
                o = t.convertEmoji,
                c = void 0 === o || o,
                u = s(e);
            return u = u.replace(/\n\r/gi, "\n"), "oneline" === r ? u = u.replace(/<br>/gi, " ").replace(/\n/gi, " ") : "html" === r && (u = u.replace(/\n/gi, "<br>")), u = a(u), c && (u = i.emojiToHTML(u, !0)), u
        }
    },
    nGyu: function(e, t, n) {
        var r = n("K0xU")("unscopables"),
            i = Array.prototype;
        void 0 == i[r] && n("Mukb")(i, r, {}), e.exports = function(e) {
            i[r][e] = !0
        }
    },
    ne8i: function(e, t, n) {
        var r = n("RYi7"),
            i = Math.min;
        e.exports = function(e) {
            return e > 0 ? i(r(e), 9007199254740991) : 0
        }
    },
    nh4g: function(e, t, n) {
        e.exports = !n("eeVq")(function() {
            return 7 != Object.defineProperty({}, "a", {
                get: function() {
                    return 7
                }
            }).a
        })
    },
    nyd8: function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return a
        }), n.d(t, "a", function() {
            return s
        });
        var r = window,
            i = r.nav,
            o = r.extend;

        function a(e) {
            var t = o({}, i.objLoc, e);
            Object.keys(t).filter(function(e) {
                return "" === t[e]
            }).forEach(function(e) {
                delete t[e]
            });
            var n = i.toStr(t);
            i.setLoc(n)
        }

        function s() {
            var e = {};
            return {
                scheduleNav: function(t) {
                    e = o(e, t)
                },
                commitNav: function() {
                    a(e), e = {}
                },
                scheduleNavWithTimeOut: function(t) {
                    var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 100;
                    e = o(e, t), setTimeout(function() {
                        a(e), e = {}
                    }, n)
                }
            }
        }
    },
    "p+C8": function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return a
        });
        var r = n("q1tI"),
            i = n("pemR"),
            o = (n("17x9"), Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            });

        function a(e) {
            var t = e.icon,
                n = e.aside,
                a = e.chevron,
                s = e.selectable,
                c = e.border,
                u = e.className,
                l = e.children,
                d = e.active,
                _ = e.canBeHovered,
                f = void 0 === _ || _,
                p = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["icon", "aside", "chevron", "selectable", "border", "className", "children", "active", "canBeHovered"]),
                m = {
                    "ListItem--chevron": !!a,
                    "ListItem--selectable": !!s,
                    "ListItem--border": !!c,
                    "ListItem--active": !!d,
                    "ListItem--can-be-hovered": f
                };
            return r.createElement("li", o({}, p, {
                className: Object(i.a)("ListItem", m, u)
            }), t && r.createElement("div", {
                className: "ListItem__icon"
            }, t), r.createElement("div", {
                className: "ListItem__main"
            }, l), r.createElement("div", {
                className: "ListItem__aside"
            }, n))
        }
        a.defaultProps = {
            onClick: function() {},
            icon: null,
            aside: null,
            chevron: !1,
            selectable: !0,
            border: !0
        }
    },
    p3re: function(e, t, n) {
        "use strict";
        n.d(t, "e", function() {
            return u
        }), n.d(t, "c", function() {
            return l
        }), n.d(t, "f", function() {
            return d
        }), n.d(t, "d", function() {
            return p
        }), n.d(t, "a", function() {
            return m
        }), n.d(t, "b", function() {
            return g
        });
        var r = n("h++7"),
            i = void 0,
            o = window,
            a = o.clean,
            s = o.replaceEntities,
            c = o.statlogsValueEvent;

        function u(e, t) {
            for (var n = void 0, i = 0, o = e; null !== (n = r.s.exec(e));) {
                var a = (n = _(n))[0].length,
                    s = n.index + a,
                    c = e[n.index - 1],
                    u = e[s - 1],
                    l = void 0 !== c && /([\w\$А-Яа-яёЁєЄҐґЇїІіЈј\—\-\_@;.])/i.test(c),
                    d = void 0 !== u && /([:;$])/i.test(u);
                if (!l && !d) {
                    var p = f(n),
                        m = p.domain.toLowerCase();
                    if (m.length <= r.p && -1 !== r.y.indexOf(m)) {
                        var g = t(p);
                        o = o.slice(0, n.index + i) + g + o.slice(s + i), i += g.length - a
                    }
                }
            }
            return o
        }

        function l(e, t) {
            return e.replace(r.c, t || function(e) {
                return '<a href="mailto:' + e + '">' + e + "</a>"
            })
        }

        function d(e, t) {
            return e.replace(r.q, t || function(e, t, n, r, i) {
                return '<a href="/' + (t + n) + '" class="mem_link" mention="' + a(r || "") + '" mention_id="' + a(t + n) + '" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)">' + i + "</a>"
            })
        }

        function _(e) {
            if (!e[0] || !e[6]) return e;
            var t = e[0].length - 1,
                n = e[6].length - 1;
            return "." === e[0][t] && "." === e[6][n] && (e[0] = e[0].slice(0, t), e[6] = e[6].slice(0, n)), e
        }

        function f(e) {
            return {
                full: e[0],
                protocol: e[1] || "http://",
                url: e[2],
                domain: e[4],
                query: e[6] || ""
            }
        }

        function p(e, t) {
            return e.replace((i || (i = new RegExp(r.x, "ig")), i), function(e, n, r, i, o, a) {
                return (n || "") + t(r + (o || ""))
            })
        }

        function m(e) {
            c("ttl_message_confirm_delivery", e)
        }

        function g(e, t) {
            var n = t.protocol,
                i = t.url,
                o = t.query,
                c = t.domain,
                u = t.full;
            try {
                u = decodeURIComponent(u)
            } catch (e) {}
            if (u.length > 55 && (u = u.substr(0, 53) + ".."), u = a(u).replace(/&amp;/g, "&"), !e && c.match(r.t)) {
                var l, d = i = s(i).replace(r.f, encodeURIComponent),
                    _ = i.indexOf("#/"),
                    f = "";
                return _ >= 0 ? d = i.substr(_ + 1) : (_ = i.indexOf("#!")) >= 0 && (d = "/" + i.substr(_ + 2).replace(/^\//, "")), (l = d.match(r.B)) && l[1].length < 32 && (f = ' mention_id="' + l[1] + '" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"'), '<a href="' + function(e) {
                    return e.replace(/"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;")
                }(n + i + o) + '" target="_blank"' + f + ">" + u + "</a>"
            }
            return '<a href="' + ("away.php?utf=1&to=" + encodeURIComponent(n + s(i + o))) + '" target="_blank" onclick="' + ("return goAway('" + a((n + i + o).replace(/'/g, "\\'")) + "', {}, event);") + '">' + u + "</a>"
        }
    },
    pemR: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return i
        });
        var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };

        function i() {
            var e = [];
            return [].concat(Array.prototype.slice.call(arguments)).forEach(function(t) {
                if (t) switch (void 0 === t ? "undefined" : r(t)) {
                    case "string":
                        e.push(t);
                        break;
                    case "object":
                        Object.keys(t).forEach(function(n) {
                            t[n] && e.push(n)
                        });
                        break;
                    default:
                        e.push("" + t)
                }
            }), e.join(" ")
        }
    },
    qKs0: function(e, t, n) {
        n("Btvt"), n("XfO3"), n("rGqo"), n("9AAn"), e.exports = n("g3g5").Map
    },
    rCUf: function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return a
        }), n.d(t, "c", function() {
            return i
        }), n.d(t, "d", function() {
            return s
        });
        var r = n("8h6g");

        function i(e) {
            var t = r.b.slice(0, r.b.length);
            if ("types" === e) {
                for (var n = t.length, i = 0; i < n; ++i) t.push(t[i].toUpperCase());
                return "*." + t.join(";*.")
            }
            return "accept" === e ? "." + r.b.join(",.") : ""
        }

        function o(e) {
            if (!cur.leaving) {
                var t = getLang("video_upload_changed"),
                    n = !1;
                if (each(window.cur.videoUploaders, function(e, t) {
                        Upload.isSomethingUploading(t) && (n = !0)
                    }), 1 === e) {
                    if (!n) return !0;
                    var r = showFastBox({
                        title: getLang("global_warning"),
                        dark: !0
                    }, t, getLang("global_continue"), function() {
                        cur.leaving = !0, r.hide(), cur.onContinueCb && cur.onContinueCb()
                    }, getLang("global_cancel"), function() {
                        r.hide(), nav.objLoc.section = "upload", nav.setLoc(nav.objLoc)
                    });
                    return !1
                }
                return n ? winToUtf(t.replace(/<\/?b>/g, "").replace(/<br\s*\/?>/g, "\n")) : void 0
            }
        }

        function a(e, t, n, a, c) {
            if (n) {
                a = a || cur, (c = c || {}).onUploadStart || (c.onUploadStart = function(e) {
                    boxQueue.hideLast(), cur.nav.push(function(e, t, n) {
                        if (!1 === o(1)) return cur.onContinueCb = nav.go.pbind(n), !1
                    }), cur.prevBefUnload = window.onbeforeunload, window.onbeforeunload = o, c.onUploadProgress(e, 0, 0), Wall.showEditPost && Wall.showEditPost(), c.onUploadStartDone && c.onUploadStartDone()
                }), c.onUploadComplete || (c.onUploadComplete = function(e, t) {
                    var n = window.parseJSON(t);
                    n.video_id ? s(e, n, a) : "string" == typeof t && t.indexOf("TERMINATED") > -1 || Upload.onUploadError(e);
                    c.onUploadCompleteDone && c.onUploadCompleteDone(), setTimeout(function() {
                        c.onUploadAllCompleteDone && !window.Upload.isSomethingUploading(e.ind) && c.onUploadAllCompleteDone()
                    })
                }), c.onUploadProgress || (c.onUploadProgress = function(e, t, n) {
                    var r = void 0 !== e.ind ? e.ind : e;
                    show("_im_media_preview"), a.showMediaProgress && a.showMediaProgress("video", r, function(e, t, n) {
                        return {
                            loaded: t,
                            total: n,
                            fileName: e.fileName ? e.fileName.replace(/[&<>"']/g, "") : void 0
                        }
                    }(e, t, n))
                }), c.onUploadError || (c.onUploadError = function(e, t) {
                    statlogsValueEvent("upload_video_fails", 1, n.options.server, t),
                        function(e) {
                            var t = void 0 !== e.ind ? e.ind : e,
                                n = e.fileName ? t + "_" + e.fileName : e;
                            if (re("upload" + n + "_progress_wrap"), !geByClass1("popup_box_container")) {
                                var r = getLang("video_upload_error");
                                setTimeout(showFastBox({
                                    title: getLang("global_error")
                                }, r).hide, 2e3)
                            }
                            topError("Upload failed", {
                                dt: -1,
                                type: 102,
                                url: (ge("file_uploader_form" + t) || {}).action
                            }), Upload.embed(t)
                        }(e)
                }), cur.maxFiles = (cur.chooseParams || {}).maxFiles || 10;
                var u = cur.maxFiles - (cur.savedVideos || []).length,
                    l = browser.safari ? "" : "video/*," + i("accept");
                n.lang && (cur.lang = extend(cur.lang || {}, n.lang));
                var d = {
                        accept: l,
                        file_input: null,
                        file_name: "video_file",
                        file_size_limit: 1024 * (n.options.file_size_limit_in_GB || r.c) * 1024 * 1024,
                        file_types_description: "Video files",
                        file_types: i("types"),
                        chooseBox: 1,
                        chunked: 1,
                        chunkSize: r.a,
                        clear: 1,
                        dragEl: t === boxLayerWrap ? boxLayerWrap : bodyNode,
                        dropbox: t,
                        from: n.vars.from,
                        lang: n.lang,
                        max_attempts: 3,
                        max_files: u,
                        multiple: 1,
                        multi_progress: 1,
                        requestOptionsForFile: !0,
                        type: "video",
                        visibleDropbox: !n.options.hasOwnProperty("visible_dropbox") || n.options.visible_dropbox
                    },
                    _ = Upload.init(e, "", {}, Object.assign(d, c));
                return window.cur.videoUploaders || (window.cur.videoUploaders = []), window.cur.videoUploaders.push(_), _
            }
        }

        function s(e, t, n, r) {
            n = n || cur;
            var i = void 0 !== e.ind ? e.ind : e,
                o = (e.fileName || e.filename || "").replace(/[&<>"']/g, ""),
                a = o ? i + "_" + o : e,
                s = t.owner_id + "_" + t.video_id,
                c = ge("upload" + a + "_progress_wrap");
            c && hide(geByClass1("progress_x", c)), ajax.post("al_video.php?act=a_videos_attach_info", {
                videos: s
            }, {
                onDone: function(e) {
                    n.chooseMedia("video", s, extend(e[s], {
                        upload_ind: a,
                        upload_new: !0
                    }));
                    var i = t.owner_id,
                        o = t.video_id,
                        c = t.video_hash,
                        u = 0;
                    ! function t() {
                        ajax.post("al_video.php", {
                            act: "encode_progress",
                            oid: i,
                            vid: o,
                            hash: c,
                            need_thumb: 1
                        }, {
                            onDone: function(c) {
                                var u, l = !0;
                                if (c) {
                                    if (c.error) return u = getLang("video_upload_encode_error"), void setTimeout(showFastBox({
                                        title: getLang("global_error")
                                    }, u).hide, 2e3);
                                    c.thumb && (l = !1, ajax.post("al_video.php", {
                                        act: "a_video_photo_sizes",
                                        oid: i,
                                        vid: o
                                    }, {
                                        onDone: function(t) {
                                            n.hasChosenMedia("video", s) ? n.updateChosenMedia("video", s, extend(t, {
                                                upload_ind: a,
                                                upload_new: !0
                                            })) : r && r(e, s)
                                        }
                                    }))
                                }
                                l && n.hasChosenMedia("video", s) && setTimeout(t, 1e3)
                            },
                            onFail: function() {
                                ++u < 3 && setTimeout(t, 2e3 * u)
                            }
                        })
                    }()
                }
            })
        }
        t.a = {
            getUploadModule: function(e, t, n, r, i) {
                return a(e, t, n, r, i)
            },
            initModalVideoUploader: function() {
                var e = cur.videoUploadParams,
                    t = ge("choose_video_upload");
                return !!t && (this.initDragEvents(), a(t, boxLayerWrap, e))
            },
            initDragEvents: function() {
                var e = function(e) {
                        cur.dragTimeout && (clearTimeout(cur.dragTimeout), delete cur.dragTimeout);
                        var t = ge("video_choose_upload_area_wrap");
                        if (!hasClass(t, "video_choose_upload_area_enter")) {
                            addClass(t, "video_choose_upload_area_enter");
                            var n = ge("video_choose_wrap"),
                                r = getXY(n)[1],
                                i = getSize(t)[1];
                            return hide("video_choose_wrap"), setStyle(t, "height", scrollGetY() + window.clientHeight() - r + i), cancelEvent(e)
                        }
                    },
                    t = function(e) {
                        return cancelEvent(e)
                    },
                    n = function(e) {
                        if (t(), e.dataTransfer.files.length && Upload.checkFilesSizes(window.videoInlineUploader, e.dataTransfer.files)) return window.Upload && Upload.checked && Upload.checked[window.videoInlineUploader] && Upload.onFileApiSend(window.videoInlineUploader, e.dataTransfer.files), cancelEvent(e)
                    },
                    r = function() {
                        addEvent(boxLayerWrap, "dragenter dragover", e), addEvent(boxLayerWrap, "dragleave", t), addEvent(boxLayerWrap, "drop", n)
                    };
                r(), setTimeout(curBox().setOptions.pbind({
                    onHide: function() {
                        removeEvent(boxLayerWrap, "dragenter dragover", e), removeEvent(boxLayerWrap, "dragleave", t), removeEvent(boxLayerWrap, "drop", n)
                    },
                    onShow: function() {
                        r()
                    }
                }), 0)
            }
        }
    },
    rGqo: function(e, t, n) {
        for (var r = n("yt8O"), i = n("KroJ"), o = n("dyZX"), a = n("Mukb"), s = n("hPIQ"), c = n("K0xU"), u = c("iterator"), l = c("toStringTag"), d = s.Array, _ = ["NodeList", "DOMTokenList", "MediaList", "StyleSheetList", "CSSRuleList"], f = 0; f < 5; f++) {
            var p, m = _[f],
                g = o[m],
                h = g && g.prototype;
            if (h)
                for (p in h[u] || a(h, u, d), h[l] || a(h, l, m), s[m] = d, r) h[p] || i(h, p, r[p], !0)
        }
    },
    rHUl: function(e, t, n) {
        "use strict";
        n.d(t, "h", function() {
            return l
        }), n.d(t, "K", function() {
            return d
        }), n.d(t, "o", function() {
            return _
        }), n.d(t, "f", function() {
            return f
        }), n.d(t, "j", function() {
            return p
        }), n.d(t, "t", function() {
            return m
        }), n.d(t, "g", function() {
            return g
        }), n.d(t, "s", function() {
            return h
        }), n.d(t, "n", function() {
            return b
        }), n.d(t, "b", function() {
            return v
        }), n.d(t, "J", function() {
            return y
        }), n.d(t, "l", function() {
            return O
        }), n.d(t, "k", function() {
            return j
        }), n.d(t, "P", function() {
            return w
        }), n.d(t, "d", function() {
            return E
        }), n.d(t, "m", function() {
            return k
        }), n.d(t, "q", function() {
            return C
        }), n.d(t, "z", function() {
            return x
        }), n.d(t, "G", function() {
            return P
        }), n.d(t, "D", function() {
            return M
        }), n.d(t, "B", function() {
            return T
        }), n.d(t, "y", function() {
            return I
        }), n.d(t, "e", function() {
            return S
        }), n.d(t, "I", function() {
            return D
        }), n.d(t, "E", function() {
            return B
        }), n.d(t, "O", function() {
            return L
        }), n.d(t, "F", function() {
            return A
        }), n.d(t, "w", function() {
            return R
        }), n.d(t, "N", function() {
            return N
        }), n.d(t, "C", function() {
            return U
        }), n.d(t, "A", function() {
            return W
        }), n.d(t, "a", function() {
            return H
        }), n.d(t, "L", function() {
            return K
        }), n.d(t, "r", function() {
            return q
        }), n.d(t, "M", function() {
            return F
        }), n.d(t, "H", function() {
            return z
        }), n.d(t, "p", function() {
            return V
        }), n.d(t, "c", function() {
            return Q
        }), n.d(t, "x", function() {
            return G
        }), n.d(t, "i", function() {
            return X
        }), n.d(t, "u", function() {
            return Y
        }), n.d(t, "v", function() {
            return J
        }), n.d(t, "Q", function() {
            return Z
        }), n.d(t, "R", function() {
            return $
        });
        var r = n("MhhX"),
            i = n("f01n"),
            o = n("h++7"),
            a = n("86+7"),
            s = n("rjmT"),
            c = n("aong"),
            u = n("lJdi");

        function l(e, t) {
            var n = Object(c.r)(e),
                i = n.tabs[n.peer];
            return Object.keys(i.msgs).filter(function(n) {
                var o = k(e, t, n);
                return !Object(r.k)(o) && intval(n) > i.in_up_to
            })[0]
        }

        function d(e) {
            return Object(c.r)(e).searchShown
        }

        function _(e) {
            return Object(c.r)(e).peer
        }

        function f(e) {
            return p(e, _(e))
        }

        function p(e, t) {
            return (m(e, t) || {}).keyboard
        }

        function m(e, t) {
            var n = Object(c.r)(e);
            return n.tabs && n.tabs[t]
        }

        function g(e) {
            var t = Object(c.r)(e);
            return t.peer ? t.tabs[t.peer] : null
        }

        function h(e) {
            return Object(c.r)(e).selectedMessages
        }

        function b(e, t, n) {
            var i = m(e, t),
                o = h(e)[0];
            if (void 0 === o) return [n];
            var a = Math.min(n, o),
                s = Math.max(n, o);
            return Object.keys(i.msgs).filter(function(e) {
                return e >= a && e <= s
            }).filter(function(t) {
                var n = k(e, e.get().peer, t);
                return !Object(r.l)(n) && !Object(r.e)(n)
            }).map(intval)
        }

        function v(e, t) {
            var n = m(Object(c.r)(t), e),
                i = 0;
            for (var o in n.msgs)
                if (n.msgs.hasOwnProperty(o)) {
                    var a = k(t, e, o);
                    Object(r.k)(a) || (i += Object(r.n)(n, a) ? 1 : 0)
                }
            return i
        }

        function y(e, t, n) {
            return !! function(e, t, n) {
                var r = m(e, t);
                return Object.keys(r.msgs).filter(function(r) {
                    return intval(k(e, t, r).randomId) === n
                }).length > 0
            }(e, t, n)
        }

        function O(e, t) {
            var n = Object(c.r)(e),
                r = n.msg_local_ids_sort && n.msg_local_ids_sort[t];
            return void 0 !== r ? 2e9 + r : t
        }

        function j(e, t, n) {
            var r = m(e, t),
                o = k(e, t, n),
                a = Object.keys(r.msgs).filter(function(n) {
                    var r = k(e, t, n),
                        a = r.local && r.type !== i.g;
                    return !(!o.local && a) && (!(!o.local || a) || O(e, o.messageId) > O(e, r.messageId))
                }).pop();
            return a ? k(e, t, a) : null
        }

        function w(e) {
            return e && e.length > 0 ? i.Z([0].concat(e)) : e
        }

        function E(e, t, n) {
            var i = m(e, t),
                o = k(e, t, n),
                s = Object(c.r)(e);
            return Object(r.k)(o) ? Object(a.c)(e, s.id).name : o.userId !== o.peerId ? !!Object(a.b)(e, o.userId) && Object(a.c)(e, o.userId).name : i.tab
        }

        function k(e, t, n) {
            var r = m(e, t),
                i = r && r.msgs && r.msgs[n];
            return i ? w(i) : null
        }

        function C(e, t, n) {
            var r = m(e, t),
                i = r && r.msgs && Object.keys(r.msgs).sort(function(e, t) {
                    return +e - t
                });
            if (!i) return null;
            var o = i && i.indexOf("" + n),
                a = o > -1 ? i[o - 1] : null;
            return r.msgs[a]
        }

        function x(e) {
            var t = Object(c.r)(e);
            return t.gid || t.isClassic
        }

        function P(e) {
            return Object(c.r)(e).gid
        }

        function M(e) {
            return Object(c.r)(e).gid
        }

        function T(e) {
            return !!Object(c.r)(e).gid
        }

        function I(e, t) {
            return !!(t.peerId > 2e9 && Object(u.m)(t, 1024))
        }

        function S(e, t) {
            var n = Object(c.r)(t);
            return n.tabs[e] || n.mapped_index[e]
        }

        function D(e) {
            var t = Object(c.r)(e);
            return !!T(e) && ((19542789 === t.gid || 103416369 == t.gid) && (t.active_tab === o.n || t.active_tab === o.m))
        }

        function B(e, t) {
            var n = (e = Object(c.r)(e)).tabs;
            return !(!n || !n[t] || void 0 === n[t].history || !n[t].msgs)
        }

        function L(e, t) {
            var n = m(e, t);
            n && (n.msgs = void 0, n.msgid = void 0, n.scrollTop = void 0, n.scrollBottom = void 0, n.contHeight = void 0, n.offset = void 0, n.skipped = void 0)
        }

        function A(e) {
            var t = e.get().go_to_end_visible;
            return !!t && t[0]
        }

        function R(e) {
            var t = e.get().go_to_end_visible;
            return t ? t[1] : 0
        }

        function N(e) {
            return !Object(c.r)(e).lockedSending
        }

        function U(e) {
            return e > -2e9 && e < 0
        }

        function W(e, t) {
            return !!U(t) && !!m(e, t).blocked_community
        }

        function H(e) {
            return Object(c.r)(e).voice_message_available
        }

        function K(e) {
            var t = Object(c.r)(e);
            return !(!q(t) && !t.recentSearch)
        }

        function q(e) {
            return Object(c.r)(e).searchText
        }

        function F(e, t) {
            var n = Object(c.r)(e);
            return !!(t && t !== q(e) || n.recentSearch)
        }

        function z(e) {
            return Object(c.r)(e).recentSearch
        }

        function V(e) {
            var t = g(e);
            return t && t.pinned && w(t.pinned)
        }

        function Q(e) {
            var t = e.get().popular_sugg;
            return t && t.length > 0
        }

        function G(e) {
            return 1 == Object(c.r)(e).isEditing
        }

        function X(e) {
            return Object(c.r)(e).gid
        }

        function Y(e) {
            return e.draft || (e.draft = Object(s.b)(cur.imDb, e.peerId)), e.draft
        }

        function J(e) {
            return (Object(c.r)(e).templates || []).filter(function(e) {
                return !e.deleted
            })
        }

        function Z(e) {
            return e.is_message_request || e.folders & o.j[o.k] || e.folders & o.j[o.l]
        }

        function $(e) {
            return e.peerId > 19e8 && e.peerId < 2e9
        }
    },
    rjmT: function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return s
        }), n.d(t, "b", function() {
            return u
        });
        var r = n("BxOC"),
            i = n("f01n"),
            o = n("vT4u"),
            a = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }();

        function s(e, t) {
            this._db = e, this._key = t, this.dData = {
                txt: "",
                attaches: [],
                urlBinds: [],
                cancelled: []
            }, this.load()
        }

        function c(e) {
            switch (e.type) {
                case "mail":
                case "reply":
                    return e.id < 0 && 1 == e.object.fwd_count;
                default:
                    return !e.object
            }
        }

        function u(e, t) {
            return new s(e, "draft_" + t)
        }
        s.prototype.dump = function() {
            var e;
            this._key && this._db.updateByKey(this._key, {
                txt: (e = this.dData).txt,
                attaches: e.attaches.length ? e.attaches : void 0,
                urlBinds: e.urlBinds.length ? e.urlBinds : void 0,
                cancelled: e.cancelled.length ? e.cancelled : void 0
            })
        }, s.prototype.load = function() {
            if (this._key) {
                var e = this._db.selectByKey(this._key);
                e && (this.dData = function(e) {
                    return {
                        txt: e.txt,
                        attaches: e.attaches || [],
                        urlBinds: e.urlBinds || [],
                        cancelled: e.cancelled || []
                    }
                }(e))
            }
        }, s.prototype.clear = function() {
            this.dData = {
                txt: "",
                attaches: [],
                urlBinds: [],
                cancelled: []
            }, this.dump()
        }, s.prototype.setText = function(e) {
            this.dData.txt = trim(e), this.dump()
        }, s.prototype.addAttach = function(e, t, n) {
            if ("share" === e && this.removeAttachByType(e), "mail" !== e && "reply" !== e || (this.removeAttachByType("mail"), this.removeAttachByType("reply")), !e || !t && "poll" !== e) return !1;
            var r = this.dData.attaches.findIndex(function(n) {
                return n.type === e && n.id === t
            }); - 1 === r ? (this.dData.attaches.push({
                type: e,
                id: t,
                object: n
            }), this.dump()) : "video" !== e && "poll" !== e || (this.dData.attaches[r] = {
                type: e,
                id: t,
                object: n
            }, this.dump())
        }, s.prototype.syncWithSelector = function(e) {
            var t = this,
                n = this.getFwdRaw();
            this.dData.attaches = (n ? [n] : []).concat(e.getMedias().map(function(e) {
                var n = a(e, 2),
                    r = n[0],
                    i = n[1];
                return t.dData.attaches.find(function(e) {
                    return e.type == r && e.id == i
                }) || {
                    type: r,
                    id: i
                }
            })), this.dump()
        }, s.prototype.removeAttachByType = function(e) {
            for (var t = this.dData.attaches.length; t--;) this.dData.attaches[t].type === e && this.dData.attaches.splice(t, 1);
            this.dump()
        }, s.prototype.removeAllAttaches = function() {
            this.dData.attaches = [], this.dData.cancelled = [], this.dump()
        }, s.prototype.addBindUrl = function(e, t, n) {
            this.getBoundAttach(e) || (this.dData.urlBinds.push({
                url: e,
                type: t,
                id: n
            }), this.dump())
        }, s.prototype.getBoundAttach = function(e) {
            var t = this.dData.urlBinds.find(function(t) {
                return t.url === e
            });
            return t && this.dData.attaches.find(function(e) {
                return e.type === t.type && e.id === t.id
            }) || null
        }, s.prototype.getShareUrl = function() {
            var e = this.dData.attaches.find(function(e) {
                return "share" === e.type
            });
            if (e && e.object) return e.object.url
        }, s.prototype.hasOnlyReplies = function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null;
            return e ? e.flags & i.k && !this.dData.attaches.find(function(e) {
                return "mail" !== e.type
            }) : this.hasAttaches() && !this.dData.attaches.find(function(e) {
                return "reply" !== e.type
            })
        }, s.prototype.getCancelledShares = function() {
            return this.dData.cancelled.length ? this.dData.cancelled : void 0
        }, s.prototype.hasAttaches = function() {
            return this.dData.attaches.length > 0
        }, s.prototype.destroy = function() {
            this.dData = {}, this._key = this._db = null
        }, s.prototype.prepareObjects = function(e, t) {
            var n = this;
            return this.dData.attaches.find(c) ? Object(r.b)(o.e, {
                act: "draft_medias",
                gid: e,
                messageId: t || 0,
                media: t ? void 0 : this.dData.attaches.map(function(e) {
                    return [e.type, e.id]
                }).join("*")
            }).then(function(e) {
                var t = a(e, 1)[0];
                n.dData.attaches = t.map(function(e) {
                    return {
                        type: e[0],
                        id: e[1],
                        object: e[2]
                    }
                })
            }) : Promise.resolve()
        }, s.prototype.getFwdRaw = function() {
            return this.dData.attaches.find(function(e) {
                return "mail" === e.type || "reply" === e.type
            })
        }, s.prototype.getFwdCount = function() {
            var e = this.getFwdRaw();
            return e ? e.id < 0 ? e.object.fwd_count : e.id.split(";").length : 0
        }
    },
    ryw6: function(__webpack_module__, __webpack_exports__, __webpack_require__) {
        "use strict";
        __webpack_require__.d(__webpack_exports__, "d", function() {
            return topMsg
        }), __webpack_require__.d(__webpack_exports__, "c", function() {
            return topError
        }), __webpack_require__.d(__webpack_exports__, "b", function() {
            return showMsg
        }), __webpack_require__.d(__webpack_exports__, "a", function() {
            return showGlobalPrg
        });
        var _dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("zxIV"),
            _utils_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("t7n3");

        function topMsg(e, t, n) {
            if (n || (n = "#D6E5F7"), e) {
                clearTimeout(window.topMsgTimer);
                var r = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.F)("system_msg");
                r.style.backgroundColor = n, r.innerHTML = e, Object(_dom__WEBPACK_IMPORTED_MODULE_0__.Ta)(r), t && (window.topMsgTimer = setTimeout(topMsg.pbind(!1), 1e3 * t))
            } else Object(_dom__WEBPACK_IMPORTED_MODULE_0__.W)("system_msg")
        }

        function topError(text, opts) {
            if (opts || (opts = {}), text.message) {
                var error = text;
                text = "<b>JavaScript error:</b> " + error.message, opts.stack = error.stack, error.stack && __debugMode && (text += "<br/>" + error.stack.replace(/\n/g, "<br/>"));
                try {
                    console.log(error.stack)
                } catch (e) {}
            }
            if (!opts.stack) try {
                eval("0 = 1")
            } catch (e) {
                opts.stack = e.stack
            } - 1 != opts.dt && topMsg(text, opts.dt, "#FFB4A3"), __dev || Object(_dom__WEBPACK_IMPORTED_MODULE_0__.F)("debuglogwrap") || (delete opts.dt, ajax.plainpost("/errors.php", Object(_utils_common__WEBPACK_IMPORTED_MODULE_1__.i)(opts, {
                msg: opts.msg || text,
                module: (window.cur || {}).module,
                id: vk.id,
                host: locHost,
                lang: vk.lang,
                loc: (window.nav || {}).strLoc,
                realloc: location.toString()
            })))
        }

        function showMsg(e, t, n, r) {
            var i = "msg" + ("msg" !== n ? " " + n : "");
            r && (i += " msg_appear"), e = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.F)(e);
            var o = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.H)(n, e),
                a = o || Object(_dom__WEBPACK_IMPORTED_MODULE_0__.u)(e),
                s = e.insertBefore(Object(_dom__WEBPACK_IMPORTED_MODULE_0__.e)("div", {
                    className: i,
                    innerHTML: '<div class="msg_text">' + t + "</div>"
                }), a);
            o && Object(_dom__WEBPACK_IMPORTED_MODULE_0__.Fa)(o), setTimeout(_dom__WEBPACK_IMPORTED_MODULE_0__.Ha.pbind(s, "msg_appear"), 0)
        }

        function showGlobalPrg(e, t) {
            var n = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.Q)(e),
                r = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.N)(e),
                i = t || {},
                o = i.w,
                a = void 0 === o ? 32 : o,
                s = i.h,
                c = void 0 === s ? 13 : s,
                u = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.F)("global_prg");
            u.className = i.cls || "progress", Object(_dom__WEBPACK_IMPORTED_MODULE_0__.Qa)(u, {
                left: n[0] + Math.floor((r[0] - a) / 2) + Object(_utils_common__WEBPACK_IMPORTED_MODULE_1__.r)(i.shift ? i.shift[0] : 0),
                top: n[1] + Math.floor((r[1] - c) / 2) + Object(_utils_common__WEBPACK_IMPORTED_MODULE_1__.r)(i.shift ? i.shift[1] : 0),
                width: a,
                height: c,
                display: "block",
                "z-index": i.zIndex ? i.zIndex : null
            }), i.hide && (e.style.visibility = "hidden")
        }
    },
    "uW+i": function(e, t, n) {
        "use strict";
        var r = n("q1tI"),
            i = (n("17x9"), n("pemR"));
        var o = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                r.getActiveTab = function() {
                    var e = r.props.active,
                        t = [],
                        n = null;
                    return r.props.children.forEach(function(r) {
                        r.key === e ? n = r : t.push(r)
                    }), n || (Number.isInteger(e) && t.length > e ? t[e] : t[0])
                }, r.onClick = function(e, t) {
                    if (t !== r.state.active) {
                        var n = r.refsStore[t],
                            i = r.getTransform(n);
                        r.setState({
                            active: t,
                            isAnimating: !0,
                            transform: i
                        }), r.props.onTabClick(e, t)
                    }
                }, r.onTransitionEnd = function(e) {
                    "transform" === e.propertyName && r.setState({
                        isAnimating: !1
                    })
                }, r.getRef = function(e, t) {
                    r.refsStore[e] = t
                };
                var i = r.getActiveTab();
                return r.refsStore = {}, r.state = {
                    isAnimating: !1,
                    active: i.key
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.reactifyTabs = function(e) {
                return (Array.isArray(e) ? e : Object.values(e)).map(function(e) {
                    return r.createElement("a", {
                        key: e[0],
                        href: e[2],
                        onClick: function() {}
                    }, e[1] ? unclean(e[1]) : "")
                })
            }, t.prototype.componentDidUpdate = function(e, t, n) {
                this.props.active !== e.active && this.setState({
                    active: this.props.active
                })
            }, t.prototype.getTransform = function(e) {
                var t = e.offsetWidth;
                return "translateX(" + (e.offsetLeft - 50 + .5 * t) + "px) scaleX(" + t / 100 + ")"
            }, t.prototype.componentDidMount = function() {
                var e = this.refsStore[this.state.active];
                this.setState({
                    transform: this.getTransform(e)
                })
            }, t.prototype.render = function() {
                var e = this,
                    t = {
                        "Tabs--animating": this.state.isAnimating
                    };
                return r.createElement("nav", {
                    className: Object(i.a)("Tabs", this.props.className, t),
                    style: this.props.style
                }, r.createElement("ul", {
                    className: "Tabs__list"
                }, this.props.children.map(function(t, n) {
                    return r.createElement("li", {
                        className: Object(i.a)("Tabs__item", {
                            "Tabs__item--active": e.state.active === (t.key || n)
                        }),
                        onClick: function(r) {
                            return e.onClick(r, t.key || n)
                        },
                        ref: function(r) {
                            return e.getRef(t.key || n, r)
                        },
                        key: t.key || n
                    }, t)
                })), r.createElement("div", {
                    style: {
                        transform: this.state.transform
                    },
                    className: "Tabs__divider",
                    onTransitionEnd: this.onTransitionEnd
                }))
            }, t
        }(r.Component);
        t.a = o, o.defaultProps = {
            onTabClick: function() {},
            active: 0
        }
    },
    uytb: function(e, t, n) {
        "use strict";
        n.d(t, "b", function() {
            return i
        }), n.d(t, "a", function() {
            return o
        }), n.d(t, "c", function() {
            return u
        });
        var r = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }(),
            i = "recent_search",
            o = "pin_hide";

        function a(e) {
            return "im_store_" + e
        }

        function s(e) {
            return ls.get(a(e)) || {}
        }

        function c(e, t, n) {
            if (ls.checkVersion()) {
                var r = JSON.stringify(t);
                rand(0, 1e5) <= 1 && statlogsValueEvent("im_local_store_size", r.length), n(a(e), r)
            }
        }

        function u(e) {
            var t = debounce(function(e, t) {
                localStorage.setItem(e, t)
            }, 300);
            ls.checkVersion() && function(e, t) {
                for (var n = ["fwd", "draft", "bind_attach"], r = s(e), i = !1, o = n.length; o--;) n[o] in r && (delete r[n[o]], i = !0);
                i && c(e, r, t)
            }(e, t);
            var n = {
                    db: s(e),
                    checkTime: Date.now()
                },
                u = function(e, t, n) {
                    n.key === a(e) && (t.db = JSON.parse(n.newValue), t.checkTime = Date.now())
                }.bind(null, e, n);
            return window.addEventListener("storage", u, !1), {
                select: function(t, r) {
                    return Date.now() - n.checkTime > 1e3 && (n.db = s(e)),
                        function(e, t, n) {
                            return t === i ? e[t] || [] : t === o ? e[t] && e[t][n] : e[t] ? extend(!0, {}, e[t][n]) : null
                        }(n.db, t, r)
                },
                selectByKey: function(t) {
                    return Date.now() - n.checkTime > 1e3 && (n.db = s(e)), n.db[t]
                },
                update: function(a, s) {
                    var u = function(e, t, n) {
                        switch (e[t] || (e[t] = {}), t) {
                            case i:
                                var a = n;
                                a && a.length > 0 ? e[t] = a : delete e[t];
                                break;
                            case o:
                                var s = r(n, 2),
                                    c = s[0],
                                    u = s[1];
                                u ? e[t][c] = +u : delete e[t][c]
                        }
                        return e
                    }(n.db, a, s);
                    return n.db = u, n.checkTime = Date.now(), c(e, u, t)
                },
                updateByKey: function(r, i) {
                    return n.db[r] = i, n.checkTime = Date.now(), c(e, n.db, t)
                },
                unmount: function() {
                    window.removeEventListener("storage", u, !1)
                }
            }
        }
    },
    "v+DW": function(e, t, n) {
        "use strict";
        n.d(t, "q", function() {
            return l
        }), n.d(t, "y", function() {
            return d
        }), n.d(t, "d", function() {
            return _
        }), n.d(t, "a", function() {
            return f
        }), n.d(t, "n", function() {
            return p
        }), n.d(t, "v", function() {
            return m
        }), n.d(t, "m", function() {
            return g
        }), n.d(t, "p", function() {
            return h
        }), n.d(t, "x", function() {
            return b
        }), n.d(t, "o", function() {
            return v
        }), n.d(t, "w", function() {
            return y
        }), n.d(t, "b", function() {
            return O
        }), n.d(t, "k", function() {
            return j
        }), n.d(t, "f", function() {
            return w
        }), n.d(t, "t", function() {
            return E
        }), n.d(t, "l", function() {
            return k
        }), n.d(t, "c", function() {
            return C
        }), n.d(t, "e", function() {
            return x
        }), n.d(t, "s", function() {
            return P
        }), n.d(t, "r", function() {
            return M
        }), n.d(t, "u", function() {
            return T
        }), n.d(t, "i", function() {
            return I
        }), n.d(t, "g", function() {
            return S
        }), n.d(t, "h", function() {
            return D
        }), n.d(t, "j", function() {
            return B
        });
        var r = n("zxIV"),
            i = n("Egk5"),
            o = n("t7n3"),
            a = n("lXE5"),
            s = n("7jxN"),
            c = n("gdug"),
            u = n("4+be");

        function l(e, t, n) {
            if (e = Object(r.F)(e)) {
                n || Object(r.E)(e), void 0 === Object(r.i)(e, "backstyle") && Object(r.i)(e, "backstyle", e.style.backgroundColor || "");
                var i = Object(r.i)(e, "back") || Object(r.i)(e, "back", Object(r.O)(e, "backgroundColor")),
                    o = {
                        notice: "#FFFFE0",
                        warning: "#FAEAEA"
                    };
                Object(r.Qa)(e, "backgroundColor", o[t] || t || o.warning), setTimeout(s.b.pbind(e, {
                    backgroundColor: i
                }, 300, function() {
                    e.style.backgroundColor = Object(r.i)(e, "backstyle")
                }), 400)
            }
        }

        function d(e) {
            if (window.scrollNode && !c.a.mobile && window._tbLink) {
                var t = Object(r.F)("page_body"),
                    n = Object(r.Q)(t),
                    i = Object(a.e)(),
                    o = bodyNode.scrollLeft,
                    l = Object(r.F)("side_bar"),
                    d = Object(r.Aa)(l);
                if (window._stlSideTop = Math.max((d ? Object(r.N)(l)[1] : 0) - i - (c.a.mozilla ? Object(r.Q)(pageNode)[1] : 0), n[1]), e || o != __scrLeft) {
                    var _ = Object(r.F)("page_layout"),
                        f = vk.rtl ? _.offsetLeft + _.offsetWidth : 0,
                        p = vk.rtl ? (window.lastWindowWidth || 0) - f : _.offsetLeft;
                    Object(r.Qa)(_stlLeft, {
                        width: Math.max(p - 1, 0)
                    });
                    var m = vk.rtl ? n[0] + t.offsetWidth + 5 : p,
                        g = vk.rtl ? f - m : n[0] - 5 - m;
                    Object(r.Qa)(_stlSide, {
                        left: m - o,
                        width: Math.max(g, 0)
                    }), __scrLeft = o
                }
                Object(r.Qa)(_stlSide, {
                    top: _stlSideTop,
                    height: Math.max((window.lastWindowHeight || 0) - _stlSideTop, 0)
                }), __adsUpdate();
                var h = _tbLink.loc || _stlWas || i > 200,
                    b = i > 250 && cur._regBar,
                    v = 0,
                    y = !1;
                if (h) {
                    1 !== _stlShown && (Object(r.Ta)(_stlLeft, _stlSide), Object(r.a)(_stlLeft, "stl_active"), Object(r.a)(_stlSide, "stl_active"), _stlShown = 1), _tbLink.loc && cur._noUpLink && (i = 0), _stlWas && i > 500 && (_stlWas = 0), i > 200 ? (v = (i - 200) / 200, (_stlWasSet || _stlBack) && (_stlWasSet = _stlBack = 0, y = 1, Object(r.Ya)(_stlText, Object(u.d)("global_to_top")), Object(r.Ha)(_stlText, "down"), Object(r.Ha)(_stlText, "back"))) : (v = (200 - i) / 200, _stlWas ? _stlWasSet || (_stlWasSet = 1, y = 0, Object(r.Ya)(_stlText, ""), Object(r.a)(_stlText, "down"), _stlBack && (_stlBack = 0, Object(r.Ha)(_stlText, "back"))) : _tbLink.loc && (_stlBack || (_stlBack = 1, y = _tbLink.fast ? 1 : 0, Object(r.Ya)(_stlText, Object(u.d)("global_back")), Object(r.a)(_stlText, "back"), _stlWasSet && (_stlWasSet = 0, Object(r.Ha)(_stlText, "down"))))), !1 !== y && Object(r.Va)(_stlLeft, "over_fast", Object(r.V)(_stlLeft, "over") && y);
                    var O = {
                        opacity: Math.min(Math.max(v, 0), 1)
                    };
                    vk.staticheader && (O.top = -Math.min(Object(r.N)("page_header_cont")[1], i)), Object(r.Qa)(_stlLeft, O)
                } else 0 !== _stlShown && (Object(r.W)(_stlLeft, _stlSide), _stlShown = 0);
                vk.id || (!_regBar && b ? (_regBar = 1, Object(r.Ya)(Object(r.F)("reg_bar_content"), cur._regBar), Object(s.b)(Object(r.F)("reg_bar"), {
                    top: 0,
                    transition: s.a.Transitions.sineInOut
                }, 400), Object(s.b)(Object(r.F)("stl_bg"), {
                    paddingTop: 60,
                    transition: s.a.Transitions.sineInOut
                }, 400)) : _regBar && !b && (_regBar = 0, Object(s.b)(Object(r.F)("reg_bar"), {
                    top: -56,
                    transition: s.a.Transitions.sineInOut
                }, 400), Object(s.b)(Object(r.F)("stl_bg"), {
                    paddingTop: 13,
                    transition: s.a.Transitions.sineInOut
                }, 400)))
            }
        }

        function _(e, t) {
            if ((e = Object(r.F)(e)) && !e.btnevents)
                if (Object(r.V)(e, "flat_button")) Object(o.v)(t) && (e.onclick = t.pbind(e));
                else {
                    var n = e.parentNode;
                    if (Object(r.V)(n, "button_blue") || Object(r.V)(n, "button_gray")) Object(o.v)(t) && (e.onclick = t.pbind(e));
                    else {
                        var a = !1;
                        Object(i.b)(e, "click mousedown mouseover mouseout", function(o) {
                            if (!Object(r.V)(n, "locked")) switch (o.type) {
                                case "click":
                                    if (!a) return;
                                    return e.className = "button_hover", t(e), Object(i.c)(o);
                                case "mousedown":
                                    e.className = "button_down";
                                    break;
                                case "mouseover":
                                    a = !0, e.className = "button_hover";
                                    break;
                                case "mouseout":
                                    e.className = "button", a = !1
                            }
                        }), e.btnevents = !0
                    }
                }
        }

        function f(e) {
            var t = Object(r.F)(e);
            if (t) return Object(r.V)(t, "ui_actions_menu_item_lock")
        }

        function p(e) {
            if ((e = Object(r.F)(e)) && Object(r.V)(e, "ui_actions_menu_item") && !Object(r.V)(e, "ui_actions_menu_item_lock")) {
                Object(r.i)(e, "inner", e.innerHTML), Object(r.a)(e, "ui_actions_menu_item_lock");
                var t = Object(r.e)("div", {
                    className: "ui_actions_menu_item_lock_text"
                });
                Object(r.Ya)(t, e.innerHTML), e.appendChild(t), T(e)
            }
        }

        function m(e) {
            (e = Object(r.F)(e)) && Object(r.V)(e, "ui_actions_menu_item") && Object(r.V)(e, "ui_actions_menu_item_lock") && (Object(r.Ha)(e, "ui_actions_menu_item_lock"), e.innerHTML = Object(r.i)(e, "inner"))
        }

        function g(e) {
            var t = Object(r.F)(e);
            if (t) return Object(r.V)(t, "link_lock")
        }

        function h(e, t) {
            var n = Object(r.F)(e);
            n && "a" === n.tagName.toLowerCase() && !g(n) && (Object(r.a)(n, "link_lock"), t && Object(o.f)(t, function(e, t) {
                return Object(r.a)(n, t)
            }))
        }

        function b(e, t) {
            var n = Object(r.F)(e);
            n && g(n) && (Object(r.Ha)(n, "link_lock"), t && Object(o.f)(t, function(e, t) {
                return Object(r.Ha)(n, t)
            }))
        }

        function v(e) {
            var t = Object(r.F)(e);
            if (t && ("button" === t.tagName.toLowerCase() || Object(r.V)(t, "flat_button") || Object(r.V)(t, "wr_header")) && !j(t)) {
                var n = Object(r.N)(t);
                Object(r.a)(t, "flat_btn_lock"), Object(r.i)(t, "inner", t.innerHTML), Object(r.Qa)(t, {
                    width: n[0],
                    height: n[1]
                }), t.innerHTML = "", T(t, "btn_lock")
            }
        }

        function y(e) {
            var t = Object(r.F)(e);
            t && j(t) && (I(t), t.innerHTML = Object(r.i)(t, "inner"), Object(r.Ha)(t, "flat_btn_lock"), Object(r.Qa)(t, {
                width: null,
                height: null
            }))
        }

        function O(e) {
            return j(e)
        }

        function j(e) {
            var t = Object(r.F)(e);
            if (t) return Object(r.V)(t, "flat_btn_lock")
        }

        function w(e, t) {
            var n = Object(r.F)(e);
            if (n && "button" === n.tagName.toLowerCase())
                if (t) {
                    if (!Object(r.Aa)(n)) return;
                    n.parentNode.insertBefore(Object(r.e)("button", {
                        innerHTML: n.innerHTML,
                        className: n.className + " button_disabled"
                    }), n), Object(r.W)(n)
                } else {
                    var i = Object(r.A)(n);
                    i && Object(r.V)(i, "button_disabled") && Object(r.Fa)(i), Object(r.Ta)(n)
                }
        }

        function E(e) {
            if (void 0 === window._sbWidth || e) {
                var t = Object(r.e)("div", {
                    innerHTML: '<div style="height: 75px;">1<br>1</div>'
                }, {
                    overflowY: "scroll",
                    position: "absolute",
                    width: "50px",
                    height: "50px"
                });
                bodyNode.appendChild(t), window._sbWidth = Math.max(0, t.offsetWidth - t.firstChild.offsetWidth - 1), bodyNode.removeChild(t)
            }
            return window._sbWidth
        }

        function k(e) {
            return e = Object(r.F)(e), Object(r.V)(e, "on") ? 1 : ""
        }

        function C(e, t) {
            var n = Object(r.F)(e);
            if (n && !Object(r.V)(n, "disabled")) return void 0 === t && (t = !k(n)), Object(r.Va)(n, "on", t), n.setAttribute("aria-checked", t ? "true" : "false"), !1
        }

        function x(e, t) {
            return e = Object(r.F)(e), void 0 === t && (t = !Object(r.V)(e, "disabled")), Object(r.Va)(e, "disabled", t), "INPUT" === e.tagName && (t ? e.setAttribute("readonly", "readonly") : e.removeAttribute("readonly")), !1
        }

        function P(e) {
            return !!radioBtns[e] && radioBtns[e].val
        }

        function M(e, t, n) {
            if (radioBtns[n] && !Object(r.V)(e, "disabled")) return Object(o.f)(radioBtns[n].els, function() {
                this == e ? (Object(r.a)(this, "on"), this.setAttribute("aria-checked", "true"), this.setAttribute("tabindex", "0")) : (Object(r.Ha)(this, "on"), this.setAttribute && (this.setAttribute("aria-checked", "false"), this.setAttribute("tabindex", "-1")))
            }), radioBtns[n].val = t
        }

        function T(e, t, n, i) {
            if (e = Object(r.F)(e)) {
                var o = void 0;
                return Object(r.V)(e, "pr") ? o = e : (o = Object(r.Ma)(Object(r.La)(vk.pr_tpl, {
                    id: t || "",
                    cls: n || ""
                })), i ? Object(r.w)(o, e) : e.appendChild(o)), setTimeout(function() {
                    Object(r.Qa)(o, {
                        opacity: 1
                    })
                }), o
            }
        }

        function I(e) {
            e && (Object(r.V)(e, "pr") ? Object(r.Qa)(e, {
                opacity: 0
            }) : Object(r.Fa)(Object(r.H)("pr", e)))
        }

        function S(e) {
            Object(r.Qa)(e, "pointer-events", "none")
        }

        function D(e) {
            Object(r.Qa)(e, "pointer-events", "")
        }

        function B() {
            window.__scrLeft = 0, window.radioBtns = {}
        }
    },
    vRp6: function(e, t, n) {
        "use strict";
        var r = n("q1tI");
        n("17x9");
        var i = n("PjZB"),
            o = n("pemR"),
            a = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }();
        var s = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r, i, o, s, c, u = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return u.checkLoad = (r = function(e) {
                    var t = a(e, 3),
                        n = t[0],
                        r = t[1],
                        i = t[2];
                    if (!u.loading) return u.props.virtualized || u.props.hasMore ? void(r - n - i <= u.props.threshold && (u.loading = !0, u.props.loadMore().then(function() {
                        u.loading = !1
                    }))) : u.detachListeners()
                }, i = 34, o = !1, s = void 0, c = void 0, function e() {
                    if (o) return s = arguments, void(c = this);
                    r.apply(this, arguments), o = !0, setTimeout(function() {
                        o = !1, s && (e.apply(c, s), s = c = null)
                    }, i)
                }), u.onScroll = function(e) {
                    var t = u.getScrollData();
                    u.props.virtualized && u.processChildren(u.props.children, t), u.props.hasMore && u.checkLoad(t)
                }, u.getRef = function(e) {
                    u.container = e, u.props.virtualized && u.setState(u.getChildrenData(u.props.children, u.getScrollData()))
                }, u.useWindowScroll = n.useWindowScroll, n.virtualized && (u.state = {
                    before: 0,
                    after: n.children.length,
                    start: 0,
                    end: 0
                }), u
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.getScrollData = function() {
                var e = this.useWindowScroll ? document.documentElement : this.container;
                return [this.getScrollTop(), e ? e.scrollHeight : 0, e ? e.clientHeight : 0]
            }, t.prototype.getScrollTop = function() {
                var e = document.documentElement || document.body.parentNode || document.body;
                return this.useWindowScroll ? void 0 !== window.pageYOffset ? window.pageYOffset : e.scrollTop : this.container ? this.container.scrollTop : 0
            }, t.prototype.attachListeners = function() {
                var e = this.useWindowScroll ? window : this.container;
                this.container && (e.addEventListener("scroll", this.onScroll, this.props.useCapture), e.addEventListener("resize", this.onScroll, this.props.useCapture))
            }, t.prototype.detachListeners = function() {
                var e = this.useWindowScroll ? window : this.container;
                this.container && (e.removeEventListener("scroll", this.onScroll, this.props.useCapture), e.removeEventListener("resize", this.onScroll, this.props.useCapture))
            }, t.prototype.processChildren = function(e, t) {
                var n = this.state,
                    r = this.getChildrenData(e, t || this.getScrollData()),
                    i = r.start,
                    o = r.end,
                    a = r.before,
                    s = r.after;
                i === n.start && o === n.end && a === n.before && s === n.after || this.setState(r)
            }, t.prototype.getChildrenData = function(e, t) {
                var n = a(t, 3),
                    r = n[0],
                    i = n[1],
                    o = n[2],
                    s = this.useWindowScroll ? window : this.container,
                    c = s && s.offsetHeight;
                if (!s || 0 === i || 0 === o) return {
                    start: 0,
                    end: 0,
                    before: 0,
                    after: e.length
                };
                o = Math.max(o, c);
                var u = e.length,
                    l = Math.max(Math.floor(r / this.props.itemHeight) - 1, 0),
                    d = Math.min(Math.floor((r + 2 * o) / this.props.itemHeight + 1), u);
                return {
                    start: l,
                    end: d,
                    before: l,
                    after: u - d
                }
            }, t.prototype.componentWillReceiveProps = function(e) {
                this.props.virtualized && this.processChildren(e.children)
            }, t.prototype.componentDidMount = function() {
                this.attachListeners()
            }, t.prototype.componentWillUnmount = function() {
                this.detachListeners()
            }, t.prototype.render = function() {
                return r.createElement("div", {
                    className: Object(o.a)("InfiniteScroll", this.props.className),
                    ref: this.getRef,
                    style: this.props.style
                }, this.props.virtualized && this.state.before > 0 && r.createElement("div", {
                    style: {
                        height: this.state.before * this.props.itemHeight
                    },
                    key: "before"
                }), this.props.virtualized ? [].concat(this.props.children).slice(this.state.start, this.state.end) : this.props.children, this.props.virtualized && this.state.after > 0 && r.createElement("div", {
                    style: {
                        height: this.state.after * this.props.itemHeight
                    },
                    key: "after"
                }), this.props.hasMore && (this.props.loader || r.createElement("div", {
                    className: "InfiniteScroll__loader",
                    key: "loader"
                }, r.createElement(i.a, null))))
            }, t
        }(r.Component);
        t.a = s;
        s.defaultProps = {
            useWindowScroll: !1,
            virtualized: !1,
            hasMore: !0,
            useCapture: !1,
            threshold: 100,
            itemHeight: 55
        }
    },
    vT4u: function(e, t, n) {
        "use strict";
        n.d(t, "e", function() {
            return w
        }), n.d(t, "b", function() {
            return E
        }), n.d(t, "d", function() {
            return k
        }), n.d(t, "c", function() {
            return C
        }), n.d(t, "a", function() {
            return I
        }), n.d(t, "Ja", function() {
            return S
        }), n.d(t, "bc", function() {
            return A
        }), n.d(t, "oc", function() {
            return R
        }), n.d(t, "Sa", function() {
            return N
        }), n.d(t, "vb", function() {
            return U
        }), n.d(t, "jb", function() {
            return W
        }), n.d(t, "Jb", function() {
            return K
        }), n.d(t, "Kb", function() {
            return F
        }), n.d(t, "p", function() {
            return z
        }), n.d(t, "yc", function() {
            return V
        }), n.d(t, "Ob", function() {
            return Q
        }), n.d(t, "Qa", function() {
            return G
        }), n.d(t, "Ma", function() {
            return X
        }), n.d(t, "fb", function() {
            return J
        }), n.d(t, "Na", function() {
            return Z
        }), n.d(t, "Oa", function() {
            return $
        }), n.d(t, "Xb", function() {
            return ee
        }), n.d(t, "qb", function() {
            return te
        }), n.d(t, "Ec", function() {
            return oe
        }), n.d(t, "F", function() {
            return ae
        }), n.d(t, "h", function() {
            return ce
        }), n.d(t, "Wa", function() {
            return le
        }), n.d(t, "Xa", function() {
            return de
        }), n.d(t, "T", function() {
            return _e
        }), n.d(t, "eb", function() {
            return fe
        }), n.d(t, "Ya", function() {
            return pe
        }), n.d(t, "zc", function() {
            return me
        }), n.d(t, "Pb", function() {
            return ge
        }), n.d(t, "Gc", function() {
            return he
        }), n.d(t, "Lb", function() {
            return ye
        }), n.d(t, "D", function() {
            return Oe
        }), n.d(t, "C", function() {
            return je
        }), n.d(t, "j", function() {
            return we
        }), n.d(t, "t", function() {
            return Ee
        }), n.d(t, "E", function() {
            return ke
        }), n.d(t, "pb", function() {
            return Ce
        }), n.d(t, "Pa", function() {
            return xe
        }), n.d(t, "g", function() {
            return Pe
        }), n.d(t, "Sb", function() {
            return Me
        }), n.d(t, "Vb", function() {
            return Te
        }), n.d(t, "Rb", function() {
            return Ie
        }), n.d(t, "Cb", function() {
            return Se
        }), n.d(t, "Db", function() {
            return De
        }), n.d(t, "Ua", function() {
            return Be
        }), n.d(t, "Ib", function() {
            return Ae
        }), n.d(t, "Eb", function() {
            return Re
        }), n.d(t, "Fb", function() {
            return Ne
        }), n.d(t, "bb", function() {
            return Ue
        }), n.d(t, "Ia", function() {
            return We
        }), n.d(t, "Gb", function() {
            return He
        }), n.d(t, "X", function() {
            return Ke
        }), n.d(t, "Y", function() {
            return qe
        }), n.d(t, "m", function() {
            return Fe
        }), n.d(t, "v", function() {
            return ze
        }), n.d(t, "Hb", function() {
            return Qe
        }), n.d(t, "Ka", function() {
            return Ge
        }), n.d(t, "Ea", function() {
            return Xe
        }), n.d(t, "nb", function() {
            return Ye
        }), n.d(t, "mb", function() {
            return Je
        }), n.d(t, "lb", function() {
            return Ze
        }), n.d(t, "ob", function() {
            return $e
        }), n.d(t, "wb", function() {
            return et
        }), n.d(t, "xb", function() {
            return tt
        }), n.d(t, "f", function() {
            return rt
        }), n.d(t, "gb", function() {
            return it
        }), n.d(t, "Nb", function() {
            return ot
        }), n.d(t, "Mb", function() {
            return at
        }), n.d(t, "K", function() {
            return st
        }), n.d(t, "cb", function() {
            return ct
        }), n.d(t, "B", function() {
            return ut
        }), n.d(t, "I", function() {
            return lt
        }), n.d(t, "qc", function() {
            return dt
        }), n.d(t, "Ga", function() {
            return _t
        }), n.d(t, "i", function() {
            return ft
        }), n.d(t, "Ha", function() {
            return pt
        }), n.d(t, "s", function() {
            return mt
        }), n.d(t, "Ra", function() {
            return gt
        }), n.d(t, "pc", function() {
            return ht
        }), n.d(t, "Ca", function() {
            return vt
        }), n.d(t, "zb", function() {
            return yt
        }), n.d(t, "kc", function() {
            return Ot
        }), n.d(t, "Yb", function() {
            return jt
        }), n.d(t, "Ub", function() {
            return wt
        }), n.d(t, "G", function() {
            return Et
        }), n.d(t, "sc", function() {
            return kt
        }), n.d(t, "xc", function() {
            return Ct
        }), n.d(t, "Ta", function() {
            return xt
        }), n.d(t, "J", function() {
            return Pt
        }), n.d(t, "Qb", function() {
            return Mt
        }), n.d(t, "P", function() {
            return Tt
        }), n.d(t, "db", function() {
            return It
        }), n.d(t, "w", function() {
            return St
        }), n.d(t, "yb", function() {
            return Dt
        }), n.d(t, "lc", function() {
            return Bt
        }), n.d(t, "Tb", function() {
            return Lt
        }), n.d(t, "V", function() {
            return At
        }), n.d(t, "Dc", function() {
            return Rt
        }), n.d(t, "q", function() {
            return Nt
        }), n.d(t, "rc", function() {
            return Ut
        }), n.d(t, "Ab", function() {
            return Wt
        }), n.d(t, "H", function() {
            return Ht
        }), n.d(t, "o", function() {
            return Kt
        }), n.d(t, "uc", function() {
            return Ft
        }), n.d(t, "ic", function() {
            return zt
        }), n.d(t, "Va", function() {
            return Vt
        }), n.d(t, "O", function() {
            return Qt
        }), n.d(t, "hb", function() {
            return Gt
        }), n.d(t, "gc", function() {
            return Xt
        }), n.d(t, "y", function() {
            return Yt
        }), n.d(t, "ub", function() {
            return Jt
        }), n.d(t, "ac", function() {
            return Zt
        }), n.d(t, "Bc", function() {
            return $t
        }), n.d(t, "W", function() {
            return en
        }), n.d(t, "u", function() {
            return tn
        }), n.d(t, "cc", function() {
            return nn
        }), n.d(t, "vc", function() {
            return rn
        }), n.d(t, "fc", function() {
            return on
        }), n.d(t, "wc", function() {
            return an
        }), n.d(t, "l", function() {
            return sn
        }), n.d(t, "Zb", function() {
            return cn
        }), n.d(t, "hc", function() {
            return un
        }), n.d(t, "Ac", function() {
            return ln
        }), n.d(t, "U", function() {
            return dn
        }), n.d(t, "Z", function() {
            return _n
        }), n.d(t, "M", function() {
            return fn
        }), n.d(t, "rb", function() {
            return pn
        }), n.d(t, "Da", function() {
            return mn
        }), n.d(t, "Bb", function() {
            return gn
        }), n.d(t, "sb", function() {
            return hn
        }), n.d(t, "kb", function() {
            return bn
        }), n.d(t, "ab", function() {
            return vn
        }), n.d(t, "nc", function() {
            return yn
        }), n.d(t, "Za", function() {
            return On
        }), n.d(t, "mc", function() {
            return jn
        }), n.d(t, "Q", function() {
            return wn
        }), n.d(t, "N", function() {
            return En
        }), n.d(t, "L", function() {
            return Cn
        }), n.d(t, "tc", function() {
            return xn
        }), n.d(t, "ib", function() {
            return Pn
        }), n.d(t, "Ba", function() {
            return Mn
        }), n.d(t, "Aa", function() {
            return Tn
        }), n.d(t, "ec", function() {
            return In
        }), n.d(t, "dc", function() {
            return Sn
        }), n.d(t, "r", function() {
            return Dn
        }), n.d(t, "R", function() {
            return Bn
        }), n.d(t, "Fc", function() {
            return Ln
        }), n.d(t, "S", function() {
            return An
        }), n.d(t, "k", function() {
            return Rn
        }), n.d(t, "Fa", function() {
            return Nn
        }), n.d(t, "Wb", function() {
            return Un
        }), n.d(t, "z", function() {
            return Wn
        }), n.d(t, "jc", function() {
            return Hn
        }), n.d(t, "La", function() {
            return Kn
        }), n.d(t, "n", function() {
            return qn
        }), n.d(t, "A", function() {
            return Fn
        }), n.d(t, "x", function() {
            return zn
        }), n.d(t, "Cc", function() {
            return Vn
        }), n.d(t, "tb", function() {
            return Qn
        });
        var r = n("BxOC"),
            i = n("nyd8"),
            o = n("f01n"),
            a = n("DM26"),
            s = n("aong"),
            c = n("uytb"),
            u = n("P13b"),
            l = n("h++7"),
            d = n("rHUl"),
            _ = n("MhhX"),
            f = n("86+7"),
            p = n("ERyv"),
            m = n("Wu9C"),
            g = n("lJdi"),
            h = n("O8ze"),
            b = n("zxIV"),
            v = Object.assign || function(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = arguments[t];
                    for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
                }
                return e
            },
            y = function() {
                return function(e, t) {
                    if (Array.isArray(e)) return e;
                    if (Symbol.iterator in Object(e)) return function(e, t) {
                        var n = [],
                            r = !0,
                            i = !1,
                            o = void 0;
                        try {
                            for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                        } catch (e) {
                            i = !0, o = e
                        } finally {
                            try {
                                !r && s.return && s.return()
                            } finally {
                                if (i) throw o
                            }
                        }
                        return n
                    }(e, t);
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }();

        function O(e, t, n) {
            return t in e ? Object.defineProperty(e, t, {
                value: n,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = n, e
        }

        function j(e) {
            if (Array.isArray(e)) {
                for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                return n
            }
            return Array.from(e)
        }
        var w = "al_im.php",
            E = 5,
            k = "typing",
            C = "audiomessage",
            x = Object(i.a)(),
            P = x.scheduleNav,
            M = x.commitNav,
            T = x.scheduleNavWithTimeOut;
        var I = {
            settings: 0,
            block: 1,
            fav: 1,
            chat: 2,
            invite: 2,
            invite_link: 3,
            topic: 3,
            avatar: 4,
            photos: 5,
            search: 6,
            pin_hide: 7,
            pin_unhide: 7,
            unpin: 8,
            mute: 10,
            unmute: 10,
            clear: 11,
            leave: 12,
            return: 12,
            block_community: 12,
            allow_community: 12
        };

        function S(e, t, n) {
            return Object(r.b)(w, {
                act: "a_renew_hash",
                peers: e.join(","),
                gid: t.hidegid ? void 0 : n.gid
            })
        }

        function D(e, t, n) {
            return function(e) {
                return e.resync_in_process ? e.resync_in_process : Promise.resolve(!1)
            }(e).then(function(r) {
                return r ? t.apply(void 0, j(n)) : function(e) {
                    if (!e.renew_hashes) {
                        var t = e.last_hashes_update || 0;
                        if (Date.now() - t < 1e4) return Promise.resolve();
                        var n = Object.keys(e.tabs).filter(function(t) {
                            return Object(u.Oa)(e, t)
                        });
                        e.renew_hashes = S(n, {}, e).then(function(t) {
                            var r = y(t, 2),
                                i = r[0],
                                o = r[1];
                            return n.forEach(function(t) {
                                e.tabs[t].hash = i[t]
                            }), e.writeHash = o, delete e.renew_hashes, e.last_hashes_update = Date.now(), e
                        })
                    }
                    return e.renew_hashes
                }(e).then(function(e) {
                    return t.apply(void 0, j(n))
                })
            })
        }

        function B(e) {
            return function() {
                var t = arguments,
                    n = t[t.length - 1];
                return e.apply(void 0, j(t)).catch(function(r) {
                    if (r && r.match && r.match(/1001;/)) return D(n, e, t);
                    throw r
                })
            }
        }

        function L(e) {
            return "string" == typeof e ? se("<div>" + e + "</div>") : e
        }

        function A(e) {
            return "string" == typeof e ? e : e.innerHTML
        }

        function R(e, t) {
            return t.block_states = extend(t.block_states, e), Promise.resolve(t)
        }

        function N(e, t, n, i, o) {
            return o.tabHistoryNotChanged = !1, Object(a.d)(r.b, 3, function(e) {
                return e - 1
            })(w, {
                act: "a_start",
                peer: e,
                msgid: n,
                history: t,
                prevpeer: o.prevPeer,
                gid: o.gid,
                block: i
            }).then(function(t) {
                var r = y(t, 5),
                    i = r[0],
                    a = r[1],
                    s = r[2],
                    c = r[3],
                    l = r[4];
                if (a.forEach(function(e) {
                        return Object(f.a)(o, e)
                    }), o.tabs || (o.tabs = {}), o.dialog_tab_cts = l, o.tabs[e] || (o.tabs[e] = Object(u.kb)(o, i)), R(c, o), n) {
                    if (o.tabs[e]) {
                        var d = o.tabs[e].lastmsg,
                            _ = o.tabs[e].lastmsg_meta;
                        extend(o.tabs[e], i), o.tabs[e].lastmsg = d, o.tabs[e].lastmsg_meta = _
                    }
                } else extend(o.tabs[e], i);
                return o.admins = extend(o.admins, s), o.imQueue(e, !1), Ln(), U(e, o)
            }).catch(function(e) {
                return Object(p.a)("loadPeer", e)
            })
        }

        function U(e, t) {
            var n = t.imQueue(e, !1),
                r = t.tabs[e],
                i = n.filter(function(n) {
                    return !Object(d.J)(t, e, n.rid)
                });
            return r.msgs = i.reduce(function(e, t) {
                return e["rid" + t.rid] = t.mess, e
            }, r.msgs), t.imQueueSet(e, i), t.tabs[e].history = Object(u.Hb)(i, t, L(t.tabs[e].history)), Promise.resolve(t)
        }

        function W(e, t, n) {
            var r = n.imQueue(e, !1).filter(function(e) {
                return e.failed && e.mess.messageId !== t
            });
            return n.imQueueSet(e, r), n.tabs[e].history = Object(u.mb)([t], L(n.tabs[e].history)), Promise.resolve(n)
        }

        function H(e, t) {
            return !1 === (t.block_states[e] || {}).free ? Promise.resolve(t) : Object(r.b)(w, {
                act: "a_block",
                peer: e,
                prevPeer: t.prevPeer,
                gid: t.gid
            }).then(function(e) {
                return R(y(e, 1)[0], t)
            })
        }

        function K(e, t) {
            var n = t.peer;
            return Promise.resolve(t).then(function(t) {
                return t.tabHistoryNotChanged = !1, Object(u.Oa)(t, n) && !t.tabs[n].msgid ? (t.gid && H(n, t), Promise.resolve(t).then(Q)) : (Object(u.Oa)(t, n) && (t.tabs[n].msgid = !1), N(n, e, !1, !0, t))
            }).then(Q).then(q.bind(null, n))
        }

        function q(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
            return Object(u.bb)(t, e) && (t.tabs[e].last_touched = Date.now()), Object(u.bb)(t, e) && n && (t.tabs[e].last_visited = Date.now()), t
        }

        function F(e, t, n) {
            var r = n.msgid,
                i = n.peer;
            return !e && Object(u.Oa)(n, i) && n.tabs[i].msgs[r] ? (t === n.peer ? n.tabHistoryNotChanged = !0 : n.tabHistoryNotChanged = !1, n.gid && H(i, n), Promise.resolve(n).then(Q).then(q.bind(null, i))) : N(i, !0, r, !0, n).then(Q).then(function() {
                return Object(d.t)(n, i).msgid = r, n
            }).then(q.bind(null, i))
        }

        function z(e, t, n, r) {
            if (At(r)) throw Object(u.ac)(), new Error("Cant change peer while loading something");
            var i = r.gid ? "gim" + r.gid : "im";
            if (r.prevPeer = r.peer, r.peer = e, r.msgid = t || "", r.currentEntryPoint = n, cur.peer = e, P({
                    sel: e ? Object(u.H)(e) : null,
                    msgid: r.msgid,
                    email: "",
                    0: i
                }), 0 != r.prevPeer && q(r.prevPeer, r, !0), 0 !== e) {
                Object(u.bb)(r, e) && q(e, r, !0), $t(r.tabbedPeers.map(function(e) {
                    return e.peer
                }).indexOf(e) < 0 ? [{
                    peer: e,
                    type: "perm"
                }].concat(r.tabbedPeers) : r.tabbedPeers.map(function(t) {
                    return t.peer == e && "perm" !== t.type && (t.type = "perm"), t
                }), !1, r)
            } else $t(r.tabbedPeers, !1, r);
            return M(), Fe(r.prevPeer, r)
        }

        function V(e) {
            cur.wallMentions = function() {
                return new Promise(function(t, n) {
                    if (cur.wallMentions = [], !Object(u.Ha)(e.peer) || !Object(u.Oa)(e, e.peer) || Object(u.Pa)(e, e.peer)) return n();
                    var r = e.tabs[e.peer];

                    function i() {
                        var n = [];
                        Object.keys(r.msgs || {}).reverse().forEach(function(e) {
                            var t = Object(d.P)(r.msgs[e]),
                                i = t && t.userId;
                            i && i != vk.id && -1 === n.indexOf(i) && Object(u.eb)(r, i) && n.push(i)
                        }), (r.memberIds || []).forEach(function(e) {
                            -1 === n.indexOf(e) && n.push(e)
                        });
                        var i = [];
                        n.forEach(function(t) {
                            if (Object(f.b)(e, t)) {
                                var n = Object(f.c)(e, t),
                                    r = n.link.substring(1);
                                i.push([n.id, n.name, "@" + r, n.photo, void 0, void 0, void 0, r, n.first_name])
                            }
                        }), t(i)
                    }
                    r.membersLoaded ? i() : kn(e.peer, e).then(i)
                })
            }
        }

        function Q(e) {
            var t = e.peer;
            if (0 === t) return Promise.resolve(e);
            var n = e.tabs[t],
                r = [],
                i = Object(u.Ha)(t) && (n.data.closed || n.data.kicked),
                o = Object(u.Pa)(e, t);
            n.offset && r.push("photos"), n.offset && r.push("search"), (t < -2e9 || n.offset) && !o && r.push("clear"), Object(u.Ja)(e) && !o && r.push("block"), o && !i && r.push("settings"), Object(u.Ka)(t) && (n.blocked_community ? r.push("allow_community") : r.push("block_community")), (Object(u.Ha)(t) || Object(u.fb)(t) || Object(u.Ka)(t)) && !Object(u.Ja)(e) && (Object(u.Ha)(t) && (n.data.kicked || n.data.closed) || (inArray(t, e.mutedPeers) ? r.push("unmute") : r.push("mute"))), Object(u.fb)(t) && !e.gid && !n.blacklisted && n.is_friend && r.push("invite"), Object(u.Ha)(t) && !i && (Object(g.h)(e) && r.push("invite"), e.gid || r.push("leave")), Object(u.Ha)(t) && n.data.closed && !n.data.kicked && r.push("return"), Object(u.Ha)(t) && n.pinned && (r.push(Object(m.a)(e, t) ? "pin_hide" : "pin_unhide"), Object(g.j)(e) && r.push("unpin"));
            var a = Object(u.D)(e, o);
            return e.curActions = r.sort(function(e, t) {
                return I[e] - I[t]
            }).reduce(function(e, t) {
                return e[t] = a[t], e
            }, {}), Promise.resolve(e)
        }

        function G(e, t, n) {
            var i = n.tabs[n.peer];
            return Object(r.b)(w, {
                peer: n.peer,
                whole: e,
                act: "a_history",
                offset: i.offset + (i.skipped || 0),
                toend: t,
                gid: n.gid
            }).then(function(e) {
                var t = y(e, 4),
                    r = t[0],
                    o = t[1],
                    a = t[2],
                    s = t[3];
                return i.allShown = a, n.admins = extend(n.admins, s), i.history = r + A(i.history), i.historyToAppend = r, i.offset += Object.keys(o).length, i.msgs = extend(i.msgs, o), n
            })
        }

        function X(e) {
            var t = e.tabs[e.peer];
            return Object(r.b)(w, {
                peer: e.peer,
                act: "a_history",
                rev: 1,
                offset: t.skipped,
                gid: e.gid
            }).then(function(n) {
                var r = y(n, 5),
                    i = r[0],
                    o = r[1],
                    a = r[2];
                r[3], r[4];
                t.allShown = t.allShown || a, t.history = A(t.history) + i, t.historyToAppend = i;
                var s = Object.keys(o).length;
                return t.skipped -= s, t.offset += s, t.msgs = extend(t.msgs, o), e
            })
        }

        function Y(e, t, n, r) {
            var i = e.tabs[t];
            return r === o.m && i.out_up_to > n ? e : (r === o.m ? i.out_up_to = n : i.in_up_to = n, e)
        }
        var J = B(function(e, t) {
            if (Object(u.fc)(t.tabs[e])) return Promise.resolve(t);
            var n = t.tabs[e],
                i = n.msgs || {},
                a = Object.keys(i).map(function(n) {
                    return Object(d.m)(t, e, n)
                }).filter(function(e) {
                    return !Object(_.k)(e)
                }).map(function(e) {
                    return e.messageId
                }).sort(function(e, t) {
                    return t - e
                });
            return n.skipped > 0 && (a = a.filter(function(e) {
                return intval(e) <= n.lastmsg - n.skipped
            })), (a = intval(a.shift())) <= n.in_up_to ? Promise.resolve(t) : (t.longpoll.push([o.Pa([6, e, a])]), Object(r.b)(w, {
                peer: e,
                ids: [a],
                hash: n.hash,
                act: "a_mark_read",
                gid: t.gid
            }).then(function() {
                return Y(t, e, a, o.m)
            }))
        });

        function Z(e) {
            return Object(r.b)(w, {
                act: "a_get_key",
                uid: e.id,
                gid: e.gid
            }).then(function(t) {
                var n = y(t, 3),
                    r = n[0],
                    i = n[1],
                    o = n[2];
                return extend({}, e, {
                    imKey: r,
                    imUrl: i,
                    imPart: o
                })
            })
        }

        function $(e) {
            return Object(r.b)(w, {
                act: "a_get_ts",
                gid: e.gid
            }).then(function(t) {
                var n = y(t, 1)[0];
                return extend({}, e, {
                    imTs: n
                })
            })
        }

        function ee(e, t, n) {
            var r = n.tabs[e];
            return r.msgs[t.messageId] && (r.msgs[t.messageId].errored = 1, r.history = Object(u.Kb)(e, t, L(r.history))), Promise.resolve(n)
        }

        function te(e, t, n, r) {
            var i = r.tabs[e];
            return i.msgs[t] && (i.msgs[t].errored = 0, i.lastmsg_meta = n, i.lastmsg = t, i.history = Object(u.dc)(e, t, L(i.history))), Promise.resolve(r)
        }

        function ne(e, t, n, r) {
            var i = arguments.length > 4 && void 0 !== arguments[4] && arguments[4];
            t.deletedDialog || (e.dialog_tabs = Object.keys(e.dialog_tabs).reduce(function(e, o) {
                return !n && !Ht(o)(t) || i && !i(o, e[o], t) || (e[o] = Object(s.a)(r(e[o], o))), e
            }, e.dialog_tabs))
        }

        function re(e, t) {
            if (!inArray(e, t.tabbedPeers.map(function(e) {
                    return e.peer
                })) && (0 !== t.peer || t.searchText) && !inArray(e, t.mutedPeers)) {
                var n = {
                    peer: e,
                    type: "temp"
                };
                $t(t.tabbedPeers.concat([n]), !1, t)
            }
        }

        function ie(e, t, n) {
            return Object(u.Za)(n) ? t.concat([e]) : [e].concat(t)
        }

        function oe(e, t) {
            var n = e.get().peer,
                r = Object(d.t)(e, n);
            if (Object(u.Oa)(e, n)) {
                var i = L(r.history);
                r.history = Object(u.jc)(e, i, t)
            }
        }

        function ae(e, t) {
            var n = Object(d.t)(t, e.peerId);
            if (Object(u.Oa)(t, e.peerId)) {
                var r = L(n.history);
                n.msgs[e.messageId] = extend(!0, {}, e), n.history = Object(u.J)(t, e, r)
            }
            n && n.lastmsg == e.messageId && (n.lastmsg_meta = e);
            var i = n && n.pinned && Object(d.P)(n.pinned);
            return i && i.messageId == e.messageId && (n.pinned = e), Promise.resolve(t)
        }

        function ce(e, t) {
            var n = e.flags & o.m,
                r = e.peerId;
            if (Object(u.bb)(t, r)) {
                var i = t.tabs[r];
                if (i.deletedDialog = !1, !t.msg_local_ids_sort && e.local ? t.msg_local_ids_sort = O({}, e.messageId, 0) : e.local && (t.msg_local_ids_sort[e.messageId] = Object.keys(t.msg_local_ids_sort).length), n ? i.unread = 0 : (i.lastmsg == e.messageId && i.unread ? ue(t, 1, e.peerId) : (!i.unread && ue(t, 1, e.peerId), i.unread++), re(e.peerId, t)), Object(u.Oa)(t, r)) {
                    var a = L(i.history);
                    i.skipped > 0 && i.skipped++, i.offset++, i.msgs[e.messageId] = extend(!0, {}, e), i.history = Object(u.x)(t, e, a, !0, !0, !0), Object(_.k)(e) && (i.blocked_community = 0, Q(t))
                }
                if (i.typing) {
                    var s = i.typing.userIds.indexOf(e.userId);
                    s >= 0 && i.typing.userIds.splice(s, 1)
                }
                return i.lastmsg = e.messageId, i.lastmsg_meta = e, q(e.peerId, t), ne(t, i, !1, ie.bind(null, r), qt.bind(null, t)), Promise.resolve(t)
            }
            return N(r, 0, 0, 0, t).then(function(t) {
                return ne(t, t.tabs[r], !1, ie.bind(null, r), qt.bind(null, t)), q(e.peerId, t), n || re(e.peerId, t), t
            })
        }

        function ue(e, t, n) {
            e.cur_unread_cnt || (e.cur_unread_cnt = {}), -1 === t && delete e.cur_unread_cnt[n], e.unread_cnt += t
        }

        function le(e, t) {
            if (Object(u.Oa)(t, e.peerId)) {
                var n = t.tabs[e.peerId],
                    r = n.unread;
                if (t = Y(t, e.peerId, e.upToId, 0), null != e.unread ? n.unread = e.unread : n.unread = e.upToId >= n.lastmsg ? 0 : Object(d.b)(e.peerId, t) + (n.unread > 0 ? +n.skipped : 0), r > 0 && !n.unread && ue(t, -1, e.peerId), !n.skipped) {
                    var i = L(n.history);
                    n.history = Object(u.pb)(t, i, e.peerId)
                }
            } else Object(u.bb)(t, e.peerId) && (t.tabs[e.peerId].unread > 0 && ue(t, -1, e.peerId), t.tabs[e.peerId].unread = 0, t.tabs[e.peerId].in_up_to = e.upToId);
            return Object(u.bb)(t, e.peerId) && (t.dialog_tabs[l.m] = t.dialog_tabs[l.m].filter(function(t) {
                return intval(t) !== e.peerId
            })), 0 !== t.unread_cnt || t.active_tab !== l.m || t.gid ? Promise.resolve(t) : Kt(l.h, t)
        }

        function de(e, t) {
            var n = t.tabs[e.peerId];
            if (Object(u.bb)(t, e.peerId) && Y(t, e.peerId, e.upToId, o.m), Object(u.Oa)(t, e.peerId)) {
                var r = L(n.history);
                n.history = Object(u.jb)(t, e.peerId, r)
            }
            return Promise.resolve(t)
        }

        function _e(e, t, n, r, i) {
            return i.text = {}, i.imQueue = e, i.imQueueResend = t, i.imQueueSet = n, i.imQueueComplete = r, Promise.resolve(i)
        }

        function fe(e, t, n) {
            function r(e, t) {
                return {
                    id: e.messageId,
                    text: e.text,
                    date: e.date,
                    kludges: e.kludges,
                    authorName: t
                }
            }
            if (1 === e.length) {
                var i = e[0],
                    o = Object(d.m)(n, t, i),
                    a = Object(d.d)(n, t, i);
                return !1 === a ? n.set(pt.bind(null, O({}, t, [o.userId]))).then(function(n) {
                    var a = Object(d.d)(n, t, i);
                    return {
                        msgIds: e,
                        object: r(o, a)
                    }
                }) : Promise.resolve({
                    msgIds: e,
                    object: r(o, a)
                })
            }
            return Promise.resolve({
                msgIds: e
            })
        }

        function pe(e, t) {
            Object(u.lb)(t, e);
            var n = t.tabs[t.peer];
            return t.tabs = Object.keys(e).reduce(function(n, r) {
                var i = t.tabs[r] ? t.tabs[r].msgs : {},
                    o = extend({}, i || {}, e[r].msgs || {});
                return n[r] = extend(t.tabs[r] || {}, e[r]), o && (n[r].msgs = o), e[r].lastmsg || (n[r].lastmsg = !1), n
            }, t.tabs), n && (t.tabs[t.peer] = n), Promise.resolve(t)
        }

        function me(e, t, n, r) {
            var i = Object(d.t)(r, e);
            if (i) {
                var o = !1 !== t ? mobPlatforms[t] ? 1 : 0 : i.last_seen[2];
                i.online = t, i.last_seen = [t, n || i.last_seen[1], o]
            }
            return Promise.resolve(r)
        }

        function ge(e, t, n) {
            var r = Object(d.t)(n, e.peerId);
            return r && (e.ts = Date.now() / 1e3, r.activity || (r.activity = {}), r.activity[t] = e, r.typing === k && (r.typing = e)), Promise.resolve(n)
        }

        function he(e, t, n) {
            var r = e.peerId;
            return Object(a.c)(E + 2).then(function() {
                if (Object(u.bb)(n, r)) {
                    var e = n.tabs[r];
                    if ((e.activity || {})[t]) Date.now() - 1e3 * e.activity[t].ts >= 1e3 * E && (delete e.activity[t], 0 === Object.keys(e.activity) && delete e.activity);
                    if (e.typing) Date.now() - 1e3 * e.typing.ts >= 1e3 * E && (e.typing = void 0)
                }
                return n
            })
        }

        function be(e) {
            var t = {},
                n = e.find(function(e) {
                    return "poll" === e[0]
                });
            if (n) {
                var r = y(n, 3)[2];
                Object.assign(t, r)
            }
            return t
        }

        function ve(e) {
            return e.map(function(e) {
                var t = "audiomsg" === e[2] ? "audio_message" : e[2];
                return e[0] + ":" + e[1] + ":" + t
            }).join(",")
        }
        var ye = function(e, t, n, i) {
                var o = Date.now() + rand(0, 100).toFixed(0),
                    a = i.ref_id,
                    s = i.ref_source;
                i.ref_source = void 0, i.ref_id = void 0, (s || a) && (P({
                    ref_source: null,
                    ref: null
                }), M()), Object(h.i)(i);
                var c = t.attaches.length > 0,
                    u = Object(h.k)(i, "send", "server", c),
                    l = Object.assign({
                        act: "a_send",
                        to: e,
                        hash: n.hash,
                        ref_source: s,
                        ref: a,
                        msg: t.message,
                        payload: t.payload,
                        media: ve(t.attaches),
                        guid: o,
                        share_url: t.share_url,
                        cancelled_shares: t.cancelled_shares,
                        random_id: t.rid,
                        gid: n.hidegid ? void 0 : i.gid,
                        entrypoint: i.currentEntryPoint || "",
                        sticker_referrer: t.sticker_referrer
                    }, n.external, be(t.attaches));
                return Object(r.b)(w, l, 2e4).then(function(e) {
                    var t = y(e, 1)[0];
                    return u(), i.version !== t.version && nav.reload({
                        force: !0
                    }), i.currentEntryPoint = "", i
                }).catch(function(e) {
                    throw Object(h.h)(i, e, "send", "server_send"), e
                })
            },
            Oe = B(function(e, t) {
                var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    r = arguments[3],
                    i = r.tabs[e];
                return ye(e, t, v({
                    hash: i.hash
                }, n), r)
            }),
            je = B(function(e, t, n) {
                var i = t.attaches.length > 0,
                    o = Object(h.k)(n, "edit", "server", i);
                return Object(r.b)(w, Object.assign({
                    act: "a_edit_message",
                    hash: e.hash,
                    id: t.messageId,
                    peerId: e.peerId,
                    gid: n.gid,
                    msg: t.origText,
                    media: ve(t.attaches),
                    share_url: t.share_url,
                    cancelled_shares: t.cancelled_shares
                }, be(t.attaches)), 2e4).then(function(e) {
                    y(e, 1)[0];
                    return o(), n
                }).catch(function(e) {
                    throw Object(h.h)(n, e, "edit", "server_send"), e
                })
            });

        function we(e, t) {
            if (t.selectedMessages || (t.selectedMessages = []), 1 === e.length && inArray(e[0], t.selectedMessages)) t.selectedMessages = t.selectedMessages.filter(function(t) {
                return t !== e[0]
            });
            else {
                var n = t.selectedMessages.concat(e);
                t.selectedMessages = Object(s.a)(n).sort(function(e, t) {
                    return e - t
                })
            }
            return Promise.resolve(t)
        }

        function Ee(e) {
            return e.selectedMessages = [], Promise.resolve(e)
        }

        function ke(e) {
            return e.selectedMessages = [], Promise.resolve(e)
        }

        function Ce(e, t) {
            if (Object(u.Oa)(t, e.peerId)) {
                var n = t.tabs[e.peerId],
                    r = t.imQueue(e.peerId).filter(function(t) {
                        return t.failed && t.rid !== e.randomId
                    });
                t.imQueueSet(e.peerId, r), t.imQueueComplete(e.peerId, e.randomId), n.lastmsg_meta = e, n.lastmsg = e.messageId, n.msgs["rid" + e.randomId] && (n.msgs[e.messageId] = e, delete n.msgs["rid" + e.randomId]), n.history = Object(u.Eb)(t, L(n.history), e)
            }
            return Promise.resolve(t)
        }

        function xe(e, t) {
            var n = Object(h.k)(t, "unknown", "attach"),
                i = {
                    act: "a_get_media",
                    id: e.messageId,
                    gid: t.gid
                };
            return Object(a.d)(r.b, 3, function(e) {
                return e * e
            })(w, i).then(function(r) {
                return n(), Pe(e, r, t)
            }).catch(function(n) {
                return Object(h.h)(t, n, "unknown", "server_load_attach"), Pe(e, null, t)
            })
        }

        function Pe(e, t, n) {
            var r = n.tabs[e.peerId];
            return r.mediacontent || (r.mediacontent = {}), r.mediacontent[e.messageId] = t || [getTemplate("im_retry_link")],
                function(e, t) {
                    var n = t.tabs[e.peerId];
                    return n.history = Object(u.Db)(L(n.history), e, t), Promise.resolve(t)
                }(e, n)
        }

        function Me(e, t, n) {
            var r = Object(u.I)(t),
                i = n.tabs[e];
            return i.searchDay = r, i.searchOffset = 0, i.searchAllLoaded = !1, Promise.resolve(n)
        }

        function Te(e, t, n) {
            return n.tabs[t].searchText = e, Ve(t, n), n
        }

        function Ie(e, t, n) {
            if (t) {
                var r = n.tabs[t];
                r.searchText = e, r.searchOffset = 0, r.searchAllLoaded = !1
            } else n.searchText = e, n.searchOffset = 0, n.searchAllLoaded = !1;
            return Promise.resolve(n)
        }

        function Se(e, t, n, i, o) {
            return Object(r.b)(w, {
                act: "a_hints",
                str: e,
                gid: i.hidegid ? 0 : o.gid,
                query: n,
                peerIds: t.join(",")
            }).then(function(e) {
                var t = y(e, 3),
                    n = t[0],
                    r = t[1];
                return R(t[2], o), r.forEach(function(e) {
                    return Object(f.a)(o, e)
                }), pe(n, o), Object.keys(n).sort(function(e, t) {
                    return n[e].order - n[t].order
                }).map(function(e) {
                    return n[e]
                })
            })
        }

        function De(e, t, n, r) {
            return Se(e, t, n, {}, r).then(function(e) {
                return e.map(function(e) {
                    return {
                        peerId: e.peerId,
                        name: e.tab,
                        photo: e.photo,
                        online: e.online,
                        is_friend: "friends" === n
                    }
                })
            })
        }

        function Be(e) {
            var t = {
                peerId: e[0],
                name: e[1],
                tab: e[1],
                photo: e[2],
                href: e[3],
                online: e[4],
                is_friend: e[5],
                local_index: !0
            };
            return e[6] && (t.data = {
                flags: e[6]
            }), t
        }

        function Le(e) {
            return function(t, n) {
                return e(n).then(function(e) {
                    var r = (t ? e.search(t) : e.list).map(Be);
                    return n.mapped_index || (n.mapped_index = {}), r.forEach(function(e) {
                        n.mapped_index[e.peerId] = e
                    }), r
                })
            }
        }
        var Ae = Le(function(e) {
                return e.topConvTree
            }),
            Re = Le(function(e) {
                return e.imTopConvTree
            }),
            Ne = Le(function(e) {
                return e.hintsTree
            });

        function Ue(e, t) {
            var n = void 0,
                i = void 0,
                o = void 0;
            t.topConvTree = new Promise(function(e) {
                n = e
            }), t.hintsTree = new Promise(function(e) {
                i = e
            }), t.imTopConvTree = new Promise(function(e) {
                o = e
            });
            var s = e.select(c.b);
            return Object(a.d)(r.b, 1, function() {
                return 4
            })(w, {
                act: "a_dialogs_preload",
                rs: s.join(","),
                gid: t.gid
            }).catch(function(e) {
                return [
                    [],
                    [],
                    []
                ]
            }).then(function(e) {
                var r = y(e, 4),
                    a = r[0],
                    s = r[1],
                    c = r[2],
                    u = r[3];
                return t.popular_sugg = c, new vkIndexer(a, function(e) {
                    return e[1]
                }, n), new vkIndexer(s, function(e) {
                    return e[1]
                }, i), u && u.length > 0 ? new vkIndexer(u, function(e) {
                    return e[1]
                }, o) : o(), t
            })
        }

        function We(e) {
            var t = e.active_tab,
                n = void 0;
            return n = e.dialog_tabs[t].length > 0 ? Math.min.apply(null, e.dialog_tabs[t].map(function(t) {
                return e.tabs[t].lastmsg
            })) : 0, Object(r.b)(w, {
                act: "a_get_dialogs",
                start_message_id: n,
                tab: t,
                gid: e.gid
            }).then(function(n) {
                var r = y(n, 4),
                    i = r[0],
                    o = r[1],
                    a = r[2],
                    s = r[3];
                return a.forEach(function(t) {
                    return Object(f.a)(e, t)
                }), R(s, e), pe(o, e), e.dialog_tabs[t] = e.dialog_tabs[t].concat(Object.keys(o).map(intval)), e.dialog_tabs_all[t] = !i.has_more, Promise.resolve(e)
            })
        }
        var He = B(function(e, t) {
            return Object(r.b)(w, {
                act: "a_search",
                q: e,
                from: "all",
                gid: t.gid,
                hash: t.writeHash,
                offset: t.searchOffset || 0
            }).then(function(n) {
                var r = y(n, 5),
                    i = r[0],
                    o = r[1],
                    a = r[2],
                    s = r[3],
                    c = r[4];
                return o.forEach(function(e) {
                    return Object(f.a)(t, e)
                }), Object(u.lb)(t, i), e === t.searchText && (t.searchOffset = s, t.searchAllLoaded = c), Object.keys(i).filter(function(e) {
                    return !t.tabs[e]
                }).forEach(function(e) {
                    t.tabs[e] = i[e]
                }), [i, a]
            })
        });

        function Ke(e, t) {
            return t.tabs[e].searchAllLoaded
        }

        function qe(e, t) {
            return !(t.peer !== e || !Object(u.Oa)(t, e)) && t.tabs[e].inplaceSearch
        }

        function Fe(e, t) {
            if (Object(u.Oa)(t, e)) {
                var n = t.tabs[e];
                delete n.inplaceSearch, delete n.searchOffset, delete n.searchAllLoaded, delete n.searchText, delete n.searchDay, P({
                    st: ""
                }), M()
            }
            return Promise.resolve(t)
        }

        function ze(e, t) {
            if (Object(u.Oa)(t, e)) {
                var n = t.tabs[e];
                delete n.searchDay, n.searchOffset = 0, n.searchAllLoaded = !1
            }
            return Promise.resolve(t)
        }

        function Ve(e, t) {
            return t.tabs[e].inplaceSearch = !0, Promise.resolve(t)
        }
        var Qe = B(function(e, t) {
            var n = t.tabs[e],
                i = "";
            if (Ve(e, t), n.searchDay && (i = "day:" + n.searchDay), !i && !n.searchText) return Promise.reject();
            var o = "in:" + e + " " + i + " " + (n.searchText || "");
            return P({
                st: n.searchText
            }), M(), Object(r.b)(w, {
                act: "a_search",
                q: o,
                from: "in",
                gid: t.gid,
                hash: t.writeHash,
                offset: n.searchOffset || 0
            }).then(function(e) {
                var t = y(e, 3),
                    r = t[0],
                    i = t[1],
                    o = t[2];
                return n.searchOffset = i, n.searchAllLoaded = o, r
            })
        });

        function Ge(e) {
            return Object(r.b)(w, {
                act: "a_important",
                offset: e,
                part: e > 0
            })
        }

        function Xe(e, t) {
            var n = Object(d.t)(e, t);
            return Object(r.b)(w, {
                act: "a_load_lastmsg",
                peerId: t,
                gid: e.get().gid
            }).then(function(r) {
                var i = y(r, 2),
                    o = i[0],
                    a = i[1];
                n.lastmsg = o[0] || !1, n.lastmsg_meta = o;
                var s = y(a, 3);
                n.unread = s[0], n.in_up_to = s[1], n.out_up_to = s[2], n.unread || (e.get().dialog_tabs[l.m] = e.get().dialog_tabs[l.m].filter(function(e) {
                    return e != t
                })), ne(e.get(), n, !1, ie.bind(null, t), qt.bind(null, e.get()))
            })
        }

        function Ye(e, t, n) {
            if (Object(u.Oa)(n, t)) {
                var r = n.tabs[t];
                r.deleted = r.deleted ? r.deleted.concat(e) : e
            }
            return Promise.resolve(n)
        }

        function Je(e, t, n) {
            if (Object(u.Oa)(n, t)) {
                var r = n.tabs[t];
                r.history = Object(u.mb)(e, L(r.history)), r.offset -= e.filter(function(e) {
                    return r.msgs[e]
                }).length, e.forEach(function(e) {
                    return delete r.msgs[e]
                }), e.forEach(function(e) {
                    var t = (n.selectedMessages || []).indexOf(e); - 1 != t && n.selectedMessages.splice(t, 1)
                })
            }
            return Promise.resolve(n)
        }
        var Ze = B(function(e, t, n, i, o) {
            return Object(r.b)(w, {
                act: "a_mark",
                peer: t,
                hash: n || o.tabs[t].hash,
                gid: o.gid,
                msgs_ids: e.join(","),
                mark: i
            })
        });

        function $e(e, t, n, r) {
            if (Object(u.Oa)(r, t)) {
                var i = r.tabs[t];
                i.deleted = i.deleted ? i.deleted.concat(e) : e, i.history = Object(u.nb)(e, t, n, L(i.history)), i.offset -= e.filter(function(e) {
                    return i.msgs[e]
                }).length
            }
            return Promise.resolve(r)
        }

        function et(e, t, n) {
            if (Object(u.Oa)(n, t)) {
                var r = n.tabs[t];
                r.deleted && (r.deleted = r.deleted.filter(function(t) {
                    return t !== e
                })), r.history = Object(u.Gb)(e, t, L(r.history)), r.offset++
            }
            return Promise.resolve(n)
        }

        function tt(e, t, n, i) {
            return Object(r.b)(w, {
                act: "a_restore",
                id: e,
                peer: t,
                hash: n,
                gid: i
            })
        }
        var nt = B(function(e, t, n) {
                return Object(u.fc)(n.tabs[e]) ? Promise.resolve(n) : (n.tabs[e].lastTyping = Date.now(), Object(r.b)(w, {
                    act: "a_activity",
                    type: t,
                    peer: e,
                    gid: n.gid,
                    hash: n.tabs[e].hash
                }).then(function() {
                    return n
                }, function() {
                    return n
                }))
            }),
            rt = B(function(e, t) {
                return Object(r.b)(w, {
                    act: "a_accept_message_request",
                    user_id: e,
                    hash: t.tabs[e].hash
                }).then(function() {
                    t.tabs[e].is_message_request = !1
                }).then(function() {
                    return t
                })
            }),
            it = B(function(e, t) {
                return Object(r.b)(w, {
                    act: "a_reject_message_request",
                    user_id: e,
                    hash: t.tabs[e].hash
                }).then(function() {
                    return ne(t, t.tabs[e], !0, function(t) {
                        return t.filter(function(t) {
                            return t !== e
                        })
                    }), $t(t.tabbedPeers.filter(function(t) {
                        return t.peer !== e
                    }), !0, t), t.tabs[e].unread = 0, t.tabs[e].lastmsg = !1, t.tabs[e].lastmsg_meta = null, t
                })
            }),
            ot = B(function(e, t) {
                return nt(e, k, t)
            }),
            at = B(function(e, t) {
                return nt(e, C, t)
            });

        function st(e, t, n, r) {
            return t && (r.pendingForward = null, e || (e = {
                msgIds: []
            }), t.addAttach(n ? "reply" : "mail", e.msgIds.join(";"), e.object || null)), Promise.resolve(r)
        }

        function ct(e, t) {
            return t.pendingForward = e, Promise.resolve(t)
        }

        function ut(e, t, n) {
            if (Object(u.bb)(n, e)) {
                n.blockedFlagUpdates || (n.blockedFlagUpdates = {}), n.blockedFlagUpdates[e] = !0, ne(n, n.tabs[e], !0, function(t) {
                    return t.filter(function(t) {
                        return t !== e
                    })
                }), n.tabs[e].unread > 0 && ue(n, -1, e);
                var r = n.tabs[e];
                return r.deletedDialog = !0, $t(n.tabbedPeers.filter(function(t) {
                    return t.peer !== e
                }), !0, n), t.then(function(t) {
                    var i = y(t, 2);
                    i[0], i[1];
                    return delete n.blockedFlagUpdates[e], r.msgs = null, r.history = null, r.unread = 0, r.lastmsg = !1, r.lastmsg_meta = null, n
                })
            }
        }
        var lt = B(function(e, t) {
                return ut(e, Object(r.b)("al_im.php", {
                    act: "a_flush_history",
                    id: e,
                    from: "im",
                    gid: t.gid,
                    hash: t.tabs[e].hash
                }), t)
            }),
            dt = B(function(e, t, n) {
                return Object(r.b)(w, {
                    act: "a_set_chat_title",
                    peer: e,
                    new_title: t,
                    gid: n.gid,
                    hash: n.tabs[e].hash
                }).then(function() {
                    return n
                })
            }),
            _t = B(function(e, t) {
                return Object(r.b)(w, {
                    act: "a_load_chat_info",
                    peer: e,
                    gid: t.gid,
                    hash: t.tabs[e].hash
                }).then(function(n) {
                    var r = y(n, 1)[0];
                    return t.tabs[e] = extend(t.tabs[e], r), t
                })
            });
        var ft = B(function(e, t, n) {
            return Object(r.b)(w, {
                act: "a_add_chat_members",
                peer: e,
                new_peer: t.join(","),
                gid: n.gid,
                hash: n.tabs[e].hash
            }).then(function(e) {
                return n
            })
        });

        function pt(e, t) {
            if (isEmpty(e)) return Promise.resolve(t);
            var n = Object.keys(e).map(function(t) {
                return t + ":" + e[t].join(",")
            }).join(";");
            return Object(r.b)(w, {
                act: "a_load_member",
                need: n
            }).then(function(e) {
                return y(e, 1)[0].forEach(function(e) {
                    return Object(f.a)(t, e)
                }), t
            })
        }

        function mt(e, t, n) {
            var r = {},
                i = n.get();

            function a(e, t) {
                Object(u.Ha)(e) && t && !Object(f.b)(i, t) && (r[e] ? -1 === r[e].indexOf(t) && r[e].push(t) : r[e] = [t])
            }
            var s = t.filter(function(e) {
                return !Object(u.bb)(i, e.peerId)
            }).map(function(e) {
                return e.peerId
            });
            t.forEach(function(e) {
                a(e.peerId, e.userId)
            }), e.forEach(function(e) {
                a(e.peerId, +e.kludges.source_mid)
            });
            var c = t.filter(function(e) {
                return e.flags & o.m && !e.local
            }).map(function(e) {
                return e.kludges.from_admin
            }).filter(function(e) {
                return e && !i.admins[e]
            });
            return 0 === Object.keys(r).length && 0 === c.length && 0 === s.length ? Promise.resolve(i) : {
                shouldLoad: Object.keys(r).length > 0 || c.length > 0 || s.length > 0,
                needMembers: r,
                needAdminIds: c,
                needPeers: s
            }
        }

        function gt(e, t, n) {
            var i = e.needMembers,
                o = e.needAdminIds,
                a = e.needPeers;
            return t.pause(), Promise.all([pt(i, n), function(e, t) {
                return 0 === e.length ? Promise.resolve(t) : Object(r.b)(w, {
                    act: "a_get_admin",
                    admins: e.join(","),
                    gid: t.gid
                }).then(function(e) {
                    var n = y(e, 1)[0];
                    return t.admins = extend(t.admins, n), t
                })
            }(o, n), Promise.all(a.map(function(e) {
                return N(e, 0, 0, 0, n)
            }))]).catch(function() {
                return n
            }).then(function() {
                return t.resume()
            }).then(function() {
                return n
            })
        }
        var ht = B(function(e, t) {
            return e.kludges.source_act === u.d ? (delete t.tabs[e.peerId].photo, delete t.tabs[e.peerId].photoLarge, Promise.resolve(t)) : Object(r.b)(w, {
                act: "a_get_chat_photo",
                msg_id: e.messageId
            }).then(function(n) {
                var r = y(n, 2),
                    i = r[0],
                    o = r[1];
                t.chat_photo_msg = o;
                var a = t.tabs[e.peerId];
                if (t.tabs[e.peerId].photo = i[0], t.tabs[e.peerId].photoLarge = i[1], Object(u.Oa)(t, e.peerId)) {
                    var s = e.kludges.source_act;
                    a.history = Object(u.w)(e, s, t, L(a.history))
                }
                return t
            })
        });

        function bt(e, t, n, r) {
            return t !== vk.id ? Promise.resolve(r) : (Object(u.bb)(r, n) && r.peer == n && (r = Q(r)), Promise.resolve(r))
        }
        var vt = B(function(e, t) {
                return Object(r.b)(w, {
                    act: "a_leave_chat",
                    chat: e - 2e9,
                    gid: t.gid,
                    hash: t.tabs[e].hash
                }).then(bt.bind(null, u.c, vk.id, e, t))
            }),
            yt = B(function(e, t) {
                return Object(r.b)(w, {
                    act: "a_return_to_chat",
                    chat: e - 2e9,
                    gid: t.gid,
                    hash: t.tabs[e].hash
                }).then(bt.bind(null, u.b, vk.id, e, t))
            }),
            Ot = B(function(e, t, n) {
                return Object(r.b)(w, {
                    act: "a_mute",
                    peer: e,
                    hash: n.tabs[e].hash,
                    gid: n.gid,
                    value: t ? 1 : 0
                }).then(function() {
                    var r = t ? "mute" : "unmute";
                    return window.Notifier && Notifier.lcSend("im", {
                        act: r,
                        peer: e
                    }), n
                }).then(jt.bind(null, e, t))
            });

        function jt(e, t, n) {
            var r = n.mutedPeers.filter(function(t) {
                return t !== e
            });
            return t && r.push(e), n.mutedPeers = r, cur.mutedPeers = n.mutedPeers, Q(n)
        }

        function wt(e, t) {
            return t.stack = e, Promise.resolve(t)
        }
        var Et = B(function(e, t, n, i) {
            return kt(e, n, t, i), Object(r.b)(w, {
                act: "a_mark_important",
                ids: e,
                val: t ? 1 : 0,
                from: "im",
                gid: i.gid,
                peer: n,
                hash: i.tabs[n].hash
            }).then(function() {
                return i
            })
        });

        function kt(e, t, n, r) {
            if (Object(u.Oa)(r, t)) {
                var i = r.tabs[t];
                e.filter(function(e) {
                    return i.msgs[e]
                }).forEach(function(e) {
                    var a = Object(d.m)(r, t, e),
                        s = n ? a.flags | o.l : a.flags & ~o.l;
                    a.flags = s, i.msgs[e] = a, i.history = Object(u.kc)(e, n, L(i.history))
                })
            }
            return Promise.resolve(r)
        }

        function Ct(e, t, n) {
            return n.importants || (n.importants = {}), (n.importants[t] || 0) !== e && (n.important_cnt += e, n.importants[t] = e), Promise.resolve(n)
        }

        function xt(e, t) {
            return Object(r.b)(w, {
                act: "a_spam",
                offset: e,
                gid: t,
                part: e > 0
            })
        }

        function Pt(e, t) {
            return Object(r.b)(w, {
                act: "a_flush_spam",
                gid: t,
                hash: e
            })
        }

        function Mt(e, t, n) {
            return n.creationType = e, n.creationFilter = t, Promise.resolve(n)
        }

        function Tt(e, t) {
            return Object(r.b)(w, {
                act: "a_owner_photo",
                photo: JSON.parse(e).data[0],
                peer: t
            })
        }

        function It(e, t) {
            return t.next_chat_avatar = e, Promise.resolve(t)
        }
        var St = B(function(e, t, n, i) {
            return i.creating = !0, i.longpoll.pause(), Object(r.b)(w, {
                act: "a_multi_start",
                hash: i.writeHash,
                peers: t.join(","),
                title: n
            }).then(function(e) {
                var t = y(e, 1)[0];
                return i.next_peer = t.peerId, i.tabs[t.peerId] = t, ne(i, t, !1, function(e) {
                    return [t.peerId].concat(e)
                }), i.longpoll.resume(), i
            }).then(function(t) {
                return e ? function(e, t, n) {
                    return Object(r.b)("al_page.php", {
                        act: "owner_photo_save",
                        peer: e,
                        _query: t
                    }).then(function(e) {
                        return n
                    })
                }(t.next_peer, e, t) : t
            }).then(function(e) {
                return e.creating = !1, e
            }).catch(function(e) {
                throw i.creating = !1, i.longpoll.resume(), e
            })
        });

        function Dt(e) {
            var t = void 0;
            e.resync_in_process = new Promise(function(e) {
                t = e
            });
            var n = Object.keys(e.tabs).length,
                i = e.active_tab;
            return Object(r.b)(w, {
                act: "a_resync",
                sel: e.peer,
                gid: e.gid,
                loaded: n,
                tab: i,
                add_peers: e.tabbedPeers.map(function(e) {
                    return e.peer
                }).join(",")
            }).then(function(n) {
                var r = y(n, 5),
                    o = r[0],
                    a = r[1],
                    c = r[2],
                    d = r[3],
                    _ = r[4];
                a.forEach(function(t) {
                    return Object(f.a)(e, t)
                }), Object(u.lb)(e, o), c.user_unread && handlePageCount("msg", c.user_unread), Object(s.i)("Resync success", "success");
                var p = e.peer,
                    m = void 0;
                if (Object(u.Ya)(p)) m = Promise.resolve(!1);
                else {
                    var g = {
                        tabs: O({}, p, e.tabs[p]),
                        oCache: {}
                    };
                    m = pe(O({}, p, o[p]), g)
                }
                return m.then(function(n) {
                    e.tabs = o, e.admins = extend(e.admins, d), n && (e.tabs[p] = n.tabs[p], e.tabs[p].history = Object(u.Hb)(p, e, L(e.tabs[p].history))), e.loadingDialogs = !1, e.mutedPeers = c.mutedPeers, e.lastDialogsOptions = {
                        has_more: c.has_more
                    }, e.dialog_tab_cts = c.folder_cts, e.dialog_tabs[i] = _.map(intval);
                    var r = e.dialog_tabs[i].map(function(t) {
                        return e.tabs[t]
                    });
                    return Object.keys(e.dialog_tabs).filter(function(e) {
                        return e != i
                    }).forEach(function(t) {
                        i == l.h ? e.dialog_tabs[t] = r.filter(Ht(t)).map(function(e) {
                            return e.peerId
                        }) : e.dialog_tabs[t] = []
                    }), delete e.resync_in_process, setTimeout(t.bind(null, !0), 0), Rt(intval(c.unread), e)
                })
            }).catch(function(t) {
                return Object(s.i)("Resync error: " + t.message + " " + t.stack, "error"), Object(a.c)(2).then(Dt.bind(null, e))
            })
        }

        function Bt(e, t) {
            return t.lockedSending = e, Promise.resolve(t)
        }

        function Lt(e, t, n) {
            return e && !n.delayed_message ? (n.delayed_message = e, n.delayed_ts = t) : e || (n.delayed_message = e, n.delayed_ts = t), Promise.resolve(n)
        }

        function At(e) {
            return !!e.textMediaSelector.urlAttachmentLoading || !!(window.Upload && Upload.options && Upload.isSomethingUploading) && Object.keys(Upload.options).filter(function(e) {
                return Upload.isSomethingUploading(e)
            }).length > 0
        }

        function Rt(e, t) {
            return t.unread_cnt = e, t.dialog_tab_cts[l.m] = e, Promise.resolve(t)
        }

        function Nt(e, t) {
            return t.ctrl_submit = !!e, Object(r.b)(w, {
                act: "a_save_ctrl_submit",
                to: t.peer,
                hash: t.tabs[t.peer].hash,
                value: e ? 1 : 0
            }).then(function(e) {
                return t
            })
        }

        function Ut(e, t, n) {
            n.cur_unread_cnt || (n.cur_unread_cnt = {}), t && !inArray(e, n.mutedPeers) && (n.cur_unread_cnt[e] = !0);
            var r = document.title,
                i = window.devicePixelRatio >= 2 ? "_2x" : "";
            if (t && !n.update_title_to) {
                var o = function(e, t, n) {
                    return function() {
                        n.update_old_title = e;
                        var r = Object.keys(n.cur_unread_cnt).length;
                        if (0 === r) return Object(b.Oa)(e || document.title), setFavIcon("/images/icons/favicons/fav_im" + t + ".ico"), clearInterval(n.update_title_to), void(n.update_title_to = !1);
                        e ? (Object(b.Oa)(e), setFavIcon("/images/icons/favicons/fav_im" + t + ".ico"), e = !1) : (e = document.title, setFavIcon("/images/icons/favicons/fav_im" + (r > 9 ? 10 : r) + t + ".ico"), Object(b.Oa)(winToUtf(getLang("mail_im_new_messages", r))))
                    }
                }(r, i, n);
                n.update_title_to = setInterval(o, 1e3), o()
            } else !t && n.update_old_title && (Object(b.Oa)(n.update_old_title), n.cur_unread_cnt = {}, r = !1, n.update_old_title = !1, setFavIcon("/images/icons/favicons/fav_im" + i + ".ico"), clearInterval(n.update_title_to), n.update_title_to = !1);
            return Promise.resolve(n)
        }

        function Wt(e, t, n, r, i) {
            return Object(u.Oa)(i, e) && (i.tabs[e].scrollTop = intval(t), i.tabs[e].scrollBottom = intval(n), i.tabs[e].contHeight = intval(r)), Promise.resolve(i)
        }

        function Ht(e) {
            return e === l.h ? function(e) {
                return !Object(u.fc)(e)
            } : e === l.m ? function(e) {
                return e.unread > 0
            } : function(t) {
                return t.folders & l.j[e]
            }
        }

        function Kt(e, t) {
            t.active_tab = e, Object(i.b)({
                tab: e === l.h ? null : e
            });
            var n = [];
            if (e !== l.h && !Object(u.Za)(t)) {
                var r = t.dialog_tabs[e];
                n = t.dialog_tabs[l.h].map(function(e) {
                    return t.tabs[e]
                }).filter(Ht(e)).map(function(e) {
                    return e.peerId
                }), t.dialog_tabs[e] = r.length >= n.length ? r : n
            }
            return Promise.resolve(t)
        }

        function qt(e, t, n, r) {
            var i = e.dialog_tabs_all;
            return !(!i[l.h] && !i[t]) || (n.filter(function(e) {
                return e === r.peerId
            }).length > 0 || ("r" === r.lastmsg[0] || n.map(function(t) {
                return e.tabs[t.toString()]
            }).filter(function(t) {
                return Object(u.Za)(e) ? t.lastmsg > r.lastmsg : t.lastmsg < r.lastmsg
            }).length > 0))
        }

        function Ft(e, t, n, r, i) {
            if (Object(u.bb)(i, e)) {
                var a = i.tabs[e];
                return n === o.L && (t ^= a.folders),
                    function(e, t, n) {
                        return !(e === o.T && n.folders & t || !(e !== o.P || n.folders & t))
                    }(n, t, a) && Object.keys(l.j).filter(function(e) {
                        return l.j[e] & t
                    }).forEach(function(e) {
                        i.dialog_tab_cts[e] += function(e, t, n) {
                            return t !== o.P || e.folders & l.j[n] ? t === o.L ? e.folders & l.j[n] ? -1 : 1 : t === o.T ? 1 : -1 : 0
                        }(a, n, e)
                    }), n === o.T ? i.tabs[e].folders |= t : n === o.P ? i.tabs[e].folders &= ~t : i.tabs[e].folders = t ^= a.folders, ne(i, i.tabs[e], !0, function(t, n) {
                        return t.concat([e]).map(function(e) {
                            return i.tabs[e]
                        }).filter(Ht(n)).map(function(e) {
                            return e.peerId
                        })
                    }, qt.bind(null, i)), Promise.resolve(i)
            }
            return N(e, 0, 0, 0, i).then(Ft.bind(null, e, t, n, i))
        }
        var zt = B(function(e, t) {
                var n = l.j[l.i],
                    i = t.tabs[e].folders & n,
                    a = i ? o.Ya : o.cb;
                return t.longpoll.push([a([0, e, n, !0])]), Object(r.b)(w, {
                    act: "a_dialog_star",
                    val: i ? 0 : 1,
                    peer: e,
                    hash: t.tabs[e].hash,
                    gid: t.gid
                }).then(function() {
                    return t
                })
            }),
            Vt = B(function(e, t, n) {
                var i = l.j[l.n];
                return n.longpoll.push([o.Ya([0, e, i, !0]), o.Pa([6, e, t])]), Object(r.b)(w, {
                    act: "a_mark_answered",
                    peer: e,
                    lastmsg: t,
                    hash: n.tabs[e].hash,
                    gid: n.gid
                }).then(function() {
                    return n
                })
            });

        function Qt(e) {
            return Object(r.b)(w, {
                act: "a_get_mutex_key",
                gid: e
            })
        }

        function Gt(e, t) {
            return R(O({}, e, {
                free: !0
            }), t), Object(r.b)(w, {
                act: "a_block_release",
                peer: e,
                gid: t.gid
            }).then(function() {
                return t
            })
        }

        function Xt(e, t) {
            var n = ls.get("comm_mute_" + t.gid) ? 1 : 0;
            return e && (n ^= 1), ls.set("comm_mute_" + t.gid, n), t.mute = n, Promise.resolve(t)
        }
        var Yt = B(function(e, t) {
            return ne(t, t.tabs[e], !0, function(t) {
                return t.filter(function(t) {
                    return t !== e
                })
            }), t.tabs[e].deletedDialog = !0, Object(r.b)(w, {
                act: "a_delete_dialog",
                peer: e,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(function(n) {
                return n[0] ? ($t(t.tabbedPeers.filter(function(t) {
                    return t.peer !== e
                }), !0, t), t.tabs[e].unread = 0, t.tabs[e].lastmsg = !1, t.tabs[e].lastmsg_meta = null) : (t.tabs[e].deletedDialog = !1, ne(t, t.tabs[e], !1, ie.bind(null, e), qt.bind(null, t))), n
            })
        });

        function Jt(e, t, n, i) {
            return Object(r.b)(w, {
                act: "a_restore_dialog",
                hash: t,
                gid: i.gid,
                spam: n ? 1 : 0,
                peer: e
            }).then(function(t) {
                return i.tabs[e].deletedDialog = !1, ne(i, i.tabs[e], !1, function(t) {
                    return [e].concat(t)
                }), i.tabs[e].unread = t, i
            })
        }

        function Zt(e, t, n) {
            return Object(r.b)(w, {
                act: "a_spam_dialog",
                peer: e,
                gid: n.gid,
                hash: t
            })
        }

        function $t(e, t, n) {
            return n.tabbedPeers = e, Object(u.Ia)(n) && (P({
                peers: n.tabbedPeers.filter(function(e) {
                    var t = e.peer,
                        r = e.type;
                    return t !== n.peer && "perm" === r
                }).map(function(e) {
                    return Object(u.R)(e.peer, n)
                }).filter(function(e) {
                    return !e.deletedDialog
                }).map(function(e) {
                    return e.peerId
                }).map(u.H).join("_")
            }), t && M()), Promise.resolve(n)
        }

        function en(e) {
            return !e.peer || (qe(e.peer, e) ? Ke(e.peer, e) : !!Object(u.Oa)(e, e.peer) && e.tabs[e.peer].allShown)
        }

        function tn(e, t) {
            var n = t.tabs[e];
            return Object(u.Oa)(t, e) && (n.skipped = null, n.msgs = null, n.offset = null, n.allShown = null, n.history = null), Promise.resolve(t)
        }

        function nn(e, t) {
            var n = t.tabs[e];
            return Object(u.Oa)(t, e) && (n.history = A(n.history)), Promise.resolve(t)
        }

        function rn(e, t) {
            return t.go_to_end_visible = e, Promise.resolve(t)
        }

        function on(e, t, n) {
            if (!Object(u.Ka)(t)) return Promise.resolve(n);
            var i = Object(d.t)(n, t);
            return i.blocked_community = !e, Object(r.b)(w, {
                act: "a_toggle_community",
                peer_id: t,
                hash: i.hash,
                state: e ? 1 : 0
            }).then(function() {
                return Q(n)
            })
        }

        function an(e, t) {
            if (0 !== t.peer && Object(u.Oa)(t, t.peer)) {
                var n = Object(d.t)(t, t.peer);
                n.history = L(n.history), e(n.history)
            }
            return Promise.resolve(t)
        }

        function sn(e) {
            return e.audio_msg.isRecording = !1, Promise.resolve(e)
        }

        function cn(e, t) {
            return t.voice_message_available = e, Promise.resolve(t)
        }

        function un(e) {
            P({
                act: e ? "create" : null
            }), M()
        }

        function ln() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null;
            P({
                q: e
            }), M()
        }

        function dn(e) {
            return void 0 === e.chatResizeInitialized && (e.chatResizeInitialized = !0, Object(u.U)() > window.clientHeight() && Object(u.Jb)(0)), Promise.resolve(e)
        }
        var _n = B(function(e, t, n) {
            return Object(r.b)(w, {
                act: "a_join_chat",
                chat_id: e,
                hash: t,
                write_hash: n.writeHash
            }).then(function(e) {
                var t = y(e, 4),
                    r = t[0],
                    i = t[1],
                    o = t[2],
                    a = t[3];
                return o.forEach(function(e) {
                    return Object(f.a)(n, e)
                }), n.tabs[r] = i, ne(n, i, !1, ie.bind(null, r), qt.bind(null, n)), n.admins = extend(n.admins, a), [r]
            })
        });

        function fn(e, t) {
            return Object(r.b)(w, {
                act: "a_get_link",
                gid: t.gid,
                chat_id: e
            })
        }
        var pn = B(function(e, t) {
            var n = t.tabs[e];
            return Object(r.b)(w, {
                act: "a_reset_link",
                chat_id: e - 2e9,
                write_hash: t.writeHash
            }).then(function(e) {
                return n.inviteLink = e[0], e
            })
        });

        function mn(e) {
            return T({
                invite_chat_id: null,
                invite_hash: null
            }), e.invitation = void 0, Promise.resolve(e)
        }

        function gn(e, t) {
            var n = Object(s.a)([e].concat(t.select(c.b))).slice(0, 500);
            t.update(c.b, n)
        }

        function hn(e) {
            e.update(c.b, [])
        }

        function bn(e, t) {
            var n = t.select(c.b).filter(function(t) {
                return t !== e
            });
            return t.update(c.b, n), n
        }

        function vn(e, t, n) {
            var r = n.tabs[t],
                i = Object(d.m)(n, t, e);
            return r.data.kicked || r.data.closed || i.kludges.source_act || (r.pinned = i), Promise.resolve(n)
        }

        function yn(e, t) {
            return t.tabs[e].pinned = null, Promise.resolve(t)
        }
        var On = B(function(e, t, n) {
                var i = n.tabs[t];
                return i.data.kicked || i.data.closed ? Promise.resolve(n) : Object(r.b)(w, {
                    act: "a_pin_message",
                    msgid: e,
                    chat: t,
                    gid: n.gid,
                    hash: n.tabs[t].hash
                }).then(function(e) {
                    var r = y(e, 1)[0];
                    return n.tabs[t] = Object.assign({}, i, r), n
                })
            }),
            jn = B(function(e, t) {
                var n = t.tabs[e];
                return n.data.kicked || n.data.closed ? Promise.resolve(t) : Object(r.b)(w, {
                    act: "a_unpin_message",
                    chat: e,
                    gid: t.gid,
                    hash: t.tabs[e].hash
                }).then(function(r) {
                    var i = y(r, 1)[0];
                    return t.tabs[e] = Object.assign({}, n, i), t
                })
            }),
            wn = B(function(e, t) {
                var n = t.tabs[e];
                return Object(r.b)(w, {
                    act: "a_get_pinned_message",
                    chat: e,
                    gid: t.gid,
                    hash: t.tabs[e].hash
                }).then(function(e) {
                    var r = y(e, 1)[0];
                    return n.pinned = r || null, t
                })
            }),
            En = B(function(e, t, n) {
                var i = n.tabs[e];
                return Object(r.b)(w, {
                    act: "a_get_message_local_id",
                    chat: e,
                    chat_local_id: t,
                    hash: i.hash
                })
            }),
            kn = B(function(e, t) {
                var n = t.tabs[e];
                return n.membersLoaded ? Promise.resolve(t) : Object(r.b)(w, {
                    act: "a_get_chat_members",
                    chat: e,
                    gid: t.gid,
                    hash: n.hash
                }).then(function(e) {
                    var r = y(e, 1),
                        i = y(r[0], 3),
                        o = i[0],
                        a = i[1],
                        s = i[2];
                    return n.memberIds = o, n.adminIds = a, s.forEach(function(e) {
                        return Object(f.a)(t, e)
                    }), n.membersLoaded = !0, t
                })
            }),
            Cn = B(function(e, t) {
                return Promise.all([kn(e, t), function(e, t) {
                    var n = t.tabs[e];
                    return Object(r.b)(w, {
                        act: "a_get_chat_details",
                        chat: e,
                        gid: t.gid,
                        hash: n.hash
                    }).then(function(e) {
                        var r = y(e, 1)[0];
                        return n.photoGrid = r.grid, n.photoLarge = r.photo, n.membersLastSeen = r.lastSeen || null, n.inviters = r.inviters, n.caccess = r.caccess, n.invitedByMe = r.invitedByMe || [], n.inviteLink = r.link || null, n.serverSettings = r.serverSettings || null, t
                    })
                }(e, t)]).then(function() {
                    return t
                })
            }),
            xn = B(function(e, t, n) {
                var i = n.tabs[e];
                return Object(r.b)(w, {
                    act: "a_update_flags",
                    chat: e,
                    hash: i.hash,
                    flags: t
                })
            }),
            Pn = B(function(e, t) {
                var n = t.tabs[e];
                return Object(r.b)("al_page.php", {
                    act: "owner_photo_remove",
                    oid: e,
                    gid: t.gid,
                    hash: n.photoHash
                }).then(function() {
                    return n.photo = null, n.photoLarge = null, t
                })
            });

        function Mn(e, t, n) {
            var r = n.tabs[e];
            return r.memberIds = r.memberIds.filter(function(e) {
                return e !== t
            }), r.adminIds = r.adminIds.filter(function(e) {
                return e !== t
            }), r.membersCount = r.memberIds.length, Promise.resolve(n)
        }
        var Tn = B(function(e, t, n) {
            var i = n.tabs[e];
            return Object(r.b)(w, {
                act: "a_kick_user",
                chat: e,
                hash: i.hash,
                mid: t
            }).then(function() {
                return i.memberIds = i.memberIds.filter(function(e) {
                    return e !== t
                }), i.adminIds = i.adminIds.filter(function(e) {
                    return e !== t
                }), i.membersCount = i.memberIds.length, n
            })
        });

        function In(e, t, n, r) {
            var i = r.tabs[e];
            return i.adminIds = n ? [].concat(i.adminIds, t).filter(function(e, t, n) {
                return n.indexOf(e) === t
            }) : i.adminIds.filter(function(e) {
                return e !== t
            }), Promise.resolve(r)
        }
        var Sn = B(function(e, t, n, i) {
            var o = i.tabs[e];
            return Object(r.b)(w, {
                act: "a_toggle_admin",
                chat: e,
                hash: o.hash,
                mid: t,
                is_admin: +n
            }).then(function() {
                return In(e, t, n, i)
            })
        });

        function Dn(e, t, n, r) {
            var i = Object(d.m)(e, n, t).userId;
            return Object(f.c)(r, i) ? Promise.resolve(r) : pt(O({}, n, [i]), r)
        }

        function Bn() {
            ajax.post("al_im.php", {
                act: "a_hide_promo_tooltip"
            })
        }

        function Ln() {
            cur.videoAutoplayScrollHandler && cur.videoAutoplayScrollHandler()
        }
        var An = B(function(e, t) {
                return t.tabs[e].top_banner = void 0, Object(r.b)(w, {
                    act: "a_hide_banner",
                    peer_id: e,
                    gid: t.gid,
                    hash: t.tabs[e].hash
                }).then(function() {
                    return t
                })
            }),
            Rn = B(function(e, t, n) {
                n.tabs[e].top_banner = void 0;
                var i = n.tabs[e];
                return Object(r.b)(w, {
                    act: "a_callback_banner",
                    peer_id: e,
                    callback_data: t,
                    hash: i.hash
                }).then(function() {
                    return n
                })
            });

        function Nn(e, t) {
            return Object(r.b)(w, {
                act: "a_load_banner",
                peer_id: e,
                gid: t.gid
            }).then(function(n) {
                var r = y(n, 1)[0];
                return t.tabs[e].top_banner = r, t
            })
        }

        function Un(e, t, n) {
            return n.tabs[e].keyboard = t && t.buttons ? t : null, Hn(e, !1, !0, n)
        }

        function Wn(e, t) {
            return Un(e, null, t)
        }

        function Hn(e, t, n, r) {
            return ((r.tabs || {})[e] || {}).keyboard && (r.tabs[e].keyboard.hide = t, n && ls.set("is_keyboards_hide", Object.assign(ls.get("is_keyboards_hide") || {}, O({}, e, t)))), Promise.resolve(r)
        }
        var Kn = B(function(e, t) {
            var n = t.tabs[e];
            return Object(r.b)(w, {
                act: "a_get_keyboard",
                peer_id: e,
                hash: n.hash
            }).then(function(n) {
                var r = y(n, 1)[0];
                return Un(e, r, t)
            })
        });

        function qn(e, t, n, i) {
            var o = i.tabs[e];
            return o.caccess[t] = n, Object(r.b)(w, {
                act: "a_change_caccess",
                peer_id: e,
                member_id: t,
                hash: o.hash,
                access: n ? 1 : 0
            }).then(function() {
                return i
            }).catch(function(e) {
                throw o.caccess[t] = !n, e
            })
        }
        var Fn = B(function(e, t) {
            var n = t.tabs[t.peer];
            return Object(r.b)(w, {
                act: "a_delete_template",
                template_id: e,
                hash: n.hash,
                gid: t.gid,
                peer_id: t.peer
            }).then(function() {
                var n = t.templates.find(function(t) {
                    return t.id === e
                });
                return n && (n.deleted = !0), t
            })
        });

        function zn(e, t, n) {
            var i = n.tabs[n.peer];
            return Object(r.b)(w, {
                act: "a_create_template",
                hash: i.hash,
                gid: n.gid,
                peer_id: n.peer,
                name: e,
                text: t
            }).then(function(e) {
                return n.templates.unshift(e[0]), n
            })
        }

        function Vn(e, t, n, i) {
            var o = i.tabs[i.peer];
            return Object(r.b)(w, {
                act: "a_update_template",
                template_id: e,
                hash: o.hash,
                gid: i.gid,
                peer_id: i.peer,
                group_id: i.gid,
                name: t,
                text: n
            }).then(function(t) {
                var n = i.templates.find(function(t) {
                    return t.id === e
                });
                return n && Object.assign(n, t[0]), i
            })
        }

        function Qn(e, t) {
            if (Object(u.Oa)(t, e)) {
                var n = Object(d.t)(t, e);
                n.allShown = !1, n.lastReset = Date.now()
            }
            return t
        }
    },
    vhPU: function(e, t) {
        e.exports = function(e) {
            if (void 0 == e) throw TypeError("Can't call method on  " + e);
            return e
        }
    },
    w2a5: function(e, t, n) {
        var r = n("aCFj"),
            i = n("ne8i"),
            o = n("Cfrj");
        e.exports = function(e) {
            return function(t, n, a) {
                var s, c = r(t),
                    u = i(c.length),
                    l = o(a, u);
                if (e && n != n) {
                    for (; u > l;)
                        if ((s = c[l++]) != s) return !0
                } else
                    for (; u > l; l++)
                        if ((e || l in c) && c[l] === n) return e || l;
                return !e && -1
            }
        }
    },
    "wSs/": function(e, t, n) {
        "use strict";
        n.d(t, "a", function() {
            return c
        }), n.d(t, "b", function() {
            return u
        }), n.d(t, "c", function() {
            return l
        }), n.d(t, "e", function() {
            return d
        }), n.d(t, "d", function() {
            return _
        });
        var r = n("rHUl"),
            i = n("MhhX"),
            o = n("P13b"),
            a = n("eTng"),
            s = n("aong");

        function c(e, t) {
            t = Object(r.P)(t);
            var n = vk.id == t.peerId && !Object(s.r)(e).gid;
            return 333 != t.peerId && (!(!n && !Object(i.k)(t)) && (!Object(i.l)(t) && (!(Date.now() / 1e3 - t.date > 86400) && (!(Object(i.f)(t) || Object(i.m)(t) || Object(i.d)(t) || Object(i.g)(t) || Object(i.i)(t) || Object(i.o)(t)) && !Object(o.Fa)(e, t.peerId, t.messageId)))))
        }

        function u(e) {
            var t = document.createElement("div");
            return e = e.replace(/\[((id|club)\d+)\|(.+?)]/g, function() {
                var e = arguments.length <= 1 ? void 0 : arguments[1],
                    t = arguments.length <= 3 ? void 0 : arguments[3];
                return /^\@/.test(t) ? t : "@" + e + " (" + t + ")"
            }), t.innerHTML = e, Emoji.val(t)
        }

        function l(e, t) {
            return +(t && t.msgs ? Object.keys(t.msgs) : []).filter(function(e) {
                return e > 0
            }).sort(function(e, t) {
                return t - e
            }).find(function(n) {
                return c(e, t.msgs[n])
            }) || null
        }

        function d(e, t, n) {
            var r = Object(a.a)(t.kludges, t.messageId),
                i = n.dData.attaches;
            if (u(t.text) !== n.dData.txt || r.length !== i.length) return !0;
            for (var o = r.length; o--;) {
                var s = r[o],
                    c = i[o];
                if (s.id != c.id || s.type != c.type || "poll" == s.type && c.object && c.object.poll_is_edited) return !0
            }
            return !1
        }

        function _(e, t, n, r, i, a) {
            t.origText = n, t.text = Object(o.Fb)(clean(n)).replace(/\n/gi, "<br>"), t.attaches = r, t.kludges.emoji = 1, t.local = 1, t.share_url = i, t.cancelled_shares = a, t.update_time = Math.floor(Date.now() / 1e3), e.get().tabs[t.peerId].msgs[t.messageId] = t
        }
    },
    wmvG: function(e, t, n) {
        "use strict";
        var r = n("hswa").f,
            i = n("Kuth"),
            o = (n("Mukb"), n("3Lyj")),
            a = n("m0Pp"),
            s = n("9gX7"),
            c = n("vhPU"),
            u = n("SlkY"),
            l = n("Afnz"),
            d = n("1TsA"),
            _ = n("elZq"),
            f = n("nh4g"),
            p = n("Z6vF").fastKey,
            m = f ? "_s" : "size",
            g = function(e, t) {
                var n, r = p(t);
                if ("F" !== r) return e._i[r];
                for (n = e._f; n; n = n.n)
                    if (n.k == t) return n
            };
        e.exports = {
            getConstructor: function(e, t, n, l) {
                var d = e(function(e, r) {
                    s(e, d, t, "_i"), e._i = i(null), e._f = void 0, e._l = void 0, e[m] = 0, void 0 != r && u(r, n, e[l], e)
                });
                return o(d.prototype, {
                    clear: function() {
                        for (var e = this._i, t = this._f; t; t = t.n) t.r = !0, t.p && (t.p = t.p.n = void 0), delete e[t.i];
                        this._f = this._l = void 0, this[m] = 0
                    },
                    delete: function(e) {
                        var t = g(this, e);
                        if (t) {
                            var n = t.n,
                                r = t.p;
                            delete this._i[t.i], t.r = !0, r && (r.n = n), n && (n.p = r), this._f == t && (this._f = n), this._l == t && (this._l = r), this[m]--
                        }
                        return !!t
                    },
                    forEach: function(e) {
                        s(this, d, "forEach");
                        for (var t, n = a(e, arguments.length > 1 ? arguments[1] : void 0, 3); t = t ? t.n : this._f;)
                            for (n(t.v, t.k, this); t && t.r;) t = t.p
                    },
                    has: function(e) {
                        return !!g(this, e)
                    }
                }), f && r(d.prototype, "size", {
                    get: function() {
                        return c(this[m])
                    }
                }), d
            },
            def: function(e, t, n) {
                var r, i, o = g(e, t);
                return o ? o.v = n : (e._l = o = {
                    i: i = p(t, !0),
                    k: t,
                    v: n,
                    p: r = e._l,
                    n: void 0,
                    r: !1
                }, e._f || (e._f = o), r && (r.n = o), e[m]++, "F" !== i && (e._i[i] = o)), e
            },
            getEntry: g,
            setStrong: function(e, t, n) {
                l(e, t, function(e, t) {
                    this._t = e, this._k = t, this._l = void 0
                }, function() {
                    for (var e = this._k, t = this._l; t && t.r;) t = t.p;
                    return this._t && (this._l = t = t ? t.n : this._t._f) ? d(0, "keys" == e ? t.k : "values" == e ? t.v : [t.k, t.v]) : (this._t = void 0, d(1))
                }, n ? "entries" : "values", !n, !0), _(t)
            }
        }
    },
    xpql: function(e, t, n) {
        e.exports = !n("nh4g") && !n("eeVq")(function() {
            return 7 != Object.defineProperty(n("Iw71")("div"), "a", {
                get: function() {
                    return 7
                }
            }).a
        })
    },
    y3w9: function(e, t, n) {
        var r = n("0/R4");
        e.exports = function(e) {
            if (!r(e)) throw TypeError(e + " is not an object!");
            return e
        }
    },
    yLpj: function(e, t) {
        var n;
        n = function() {
            return this
        }();
        try {
            n = n || Function("return this")() || (0, eval)("this")
        } catch (e) {
            "object" == typeof window && (n = window)
        }
        e.exports = n
    },
    ylqs: function(e, t) {
        var n = 0,
            r = Math.random();
        e.exports = function(e) {
            return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++n + r).toString(36))
        }
    },
    yt8O: function(e, t, n) {
        "use strict";
        var r = n("nGyu"),
            i = n("1TsA"),
            o = n("hPIQ"),
            a = n("aCFj");
        e.exports = n("Afnz")(Array, "Array", function(e, t) {
            this._t = a(e), this._i = 0, this._k = t
        }, function() {
            var e = this._t,
                t = this._k,
                n = this._i++;
            return !e || n >= e.length ? (this._t = void 0, i(1)) : i(0, "keys" == t ? n : "values" == t ? e[n] : [n, e[n]])
        }, "values"), o.Arguments = o.Array, r("keys"), r("values"), r("entries")
    },
    zhAb: function(e, t, n) {
        var r = n("aagx"),
            i = n("aCFj"),
            o = n("w2a5")(!1),
            a = n("YTvA")("IE_PROTO");
        e.exports = function(e, t) {
            var n, s = i(e),
                c = 0,
                u = [];
            for (n in s) n != a && r(s, n) && u.push(n);
            for (; t.length > c;) r(s, n = t[c++]) && (~o(u, n) || u.push(n));
            return u
        }
    }
});