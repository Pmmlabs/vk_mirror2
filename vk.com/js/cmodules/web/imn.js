! function(e) {
    var t = {};

    function n(r) {
        if (t[r]) return t[r].exports;
        var o = t[r] = {
            i: r,
            l: !1,
            exports: {}
        };
        return e[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports
    }
    n.m = e, n.c = t, n.d = function(e, t, r) {
        n.o(e, t) || Object.defineProperty(e, t, {
            enumerable: !0,
            get: r
        })
    }, n.r = function(e) {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
            value: "Module"
        }), Object.defineProperty(e, "__esModule", {
            value: !0
        })
    }, n.t = function(e, t) {
        if (1 & t && (e = n(e)), 8 & t) return e;
        if (4 & t && "object" == typeof e && e && e.__esModule) return e;
        var r = Object.create(null);
        if (n.r(r), Object.defineProperty(r, "default", {
                enumerable: !0,
                value: e
            }), 2 & t && "string" != typeof e)
            for (var o in e) n.d(r, o, function(t) {
                return e[t]
            }.bind(null, o));
        return r
    }, n.n = function(e) {
        var t = e && e.__esModule ? function() {
            return e.default
        } : function() {
            return e
        };
        return n.d(t, "a", t), t
    }, n.o = function(e, t) {
        return Object.prototype.hasOwnProperty.call(e, t)
    }, n.p = "", n(n.s = 6)
}([function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createLongpollConnect", function() {
        return p
    });
    var r = n(392),
        o = n(364),
        i = n(112),
        a = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        s = 202,
        c = 6,
        u = 4;

    function l(e, t) {
        e.waitAbortFns.push(t)
    }

    function d(e) {
        if (e.isStoppedFn()) return Promise.resolve({
            ts: 0,
            updates: []
        });
        var t = Object(o.plaingetCancelable)(e.url, {
                act: "a_check",
                key: e.key,
                version: e.version,
                ts: e.ts,
                wait: 25,
                mode: e.mode
            }),
            n = t.request,
            i = t.cancel;
        return e.stopFn = i, n.then(function(t) {
            var n = a(t, 2),
                r = n[0],
                o = n[1];
            return e.onData(e, o), e.waitTimeout = 2, JSON.parse(r)
        }).catch(function(t) {
            var n = a(t, 2),
                r = (n[0], n[1]);
            throw e.onData(e, r), ""
        }).then(function(t) {
            return function(e, t) {
                var n = t.failed ? Object(r.abortablePause)(u, null) : {},
                    o = n.abort,
                    i = n.pause;
                switch (t.failed) {
                    case 1:
                        return l(e, o), e.onHistoryLost(e, t).then(function() {
                            return e.onResult({
                                ts: t.ts,
                                updates: [
                                    [-1]
                                ]
                            })
                        }).then(i).then(function() {
                            return d(e)
                        });
                    case 2:
                        return l(e, o), e.onKeyExpired(e, t).then(function(t) {
                            var n = a(t, 4),
                                r = n[0],
                                o = n[1],
                                i = n[2],
                                s = n[3];
                            return e.onResult({
                                ts: +s,
                                updates: [
                                    [-2, r, o + "/" + i],
                                    [-1]
                                ]
                            })
                        }).then(i).then(function() {
                            return d(e)
                        });
                    case 3:
                        return e.onLpBroken(e, t);
                    default:
                        return t
                }
            }(e, t)
        })
    }

    function f(e) {
        e.isStoppedFn() || d(e).then(e.onResult).catch(function(t) {
            return function(e, t) {
                if (e.isStoppedFn()) return;
                e.onRequestError(t), e.waitTimeout = Math.min(64, 2 * e.waitTimeout);
                var n = Object(r.abortablePause)(e.waitTimeout, null),
                    o = n.abort,
                    i = n.pause;
                return l(e, o), i()
            }(e, t)
        }).then(function() {
            return f(e)
        })
    }

    function p(e, t) {
        var n = !!e.stopped,
            r = {
                id: e.id,
                key: e.key,
                ts: e.ts,
                url: e.url,
                lpstat: e.lpstat || 0,
                version: e.version || c,
                mode: s,
                waitTimeout: 2,
                waitAbortFns: [],
                isStoppedFn: function() {
                    return n
                },
                onResult: function(e) {
                    e.ts && a(r.ts, e.ts, e.updates.map(function(e) {
                        switch (e[0]) {
                            case 0:
                                return i.deleteEvent(e);
                            case 1:
                                return i.replaceFlagsEvent(e);
                            case 2:
                                return i.setFlagsEvent(e);
                            case 3:
                                return i.resetFlagsEvent(e);
                            case 4:
                                return i.addMessageEvent(e);
                            case 5:
                                return i.editMessageEvent(e);
                            case 6:
                                return i.readInboundEvent(e);
                            case 7:
                                return i.readOutboundEvent(e);
                            case 8:
                                return i.gotOnlineEvent(e);
                            case 9:
                                return i.gotOfflineEvent(e);
                            case 10:
                                return i.resetDirectoriesEvent(e);
                            case 11:
                                return i.replaceDirectoriesEvent(e);
                            case 12:
                                return i.setDirectoriesEvent(e);
                            case 13:
                                return i.deleteDialogEvent(e);
                            case 18:
                                return i.replaceMessageEvent(e);
                            case 51:
                                return i.chatChangedEvent(e);
                            case 52:
                                return i.chatUpdatedEvent(e);
                            case 63:
                                return i.typingEvent(e);
                            case 64:
                                return i.recordingAudioEvent(e);
                            case 70:
                                return i.videoCallEvent(e);
                            case 80:
                                return i.unreadCountEvent(e);
                            case 114:
                                return i.notifySettingsChangedEvent(e);
                            case 116:
                                return i.refreshMessageEvent(e);
                            case 117:
                                return i.audioStartEvent(e);
                            case -1:
                                return i.resyncEvent();
                            case -2:
                                return i.refreshLpKeyEvent(e);
                            default:
                                return i.emptyEvent(e)
                        }
                    }))
                },
                onData: _(t.onData),
                onRequestError: _(t.onRequestError),
                onHistoryLost: m(t.onHistoryLost),
                onKeyExpired: m(t.onKeyExpired),
                onLpBroken: m(t.onHistoryLost)
            },
            o = t.onEvents;

        function a(e, t, n) {
            r.ts = t;
            for (var a = 0; a < n.length; ++a) n[a].type === i.REFRESH_LP_KEY && (r.key = n[a].key, r.url = n[a].url);
            o(e, t, n)
        }
        var u = {
            options: r,
            isStopped: function() {
                return n
            },
            stopConnection: function() {
                n = !0, r.stopFn && r.stopFn(), r.stopFn = void 0, this.abortWaiting()
            },
            reinitConnection: function() {
                this.stopConnection(), n = !1, f(r)
            },
            abortWaiting: function() {
                r.waitAbortFns.forEach(function(e) {
                    return e()
                }), r.waitAbortFns = [], r.waitTimeout = 2
            },
            onLp: a
        };
        return f(r), u
    }

    function _(e) {
        return e || function() {}
    }

    function m(e) {
        return e ? function() {
            return Promise.resolve(e.apply(void 0, arguments))
        } : function() {
            return Promise.reject()
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "SENDING_CLASS", function() {
        return w
    }), n.d(t, "FAILED_CLASS", function() {
        return E
    }), n.d(t, "ORIGINAL_CLASS", function() {
        return C
    }), n.d(t, "RESTORE_CLASS", function() {
        return j
    }), n.d(t, "TYPING_CLASS", function() {
        return k
    }), n.d(t, "CREATE_CHAT_ACTION", function() {
        return T
    }), n.d(t, "CHAT_TITLE_ACTION", function() {
        return S
    }), n.d(t, "CHAT_INVITE_USER", function() {
        return M
    }), n.d(t, "CHAT_KICK_USER", function() {
        return P
    }), n.d(t, "CHAT_PHOTO_UPDATE", function() {
        return x
    }), n.d(t, "CHAT_PHOTO_REMOVE", function() {
        return I
    }), n.d(t, "CHAT_PIN_MESSAGE", function() {
        return D
    }), n.d(t, "CHAT_UNPIN_MESSAGE", function() {
        return A
    }), n.d(t, "CHAT_INVITE_BY_LINK", function() {
        return L
    }), n.d(t, "DESELECT_ALL_CLASS", function() {
        return R
    }), n.d(t, "HIDE_TOP_NOTICE_CLASS", function() {
        return B
    }), n.d(t, "HIDE_ASIDE_NOTICE_CLASS", function() {
        return N
    }), n.d(t, "HIDE_ASIDE_PROMO_BLOCK_CLASS", function() {
        return U
    }), n.d(t, "INSTALL_VKADMIN_LINK", function() {
        return F
    }), n.d(t, "CLEAR_RECENT_CLASS", function() {
        return H
    }), n.d(t, "TOGGLE_MR_TAB", function() {
        return W
    }), n.d(t, "MESSAGE_SEARCH_CLASS", function() {
        return K
    }), n.d(t, "PINNED_CONTAINER_CLASS", function() {
        return q
    }), n.d(t, "getClassicChatHeight", function() {
        return Ge
    }), n.d(t, "setClassicChatHeight", function() {
        return Ve
    }), n.d(t, "fixTableCellChildHeight", function() {
        return Ye
    }), n.d(t, "applyInnerHtml", function() {
        return Qe
    }), n.d(t, "compensateHistoryHeightChange", function() {
        return $e
    }), n.d(t, "renderSticker", function() {
        return Xe
    }), n.d(t, "isAlreadyDeleted", function() {
        return Je
    }), n.d(t, "replaceMessageAttrs", function() {
        return Ze
    }), n.d(t, "isVoiceMessageAvailable", function() {
        return et
    }), n.d(t, "getAvailableMicrophones", function() {
        return tt
    }), n.d(t, "renderAttach", function() {
        return nt
    }), n.d(t, "dayFromVal", function() {
        return rt
    }), n.d(t, "showInvisibleBar", function() {
        return ot
    }), n.d(t, "updateMessageInCache", function() {
        return it
    }), n.d(t, "editAndReplaceMessage", function() {
        return at
    }), n.d(t, "renderMessage", function() {
        return st
    }), n.d(t, "renderMessageMedia", function() {
        return ct
    }), n.d(t, "ensureDomHasActions", function() {
        return ut
    }), n.d(t, "renderCallMessage", function() {
        return lt
    }), n.d(t, "appendToHistory", function() {
        return dt
    }), n.d(t, "restoreQueue", function() {
        return ft
    }), n.d(t, "markMessagesAsRead", function() {
        return pt
    }), n.d(t, "replaceAttaches", function() {
        return _t
    }), n.d(t, "isDuplicate", function() {
        return mt
    }), n.d(t, "isContactPeer", function() {
        return gt
    }), n.d(t, "isPeerActive", function() {
        return ht
    }), n.d(t, "isFvkcomgroup", function() {
        return bt
    }), n.d(t, "isTabLoaded", function() {
        return vt
    }), n.d(t, "isTabLoadedWithMessage", function() {
        return yt
    }), n.d(t, "parseMessage", function() {
        return Ct
    }), n.d(t, "convertPeerToUrl", function() {
        return jt
    }), n.d(t, "unUrlPeer", function() {
        return kt
    }), n.d(t, "simplifyCounter", function() {
        return Tt
    }), n.d(t, "chatActions", function() {
        return St
    }), n.d(t, "renderPhotos", function() {
        return xt
    }), n.d(t, "renderPhotosFromTab", function() {
        return It
    }), n.d(t, "renderBtnSearchOnlyMessages", function() {
        return Dt
    }), n.d(t, "renderMessagesSep", function() {
        return At
    }), n.d(t, "renderConversationsSep", function() {
        return Lt
    }), n.d(t, "renderPopularSuggSep", function() {
        return Rt
    }), n.d(t, "renderClearRecent", function() {
        return Bt
    }), n.d(t, "renderPopularSuggestions", function() {
        return Nt
    }), n.d(t, "setMessageError", function() {
        return Ut
    }), n.d(t, "startResendMessage", function() {
        return Ft
    }), n.d(t, "removeMessages", function() {
        return Ht
    }), n.d(t, "removeStartingFromMessage", function() {
        return Kt
    }), n.d(t, "removeMessagesWithRestore", function() {
        return qt
    }), n.d(t, "restoreMessage", function() {
        return zt
    }), n.d(t, "formatTyper", function() {
        return Gt
    }), n.d(t, "loadSummaryActivityType", function() {
        return Vt
    }), n.d(t, "renderEmptySearch", function() {
        return Qt
    }), n.d(t, "serviceLink", function() {
        return $t
    }), n.d(t, "renderServiceMsg", function() {
        return Xt
    }), n.d(t, "addChatPhotoToUpdate", function() {
        return Jt
    }), n.d(t, "replaceSpecialSymbols", function() {
        return Zt
    }), n.d(t, "isSelfMessage", function() {
        return en
    }), n.d(t, "showVerifiedTooltip", function() {
        return tn
    }), n.d(t, "wrapLoading", function() {
        return nn
    }), n.d(t, "tabFromIds", function() {
        return rn
    }), n.d(t, "checkSelectClick", function() {
        return on
    }), n.d(t, "renderGoTo", function() {
        return an
    }), n.d(t, "showFlushChat", function() {
        return sn
    }), n.d(t, "showLeaveDialog", function() {
        return cn
    }), n.d(t, "showUnpinDialog", function() {
        return un
    }), n.d(t, "showMsgDeleteDialog", function() {
        return ln
    }), n.d(t, "cleanHistory", function() {
        return dn
    }), n.d(t, "inviteUser", function() {
        return fn
    }), n.d(t, "toggleMessageRequestsTab", function() {
        return pn
    }), n.d(t, "showUnreadOnly", function() {
        return _n
    }), n.d(t, "changeTab", function() {
        return mn
    }), n.d(t, "isImportant", function() {
        return gn
    }), n.d(t, "isUnrespond", function() {
        return hn
    }), n.d(t, "isPeerBlocked", function() {
        return bn
    }), n.d(t, "isPendingForward", function() {
        return vn
    }), n.d(t, "isPeerBlockedByMe", function() {
        return yn
    }), n.d(t, "blockLatencyCompensation", function() {
        return On
    }), n.d(t, "showSpamLayer", function() {
        return wn
    }), n.d(t, "getLastSeenTextInHeader", function() {
        return En
    }), n.d(t, "getLastSeenText", function() {
        return Cn
    }), n.d(t, "showBlacklistBoxUser", function() {
        return kn
    }), n.d(t, "showBlacklistBox", function() {
        return Tn
    }), n.d(t, "getBaseLink", function() {
        return Sn
    }), n.d(t, "showFavvedBox", function() {
        return Mn
    }), n.d(t, "isEditableFocused", function() {
        return Pn
    }), n.d(t, "updateStar", function() {
        return xn
    }), n.d(t, "removewNewUnreadBarAndMerge", function() {
        return In
    }), n.d(t, "isMessagesVisible", function() {
        return Dn
    }), n.d(t, "hideTopNotice", function() {
        return An
    }), n.d(t, "hideAsideNotice", function() {
        return Ln
    }), n.d(t, "hideAsidePromoBlock", function() {
        return Rn
    }), n.d(t, "installVKAdminApp", function() {
        return Bn
    }), n.d(t, "renderShortText", function() {
        return Nn
    }), n.d(t, "attachToText", function() {
        return Un
    }), n.d(t, "lockButton", function() {
        return Fn
    }), n.d(t, "unlockButton", function() {
        return Hn
    }), n.d(t, "renderPinnedMessage", function() {
        return Wn
    }), n.d(t, "renderPinnedMedia", function() {
        return Kn
    }), n.d(t, "showMessageInfoTooltip", function() {
        return qn
    }), n.d(t, "showEditTimeTooltip", function() {
        return zn
    }), n.d(t, "getPinnedMessageHeight", function() {
        return Gn
    }), n.d(t, "boxHandleMessagesLabelsTooltips", function() {
        return Vn
    }), n.d(t, "showPinnedBox", function() {
        return Yn
    }), n.d(t, "showRepliedBox", function() {
        return Qn
    }), n.d(t, "isUserAliveInChat", function() {
        return $n
    }), n.d(t, "getAliveMembersCount", function() {
        return Xn
    }), n.d(t, "normalizeTab", function() {
        return Jn
    }), n.d(t, "normalizeTabsGotFromServer", function() {
        return Zn
    }), n.d(t, "splitMessageToParts", function() {
        return er
    }), n.d(t, "isMessageTooLong", function() {
        return tr
    }), n.d(t, "showInvitationBox", function() {
        return nr
    }), n.d(t, "showWaitUntilUploadedBox", function() {
        return rr
    }), n.d(t, "canMessageBeDeletedForAll", function() {
        return or
    }), n.d(t, "getTopChatMembers", function() {
        return ir
    }), n.d(t, "getChatMembersByIds", function() {
        return ar
    }), n.d(t, "getChatMembers", function() {
        return sr
    }), n.d(t, "formatTimespan", function() {
        return cr
    }), n.d(t, "focusOnMessage", function() {
        return ur
    }), n.d(t, "getNowEditingMessage", function() {
        return lr
    });
    var r = n(112),
        o = n(192),
        i = n(80),
        a = n(406);
    n.d(t, "getFirstUnread", function() {
        return a.getFirstUnread
    }), n.d(t, "isSearchShown", function() {
        return a.isSearchShown
    }), n.d(t, "getPeer", function() {
        return a.getPeer
    }), n.d(t, "getCurrentKeyboard", function() {
        return a.getCurrentKeyboard
    }), n.d(t, "getKeyboard", function() {
        return a.getKeyboard
    }), n.d(t, "getTab", function() {
        return a.getTab
    }), n.d(t, "getCurrentTab", function() {
        return a.getCurrentTab
    }), n.d(t, "getSelectedMessages", function() {
        return a.getSelectedMessages
    }), n.d(t, "getMessageRangeFromSelection", function() {
        return a.getMessageRangeFromSelection
    }), n.d(t, "countUnread", function() {
        return a.countUnread
    }), n.d(t, "getMessageByRid", function() {
        return a.getMessageByRid
    }), n.d(t, "isRidExist", function() {
        return a.isRidExist
    }), n.d(t, "getLocalId", function() {
        return a.getLocalId
    }), n.d(t, "getLastMessage", function() {
        return a.getLastMessage
    }), n.d(t, "parserMessage", function() {
        return a.parserMessage
    }), n.d(t, "getAuthorFullName", function() {
        return a.getAuthorFullName
    }), n.d(t, "getMessage", function() {
        return a.getMessage
    }), n.d(t, "getPreviousMessage", function() {
        return a.getPreviousMessage
    }), n.d(t, "isClassicInterface", function() {
        return a.isClassicInterface
    }), n.d(t, "isLocksAvailable", function() {
        return a.isLocksAvailable
    }), n.d(t, "isFoldersAvailable", function() {
        return a.isFoldersAvailable
    }), n.d(t, "isCommunityInterface", function() {
        return a.isCommunityInterface
    }), n.d(t, "isChannel", function() {
        return a.isChannel
    }), n.d(t, "getBareTab", function() {
        return a.getBareTab
    }), n.d(t, "isReversedDialogs", function() {
        return a.isReversedDialogs
    }), n.d(t, "isFullyLoadedTab", function() {
        return a.isFullyLoadedTab
    }), n.d(t, "makeTabNotFullyLoaded", function() {
        return a.makeTabNotFullyLoaded
    }), n.d(t, "isGoToEndVisible", function() {
        return a.isGoToEndVisible
    }), n.d(t, "getUnreadScrollBottom", function() {
        return a.getUnreadScrollBottom
    }), n.d(t, "isSendingAvailable", function() {
        return a.isSendingAvailable
    }), n.d(t, "isCommunityPeer", function() {
        return a.isCommunityPeer
    }), n.d(t, "isCommunityBlocked", function() {
        return a.isCommunityBlocked
    }), n.d(t, "checkVoiceMessageAvailable", function() {
        return a.checkVoiceMessageAvailable
    }), n.d(t, "isSearching", function() {
        return a.isSearching
    }), n.d(t, "getSearchText", function() {
        return a.getSearchText
    }), n.d(t, "isSearchingValue", function() {
        return a.isSearchingValue
    }), n.d(t, "isRecentSearchesActive", function() {
        return a.isRecentSearchesActive
    }), n.d(t, "getPinnedMessage", function() {
        return a.getPinnedMessage
    }), n.d(t, "doPopularSuggExist", function() {
        return a.doPopularSuggExist
    }), n.d(t, "isAnyMessageBeingEdited", function() {
        return a.isAnyMessageBeingEdited
    }), n.d(t, "getGroupId", function() {
        return a.getGroupId
    }), n.d(t, "getTabDraft", function() {
        return a.getTabDraft
    }), n.d(t, "getTemplates", function() {
        return a.getTemplates
    }), n.d(t, "tabIsMessageRequest", function() {
        return a.tabIsMessageRequest
    }), n.d(t, "tabIsOutgoingMessageRequest", function() {
        return a.tabIsOutgoingMessageRequest
    });
    var s = n(427),
        c = n(446),
        u = n(124);
    n.d(t, "isChatPeer", function() {
        return u.isChatPeer
    }), n.d(t, "isUserPeer", function() {
        return u.isUserPeer
    }), n.d(t, "isReservedPeer", function() {
        return u.isReservedPeer
    });
    var l = n(327),
        d = n(187),
        f = n(66),
        p = n(281),
        _ = n(464),
        m = n(252),
        g = n(219),
        h = n(309),
        b = n(269),
        v = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        y = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };

    function O(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    var w = "_im_mess_sending",
        E = "_im_mess_failed",
        C = "_im_mess_original",
        j = "_im_mess_restore",
        k = "_im_typing",
        T = "chat_create",
        S = "chat_title_update",
        M = "chat_invite_user",
        P = "chat_kick_user",
        x = "chat_photo_update",
        I = "chat_photo_remove",
        D = "chat_pin_message",
        A = "chat_unpin_message",
        L = "chat_invite_user_by_link",
        R = "_im_deselect_all",
        B = "_im_top_notice_hide",
        N = "_im_aside_notice_hide",
        U = "_im_aside_promo_block_hide",
        F = "_im_vkadmin_promo_link",
        H = "_im_clear_recent",
        W = "_im_toggle_mr_tab",
        K = "_im_mess_search",
        q = "_im_pinned",
        z = window,
        G = z.vk,
        V = z.ls,
        Y = z.se,
        Q = z.re,
        $ = z.rs,
        X = z.sech,
        J = z.inArray,
        Z = z.intval,
        ee = z.trim,
        te = z.stripHTML,
        ne = z.domFC,
        re = z.domPS,
        oe = z.domLC,
        ie = z.domChildren,
        ae = z.domClosestSibling,
        se = z.domData,
        ce = z.geByClass,
        ue = z.geByClass1,
        le = z.gpeByClass,
        de = z.addClass,
        fe = z.removeClass,
        pe = z.toggleClass,
        _e = z.hasClass,
        me = z.attr,
        ge = z.setStyle,
        he = z.val,
        be = z.getTemplate,
        ve = z.getLang,
        ye = z.langSex,
        Oe = z.langDate,
        we = z.langNumeric,
        Ee = z.getDateText,
        Ce = z.getSmDate,
        je = z.getShortDate,
        ke = z.isSameDate,
        Te = z.isToday,
        Se = z.ajax,
        Me = z.showBox,
        Pe = z.showFastBox,
        xe = z.showTabbedBox,
        Ie = z.showTooltip,
        De = z.mobPlatforms,
        Ae = z.onlinePlatformClass,
        Le = z.AudioMessagePlayer,
        Re = z.Emoji,
        Be = z.slideUp,
        Ne = z.fadeOut,
        Ue = z.cancelEvent,
        Fe = z.fifaReplaceText,
        He = 4096,
        We = 100,
        Ke = 8,
        qe = 52,
        ze = "chatPosition";

    function Ge() {
        return V.get(ze) || 0
    }

    function Ve(e) {
        e >= window.clientHeight() - 30 && (e = 0), V.set(ze, e)
    }

    function Ye(e, t) {
        var n = ue(e, t);
        n.firstElementChild.offsetHeight !== n.parentNode.offsetHeight && ge(n.firstElementChild, {
            height: n.parentNode.offsetHeight
        })
    }

    function Qe(e, t) {
        e && e.innerHTML !== t && (e.innerHTML = t)
    }

    function $e(e, t, n, r) {
        var o = t && !n ? 1 : !t && n ? -1 : 0;
        o && !Object(a.isClassicInterface)(e) && r().compensateHistoryHeightChange(o)
    }

    function Xe(e, t, n, r) {
        var o = window.devicePixelRatio >= 2 ? "256" : "128",
            i = "animation" === n,
            a = "im_gift";
        i && (a += " sticker_img");
        var s = '<img height="128" class="' + a + '" src="' + Stickers.getStickerUrl(Z(e), o) + '"/>';
        if (i) {
            var c = "animatedSticker" + r;
            s = '<div id="' + c + '" data-loop-count=3 data-animation-path="' + ("/stickers.php?act=proxy_animation&product_id=" + t + "&sticker_id=" + e) + '" onmouseenter="StickersAnimation.loadAndPlaySticker(this);"\n     data-uniq-id="' + r + '" data-sticker-id="' + Z(e) + '" class="sticker_animation sticker_animation_128 im_gift">' + s + "</div>";
            var u = !1;
            browser.msie ? (0 ^ r) === r && (u = !0) : u = Number.isInteger(r), u && window.StickersSettings.getAutoplay() && window.StickersAnimation && window.StickersAnimation.loadAndPlayStickerWithTimer(c, 10)
        }
        return t && (s = '<a onmouseover="return Emoji.stickerOver(' + Z(e) + ', this);"\n        onclick="return Emoji.clickSticker(' + Z(t) + ', this, event);">' + s + "</a>"), s = '<div class="im_sticker_row">' + s + "</div>"
    }

    function Je(e, t, n) {
        var r = e.get ? e.get() : e;
        if (vt(r, t)) {
            var o = r.tabs[t].deleted || [];
            return J(n, o)
        }
        return !1
    }

    function Ze(e, t, n) {
        var r = n.randomId,
            o = ue("_im_mess_rid" + r, t);
        return o && (t = dt(e, n, t = Wt([o], t), !0, !1)), t
    }

    function et(e) {
        var t = Object(a.checkVoiceMessageAvailable)(e);
        return browser.mobile && browser.safari ? Promise.resolve(!1) : void 0 !== t ? Promise.resolve(t) : tt().then(function(e) {
            return e.length > 0
        }).catch(function(e) {
            return !1
        })
    }

    function tt() {
        return window.AudioContext && navigator.mediaDevices ? navigator.mediaDevices.enumerateDevices().then(function(e) {
            for (var t = [], n = 0; n < e.length; n++) "audioinput" == e[n].kind && t.push(e[n]);
            return t
        }) : Promise.reject(new Error("NotSupported"))
    }

    function nt(e) {
        return be("im_preloader", {
            preloader: $(G.pr_tpl, {
                id: ""
            }),
            cls: "im-preloader_attach im-preloader_visible im-preloader_" + e
        })
    }

    function rt(e) {
        var t = e.split(".");
        return (t[0] < 10 ? "0" : "") + t[0] + (t[1] < 10 ? "0" : "") + t[1] + t[2]
    }

    function ot(e) {
        var t = ue("_im_invisible_bar", e);
        t && (fe(t, "_im_invisible_bar"), fe(t, "im-page--history-new-bar_hide"))
    }

    function it(e, t, n) {
        var r = se(n, "msgid"),
            o = ue("_im_mess_" + r, t),
            i = n.cloneNode(!0);
        return o && (o.parentNode.replaceChild(i, o), ut(t)), t
    }

    function at(e, t, n) {
        var r = st(e, t),
            o = ue("_im_mess_" + t.messageId, n);
        return o && (o.parentNode.replaceChild(Y(r), o), ut(n)), n
    }

    function st(e, t) {
        var n = ["_im_mess"],
            r = Object(s.isUnread)(e.tabs[t.peerId], t),
            o = Object(s.hasReply)(t) ? be("im_message_media", {
                type: "reply",
                messageId: t.messageId,
                attaches: nt("reply"),
                text: ""
            }) : "";
        Object(s.isOut)(t) && r && n.push("im-mess_unread _im_mess_unread"), Object(s.isOut)(t) && n.push("im-mess_out"), Object(s.wasEdited)(t) && n.push("im-mess_was_edited"), Object(_.canMessageBeEdited)(e, t) && n.push("im-mess_editable"), Object(s.isImportant)(t) && n.push("im-mess_fav"), -1 != (e.selectedMessages || []).indexOf(t.messageId) && n.push("im-mess_selected");
        var i = Date.now() - 1e3 * t.date > 1e3;
        t.local && i && n.push("im-mess_sending"), t.local && n.push("" + w), t.local && Object(s.wasEdited)(t) && !r && n.push("im-mess_unread im-mess_nobg"), t.failed && n.push("im-mess_failed " + E), Object(s.isGift)(t) && n.push("im-mess_gift");
        var l = ct(t),
            f = function(e, t) {
                var n = "",
                    r = Object(d.unpackStore)(e).sourceEnabled && t.kludges && t.kludges.from_widget && t.kludges.ref_source;
                Object(s.wasEdited)(t) && (n += be("sImLblWasEdited", {
                    update_time: t.update_time
                }));
                if (Object(a.isCommunityInterface)(e) && r) {
                    var o = t.kludges.ref_source,
                        i = {};
                    try {
                        (i = JSON.parse(Object(b.unclean)(o))).link && i.info && (i.link = Object(c.replaceHyperLinks)(Object(b.clean)(i.link), c.linksReplacer.bind(null, !1)), i = Object(b.clean)(langStr(ve("mail_source_info"), "link", i.link, "info", Object(b.clean)(i.info))), n += be("sImLblWasSourceInfo", {
                            source: i
                        }))
                    } catch (e) {}
                }
                return n
            }(e, t),
            p = o + Ct(e, t.text, t.kludges, !1, t.peerId);
        "" != p && (p += f), t.subject && "..." !== t.subject.trim() && !Object(u.isChatPeer)(t.peerId) && (p = be("im_topic", {
            topic: t.subject
        }) + p);
        var m = be("im_message_media", {
            type: "media",
            messageId: t.messageId,
            attaches: l.join(""),
            text: Object(s.isGift)(t) ? '<div class="im-mess--gift-lbl">' + p + "</div>" : ""
        });
        return Object(s.isGift)(t) || (m = p + m), "" == p && (m += f), be("im_msg_row", {
            msg_id: t.messageId,
            from_id: t.peerId,
            aria_hidden: t.local && !t.failed ? "true" : "false",
            ts: t.date,
            marker_params: t.failed ? 'aria-label="' + ve("mail_send_message_error") + '" role="link"' : "",
            unread_params: r ? 'aria-label="' + ve("mail_unread_message") + '"' : "",
            cls: n.join(" ")
        }).replace("%text%", function() {
            return m
        })
    }

    function ct(e) {
        return e.attaches.reduce(function(t, n) {
            return !Object(s.hasReply)(e) || "mail" !== n.type && "reply" !== n.type ? ("sticker" === n.type ? e.messageId ? t.push(Xe(n.id, n.productId, n.kind, e.messageId)) : t.push(Xe(n.id, n.productId)) : t.push(nt(n.type)), t) : t
        }, [])
    }

    function ut(e) {
        for (var t = e.getElementsByClassName("_im_mess_noa"), n = t.length; n--;) _e(t[n], "im-mess_fwd") || t[n].insertAdjacentHTML("afterbegin", be("sImHistoryRowActions")), fe(t[n], "_im_mess_noa")
    }

    function lt(e, t, n) {
        var r, o, i, a, s, c = G.id,
            u = e.attaches[0],
            l = u.initiatorId,
            d = u.state,
            p = u.receiverId,
            _ = void 0;
        switch (d) {
            case "reached":
                _ = ve(c === l ? "mail_call_outgoing" : "mail_call_incoming");
                var m = t ? "" : (r = u.duration, o = Math.floor(r / 3600), i = Math.floor(r / 60) - 60 * o, a = !1, s = !1, [o, i, r - 3600 * o - 60 * i].reduce(function(e, t) {
                    return 0 !== t || s ? (a && (t = t < 10 ? "0" + t : t), a = !0, s = !0, e + ("" !== e ? ":" : "") + t) : (s = !0, e)
                }, ""));
                _ = _.replace("{duration}", m);
                break;
            case "canceled_by_initiator":
                _ = ve(c === l ? "mail_call_canceled" : "mail_call_missed");
                break;
            case "canceled_by_receiver":
                if (c === l) {
                    if (t) return ve("mail_call_declined");
                    var g = Object(f.oCacheGet)(n, p);
                    return g ? ye(g.sex, ve("mail_call_declined_by", "raw")).replace("{user_name}", g.first_name) : ve("mail_call_declined")
                }
                return ve("mail_call_canceled");
            default:
                _ = ve("mail_added_call")
        }
        return be("im_calls_link", {
            text: _
        })
    }

    function dt(e, t, n) {
        !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3];
        var r = !(arguments.length > 4 && void 0 !== arguments[4]) || arguments[4],
            o = !(arguments.length > 5 && void 0 !== arguments[5]) || arguments[5],
            i = Date.now() - 1e3 * t.date > 1e3,
            c = e.tabs[t.peerId];
        if (!n || ue("_im_mess", n) || ue("_im_bar_date", n) || (n.innerHTML = ""), c.skipped > 0) return n;
        var l = [];
        t.local || (l = e.imQueue(t.peerId, r)), l.length > 0 && Wt(l.map(function(e) {
            return ue("_im_mess_rid" + e.rid, n)
        }, n).filter(function(e) {
            return e
        }));
        var p = st(e, t),
            _ = oe(n);
        _e(_, "_im_mess_stack") || (_ = ae(_, "._im_mess_stack", -1));
        for (var m = Object(a.getLastMessage)(e, t.peerId, t.messageId); t.peerId === e.peer && m && !ue("_im_mess_" + m.messageId);) m = Object(a.getLastMessage)(e, t.peerId, m.messageId);
        var g = ue("_im_unread_bar_row", n),
            h = Object(s.getUserId)(t),
            b = m ? Ot(m.date, e) : 0;
        if (!m || wt(c, m, t, e, o)) {
            var v = "",
                y = !1;
            if (g && Object(s.isOut)(t) && In(e, n, t.peerId), 1 === c.unread && !Object(s.isOut)(t) && o && (v += be("im_mess_bar", {}), y = !0, In(e, n, t.peerId)), !Te(new Date(b))) {
                var O = new Date,
                    E = y ? "im-page--history-new-bar_hide _im_invisible_bar" : "";
                v += be("im_day_bar", {
                    day: je(t.date, e.timeshift, !0, ve("months_of", "raw"), !0),
                    date: t.date,
                    day_class: O.getDate() + O.getMonth() + O.getFullYear() + " " + E
                })
            }
            if (Object(s.isServiceMsg)(t)) v += be("im_service_row", {
                text: Xt(e, t, c),
                type: "",
                date: t.date,
                from_id: "",
                message_id: t.messageId
            });
            else if (Object(s.isCallMessage)(t)) v += be("im_service_row", {
                text: $t("", lt(t, !1, e), ""),
                type: "",
                date: t.date,
                from_id: "",
                message_id: t.messageId
            });
            else {
                var C = e.gid && Object(s.isOut)(t) ? Z(t.kludges.from_admin) || -e.gid : 0,
                    j = Object(f.oCacheGet)(e, C ? -e.gid : h) || c,
                    k = Object(u.isChatPeer)(t.peerId) ? j.name : j.first_name,
                    T = j.link || c.href,
                    S = be("im_mess_stack_name", {
                        name: k,
                        link: T,
                        class: Object(s.isMoney)(t) ? " im-mess-stack--lnk-money-transfer" : ""
                    });
                if (Object(s.isGift)(t)) {
                    var M = ve("mail_gift_message_sent", "raw");
                    S += ' <span class="im-mess-stack--gift">' + ye(j.sex || 0, M) + "</span>"
                }
                if (Object(s.isMoney)(t)) {
                    var P = Object(s.isMoneyRequest)(t) ? ve("mail_money_request_message_sent", "raw") : ve("mail_money_tranfer_message_sent", "raw");
                    S += ' <span class="im-mess-stack--money-transfer">' + ye(j.sex || 0, P) + "</span>"
                }
                var x = e.gid ? "/gim" + e.gid : "/im",
                    I = void 0;
                if (I = t.local ? Et(t.date, e.timeshift) : be("im_stack_date", {
                        date: Et(t.date, e.timeshift),
                        link: x + "?sel=" + t.peerId + "&msgid=" + t.messageId
                    }), C && e.admins[C]) {
                    var D = e.admins[C],
                        A = C === G.id ? ve("mail_by_you") : D[0];
                    I = I + " " + be("im_admin_link", {
                        name: A,
                        href: D[1]
                    })
                }
                v += be("im_mess_stack", {
                    photo: j.photo,
                    href: T,
                    cls: "",
                    date_attr: "",
                    link: "/im?sel=" + t.peerId + "&msgid=" + t.messageId,
                    name: te(S),
                    stack_name: S,
                    peerId: h,
                    date: I,
                    messages: p,
                    admin: t.kludges.from_admin || 0
                })
            }
            Object(d.toArray)(X(v)).forEach(function(e) {
                return n && n.appendChild(e)
            })
        } else g && e.peer === t.peerId && !c.inplaceSearch && Object(s.isOut)(t) && In(e, n, t.peerId), ue("_im_stack_messages", _).appendChild(Y(p));
        return Object(s.isOut)(t) && !i && setTimeout(function() {
            var e = ue("_im_mess_" + t.messageId, n);
            _e(e, w) && de(e, "im-mess_sending")
        }, 500), l = l.filter(function(e) {
            return e.rid !== t.randomId
        }), ut(n), ft(l, e, n)
    }

    function ft(e, t, n) {
        var r = void 0;
        return (r = "object" === (void 0 === e ? "undefined" : y(e)) ? e : t.imQueue(e, !1)).length > 0 && r.map(function(e) {
            return e.mess.failed = !!e.failed, e.mess
        }).filter(function(e) {
            return Object(a.getMessage)(t, e.peerId, e.messageId)
        }).forEach(function(e) {
            return dt(t, e, n, !1)
        }), n
    }

    function pt(e, t, n) {
        var r = e.tabs[t];
        return Object(d.toArray)(ce("_im_mess_unread", n)).forEach(function(e) {
            var t, n = Z(se(e, "msgid"));
            n > 0 && r.out_up_to >= n && (fe(e, "_im_mess_unread"), fe(e, "im-mess_unread"), (t = ue("_im_mess_blind_unread_marker", e)) && (t.removeAttribute("aria-label"), t.removeAttribute("role"), t.removeAttribute("tabindex")))
        }), n
    }

    function _t(e, t, n) {
        var r = t.peerId,
            o = t.messageId,
            i = ue("_im_msg_reply" + o, e),
            a = ue("_im_msg_media" + o, e),
            s = n.tabs[r].mediacontent[o][0];
        return i && (i.innerHTML = s[0]), a && (a.innerHTML = s[1]), e
    }

    function mt(e, t) {
        if (!Object(a.isFullyLoadedTab)(t, e.peerId)) return 0;
        var n = t.tabs[e.peerId];
        return n.msgs[e.messageId] ? 1 : n.msgs["rid" + e.randomId] ? 2 : 0
    }

    function gt(e) {
        return e > 19e8 && e < 2e9
    }

    function ht(e, t) {
        return e === t.peer
    }

    function bt(e, t) {
        return Object(h.doesChatTabHaveFlag)(Object(a.getTab)(e, t), 1024)
    }

    function vt(e, t) {
        return !!e.tabs[t]
    }

    function yt(e, t) {
        return !!vt(e, t) && null !== e.tabs[t].lastmsg
    }

    function Ot(e, t) {
        return 1e3 * e + 1e3 * t.timeshift
    }

    function wt(e, t, n, r, o) {
        if (Object(s.getUserId)(t) !== Object(s.getUserId)(n)) return !0;
        var i = Ot(t.date, r),
            c = Ot(n.date, r);
        return !ke(i, c) || (!(!Object(a.isCommunityInterface)(r) || Z(t.kludges.from_admin) === Z(n.kludges.from_admin)) || (n.date - t.date > 300 || (!(!Object(s.isServiceMsg)(t) && !Object(s.isServiceMsg)(n)) || (!(!Object(s.isCallMessage)(n) && !Object(s.isCallMessage)(t)) || (!(!Object(s.isGift)(t) && !Object(s.isGift)(n)) || (!(!Object(s.isGraffiti)(t) && !Object(s.isGraffiti)(n)) || (!!Object(s.hasReply)(n) || !(Object(s.isUnread)(e, t) === Object(s.isUnread)(e, n) || !o || Object(s.isOut)(n) || en(n.peerId, r.gid)))))))))
    }

    function Et(e, t) {
        return Oe(1e3 * e, "{hour}:{minute} {am_pm}", 1e3 * t, [], !0)
    }

    function Ct(e, t, n) {
        var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
            o = arguments.length > 4 && void 0 !== arguments[4] && arguments[4],
            i = Math.round(1e9 * Math.random()).toString(16),
            s = {},
            u = 0;
        return t = (t = Object(c.replaceHyperLinks)(t || "", c.linksReplacer.bind(null, r))).replace(/(<a.+?<\/a>)/gi, function(e) {
            var t = "!link_" + u + "_" + i + "!";
            return s[t] = e, u++, t
        }), t = Object(c.replaceMentions)(t), t = Object(c.replaceEmailLinks)(t), t = Object(c.replaceHashtags)(t, function(t) {
            var n = Object(a.getGroupId)(e);
            return '<a href="/' + (n ? "gim" + n : "im") + "?sel=" + (o || Object(a.getPeer)(e)) + "&st=" + encodeURIComponent(t) + '">' + t + "</a>"
        }), Object.keys(s).forEach(function(e) {
            t = t.replace(e, function() {
                return s[e]
            })
        }), n.emoji && (t = Re.emojiToHTML(t, !0)), Fe && (t = Fe(t)), t
    }

    function jt(e) {
        return Object(u.isChatPeer)(e) ? "c" + (e - 2e9) : e < -2e9 ? "e" + Math.abs(e + 2e9) : gt(e) ? "mr" + (e - 19e8) : e
    }

    function kt(e) {
        switch (e.substr(0, 1)) {
            case "e":
                return -2e9 - Z(e.substr(1));
            case "c":
                return 2e9 + Z(e.substr(1));
            default:
                return Z(e)
        }
    }

    function Tt(e) {
        return e > 9999999 ? Math.floor(e / 1e6) + "M" : e > 9999 ? Math.floor(e / 1e3) + "K" : e > 0 ? e.toString() : ""
    }

    function St(e, t) {
        return {
            search: {
                name: ve("mail_im_peer_search"),
                icon: "search"
            },
            block_community: {
                icon: "block",
                name: ve("mail_block_comm_messages")
            },
            allow_community: {
                icon: "unblock",
                name: ve("mail_allow_comm_messages")
            },
            clear: {
                name: e.peer < -2e9 ? ve("mail_im_delete_email_contact") : ve("mail_im_delete_all_history"),
                icon: "clear"
            },
            chat: {
                name: ve("mail_im_create_chat_with"),
                icon: "invite"
            },
            mute: {
                name: ve("mail_im_mute"),
                icon: "mute"
            },
            unmute: {
                name: ve("mail_im_unmute"),
                icon: "unmute"
            },
            photos: {
                name: e.gid ? ve("mail_im_show_media_history_group") : ve("mail_im_show_media_history"),
                icon: "media"
            },
            avatar: {
                icon: "avatar",
                name: ve("mail_update_photo_red")
            },
            block: {
                icon: "block",
                name: ve("mail_block_user")
            },
            invite: {
                icon: "invite",
                name: ve("mail_im_create_chat_with")
            },
            invite_link: {
                icon: "invite-link",
                name: ve(t ? "mail_vkcomgroup_invite_link" : "mail_chat_invite_link")
            },
            leave: {
                icon: "leave",
                name: ve(t ? "mail_leave_channel" : "mail_leave_chat")
            },
            topic: {
                icon: "topic",
                name: ve("mail_change_topic")
            },
            return: {
                icon: "return",
                name: ve(t ? "mail_return_to_vkcomgroup" : "mail_return_to_chat")
            },
            pin_hide: {
                icon: "pin_hide",
                name: ve("mail_menu_pin_hide")
            },
            pin_unhide: {
                icon: "pin_unhide",
                name: ve("mail_menu_pin_show")
            },
            unpin: {
                icon: "unpin",
                name: ve("mail_menu_unpin")
            },
            settings: {
                icon: "settings",
                name: ve(t ? "mail_vkcomgroup_settings" : "mail_settings")
            }
        }
    }

    function Mt(e, t) {
        var n = '<img src="' + e + '" alt="" class="dialogs_inline_chatter dialogs_inline_chatter_half"/>';
        return t && (n = be("im_dialogs_link", {
            href: t,
            photo: n
        })), '<div class="im_grid">\n    <div class="dialogs_inline_chatter dialogs_inline_chatter_half">\n      ' + n + "\n    </div>\n  </div>"
    }

    function Pt(e, t) {
        var n = '<img src="' + e + '" alt="" class="dialogs_inline_chatter"/>';
        return t && (n = be("im_dialogs_link", {
            href: t,
            photo: n
        })), '<div class="im_grid">\n    <div class="dialogs_inline_chatter">\n      ' + n + "\n    </div>\n  </div>"
    }

    function xt(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
        if ("string" == typeof e) return '<div class="im_grid"><img src="' + e + '" alt=""/></div>';
        switch (e.length) {
            case 1:
                return '<div class="im_grid"><img src="' + e[0] + '" alt=""/></div>';
            case 2:
                return e.map(function(e, n) {
                    return Mt(e, t[n])
                }).join("");
            case 3:
                return Mt(e[0], t[0]) + e.slice(1).map(function(e, n) {
                    return Pt(e, t[n + 1])
                }).join("");
            case 4:
                return e.map(function(e, n) {
                    return Pt(e, t[n])
                }).join("")
        }
    }

    function It(e, t, n) {
        if ("string" == typeof t.photo && t.photo) return '<div class="im_grid"><img src="' + t.photo + '" alt=""></div>';
        if (Object(u.isChatPeer)(t.peerId) && t.membersCount < 2) return '<div class="im_grid"><img src="' + e.get().default_chat_photo + '" alt=""></div>';
        if (Array.isArray(t.photo)) return xt(t.photo);
        var r = t.data.active.slice(0, 4).map(f.oCacheGet.bind(null, e));
        return xt(r.map(function(e) {
            return e.photo
        }), n ? [] : r.map(function(e) {
            return e.link
        }))
    }

    function Dt(e) {
        var t = e.get().gid ? ve("mail_search_only_messages_comm") : ve("mail_search_only_messages");
        return '<li class="im-page--mess-search-w">\n    <div class="im-page--mess-search ' + K + '">\n      <button type="button" class="im-i--messages-search"></button>' + t + "\n    </div>\n  </li>"
    }

    function At() {
        return '<li class="im-search-results-head">' + ve("mail_search_messages") + "</li>"
    }

    function Lt() {
        return '<li class="im-search-results-head">' + ve("mail_search_conversations_sep") + "</li>"
    }

    function Rt() {
        return '<li class="im-search-results-head">' + ve("mail_search_dialogs_sep") + "</li>"
    }

    function Bt() {
        return '<li class="im-search-results-head _im_recent_bar">\n    ' + ve("mail_recent_searches") + '\n    <button type="button" class="' + H + ' im-page--clear-recent">' + ve("mail_clear_recent") + "</button>\n  </li>"
    }

    function Nt(e) {
        var t = e.get().popular_sugg,
            n = Object(a.isClassicInterface)(e) ? 8 : 5;
        return t.length > n && (t = t.slice(0, n)), '<li class="im-popular clear_fix">' + t.map(function(t) {
            var n = t.peerId,
                r = Object(f.oCacheGet)(e, n) || t,
                o = e.get().tabs[n] || t,
                i = (e.get().mutedPeers || []).indexOf(n) >= 0;
            return '<div class="' + ["im-popular--item", "fl_l", "_im_dialog", "_dont_add_recent", "_im_sugg_" + n, o.unread > 0 && "sugg-is_unread", i && "sugg-is_muted"].filter(function(e) {
                return !!e
            }).join(" ") + '" data-peer="' + n + '">\n    <a class="im-popular--avatar-w ' + Ae(o.online) + '" href="' + r.link + '"><img class="im-popular--avatar" src="' + r.photo + '"/></a>\n    <div class="im-popular--name-w"><a class="im-popular--name" href="' + r.link + '">' + (r.first_name || r.name) + '</a></div>\n    <span class="im-popular--unread _sugg_unread_ct">' + Tt(o.unread) + "</span>\n</div>"
        }).join("") + "</li>"
    }

    function Ut(e, t, n) {
        var r = ue("_im_mess_" + t.messageId, n);
        if (r) {
            me(r, "aria-hidden", "false"), de(r, "im-mess_failed " + E);
            var o = ue("_im_mess_marker", r);
            me(o, "aria-label", ve("mail_send_message_error")), me(o, "role", "link")
        }
        return n
    }

    function Ft(e, t, n) {
        var r = ue("_im_mess_" + t, n);
        if (r) {
            fe(r, "im-mess_failed"), me(r, "aria-hidden", "true"), fe(r, E);
            var o = ue("_im_mess_marker", r);
            me(o, "aria-label", ""), me(o, "role", "")
        }
        return n
    }

    function Ht(e, t) {
        return Wt(e.map(function(e) {
            return ue("_im_mess_" + e, t)
        }).filter(function(e) {
            return e
        }), t)
    }

    function Wt(e, t) {
        var n = e.filter(function(e) {
            return !_e(e, "im-mess_srv")
        }).map(function(e) {
            return e.parentNode
        });
        return e.forEach(function(e) {
            _e(e, "im-mess_srv") ? e.parentNode.parentNode.removeChild(e.parentNode) : e.parentNode.removeChild(e)
        }), n.filter(function(e) {
            return 0 === ie(e).length
        }).map(function(e) {
            return le("_im_mess_stack", e)
        }).forEach(function(e) {
            _e(re(e), "_im_bar_date") && Q(re(e)), _e(re(e), "_im_unread_bar_row") && Q(re(e)), Q(e)
        }), t
    }

    function Kt(e) {
        for (var t = e; t;) {
            var n = t;
            if (null === (t = t.previousElementSibling)) {
                _e(n, "mess_srv") && (t = n.parentNode);
                var r = le("_im_mess_stack", n);
                r && (t = r.previousElementSibling, 1 === ie(n.parentNode).length && r.parentNode.removeChild(r))
            }
            _e(n, "_im_unread_bar_row") || n.parentNode.removeChild(n)
        }
    }

    function qt(e, t, n, r) {
        return e.map(function(e) {
            return ue("_im_mess_" + e, r)
        }).filter(function(e) {
            return e
        }).forEach(function(e) {
            he(e, function(e, t, n) {
                var r = t.innerHTML;
                return '<div class="im-mess--text">\n    ' + ve("delete" === n ? "mail_deleted_stop" : "mail_marked_as_spam") + ' <button type="button" data-peer="' + e + '" class="' + j + ' im-mess--btn">' + ve("mail_restore") + '</button>\n    <div class="' + C + ' im-mess--original">' + r + "</div>\n  </div>"
            }(t, e, n)), de(e, "im-mess_light")
        }), r
    }

    function zt(e, t, n) {
        var r = ue("_im_mess_" + e, n);
        if (r) {
            var o = ue(C, r);
            he(r, o.innerHTML), fe(r, "im-mess_light")
        }
        return n
    }

    function Gt() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
            t = arguments[1],
            n = arguments[2],
            r = arguments[3],
            o = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 2;
        if (arguments.length > 5 && void 0 !== arguments[5] && arguments[5]) return Yt(e, t, n, r, !0, o);
        var i = Yt(e, t, n, r, !1, o);
        return i.length > 60 ? Yt(e, t, n, r, !0, o) : i
    }

    function Vt(e) {
        var t, n = (O(t = {}, m.ACTIVITY_TYPE_TYPING, 1), O(t, m.ACTIVITY_TYPE_RECORDING_AUDIO, 2), t),
            r = Object.keys(e).sort(function(e, t) {
                return n[t] - n[e]
            }),
            o = {},
            i = r.reduce(function(t, n) {
                var r = (e[n] || {}).userIds;
                return (void 0 === r ? [] : r).forEach(function(e) {
                    o[e] || (o[e] = !0, t[n] = !0)
                }), t
            }, {}),
            a = r.filter(function(e) {
                return !!i[e]
            });
        return a.length > 1 ? "" : a[0]
    }

    function Yt(e, t, n, r, o, i) {
        var s = function(e, t, n) {
            var r = [],
                o = {};
            return Object.keys(t).map(function(n) {
                ((t[n] || {}).userIds || []).forEach(function(t) {
                    Object(f.oCacheExists)(e, t) ? parseInt(t, 10) !== e.id && (o[t] = n) : r.push(t)
                })
            }), r.length && Object(m.loadChatMember)(O({}, n, r), e), Object.keys(o).sort(function(e, n) {
                return t[o[e]].ts - t[o[n]].ts
            })
        }(r, e, t);
        if (0 === s.length) return "";
        var c = Object(u.isUserPeer)(t) || Object(a.isCommunityPeer)(t) ? "first_name" : o ? "short_name" : "name",
            l = Vt(e),
            d = "";
        l === m.ACTIVITY_TYPE_RECORDING_AUDIO ? d = ve("mail_recording_audio_several", s.length) : l === m.ACTIVITY_TYPE_TYPING && (d = ve("mail_typing_several", s.length));
        var p = s.slice(0, Math.min(s.length - 1, i)),
            _ = p.map(function(e) {
                return Object(f.oCacheGet)(r, e)[c]
            }).join(", ");
        if (s.length > i + 1) {
            var g = function(e) {
                var t = {};
                return Object.keys(e).forEach(function(n) {
                    var r = e[n].userIds;
                    (void 0 === r ? [] : r).forEach(function(e) {
                        t[e] = 1
                    })
                }), Object.keys(t).length
            }(e);
            _ += " " + ve("mail_and_peer").replace("{count}", g - i).replace("{typing}", d)
        } else {
            if (s.length > 1 && (_ += " " + ve("mail_and_peer_one")), !Object(u.isChatPeer)(t) && n) _ += " " + d;
            else _ += " " + Object(f.oCacheGet)(r, s[p.length])[c] + " " + d
        }
        return _.trim()
    }

    function Qt() {
        return '<div class="im-page--chat-search-empty">\n    ' + ve("mail_im_search_empty") + "\n  </div>"
    }

    function $t(e, t, n) {
        var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "";
        return n ? '<a class="im_srv_lnk ' + r + '" target="_blank" href="' + e + '">' + t + "</a>" : '<span class="' + r + '">' + t + "</span>"
    }

    function Xt(e, t, n) {
        var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
            o = t.kludges,
            i = o.source_act,
            a = Z(o.source_mid),
            s = t.userId,
            c = Object(f.oCacheGet)(e, s),
            u = "",
            l = s === a;
        switch (i) {
            case T:
                u = "mail_im_chat_created";
                break;
            case S:
                u = o.source_is_channel ? "mail_im_title_updated_channel" : "mail_im_title_updated_dot";
                break;
            case M:
                u = l ? "mail_im_returned_to_chat" : "mail_im_invited";
                break;
            case P:
                u = l ? "mail_im_left" : "mail_im_kicked_from_chat";
                break;
            case x:
                u = "mail_im_photo_set";
                break;
            case I:
                u = o.source_is_channel ? "mail_im_photo_removed_channel" : "mail_im_photo_removed";
                break;
            case D:
                u = o.source_message ? "mail_im_pin_message" : "mail_im_pin_message_empty2";
                break;
            case A:
                u = o.source_message ? "mail_im_unpin_message" : "mail_im_unpin_message_empty2";
                break;
            case L:
                u = "mail_im_invite_by_link";
                break;
            default:
                return "mail_no_support"
        }
        if (u = (u = ye(c.sex, ve(u, "raw"))).replace("{from}", $t(c.link, c.name, r)), a && a !== s) {
            var d = o.source_email;
            if (d) u = u.replace("{user}", $t("/im?email=" + encodeURIComponent(d), "email", r));
            else {
                var p = Object(f.oCacheGet)(e, a),
                    _ = i === P ? p.inv_name : p.kick_name;
                u = u.replace("{user}", $t(p.link, _, r))
            }
        }
        if (o.source_text) {
            var m = o.source_old_text ? '«<b class="im_srv_lnk">' + o.source_old_text + "</b>» &rarr; " : "";
            u = u.replace("{title}", m + '«<b class="im_srv_lnk">' + o.source_text + "</b>»")
        }
        if (o.source_act === D || o.source_act === A)
            if (o.source_message) {
                var g = $t("", Zt(Re.emojiToHTML(te(o.source_message.replace(/<br\s?\/?>/gi, " ")), !0)), !1, "im_srv_mess_link");
                u = u.replace("{msg}", g)
            } else u = u.replace(/{link}(.+){\/link}/i, function(e, t) {
                return $t("", t, !1, "im_srv_mess_link")
            });
        return u
    }

    function Jt(e, t, n, r) {
        if (t === x) {
            var o = ue("_im_mess_" + e.messageId, r);
            if (o) {
                var i = n.tabs[e.peerId];
                o.parentNode.innerHTML = be("im_msg_row", {
                    msg_id: e.messageId,
                    from_id: e.peerId,
                    text: Xt(n, e, i) + n.chat_photo_msg,
                    ts: e.date,
                    cls: "im-mess_srv"
                })
            }
        }
        return r
    }

    function Zt(e) {
        return e.replace(/&lt;&lt;/g, "&laquo;").replace(/&gt;&gt;/g, "&raquo;").replace(/ \-\-/g, " &mdash;").replace(/\-\- /g, "&mdash; ").replace(o.MENTION_RAW, "$1$4")
    }

    function en(e, t) {
        return !t && e === G.id
    }

    function tn(e, t) {
        return Ie(e, {
            url: Object(a.isCommunityPeer)(t) ? "al_groups.php" : "al_profile.php",
            params: {
                act: "verified_tt",
                mid: t,
                gid: t
            },
            slide: 15,
            ajxdt: 200,
            showdt: 200,
            hidedt: 200,
            dir: "auto",
            shift: [94, 7, 7],
            className: "verified_tt"
        })
    }

    function nn(e) {
        return function(t) {
            var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "bottom",
                r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "",
                o = Y(be("im_preloader", {
                    preloader: $(G.pr_tpl, {
                        id: ""
                    }),
                    cls: ["bottom" === n ? "im-preloader_bottom" : "im-preloader_top", r].join(" ")
                })),
                i = !1;

            function a() {
                i = !0, fe(o, "im-preloader_visible"), o.parentNode && o.parentNode.removeChild(o)
            }
            setTimeout(function() {
                i || ("bottom" === n ? e.appendChild(o) : e.insertBefore(o, ne(e)), de(o, "im-preloader_visible"))
            }, 0), t.then(a).catch(function(e) {
                Object(g.imWeirdCatch)("wrapLoading", e), a()
            })
        }
    }

    function rn(e, t) {
        return {
            0: {
                msgs: e.reduce(function(e, t) {
                    return e[t] = [t, r.FLAG_IMPORTANT, 0, 0, "", {}, {}, 0, 0, 0], e
                }, {}),
                hash: t,
                history: 1
            }
        }
    }

    function on(e, t) {
        if (!t && !e) return !1;
        var n = e.target || e.srcElement,
            r = Ke,
            o = !1,
            i = /_im_mess|im_log_act|im_log_ract|_im_log_body|im_log_rspacer|_im_graffiti_w|_wall_post_cont/;
        do {
            if (!n || n.onclick || n.onmousedown || "A" == n.tagName || _e(n, "_im_no_select") || _e(n, "im_msg_media_link") || "IMG" == n.tagName && !_e(n, "_im_graffiti") && !_e(n, "emoji") && !_e(n, "emoji_css") && !_e(n, "im_gift") || "TEXTAREA" == n.tagName || _e(n, "play_new") || _e(n, "videoplayer") || (o = i.test(n.className))) break
        } while (r-- && (n = n.parentNode));
        return !o || !!ee((window.getSelection && window.getSelection() || document.getSelection && document.getSelection() || "").toString())
    }

    function an(e, t) {
        return '<div class="im-mess--text">\n      <span>' + ve("mail_restored") + '</span>\n      <a class="_im_go_to" href="/im?sel=' + jt(e) + "&msgid=" + t + '">' + ve("mail_im_goto_conversation") + "</a>\n    </div>"
    }

    function sn(e, t, n) {
        var r = ve("mail_deleteall1"),
            o = ve("mail_sure_to_delete_all"),
            i = ve("mail_delete");
        return Object(u.isChatPeer)(t) && (Object(h.doesChatTabHaveFlag)(e, 1024) ? (r = ve("mail_leave_channel"), o = ve("mail_unfollow_channel_confirmation"), i = ve("mail_unfollow_channel")) : o = ve("mail_chat_sure_to_delete_all")), Object(a.isCommunityPeer)(t) && (o = ve("mail_group_sure_to_delete_all")), Pe(r, o, i, n, ve("global_cancel"))
    }

    function cn(e, t, n) {
        var r = Object(a.getTab)(e, t),
            o = Object(u.isChatPeer)(t),
            i = o && Object(h.doesChatTabHaveFlag)(r, 1024),
            s = ve("mail_deleteall1"),
            c = ve("mail_sure_to_delete_all"),
            l = ve("mail_delete");
        if (o) {
            if (r.data.closed || r.data.kicked) return sn(r, t, n.bind(null, !0));
            i ? (s = ve("mail_leave_channel"), c = ve("mail_vkcomgroup_leave_confirm"), l = ve("mail_leave_channel")) : (s = ve("mail_leave_chat"), c = ve("mail_chat_leave_confirm"), l = ve("mail_leave_chat"))
        }
        Object(a.isCommunityPeer)(t) && (c = ve("mail_group_sure_to_delete_all"));
        var d = new MessageBox({
            title: s,
            width: i ? 450 : 500
        }).content(c).setButtons(l, function() {
            return n(!!isChecked(ue("_check_is_delete")) || !o)
        }, ve("global_cancel")).show();
        return o && !i && d.setControlsText('<div class="checkbox im-delete-forall-checkbox _check_is_delete" onclick="checkbox(this);" role="checkbox" aria-checked="false">' + ve("mail_deleteall1") + "</div>"), d
    }

    function un(e) {
        return Pe(ve("mail_unpin_title"), ve("mail_unpin_text"), ve("mail_unpin"), e, ve("global_cancel"))
    }

    function ln(e, t, n, r) {
        var o = ve("mail_dialog_msg_delete_N", t),
            i = Pe(ve("mail_dialog_msg_delete_title"), o, ve("mail_delete"), function() {
                return r(isChecked(ue("_check_forall")))
            }, ve("global_cancel")),
            a = "",
            s = !1;
        return n && (a = '<div class="checkbox im-delete-forall-checkbox _check_forall" onclick="checkbox(this);" role="checkbox" aria-checked="false">' + ve("mail_delete_for_all") + "</div>", s = cur.imDb.selectByKey("del_forall_checked")), i.setControlsText(a), s && checkbox(ue("_check_forall")), i
    }

    function dn(e, t, n, r, o) {
        t.showProgress(), e.set(r.bind(null, o)).then(function() {
            t.hideProgress(), t.hide(), n().removePeer(e, o), n().updateDialogFilters(e)
        })
    }

    function fn(e, t, n, r) {
        var o = e.get().tabs[t].memberIds;
        e.set(r.bind(null, "add_member", o)).then(n().showCreation)
    }

    function pn(e, t, n) {
        var r = e.get();
        if (r.active_tab === o.FOLDER_ALL && 0 === r.message_requests_cnt) return !1;
        var i = r.active_tab === o.FOLDER_MESSAGE_REQUEST ? o.FOLDER_ALL : o.FOLDER_MESSAGE_REQUEST;
        return e.set(n.bind(null, i)).then(function(e) {
            t().restoreDialogs(e, !0)
        })
    }

    function _n(e, t, n) {
        if (e.get().active_tab === o.FOLDER_ALL && 0 === e.get().unread_cnt) return !1;
        var r = e.get().active_tab === o.FOLDER_UNREAD ? o.FOLDER_ALL : o.FOLDER_UNREAD;
        return e.set(n.bind(null, r)).then(function(e) {
            t().restoreDialogs(e, !0)
        })
    }

    function mn(e, t, n, r) {
        if (t.get().active_tab === e) return Promise.resolve(t);
        var o = Object(a.isReversedDialogs)(t);
        return t.set(r.bind(null, e)).then(function(e) {
            return n().restoreDialogs(e, !0, o !== Object(a.isReversedDialogs)(e)), e
        })
    }

    function gn(e, t) {
        void 0 === t && (t = e.get().peer);
        var n = e.get().tabs[t];
        return o.FOLDER_MASKS[o.FOLDER_IMPORTANT] & n.folders
    }

    function hn(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
        if (void 0 === t && (t = e.get().peer), !Object(a.isFoldersAvailable)(e)) return !1;
        var r = n || e.get().tabs[t];
        return o.FOLDER_MASKS[o.FOLDER_UNRESPOND] & r.folders
    }

    function bn(e, t) {
        return !1 === ((t.get().block_states || {})[e] || {}).free
    }

    function vn(e) {
        return null != e.get().pendingForward
    }

    function yn(e, t) {
        return (t.get().block_states[e] || {}).who === G.id
    }

    function On(e, t) {
        var n = e.get().block_states;
        Object.keys(n).forEach(function(o) {
            n[o].time ? !1 === n[o].free && Date.now() - n[o].time >= 5e4 && t.push([r.mutexEvent([, 1, "gim" + e.get().gid, o, 0, ""])]) : n[o].time = Date.now()
        })
    }

    function wn(e, t, n) {
        var r = void 0;
        return !xe("al_im.php", {
            act: "a_spam",
            offset: "0",
            gid: e.get().gid
        }, {
            onDone: function(n, o) {
                o && (r = t(n, e, o))
            },
            params: {
                width: 638,
                onHide: function() {
                    Le.loaded && Le.detachPlayer(!0), r.unmount()
                }
            }
        }, n)
    }

    function En(e, t) {
        return Cn(e.get(), t, Object(a.getTab)(e, t).last_seen)
    }

    function Cn(e, t, n, r) {
        if (n[0]) return ve("mail_header_online_status") + (De[n[0]] ? jn(t, !1, !1, !0) : "");
        if (!n[1]) return "";
        var o = Ee(n[1], e.timeshift),
            i = ye(Object(f.oCacheGet)(e, t).sex, ve("mail_last_activity_tip", "raw")).replace("{user}", "").replace("{time}", o);
        return n[2] && (i += jn(t, !1, !1, r)), i
    }

    function jn(e, t, n, r) {
        var o = {
            mid: e
        };
        n || (o.was = 1), t ? o.forcetoup = !0 : o.forcetodown = !0, o = Object.assign(o, r);
        var i = JSON.stringify(o).slice(1, -1).replace(/"/g, "&quot;");
        return be("im_wrap_mobile", {
            class: "im_status_mob_onl",
            params: i
        })
    }

    function kn(e, t) {
        var n = t.get().tabs[e];
        return Me("al_settings.php", {
            act: "blacklist_box",
            q: n.href
        }, {
            stat: ["settings.js", "settings.css"],
            dark: 1
        })
    }

    function Tn(e, t) {
        return Me("groupsedit.php", {
            act: "bl_edit",
            name: "/id" + e,
            gid: t.get().gid
        }, {
            stat: ["page.css", "ui_controls.js", "ui_controls.css"],
            dark: 1
        })
    }

    function Sn(e) {
        return e.get().gid ? "/gim" + e.get().gid : "/im"
    }

    function Mn(e, t, n, r) {
        var o = void 0;
        Vn(xe("al_im.php", {
            act: "a_important",
            offset: "0"
        }, {
            onDone: function(r, i) {
                i && (o = n(r, e, t, i))
            },
            params: {
                width: 638,
                onHide: function() {
                    Le.loaded && Le.detachPlayer(!0)
                },
                onDestroy: function() {
                    o && o.unmount()
                }
            }
        }, r), e)
    }

    function Pn() {
        var e = document.activeElement;
        return null !== e && ("INPUT" === e.tagName || "TEXTAREA" === e.tagName || e.getAttribute("contenteditable"))
    }

    function xn(e, t, n) {
        var r = ue("_im_mess_" + e, n);
        return r && pe(r, "im-mess_fav", t), n
    }

    function In(e, t, n) {
        var r = ue("_im_unread_bar_row", t);
        if (!r) return t;
        var o = ae(r, "._im_mess_stack", -1),
            i = ae(r, "._im_mess_stack"),
            s = o ? ce("_im_mess", o).pop() : null,
            c = i ? ue("_im_mess", i) : null;
        if (Q(r), ot(t), !c || !s) return t;
        var u = se(c, "msgid"),
            l = Object(a.getPreviousMessage)(e, n, u),
            f = Object(a.getMessage)(e, n, u);
        if (!l || wt(e.tabs[n], l, f, e)) return t;
        var p = ue("_im_stack_messages", o),
            _ = ue("_im_stack_messages", i).children;
        return Object(d.toArray)(_).forEach(function(e) {
            Q(e), p.appendChild(e)
        }), Q(i), t
    }

    function Dn(e, t, n) {
        var r = Object(a.getFirstUnread)(e, e.get().peer);
        if (!r) return [!1, 0];
        var o = ue("_im_mess_" + r, t);
        if (!o) {
            var i = Object(a.getLastMessage)(e, e.get().peer, r);
            if (!i) return [!0, 0];
            o = ue("_im_mess_" + i.messageId, t)
        }
        var s = _e(o, "_im_mess_srv") ? o : le("_im_mess_stack", o);
        if (!s) return [!0, 0];
        var c = o ? o.offsetTop : 0,
            u = s.offsetTop + c,
            l = n.contHeight();
        return u <= n.scrollTop() + n.getScrollHeight() ? [!0, 0] : [!1, Math.max(0, l - u)]
    }

    function An(e, t, n) {
        Ue(t);
        var r = le("_im_top_notice", n);
        Ne(r, 200, Q.pbind(r));
        var o = le("_im_page_dialogs", r);
        o && _e(o, "im-page--dialogs-notice") && fe(o, "im-page--dialogs-notice"), Se.post("al_im.php", {
            act: "a_hide_top_notice",
            type: r.getAttribute("data-type"),
            hash: r.getAttribute("data-hash")
        })
    }

    function Ln(e, t, n) {
        Ue(t);
        var r = le("_im_aside_notice", n);
        Be(r, 200, Q.pbind(r)), Se.post("al_im.php", {
            act: "a_hide_top_notice",
            type: r.getAttribute("data-type"),
            hash: r.getAttribute("data-hash")
        })
    }

    function Rn(e, t) {
        Ue(e);
        var n = le("_im_aside_promo_block", t);
        Be(n, 200, Q.pbind(n)), Se.post("al_im.php", {
            act: "a_hide_promo_block",
            type: n.getAttribute("data-type"),
            hash: n.getAttribute("data-hash")
        })
    }

    function Bn(e, t) {
        le("_im_aside_promo_block", t).classList.add("--action-called"), Se.post("al_im.php", {
            act: "a_vkadmin_app_install",
            hash: se(t, "hash"),
            platform: se(t, "platform")
        })
    }

    function Nn(e, t, n, r, o) {
        return n = n.replace(/\<br\s*\/?\>(\n)?/gi, " ").replace(/[\n\r]/gi, " "), n = Object(c.replaceMentions)(n, function(e, t, n, r, o) {
            return o
        }), r && (n = Re.emojiToHTML(n, !0)), t && "..." !== t.trim() && !Object(u.isChatPeer)(e) && (n = be("im_topic", {
            topic: t,
            cls: "im-topic_dialog"
        }) + n), !n && o.length > 0 && (n = be("im_dialog_media", {
            name: Un(o[0], o)
        })), n
    }

    function Un(e, t) {
        var n = {
            photo: ve("mail_added_photos", "raw"),
            video: ve("mail_added_videos", "raw"),
            audio: ve("mail_added_audios", "raw")
        };
        switch (e.type) {
            case "mail":
            case "respond":
                var r = e.object ? e.object.fwd_count : e.id.split(";").length;
                return we(r, ve("mail_fwd_msgs", "raw"), !0);
            case "photo":
            case "video":
            case "audio":
                var o = t.filter(function(t) {
                    return t.type === e.type
                }).length;
                return we(o, n[e.type], !0);
            case "audio_playlist":
                return ve("mail_added_audio_playlist");
            case "artist":
                return ve("mail_added_artist");
            case "doc":
                switch (e.kind) {
                    case "graffiti":
                        return ve("mail_added_graffiti");
                    case "audiomsg":
                        return ve("mail_added_audiomsg");
                    default:
                        return ve("mail_added_docs")
                }
            case "geo":
            case "map":
                return ve("mail_added_geo");
            case "wall":
                return ve("mail_added_wall");
            case "wall_reply":
                return ve("mail_added_wall_reply");
            case "gift":
                return ve("mail_added_gift");
            case "link":
            case "share":
                return ve("mail_added_link");
            case "sticker":
                return ve("mail_added_sticker");
            case "market":
                return ve("mail_added_market_item");
            case "money_transfer":
                return ve("mail_added_money_transfer");
            case "money_request":
                return ve("mail_added_money_request");
            case "story":
                return ve("mail_added_story");
            case "mask":
                return ve("mail_added_mask");
            case "article":
                return ve("mail_added_article");
            case "call":
                return ve("mail_added_call");
            case "poll":
                return ve("mail_added_poll");
            case "podcast":
                return ve("mail_added_podcast");
            default:
                return ve("mail_added_" + e.type)
        }
        return ""
    }

    function Fn(e) {
        de(e, "im-send-btn_loading")
    }

    function Hn(e) {
        fe(e, "im-send-btn_loading")
    }

    function Wn(e) {
        var t = e.get(),
            n = Object(a.getPinnedMessage)(e);
        if (!n || !Object(p.isPinnedMessageVisibleInTab)(e, Object(a.getPeer)(e))) return "";
        var r = Object(f.oCacheGet)(e, n.userId);
        if (!r) return "";
        var o = Kn(e, n);
        return o || (o = !(o = n.text) && n.attaches.length ? be("im_pinned_message_media", {
            text: Un(n.attaches[0], n.attaches)
        }) : Ct(e, o, n && n.kludges || {}) || ""), o = o.replace(/<br\s?\/?>/gi, " "), be("im_pinned_message", {
            date: Ce(n.date, t.timeshift),
            content: o,
            link: r.link,
            name: r.name
        })
    }

    function Kn(e, t) {
        var n = "";
        if (t && Object(s.isMoneyRequest)(t) && void 0 !== t.kludges.attach1_tr_amount) {
            var r = "%s " + t.kludges.attach1_currency;
            if ("RUB" === t.kludges.attach1_currency && (r = ve("mail_money_amount_rub", "raw")), t.kludges.attach1_total_amount) {
                var o = we(t.kludges.attach1_tr_amount / 1e3, "%s", !0),
                    i = we(t.kludges.attach1_total_amount / 1e3, r, !0);
                n = ve("mail_money_request_collected_amount_from").replace("{amount}", o).replace("{total_amount}", i)
            } else {
                var a = we(t.kludges.attach1_tr_amount / 1e3, r, !0);
                n = ve("mail_money_request_collected_amount").replace("{amount}", a)
            }
            if (Z(t.kludges.attach1_held_amount)) {
                var c = we(t.kludges.attach1_held_amount / 1e3, r, !0);
                n += " " + ve("mail_money_request_held_amount").replace("{amount}", c)
            }
            t.text && (n += '<span class="divider"></span>' + Ct(e, t.text, t.kludges)), t.kludges.attach1_total_amount && (n += be("im_pinned_message_media_bar", {
                percent: Math.min(100, Math.floor(t.kludges.attach1_tr_amount / t.kludges.attach1_total_amount * 100))
            }))
        }
        return n
    }

    function qn(e, t, n) {
        var r = n.getAttribute("data-info");
        r && Ie(n, {
            text: r,
            className: "_im_history_tooltip",
            appendParentCls: "_im_mess_stack",
            black: 1,
            hidedt: 1e3,
            shift: [0, 4]
        })
    }

    function zn(e, t, n) {
        var r = +n.getAttribute("data-time");
        r && Ie(n, {
            text: ve("mail_message_edited") + " " + Ce(r, e.get().timeshift),
            className: "_im_history_tooltip",
            appendParentCls: "_im_mess_stack",
            black: 1,
            shift: [0, 4]
        })
    }

    function Gn() {
        var e = getSize(ue(q))[1];
        return e || (e = qe), e
    }

    function Vn(e, t) {
        e.bodyNode.addEventListener("mouseover", function(e) {
            _e(e.target, "_im_edit_time") ? zn(t, 0, e.target) : _e(e.target, "_im_page_info") && qn(0, 0, e.target)
        })
    }

    function Yn(e, t, n, r, o) {
        var i = e.get(),
            a = void 0;
        Vn(xe("al_im.php", {
            act: "a_get_pinned_message_box",
            chat: n,
            gid: e.get().gid,
            hash: i.tabs[n].hash
        }, {
            onDone: function(n, o) {
                o && (a = r(n, e, t, o))
            },
            params: {
                width: 638,
                onHide: function() {
                    Le.loaded && Le.detachPlayer(!0)
                },
                onDestroy: function() {
                    a && a.unmount()
                }
            }
        }, o), e)
    }

    function Qn(e, t, n) {
        var r = e.get();
        Vn(xe("al_im.php", {
            act: "a_get_replied_message_box",
            chat: r.peer,
            msgid: t,
            gid: r.gid,
            hash: r.tabs[r.peer].hash
        }, {
            onDone: function(e, t) {},
            params: {
                width: 638,
                onHide: function() {
                    Le.loaded && Le.detachPlayer(!0)
                },
                onDestroy: function() {}
            }
        }, n), e)
    }

    function $n(e, t) {
        return !(!Object(u.isChatPeer)(e.peerId) || !e.memberIds) && e.memberIds.indexOf(t) >= 0
    }

    function Xn(e) {
        return !Object(u.isChatPeer)(e.peerId) || e.data.kicked ? 0 : e.membersCount
    }

    function Jn(e, t) {
        var n = Object(f.oCacheGet)(e, t.peerId),
            r = Object(a.getTab)(e, t.peerId) || {};
        return n && (t.photo = t.photo || n.photo, t.name = t.name || n.name, t.href = t.link || n.link, t.sex = t.sex || n.sex), t.last_touched = r.last_touched || 0, t.verified = !!t.verified, t.lastmsg = t.lastmsg || t.lastmsg_meta && t.lastmsg_meta[0] || !1, t.folders = t.folders || null, t.unread = t.unread || 0, t.last_seen = t.last_seen || [0, 0, 0], t.online = t.last_seen && t.last_seen[0] || 0, t.out_up_to = null != t.out_up_to ? t.out_up_to : t.in_up_to || 0, Object(u.isChatPeer)(t.peerId) && (t.memberIds = t.memberIds || r.memberIds || null), t
    }

    function Zn(e, t) {
        for (var n in t) t.hasOwnProperty(n) && Jn(e, t[n])
    }

    function er(e, t) {
        var n = [],
            r = t.find(function(e) {
                return "mail" === e[0]
            }),
            o = r ? r[1].split(";") : [];
        for (o.length > We && (r[1] = o.slice(0, We).join(";")); e.length > He;) {
            var i = e.substr(0, He).lastIndexOf(" "); - 1 == i && (i = He), n.push({
                msgText: ee(e.substr(0, i))
            }), e = ee(e.substr(i))
        }
        for (e.length && n.push({
                msgText: e,
                attaches: t
            }), n.length || n.push({
                attaches: t
            }), o = o.slice(We); o.length; o = o.slice(We)) n.push({
            attaches: [
                ["mail", o.slice(0, We).join(";")]
            ]
        });
        return n
    }

    function tr(e) {
        return e.length > He
    }

    function nr(e, t, n) {
        var r = !1;
        Me("al_im.php", {
            act: "a_chat_preview",
            chat_id: t.invite_chat_id,
            hash: t.invite_hash
        }, {
            stat: ["boxes.css"],
            params: {
                dark: 1,
                hideButtons: !0,
                onHide: function() {
                    e.set(n), r && r.unmount()
                }
            },
            onFail: function(e) {
                return setTimeout(function() {
                    return Pe(ve("global_error"), e)
                }, 0), !0
            },
            onDone: function(t, n) {
                r = Object(l.mount)(t.bodyNode, e)
            }
        }, {})
    }

    function rr() {
        Pe(ve("global_error"), ve("mail_message_wait_until_uploaded"))
    }

    function or(e, t) {
        var n = Object(a.getTab)(e, t.peerId) || {};
        if (!t || !Object(s.isOut)(t)) return !1;
        if (333 == t.peerId) return !1;
        if (Date.now() / 1e3 - t.date > 86400) return !1;
        if (Je(e, t.peerId, t.messageId)) return !1;
        if (Object(u.isChatPeer)(t.peerId)) {
            if (n.data.kicked || n.data.closed) return !1
        } else if (n.block_error > 0) return !1;
        return !0
    }

    function ir(e, t) {
        var n = Object(a.getTab)(e, t),
            r = -1 !== n.memberIds.indexOf(n.ownerId),
            o = r ? [n.ownerId] : [];
        return (o = o.concat(n.memberIds.filter(function(t) {
            return t !== n.ownerId && Object(f.oCacheExists)(e, t)
        }).slice(0, r ? 4 : 5))).map(function(t) {
            return Object(f.oCacheGet)(e, t)
        })
    }

    function ar(e, t) {
        return t.map(function(t) {
            return Object(f.oCacheGet)(e, t)
        })
    }

    function sr(e, t) {
        return Object(a.getTab)(e, t).memberIds.reduce(function(t, n) {
            var r = Object(f.oCacheGet)(e, n);
            return t[r.id] = r, t
        }, {})
    }

    function cr(e, t) {
        if ("number" != typeof e || 0 === e) return "";
        var n, r = e,
            o = [];
        if ([
                [31536e3, ve(t ? "global_years_accusative" : "global_age_years", "raw")],
                [2592e3, ve(t ? "global_months_accusative" : "global_age_months", "raw")],
                [604800, ve(t ? "global_weeks_accusative" : "global_age_weeks", "raw")],
                [86400, ve(t ? "global_days_accusative" : "global_age_days", "raw")],
                [3600, ve(t ? "global_hours_accusative" : "global_hours", "raw")],
                [60, ve(t ? "global_minutes_accusative" : "global_minutes", "raw")],
                [1, ve(t ? "global_seconds_accusative" : "global_age_seconds", "raw")]
            ].forEach(function(e) {
                var t = v(e, 2),
                    n = t[0],
                    i = t[1],
                    a = Math.floor(r / n);
                r %= n, a >= 1 && o.push(we(a, i))
            }), 1 === (n = o.length)) return o.pop();
        var i = o.slice(0, n - 1).join(", "),
            a = o.pop();
        return ve("global_and").replace(/{before}/gi, i).replace(/{after}/gi, a)
    }

    function ur(e, t, n, o) {
        o && !Je(e, n, o) && (Object(a.getMessage)(e, n, o) ? (e.setState({
            msgid: o
        }), Object(i.updateLocation)({
            msgid: o
        }), t()) : e.get().longpoll.push([Object(r.changePeer)(n, o)]))
    }

    function lr(e) {
        var t = ue("im-mess_is_editing");
        if (!t) return null;
        var n = e.get().tabs[e.get().peer],
            r = Object(a.parserMessage)(n.msgs[se(t, "msgid")]);
        return r && r.peerId == e.get().peer ? r : null
    }
}, , , function(e, t) {
    e.exports = !1
}, , function(e, t, n) {
    e.exports = n(333)
}, , function(e, t, n) {
    var r = n(51);
    e.exports = function(e) {
        return Object(r(e))
    }
}, , , , function(e, t, n) {
    var r = n(405);
    e.exports = Object("z").propertyIsEnumerable(0) ? Object : function(e) {
        return "String" == r(e) ? e.split("") : Object(e)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return $
    });
    var r = n(252),
        o = n(1),
        i = n(406),
        a = n(427),
        s = n(228),
        c = n(192),
        u = n(433),
        l = n(46),
        d = n(112),
        f = n(256),
        p = n(292),
        _ = n(66),
        m = n(309),
        g = n(187),
        h = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function b(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    var v = 64,
        y = "_im_dialog_star",
        O = "_im_dialog_daction",
        w = ["_im_dialog_selected", "nim-dialog_selected"],
        E = ["_im_dialog_hovered", "nim-dialog_hovered"];

    function C(e) {
        return hasClass(e, "_im_search")
    }

    function j(e, t, n, a, s) {
        if (!gpeByClass("_im_peer_target", a.target)) {
            var c = t.get(),
                u = C(s),
                l = parseInt(domData(s, "peer"), 10),
                f = parseInt(domData(s, "msgid"), 10),
                p = Object(i.getTab)(t, l),
                _ = "";
            if (Object(i.isSearching)(t) && (_ = "conversations_search"), Object(i.isRecentSearchesActive)(t) && (_ = "recent_searches"), hasClass(s, "_im_sugg_" + l) && (_ = "popular_suggestions"), u && (_ = "message_search"), checkEvent(a)) return window.open(function(e, t, n) {
                var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                    i = Object(o.getBaseLink)(e),
                    a = function() {
                        return i + "?sel=" + Object(o.convertPeerToUrl)(t.peerId) + (r && n ? "&msgid=" + n : "")
                    };
                if (r) return a();
                if (Object(o.isUserPeer)(t.peerId) || Object(o.isCommunityPeer)(t.peerId)) return Object(o.isClassicInterface)(e) ? a() : t.href;
                return a()
            }(t, p, f, u));
            if (n.saveScroll("list"), u && c.msgid !== f) c.longpoll.push([d.changePeer(l, f, !1, !1, _)]);
            else if (l !== c.peer) {
                c.longpoll.push([d.changePeer(l, !1, !0, !0, _)]);
                var m = Object(i.isSearching)(t);
                m && !hasClass(s, "_dont_add_recent") && Object(r.saveRecentSearchPeer)(l, cur.imDb), m && p && !Object(o.isClassicInterface)(t) && setTimeout(function() {
                    var e = p.message ? p.message.messageId : p.peerId;
                    n.scrollToElement(e.toString(), !0, 0, "center")
                }, 100)
            } else l === c.peer && e().goToHistoryEnd();
            cancelEvent(a)
        }
    }

    function k(e, t, n, r) {
        var i = void 0;
        return !Object(o.isChatPeer)(t) || "string" == typeof n.photo && "" !== n.photo ? (i = '<img src="' + n.photo + '" alt="">', r && (i = getTemplate("im_dialogs_link_img", {
            href: n.href,
            photo: i
        }))) : i = Object(o.renderPhotosFromTab)(e, n, !r), {
            photo: i,
            userLink: '<span class="_im_dialog_link">' + n.tab + "</span>"
        }
    }

    function T(e, t, n, r) {
        return n ? "" : r ? getTemplate("im_img_prebody", {
            photo: t
        }) : e + ":"
    }

    function S(e, t, n) {
        return !!(n & d.FLAG_OUTBOUND) && (!Object(o.isSelfMessage)(t.peerId, e.get().gid) && (!(Object(o.isChatPeer)(t.peerId) && t.data && t.data.closed) && (!t.unread && !(t.lastmsg <= t.out_up_to))))
    }

    function M(e) {
        var t = A(e);
        return (e.unread > 0 ? e.unread : "") > 0 && t
    }

    function P(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
            r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {},
            a = k(e, t.peerId, t, Object(o.isClassicInterface)(e)),
            s = a.photo,
            c = a.userLink,
            u = n || A(t);
        if (!u) return function(e, t, n, r) {
            var a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {},
                s = [];
            return Object(o.isClassicInterface)(r) && s.push("nim-dialog_classic"), Object(i.isRecentSearchesActive)(r) && s.push("nim-dialog_recent"), s.push("nim-dialog_empty"), a.search && s.push("_im_search"), getTemplate("im_drow", {
                peer: e.peerId,
                msg_id: "",
                photo: t,
                user_link: n,
                date: "",
                body: "",
                unread: "",
                more: s.join(" "),
                is_star: "",
                unread_message_string: "",
                is_online: onlinePlatformClass(e.online),
                is_unread: "",
                is_unread_out: "",
                is_selected: e.peerId == r.get().peer ? "nim-dialog_selected _im_dialog_selected" : ""
            })
        }(t, s, c, e, r);
        var l = u.flags,
            f = Object(o.isFvkcomgroup)(e, t.peerId),
            p = D(t, e, n),
            _ = [];
        r.search && _.push("_im_search", "nim-dialog_search"), inArray(t.peerId, e.get().mutedPeers) && _.push("nim-dialog_muted"), t.verified && _.push("nim-dialog_verified"), Object(i.isRecentSearchesActive)(e) && _.push("nim-dialog_recent"), -1 === u.messageId && _.push("nim-dialog_empty"), Object(o.isClassicInterface)(e) && _.push("nim-dialog_classic"), t.folders & d.FOLDER_IMPORTANT && _.push("nim-dialog_starred"), !r.search && Object(o.isUnrespond)(e, t.peerId, t) && _.push("nim-dialog_unrespond"), f && e.get().gid && _.push("nim-dialog_deny-remove");
        var m = e.get().timeshift,
            g = S(e, t, l) ? "nim-dialog_unread-out" : "",
            h = t.unread > 0 ? getLang("mail_im_new_messages", t.unread) : "";
        return getTemplate("im_drow", {
            peer: t.peerId,
            msg_id: u.messageId,
            photo: s,
            user_link: c,
            date: u.date ? getShortDateOrTime(u.date, m, !0, getLang("months_sm_of", "raw")) : "",
            body: p,
            unread_message_string: h,
            tab_name: stripHTML(t.tab),
            unread: Object(o.simplifyCounter)(t.unread),
            more: _.join(" "),
            is_online: onlinePlatformClass(t.online),
            is_unread: M(t) ? "nim-dialog_unread" : "",
            is_unread_out: g,
            is_selected: r.noselect || t.peerId != e.get().peer ? "" : "nim-dialog_selected _im_dialog_selected"
        })
    }

    function x(e, t, n, r, a) {
        if (!t.deletedDialog)
            if (hasClass(e, "nim-conversation-search-row")) I(e, t, n);
            else {
                var s = A(t),
                    c = s.flags,
                    u = D(t, n),
                    l = k(n, t.peerId, t, Object(o.isClassicInterface)(n)).photo,
                    f = n.get().timeshift,
                    p = s.date ? getShortDateOrTime(s.date, f, !0, getLang("months_sm_of", "raw")) : "";
                W(e, t), val(geByClass1("_dialog_body", e), u), val(geByClass1("_im_dialog_date", e), p), val(geByClass1("_im_dialog_unread_ct", e), Object(o.simplifyCounter)(t.unread)), val(geByClass1("_im_dialog_link", e), t.tab);
                var _ = geByClass1("_im_dialog_photo", e);
                _.innerHTML !== l && val(_, l), toggleClass(e, "nim-dialog_verified", !!t.verified), toggleClass(e, "nim-dialog_starred", t.folders & d.FOLDER_IMPORTANT), toggleClass(e, "nim-dialog_muted", inArray(t.peerId, n.get().mutedPeers)), toggleClass(e, "nim-dialog_unrespond", Object(o.isUnrespond)(n, t.peerId, t)), toggleClass(e, "nim-dialog_classic", Object(o.isClassicInterface)(n)), toggleClass(e, "nim-dialog_unread", M(t)), toggleClass(e, "nim-dialog_deny-remove", n.get().gid > 0 && Object(o.isFvkcomgroup)(n, t.peerId)), removeClass(e, "nim-dialog_failed"), removeClass(e, "nim-dialog_deleted"), addClass(e, "_im_dialog"), toggleOnline(geByClass1("_im_peer_online", e), t.online), toggleClass(e, "nim-dialog_recent", Object(i.isRecentSearchesActive)(n)), toggleClass(e, "nim-dialog_empty", -1 === s.messageId), S(n, t, c) && addClass(e, "nim-dialog_unread-out"), a && setTimeout(function() {
                    addClass(geByClass1("_im_dialog_" + t.peerId, r), "nim-dialog_injected")
                }, 100)
            }
    }

    function I(e, t, n) {
        W(e, t), toggleClass(e, "nim-dialog_recent", Object(i.isRecentSearchesActive)(n)), val(geByClass1("_im_dialog_unread_ct", e), Object(o.simplifyCounter)(t.unread));
        var r = k(n, t.peerId, t, Object(o.isClassicInterface)(n)).photo,
            a = geByClass1("_im_dialog_photo", e);
        a.innerHTML !== r && val(a, r), toggleOnline(geByClass1("_im_peer_online", e), t.online), M(t) && addClass(e, "nim-dialog_unread")
    }

    function D(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2] || A(e);
        if (Object(o.isPeerBlocked)(e.peerId, t)) {
            var r = t.get().block_states[e.peerId].name,
                s = getLang("mail_community_answering").replace("{username}", r);
            return getTemplate("im_drow_prebody", {
                prebody: s,
                body: ""
            })
        }
        return Object(a.isServiceMsg)(n) ? Object(o.renderServiceMsg)(t, n, e, !1) : function(e, t, n, r, a, s, c, u, l, f) {
            var p = "",
                m = Object(i.isChannel)(e, Object(i.getTab)(e, n));
            return t & d.FLAG_OUTBOUND ? p = T(getLang("mail_by_you"), f, m, l) : Object(o.isChatPeer)(n) && 0 !== r && (p = T(Object(_.oCacheGet)(e, r).first_name, Object(_.oCacheGet)(e, r).photo, m, l)), c = Object(o.renderShortText)(n, u, c, a, s), p ? getTemplate("im_drow_prebody", {
                prebody: p,
                body: c
            }) : c
        }(t, n.flags, e.peerId, n.userId, !0, n.attaches, n.text, n.subject, Object(o.isClassicInterface)(t), Object(_.oCacheGet)(t, t.get().id).photo)
    }

    function A(e) {
        var t = e.lastmsg_meta;
        return isArray(t) && (t = Object(d.addMessageEvent)([4].concat(t))), t || Object(d.addMessageEvent)([4, -1, 0, e.peer, 0, "", {}, {}, -1, -1, 0])
    }

    function L(e, t, n) {
        var i = Object(o.showLeaveDialog)(e, t, function(a) {
            n().updateMenu(e), a && Object(o.cleanHistory)(e, i, n, r.flushHistory, t), Object(o.isChatPeer)(t) && e.set(r.leaveChat.bind(null, t)), i.hide()
        })
    }

    function R(e, t, n, i, a, s) {
        var c = gpeByClass("_im_dialog", s, n);
        if (cancelEvent(a), !c) return !1;
        var u = intval(domData(c, "peer")),
            l = t.get(),
            d = Object(o.isCommunityPeer)(u) || Object(o.isUserPeer)(u);
        if (l.recentSearch) {
            var f = Object(r.removeFromRecentSearch)(u, cur.imDb);
            re(c), 0 === f.length && G(t, i, e)
        } else Object(o.isClassicInterface)(t) && d ? Object(r.deleteDialog)(u, l).then(function(n) {
            var r = h(n, 2),
                o = r[0],
                i = r[1];
            o ? (! function(e, t, n, r, o) {
                var i = geByClass1("_dialog_body", t);
                addClass(t, "nim-dialog_deleted"), removeClass(t, "_im_dialog"), val(i, getTemplate("im_delete_actions", {
                    text: langNumeric(n, getLang("mail_im_X_message_deleted", "raw")),
                    peer: e,
                    spam_id: r
                }))
            }(u, c, o, i), e().updateMenu(t)) : L(t, u, e)
        }) : L(t, u, e);
        return !1
    }

    function B(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "",
            r = k(e, t.peerId, t, Object(o.isClassicInterface)(e)),
            a = r.photo,
            s = r.userLink,
            c = function(e) {
                return !Object(o.isPendingForward)(e)
            }(e),
            u = "" === n ? [] : [n];
        return Object(i.isRecentSearchesActive)(e) && u.push("nim-dialog_recent"), Object(o.isClassicInterface)(e) && u.push("nim-csr_classic"), inArray(t.peerId, e.get().mutedPeers) && u.push("nim-dialog_muted"), getTemplate("im_conversation_search_row", {
            peer: t.peerId,
            msg_id: t.lastmsg || "",
            photo: a,
            user_link: s,
            unread: Object(o.simplifyCounter)(t.unread),
            tab_name: stripHTML(t.tab),
            is_unread: M(t) ? "nim-dialog_unread" : "",
            is_online: onlinePlatformClass(t.online),
            is_selected: t.peerId == e.get().peer && c ? "nim-dialog_selected _im_dialog_selected" : "",
            more: u.join(" ")
        })
    }

    function N(e, t) {
        return e.map(function(e) {
            return Object(d.addMessageEvent)([4].concat(e))
        }).map(function(e) {
            return extend({}, t[e.peerId], {
                message: e
            })
        })
    }

    function U(e) {
        return {
            type: "empty",
            lang: e
        }
    }

    function F(e, t) {
        var n = e.get().msg_local_ids_sort && e.get().msg_local_ids_sort[t.lastmsg];
        return void 0 !== n ? 2e9 + n : t.lastmsg
    }

    function H(e, t, n, r) {
        showTooltip(r, {
            text: function() {
                var n = gpeByClass("_im_dialog", r, t),
                    o = domData(n, "peer");
                return e.get().tabs[o].folders & d.FOLDER_IMPORTANT ? getLang("mail_im_toggle_important_off") : getLang("mail_im_toggle_important")
            },
            black: 1,
            zIndex: 1,
            shift: [14, 8],
            toup: Q(e, r.getBoundingClientRect().top)
        })
    }

    function W(e, t) {
        var n = t.unread > 0 ? getLang("mail_im_new_messages", t.unread) : "",
            r = geByClass1("_im_unread_blind_label", e);
        val(r, n)
    }

    function K(e) {
        var t = Object(i.isSearching)(e),
            n = e.get().searchOnlyMessages;
        return Object(o.isClassicInterface)(e) ? {
            top: t && !n ? 96 : 60,
            bottom: Object(o.isCommunityInterface)(e) ? 42 : 87
        } : {
            top: t && !n ? 36 : 0,
            bottom: 0
        }
    }

    function q(e, t) {
        e.hoverFirstElement(E, K(t))
    }

    function z(e) {
        e.unhoverElements(E)
    }

    function G(e, t, n) {
        if (Object(i.doPopularSuggExist)(e)) {
            t.pipeReplace(Promise.resolve([{
                type: "sep_popular"
            }, {
                type: "popular_sugg"
            }])), t.toTop()
        } else n().cancelSearch(e), cancelStackFilter("im_search")
    }

    function V(e, t, n, r, a) {
        return {
            selectPeer: function(t, n) {
                for (var r = geByClass("_im_dialog", e), o = n.get().peer, i = 0; i < r.length; i++) {
                    var a = r[i],
                        s = intval(domData(a, "peer")),
                        c = intval(domData(a, "msgid"));
                    s === o && (!C(a) || t === c && C(a)) ? (addClass(a, "nim-dialog_selected"), addClass(a, "_im_dialog_selected")) : hasClass(a, "_im_dialog_selected") && (removeClass(a, "nim-dialog_selected"), removeClass(a, "_im_dialog_selected"))
                }
            },
            appendFastDialogs: function(t, r, a) {
                removeClass(e.parentNode, "im-page--dialogs_with-mess"), n.saveScroll("list"), a ? (n.reset(), Object(o.isPendingForward)(t) || Object(i.isRecentSearchesActive)(t) || !Object(s.doesSearchResultContainConversations)(r) ? Object(i.isRecentSearchesActive)(t) && (Object(s.doesSearchResultContainConversations)(r) && (r = [{
                    type: "clear_recent"
                }].concat(r)), Object(i.doPopularSuggExist)(t) && (r = [{
                    type: "sep_popular"
                }, {
                    type: "popular_sugg"
                }].concat(r))) : r = [{
                    type: "sep_btn_search_msg"
                }, {
                    type: "sep_conversations"
                }].concat(r), t.setState({
                    searchOnlyMessages: !1
                }), n.pipeReplace(Promise.resolve(r)).then(function() {
                    return q(n, t)
                })) : n.pipe(Promise.resolve(r)), Object(o.isClassicInterface)(t) && !Object(o.isReservedPeer)(t.get().peer) || n.toTop()
            },
            deactivate: function() {
                n.deactivate()
            },
            activate: function() {
                n.activate()
            },
            hoverFirstDialog: function(e) {
                q(n, e)
            },
            hoverNextDialog: function(e) {
                n.hoverNextElement(E, w, K(e))
            },
            hoverPrevDialog: function(e) {
                n.hoverPrevElement(E, w, K(e))
            },
            unhoverDialogs: z.bind(n),
            selectHoveredDialog: function(t) {
                var o = geByClass1("_im_dialog_hovered", e);
                o || (o = geByClass1("_im_dialog", e)), o && j(r, t, n, {}, o)
            },
            appendSearch: function(t, r, o) {
                var i = N(o, r);
                o.length > 0 ? (addClass(e.parentNode, "im-page--dialogs_with-mess"), n.pipe(Promise.resolve([{
                    type: "sep_messages"
                }].concat(i))).then(function() {
                    return q(n, t)
                })) : (0 === n.getCurrentElements().length && n.pipeReplace(Promise.resolve([U()])), removeClass(e.parentNode, "im-page--dialogs_with-mess"))
            },
            updateDialog: function(t, n) {
                var r = geByClass1("_im_dialog_" + t);
                r && !C(r) && x(r, n.get().tabs[t], n, e)
            },
            focusOnSelected: function(e) {
                var t = e.get().peer;
                if (t) {
                    var r = geByClass1("_im_dialog_" + t);
                    r ? n.scrollTop(r.offsetTop - r.offsetHeight) : n.toTop()
                }
            },
            restoreScroll: function(e) {
                n.restoreScroll("list") || n.toTop()
            },
            restoreDialogs: function(t, i, a) {
                removeClass(e.parentNode, "im-page--dialogs_with-mess"), t.setState({
                    searchOnlyMessages: !1
                }), 0 !== Y(t).length || n.isLoading() || (i = !0), i && n.reset(), a && n.wipe(), n.pipeReplace(Promise.resolve(Y(t))).then(function(e) {
                    if (i && (!Object(o.isClassicInterface)(t) || !t.get().peer)) {
                        var a = function(e, t, n) {
                            return Object(o.isClassicInterface)(n) || t().toggleSettingsLoader(n, !0), e.checkMore(!Object(o.isClassicInterface)(n)).then(function() {
                                Object(o.isClassicInterface)(n) || t().toggleSettingsLoader(n, !1)
                            })
                        }(n, r, t);
                        return n.toTop(), a
                    }
                }).then(function() {
                    return z(n)
                })
            },
            appendDialogs: function(t, r) {
                removeClass(e.parentNode, "im-page--dialogs_with-mess"), r.forEach(function(n) {
                    var r = geByClass1("_im_dialog_" + n.peerId, e);
                    r && I(r, n, t)
                }), Object(o.isPendingForward)(t) || Object(i.isRecentSearchesActive)(t) || !Object(s.doesSearchResultContainConversations)(r) || (r = [{
                    type: "sep_btn_search_msg"
                }, {
                    type: "sep_conversations"
                }].concat(r)), t.setState({
                    searchOnlyMessages: !1
                }), n.isEmpty() && 0 === r.length && Object(o.isPendingForward)(t) && (r = [U(getLang("mail_im_search_empty_chats"))]), n.replacePreserveOrder(r)
            },
            updateCounter: function(t, n) {
                var r = geByClass1("_im_dialog_" + n, e),
                    a = Object(i.getTab)(t, n);
                if (r && !C(r) && (W(r, a), val(geByClass1("_im_dialog_unread_ct", r), Object(o.simplifyCounter)(a.unread)), toggleClass(r, "nim-dialog_unread", a.unread > 0), toggleClass(r, "nim-dialog_unread-out", S(t, a, A(a).flags))), Object(i.isRecentSearchesActive)(t)) {
                    var s = geByClass1("_im_sugg_" + n);
                    s && (val(geByClass1("_sugg_unread_ct", s), Object(o.simplifyCounter)(a.unread)), toggleClass(s, "sugg-is_unread", a.unread > 0))
                }
            },
            removeDialog: function(e, t) {
                n.remove(t)
            },
            updateOnline: function(t, n) {
                var r = geByClass1("_im_dialog_" + t, e);
                if (r) {
                    var o = n.get().tabs[t],
                        i = geByClass1("_im_peer_online", r);
                    toggleOnline(i, o.online)
                }
            },
            setDialogFailed: function(t, n, r) {
                var o = geByClass1("_im_dialog_" + t, e);
                o && (r.get().tabs[t].lastmsg === n && (addClass(o, "nim-dialog_failed"), val(geByClass1("_im_dialog_unread_ct", o), "!")))
            },
            scrollUp: function(e) {
                var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
                n.toTop(e, t), n.saveScroll("list", !0)
            },
            saveScroll: function(e) {
                n.saveScroll("list", !0)
            },
            promoteDialog: function(r, o) {
                var a = geByClass1("_im_dialog_" + o, e);
                a && !C(a) || !Object(i.isSearching)(r) ? (n.pipeReplace(Promise.resolve(Y(r)), void 0, !0).then(function(t) {
                    !inArray(o, t) && a && x(a, Object(i.getTab)(r, o), r, e)
                }), t().updateTyping(o, r)) : n.unsetScroll("list")
            },
            removeSelection: function(t) {
                var r = t.get().peer.toString(),
                    i = "._im_dialog_" + r + "." + w.join("."),
                    a = domQuery(i, e)[0];
                w.forEach(function(e) {
                    return removeClass(a, e)
                }), Object(o.isClassicInterface)(t) || n.hoverElement(r, E, K(t))
            },
            updateScroll: function() {
                n.updateScroll()
            },
            updateTyping: function(t, n) {
                var r = geByClass1("_im_dialog_" + t, e);
                if (r && !C(r) && !n.get().tabs[t].deletedDialog) {
                    var a = geByClass1("_im_dialog_typing", r),
                        s = !Object(o.isClassicInterface)(n),
                        c = Object(o.formatTyper)(Object(i.getTab)(n, t).activity, t, !Object(o.isChatPeer)(t), n.get(), 1, s);
                    val(a, c), toggleClass(r, "nim-dialog_typing", c)
                }
            },
            unmount: function() {
                n.unmount(), Object(f.destroyModule)(a)
            }
        }
    }

    function Y(e) {
        var t = e.get().active_tab,
            n = e.get().dialog_tabs[t],
            r = e.get().tabs,
            i = n.map(function(e) {
                return r["" + e]
            }).sort(function(e, t, n) {
                var r = void 0;
                return t.message && n.message ? (r = n.message.messageId - t.message.messageId, r = Object(o.isReversedDialogs)(e) ? -r : r) : t.message && !n.message ? r = 1 : n.message && !t.message ? r = -1 : (r = F(e, n) - F(e, t), r = Object(o.isReversedDialogs)(e) ? -r : r), r
            }.bind(null, e));
        if (e.get().isIncomingMessageRequestsAllowed && n.length) {
            var a = Object(g.unpackStore)(e),
                s = a.message_requests_cnt,
                u = a.active_tab;
            if (u === c.FOLDER_MESSAGE_REQUEST && i.unshift({
                    type: "message_request_notice"
                }), !Object(o.isClassicInterface)(e)) switch (u) {
                case c.FOLDER_ALL:
                    s && i.unshift({
                        type: "message_request_button_go"
                    });
                    break;
                case c.FOLDER_MESSAGE_REQUEST:
                    i.unshift({
                        type: "message_request_button_return"
                    })
            }
        }
        return i
    }

    function Q(e, t) {
        return t > (e.get().gid ? 220 : 150) || Object(i.isSearching)(e)
    }

    function $(e, t, n) {
        var a = Object(f.createMutations)(V),
            s = a.callMutations,
            d = a.bindMutations,
            _ = function(e, n) {
                var r;
                showTooltip(n, (b(r = {
                    text: function() {
                        if (Object(i.isRecentSearchesActive)(t)) return getLang("mail_hide_from_recent");
                        var e = Number(n.getAttribute("data-peer")),
                            r = Object(i.getTab)(t, e);
                        return Object(o.isChatPeer)(e) ? Object(m.doesChatTabHaveFlag)(Object(i.getTab)(t, e), 1024) ? getLang("mail_unfollow_channel") : r.data.closed || r.data.kicked ? getLang("mail_delete") : getLang("mail_leave_chat") : getLang("mail_delete")
                    },
                    black: 1
                }, Object(o.isClassicInterface)(t) ? "center" : "needLeft", !0), b(r, "shift", Object(o.isClassicInterface)(t) ? [-4, 10] : [0, 10]), b(r, "toup", Q(t, n.getBoundingClientRect().top)), b(r, "zIndex", 1), r))
            },
            g = function(e, n) {
                showTooltip(n, {
                    text: getLang("mail_end_conversation"),
                    black: 1,
                    center: !0,
                    zIndex: 1,
                    shift: [1, 4],
                    toup: Q(t, n.getBoundingClientRect().top)
                })
            },
            w = H.bind(null, t, e),
            C = function(e, t, n, o) {
                var i = gpeByClass("_im_dialog", o, t),
                    a = intval(domData(i, "peer"));
                return e.set(r.toggleDialogImportant.bind(null, a)), setTimeout(function() {
                    H(e, t, 0, o)
                }, 100), cancelEvent(n), !1
            }.bind(null, t, e),
            k = function(e, t, n, o, a) {
                var s = gpeByClass("_im_dialog", a, t),
                    c = intval(domData(s, "peer")),
                    u = e.get().tabs[c].lastmsg;
                return e.set(r.markDialogAnswered.bind(null, c, u)).then(function() {
                    x(s, e.get().tabs[c], e, t), Object(i.isRecentSearchesActive)(e) || n().restoreDialogs(e)
                }), showDoneBox(getLang("mail_marked_as_answered"), {
                    out: 1e3
                }), cancelEvent(o), !1
            }.bind(null, t, e, s),
            T = geByClass1("_im_dialogs_search"),
            S = {
                idFn: function(e) {
                    return function(e, t) {
                        return t.message ? t.message.messageId : Object(i.isSearching)(e) && t.peerId ? t.peerId + "cr" : t.peerId || t.type
                    }(t, e)
                },
                hoverableFn: function(e) {
                    return hasClass(e, "_im_dialog")
                },
                renderFn: function(e, t) {
                    var n = e.get().isIncomingMessageRequestsAllowed;
                    switch (t.type) {
                        case "sep_btn_search_msg":
                            return Object(o.renderBtnSearchOnlyMessages)(e);
                        case "sep_messages":
                            return Object(o.renderMessagesSep)();
                        case "sep_conversations":
                            return Object(o.renderConversationsSep)();
                        case "sep_popular":
                            return Object(o.renderPopularSuggSep)();
                        case "popular_sugg":
                            return Object(o.renderPopularSuggestions)(e);
                        case "clear_recent":
                            return Object(o.renderClearRecent)();
                        case "empty_dialogs":
                        case "empty_message_requests":
                            return getTemplate("im_dialogs_none", {
                                msg: getLang("mail_dialogs_list_empty")
                            });
                        case "empty":
                            return getTemplate("im_dialogs_none", {
                                msg: getLang("mail_im_search_empty")
                            });
                        case "message_request_notice":
                            return n ? getTemplate("im_dialogs_message_requests_notice", {
                                msg: getLang("mail_message_request_tab_notice")
                            }) : "";
                        case "message_request_button_go":
                            return n ? getTemplate("im_dialogs_message_requests_button", {
                                msg: getLang("mail_tab_mr")
                            }) : "";
                        case "message_request_button_return":
                            return n ? getTemplate("im_dialogs_message_requests_button", {
                                msg: getLang("mail_go_to_all_tab")
                            }) : "";
                        default:
                            return t.message ? P(e, t, t.message, {
                                noselect: !0,
                                search: !0
                            }) : t.local_index || Object(i.isSearching)(e) ? B(e, t) : P(e, t)
                    }
                }.bind(null, t),
                more: function(e, t, n, a) {
                    if (Object(i.isSearching)(e) && e.get().searchAllLoaded || Object(i.isRecentSearchesActive)(e)) return Promise.resolve([]);
                    if (e.get().dialog_search_going || Object(o.isClassicInterface)(e) && 0 !== e.get().peer) return Promise.resolve(!1);
                    if (Object(i.isSearching)(e)) return Object(r.searchMessages)(Object(i.getSearchText)(e), e.get()).then(function(e) {
                        var t = h(e, 2),
                            n = t[0];
                        return N(t[1], n)
                    });
                    var s = e.get().active_tab,
                        u = e.get().dialog_tabs_all,
                        l = s === c.FOLDER_MESSAGE_REQUEST;
                    return s !== c.FOLDER_MESSAGE_REQUEST && u[c.FOLDER_ALL] && !Object(o.isReversedDialogs)(e) || u[s] ? 0 === Y(e).length ? l ? Promise.resolve([{
                        type: "message_request_notice"
                    }, {
                        type: "empty_message_requests"
                    }]) : Promise.resolve([{
                        type: "empty_dialogs"
                    }]) : Promise.resolve([]) : e.set(r.loadDialogs).then(function(t) {
                        var n = Y(e);
                        return 0 === n.length ? l ? Promise.resolve([{
                            type: "message_request_notice"
                        }, {
                            type: "empty_message_requests"
                        }]) : [{
                            type: "empty_dialogs"
                        }] : n
                    })
                }.bind(null, t, s),
                onScroll: !!Object(o.isClassicInterface)(t) && function() {
                    (bodyNode.scrollTop || document.documentElement.scrollTop) <= 0 && !layers.visible && browser.safari ? addClass(T, "im-page--header_static") : removeClass(T, "im-page--header_static")
                }
            },
            M = Object(l.mount)(e, Object(u.default)({
                limit: 40,
                offset: 0,
                nativeScroll: !!Object(o.isClassicInterface)(t),
                height: v,
                elements: Y(t)
            }), function() {
                return S
            }),
            I = j.bind(null, n, t, M),
            D = function(e, t, n) {
                removeClass(t.parentNode, "im-page--dialogs_with-mess");
                var r = n.getCurrentElements().filter(function(e) {
                    return e.message
                });
                n.toTop(), n.reset(), Object(p.statlogsProbValueEvent)(.01, "im_search_stat", 1, "search_messages_only"), r.length > 0 ? (r = [{
                    type: "sep_messages"
                }].concat(r), e.setState({
                    searchOnlyMessages: !0
                })) : r = [U()], n.pipeReplace(Promise.resolve(r))
            }.bind(null, t, e, M),
            A = function(e, t, n, i, a, s) {
                var c = intval(domData(s, "peer")),
                    u = domData(s, "action"),
                    l = domData(s, "sid"),
                    d = geByClass1("_im_dialog_" + c, t),
                    f = intval(domData(s, "spam"));
                switch (u) {
                    case "restore":
                        d && e.set(r.restoreDialog.bind(null, c, l, f)).then(function() {
                            addClass(d, "_im_dialog"), removeClass(d, "nim-dialog_deleted"), x(d, e.get().tabs[c], e, t, !1), i().updateMenu(e)
                        });
                        break;
                    case "spam":
                        var p = getLang("mail_im_dialog_marked_spam") + '\n        <button type="button" class="nim-dialog--daction nim-dialog--daction_last _im_dialog_daction"\n          data-action="restore"\n          data-spam="1"\n          data-sid="' + l + '" data-peer="' + c + '">\n            ' + getLang("mail_restore") + "\n        </button>";
                        if (d) {
                            var _ = geByClass1("_dialog_body", d);
                            val(_, p), Object(r.spamDialog)(c, l, e.get())
                        }
                        break;
                    case "block":
                        (Object(o.isCommunityInterface)(e) ? Object(o.showBlacklistBox)(c, e) : Object(o.showBlacklistBoxUser)(c, e)).once("success", function() {
                            e.set(r.flushHistory.bind(null, c)).then(function() {
                                n().restoreDialogs(e)
                            })
                        })
                }
                cancelEvent(a)
            }.bind(null, t, e, s, n),
            L = R.bind(null, n, t, e, M),
            F = function(e, t) {
                Object(o.toggleMessageRequestsTab)(e, t, r.changeDialogsTab)
            }.bind(null, t, n),
            W = Object(f.createModule)({
                handlers: function(i, a) {
                    a(e, "click", "_im_dialog_close", L), a(e, "click", "_im_dialog_markre", k), a(e, "click", y, C), a(e, "click", "_im_dialog", I), a(e, "click", o.MESSAGE_SEARCH_CLASS, D), a(e, "mouseover", "_im_dialog_close", _), a(e, "mouseover", "_im_dialog_markre", g), a(e, "click", o.CLEAR_RECENT_CLASS, function() {
                        Object(r.resetRecentSearch)(cur.imDb), G(t, M, n)
                    }), a(e, "click", o.TOGGLE_MR_TAB, F), a(e, "mouseover", y, w), a(e, "click", O, A), i(e, "mouseover", throttle(M.unhoverElements.bind(M, E), 100))
                }
            });
        return d(e, s, M, n, W)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(412),
        i = (n(96), n(63)),
        a = n(400);
    var s = window.elfocus,
        c = {
            height: "auto"
        },
        u = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onChange = function(e) {
                    r.props.onChange ? r.props.onChange(e) : r.setState({
                        value: e.target.value,
                        changed: r.props.value !== r.state.value
                    })
                }, r.onClick = function() {
                    r.setState({
                        editing: !0
                    }, function() {
                        r.textarea && s(r.textarea)
                    })
                }, r.onBlur = function() {
                    r.state.changed || r.setState({
                        editing: !1
                    })
                }, r.onSave = function() {
                    r.props.validate && !r.props.validate(r.state.value) || (r.setState({
                        editing: !1,
                        changed: !1
                    }), r.props.onSave && r.props.onSave({
                        value: r.state.value
                    }))
                }, r.onKeydown = function(e) {
                    r.state.editing && (27 === e.keyCode && (r.props.onCancel && r.props.onCancel(), r.setState({
                        editing: !1,
                        changed: !1,
                        value: r.props.value
                    }), e.preventDefault(), e.stopPropagation()), r.props.useEnter && 13 === e.keyCode && (r.onSave(), e.preventDefault(), e.stopPropagation()))
                }, r.getRef = function(e) {
                    e && e.element && (r.textarea = e.element)
                }, r.state = {
                    value: n.value,
                    editing: !1,
                    changed: !!n.onChange && n.changed
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                this.setState({
                    value: e.value,
                    changed: e.onChange ? e.changed : e.value === this.state.value
                })
            }, t.prototype.componentDidMount = function() {
                this.el = o.findDOMNode(this), this.el.addEventListener("keydown", this.onKeydown)
            }, t.prototype.componentWillUnmount = function() {
                this.el.removeEventListener("keydown", this.onKeydown)
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.className,
                    n = e.validate,
                    o = this.state,
                    s = o.editing,
                    u = o.changed,
                    l = o.value,
                    d = Object(i.classNames)("EditableLabel", {
                        "EditableLabel--editing": s,
                        "EditableLabel--changed": u,
                        "EditableLabel--invalid": n && !n(l)
                    }, t);
                return r.createElement("div", {
                    className: d
                }, s ? r.createElement(r.Fragment, null, r.createElement(a.default, {
                    className: "EditableLabel__textarea",
                    onChange: this.onChange,
                    onInput: this.onChange,
                    onPaste: this.onChange,
                    value: l,
                    onBlur: this.onBlur,
                    style: c,
                    rows: "1",
                    ref: this.getRef
                }), u && r.createElement("button", {
                    className: "EditableLabel__save",
                    onClick: this.onSave
                })) : r.createElement("div", {
                    className: "EditableLabel__text",
                    onClick: this.onClick
                }, l))
            }, t
        }(r.Component);
    t.default = u, u.defaultProps = {
        value: "",
        changed: !1,
        useEnter: !1
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return O
    });
    var r = n(256),
        o = n(1),
        i = window,
        a = i.nav,
        s = i.setStyle,
        c = i.getLang,
        u = "._im_sick_reload",
        l = "._im_sick_timer",
        d = 5e3,
        f = 6e5,
        p = 30,
        _ = 400,
        m = void 0,
        g = void 0;

    function h(e) {
        var t = ge("page_header"),
            n = window.clientHeight() - t.offsetHeight - p - 2,
            r = _;
        s(e, {
            height: Math.max(n, r)
        })
    }

    function b(e) {
        var t = Object(o.formatTimespan)(Math.floor(Math.max(e, 0) / 1e3), !0);
        return t ? c("mail_sick_timer").replace(/{timer}/gi, t) : ""
    }

    function v() {
        a.reload({
            force: !0
        })
    }

    function y(e) {
        return {
            unmount: function() {
                clearInterval(g), clearTimeout(m), Object(r.destroyModule)(e)
            }
        }
    }

    function O(e, t, n) {
        h(e);
        var o, i, a = (0, Object(r.createMutations)(y).bindMutations)(Object(r.createModule)({
                handlers: function(t, n) {
                    t(e.querySelector(u), "click", v), t(window, "resize", h.bind(null, e))
                }
            })),
            s = (o = localStorage.getItem("im_sick_timer"), i = o ? Math.min(2 * parseInt(o), f) : d, localStorage.setItem("im_sick_timer", i), i),
            c = e.querySelector(l),
            p = +new Date;
        return c.innerHTML = b(s), g = setInterval(function() {
            c.innerHTML = b(p + s - new Date)
        }, 500), m = setTimeout(v, s), a
    }
}, , , , function(e, t, n) {
    e.exports = !n(263) && !n(286)(function() {
        return 7 != Object.defineProperty(n(382)("div"), "a", {
            get: function() {
                return 7
            }
        }).a
    })
}, , , function(e, t, n) {
    "use strict";
    var r = Object.getOwnPropertySymbols,
        o = Object.prototype.hasOwnProperty,
        i = Object.prototype.propertyIsEnumerable;
    e.exports = function() {
        try {
            if (!Object.assign) return !1;
            var e = new String("abc");
            if (e[5] = "de", "5" === Object.getOwnPropertyNames(e)[0]) return !1;
            for (var t = {}, n = 0; n < 10; n++) t["_" + String.fromCharCode(n)] = n;
            if ("0123456789" !== Object.getOwnPropertyNames(t).map(function(e) {
                    return t[e]
                }).join("")) return !1;
            var r = {};
            return "abcdefghijklmnopqrst".split("").forEach(function(e) {
                r[e] = e
            }), "abcdefghijklmnopqrst" === Object.keys(Object.assign({}, r)).join("")
        } catch (e) {
            return !1
        }
    }() ? Object.assign : function(e, t) {
        for (var n, a, s = function(e) {
                if (null === e || void 0 === e) throw new TypeError("Object.assign cannot be called with null or undefined");
                return Object(e)
            }(e), c = 1; c < arguments.length; c++) {
            for (var u in n = Object(arguments[c])) o.call(n, u) && (s[u] = n[u]);
            if (r) {
                a = r(n);
                for (var l = 0; l < a.length; l++) i.call(n, a[l]) && (s[a[l]] = n[a[l]])
            }
        }
        return s
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(135),
        i = n(457),
        a = n(190),
        s = n(63),
        c = n(420),
        u = n(406),
        l = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function d(e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
    }

    function f(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }

    function p(e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
        e.prototype = Object.create(t && t.prototype, {
            constructor: {
                value: e,
                enumerable: !1,
                writable: !0,
                configurable: !0
            }
        }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
    }
    var _ = function(e) {
            function t() {
                return d(this, t), f(this, e.apply(this, arguments))
            }
            return p(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.color,
                    n = e.action,
                    i = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(e, ["color", "action"]),
                    a = t.toLowerCase().replace("default", "secondary"),
                    s = Emoji.emojiToHTML(clean(Object(c.decodeHTMLEntities)(n.label)).replace(/\n(\r)?/gi, " "), !0);
                return r.createElement(o.default, l({
                    wide: !0,
                    overflow: !0
                }, i, {
                    appearance: a,
                    dangerouslySetInnerHTML: {
                        __html: s
                    }
                }))
            }, t
        }(r.Component),
        m = function(e) {
            function t() {
                return d(this, t), f(this, e.apply(this, arguments))
            }
            return p(t, e), t.prototype.render = function() {
                var e = this,
                    t = Object(u.getCurrentKeyboard)(this.props.store);
                if (!t || !t.buttons) return null;
                return r.createElement("div", {
                    className: Object(s.classNames)("Keyboard", {
                        "Keyboard--hidden": t.hide
                    })
                }, r.createElement(i.default, {
                    className: "Keyboard__scroll-wrapper"
                }, r.createElement("div", {
                    className: "Keyboard__container"
                }, t.buttons.map(function(t, n) {
                    return r.createElement("div", {
                        key: "row-" + n,
                        className: "Keyboard__row"
                    }, t.map(function(n, o) {
                        return r.createElement("div", {
                            className: "Keyboard__button",
                            key: "row-" + o,
                            style: {
                                width: (i = t.length, "calc(100% / " + i + " - 10px)")
                            }
                        }, r.createElement(_, l({
                            onClick: function() {
                                return e.props.send(n)
                            }
                        }, n)));
                        var i
                    }))
                }))))
            }, t
        }(r.Component);
    t.default = Object(a.connect)(m)
}, function(e, t, n) {
    e.exports = n(316).document && document.documentElement
}, , , function(e, t, n) {
    "use strict";

    function r(e) {
        var t = new Date;
        return e.getFullYear() === t.getFullYear() && e.getMonth() === t.getMonth() && e.getDate() === t.getDate()
    }

    function o(e) {
        return r(new Date(e.getTime() + 864e5))
    }

    function i(e) {
        return r(new Date(e.getTime() - 864e5))
    }

    function a(e, t) {
        var n = new Date(e),
            r = new Date(t);
        return n.getFullYear() === r.getFullYear() && n.getMonth() === r.getMonth() && n.getDate() === r.getDate()
    }

    function s(e) {
        return e >= 10 ? e : "0" + e
    }

    function c(e, t) {
        var n = void 0;
        e = Math.max(e, 0);
        var r = Math.floor(e % 60);
        n = r < 10 ? "0" + r : r;
        var o = (e = Math.floor(e / 60)) % 60;
        return n = o + ":" + n, ((e = Math.floor(e / 60)) > 0 || t) && (o < 10 && (n = "0" + n), n = e + ":" + n), n
    }
    n.r(t), n.d(t, "isToday", function() {
        return r
    }), n.d(t, "isYesterday", function() {
        return o
    }), n.d(t, "isTomorrow", function() {
        return i
    }), n.d(t, "isSameDate", function() {
        return a
    }), n.d(t, "leadingZero", function() {
        return s
    }), n.d(t, "formatTime", function() {
        return c
    })
}, , , , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "chatUserHasJoined", function() {
        return l
    }), n.d(t, "chatUserHasLeft", function() {
        return d
    }), n.d(t, "handleEventChatUpdated", function() {
        return f
    });
    var r = n(1),
        o = n(406),
        i = n(252),
        a = n(272),
        s = n(112);

    function c(e, t) {
        return -1 === (e ? e.indexOf(t) : 0) && (e.push(t), !0)
    }

    function u(e, t) {
        var n = e ? e.indexOf(t) : -1;
        return -1 !== n && (e.splice(n, 1), !0)
    }

    function l(e, t, n) {
        if (Object(r.isTabLoaded)(n.get(), e)) {
            var a = Object(o.getTab)(n, e);
            c(a.memberIds, t) && a.membersCount++, -1 === a.data.active.indexOf(t) && a.data.active.push(t), t === vk.id && (a.data.kicked = 0, a.data.closed = 0)
        }
        return n.set(i.loadChatMember.bind(null, (s = {}, u = e, l = [t], u in s ? Object.defineProperty(s, u, {
            value: l,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : s[u] = l, s))).then(function(r) {
            if (t === vk.id && n.get().peer === e) return Promise.all([n.set(i.getPinnedMessage.bind(null, e)), n.set(i.loadKeyboard.bind(null, e))])
        });
        var s, u, l
    }

    function d(e, t, n, a, s) {
        if (Object(r.isTabLoaded)(a.get(), e)) {
            var c = Object(o.getTab)(a, e);
            u(c.memberIds, t) && c.membersCount--, c.data.active = c.data.active.filter(function(e) {
                return e !== t
            }), t === vk.id && (n ? c.data.kicked = 1 : c.data.closed = 1)
        }
        return t === vk.id && a.get().peer === e ? (s.cancelEditing(), a.set(i.unpinMessageOptimistic.bind(null, e))) : Promise.resolve()
    }

    function f(e, t, n, r, f, m) {
        var g = Object(o.getTab)(e, t);
        switch (n) {
            case s.MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED:
            case s.MAIL_CHAT_UPDATE_TYPE_ADMIN_KICKED:
                return n === s.MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED ? c(g.adminIds, r) : u(g.adminIds, r), p(e, t, f), !0;
            case s.MAIL_CHAT_UPDATE_TYPE_FLAGS_CHANGED:
                return g.data.flags = r, p(e, t, f), !0;
            case s.MAIL_CHAT_UPDATE_TYPE_PINNED:
                return delete g.pinHideId, cur.imDb.update(a.PIN_HIDDEN_ID_OP, [g.peerId, void 0]), !1;
            case s.MAIL_CHAT_UPDATE_TYPE_USER_JOINED:
                return l(t, r, e).then(function() {
                    return _(e, t, f, m), f.fixKeyboard()
                }), !0;
            case s.MAIL_CHAT_UPDATE_TYPE_USER_LEFT:
            case s.MAIL_CHAT_UPDATE_TYPE_USER_KICKED:
                return d(t, r, n === s.MAIL_CHAT_UPDATE_TYPE_USER_KICKED, e, f).then(function() {
                    return _(e, t, f, m)
                }), e.get().id !== r && (Object(o.getKeyboard)(e, t) || {}).author_id !== r || e.set(i.deleteKeyboard.bind(null, t)).then(function() {
                    return f.fixKeyboard()
                }), !0;
            case s.MAIL_CHAT_UPDATE_TYPE_BANNER_CHANGED:
                return e.set(i.loadBanner.bind(null, t)).then(function() {
                    return f.updateBanner(e)
                }), !0;
            case s.MAIL_CHAT_UPDATE_TYPE_KEYBOARD_CHANGED:
            case s.MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED:
                return !0;
            default:
                return !1
        }
    }

    function p(e, t, n) {
        e.get().peer === t && (Object(i.setActions)(e.get()), n.updateActions(e))
    }

    function _(e, t, n, r) {
        e.get().peer === t && (Object(i.setActions)(e.get()), n.updateChat(e, t), r.updateDialog(t, e))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return _
    });
    var r = n(256),
        o = n(356),
        i = n(252),
        a = n(1),
        s = n(192),
        c = n(406),
        u = "_im_dialogs_cog_settings",
        l = "_im_settings_action",
        d = "_im_to_unread";

    function f() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "im_settings";
        return getTemplate(e, {
            sound: ls.get("sound_notify_off") ? getLang("mail_im_sound_off") : getLang("mail_im_sound_on"),
            browser: p() ? getLang("mail_im_notifications_on") : getLang("mail_im_notifications_off")
        })
    }

    function p() {
        return DesktopNotifications.supported() && !DesktopNotifications.checkPermission() && !ls.get("im_ui_notify_off")
    }

    function _(e, t, n) {
        var _ = function(e, t) {
                showTooltip(t.target, {
                    content: f("im_settings_pop"),
                    dir: "down",
                    shift: [220, 9],
                    hasover: !0,
                    showdt: 300
                })
            }.bind(null, t),
            m = function(e, t, n, r, i) {
                var s = domData(i, "action"),
                    c = gpeByClass("_im_settings_menu", i),
                    u = hasClass(c, "_im_settings_popup") ? "im_settings_pop" : "im_settings";
                switch (s) {
                    case "spam":
                        Object(a.showSpamLayer)(e, o.mount, r);
                        break;
                    case "sound":
                        ls.get("sound_notify_off") ? ls.set("sound_notify_off", 0) : ls.set("sound_notify_off", 1), c.outerHTML = f(u);
                        break;
                    case "browser":
                        p() ? (ls.set("im_ui_notify_off", 1), c.outerHTML = f(u)) : DesktopNotifications.checkPermission() ? DesktopNotifications.requestPermission(function() {
                            c.parentNode && (c.outerHTML = f(u))
                        }) : (ls.set("im_ui_notify_off", 0), c.outerHTML = f(u))
                }
            }.bind(null, t, n, e),
            g = function(e, r) {
                if (Object(a.showUnreadOnly)(t, n, i.changeDialogsTab)) {
                    var o = t.get().active_tab === s.FOLDER_UNREAD;
                    val(r, getTemplate("im_filter", {
                        filter: o ? getLang("mail_to_all_dialogs") : getLang("mail_to_unread")
                    }))
                }
            },
            h = Object(r.createModule)({
                handlers: function(t, n) {
                    n(e, "mouseover", u, _), n(e, "click", l, m), n(e, "click", d, g)
                }
            });
        return function(e, t) {
            return {
                updateFilter: function(t) {
                    var n = t.get().active_tab === s.FOLDER_UNREAD,
                        r = void 0,
                        o = [];
                    Object(c.isSearching)(t) && o.push("im-page--dialogs-filter_hidden"), t.get().unread_cnt > 0 ? r = n ? getLang("mail_to_all_dialogs") : getLang("mail_to_unread") : (r = getLang("mail_all_dialogs"), o.push("im-page--dialogs-filter_disabled")), val(geByClass1(d, e), getTemplate("im_filter", {
                        filter: r,
                        cls: o.join(" ")
                    }))
                },
                toggleButton: function(t, n) {
                    var r = geByClass1("im-page--dialogs-filter", e);
                    toggleClass(r, "im-page--dialogs-filter_hidden", n)
                },
                toggleLoader: function(t, n) {
                    var r = geByClass1(u, e);
                    toggleClass(r, "im-page--dialogs-settings_loading", n)
                },
                updateSettings: function(t) {
                    geByClass1("_im_settings_menu", e).outerHTML = f()
                },
                unmount: function() {
                    Object(r.destroyModule)(t)
                }
            }
        }(e, h)
    }
}, , function(e, t, n) {
    "use strict";
    var r = function(e) {};
    e.exports = function(e, t, n, o, i, a, s, c) {
        if (r(t), !e) {
            var u;
            if (void 0 === t) u = new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");
            else {
                var l = [n, o, i, a, s, c],
                    d = 0;
                (u = new Error(t.replace(/%s/g, function() {
                    return l[d++]
                }))).name = "Invariant Violation"
            }
            throw u.framesToPop = 1, u
        }
    }
}, , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "TemplatesDropDown", function() {
        return l
    });
    var r = n(451),
        o = (n(96), n(457)),
        i = n(409),
        a = n(190),
        s = n(389),
        c = n(63);
    var u = i.default.getLang,
        l = function(e) {
            function t() {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                for (var n = arguments.length, r = Array(n), o = 0; o < n; o++) r[o] = arguments[o];
                var i = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call.apply(e, [this].concat(r)));
                return i.elementOnClick = function(e, t) {
                    t.preventDefault(), t.stopPropagation(), i.props.applyTemplate(e), i.toggleDropdown(!1)
                }, i.toggleDropdown = function(e) {
                    i.setState({
                        isShowDropDown: e
                    })
                }, i.state = {
                    isShowDropDown: !1
                }, i
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.getTemplates,
                    i = t.showSettingsPopup,
                    a = t.showCreatingTemplatePopup,
                    l = t.isNeededRendering,
                    d = this.state.isShowDropDown;
                if (!l()) return null;
                var f = n();
                return r.createElement("div", {
                    className: "TemplatesDropDown",
                    onMouseOver: this.toggleDropdown.bind(this, !0),
                    onMouseOut: this.toggleDropdown.bind(this, !1)
                }, r.createElement("div", {
                    className: Object(c.classNames)("TemplatesDropDown__wrapper", {
                        "TemplatesDropDown__wrapper--show": d
                    }),
                    "aria-hidden": d
                }, r.createElement("div", {
                    className: "TemplatesDropDown__container"
                }, r.createElement(o.default, {
                    className: "TemplatesDropDown__scroll-wrapper"
                }, r.createElement("div", null, " ", r.createElement("header", {
                    className: "TemplatesDropDown__header"
                }, r.createElement("h2", {
                    className: "TemplatesDropDown__title"
                }, u("mail_community_templates")), r.createElement("a", {
                    role: "button",
                    className: "TemplatesDropDown__setting-button",
                    onClick: i
                }, u("mail_settings_configure"))), f.length ? r.createElement("ul", {
                    className: "TemplatesDropDown__list"
                }, f.map(function(t) {
                    return r.createElement("li", {
                        key: t.id,
                        className: "TemplatesDropDown__item",
                        onMouseDown: e.elementOnClick.bind(null, t.id)
                    }, r.createElement("h3", {
                        className: "TemplatesDropDown__item-name",
                        dangerouslySetInnerHTML: {
                            __html: t.name
                        }
                    }), r.createElement("div", {
                        className: "TemplatesDropDown__item-content",
                        dangerouslySetInnerHTML: {
                            __html: t.text
                        }
                    }))
                })) : r.createElement("div", {
                    className: "TemplatesDropDown__not-found-container"
                }, r.createElement("span", null, u("mail_community_templates_not_found")), r.createElement(s.default, {
                    onClick: a
                }, u("mail_add_community_template"))))))), r.createElement("button", {
                    className: "TemplatesDropDown__icon"
                }))
            }, t
        }(r.Component);
    t.default = Object(a.connect)(l)
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "KEY", function() {
        return a
    }), n.d(t, "addEvent", function() {
        return s
    }), n.d(t, "removeEvent", function() {
        return c
    }), n.d(t, "triggerEvent", function() {
        return u
    }), n.d(t, "cancelEvent", function() {
        return l
    }), n.d(t, "stopEvent", function() {
        return d
    }), n.d(t, "normEvent", function() {
        return f
    }), n.d(t, "checkEvent", function() {
        return p
    }), n.d(t, "checkKeyboardEvent", function() {
        return _
    }), n.d(t, "checkOver", function() {
        return m
    });
    var r = n(347),
        o = n(269),
        i = n(324),
        a = {
            LEFT: 37,
            UP: 38,
            RIGHT: 39,
            DOWN: 40,
            DEL: 8,
            TAB: 9,
            RETURN: 13,
            ENTER: 13,
            ESC: 27,
            PAGEUP: 33,
            PAGEDOWN: 34,
            SPACE: 32,
            CTRL: 17,
            ALT: 18,
            SHIFT: 16
        };

    function s(e, t, n, i, a, s) {
        if ((e = Object(r.ge)(e)) && 3 != e.nodeType && 8 != e.nodeType) {
            var c, u = a ? ((c = function(e) {
                var t = e.data;
                e.data = a;
                var r = n.apply(this, [e]);
                return e.data = t, r
            }).handler = n, c) : n;
            e.setInterval && e !== window && (e = window);
            var d = Object(r.data)(e, "events") || Object(r.data)(e, "events", {}),
                p = Object(r.data)(e, "handle") || Object(r.data)(e, "handle", function(e) {
                    return function() {
                        (function(e) {
                            e = f(e);
                            var t = Array.from(arguments);
                            t[0] = e;
                            var n = Object(r.data)(this, "events");
                            if (!n || "string" != typeof e.type || !n[e.type] || !n[e.type].length) return;
                            var o = (n[e.type] || []).slice();
                            for (var i in o)
                                if (o.hasOwnProperty(i)) {
                                    if ("mouseover" === e.type || "mouseout" === e.type) {
                                        for (var a = e.relatedElement; a && a !== this;) a = a.parentNode;
                                        if (a === this) continue
                                    }
                                    var s = o[i].apply(this, t);
                                    if (!1 !== s && -1 !== s || l(e), -1 === s) return !1
                                }
                        }).apply(e, arguments)
                    }
                }(e));
            Object(o.each)(t.split(/\s+/), function(t, n) {
                d[n] || (d[n] = [], !i && e.addEventListener ? e.addEventListener(n, p, s) : !i && e.attachEvent && e.attachEvent("on" + n, p)), d[n].push(u)
            })
        }
    }

    function c(e, t, n, i) {
        if (void 0 === i && (i = !1), e = Object(r.ge)(e)) {
            var a = Object(r.data)(e, "events");
            if (a)
                if ("string" == typeof t) Object(o.each)(t.split(/\s+/), function(t, s) {
                    if (Object(o.isArray)(a[s])) {
                        var c = a[s].length;
                        if (Object(o.isFunction)(n)) {
                            for (var u = c - 1; u >= 0; u--)
                                if (a[s][u] && (a[s][u] === n || a[s][u].handler === n)) {
                                    a[s].splice(u, 1), c--;
                                    break
                                }
                        } else {
                            for (var l = 0; l < c; l++) delete a[s][l];
                            c = 0
                        }
                        c || (e.removeEventListener ? e.removeEventListener(s, Object(r.data)(e, "handle"), i) : e.detachEvent && e.detachEvent("on" + s, Object(r.data)(e, "handle")), delete a[s])
                    }
                }), Object(o.isEmpty)(a) && (Object(r.removeData)(e, "events"), Object(r.removeData)(e, "handle"));
                else
                    for (var s in a) a.hasOwnProperty(s) && c(e, s)
        }
    }

    function u(e, t, n, i) {
        e = Object(r.ge)(e);
        var a = Object(r.data)(e, "handle");
        if (a) {
            var s = function() {
                return a.call(e, Object(o.extend)(n || {}, {
                    type: t,
                    target: e
                }))
            };
            i ? s() : setTimeout(s, 0)
        }
    }

    function l(e) {
        if (!(e = e || window.event)) return !1;
        for (; e.originalEvent;) e = e.originalEvent;
        return e.preventDefault && e.preventDefault(), e.stopPropagation && e.stopPropagation(), e.stopImmediatePropagation && e.stopImmediatePropagation(), e.cancelBubble = !0, e.returnValue = !1, !1
    }

    function d(e) {
        if (!(e = e || window.event)) return !1;
        for (; e.originalEvent;) e = e.originalEvent;
        return e.stopPropagation && e.stopPropagation(), e.cancelBubble = !0, !1
    }

    function f(e) {
        var t = e = e || window.event;
        if ((e = Object(o.clone)(t)).originalEvent = t, e.target || (e.target = e.srcElement || document), 3 == e.target.nodeType && (e.target = e.target.parentNode), !e.relatedTarget && e.fromElement && (e.relatedTarget = e.fromElement === e.target), null == e.pageX && null != e.clientX) {
            var n = document.documentElement,
                r = bodyNode;
            e.pageX = e.clientX + (n && n.scrollLeft || r && r.scrollLeft || 0) - (n.clientLeft || 0), e.pageY = e.clientY + (n && n.scrollTop || r && r.scrollTop || 0) - (n.clientTop || 0)
        }
        return !e.which && (e.charCode || 0 === e.charCode ? e.charCode : e.keyCode) && (e.which = e.charCode || e.keyCode), !e.metaKey && e.ctrlKey ? e.metaKey = e.ctrlKey : !e.ctrlKey && e.metaKey && i.browser.mac && (e.ctrlKey = e.metaKey), !e.which && e.button && (e.which = 1 & e.button ? 1 : 2 & e.button ? 3 : 4 & e.button ? 2 : 0), e
    }

    function p(e) {
        var t = e || window.event;
        return t && ("click" === t.type || "mousedown" === t.type || "mouseup" === t.type) && (t.which > 1 || t.button > 1 || t.ctrlKey || t.shiftKey || i.browser.mac && t.metaKey) || !1
    }

    function _(e) {
        if (!(e = f(e)) || !e.target) return !1;
        if (!e.screenX) return !0;
        var t = Object(r.getSize)(e.target),
            n = Object(r.getXY)(e.target),
            o = e.pageX - n[0],
            i = e.pageY - n[1];
        return o < -1 || o > t[0] + 1 || i < -1 || i > t[1] + 1 || Math.abs(e.pageX - n[0] - t[0] / 2) < 1 && Math.abs(e.pageY - n[1] - t[1] / 2) < 1
    }

    function m(e, t) {
        if (!e) return !0;
        e = e.originalEvent || e, t = t || e.target;
        var n = e.fromElement || e.relatedTarget;
        if (!n || n === t || n === t.parentNode) return !0;
        for (; n !== t && n.parentNode && n.parentNode !== bodyNode;) n = n.parentNode;
        return n !== t
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createIdMap", function() {
        return p
    }), n.d(t, "addElements", function() {
        return _
    }), n.d(t, "collapseOps", function() {
        return g
    }), n.d(t, "distance", function() {
        return h
    }), n.d(t, "mount", function() {
        return E
    });
    var r = n(1),
        o = n(187),
        i = n(260),
        a = n(256);

    function s(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }

    function c(e, t) {
        return Object(o.toArray)(e).find(function(e) {
            return domData(e, "list-id") === t
        })
    }

    function u(e, t) {
        return Object(o.toArray)(e).findIndex(function(e) {
            return domData(e, "list-id") === t
        })
    }

    function l(e, t, n, r) {
        if (n) {
            d(e, t, r);
            var o = domData(n, "list-id"),
                i = o && c(t.children, o);
            i && r.forEach(function(e) {
                return addClass(i, e)
            }), e.setState({
                hoveredListItemId: o
            })
        }
    }

    function d(e, t, n) {
        var r = domQuery("." + n.join("."), t);
        r && Object(o.toArray)(r).forEach(function(e) {
            n.forEach(function(t) {
                return removeClass(e, t)
            })
        }), e.setState({
            hoveredListItemId: null
        })
    }

    function f(e, t) {
        var n = t && domQuery("." + t.join("."), e)[0];
        return n ? domData(n, "list-id") : null
    }

    function p(e, t, n) {
        return e.map(t).reduce(function(e, t) {
            return e[t] = !0, e
        }, n)
    }

    function _(e, t, n) {
        var r = e.filter(function(e) {
            return !n.ids[t(e)]
        });
        return {
            _sortedEls: !1,
            els: r,
            ids: p(r, t, n.ids),
            elements: n.elements.concat(r)
        }
    }

    function m(e, t, n) {
        return {
            ids: p(n.get().elements, e, {}),
            scrolls: t,
            activated: !0
        }
    }

    function g(e) {
        var t = {};
        return e.forEach(function(e) {
            "r" === e[0] && t["a," + e[1]] ? delete t["a," + e[1]] : t[e[0] + "," + e[1]] = e
        }), Object.keys(t).map(function(e) {
            return t[e]
        })
    }

    function h(e, t) {
        for (var n = [], r = Math.max(e.length, t.length), o = 0; o < r; o++) {
            var i = e[o],
                a = t[o];
            !i && a ? n.push(["a", a, o]) : i && !a ? n.push(["r", i, o]) : i !== a && (n.push(["r", i, o]), n.push(["a", a, o]))
        }
        var s = g(n),
            c = g(n.reverse());
        return s.length > c.length ? c : s
    }

    function b(e, t, n, r, o, i) {
        for (var a = 0; a < r; a++) e = domNS(e);
        var s = se(o(t));
        return domData(s, "list-id", n), e ? i.insertBefore(s, e) : i.appendChild(s), e
    }

    function v(e, t, n, r, i) {
        var a = r.get(),
            s = a.limit,
            c = a.offset,
            u = function(e, t) {
                var n = t.get();
                return !n._sortedEls && e && t.setState({
                    elements: n.elements.sort(e),
                    _sortedEls: !0
                }), t.get().elements
            }(n().sortFn, r).slice(0, c + s),
            l = h(Object(o.toArray)(e.children).map(function(e) {
                return domData(e, "list-id")
            }).filter(function(e) {
                return !!e
            }), u.map(function(e) {
                return n().idFn(e).toString()
            }));
        if (function(e, t, n, r) {
                if (0 !== t.length) {
                    var o = (t = t.sort(function(e, t) {
                        return e[2] - t[2]
                    })).filter(function(e) {
                        return "a" === e[0]
                    });
                    if (t.filter(function(e) {
                            return "r" === e[0]
                        }).map(function(t) {
                            return e.children[t[2]]
                        }).forEach(function(e) {
                            return re(e)
                        }), 0 !== o.length)
                        for (var i = o.shift(), a = i[2], s = (b(e.children[a], n[i[2]], i[1], 0, r, e), 0); s < o.length; s++) i = o[s], b(e.children[a], n[i[2]], i[1], i[2] - a, r, e), a = i[2]
                }
            }(e, l, u, n().renderFn), function(e, t) {
                e.get().loading ? t.update(!1, !0) : (e.get().loading = !0, t.update(!1, !0), e.get().loading = !1)
            }(r, t), i) return l.filter(function(e) {
            return "a" == e[0]
        }).map(function(e) {
            return parseInt(e[1])
        })
    }

    function y(e, t, n, r) {
        var o = arguments.length > 4 && void 0 !== arguments[4] && arguments[4],
            i = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 0,
            a = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0,
            s = e.get(),
            c = t.getContainer().children,
            l = u(c, r || s.hoveredListItemId);
        if (!(l < 0)) {
            (s.limit + s.offset < l ? e.setState({
                offset: l - s.limit + 1
            }).then(v.bind(null, t.getContainer(), t, n)) : Promise.resolve()).then(function() {
                var e = c[l],
                    n = t.scrollTop(),
                    r = t.getScrollHeight(),
                    s = e.offsetHeight;
                i = "center" === i ? -.5 * t.getScrollHeight() : i, a = "center" === a ? r / 2 : a;
                var u = o ? function(e) {
                        t.smoothScroll(e - t.scrollTop())
                    } : t.scrollTop.bind(t),
                    d = n + i > e.offsetTop,
                    f = s + e.offsetTop > n + r - a;
                d ? u(e.offsetTop - i) : f && u(e.offsetTop - r + s + a)
            })
        }
    }

    function O(e, t) {
        var n = e.get().pipeId;
        return !(void 0 !== n && void 0 !== t && n !== t)
    }

    function w(e, t, n, r, o, i) {
        return !!O(e, o) && e.setState(_(i, r().idFn, e.get())).then(v.bind(null, t, n, r))
    }

    function E(e, t, n) {
        var _ = function(e, t) {
                if (e.get().loading || e.get().stop || !e.get().activated) return Promise.resolve([]);
                e.get().loading = !0;
                for (var n = arguments.length, r = Array(n > 2 ? n - 2 : 0), o = 2; o < n; o++) r[o - 2] = arguments[o];
                return t.apply(void 0, r).then(function() {
                    e.get().loading = !1
                })
            }.bind(null, t, function(e, t, n, o) {
                var i = e.get(),
                    a = i.elements,
                    s = o.getContainer(),
                    c = e.setState({
                        offset: i.offset + i.limit
                    }).then(function() {
                        var n = i.offset,
                            r = i.limit,
                            c = void 0;
                        return r + n > a.length ? c = t().more(n, r).then(function(t) {
                            return !1 === t ? [] : (0 === t.length && e.setState({
                                stop: !0
                            }), t)
                        }).then(w.bind(null, e, s, o, t, i.pipeId)) : (c = Promise.resolve(), v(s, o, t, e)), c
                    });
                if (!n) {
                    var u = a.length > 0 ? "im-preloader_fixed-bottom" : "im-preloader_fixed-center";
                    Object(r.wrapLoading)(s)(c, "bottom", u)
                }
                return c
            }.bind(null, t, n)),
            g = function(e, r) {
                (t.get().activated || e) && (void 0 !== r && t.get().elements.length > 0 && t.setState({
                    scrolled: r
                }), n().onScroll && n().onScroll())
            },
            h = Object(i.createScroll)(e, {
                noScroll: t.get().noScroll,
                nativeScroll: t.get().nativeScroll,
                scrollChange: g.bind(null, !1),
                more: !!n().more && _.bind(null, !1)
            }),
            b = Object(a.createModule)({
                handlers: function(r, o) {
                    o(e, "click", t.get().elCls, n().onClick)
                }
            });
        return t.setState(m(n().idFn, {}, t)), {
            pipe: function(e, r) {
                return t.setState({
                    pipeId: r
                }), e.then(w.bind(null, t, h.getContainer(), h, n, r))
            },
            replacePreserveOrder: function(e) {
                return t.set(function(e, t, n) {
                    var r = [];
                    n.elements = n.elements.map(function(n) {
                        var o = t(n),
                            i = e.filter(function(e) {
                                return t(e) === o
                            })[0];
                        return r.push(o), i || n
                    });
                    var o = e.filter(function(e) {
                        return !inArray(t(e), r)
                    });
                    return n.elements = n.elements.concat(o), Promise.resolve(n)
                }.bind(null, e, n().idFn)).then(v.bind(null, h.getContainer(), h, n))
            },
            pipeReplace: function(e, r) {
                var o = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                return t.setState({
                    pipeId: r,
                    stop: !1
                }), e.then(function(e) {
                    if (O(t, r)) return t.setState({
                        elements: e,
                        _sortedEls: !1,
                        ids: p(e, n().idFn, {})
                    }).then(v.bind(null, h.getContainer(), h, n, t, o))
                })
            },
            wipe: function() {
                h.getContainer().innerHTML = ""
            },
            deactivate: function() {
                t.setState({
                    activated: !1
                })
            },
            activate: function() {
                t.setState({
                    activated: !0
                })
            },
            saveScroll: function(e, n) {
                return t.set(function(e, t, n) {
                    return n.scrolls || (n.scrolls = {}), n.scrolls[e] && !t || (n.scrolls[e] = {
                        scrolled: n.scrolled || 0,
                        scrollItem: n.scrollItem
                    }), Promise.resolve(n)
                }.bind(null, e, n))
            },
            updateScroll: function() {
                h.update(!1, !0)
            },
            toTop: function(e) {
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1] ? h.smoothScroll(-h.scrollTop()) : h.scrollTop(0), e && g(e, 0)
            },
            scrollTop: function(e) {
                return h.scrollTop(e)
            },
            restoreScroll: function(e) {
                var n = t.get().scrolls,
                    r = n[e];
                return r && (t.setState({
                    scrolls: extend({}, n, s({}, e, null))
                }), h.scrollTop(r.scrolled)), !!r
            },
            unsetScroll: function(e) {
                t.setState({
                    scrolls: extend({}, t.get().scrolls, s({}, e, null))
                })
            },
            scrollPage: function(e, t) {
                var n = h.scroll.scroller,
                    r = h.scrollTop(),
                    o = r + ("up" === e ? -1 : 1) * n.clientHeight;
                t ? h.smoothScroll(o - r) : h.scrollTop(o)
            },
            scrollToElement: function(e, r, o, i) {
                y(t, h, n, e, r, o, i)
            },
            checkMore: function(e) {
                return t.get().elements.length < t.get().limit ? _(e, h) : Promise.resolve([])
            },
            add: function(e, r) {
                return w(t, h.getContainer(), h, n, r, e)
            },
            hoverNextElement: function(e, r) {
                var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    a = h.getContainer(),
                    s = a.children,
                    c = u(s, t.get().hoveredListItemId || f(a, r)),
                    d = Object(o.toArray)(s).slice(c + 1).find(n().hoverableFn);
                l(t, a, d, e), y(t, h, n, null, !1, i.top, i.bottom)
            },
            hoverPrevElement: function(e, r) {
                var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                    a = h.getContainer(),
                    s = a.children,
                    c = u(s, t.get().hoveredListItemId || f(a, r)),
                    d = c >= 0 && Object(o.toArray)(s).slice(0, c).reverse().find(n().hoverableFn);
                l(t, a, d, e), y(t, h, n, null, !1, i.top, i.bottom)
            },
            hoverFirstElement: function(e, r) {
                var i = h.getContainer(),
                    a = i.children,
                    s = Object(o.toArray)(a).findIndex(n().hoverableFn),
                    c = a[s];
                !t.get().hoveredListItemId && c && (l(t, i, c, e), y(t, h, n, s, !1, r.top, r.bottom))
            },
            hoverElement: function(e, r, o) {
                var i = h.getContainer(),
                    a = i.children,
                    s = u(a, e),
                    c = a[s];
                c && (l(t, i, c, r), y(t, h, n, s, !1, o.top, o.bottom))
            },
            unhoverElements: function(e) {
                d(t, h.getContainer(), e)
            },
            reset: function() {
                var e = t.get().scrolls;
                t.reset(), t.setState(m(n().idFn, e, t))
            },
            getHoveredElement: function() {
                return c(h.getContainer().children, t.get().hoveredListItemId)
            },
            getCurrentElements: function() {
                return t.get().elements
            },
            isLoading: function() {
                return t.get().loading
            },
            isEmpty: function() {
                return 0 === t.get().elements.length
            },
            remove: function(e) {
                t.set(function(e, t, n) {
                    return n.elements = n.elements.filter(function(n) {
                        return t(n) !== e
                    }), delete n.ids[e], Promise.resolve(n)
                }.bind(null, e, n().idFn)).then(v.bind(null, h.getContainer(), h, n))
            },
            unmount: function() {
                Object(a.destroyModule)(b), h.destroy()
            }
        }
    }
}, , , , , function(e, t) {
    e.exports = function(e) {
        if (void 0 == e) throw TypeError("Can't call method on  " + e);
        return e
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63)),
        i = n(389);
    var a = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.onError = function() {
                r.setState({
                    errored: !0
                })
            }, r.state = {}, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.getPhotoImage = function() {
            var e = this.props,
                t = e.size,
                n = e.photo,
                o = e.title;
            return r.createElement("img", {
                width: t,
                height: t,
                src: this.state.errored ? "/images/camera_c.gif" : n,
                alt: o,
                onError: this.onError,
                className: "Entity__photo"
            })
        }, t.prototype.render = function() {
            var e, t, n, a = this.props,
                s = a.className,
                c = a.style,
                u = a.size,
                l = a.photo,
                d = a.href,
                f = a.title,
                p = a.description,
                _ = a.target,
                m = (n = !!u, (t = "Entity--size" + u) in (e = {}) ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e);
            return r.createElement("div", {
                className: Object(o.classNames)("Entity", s, m),
                style: c
            }, r.createElement("div", {
                className: "Entity__aside"
            }, "string" == typeof l ? d ? r.createElement("a", {
                href: d
            }, this.getPhotoImage()) : this.getPhotoImage() : l), r.createElement("div", {
                className: "Entity__main"
            }, f && d ? r.createElement("div", {
                className: "Entity__title"
            }, r.createElement(i.default, {
                href: d,
                dangerouslySetInnerHTML: {
                    __html: f
                },
                target: _
            })) : r.createElement("div", {
                className: "Entity__title",
                dangerouslySetInnerHTML: {
                    __html: f
                }
            }), "string" != typeof p ? r.createElement("div", {
                className: "Entity__description"
            }, p) : r.createElement("div", {
                className: "Entity__description",
                dangerouslySetInnerHTML: {
                    __html: p
                }
            })))
        }, t
    }(r.PureComponent);
    t.default = a, a.defaultProps = {
        size: null,
        photo: "",
        title: "",
        description: "",
        href: "",
        target: null
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(409),
        i = n(135),
        a = n(362),
        s = n(210);
    var c = o.default.getLang,
        u = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onConfirm = function() {
                    r.state.loading || (r.setState({
                        loading: !0
                    }), r.props.onConfirm().then(function() {
                        r.setState({
                            loading: !1
                        }), r.props.onCancel()
                    }).catch(function() {
                        return r.setState({
                            loading: !1
                        })
                    }))
                }, r.state = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                return r.createElement("div", {
                    className: "ChatSettingsResetInvitationLink"
                }, r.createElement("div", {
                    className: "ChatSettingsResetInvitationLink__text",
                    dangerouslySetInnerHTML: {
                        __html: c("mail_chat_reset_link_warning")
                    }
                }), r.createElement(s.default, {
                    alignment: "right"
                }, r.createElement(i.default, {
                    appearance: "tertiary",
                    onClick: this.props.onCancel
                }, c("global_cancel")), r.createElement(a.default, {
                    onClick: this.onConfirm,
                    loading: this.state.loading
                }, c("mail_chat_reset_link_confirm"))))
            }, t
        }(r.Component);
    t.default = u
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63));
    var i = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.onError = function() {
                r.setState({
                    errored: !0
                })
            }, r.state = {}, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.photo,
                n = e.title,
                i = e.online;
            return r.createElement("div", {
                className: Object(o.classNames)("Avatar", {
                    "Avatar--online": i,
                    "Avatar--mobile": mobPlatforms[i]
                })
            }, r.createElement("div", {
                className: "Avatar__wrapper"
            }, r.createElement("img", {
                onError: this.onError,
                className: "Avatar__img",
                src: this.state.errored ? "/images/camera_c.gif" : t,
                alt: n
            })))
        }, t
    }(r.Component);
    t.default = i
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return i
    });
    var r = n(451),
        o = (n(96), n(63));

    function i(e) {
        return r.createElement("header", {
            className: Object(o.classNames)("PopupHeader", e.className),
            style: e.style
        }, e.back && r.createElement("div", {
            className: "PopupHeader__back",
            onClick: e.onBackClick
        }, r.createElement("button", {
            className: "PopupHeader__backBtn",
            onClick: e.onBackClick
        }, e.back)), r.createElement("h2", {
            className: "PopupHeader__title"
        }, e.title), r.createElement("div", {
            className: "PopupHeader__close"
        }, r.createElement("button", {
            className: "PopupHeader__closeBtn",
            onClick: e.onCloseClick
        })))
    }
    i.defaultProps = {
        back: null,
        title: "",
        onCloseClick: function() {}
    }
}, , function(e, t, n) {
    var r = n(64),
        o = n(151)("iterator"),
        i = n(67);
    e.exports = n(230).getIteratorMethod = function(e) {
        if (void 0 != e) return e[o] || e["@@iterator"] || i[r(e)]
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "classNames", function() {
        return o
    });
    var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
        return typeof e
    } : function(e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
    };

    function o() {
        var e = [];
        return [].concat(Array.prototype.slice.call(arguments)).forEach(function(t) {
            if (t) switch (void 0 === t ? "undefined" : r(t)) {
                case "string":
                    e.push(t);
                    break;
                case "object":
                    Object.keys(t).forEach(function(n) {
                        t[n] && e.push(n)
                    });
                    break;
                default:
                    e.push("" + t)
            }
        }), e.join(" ")
    }
}, function(e, t, n) {
    var r = n(405),
        o = n(151)("toStringTag"),
        i = "Arguments" == r(function() {
            return arguments
        }());
    e.exports = function(e) {
        var t, n, a;
        return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof(n = function(e, t) {
            try {
                return e[t]
            } catch (e) {}
        }(t = Object(e), o)) ? n : i ? r(t) : "Object" == (a = r(t)) && "function" == typeof t.callee ? "Arguments" : a
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "oCacheExists", function() {
        return o
    }), n.d(t, "oCacheGet", function() {
        return i
    }), n.d(t, "oCacheAdd", function() {
        return a
    });
    var r = n(187);

    function o(e, t) {
        return t in Object(r.unpackStore)(e).oCache
    }

    function i(e, t) {
        var n = Object(r.unpackStore)(e).oCache[t];
        return n && !n._n && (! function(e) {
            if (!e.first_name) {
                var t = e.name.split(" ", 2);
                e.first_name = t[0], e.short_name = t[1] ? t[0] + " " + t[1].substr(0, 1) + "." : t[0]
            }
            e.inv_name || (e.inv_name = e.name), e.kick_name || (e.kick_name = e.inv_name)
        }(n), n._n = 1), n
    }

    function a(e, t) {
        var n = Object(r.unpackStore)(e);
        n.oCache || (n.oCache = {}), t.id && (n.oCache[t.id] = t)
    }
}, function(e, t) {
    e.exports = {}
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return w
    });
    var r = n(256),
        o = n(451),
        i = n(412),
        a = n(209),
        s = n(252),
        c = n(406),
        u = n(187),
        l = window,
        d = l.MessageBox,
        f = l.show,
        p = l.hide,
        _ = l.isVisible,
        m = l.boxRefreshCoords,
        g = void 0;

    function h(e) {
        var t = y();
        t && i.render(o.createElement(a.default, {
            store: e,
            closePopup: b,
            updatePopup: v
        }), t)
    }

    function b() {
        g && g.hide()
    }

    function v() {
        g && g.updateBoxCoords()
    }

    function y() {
        return document.querySelector("#ChatSettings")
    }

    function O(e) {
        var t = document.querySelector("#box_layer_wrap"),
            n = document.querySelector("#box_loader"),
            o = _(t);
        return {
            unmount: function() {
                var t = y();
                t && i.unmountComponentAtNode(t), Object(r.destroyModule)(e)
            },
            showLoader: function() {
                m(n), f(n), o || f(t)
            },
            hideLoader: function() {
                p(n), o || p(t)
            }
        }
    }

    function w(e, t, n) {
        var o = Object(r.createMutations)(O).bindMutations,
            i = t.get(),
            a = Object(r.createModule)({
                handlers: function(e, t) {}
            }),
            l = i.peer,
            f = o(a);
        var p = function(e, t) {
                t.get().peer === l ? function(e) {
                    var t = Object(c.getTab)(e, e.get().peer);
                    t && t.data && !t.data.closed && !t.data.kicked ? h(e) : b()
                }(t) : e.unmount()
            }.bind(null, f),
            _ = {
                hideButtons: !0,
                bodyStyle: "padding: 0; background: none;",
                width: 560,
                onShow: function() {
                    h(t), t.subscribe(p), requestAnimationFrame(function() {
                        return g.updateBoxCoords()
                    })
                },
                onHideAttempt: function() {
                    return t.unsubscribe(p), f.unmount(), !0
                }
            };
        return f.showLoader(), t.set(s.getChatDetails.bind(null, l)).then(function(e) {
            f.hideLoader();
            var t = Object(u.unpackStore)(e).peer;
            t && t === l ? g = new d(_).content('<div id="ChatSettings" class="ChatSettingsWrapper"></div>').show() : f.unmount()
        }), f
    }
}, function(e, t, n) {
    "use strict";
    var r = n(38),
        o = n(451),
        i = n(345),
        a = n(23),
        s = n(247),
        c = n(156),
        u = n(374),
        l = n(289),
        d = n(198);

    function f(e) {
        for (var t = arguments.length - 1, n = "https://reactjs.org/docs/error-decoder.html?invariant=" + e, o = 0; o < t; o++) n += "&args[]=" + encodeURIComponent(arguments[o + 1]);
        r(!1, "Minified React error #" + e + "; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ", n)
    }
    o || f("227");
    var p = {
        _caughtError: null,
        _hasCaughtError: !1,
        _rethrowError: null,
        _hasRethrowError: !1,
        invokeGuardedCallback: function(e, t, n, r, o, i, a, s, c) {
            (function(e, t, n, r, o, i, a, s, c) {
                this._hasCaughtError = !1, this._caughtError = null;
                var u = Array.prototype.slice.call(arguments, 3);
                try {
                    t.apply(n, u)
                } catch (e) {
                    this._caughtError = e, this._hasCaughtError = !0
                }
            }).apply(p, arguments)
        },
        invokeGuardedCallbackAndCatchFirstError: function(e, t, n, r, o, i, a, s, c) {
            if (p.invokeGuardedCallback.apply(this, arguments), p.hasCaughtError()) {
                var u = p.clearCaughtError();
                p._hasRethrowError || (p._hasRethrowError = !0, p._rethrowError = u)
            }
        },
        rethrowCaughtError: function() {
            return function() {
                if (p._hasRethrowError) {
                    var e = p._rethrowError;
                    throw p._rethrowError = null, p._hasRethrowError = !1, e
                }
            }.apply(p, arguments)
        },
        hasCaughtError: function() {
            return p._hasCaughtError
        },
        clearCaughtError: function() {
            if (p._hasCaughtError) {
                var e = p._caughtError;
                return p._caughtError = null, p._hasCaughtError = !1, e
            }
            f("198")
        }
    };
    var _ = null,
        m = {};

    function g() {
        if (_)
            for (var e in m) {
                var t = m[e],
                    n = _.indexOf(e);
                if (-1 < n || f("96", e), !b[n])
                    for (var r in t.extractEvents || f("97", e), b[n] = t, n = t.eventTypes) {
                        var o = void 0,
                            i = n[r],
                            a = t,
                            s = r;
                        v.hasOwnProperty(s) && f("99", s), v[s] = i;
                        var c = i.phasedRegistrationNames;
                        if (c) {
                            for (o in c) c.hasOwnProperty(o) && h(c[o], a, s);
                            o = !0
                        } else i.registrationName ? (h(i.registrationName, a, s), o = !0) : o = !1;
                        o || f("98", r, e)
                    }
            }
    }

    function h(e, t, n) {
        y[e] && f("100", e), y[e] = t, O[e] = t.eventTypes[n].dependencies
    }
    var b = [],
        v = {},
        y = {},
        O = {};

    function w(e) {
        _ && f("101"), _ = Array.prototype.slice.call(e), g()
    }

    function E(e) {
        var t, n = !1;
        for (t in e)
            if (e.hasOwnProperty(t)) {
                var r = e[t];
                m.hasOwnProperty(t) && m[t] === r || (m[t] && f("102", t), m[t] = r, n = !0)
            }
        n && g()
    }
    var C = {
            plugins: b,
            eventNameDispatchConfigs: v,
            registrationNameModules: y,
            registrationNameDependencies: O,
            possibleRegistrationNames: null,
            injectEventPluginOrder: w,
            injectEventPluginsByName: E
        },
        j = null,
        k = null,
        T = null;

    function S(e, t, n, r) {
        t = e.type || "unknown-event", e.currentTarget = T(r), p.invokeGuardedCallbackAndCatchFirstError(t, n, void 0, e), e.currentTarget = null
    }

    function M(e, t) {
        return null == t && f("30"), null == e ? t : Array.isArray(e) ? Array.isArray(t) ? (e.push.apply(e, t), e) : (e.push(t), e) : Array.isArray(t) ? [e].concat(t) : [e, t]
    }

    function P(e, t, n) {
        Array.isArray(e) ? e.forEach(t, n) : e && t.call(n, e)
    }
    var x = null;

    function I(e, t) {
        if (e) {
            var n = e._dispatchListeners,
                r = e._dispatchInstances;
            if (Array.isArray(n))
                for (var o = 0; o < n.length && !e.isPropagationStopped(); o++) S(e, t, n[o], r[o]);
            else n && S(e, t, n, r);
            e._dispatchListeners = null, e._dispatchInstances = null, e.isPersistent() || e.constructor.release(e)
        }
    }

    function D(e) {
        return I(e, !0)
    }

    function A(e) {
        return I(e, !1)
    }
    var L = {
        injectEventPluginOrder: w,
        injectEventPluginsByName: E
    };

    function R(e, t) {
        var n = e.stateNode;
        if (!n) return null;
        var r = j(n);
        if (!r) return null;
        n = r[t];
        e: switch (t) {
            case "onClick":
            case "onClickCapture":
            case "onDoubleClick":
            case "onDoubleClickCapture":
            case "onMouseDown":
            case "onMouseDownCapture":
            case "onMouseMove":
            case "onMouseMoveCapture":
            case "onMouseUp":
            case "onMouseUpCapture":
                (r = !r.disabled) || (r = !("button" === (e = e.type) || "input" === e || "select" === e || "textarea" === e)), e = !r;
                break e;
            default:
                e = !1
        }
        return e ? null : (n && "function" != typeof n && f("231", t, typeof n), n)
    }

    function B(e, t) {
        null !== e && (x = M(x, e)), e = x, x = null, e && (P(e, t ? D : A), x && f("95"), p.rethrowCaughtError())
    }

    function N(e, t, n, r) {
        for (var o = null, i = 0; i < b.length; i++) {
            var a = b[i];
            a && (a = a.extractEvents(e, t, n, r)) && (o = M(o, a))
        }
        B(o, !1)
    }
    var U = {
            injection: L,
            getListener: R,
            runEventsInBatch: B,
            runExtractedEventsInBatch: N
        },
        F = Math.random().toString(36).slice(2),
        H = "__reactInternalInstance$" + F,
        W = "__reactEventHandlers$" + F;

    function K(e) {
        if (e[H]) return e[H];
        for (; !e[H];) {
            if (!e.parentNode) return null;
            e = e.parentNode
        }
        return 5 === (e = e[H]).tag || 6 === e.tag ? e : null
    }

    function q(e) {
        if (5 === e.tag || 6 === e.tag) return e.stateNode;
        f("33")
    }

    function z(e) {
        return e[W] || null
    }
    var G = {
        precacheFiberNode: function(e, t) {
            t[H] = e
        },
        getClosestInstanceFromNode: K,
        getInstanceFromNode: function(e) {
            return !(e = e[H]) || 5 !== e.tag && 6 !== e.tag ? null : e
        },
        getNodeFromInstance: q,
        getFiberCurrentPropsFromNode: z,
        updateFiberProps: function(e, t) {
            e[W] = t
        }
    };

    function V(e) {
        do {
            e = e.return
        } while (e && 5 !== e.tag);
        return e || null
    }

    function Y(e, t, n) {
        for (var r = []; e;) r.push(e), e = V(e);
        for (e = r.length; 0 < e--;) t(r[e], "captured", n);
        for (e = 0; e < r.length; e++) t(r[e], "bubbled", n)
    }

    function Q(e, t, n) {
        (t = R(e, n.dispatchConfig.phasedRegistrationNames[t])) && (n._dispatchListeners = M(n._dispatchListeners, t), n._dispatchInstances = M(n._dispatchInstances, e))
    }

    function $(e) {
        e && e.dispatchConfig.phasedRegistrationNames && Y(e._targetInst, Q, e)
    }

    function X(e) {
        if (e && e.dispatchConfig.phasedRegistrationNames) {
            var t = e._targetInst;
            Y(t = t ? V(t) : null, Q, e)
        }
    }

    function J(e, t, n) {
        e && n && n.dispatchConfig.registrationName && (t = R(e, n.dispatchConfig.registrationName)) && (n._dispatchListeners = M(n._dispatchListeners, t), n._dispatchInstances = M(n._dispatchInstances, e))
    }

    function Z(e) {
        e && e.dispatchConfig.registrationName && J(e._targetInst, null, e)
    }

    function ee(e) {
        P(e, $)
    }

    function te(e, t, n, r) {
        if (n && r) e: {
            for (var o = n, i = r, a = 0, s = o; s; s = V(s)) a++;s = 0;
            for (var c = i; c; c = V(c)) s++;
            for (; 0 < a - s;) o = V(o),
            a--;
            for (; 0 < s - a;) i = V(i),
            s--;
            for (; a--;) {
                if (o === i || o === i.alternate) break e;
                o = V(o), i = V(i)
            }
            o = null
        }
        else o = null;
        for (i = o, o = []; n && n !== i && (null === (a = n.alternate) || a !== i);) o.push(n), n = V(n);
        for (n = []; r && r !== i && (null === (a = r.alternate) || a !== i);) n.push(r), r = V(r);
        for (r = 0; r < o.length; r++) J(o[r], "bubbled", e);
        for (e = n.length; 0 < e--;) J(n[e], "captured", t)
    }
    var ne = {
        accumulateTwoPhaseDispatches: ee,
        accumulateTwoPhaseDispatchesSkipTarget: function(e) {
            P(e, X)
        },
        accumulateEnterLeaveDispatches: te,
        accumulateDirectDispatches: function(e) {
            P(e, Z)
        }
    };

    function re(e, t) {
        var n = {};
        return n[e.toLowerCase()] = t.toLowerCase(), n["Webkit" + e] = "webkit" + t, n["Moz" + e] = "moz" + t, n["ms" + e] = "MS" + t, n["O" + e] = "o" + t.toLowerCase(), n
    }
    var oe = {
            animationend: re("Animation", "AnimationEnd"),
            animationiteration: re("Animation", "AnimationIteration"),
            animationstart: re("Animation", "AnimationStart"),
            transitionend: re("Transition", "TransitionEnd")
        },
        ie = {},
        ae = {};

    function se(e) {
        if (ie[e]) return ie[e];
        if (!oe[e]) return e;
        var t, n = oe[e];
        for (t in n)
            if (n.hasOwnProperty(t) && t in ae) return ie[e] = n[t];
        return e
    }
    i.canUseDOM && (ae = document.createElement("div").style, "AnimationEvent" in window || (delete oe.animationend.animation, delete oe.animationiteration.animation, delete oe.animationstart.animation), "TransitionEvent" in window || delete oe.transitionend.transition);
    var ce = se("animationend"),
        ue = se("animationiteration"),
        le = se("animationstart"),
        de = se("transitionend"),
        fe = "abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),
        pe = null;

    function _e() {
        return !pe && i.canUseDOM && (pe = "textContent" in document.documentElement ? "textContent" : "innerText"), pe
    }
    var me = {
        _root: null,
        _startText: null,
        _fallbackText: null
    };

    function ge() {
        if (me._fallbackText) return me._fallbackText;
        var e, t, n = me._startText,
            r = n.length,
            o = he(),
            i = o.length;
        for (e = 0; e < r && n[e] === o[e]; e++);
        var a = r - e;
        for (t = 1; t <= a && n[r - t] === o[i - t]; t++);
        return me._fallbackText = o.slice(e, 1 < t ? 1 - t : void 0), me._fallbackText
    }

    function he() {
        return "value" in me._root ? me._root.value : me._root[_e()]
    }
    var be = "dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances".split(" "),
        ve = {
            type: null,
            target: null,
            currentTarget: s.thatReturnsNull,
            eventPhase: null,
            bubbles: null,
            cancelable: null,
            timeStamp: function(e) {
                return e.timeStamp || Date.now()
            },
            defaultPrevented: null,
            isTrusted: null
        };

    function ye(e, t, n, r) {
        for (var o in this.dispatchConfig = e, this._targetInst = t, this.nativeEvent = n, e = this.constructor.Interface) e.hasOwnProperty(o) && ((t = e[o]) ? this[o] = t(n) : "target" === o ? this.target = r : this[o] = n[o]);
        return this.isDefaultPrevented = (null != n.defaultPrevented ? n.defaultPrevented : !1 === n.returnValue) ? s.thatReturnsTrue : s.thatReturnsFalse, this.isPropagationStopped = s.thatReturnsFalse, this
    }

    function Oe(e, t, n, r) {
        if (this.eventPool.length) {
            var o = this.eventPool.pop();
            return this.call(o, e, t, n, r), o
        }
        return new this(e, t, n, r)
    }

    function we(e) {
        e instanceof this || f("223"), e.destructor(), 10 > this.eventPool.length && this.eventPool.push(e)
    }

    function Ee(e) {
        e.eventPool = [], e.getPooled = Oe, e.release = we
    }
    a(ye.prototype, {
        preventDefault: function() {
            this.defaultPrevented = !0;
            var e = this.nativeEvent;
            e && (e.preventDefault ? e.preventDefault() : "unknown" != typeof e.returnValue && (e.returnValue = !1), this.isDefaultPrevented = s.thatReturnsTrue)
        },
        stopPropagation: function() {
            var e = this.nativeEvent;
            e && (e.stopPropagation ? e.stopPropagation() : "unknown" != typeof e.cancelBubble && (e.cancelBubble = !0), this.isPropagationStopped = s.thatReturnsTrue)
        },
        persist: function() {
            this.isPersistent = s.thatReturnsTrue
        },
        isPersistent: s.thatReturnsFalse,
        destructor: function() {
            var e, t = this.constructor.Interface;
            for (e in t) this[e] = null;
            for (t = 0; t < be.length; t++) this[be[t]] = null
        }
    }), ye.Interface = ve, ye.extend = function(e) {
        function t() {}

        function n() {
            return r.apply(this, arguments)
        }
        var r = this;
        t.prototype = r.prototype;
        var o = new t;
        return a(o, n.prototype), n.prototype = o, n.prototype.constructor = n, n.Interface = a({}, r.Interface, e), n.extend = r.extend, Ee(n), n
    }, Ee(ye);
    var Ce = ye.extend({
            data: null
        }),
        je = ye.extend({
            data: null
        }),
        ke = [9, 13, 27, 32],
        Te = i.canUseDOM && "CompositionEvent" in window,
        Se = null;
    i.canUseDOM && "documentMode" in document && (Se = document.documentMode);
    var Me = i.canUseDOM && "TextEvent" in window && !Se,
        Pe = i.canUseDOM && (!Te || Se && 8 < Se && 11 >= Se),
        xe = String.fromCharCode(32),
        Ie = {
            beforeInput: {
                phasedRegistrationNames: {
                    bubbled: "onBeforeInput",
                    captured: "onBeforeInputCapture"
                },
                dependencies: ["compositionend", "keypress", "textInput", "paste"]
            },
            compositionEnd: {
                phasedRegistrationNames: {
                    bubbled: "onCompositionEnd",
                    captured: "onCompositionEndCapture"
                },
                dependencies: "blur compositionend keydown keypress keyup mousedown".split(" ")
            },
            compositionStart: {
                phasedRegistrationNames: {
                    bubbled: "onCompositionStart",
                    captured: "onCompositionStartCapture"
                },
                dependencies: "blur compositionstart keydown keypress keyup mousedown".split(" ")
            },
            compositionUpdate: {
                phasedRegistrationNames: {
                    bubbled: "onCompositionUpdate",
                    captured: "onCompositionUpdateCapture"
                },
                dependencies: "blur compositionupdate keydown keypress keyup mousedown".split(" ")
            }
        },
        De = !1;

    function Ae(e, t) {
        switch (e) {
            case "keyup":
                return -1 !== ke.indexOf(t.keyCode);
            case "keydown":
                return 229 !== t.keyCode;
            case "keypress":
            case "mousedown":
            case "blur":
                return !0;
            default:
                return !1
        }
    }

    function Le(e) {
        return "object" == typeof(e = e.detail) && "data" in e ? e.data : null
    }
    var Re = !1;
    var Be = {
            eventTypes: Ie,
            extractEvents: function(e, t, n, r) {
                var o = void 0,
                    i = void 0;
                if (Te) e: {
                    switch (e) {
                        case "compositionstart":
                            o = Ie.compositionStart;
                            break e;
                        case "compositionend":
                            o = Ie.compositionEnd;
                            break e;
                        case "compositionupdate":
                            o = Ie.compositionUpdate;
                            break e
                    }
                    o = void 0
                }
                else Re ? Ae(e, n) && (o = Ie.compositionEnd) : "keydown" === e && 229 === n.keyCode && (o = Ie.compositionStart);
                return o ? (Pe && (Re || o !== Ie.compositionStart ? o === Ie.compositionEnd && Re && (i = ge()) : (me._root = r, me._startText = he(), Re = !0)), o = Ce.getPooled(o, t, n, r), i ? o.data = i : null !== (i = Le(n)) && (o.data = i), ee(o), i = o) : i = null, (e = Me ? function(e, t) {
                    switch (e) {
                        case "compositionend":
                            return Le(t);
                        case "keypress":
                            return 32 !== t.which ? null : (De = !0, xe);
                        case "textInput":
                            return (e = t.data) === xe && De ? null : e;
                        default:
                            return null
                    }
                }(e, n) : function(e, t) {
                    if (Re) return "compositionend" === e || !Te && Ae(e, t) ? (e = ge(), me._root = null, me._startText = null, me._fallbackText = null, Re = !1, e) : null;
                    switch (e) {
                        case "paste":
                            return null;
                        case "keypress":
                            if (!(t.ctrlKey || t.altKey || t.metaKey) || t.ctrlKey && t.altKey) {
                                if (t.char && 1 < t.char.length) return t.char;
                                if (t.which) return String.fromCharCode(t.which)
                            }
                            return null;
                        case "compositionend":
                            return Pe ? null : t.data;
                        default:
                            return null
                    }
                }(e, n)) ? ((t = je.getPooled(Ie.beforeInput, t, n, r)).data = e, ee(t)) : t = null, null === i ? t : null === t ? i : [i, t]
            }
        },
        Ne = null,
        Ue = {
            injectFiberControlledHostComponent: function(e) {
                Ne = e
            }
        },
        Fe = null,
        He = null;

    function We(e) {
        if (e = k(e)) {
            Ne && "function" == typeof Ne.restoreControlledState || f("194");
            var t = j(e.stateNode);
            Ne.restoreControlledState(e.stateNode, e.type, t)
        }
    }

    function Ke(e) {
        Fe ? He ? He.push(e) : He = [e] : Fe = e
    }

    function qe() {
        return null !== Fe || null !== He
    }

    function ze() {
        if (Fe) {
            var e = Fe,
                t = He;
            if (He = Fe = null, We(e), t)
                for (e = 0; e < t.length; e++) We(t[e])
        }
    }
    var Ge = {
        injection: Ue,
        enqueueStateRestore: Ke,
        needsStateRestore: qe,
        restoreStateIfNeeded: ze
    };

    function Ve(e, t) {
        return e(t)
    }

    function Ye(e, t, n) {
        return e(t, n)
    }

    function Qe() {}
    var $e = !1;

    function Xe(e, t) {
        if ($e) return e(t);
        $e = !0;
        try {
            return Ve(e, t)
        } finally {
            $e = !1, qe() && (Qe(), ze())
        }
    }
    var Je = {
        color: !0,
        date: !0,
        datetime: !0,
        "datetime-local": !0,
        email: !0,
        month: !0,
        number: !0,
        password: !0,
        range: !0,
        search: !0,
        tel: !0,
        text: !0,
        time: !0,
        url: !0,
        week: !0
    };

    function Ze(e) {
        var t = e && e.nodeName && e.nodeName.toLowerCase();
        return "input" === t ? !!Je[e.type] : "textarea" === t
    }

    function et(e) {
        return (e = e.target || window).correspondingUseElement && (e = e.correspondingUseElement), 3 === e.nodeType ? e.parentNode : e
    }

    function tt(e, t) {
        return !(!i.canUseDOM || t && !("addEventListener" in document)) && ((t = (e = "on" + e) in document) || ((t = document.createElement("div")).setAttribute(e, "return;"), t = "function" == typeof t[e]), t)
    }

    function nt(e) {
        var t = e.type;
        return (e = e.nodeName) && "input" === e.toLowerCase() && ("checkbox" === t || "radio" === t)
    }

    function rt(e) {
        e._valueTracker || (e._valueTracker = function(e) {
            var t = nt(e) ? "checked" : "value",
                n = Object.getOwnPropertyDescriptor(e.constructor.prototype, t),
                r = "" + e[t];
            if (!e.hasOwnProperty(t) && void 0 !== n && "function" == typeof n.get && "function" == typeof n.set) {
                var o = n.get,
                    i = n.set;
                return Object.defineProperty(e, t, {
                    configurable: !0,
                    get: function() {
                        return o.call(this)
                    },
                    set: function(e) {
                        r = "" + e, i.call(this, e)
                    }
                }), Object.defineProperty(e, t, {
                    enumerable: n.enumerable
                }), {
                    getValue: function() {
                        return r
                    },
                    setValue: function(e) {
                        r = "" + e
                    },
                    stopTracking: function() {
                        e._valueTracker = null, delete e[t]
                    }
                }
            }
        }(e))
    }

    function ot(e) {
        if (!e) return !1;
        var t = e._valueTracker;
        if (!t) return !0;
        var n = t.getValue(),
            r = "";
        return e && (r = nt(e) ? e.checked ? "true" : "false" : e.value), (e = r) !== n && (t.setValue(e), !0)
    }
    var it = o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,
        at = "function" == typeof Symbol && Symbol.for,
        st = at ? Symbol.for("react.element") : 60103,
        ct = at ? Symbol.for("react.portal") : 60106,
        ut = at ? Symbol.for("react.fragment") : 60107,
        lt = at ? Symbol.for("react.strict_mode") : 60108,
        dt = at ? Symbol.for("react.profiler") : 60114,
        ft = at ? Symbol.for("react.provider") : 60109,
        pt = at ? Symbol.for("react.context") : 60110,
        _t = at ? Symbol.for("react.async_mode") : 60111,
        mt = at ? Symbol.for("react.forward_ref") : 60112,
        gt = at ? Symbol.for("react.timeout") : 60113,
        ht = "function" == typeof Symbol && Symbol.iterator;

    function bt(e) {
        return null === e || void 0 === e ? null : "function" == typeof(e = ht && e[ht] || e["@@iterator"]) ? e : null
    }

    function vt(e) {
        var t = e.type;
        if ("function" == typeof t) return t.displayName || t.name;
        if ("string" == typeof t) return t;
        switch (t) {
            case _t:
                return "AsyncMode";
            case pt:
                return "Context.Consumer";
            case ut:
                return "ReactFragment";
            case ct:
                return "ReactPortal";
            case dt:
                return "Profiler(" + e.pendingProps.id + ")";
            case ft:
                return "Context.Provider";
            case lt:
                return "StrictMode";
            case gt:
                return "Timeout"
        }
        if ("object" == typeof t && null !== t) switch (t.$$typeof) {
            case mt:
                return "" !== (e = t.render.displayName || t.render.name || "") ? "ForwardRef(" + e + ")" : "ForwardRef"
        }
        return null
    }

    function yt(e) {
        var t = "";
        do {
            e: switch (e.tag) {
                case 0:
                case 1:
                case 2:
                case 5:
                    var n = e._debugOwner,
                        r = e._debugSource,
                        o = vt(e),
                        i = null;
                    n && (i = vt(n)), n = r, o = "\n    in " + (o || "Unknown") + (n ? " (at " + n.fileName.replace(/^.*[\\\/]/, "") + ":" + n.lineNumber + ")" : i ? " (created by " + i + ")" : "");
                    break e;
                default:
                    o = ""
            }
            t += o,
            e = e.return
        } while (e);
        return t
    }
    var Ot = /^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,
        wt = {},
        Et = {};

    function Ct(e, t, n, r, o) {
        this.acceptsBooleans = 2 === t || 3 === t || 4 === t, this.attributeName = r, this.attributeNamespace = o, this.mustUseProperty = n, this.propertyName = e, this.type = t
    }
    var jt = {};
    "children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e) {
        jt[e] = new Ct(e, 0, !1, e, null)
    }), [
        ["acceptCharset", "accept-charset"],
        ["className", "class"],
        ["htmlFor", "for"],
        ["httpEquiv", "http-equiv"]
    ].forEach(function(e) {
        var t = e[0];
        jt[t] = new Ct(t, 1, !1, e[1], null)
    }), ["contentEditable", "draggable", "spellCheck", "value"].forEach(function(e) {
        jt[e] = new Ct(e, 2, !1, e.toLowerCase(), null)
    }), ["autoReverse", "externalResourcesRequired", "preserveAlpha"].forEach(function(e) {
        jt[e] = new Ct(e, 2, !1, e, null)
    }), "allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e) {
        jt[e] = new Ct(e, 3, !1, e.toLowerCase(), null)
    }), ["checked", "multiple", "muted", "selected"].forEach(function(e) {
        jt[e] = new Ct(e, 3, !0, e.toLowerCase(), null)
    }), ["capture", "download"].forEach(function(e) {
        jt[e] = new Ct(e, 4, !1, e.toLowerCase(), null)
    }), ["cols", "rows", "size", "span"].forEach(function(e) {
        jt[e] = new Ct(e, 6, !1, e.toLowerCase(), null)
    }), ["rowSpan", "start"].forEach(function(e) {
        jt[e] = new Ct(e, 5, !1, e.toLowerCase(), null)
    });
    var kt = /[\-:]([a-z])/g;

    function Tt(e) {
        return e[1].toUpperCase()
    }

    function St(e, t, n, r) {
        var o = jt.hasOwnProperty(t) ? jt[t] : null;
        (null !== o ? 0 === o.type : !r && (2 < t.length && ("o" === t[0] || "O" === t[0]) && ("n" === t[1] || "N" === t[1]))) || (function(e, t, n, r) {
            if (null === t || void 0 === t || function(e, t, n, r) {
                    if (null !== n && 0 === n.type) return !1;
                    switch (typeof t) {
                        case "function":
                        case "symbol":
                            return !0;
                        case "boolean":
                            return !r && (null !== n ? !n.acceptsBooleans : "data-" !== (e = e.toLowerCase().slice(0, 5)) && "aria-" !== e);
                        default:
                            return !1
                    }
                }(e, t, n, r)) return !0;
            if (r) return !1;
            if (null !== n) switch (n.type) {
                case 3:
                    return !t;
                case 4:
                    return !1 === t;
                case 5:
                    return isNaN(t);
                case 6:
                    return isNaN(t) || 1 > t
            }
            return !1
        }(t, n, o, r) && (n = null), r || null === o ? function(e) {
            return !!Et.hasOwnProperty(e) || !wt.hasOwnProperty(e) && (Ot.test(e) ? Et[e] = !0 : (wt[e] = !0, !1))
        }(t) && (null === n ? e.removeAttribute(t) : e.setAttribute(t, "" + n)) : o.mustUseProperty ? e[o.propertyName] = null === n ? 3 !== o.type && "" : n : (t = o.attributeName, r = o.attributeNamespace, null === n ? e.removeAttribute(t) : (n = 3 === (o = o.type) || 4 === o && !0 === n ? "" : "" + n, r ? e.setAttributeNS(r, t, n) : e.setAttribute(t, n))))
    }

    function Mt(e, t) {
        var n = t.checked;
        return a({}, t, {
            defaultChecked: void 0,
            defaultValue: void 0,
            value: void 0,
            checked: null != n ? n : e._wrapperState.initialChecked
        })
    }

    function Pt(e, t) {
        var n = null == t.defaultValue ? "" : t.defaultValue,
            r = null != t.checked ? t.checked : t.defaultChecked;
        n = Lt(null != t.value ? t.value : n), e._wrapperState = {
            initialChecked: r,
            initialValue: n,
            controlled: "checkbox" === t.type || "radio" === t.type ? null != t.checked : null != t.value
        }
    }

    function xt(e, t) {
        null != (t = t.checked) && St(e, "checked", t, !1)
    }

    function It(e, t) {
        xt(e, t);
        var n = Lt(t.value);
        null != n && ("number" === t.type ? (0 === n && "" === e.value || e.value != n) && (e.value = "" + n) : e.value !== "" + n && (e.value = "" + n)), t.hasOwnProperty("value") ? At(e, t.type, n) : t.hasOwnProperty("defaultValue") && At(e, t.type, Lt(t.defaultValue)), null == t.checked && null != t.defaultChecked && (e.defaultChecked = !!t.defaultChecked)
    }

    function Dt(e, t) {
        (t.hasOwnProperty("value") || t.hasOwnProperty("defaultValue")) && ("" === e.value && (e.value = "" + e._wrapperState.initialValue), e.defaultValue = "" + e._wrapperState.initialValue), "" !== (t = e.name) && (e.name = ""), e.defaultChecked = !e.defaultChecked, e.defaultChecked = !e.defaultChecked, "" !== t && (e.name = t)
    }

    function At(e, t, n) {
        "number" === t && e.ownerDocument.activeElement === e || (null == n ? e.defaultValue = "" + e._wrapperState.initialValue : e.defaultValue !== "" + n && (e.defaultValue = "" + n))
    }

    function Lt(e) {
        switch (typeof e) {
            case "boolean":
            case "number":
            case "object":
            case "string":
            case "undefined":
                return e;
            default:
                return ""
        }
    }
    "accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e) {
        var t = e.replace(kt, Tt);
        jt[t] = new Ct(t, 1, !1, e, null)
    }), "xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e) {
        var t = e.replace(kt, Tt);
        jt[t] = new Ct(t, 1, !1, e, "http://www.w3.org/1999/xlink")
    }), ["xml:base", "xml:lang", "xml:space"].forEach(function(e) {
        var t = e.replace(kt, Tt);
        jt[t] = new Ct(t, 1, !1, e, "http://www.w3.org/XML/1998/namespace")
    }), jt.tabIndex = new Ct("tabIndex", 1, !1, "tabindex", null);
    var Rt = {
        change: {
            phasedRegistrationNames: {
                bubbled: "onChange",
                captured: "onChangeCapture"
            },
            dependencies: "blur change click focus input keydown keyup selectionchange".split(" ")
        }
    };

    function Bt(e, t, n) {
        return (e = ye.getPooled(Rt.change, e, t, n)).type = "change", Ke(n), ee(e), e
    }
    var Nt = null,
        Ut = null;

    function Ft(e) {
        B(e, !1)
    }

    function Ht(e) {
        if (ot(q(e))) return e
    }

    function Wt(e, t) {
        if ("change" === e) return t
    }
    var Kt = !1;

    function qt() {
        Nt && (Nt.detachEvent("onpropertychange", zt), Ut = Nt = null)
    }

    function zt(e) {
        "value" === e.propertyName && Ht(Ut) && Xe(Ft, e = Bt(Ut, e, et(e)))
    }

    function Gt(e, t, n) {
        "focus" === e ? (qt(), Ut = n, (Nt = t).attachEvent("onpropertychange", zt)) : "blur" === e && qt()
    }

    function Vt(e) {
        if ("selectionchange" === e || "keyup" === e || "keydown" === e) return Ht(Ut)
    }

    function Yt(e, t) {
        if ("click" === e) return Ht(t)
    }

    function Qt(e, t) {
        if ("input" === e || "change" === e) return Ht(t)
    }
    i.canUseDOM && (Kt = tt("input") && (!document.documentMode || 9 < document.documentMode));
    var $t = {
            eventTypes: Rt,
            _isInputEventSupported: Kt,
            extractEvents: function(e, t, n, r) {
                var o = t ? q(t) : window,
                    i = void 0,
                    a = void 0,
                    s = o.nodeName && o.nodeName.toLowerCase();
                if ("select" === s || "input" === s && "file" === o.type ? i = Wt : Ze(o) ? Kt ? i = Qt : (i = Vt, a = Gt) : (s = o.nodeName) && "input" === s.toLowerCase() && ("checkbox" === o.type || "radio" === o.type) && (i = Yt), i && (i = i(e, t))) return Bt(i, n, r);
                a && a(e, o, t), "blur" === e && null != t && (e = t._wrapperState || o._wrapperState) && e.controlled && "number" === o.type && At(o, "number", o.value)
            }
        },
        Xt = ye.extend({
            view: null,
            detail: null
        }),
        Jt = {
            Alt: "altKey",
            Control: "ctrlKey",
            Meta: "metaKey",
            Shift: "shiftKey"
        };

    function Zt(e) {
        var t = this.nativeEvent;
        return t.getModifierState ? t.getModifierState(e) : !!(e = Jt[e]) && !!t[e]
    }

    function en() {
        return Zt
    }
    var tn = Xt.extend({
            screenX: null,
            screenY: null,
            clientX: null,
            clientY: null,
            pageX: null,
            pageY: null,
            ctrlKey: null,
            shiftKey: null,
            altKey: null,
            metaKey: null,
            getModifierState: en,
            button: null,
            buttons: null,
            relatedTarget: function(e) {
                return e.relatedTarget || (e.fromElement === e.srcElement ? e.toElement : e.fromElement)
            }
        }),
        nn = tn.extend({
            pointerId: null,
            width: null,
            height: null,
            pressure: null,
            tiltX: null,
            tiltY: null,
            pointerType: null,
            isPrimary: null
        }),
        rn = {
            mouseEnter: {
                registrationName: "onMouseEnter",
                dependencies: ["mouseout", "mouseover"]
            },
            mouseLeave: {
                registrationName: "onMouseLeave",
                dependencies: ["mouseout", "mouseover"]
            },
            pointerEnter: {
                registrationName: "onPointerEnter",
                dependencies: ["pointerout", "pointerover"]
            },
            pointerLeave: {
                registrationName: "onPointerLeave",
                dependencies: ["pointerout", "pointerover"]
            }
        },
        on = {
            eventTypes: rn,
            extractEvents: function(e, t, n, r) {
                var o = "mouseover" === e || "pointerover" === e,
                    i = "mouseout" === e || "pointerout" === e;
                if (o && (n.relatedTarget || n.fromElement) || !i && !o) return null;
                if (o = r.window === r ? r : (o = r.ownerDocument) ? o.defaultView || o.parentWindow : window, i ? (i = t, t = (t = n.relatedTarget || n.toElement) ? K(t) : null) : i = null, i === t) return null;
                var a = void 0,
                    s = void 0,
                    c = void 0,
                    u = void 0;
                return "mouseout" === e || "mouseover" === e ? (a = tn, s = rn.mouseLeave, c = rn.mouseEnter, u = "mouse") : "pointerout" !== e && "pointerover" !== e || (a = nn, s = rn.pointerLeave, c = rn.pointerEnter, u = "pointer"), e = null == i ? o : q(i), o = null == t ? o : q(t), (s = a.getPooled(s, i, n, r)).type = u + "leave", s.target = e, s.relatedTarget = o, (n = a.getPooled(c, t, n, r)).type = u + "enter", n.target = o, n.relatedTarget = e, te(s, n, i, t), [s, n]
            }
        };

    function an(e) {
        var t = e;
        if (e.alternate)
            for (; t.return;) t = t.return;
        else {
            if (0 != (2 & t.effectTag)) return 1;
            for (; t.return;)
                if (0 != (2 & (t = t.return).effectTag)) return 1
        }
        return 3 === t.tag ? 2 : 3
    }

    function sn(e) {
        2 !== an(e) && f("188")
    }

    function cn(e) {
        var t = e.alternate;
        if (!t) return 3 === (t = an(e)) && f("188"), 1 === t ? null : e;
        for (var n = e, r = t;;) {
            var o = n.return,
                i = o ? o.alternate : null;
            if (!o || !i) break;
            if (o.child === i.child) {
                for (var a = o.child; a;) {
                    if (a === n) return sn(o), e;
                    if (a === r) return sn(o), t;
                    a = a.sibling
                }
                f("188")
            }
            if (n.return !== r.return) n = o, r = i;
            else {
                a = !1;
                for (var s = o.child; s;) {
                    if (s === n) {
                        a = !0, n = o, r = i;
                        break
                    }
                    if (s === r) {
                        a = !0, r = o, n = i;
                        break
                    }
                    s = s.sibling
                }
                if (!a) {
                    for (s = i.child; s;) {
                        if (s === n) {
                            a = !0, n = i, r = o;
                            break
                        }
                        if (s === r) {
                            a = !0, r = i, n = o;
                            break
                        }
                        s = s.sibling
                    }
                    a || f("189")
                }
            }
            n.alternate !== r && f("190")
        }
        return 3 !== n.tag && f("188"), n.stateNode.current === n ? e : t
    }

    function un(e) {
        if (!(e = cn(e))) return null;
        for (var t = e;;) {
            if (5 === t.tag || 6 === t.tag) return t;
            if (t.child) t.child.return = t, t = t.child;
            else {
                if (t === e) break;
                for (; !t.sibling;) {
                    if (!t.return || t.return === e) return null;
                    t = t.return
                }
                t.sibling.return = t.return, t = t.sibling
            }
        }
        return null
    }
    var ln = ye.extend({
            animationName: null,
            elapsedTime: null,
            pseudoElement: null
        }),
        dn = ye.extend({
            clipboardData: function(e) {
                return "clipboardData" in e ? e.clipboardData : window.clipboardData
            }
        }),
        fn = Xt.extend({
            relatedTarget: null
        });

    function pn(e) {
        var t = e.keyCode;
        return "charCode" in e ? 0 === (e = e.charCode) && 13 === t && (e = 13) : e = t, 10 === e && (e = 13), 32 <= e || 13 === e ? e : 0
    }
    var _n = {
            Esc: "Escape",
            Spacebar: " ",
            Left: "ArrowLeft",
            Up: "ArrowUp",
            Right: "ArrowRight",
            Down: "ArrowDown",
            Del: "Delete",
            Win: "OS",
            Menu: "ContextMenu",
            Apps: "ContextMenu",
            Scroll: "ScrollLock",
            MozPrintableKey: "Unidentified"
        },
        mn = {
            8: "Backspace",
            9: "Tab",
            12: "Clear",
            13: "Enter",
            16: "Shift",
            17: "Control",
            18: "Alt",
            19: "Pause",
            20: "CapsLock",
            27: "Escape",
            32: " ",
            33: "PageUp",
            34: "PageDown",
            35: "End",
            36: "Home",
            37: "ArrowLeft",
            38: "ArrowUp",
            39: "ArrowRight",
            40: "ArrowDown",
            45: "Insert",
            46: "Delete",
            112: "F1",
            113: "F2",
            114: "F3",
            115: "F4",
            116: "F5",
            117: "F6",
            118: "F7",
            119: "F8",
            120: "F9",
            121: "F10",
            122: "F11",
            123: "F12",
            144: "NumLock",
            145: "ScrollLock",
            224: "Meta"
        },
        gn = Xt.extend({
            key: function(e) {
                if (e.key) {
                    var t = _n[e.key] || e.key;
                    if ("Unidentified" !== t) return t
                }
                return "keypress" === e.type ? 13 === (e = pn(e)) ? "Enter" : String.fromCharCode(e) : "keydown" === e.type || "keyup" === e.type ? mn[e.keyCode] || "Unidentified" : ""
            },
            location: null,
            ctrlKey: null,
            shiftKey: null,
            altKey: null,
            metaKey: null,
            repeat: null,
            locale: null,
            getModifierState: en,
            charCode: function(e) {
                return "keypress" === e.type ? pn(e) : 0
            },
            keyCode: function(e) {
                return "keydown" === e.type || "keyup" === e.type ? e.keyCode : 0
            },
            which: function(e) {
                return "keypress" === e.type ? pn(e) : "keydown" === e.type || "keyup" === e.type ? e.keyCode : 0
            }
        }),
        hn = tn.extend({
            dataTransfer: null
        }),
        bn = Xt.extend({
            touches: null,
            targetTouches: null,
            changedTouches: null,
            altKey: null,
            metaKey: null,
            ctrlKey: null,
            shiftKey: null,
            getModifierState: en
        }),
        vn = ye.extend({
            propertyName: null,
            elapsedTime: null,
            pseudoElement: null
        }),
        yn = tn.extend({
            deltaX: function(e) {
                return "deltaX" in e ? e.deltaX : "wheelDeltaX" in e ? -e.wheelDeltaX : 0
            },
            deltaY: function(e) {
                return "deltaY" in e ? e.deltaY : "wheelDeltaY" in e ? -e.wheelDeltaY : "wheelDelta" in e ? -e.wheelDelta : 0
            },
            deltaZ: null,
            deltaMode: null
        }),
        On = [
            ["abort", "abort"],
            [ce, "animationEnd"],
            [ue, "animationIteration"],
            [le, "animationStart"],
            ["canplay", "canPlay"],
            ["canplaythrough", "canPlayThrough"],
            ["drag", "drag"],
            ["dragenter", "dragEnter"],
            ["dragexit", "dragExit"],
            ["dragleave", "dragLeave"],
            ["dragover", "dragOver"],
            ["durationchange", "durationChange"],
            ["emptied", "emptied"],
            ["encrypted", "encrypted"],
            ["ended", "ended"],
            ["error", "error"],
            ["gotpointercapture", "gotPointerCapture"],
            ["load", "load"],
            ["loadeddata", "loadedData"],
            ["loadedmetadata", "loadedMetadata"],
            ["loadstart", "loadStart"],
            ["lostpointercapture", "lostPointerCapture"],
            ["mousemove", "mouseMove"],
            ["mouseout", "mouseOut"],
            ["mouseover", "mouseOver"],
            ["playing", "playing"],
            ["pointermove", "pointerMove"],
            ["pointerout", "pointerOut"],
            ["pointerover", "pointerOver"],
            ["progress", "progress"],
            ["scroll", "scroll"],
            ["seeking", "seeking"],
            ["stalled", "stalled"],
            ["suspend", "suspend"],
            ["timeupdate", "timeUpdate"],
            ["toggle", "toggle"],
            ["touchmove", "touchMove"],
            [de, "transitionEnd"],
            ["waiting", "waiting"],
            ["wheel", "wheel"]
        ],
        wn = {},
        En = {};

    function Cn(e, t) {
        var n = e[0],
            r = "on" + ((e = e[1])[0].toUpperCase() + e.slice(1));
        t = {
            phasedRegistrationNames: {
                bubbled: r,
                captured: r + "Capture"
            },
            dependencies: [n],
            isInteractive: t
        }, wn[e] = t, En[n] = t
    }[
        ["blur", "blur"],
        ["cancel", "cancel"],
        ["click", "click"],
        ["close", "close"],
        ["contextmenu", "contextMenu"],
        ["copy", "copy"],
        ["cut", "cut"],
        ["dblclick", "doubleClick"],
        ["dragend", "dragEnd"],
        ["dragstart", "dragStart"],
        ["drop", "drop"],
        ["focus", "focus"],
        ["input", "input"],
        ["invalid", "invalid"],
        ["keydown", "keyDown"],
        ["keypress", "keyPress"],
        ["keyup", "keyUp"],
        ["mousedown", "mouseDown"],
        ["mouseup", "mouseUp"],
        ["paste", "paste"],
        ["pause", "pause"],
        ["play", "play"],
        ["pointercancel", "pointerCancel"],
        ["pointerdown", "pointerDown"],
        ["pointerup", "pointerUp"],
        ["ratechange", "rateChange"],
        ["reset", "reset"],
        ["seeked", "seeked"],
        ["submit", "submit"],
        ["touchcancel", "touchCancel"],
        ["touchend", "touchEnd"],
        ["touchstart", "touchStart"],
        ["volumechange", "volumeChange"]
    ].forEach(function(e) {
        Cn(e, !0)
    }), On.forEach(function(e) {
        Cn(e, !1)
    });
    var jn = {
            eventTypes: wn,
            isInteractiveTopLevelEventType: function(e) {
                return void 0 !== (e = En[e]) && !0 === e.isInteractive
            },
            extractEvents: function(e, t, n, r) {
                var o = En[e];
                if (!o) return null;
                switch (e) {
                    case "keypress":
                        if (0 === pn(n)) return null;
                    case "keydown":
                    case "keyup":
                        e = gn;
                        break;
                    case "blur":
                    case "focus":
                        e = fn;
                        break;
                    case "click":
                        if (2 === n.button) return null;
                    case "dblclick":
                    case "mousedown":
                    case "mousemove":
                    case "mouseup":
                    case "mouseout":
                    case "mouseover":
                    case "contextmenu":
                        e = tn;
                        break;
                    case "drag":
                    case "dragend":
                    case "dragenter":
                    case "dragexit":
                    case "dragleave":
                    case "dragover":
                    case "dragstart":
                    case "drop":
                        e = hn;
                        break;
                    case "touchcancel":
                    case "touchend":
                    case "touchmove":
                    case "touchstart":
                        e = bn;
                        break;
                    case ce:
                    case ue:
                    case le:
                        e = ln;
                        break;
                    case de:
                        e = vn;
                        break;
                    case "scroll":
                        e = Xt;
                        break;
                    case "wheel":
                        e = yn;
                        break;
                    case "copy":
                    case "cut":
                    case "paste":
                        e = dn;
                        break;
                    case "gotpointercapture":
                    case "lostpointercapture":
                    case "pointercancel":
                    case "pointerdown":
                    case "pointermove":
                    case "pointerout":
                    case "pointerover":
                    case "pointerup":
                        e = nn;
                        break;
                    default:
                        e = ye
                }
                return ee(t = e.getPooled(o, t, n, r)), t
            }
        },
        kn = jn.isInteractiveTopLevelEventType,
        Tn = [];

    function Sn(e) {
        var t = e.targetInst;
        do {
            if (!t) {
                e.ancestors.push(t);
                break
            }
            var n;
            for (n = t; n.return;) n = n.return;
            if (!(n = 3 !== n.tag ? null : n.stateNode.containerInfo)) break;
            e.ancestors.push(t), t = K(n)
        } while (t);
        for (n = 0; n < e.ancestors.length; n++) t = e.ancestors[n], N(e.topLevelType, t, e.nativeEvent, et(e.nativeEvent))
    }
    var Mn = !0;

    function Pn(e) {
        Mn = !!e
    }

    function xn(e, t) {
        if (!t) return null;
        var n = (kn(e) ? Dn : An).bind(null, e);
        t.addEventListener(e, n, !1)
    }

    function In(e, t) {
        if (!t) return null;
        var n = (kn(e) ? Dn : An).bind(null, e);
        t.addEventListener(e, n, !0)
    }

    function Dn(e, t) {
        Ye(An, e, t)
    }

    function An(e, t) {
        if (Mn) {
            var n = et(t);
            if (null === (n = K(n)) || "number" != typeof n.tag || 2 === an(n) || (n = null), Tn.length) {
                var r = Tn.pop();
                r.topLevelType = e, r.nativeEvent = t, r.targetInst = n, e = r
            } else e = {
                topLevelType: e,
                nativeEvent: t,
                targetInst: n,
                ancestors: []
            };
            try {
                Xe(Sn, e)
            } finally {
                e.topLevelType = null, e.nativeEvent = null, e.targetInst = null, e.ancestors.length = 0, 10 > Tn.length && Tn.push(e)
            }
        }
    }
    var Ln = {
            get _enabled() {
                return Mn
            },
            setEnabled: Pn,
            isEnabled: function() {
                return Mn
            },
            trapBubbledEvent: xn,
            trapCapturedEvent: In,
            dispatchEvent: An
        },
        Rn = {},
        Bn = 0,
        Nn = "_reactListenersID" + ("" + Math.random()).slice(2);

    function Un(e) {
        return Object.prototype.hasOwnProperty.call(e, Nn) || (e[Nn] = Bn++, Rn[e[Nn]] = {}), Rn[e[Nn]]
    }

    function Fn(e) {
        for (; e && e.firstChild;) e = e.firstChild;
        return e
    }

    function Hn(e, t) {
        var n, r = Fn(e);
        for (e = 0; r;) {
            if (3 === r.nodeType) {
                if (n = e + r.textContent.length, e <= t && n >= t) return {
                    node: r,
                    offset: t - e
                };
                e = n
            }
            e: {
                for (; r;) {
                    if (r.nextSibling) {
                        r = r.nextSibling;
                        break e
                    }
                    r = r.parentNode
                }
                r = void 0
            }
            r = Fn(r)
        }
    }

    function Wn(e) {
        var t = e && e.nodeName && e.nodeName.toLowerCase();
        return t && ("input" === t && "text" === e.type || "textarea" === t || "true" === e.contentEditable)
    }
    var Kn = i.canUseDOM && "documentMode" in document && 11 >= document.documentMode,
        qn = {
            select: {
                phasedRegistrationNames: {
                    bubbled: "onSelect",
                    captured: "onSelectCapture"
                },
                dependencies: "blur contextmenu focus keydown keyup mousedown mouseup selectionchange".split(" ")
            }
        },
        zn = null,
        Gn = null,
        Vn = null,
        Yn = !1;

    function Qn(e, t) {
        if (Yn || null == zn || zn !== c()) return null;
        var n = zn;
        return "selectionStart" in n && Wn(n) ? n = {
            start: n.selectionStart,
            end: n.selectionEnd
        } : window.getSelection ? n = {
            anchorNode: (n = window.getSelection()).anchorNode,
            anchorOffset: n.anchorOffset,
            focusNode: n.focusNode,
            focusOffset: n.focusOffset
        } : n = void 0, Vn && u(Vn, n) ? null : (Vn = n, (e = ye.getPooled(qn.select, Gn, e, t)).type = "select", e.target = zn, ee(e), e)
    }
    var $n = {
        eventTypes: qn,
        extractEvents: function(e, t, n, r) {
            var o, i = r.window === r ? r.document : 9 === r.nodeType ? r : r.ownerDocument;
            if (!(o = !i)) {
                e: {
                    i = Un(i),
                    o = O.onSelect;
                    for (var a = 0; a < o.length; a++) {
                        var s = o[a];
                        if (!i.hasOwnProperty(s) || !i[s]) {
                            i = !1;
                            break e
                        }
                    }
                    i = !0
                }
                o = !i
            }
            if (o) return null;
            switch (i = t ? q(t) : window, e) {
                case "focus":
                    (Ze(i) || "true" === i.contentEditable) && (zn = i, Gn = t, Vn = null);
                    break;
                case "blur":
                    Vn = Gn = zn = null;
                    break;
                case "mousedown":
                    Yn = !0;
                    break;
                case "contextmenu":
                case "mouseup":
                    return Yn = !1, Qn(n, r);
                case "selectionchange":
                    if (Kn) break;
                case "keydown":
                case "keyup":
                    return Qn(n, r)
            }
            return null
        }
    };
    L.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")), j = G.getFiberCurrentPropsFromNode, k = G.getInstanceFromNode, T = G.getNodeFromInstance, L.injectEventPluginsByName({
        SimpleEventPlugin: jn,
        EnterLeaveEventPlugin: on,
        ChangeEventPlugin: $t,
        SelectEventPlugin: $n,
        BeforeInputEventPlugin: Be
    });
    var Xn = void 0;
    Xn = "object" == typeof performance && "function" == typeof performance.now ? function() {
        return performance.now()
    } : function() {
        return Date.now()
    };
    var Jn = void 0,
        Zn = void 0;
    if (i.canUseDOM) {
        var er = [],
            tr = 0,
            nr = {},
            rr = -1,
            or = !1,
            ir = !1,
            ar = 0,
            sr = 33,
            cr = 33,
            ur = {
                didTimeout: !1,
                timeRemaining: function() {
                    var e = ar - Xn();
                    return 0 < e ? e : 0
                }
            },
            lr = function(e, t) {
                if (nr[t]) try {
                    e(ur)
                } finally {
                    delete nr[t]
                }
            },
            dr = "__reactIdleCallback$" + Math.random().toString(36).slice(2);
        window.addEventListener("message", function(e) {
            if (e.source === window && e.data === dr && (or = !1, 0 !== er.length)) {
                if (0 !== er.length && (e = Xn(), !(-1 === rr || rr > e))) {
                    rr = -1, ur.didTimeout = !0;
                    for (var t = 0, n = er.length; t < n; t++) {
                        var r = er[t],
                            o = r.timeoutTime; - 1 !== o && o <= e ? lr(r.scheduledCallback, r.callbackId) : -1 !== o && (-1 === rr || o < rr) && (rr = o)
                    }
                }
                for (e = Xn(); 0 < ar - e && 0 < er.length;) e = er.shift(), ur.didTimeout = !1, lr(e.scheduledCallback, e.callbackId), e = Xn();
                0 < er.length && !ir && (ir = !0, requestAnimationFrame(fr))
            }
        }, !1);
        var fr = function(e) {
            ir = !1;
            var t = e - ar + cr;
            t < cr && sr < cr ? (8 > t && (t = 8), cr = t < sr ? sr : t) : sr = t, ar = e + cr, or || (or = !0, window.postMessage(dr, "*"))
        };
        Jn = function(e, t) {
            var n = -1;
            return null != t && "number" == typeof t.timeout && (n = Xn() + t.timeout), (-1 === rr || -1 !== n && n < rr) && (rr = n), t = ++tr, er.push({
                scheduledCallback: e,
                callbackId: t,
                timeoutTime: n
            }), nr[t] = !0, ir || (ir = !0, requestAnimationFrame(fr)), t
        }, Zn = function(e) {
            delete nr[e]
        }
    } else {
        var pr = 0,
            _r = {};
        Jn = function(e) {
            var t = pr++,
                n = setTimeout(function() {
                    e({
                        timeRemaining: function() {
                            return 1 / 0
                        },
                        didTimeout: !1
                    })
                });
            return _r[t] = n, t
        }, Zn = function(e) {
            var t = _r[e];
            delete _r[e], clearTimeout(t)
        }
    }

    function mr(e, t) {
        return e = a({
            children: void 0
        }, t), (t = function(e) {
            var t = "";
            return o.Children.forEach(e, function(e) {
                null == e || "string" != typeof e && "number" != typeof e || (t += e)
            }), t
        }(t.children)) && (e.children = t), e
    }

    function gr(e, t, n, r) {
        if (e = e.options, t) {
            t = {};
            for (var o = 0; o < n.length; o++) t["$" + n[o]] = !0;
            for (n = 0; n < e.length; n++) o = t.hasOwnProperty("$" + e[n].value), e[n].selected !== o && (e[n].selected = o), o && r && (e[n].defaultSelected = !0)
        } else {
            for (n = "" + n, t = null, o = 0; o < e.length; o++) {
                if (e[o].value === n) return e[o].selected = !0, void(r && (e[o].defaultSelected = !0));
                null !== t || e[o].disabled || (t = e[o])
            }
            null !== t && (t.selected = !0)
        }
    }

    function hr(e, t) {
        var n = t.value;
        e._wrapperState = {
            initialValue: null != n ? n : t.defaultValue,
            wasMultiple: !!t.multiple
        }
    }

    function br(e, t) {
        return null != t.dangerouslySetInnerHTML && f("91"), a({}, t, {
            value: void 0,
            defaultValue: void 0,
            children: "" + e._wrapperState.initialValue
        })
    }

    function vr(e, t) {
        var n = t.value;
        null == n && (n = t.defaultValue, null != (t = t.children) && (null != n && f("92"), Array.isArray(t) && (1 >= t.length || f("93"), t = t[0]), n = "" + t), null == n && (n = "")), e._wrapperState = {
            initialValue: "" + n
        }
    }

    function yr(e, t) {
        var n = t.value;
        null != n && ((n = "" + n) !== e.value && (e.value = n), null == t.defaultValue && (e.defaultValue = n)), null != t.defaultValue && (e.defaultValue = t.defaultValue)
    }

    function Or(e) {
        var t = e.textContent;
        t === e._wrapperState.initialValue && (e.value = t)
    }
    var wr = {
        html: "http://www.w3.org/1999/xhtml",
        mathml: "http://www.w3.org/1998/Math/MathML",
        svg: "http://www.w3.org/2000/svg"
    };

    function Er(e) {
        switch (e) {
            case "svg":
                return "http://www.w3.org/2000/svg";
            case "math":
                return "http://www.w3.org/1998/Math/MathML";
            default:
                return "http://www.w3.org/1999/xhtml"
        }
    }

    function Cr(e, t) {
        return null == e || "http://www.w3.org/1999/xhtml" === e ? Er(t) : "http://www.w3.org/2000/svg" === e && "foreignObject" === t ? "http://www.w3.org/1999/xhtml" : e
    }
    var jr, kr = void 0,
        Tr = (jr = function(e, t) {
            if (e.namespaceURI !== wr.svg || "innerHTML" in e) e.innerHTML = t;
            else {
                for ((kr = kr || document.createElement("div")).innerHTML = "<svg>" + t + "</svg>", t = kr.firstChild; e.firstChild;) e.removeChild(e.firstChild);
                for (; t.firstChild;) e.appendChild(t.firstChild)
            }
        }, "undefined" != typeof MSApp && MSApp.execUnsafeLocalFunction ? function(e, t, n, r) {
            MSApp.execUnsafeLocalFunction(function() {
                return jr(e, t)
            })
        } : jr);

    function Sr(e, t) {
        if (t) {
            var n = e.firstChild;
            if (n && n === e.lastChild && 3 === n.nodeType) return void(n.nodeValue = t)
        }
        e.textContent = t
    }
    var Mr = {
            animationIterationCount: !0,
            borderImageOutset: !0,
            borderImageSlice: !0,
            borderImageWidth: !0,
            boxFlex: !0,
            boxFlexGroup: !0,
            boxOrdinalGroup: !0,
            columnCount: !0,
            columns: !0,
            flex: !0,
            flexGrow: !0,
            flexPositive: !0,
            flexShrink: !0,
            flexNegative: !0,
            flexOrder: !0,
            gridRow: !0,
            gridRowEnd: !0,
            gridRowSpan: !0,
            gridRowStart: !0,
            gridColumn: !0,
            gridColumnEnd: !0,
            gridColumnSpan: !0,
            gridColumnStart: !0,
            fontWeight: !0,
            lineClamp: !0,
            lineHeight: !0,
            opacity: !0,
            order: !0,
            orphans: !0,
            tabSize: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0,
            fillOpacity: !0,
            floodOpacity: !0,
            stopOpacity: !0,
            strokeDasharray: !0,
            strokeDashoffset: !0,
            strokeMiterlimit: !0,
            strokeOpacity: !0,
            strokeWidth: !0
        },
        Pr = ["Webkit", "ms", "Moz", "O"];

    function xr(e, t) {
        for (var n in e = e.style, t)
            if (t.hasOwnProperty(n)) {
                var r = 0 === n.indexOf("--"),
                    o = n,
                    i = t[n];
                o = null == i || "boolean" == typeof i || "" === i ? "" : r || "number" != typeof i || 0 === i || Mr.hasOwnProperty(o) && Mr[o] ? ("" + i).trim() : i + "px", "float" === n && (n = "cssFloat"), r ? e.setProperty(n, o) : e[n] = o
            }
    }
    Object.keys(Mr).forEach(function(e) {
        Pr.forEach(function(t) {
            t = t + e.charAt(0).toUpperCase() + e.substring(1), Mr[t] = Mr[e]
        })
    });
    var Ir = a({
        menuitem: !0
    }, {
        area: !0,
        base: !0,
        br: !0,
        col: !0,
        embed: !0,
        hr: !0,
        img: !0,
        input: !0,
        keygen: !0,
        link: !0,
        meta: !0,
        param: !0,
        source: !0,
        track: !0,
        wbr: !0
    });

    function Dr(e, t, n) {
        t && (Ir[e] && (null != t.children || null != t.dangerouslySetInnerHTML) && f("137", e, n()), null != t.dangerouslySetInnerHTML && (null != t.children && f("60"), "object" == typeof t.dangerouslySetInnerHTML && "__html" in t.dangerouslySetInnerHTML || f("61")), null != t.style && "object" != typeof t.style && f("62", n()))
    }

    function Ar(e, t) {
        if (-1 === e.indexOf("-")) return "string" == typeof t.is;
        switch (e) {
            case "annotation-xml":
            case "color-profile":
            case "font-face":
            case "font-face-src":
            case "font-face-uri":
            case "font-face-format":
            case "font-face-name":
            case "missing-glyph":
                return !1;
            default:
                return !0
        }
    }
    var Lr = s.thatReturns("");

    function Rr(e, t) {
        var n = Un(e = 9 === e.nodeType || 11 === e.nodeType ? e : e.ownerDocument);
        t = O[t];
        for (var r = 0; r < t.length; r++) {
            var o = t[r];
            if (!n.hasOwnProperty(o) || !n[o]) {
                switch (o) {
                    case "scroll":
                        In("scroll", e);
                        break;
                    case "focus":
                    case "blur":
                        In("focus", e), In("blur", e), n.blur = !0, n.focus = !0;
                        break;
                    case "cancel":
                    case "close":
                        tt(o, !0) && In(o, e);
                        break;
                    case "invalid":
                    case "submit":
                    case "reset":
                        break;
                    default:
                        -1 === fe.indexOf(o) && xn(o, e)
                }
                n[o] = !0
            }
        }
    }

    function Br(e, t, n, r) {
        return n = 9 === n.nodeType ? n : n.ownerDocument, r === wr.html && (r = Er(e)), r === wr.html ? "script" === e ? ((e = n.createElement("div")).innerHTML = "<script><\/script>", e = e.removeChild(e.firstChild)) : e = "string" == typeof t.is ? n.createElement(e, {
            is: t.is
        }) : n.createElement(e) : e = n.createElementNS(r, e), e
    }

    function Nr(e, t) {
        return (9 === t.nodeType ? t : t.ownerDocument).createTextNode(e)
    }

    function Ur(e, t, n, r) {
        var o = Ar(t, n);
        switch (t) {
            case "iframe":
            case "object":
                xn("load", e);
                var i = n;
                break;
            case "video":
            case "audio":
                for (i = 0; i < fe.length; i++) xn(fe[i], e);
                i = n;
                break;
            case "source":
                xn("error", e), i = n;
                break;
            case "img":
            case "image":
            case "link":
                xn("error", e), xn("load", e), i = n;
                break;
            case "form":
                xn("reset", e), xn("submit", e), i = n;
                break;
            case "details":
                xn("toggle", e), i = n;
                break;
            case "input":
                Pt(e, n), i = Mt(e, n), xn("invalid", e), Rr(r, "onChange");
                break;
            case "option":
                i = mr(e, n);
                break;
            case "select":
                hr(e, n), i = a({}, n, {
                    value: void 0
                }), xn("invalid", e), Rr(r, "onChange");
                break;
            case "textarea":
                vr(e, n), i = br(e, n), xn("invalid", e), Rr(r, "onChange");
                break;
            default:
                i = n
        }
        Dr(t, i, Lr);
        var c, u = i;
        for (c in u)
            if (u.hasOwnProperty(c)) {
                var l = u[c];
                "style" === c ? xr(e, l) : "dangerouslySetInnerHTML" === c ? null != (l = l ? l.__html : void 0) && Tr(e, l) : "children" === c ? "string" == typeof l ? ("textarea" !== t || "" !== l) && Sr(e, l) : "number" == typeof l && Sr(e, "" + l) : "suppressContentEditableWarning" !== c && "suppressHydrationWarning" !== c && "autoFocus" !== c && (y.hasOwnProperty(c) ? null != l && Rr(r, c) : null != l && St(e, c, l, o))
            }
        switch (t) {
            case "input":
                rt(e), Dt(e, n);
                break;
            case "textarea":
                rt(e), Or(e);
                break;
            case "option":
                null != n.value && e.setAttribute("value", n.value);
                break;
            case "select":
                e.multiple = !!n.multiple, null != (t = n.value) ? gr(e, !!n.multiple, t, !1) : null != n.defaultValue && gr(e, !!n.multiple, n.defaultValue, !0);
                break;
            default:
                "function" == typeof i.onClick && (e.onclick = s)
        }
    }

    function Fr(e, t, n, r, o) {
        var i = null;
        switch (t) {
            case "input":
                n = Mt(e, n), r = Mt(e, r), i = [];
                break;
            case "option":
                n = mr(e, n), r = mr(e, r), i = [];
                break;
            case "select":
                n = a({}, n, {
                    value: void 0
                }), r = a({}, r, {
                    value: void 0
                }), i = [];
                break;
            case "textarea":
                n = br(e, n), r = br(e, r), i = [];
                break;
            default:
                "function" != typeof n.onClick && "function" == typeof r.onClick && (e.onclick = s)
        }
        Dr(t, r, Lr), t = e = void 0;
        var c = null;
        for (e in n)
            if (!r.hasOwnProperty(e) && n.hasOwnProperty(e) && null != n[e])
                if ("style" === e) {
                    var u = n[e];
                    for (t in u) u.hasOwnProperty(t) && (c || (c = {}), c[t] = "")
                } else "dangerouslySetInnerHTML" !== e && "children" !== e && "suppressContentEditableWarning" !== e && "suppressHydrationWarning" !== e && "autoFocus" !== e && (y.hasOwnProperty(e) ? i || (i = []) : (i = i || []).push(e, null));
        for (e in r) {
            var l = r[e];
            if (u = null != n ? n[e] : void 0, r.hasOwnProperty(e) && l !== u && (null != l || null != u))
                if ("style" === e)
                    if (u) {
                        for (t in u) !u.hasOwnProperty(t) || l && l.hasOwnProperty(t) || (c || (c = {}), c[t] = "");
                        for (t in l) l.hasOwnProperty(t) && u[t] !== l[t] && (c || (c = {}), c[t] = l[t])
                    } else c || (i || (i = []), i.push(e, c)), c = l;
            else "dangerouslySetInnerHTML" === e ? (l = l ? l.__html : void 0, u = u ? u.__html : void 0, null != l && u !== l && (i = i || []).push(e, "" + l)) : "children" === e ? u === l || "string" != typeof l && "number" != typeof l || (i = i || []).push(e, "" + l) : "suppressContentEditableWarning" !== e && "suppressHydrationWarning" !== e && (y.hasOwnProperty(e) ? (null != l && Rr(o, e), i || u === l || (i = [])) : (i = i || []).push(e, l))
        }
        return c && (i = i || []).push("style", c), i
    }

    function Hr(e, t, n, r, o) {
        "input" === n && "radio" === o.type && null != o.name && xt(e, o), Ar(n, r), r = Ar(n, o);
        for (var i = 0; i < t.length; i += 2) {
            var a = t[i],
                s = t[i + 1];
            "style" === a ? xr(e, s) : "dangerouslySetInnerHTML" === a ? Tr(e, s) : "children" === a ? Sr(e, s) : St(e, a, s, r)
        }
        switch (n) {
            case "input":
                It(e, o);
                break;
            case "textarea":
                yr(e, o);
                break;
            case "select":
                e._wrapperState.initialValue = void 0, t = e._wrapperState.wasMultiple, e._wrapperState.wasMultiple = !!o.multiple, null != (n = o.value) ? gr(e, !!o.multiple, n, !1) : t !== !!o.multiple && (null != o.defaultValue ? gr(e, !!o.multiple, o.defaultValue, !0) : gr(e, !!o.multiple, o.multiple ? [] : "", !1))
        }
    }

    function Wr(e, t, n, r, o) {
        switch (t) {
            case "iframe":
            case "object":
                xn("load", e);
                break;
            case "video":
            case "audio":
                for (r = 0; r < fe.length; r++) xn(fe[r], e);
                break;
            case "source":
                xn("error", e);
                break;
            case "img":
            case "image":
            case "link":
                xn("error", e), xn("load", e);
                break;
            case "form":
                xn("reset", e), xn("submit", e);
                break;
            case "details":
                xn("toggle", e);
                break;
            case "input":
                Pt(e, n), xn("invalid", e), Rr(o, "onChange");
                break;
            case "select":
                hr(e, n), xn("invalid", e), Rr(o, "onChange");
                break;
            case "textarea":
                vr(e, n), xn("invalid", e), Rr(o, "onChange")
        }
        for (var i in Dr(t, n, Lr), r = null, n)
            if (n.hasOwnProperty(i)) {
                var a = n[i];
                "children" === i ? "string" == typeof a ? e.textContent !== a && (r = ["children", a]) : "number" == typeof a && e.textContent !== "" + a && (r = ["children", "" + a]) : y.hasOwnProperty(i) && null != a && Rr(o, i)
            }
        switch (t) {
            case "input":
                rt(e), Dt(e, n);
                break;
            case "textarea":
                rt(e), Or(e);
                break;
            case "select":
            case "option":
                break;
            default:
                "function" == typeof n.onClick && (e.onclick = s)
        }
        return r
    }

    function Kr(e, t) {
        return e.nodeValue !== t
    }
    var qr = {
            createElement: Br,
            createTextNode: Nr,
            setInitialProperties: Ur,
            diffProperties: Fr,
            updateProperties: Hr,
            diffHydratedProperties: Wr,
            diffHydratedText: Kr,
            warnForUnmatchedText: function() {},
            warnForDeletedHydratableElement: function() {},
            warnForDeletedHydratableText: function() {},
            warnForInsertedHydratedElement: function() {},
            warnForInsertedHydratedText: function() {},
            restoreControlledState: function(e, t, n) {
                switch (t) {
                    case "input":
                        if (It(e, n), t = n.name, "radio" === n.type && null != t) {
                            for (n = e; n.parentNode;) n = n.parentNode;
                            for (n = n.querySelectorAll("input[name=" + JSON.stringify("" + t) + '][type="radio"]'), t = 0; t < n.length; t++) {
                                var r = n[t];
                                if (r !== e && r.form === e.form) {
                                    var o = z(r);
                                    o || f("90"), ot(r), It(r, o)
                                }
                            }
                        }
                        break;
                    case "textarea":
                        yr(e, n);
                        break;
                    case "select":
                        null != (t = n.value) && gr(e, !!n.multiple, t, !1)
                }
            }
        },
        zr = null,
        Gr = null;

    function Vr(e, t) {
        switch (e) {
            case "button":
            case "input":
            case "select":
            case "textarea":
                return !!t.autoFocus
        }
        return !1
    }

    function Yr(e, t) {
        return "textarea" === e || "string" == typeof t.children || "number" == typeof t.children || "object" == typeof t.dangerouslySetInnerHTML && null !== t.dangerouslySetInnerHTML && "string" == typeof t.dangerouslySetInnerHTML.__html
    }
    var Qr = Xn,
        $r = Jn,
        Xr = Zn;

    function Jr(e) {
        for (e = e.nextSibling; e && 1 !== e.nodeType && 3 !== e.nodeType;) e = e.nextSibling;
        return e
    }

    function Zr(e) {
        for (e = e.firstChild; e && 1 !== e.nodeType && 3 !== e.nodeType;) e = e.nextSibling;
        return e
    }
    new Set;
    var eo = [],
        to = -1;

    function no(e) {
        return {
            current: e
        }
    }

    function ro(e) {
        0 > to || (e.current = eo[to], eo[to] = null, to--)
    }

    function oo(e, t) {
        eo[++to] = e.current, e.current = t
    }
    var io = no(d),
        ao = no(!1),
        so = d;

    function co(e) {
        return lo(e) ? so : io.current
    }

    function uo(e, t) {
        var n = e.type.contextTypes;
        if (!n) return d;
        var r = e.stateNode;
        if (r && r.__reactInternalMemoizedUnmaskedChildContext === t) return r.__reactInternalMemoizedMaskedChildContext;
        var o, i = {};
        for (o in n) i[o] = t[o];
        return r && ((e = e.stateNode).__reactInternalMemoizedUnmaskedChildContext = t, e.__reactInternalMemoizedMaskedChildContext = i), i
    }

    function lo(e) {
        return 2 === e.tag && null != e.type.childContextTypes
    }

    function fo(e) {
        lo(e) && (ro(ao), ro(io))
    }

    function po(e) {
        ro(ao), ro(io)
    }

    function _o(e, t, n) {
        io.current !== d && f("168"), oo(io, t), oo(ao, n)
    }

    function mo(e, t) {
        var n = e.stateNode,
            r = e.type.childContextTypes;
        if ("function" != typeof n.getChildContext) return t;
        for (var o in n = n.getChildContext()) o in r || f("108", vt(e) || "Unknown", o);
        return a({}, t, n)
    }

    function go(e) {
        if (!lo(e)) return !1;
        var t = e.stateNode;
        return t = t && t.__reactInternalMemoizedMergedChildContext || d, so = io.current, oo(io, t), oo(ao, ao.current), !0
    }

    function ho(e, t) {
        var n = e.stateNode;
        if (n || f("169"), t) {
            var r = mo(e, so);
            n.__reactInternalMemoizedMergedChildContext = r, ro(ao), ro(io), oo(io, r)
        } else ro(ao);
        oo(ao, t)
    }

    function bo(e, t, n, r) {
        this.tag = e, this.key = n, this.sibling = this.child = this.return = this.stateNode = this.type = null, this.index = 0, this.ref = null, this.pendingProps = t, this.memoizedState = this.updateQueue = this.memoizedProps = null, this.mode = r, this.effectTag = 0, this.lastEffect = this.firstEffect = this.nextEffect = null, this.expirationTime = 0, this.alternate = null
    }

    function vo(e, t, n) {
        var r = e.alternate;
        return null === r ? ((r = new bo(e.tag, t, e.key, e.mode)).type = e.type, r.stateNode = e.stateNode, r.alternate = e, e.alternate = r) : (r.pendingProps = t, r.effectTag = 0, r.nextEffect = null, r.firstEffect = null, r.lastEffect = null), r.expirationTime = n, r.child = e.child, r.memoizedProps = e.memoizedProps, r.memoizedState = e.memoizedState, r.updateQueue = e.updateQueue, r.sibling = e.sibling, r.index = e.index, r.ref = e.ref, r
    }

    function yo(e, t, n) {
        var r = e.type,
            o = e.key;
        if (e = e.props, "function" == typeof r) var i = r.prototype && r.prototype.isReactComponent ? 2 : 0;
        else if ("string" == typeof r) i = 5;
        else switch (r) {
            case ut:
                return Oo(e.children, t, n, o);
            case _t:
                i = 11, t |= 3;
                break;
            case lt:
                i = 11, t |= 2;
                break;
            case dt:
                return (r = new bo(15, e, o, 4 | t)).type = dt, r.expirationTime = n, r;
            case gt:
                i = 16, t |= 2;
                break;
            default:
                e: {
                    switch ("object" == typeof r && null !== r ? r.$$typeof : null) {
                        case ft:
                            i = 13;
                            break e;
                        case pt:
                            i = 12;
                            break e;
                        case mt:
                            i = 14;
                            break e;
                        default:
                            f("130", null == r ? r : typeof r, "")
                    }
                    i = void 0
                }
        }
        return (t = new bo(i, e, o, t)).type = r, t.expirationTime = n, t
    }

    function Oo(e, t, n, r) {
        return (e = new bo(10, e, r, t)).expirationTime = n, e
    }

    function wo(e, t, n) {
        return (e = new bo(6, e, null, t)).expirationTime = n, e
    }

    function Eo(e, t, n) {
        return (t = new bo(4, null !== e.children ? e.children : [], e.key, t)).expirationTime = n, t.stateNode = {
            containerInfo: e.containerInfo,
            pendingChildren: null,
            implementation: e.implementation
        }, t
    }

    function Co(e, t, n) {
        return e = {
            current: t = new bo(3, null, null, t ? 3 : 0),
            containerInfo: e,
            pendingChildren: null,
            earliestPendingTime: 0,
            latestPendingTime: 0,
            earliestSuspendedTime: 0,
            latestSuspendedTime: 0,
            latestPingedTime: 0,
            pendingCommitExpirationTime: 0,
            finishedWork: null,
            context: null,
            pendingContext: null,
            hydrate: n,
            remainingExpirationTime: 0,
            firstBatch: null,
            nextScheduledRoot: null
        }, t.stateNode = e
    }
    var jo = null,
        ko = null;

    function To(e) {
        return function(t) {
            try {
                return e(t)
            } catch (e) {}
        }
    }

    function So(e) {
        "function" == typeof jo && jo(e)
    }

    function Mo(e) {
        "function" == typeof ko && ko(e)
    }
    var Po = !1;

    function xo(e) {
        return {
            expirationTime: 0,
            baseState: e,
            firstUpdate: null,
            lastUpdate: null,
            firstCapturedUpdate: null,
            lastCapturedUpdate: null,
            firstEffect: null,
            lastEffect: null,
            firstCapturedEffect: null,
            lastCapturedEffect: null
        }
    }

    function Io(e) {
        return {
            expirationTime: e.expirationTime,
            baseState: e.baseState,
            firstUpdate: e.firstUpdate,
            lastUpdate: e.lastUpdate,
            firstCapturedUpdate: null,
            lastCapturedUpdate: null,
            firstEffect: null,
            lastEffect: null,
            firstCapturedEffect: null,
            lastCapturedEffect: null
        }
    }

    function Do(e) {
        return {
            expirationTime: e,
            tag: 0,
            payload: null,
            callback: null,
            next: null,
            nextEffect: null
        }
    }

    function Ao(e, t, n) {
        null === e.lastUpdate ? e.firstUpdate = e.lastUpdate = t : (e.lastUpdate.next = t, e.lastUpdate = t), (0 === e.expirationTime || e.expirationTime > n) && (e.expirationTime = n)
    }

    function Lo(e, t, n) {
        var r = e.alternate;
        if (null === r) {
            var o = e.updateQueue,
                i = null;
            null === o && (o = e.updateQueue = xo(e.memoizedState))
        } else o = e.updateQueue, i = r.updateQueue, null === o ? null === i ? (o = e.updateQueue = xo(e.memoizedState), i = r.updateQueue = xo(r.memoizedState)) : o = e.updateQueue = Io(i) : null === i && (i = r.updateQueue = Io(o));
        null === i || o === i ? Ao(o, t, n) : null === o.lastUpdate || null === i.lastUpdate ? (Ao(o, t, n), Ao(i, t, n)) : (Ao(o, t, n), i.lastUpdate = t)
    }

    function Ro(e, t, n) {
        var r = e.updateQueue;
        null === (r = null === r ? e.updateQueue = xo(e.memoizedState) : Bo(e, r)).lastCapturedUpdate ? r.firstCapturedUpdate = r.lastCapturedUpdate = t : (r.lastCapturedUpdate.next = t, r.lastCapturedUpdate = t), (0 === r.expirationTime || r.expirationTime > n) && (r.expirationTime = n)
    }

    function Bo(e, t) {
        var n = e.alternate;
        return null !== n && t === n.updateQueue && (t = e.updateQueue = Io(t)), t
    }

    function No(e, t, n, r, o, i) {
        switch (n.tag) {
            case 1:
                return "function" == typeof(e = n.payload) ? e.call(i, r, o) : e;
            case 3:
                e.effectTag = -1025 & e.effectTag | 64;
            case 0:
                if (null === (o = "function" == typeof(e = n.payload) ? e.call(i, r, o) : e) || void 0 === o) break;
                return a({}, r, o);
            case 2:
                Po = !0
        }
        return r
    }

    function Uo(e, t, n, r, o) {
        if (Po = !1, !(0 === t.expirationTime || t.expirationTime > o)) {
            for (var i = (t = Bo(e, t)).baseState, a = null, s = 0, c = t.firstUpdate, u = i; null !== c;) {
                var l = c.expirationTime;
                l > o ? (null === a && (a = c, i = u), (0 === s || s > l) && (s = l)) : (u = No(e, 0, c, u, n, r), null !== c.callback && (e.effectTag |= 32, c.nextEffect = null, null === t.lastEffect ? t.firstEffect = t.lastEffect = c : (t.lastEffect.nextEffect = c, t.lastEffect = c))), c = c.next
            }
            for (l = null, c = t.firstCapturedUpdate; null !== c;) {
                var d = c.expirationTime;
                d > o ? (null === l && (l = c, null === a && (i = u)), (0 === s || s > d) && (s = d)) : (u = No(e, 0, c, u, n, r), null !== c.callback && (e.effectTag |= 32, c.nextEffect = null, null === t.lastCapturedEffect ? t.firstCapturedEffect = t.lastCapturedEffect = c : (t.lastCapturedEffect.nextEffect = c, t.lastCapturedEffect = c))), c = c.next
            }
            null === a && (t.lastUpdate = null), null === l ? t.lastCapturedUpdate = null : e.effectTag |= 32, null === a && null === l && (i = u), t.baseState = i, t.firstUpdate = a, t.firstCapturedUpdate = l, t.expirationTime = s, e.memoizedState = u
        }
    }

    function Fo(e, t) {
        "function" != typeof e && f("191", e), e.call(t)
    }

    function Ho(e, t, n) {
        for (null !== t.firstCapturedUpdate && (null !== t.lastUpdate && (t.lastUpdate.next = t.firstCapturedUpdate, t.lastUpdate = t.lastCapturedUpdate), t.firstCapturedUpdate = t.lastCapturedUpdate = null), e = t.firstEffect, t.firstEffect = t.lastEffect = null; null !== e;) {
            var r = e.callback;
            null !== r && (e.callback = null, Fo(r, n)), e = e.nextEffect
        }
        for (e = t.firstCapturedEffect, t.firstCapturedEffect = t.lastCapturedEffect = null; null !== e;) null !== (t = e.callback) && (e.callback = null, Fo(t, n)), e = e.nextEffect
    }

    function Wo(e, t) {
        return {
            value: e,
            source: t,
            stack: yt(t)
        }
    }
    var Ko = no(null),
        qo = no(null),
        zo = no(0);

    function Go(e) {
        var t = e.type._context;
        oo(zo, t._changedBits), oo(qo, t._currentValue), oo(Ko, e), t._currentValue = e.pendingProps.value, t._changedBits = e.stateNode
    }

    function Vo(e) {
        var t = zo.current,
            n = qo.current;
        ro(Ko), ro(qo), ro(zo), (e = e.type._context)._currentValue = n, e._changedBits = t
    }
    var Yo = {},
        Qo = no(Yo),
        $o = no(Yo),
        Xo = no(Yo);

    function Jo(e) {
        return e === Yo && f("174"), e
    }

    function Zo(e, t) {
        oo(Xo, t), oo($o, e), oo(Qo, Yo);
        var n = t.nodeType;
        switch (n) {
            case 9:
            case 11:
                t = (t = t.documentElement) ? t.namespaceURI : Cr(null, "");
                break;
            default:
                t = Cr(t = (n = 8 === n ? t.parentNode : t).namespaceURI || null, n = n.tagName)
        }
        ro(Qo), oo(Qo, t)
    }

    function ei(e) {
        ro(Qo), ro($o), ro(Xo)
    }

    function ti(e) {
        $o.current === e && (ro(Qo), ro($o))
    }

    function ni(e, t, n) {
        var r = e.memoizedState;
        r = null === (t = t(n, r)) || void 0 === t ? r : a({}, r, t), e.memoizedState = r, null !== (e = e.updateQueue) && 0 === e.expirationTime && (e.baseState = r)
    }
    var ri = {
        isMounted: function(e) {
            return !!(e = e._reactInternalFiber) && 2 === an(e)
        },
        enqueueSetState: function(e, t, n) {
            e = e._reactInternalFiber;
            var r = ma(),
                o = Do(r = pa(r, e));
            o.payload = t, void 0 !== n && null !== n && (o.callback = n), Lo(e, o, r), _a(e, r)
        },
        enqueueReplaceState: function(e, t, n) {
            e = e._reactInternalFiber;
            var r = ma(),
                o = Do(r = pa(r, e));
            o.tag = 1, o.payload = t, void 0 !== n && null !== n && (o.callback = n), Lo(e, o, r), _a(e, r)
        },
        enqueueForceUpdate: function(e, t) {
            e = e._reactInternalFiber;
            var n = ma(),
                r = Do(n = pa(n, e));
            r.tag = 2, void 0 !== t && null !== t && (r.callback = t), Lo(e, r, n), _a(e, n)
        }
    };

    function oi(e, t, n, r, o, i) {
        var a = e.stateNode;
        return e = e.type, "function" == typeof a.shouldComponentUpdate ? a.shouldComponentUpdate(n, o, i) : !e.prototype || !e.prototype.isPureReactComponent || (!u(t, n) || !u(r, o))
    }

    function ii(e, t, n, r) {
        e = t.state, "function" == typeof t.componentWillReceiveProps && t.componentWillReceiveProps(n, r), "function" == typeof t.UNSAFE_componentWillReceiveProps && t.UNSAFE_componentWillReceiveProps(n, r), t.state !== e && ri.enqueueReplaceState(t, t.state, null)
    }

    function ai(e, t) {
        var n = e.type,
            r = e.stateNode,
            o = e.pendingProps,
            i = co(e);
        r.props = o, r.state = e.memoizedState, r.refs = d, r.context = uo(e, i), null !== (i = e.updateQueue) && (Uo(e, i, o, r, t), r.state = e.memoizedState), "function" == typeof(i = e.type.getDerivedStateFromProps) && (ni(e, i, o), r.state = e.memoizedState), "function" == typeof n.getDerivedStateFromProps || "function" == typeof r.getSnapshotBeforeUpdate || "function" != typeof r.UNSAFE_componentWillMount && "function" != typeof r.componentWillMount || (n = r.state, "function" == typeof r.componentWillMount && r.componentWillMount(), "function" == typeof r.UNSAFE_componentWillMount && r.UNSAFE_componentWillMount(), n !== r.state && ri.enqueueReplaceState(r, r.state, null), null !== (i = e.updateQueue) && (Uo(e, i, o, r, t), r.state = e.memoizedState)), "function" == typeof r.componentDidMount && (e.effectTag |= 4)
    }
    var si = Array.isArray;

    function ci(e, t, n) {
        if (null !== (e = n.ref) && "function" != typeof e && "object" != typeof e) {
            if (n._owner) {
                var r = void 0;
                (n = n._owner) && (2 !== n.tag && f("110"), r = n.stateNode), r || f("147", e);
                var o = "" + e;
                return null !== t && null !== t.ref && "function" == typeof t.ref && t.ref._stringRef === o ? t.ref : ((t = function(e) {
                    var t = r.refs === d ? r.refs = {} : r.refs;
                    null === e ? delete t[o] : t[o] = e
                })._stringRef = o, t)
            }
            "string" != typeof e && f("148"), n._owner || f("254", e)
        }
        return e
    }

    function ui(e, t) {
        "textarea" !== e.type && f("31", "[object Object]" === Object.prototype.toString.call(t) ? "object with keys {" + Object.keys(t).join(", ") + "}" : t, "")
    }

    function li(e) {
        function t(t, n) {
            if (e) {
                var r = t.lastEffect;
                null !== r ? (r.nextEffect = n, t.lastEffect = n) : t.firstEffect = t.lastEffect = n, n.nextEffect = null, n.effectTag = 8
            }
        }

        function n(n, r) {
            if (!e) return null;
            for (; null !== r;) t(n, r), r = r.sibling;
            return null
        }

        function r(e, t) {
            for (e = new Map; null !== t;) null !== t.key ? e.set(t.key, t) : e.set(t.index, t), t = t.sibling;
            return e
        }

        function o(e, t, n) {
            return (e = vo(e, t, n)).index = 0, e.sibling = null, e
        }

        function i(t, n, r) {
            return t.index = r, e ? null !== (r = t.alternate) ? (r = r.index) < n ? (t.effectTag = 2, n) : r : (t.effectTag = 2, n) : n
        }

        function a(t) {
            return e && null === t.alternate && (t.effectTag = 2), t
        }

        function s(e, t, n, r) {
            return null === t || 6 !== t.tag ? ((t = wo(n, e.mode, r)).return = e, t) : ((t = o(t, n, r)).return = e, t)
        }

        function c(e, t, n, r) {
            return null !== t && t.type === n.type ? ((r = o(t, n.props, r)).ref = ci(e, t, n), r.return = e, r) : ((r = yo(n, e.mode, r)).ref = ci(e, t, n), r.return = e, r)
        }

        function u(e, t, n, r) {
            return null === t || 4 !== t.tag || t.stateNode.containerInfo !== n.containerInfo || t.stateNode.implementation !== n.implementation ? ((t = Eo(n, e.mode, r)).return = e, t) : ((t = o(t, n.children || [], r)).return = e, t)
        }

        function l(e, t, n, r, i) {
            return null === t || 10 !== t.tag ? ((t = Oo(n, e.mode, r, i)).return = e, t) : ((t = o(t, n, r)).return = e, t)
        }

        function d(e, t, n) {
            if ("string" == typeof t || "number" == typeof t) return (t = wo("" + t, e.mode, n)).return = e, t;
            if ("object" == typeof t && null !== t) {
                switch (t.$$typeof) {
                    case st:
                        return (n = yo(t, e.mode, n)).ref = ci(e, null, t), n.return = e, n;
                    case ct:
                        return (t = Eo(t, e.mode, n)).return = e, t
                }
                if (si(t) || bt(t)) return (t = Oo(t, e.mode, n, null)).return = e, t;
                ui(e, t)
            }
            return null
        }

        function p(e, t, n, r) {
            var o = null !== t ? t.key : null;
            if ("string" == typeof n || "number" == typeof n) return null !== o ? null : s(e, t, "" + n, r);
            if ("object" == typeof n && null !== n) {
                switch (n.$$typeof) {
                    case st:
                        return n.key === o ? n.type === ut ? l(e, t, n.props.children, r, o) : c(e, t, n, r) : null;
                    case ct:
                        return n.key === o ? u(e, t, n, r) : null
                }
                if (si(n) || bt(n)) return null !== o ? null : l(e, t, n, r, null);
                ui(e, n)
            }
            return null
        }

        function _(e, t, n, r, o) {
            if ("string" == typeof r || "number" == typeof r) return s(t, e = e.get(n) || null, "" + r, o);
            if ("object" == typeof r && null !== r) {
                switch (r.$$typeof) {
                    case st:
                        return e = e.get(null === r.key ? n : r.key) || null, r.type === ut ? l(t, e, r.props.children, o, r.key) : c(t, e, r, o);
                    case ct:
                        return u(t, e = e.get(null === r.key ? n : r.key) || null, r, o)
                }
                if (si(r) || bt(r)) return l(t, e = e.get(n) || null, r, o, null);
                ui(t, r)
            }
            return null
        }

        function m(o, a, s, c) {
            for (var u = null, l = null, f = a, m = a = 0, g = null; null !== f && m < s.length; m++) {
                f.index > m ? (g = f, f = null) : g = f.sibling;
                var h = p(o, f, s[m], c);
                if (null === h) {
                    null === f && (f = g);
                    break
                }
                e && f && null === h.alternate && t(o, f), a = i(h, a, m), null === l ? u = h : l.sibling = h, l = h, f = g
            }
            if (m === s.length) return n(o, f), u;
            if (null === f) {
                for (; m < s.length; m++)(f = d(o, s[m], c)) && (a = i(f, a, m), null === l ? u = f : l.sibling = f, l = f);
                return u
            }
            for (f = r(o, f); m < s.length; m++)(g = _(f, o, m, s[m], c)) && (e && null !== g.alternate && f.delete(null === g.key ? m : g.key), a = i(g, a, m), null === l ? u = g : l.sibling = g, l = g);
            return e && f.forEach(function(e) {
                return t(o, e)
            }), u
        }

        function g(o, a, s, c) {
            var u = bt(s);
            "function" != typeof u && f("150"), null == (s = u.call(s)) && f("151");
            for (var l = u = null, m = a, g = a = 0, h = null, b = s.next(); null !== m && !b.done; g++, b = s.next()) {
                m.index > g ? (h = m, m = null) : h = m.sibling;
                var v = p(o, m, b.value, c);
                if (null === v) {
                    m || (m = h);
                    break
                }
                e && m && null === v.alternate && t(o, m), a = i(v, a, g), null === l ? u = v : l.sibling = v, l = v, m = h
            }
            if (b.done) return n(o, m), u;
            if (null === m) {
                for (; !b.done; g++, b = s.next()) null !== (b = d(o, b.value, c)) && (a = i(b, a, g), null === l ? u = b : l.sibling = b, l = b);
                return u
            }
            for (m = r(o, m); !b.done; g++, b = s.next()) null !== (b = _(m, o, g, b.value, c)) && (e && null !== b.alternate && m.delete(null === b.key ? g : b.key), a = i(b, a, g), null === l ? u = b : l.sibling = b, l = b);
            return e && m.forEach(function(e) {
                return t(o, e)
            }), u
        }
        return function(e, r, i, s) {
            "object" == typeof i && null !== i && i.type === ut && null === i.key && (i = i.props.children);
            var c = "object" == typeof i && null !== i;
            if (c) switch (i.$$typeof) {
                case st:
                    e: {
                        var u = i.key;
                        for (c = r; null !== c;) {
                            if (c.key === u) {
                                if (10 === c.tag ? i.type === ut : c.type === i.type) {
                                    n(e, c.sibling), (r = o(c, i.type === ut ? i.props.children : i.props, s)).ref = ci(e, c, i), r.return = e, e = r;
                                    break e
                                }
                                n(e, c);
                                break
                            }
                            t(e, c), c = c.sibling
                        }
                        i.type === ut ? ((r = Oo(i.props.children, e.mode, s, i.key)).return = e, e = r) : ((s = yo(i, e.mode, s)).ref = ci(e, r, i), s.return = e, e = s)
                    }
                    return a(e);
                case ct:
                    e: {
                        for (c = i.key; null !== r;) {
                            if (r.key === c) {
                                if (4 === r.tag && r.stateNode.containerInfo === i.containerInfo && r.stateNode.implementation === i.implementation) {
                                    n(e, r.sibling), (r = o(r, i.children || [], s)).return = e, e = r;
                                    break e
                                }
                                n(e, r);
                                break
                            }
                            t(e, r), r = r.sibling
                        }(r = Eo(i, e.mode, s)).return = e,
                        e = r
                    }
                    return a(e)
            }
            if ("string" == typeof i || "number" == typeof i) return i = "" + i, null !== r && 6 === r.tag ? (n(e, r.sibling), (r = o(r, i, s)).return = e, e = r) : (n(e, r), (r = wo(i, e.mode, s)).return = e, e = r), a(e);
            if (si(i)) return m(e, r, i, s);
            if (bt(i)) return g(e, r, i, s);
            if (c && ui(e, i), void 0 === i) switch (e.tag) {
                case 2:
                case 1:
                    f("152", (s = e.type).displayName || s.name || "Component")
            }
            return n(e, r)
        }
    }
    var di = li(!0),
        fi = li(!1),
        pi = null,
        _i = null,
        mi = !1;

    function gi(e, t) {
        var n = new bo(5, null, null, 0);
        n.type = "DELETED", n.stateNode = t, n.return = e, n.effectTag = 8, null !== e.lastEffect ? (e.lastEffect.nextEffect = n, e.lastEffect = n) : e.firstEffect = e.lastEffect = n
    }

    function hi(e, t) {
        switch (e.tag) {
            case 5:
                var n = e.type;
                return null !== (t = 1 !== t.nodeType || n.toLowerCase() !== t.nodeName.toLowerCase() ? null : t) && (e.stateNode = t, !0);
            case 6:
                return null !== (t = "" === e.pendingProps || 3 !== t.nodeType ? null : t) && (e.stateNode = t, !0);
            default:
                return !1
        }
    }

    function bi(e) {
        if (mi) {
            var t = _i;
            if (t) {
                var n = t;
                if (!hi(e, t)) {
                    if (!(t = Jr(n)) || !hi(e, t)) return e.effectTag |= 2, mi = !1, void(pi = e);
                    gi(pi, n)
                }
                pi = e, _i = Zr(t)
            } else e.effectTag |= 2, mi = !1, pi = e
        }
    }

    function vi(e) {
        for (e = e.return; null !== e && 5 !== e.tag && 3 !== e.tag;) e = e.return;
        pi = e
    }

    function yi(e) {
        if (e !== pi) return !1;
        if (!mi) return vi(e), mi = !0, !1;
        var t = e.type;
        if (5 !== e.tag || "head" !== t && "body" !== t && !Yr(t, e.memoizedProps))
            for (t = _i; t;) gi(e, t), t = Jr(t);
        return vi(e), _i = pi ? Jr(e.stateNode) : null, !0
    }

    function Oi() {
        _i = pi = null, mi = !1
    }

    function wi(e, t, n) {
        Ei(e, t, n, t.expirationTime)
    }

    function Ei(e, t, n, r) {
        t.child = null === e ? fi(t, null, n, r) : di(t, e.child, n, r)
    }

    function Ci(e, t) {
        var n = t.ref;
        (null === e && null !== n || null !== e && e.ref !== n) && (t.effectTag |= 128)
    }

    function ji(e, t, n, r, o) {
        Ci(e, t);
        var i = 0 != (64 & t.effectTag);
        if (!n && !i) return r && ho(t, !1), Si(e, t);
        n = t.stateNode, it.current = t;
        var a = i ? null : n.render();
        return t.effectTag |= 1, i && (Ei(e, t, null, o), t.child = null), Ei(e, t, a, o), t.memoizedState = n.state, t.memoizedProps = n.props, r && ho(t, !0), t.child
    }

    function ki(e) {
        var t = e.stateNode;
        t.pendingContext ? _o(0, t.pendingContext, t.pendingContext !== t.context) : t.context && _o(0, t.context, !1), Zo(e, t.containerInfo)
    }

    function Ti(e, t, n, r) {
        var o = e.child;
        for (null !== o && (o.return = e); null !== o;) {
            switch (o.tag) {
                case 12:
                    var i = 0 | o.stateNode;
                    if (o.type === t && 0 != (i & n)) {
                        for (i = o; null !== i;) {
                            var a = i.alternate;
                            if (0 === i.expirationTime || i.expirationTime > r) i.expirationTime = r, null !== a && (0 === a.expirationTime || a.expirationTime > r) && (a.expirationTime = r);
                            else {
                                if (null === a || !(0 === a.expirationTime || a.expirationTime > r)) break;
                                a.expirationTime = r
                            }
                            i = i.return
                        }
                        i = null
                    } else i = o.child;
                    break;
                case 13:
                    i = o.type === e.type ? null : o.child;
                    break;
                default:
                    i = o.child
            }
            if (null !== i) i.return = o;
            else
                for (i = o; null !== i;) {
                    if (i === e) {
                        i = null;
                        break
                    }
                    if (null !== (o = i.sibling)) {
                        o.return = i.return, i = o;
                        break
                    }
                    i = i.return
                }
            o = i
        }
    }

    function Si(e, t) {
        if (null !== e && t.child !== e.child && f("153"), null !== t.child) {
            var n = vo(e = t.child, e.pendingProps, e.expirationTime);
            for (t.child = n, n.return = t; null !== e.sibling;) e = e.sibling, (n = n.sibling = vo(e, e.pendingProps, e.expirationTime)).return = t;
            n.sibling = null
        }
        return t.child
    }

    function Mi(e, t, n) {
        if (0 === t.expirationTime || t.expirationTime > n) {
            switch (t.tag) {
                case 3:
                    ki(t);
                    break;
                case 2:
                    go(t);
                    break;
                case 4:
                    Zo(t, t.stateNode.containerInfo);
                    break;
                case 13:
                    Go(t)
            }
            return null
        }
        switch (t.tag) {
            case 0:
                null !== e && f("155");
                var r = t.type,
                    o = t.pendingProps,
                    i = co(t);
                return r = r(o, i = uo(t, i)), t.effectTag |= 1, "object" == typeof r && null !== r && "function" == typeof r.render && void 0 === r.$$typeof ? (i = t.type, t.tag = 2, t.memoizedState = null !== r.state && void 0 !== r.state ? r.state : null, "function" == typeof(i = i.getDerivedStateFromProps) && ni(t, i, o), o = go(t), r.updater = ri, t.stateNode = r, r._reactInternalFiber = t, ai(t, n), e = ji(e, t, !0, o, n)) : (t.tag = 1, wi(e, t, r), t.memoizedProps = o, e = t.child), e;
            case 1:
                return o = t.type, n = t.pendingProps, ao.current || t.memoizedProps !== n ? (o = o(n, r = uo(t, r = co(t))), t.effectTag |= 1, wi(e, t, o), t.memoizedProps = n, e = t.child) : e = Si(e, t), e;
            case 2:
                if (o = go(t), null === e)
                    if (null === t.stateNode) {
                        var a = t.pendingProps,
                            s = t.type;
                        r = co(t);
                        var c = 2 === t.tag && null != t.type.contextTypes;
                        a = new s(a, i = c ? uo(t, r) : d), t.memoizedState = null !== a.state && void 0 !== a.state ? a.state : null, a.updater = ri, t.stateNode = a, a._reactInternalFiber = t, c && ((c = t.stateNode).__reactInternalMemoizedUnmaskedChildContext = r, c.__reactInternalMemoizedMaskedChildContext = i), ai(t, n), r = !0
                    } else {
                        s = t.type, r = t.stateNode, c = t.memoizedProps, i = t.pendingProps, r.props = c;
                        var u = r.context;
                        a = uo(t, a = co(t));
                        var l = s.getDerivedStateFromProps;
                        (s = "function" == typeof l || "function" == typeof r.getSnapshotBeforeUpdate) || "function" != typeof r.UNSAFE_componentWillReceiveProps && "function" != typeof r.componentWillReceiveProps || (c !== i || u !== a) && ii(t, r, i, a), Po = !1;
                        var p = t.memoizedState;
                        u = r.state = p;
                        var _ = t.updateQueue;
                        null !== _ && (Uo(t, _, i, r, n), u = t.memoizedState), c !== i || p !== u || ao.current || Po ? ("function" == typeof l && (ni(t, l, i), u = t.memoizedState), (c = Po || oi(t, c, i, p, u, a)) ? (s || "function" != typeof r.UNSAFE_componentWillMount && "function" != typeof r.componentWillMount || ("function" == typeof r.componentWillMount && r.componentWillMount(), "function" == typeof r.UNSAFE_componentWillMount && r.UNSAFE_componentWillMount()), "function" == typeof r.componentDidMount && (t.effectTag |= 4)) : ("function" == typeof r.componentDidMount && (t.effectTag |= 4), t.memoizedProps = i, t.memoizedState = u), r.props = i, r.state = u, r.context = a, r = c) : ("function" == typeof r.componentDidMount && (t.effectTag |= 4), r = !1)
                    }
                else s = t.type, r = t.stateNode, i = t.memoizedProps, c = t.pendingProps, r.props = i, u = r.context, a = uo(t, a = co(t)), (s = "function" == typeof(l = s.getDerivedStateFromProps) || "function" == typeof r.getSnapshotBeforeUpdate) || "function" != typeof r.UNSAFE_componentWillReceiveProps && "function" != typeof r.componentWillReceiveProps || (i !== c || u !== a) && ii(t, r, c, a), Po = !1, u = t.memoizedState, p = r.state = u, null !== (_ = t.updateQueue) && (Uo(t, _, c, r, n), p = t.memoizedState), i !== c || u !== p || ao.current || Po ? ("function" == typeof l && (ni(t, l, c), p = t.memoizedState), (l = Po || oi(t, i, c, u, p, a)) ? (s || "function" != typeof r.UNSAFE_componentWillUpdate && "function" != typeof r.componentWillUpdate || ("function" == typeof r.componentWillUpdate && r.componentWillUpdate(c, p, a), "function" == typeof r.UNSAFE_componentWillUpdate && r.UNSAFE_componentWillUpdate(c, p, a)), "function" == typeof r.componentDidUpdate && (t.effectTag |= 4), "function" == typeof r.getSnapshotBeforeUpdate && (t.effectTag |= 256)) : ("function" != typeof r.componentDidUpdate || i === e.memoizedProps && u === e.memoizedState || (t.effectTag |= 4), "function" != typeof r.getSnapshotBeforeUpdate || i === e.memoizedProps && u === e.memoizedState || (t.effectTag |= 256), t.memoizedProps = c, t.memoizedState = p), r.props = c, r.state = p, r.context = a, r = l) : ("function" != typeof r.componentDidUpdate || i === e.memoizedProps && u === e.memoizedState || (t.effectTag |= 4), "function" != typeof r.getSnapshotBeforeUpdate || i === e.memoizedProps && u === e.memoizedState || (t.effectTag |= 256), r = !1);
                return ji(e, t, r, o, n);
            case 3:
                return ki(t), null !== (o = t.updateQueue) ? (r = null !== (r = t.memoizedState) ? r.element : null, Uo(t, o, t.pendingProps, null, n), (o = t.memoizedState.element) === r ? (Oi(), e = Si(e, t)) : (r = t.stateNode, (r = (null === e || null === e.child) && r.hydrate) && (_i = Zr(t.stateNode.containerInfo), pi = t, r = mi = !0), r ? (t.effectTag |= 2, t.child = fi(t, null, o, n)) : (Oi(), wi(e, t, o)), e = t.child)) : (Oi(), e = Si(e, t)), e;
            case 5:
                return Jo(Xo.current), (o = Jo(Qo.current)) !== (r = Cr(o, t.type)) && (oo($o, t), oo(Qo, r)), null === e && bi(t), o = t.type, c = t.memoizedProps, r = t.pendingProps, i = null !== e ? e.memoizedProps : null, ao.current || c !== r || ((c = 1 & t.mode && !!r.hidden) && (t.expirationTime = 1073741823), c && 1073741823 === n) ? (c = r.children, Yr(o, r) ? c = null : i && Yr(o, i) && (t.effectTag |= 16), Ci(e, t), 1073741823 !== n && 1 & t.mode && r.hidden ? (t.expirationTime = 1073741823, t.memoizedProps = r, e = null) : (wi(e, t, c), t.memoizedProps = r, e = t.child)) : e = Si(e, t), e;
            case 6:
                return null === e && bi(t), t.memoizedProps = t.pendingProps, null;
            case 16:
                return null;
            case 4:
                return Zo(t, t.stateNode.containerInfo), o = t.pendingProps, ao.current || t.memoizedProps !== o ? (null === e ? t.child = di(t, null, o, n) : wi(e, t, o), t.memoizedProps = o, e = t.child) : e = Si(e, t), e;
            case 14:
                return o = t.type.render, n = t.pendingProps, r = t.ref, ao.current || t.memoizedProps !== n || r !== (null !== e ? e.ref : null) ? (wi(e, t, o = o(n, r)), t.memoizedProps = n, e = t.child) : e = Si(e, t), e;
            case 10:
                return n = t.pendingProps, ao.current || t.memoizedProps !== n ? (wi(e, t, n), t.memoizedProps = n, e = t.child) : e = Si(e, t), e;
            case 11:
                return n = t.pendingProps.children, ao.current || null !== n && t.memoizedProps !== n ? (wi(e, t, n), t.memoizedProps = n, e = t.child) : e = Si(e, t), e;
            case 15:
                return n = t.pendingProps, t.memoizedProps === n ? e = Si(e, t) : (wi(e, t, n.children), t.memoizedProps = n, e = t.child), e;
            case 13:
                return function(e, t, n) {
                    var r = t.type._context,
                        o = t.pendingProps,
                        i = t.memoizedProps,
                        a = !0;
                    if (ao.current) a = !1;
                    else if (i === o) return t.stateNode = 0, Go(t), Si(e, t);
                    var s = o.value;
                    if (t.memoizedProps = o, null === i) s = 1073741823;
                    else if (i.value === o.value) {
                        if (i.children === o.children && a) return t.stateNode = 0, Go(t), Si(e, t);
                        s = 0
                    } else {
                        var c = i.value;
                        if (c === s && (0 !== c || 1 / c == 1 / s) || c != c && s != s) {
                            if (i.children === o.children && a) return t.stateNode = 0, Go(t), Si(e, t);
                            s = 0
                        } else if (s = "function" == typeof r._calculateChangedBits ? r._calculateChangedBits(c, s) : 1073741823, 0 == (s |= 0)) {
                            if (i.children === o.children && a) return t.stateNode = 0, Go(t), Si(e, t)
                        } else Ti(t, r, s, n)
                    }
                    return t.stateNode = s, Go(t), wi(e, t, o.children), t.child
                }(e, t, n);
            case 12:
                e: if (r = t.type, i = t.pendingProps, c = t.memoizedProps, o = r._currentValue, a = r._changedBits, ao.current || 0 !== a || c !== i) {
                    if (t.memoizedProps = i, void 0 !== (s = i.unstable_observedBits) && null !== s || (s = 1073741823), t.stateNode = s, 0 != (a & s)) Ti(t, r, a, n);
                    else if (c === i) {
                        e = Si(e, t);
                        break e
                    }
                    n = (n = i.children)(o), t.effectTag |= 1, wi(e, t, n), e = t.child
                } else e = Si(e, t);
                return e;
            default:
                f("156")
        }
    }

    function Pi(e) {
        e.effectTag |= 4
    }
    var xi = void 0,
        Ii = void 0,
        Di = void 0;

    function Ai(e, t) {
        var n = t.pendingProps;
        switch (t.tag) {
            case 1:
                return null;
            case 2:
                return fo(t), null;
            case 3:
                ei(), po();
                var r = t.stateNode;
                return r.pendingContext && (r.context = r.pendingContext, r.pendingContext = null), null !== e && null !== e.child || (yi(t), t.effectTag &= -3), xi(t), null;
            case 5:
                ti(t), r = Jo(Xo.current);
                var o = t.type;
                if (null !== e && null != t.stateNode) {
                    var i = e.memoizedProps,
                        a = t.stateNode,
                        s = Jo(Qo.current);
                    a = Fr(a, o, i, n, r), Ii(e, t, a, o, i, n, r, s), e.ref !== t.ref && (t.effectTag |= 128)
                } else {
                    if (!n) return null === t.stateNode && f("166"), null;
                    if (e = Jo(Qo.current), yi(t)) n = t.stateNode, o = t.type, i = t.memoizedProps, n[H] = t, n[W] = i, r = Wr(n, o, i, e, r), t.updateQueue = r, null !== r && Pi(t);
                    else {
                        (e = Br(o, n, r, e))[H] = t, e[W] = n;
                        e: for (i = t.child; null !== i;) {
                            if (5 === i.tag || 6 === i.tag) e.appendChild(i.stateNode);
                            else if (4 !== i.tag && null !== i.child) {
                                i.child.return = i, i = i.child;
                                continue
                            }
                            if (i === t) break;
                            for (; null === i.sibling;) {
                                if (null === i.return || i.return === t) break e;
                                i = i.return
                            }
                            i.sibling.return = i.return, i = i.sibling
                        }
                        Ur(e, o, n, r), Vr(o, n) && Pi(t), t.stateNode = e
                    }
                    null !== t.ref && (t.effectTag |= 128)
                }
                return null;
            case 6:
                if (e && null != t.stateNode) Di(e, t, e.memoizedProps, n);
                else {
                    if ("string" != typeof n) return null === t.stateNode && f("166"), null;
                    r = Jo(Xo.current), Jo(Qo.current), yi(t) ? (r = t.stateNode, n = t.memoizedProps, r[H] = t, Kr(r, n) && Pi(t)) : ((r = Nr(n, r))[H] = t, t.stateNode = r)
                }
                return null;
            case 14:
            case 16:
            case 10:
            case 11:
            case 15:
                return null;
            case 4:
                return ei(), xi(t), null;
            case 13:
                return Vo(t), null;
            case 12:
                return null;
            case 0:
                f("167");
            default:
                f("156")
        }
    }

    function Li(e, t) {
        var n = t.source;
        null === t.stack && null !== n && yt(n), null !== n && vt(n), t = t.value, null !== e && 2 === e.tag && vt(e);
        try {
            t && t.suppressReactErrorLogging || console.error(t)
        } catch (e) {
            e && e.suppressReactErrorLogging || console.error(e)
        }
    }

    function Ri(e) {
        var t = e.ref;
        if (null !== t)
            if ("function" == typeof t) try {
                t(null)
            } catch (t) {
                da(e, t)
            } else t.current = null
    }

    function Bi(e) {
        switch (Mo(e), e.tag) {
            case 2:
                Ri(e);
                var t = e.stateNode;
                if ("function" == typeof t.componentWillUnmount) try {
                    t.props = e.memoizedProps, t.state = e.memoizedState, t.componentWillUnmount()
                } catch (t) {
                    da(e, t)
                }
                break;
            case 5:
                Ri(e);
                break;
            case 4:
                Fi(e)
        }
    }

    function Ni(e) {
        return 5 === e.tag || 3 === e.tag || 4 === e.tag
    }

    function Ui(e) {
        e: {
            for (var t = e.return; null !== t;) {
                if (Ni(t)) {
                    var n = t;
                    break e
                }
                t = t.return
            }
            f("160"),
            n = void 0
        }
        var r = t = void 0;
        switch (n.tag) {
            case 5:
                t = n.stateNode, r = !1;
                break;
            case 3:
            case 4:
                t = n.stateNode.containerInfo, r = !0;
                break;
            default:
                f("161")
        }
        16 & n.effectTag && (Sr(t, ""), n.effectTag &= -17);e: t: for (n = e;;) {
            for (; null === n.sibling;) {
                if (null === n.return || Ni(n.return)) {
                    n = null;
                    break e
                }
                n = n.return
            }
            for (n.sibling.return = n.return, n = n.sibling; 5 !== n.tag && 6 !== n.tag;) {
                if (2 & n.effectTag) continue t;
                if (null === n.child || 4 === n.tag) continue t;
                n.child.return = n, n = n.child
            }
            if (!(2 & n.effectTag)) {
                n = n.stateNode;
                break e
            }
        }
        for (var o = e;;) {
            if (5 === o.tag || 6 === o.tag)
                if (n)
                    if (r) {
                        var i = t,
                            a = o.stateNode,
                            s = n;
                        8 === i.nodeType ? i.parentNode.insertBefore(a, s) : i.insertBefore(a, s)
                    } else t.insertBefore(o.stateNode, n);
            else r ? (i = t, a = o.stateNode, 8 === i.nodeType ? i.parentNode.insertBefore(a, i) : i.appendChild(a)) : t.appendChild(o.stateNode);
            else if (4 !== o.tag && null !== o.child) {
                o.child.return = o, o = o.child;
                continue
            }
            if (o === e) break;
            for (; null === o.sibling;) {
                if (null === o.return || o.return === e) return;
                o = o.return
            }
            o.sibling.return = o.return, o = o.sibling
        }
    }

    function Fi(e) {
        for (var t = e, n = !1, r = void 0, o = void 0;;) {
            if (!n) {
                n = t.return;
                e: for (;;) {
                    switch (null === n && f("160"), n.tag) {
                        case 5:
                            r = n.stateNode, o = !1;
                            break e;
                        case 3:
                        case 4:
                            r = n.stateNode.containerInfo, o = !0;
                            break e
                    }
                    n = n.return
                }
                n = !0
            }
            if (5 === t.tag || 6 === t.tag) {
                e: for (var i = t, a = i;;)
                    if (Bi(a), null !== a.child && 4 !== a.tag) a.child.return = a, a = a.child;
                    else {
                        if (a === i) break;
                        for (; null === a.sibling;) {
                            if (null === a.return || a.return === i) break e;
                            a = a.return
                        }
                        a.sibling.return = a.return, a = a.sibling
                    }o ? (i = r, a = t.stateNode, 8 === i.nodeType ? i.parentNode.removeChild(a) : i.removeChild(a)) : r.removeChild(t.stateNode)
            }
            else if (4 === t.tag ? r = t.stateNode.containerInfo : Bi(t), null !== t.child) {
                t.child.return = t, t = t.child;
                continue
            }
            if (t === e) break;
            for (; null === t.sibling;) {
                if (null === t.return || t.return === e) return;
                4 === (t = t.return).tag && (n = !1)
            }
            t.sibling.return = t.return, t = t.sibling
        }
    }

    function Hi(e, t) {
        switch (t.tag) {
            case 2:
                break;
            case 5:
                var n = t.stateNode;
                if (null != n) {
                    var r = t.memoizedProps;
                    e = null !== e ? e.memoizedProps : r;
                    var o = t.type,
                        i = t.updateQueue;
                    t.updateQueue = null, null !== i && (n[W] = r, Hr(n, i, o, e, r))
                }
                break;
            case 6:
                null === t.stateNode && f("162"), t.stateNode.nodeValue = t.memoizedProps;
                break;
            case 3:
            case 15:
            case 16:
                break;
            default:
                f("163")
        }
    }

    function Wi(e, t, n) {
        (n = Do(n)).tag = 3, n.payload = {
            element: null
        };
        var r = t.value;
        return n.callback = function() {
            Ya(r), Li(e, t)
        }, n
    }

    function Ki(e, t, n) {
        (n = Do(n)).tag = 3;
        var r = e.stateNode;
        return null !== r && "function" == typeof r.componentDidCatch && (n.callback = function() {
            null === aa ? aa = new Set([this]) : aa.add(this);
            var n = t.value,
                r = t.stack;
            Li(e, t), this.componentDidCatch(n, {
                componentStack: null !== r ? r : ""
            })
        }), n
    }

    function qi(e, t, n, r, o, i) {
        n.effectTag |= 512, n.firstEffect = n.lastEffect = null, r = Wo(r, n), e = t;
        do {
            switch (e.tag) {
                case 3:
                    return e.effectTag |= 1024, void Ro(e, r = Wi(e, r, i), i);
                case 2:
                    if (t = r, n = e.stateNode, 0 == (64 & e.effectTag) && null !== n && "function" == typeof n.componentDidCatch && (null === aa || !aa.has(n))) return e.effectTag |= 1024, void Ro(e, r = Ki(e, t, i), i)
            }
            e = e.return
        } while (null !== e)
    }

    function zi(e) {
        switch (e.tag) {
            case 2:
                fo(e);
                var t = e.effectTag;
                return 1024 & t ? (e.effectTag = -1025 & t | 64, e) : null;
            case 3:
                return ei(), po(), 1024 & (t = e.effectTag) ? (e.effectTag = -1025 & t | 64, e) : null;
            case 5:
                return ti(e), null;
            case 16:
                return 1024 & (t = e.effectTag) ? (e.effectTag = -1025 & t | 64, e) : null;
            case 4:
                return ei(), null;
            case 13:
                return Vo(e), null;
            default:
                return null
        }
    }
    xi = function() {}, Ii = function(e, t, n) {
        (t.updateQueue = n) && Pi(t)
    }, Di = function(e, t, n, r) {
        n !== r && Pi(t)
    };
    var Gi = Qr(),
        Vi = 2,
        Yi = Gi,
        Qi = 0,
        $i = 0,
        Xi = !1,
        Ji = null,
        Zi = null,
        ea = 0,
        ta = -1,
        na = !1,
        ra = null,
        oa = !1,
        ia = !1,
        aa = null;

    function sa() {
        if (null !== Ji)
            for (var e = Ji.return; null !== e;) {
                var t = e;
                switch (t.tag) {
                    case 2:
                        fo(t);
                        break;
                    case 3:
                        ei(), po();
                        break;
                    case 5:
                        ti(t);
                        break;
                    case 4:
                        ei();
                        break;
                    case 13:
                        Vo(t)
                }
                e = e.return
            }
        Zi = null, ea = 0, ta = -1, na = !1, Ji = null, ia = !1
    }

    function ca(e) {
        for (;;) {
            var t = e.alternate,
                n = e.return,
                r = e.sibling;
            if (0 == (512 & e.effectTag)) {
                t = Ai(t, e);
                var o = e;
                if (1073741823 === ea || 1073741823 !== o.expirationTime) {
                    var i = 0;
                    switch (o.tag) {
                        case 3:
                        case 2:
                            var a = o.updateQueue;
                            null !== a && (i = a.expirationTime)
                    }
                    for (a = o.child; null !== a;) 0 !== a.expirationTime && (0 === i || i > a.expirationTime) && (i = a.expirationTime), a = a.sibling;
                    o.expirationTime = i
                }
                if (null !== t) return t;
                if (null !== n && 0 == (512 & n.effectTag) && (null === n.firstEffect && (n.firstEffect = e.firstEffect), null !== e.lastEffect && (null !== n.lastEffect && (n.lastEffect.nextEffect = e.firstEffect), n.lastEffect = e.lastEffect), 1 < e.effectTag && (null !== n.lastEffect ? n.lastEffect.nextEffect = e : n.firstEffect = e, n.lastEffect = e)), null !== r) return r;
                if (null === n) {
                    ia = !0;
                    break
                }
                e = n
            } else {
                if (null !== (e = zi(e))) return e.effectTag &= 511, e;
                if (null !== n && (n.firstEffect = n.lastEffect = null, n.effectTag |= 512), null !== r) return r;
                if (null === n) break;
                e = n
            }
        }
        return null
    }

    function ua(e) {
        var t = Mi(e.alternate, e, ea);
        return null === t && (t = ca(e)), it.current = null, t
    }

    function la(e, t, n) {
        Xi && f("243"), Xi = !0, t === ea && e === Zi && null !== Ji || (sa(), ea = t, ta = -1, Ji = vo((Zi = e).current, null, ea), e.pendingCommitExpirationTime = 0);
        var r = !1;
        for (na = !n || ea <= Vi;;) {
            try {
                if (n)
                    for (; null !== Ji && !Va();) Ji = ua(Ji);
                else
                    for (; null !== Ji;) Ji = ua(Ji)
            } catch (t) {
                if (null === Ji) r = !0, Ya(t);
                else {
                    null === Ji && f("271");
                    var o = (n = Ji).return;
                    if (null === o) {
                        r = !0, Ya(t);
                        break
                    }
                    qi(e, o, n, t, 0, ea), Ji = ca(n)
                }
            }
            break
        }
        if (Xi = !1, r) return null;
        if (null === Ji) {
            if (ia) return e.pendingCommitExpirationTime = t, e.current.alternate;
            na && f("262"), 0 <= ta && setTimeout(function() {
                    var t = e.current.expirationTime;
                    0 !== t && (0 === e.remainingExpirationTime || e.remainingExpirationTime < t) && Na(e, t)
                }, ta),
                function(e) {
                    null === Ea && f("246"), Ea.remainingExpirationTime = e
                }(e.current.expirationTime)
        }
        return null
    }

    function da(e, t) {
        var n;
        e: {
            for (Xi && !oa && f("263"), n = e.return; null !== n;) {
                switch (n.tag) {
                    case 2:
                        var r = n.stateNode;
                        if ("function" == typeof n.type.getDerivedStateFromCatch || "function" == typeof r.componentDidCatch && (null === aa || !aa.has(r))) {
                            Lo(n, e = Ki(n, e = Wo(t, e), 1), 1), _a(n, 1), n = void 0;
                            break e
                        }
                        break;
                    case 3:
                        Lo(n, e = Wi(n, e = Wo(t, e), 1), 1), _a(n, 1), n = void 0;
                        break e
                }
                n = n.return
            }
            3 === e.tag && (Lo(e, n = Wi(e, n = Wo(t, e), 1), 1), _a(e, 1)),
            n = void 0
        }
        return n
    }

    function fa() {
        var e = 2 + 25 * (1 + ((ma() - 2 + 500) / 25 | 0));
        return e <= Qi && (e = Qi + 1), Qi = e
    }

    function pa(e, t) {
        return e = 0 !== $i ? $i : Xi ? oa ? 1 : ea : 1 & t.mode ? Ia ? 2 + 10 * (1 + ((e - 2 + 15) / 10 | 0)) : 2 + 25 * (1 + ((e - 2 + 500) / 25 | 0)) : 1, Ia && (0 === ja || e > ja) && (ja = e), e
    }

    function _a(e, t) {
        for (; null !== e;) {
            if ((0 === e.expirationTime || e.expirationTime > t) && (e.expirationTime = t), null !== e.alternate && (0 === e.alternate.expirationTime || e.alternate.expirationTime > t) && (e.alternate.expirationTime = t), null === e.return) {
                if (3 !== e.tag) break;
                var n = e.stateNode;
                !Xi && 0 !== ea && t < ea && sa();
                var r = n.current.expirationTime;
                Xi && !oa && Zi === n || Na(n, r), La > Aa && f("185")
            }
            e = e.return
        }
    }

    function ma() {
        return Yi = Qr() - Gi, Vi = 2 + (Yi / 10 | 0)
    }

    function ga(e) {
        var t = $i;
        $i = 2 + 25 * (1 + ((ma() - 2 + 500) / 25 | 0));
        try {
            return e()
        } finally {
            $i = t
        }
    }

    function ha(e, t, n, r, o) {
        var i = $i;
        $i = 1;
        try {
            return e(t, n, r, o)
        } finally {
            $i = i
        }
    }
    var ba = null,
        va = null,
        ya = 0,
        Oa = -1,
        wa = !1,
        Ea = null,
        Ca = 0,
        ja = 0,
        ka = !1,
        Ta = !1,
        Sa = null,
        Ma = null,
        Pa = !1,
        xa = !1,
        Ia = !1,
        Da = null,
        Aa = 1e3,
        La = 0,
        Ra = 1;

    function Ba(e) {
        if (0 !== ya) {
            if (e > ya) return;
            Xr(Oa)
        }
        var t = Qr() - Gi;
        ya = e, Oa = $r(Fa, {
            timeout: 10 * (e - 2) - t
        })
    }

    function Na(e, t) {
        if (null === e.nextScheduledRoot) e.remainingExpirationTime = t, null === va ? (ba = va = e, e.nextScheduledRoot = e) : (va = va.nextScheduledRoot = e).nextScheduledRoot = ba;
        else {
            var n = e.remainingExpirationTime;
            (0 === n || t < n) && (e.remainingExpirationTime = t)
        }
        wa || (Pa ? xa && (Ea = e, Ca = 1, za(e, 1, !1)) : 1 === t ? Ha() : Ba(t))
    }

    function Ua() {
        var e = 0,
            t = null;
        if (null !== va)
            for (var n = va, r = ba; null !== r;) {
                var o = r.remainingExpirationTime;
                if (0 === o) {
                    if ((null === n || null === va) && f("244"), r === r.nextScheduledRoot) {
                        ba = va = r.nextScheduledRoot = null;
                        break
                    }
                    if (r === ba) ba = o = r.nextScheduledRoot, va.nextScheduledRoot = o, r.nextScheduledRoot = null;
                    else {
                        if (r === va) {
                            (va = n).nextScheduledRoot = ba, r.nextScheduledRoot = null;
                            break
                        }
                        n.nextScheduledRoot = r.nextScheduledRoot, r.nextScheduledRoot = null
                    }
                    r = n.nextScheduledRoot
                } else {
                    if ((0 === e || o < e) && (e = o, t = r), r === va) break;
                    n = r, r = r.nextScheduledRoot
                }
            }
        null !== (n = Ea) && n === t && 1 === e ? La++ : La = 0, Ea = t, Ca = e
    }

    function Fa(e) {
        Wa(0, !0, e)
    }

    function Ha() {
        Wa(1, !1, null)
    }

    function Wa(e, t, n) {
        if (Ma = n, Ua(), t)
            for (; null !== Ea && 0 !== Ca && (0 === e || e >= Ca) && (!ka || ma() >= Ca);) ma(), za(Ea, Ca, !ka), Ua();
        else
            for (; null !== Ea && 0 !== Ca && (0 === e || e >= Ca);) za(Ea, Ca, !1), Ua();
        null !== Ma && (ya = 0, Oa = -1), 0 !== Ca && Ba(Ca), Ma = null, ka = !1, qa()
    }

    function Ka(e, t) {
        wa && f("253"), Ea = e, Ca = t, za(e, t, !1), Ha(), qa()
    }

    function qa() {
        if (La = 0, null !== Da) {
            var e = Da;
            Da = null;
            for (var t = 0; t < e.length; t++) {
                var n = e[t];
                try {
                    n._onComplete()
                } catch (e) {
                    Ta || (Ta = !0, Sa = e)
                }
            }
        }
        if (Ta) throw e = Sa, Sa = null, Ta = !1, e
    }

    function za(e, t, n) {
        wa && f("245"), wa = !0, n ? null !== (n = e.finishedWork) ? Ga(e, n, t) : (e.finishedWork = null, null !== (n = la(e, t, !0)) && (Va() ? e.finishedWork = n : Ga(e, n, t))) : null !== (n = e.finishedWork) ? Ga(e, n, t) : (e.finishedWork = null, null !== (n = la(e, t, !1)) && Ga(e, n, t)), wa = !1
    }

    function Ga(e, t, n) {
        var r = e.firstBatch;
        if (null !== r && r._expirationTime <= n && (null === Da ? Da = [r] : Da.push(r), r._defer)) return e.finishedWork = t, void(e.remainingExpirationTime = 0);
        if (e.finishedWork = null, oa = Xi = !0, (n = t.stateNode).current === t && f("177"), 0 === (r = n.pendingCommitExpirationTime) && f("261"), n.pendingCommitExpirationTime = 0, ma(), it.current = null, 1 < t.effectTag)
            if (null !== t.lastEffect) {
                t.lastEffect.nextEffect = t;
                var o = t.firstEffect
            } else o = t;
        else o = t.firstEffect;
        zr = Mn;
        var i = c();
        if (Wn(i)) {
            if ("selectionStart" in i) var a = {
                start: i.selectionStart,
                end: i.selectionEnd
            };
            else e: {
                var s = window.getSelection && window.getSelection();
                if (s && 0 !== s.rangeCount) {
                    a = s.anchorNode;
                    var u = s.anchorOffset,
                        d = s.focusNode;
                    s = s.focusOffset;
                    try {
                        a.nodeType, d.nodeType
                    } catch (e) {
                        a = null;
                        break e
                    }
                    var p = 0,
                        _ = -1,
                        m = -1,
                        g = 0,
                        h = 0,
                        b = i,
                        v = null;
                    t: for (;;) {
                        for (var y; b !== a || 0 !== u && 3 !== b.nodeType || (_ = p + u), b !== d || 0 !== s && 3 !== b.nodeType || (m = p + s), 3 === b.nodeType && (p += b.nodeValue.length), null !== (y = b.firstChild);) v = b, b = y;
                        for (;;) {
                            if (b === i) break t;
                            if (v === a && ++g === u && (_ = p), v === d && ++h === s && (m = p), null !== (y = b.nextSibling)) break;
                            v = (b = v).parentNode
                        }
                        b = y
                    }
                    a = -1 === _ || -1 === m ? null : {
                        start: _,
                        end: m
                    }
                } else a = null
            }
            a = a || {
                start: 0,
                end: 0
            }
        } else a = null;
        for (Gr = {
                focusedElem: i,
                selectionRange: a
            }, Pn(!1), ra = o; null !== ra;) {
            i = !1, a = void 0;
            try {
                for (; null !== ra;) {
                    if (256 & ra.effectTag) {
                        var O = ra.alternate;
                        switch ((u = ra).tag) {
                            case 2:
                                if (256 & u.effectTag && null !== O) {
                                    var w = O.memoizedProps,
                                        E = O.memoizedState,
                                        C = u.stateNode;
                                    C.props = u.memoizedProps, C.state = u.memoizedState;
                                    var j = C.getSnapshotBeforeUpdate(w, E);
                                    C.__reactInternalSnapshotBeforeUpdate = j
                                }
                                break;
                            case 3:
                            case 5:
                            case 6:
                            case 4:
                                break;
                            default:
                                f("163")
                        }
                    }
                    ra = ra.nextEffect
                }
            } catch (e) {
                i = !0, a = e
            }
            i && (null === ra && f("178"), da(ra, a), null !== ra && (ra = ra.nextEffect))
        }
        for (ra = o; null !== ra;) {
            O = !1, w = void 0;
            try {
                for (; null !== ra;) {
                    var k = ra.effectTag;
                    if (16 & k && Sr(ra.stateNode, ""), 128 & k) {
                        var T = ra.alternate;
                        if (null !== T) {
                            var S = T.ref;
                            null !== S && ("function" == typeof S ? S(null) : S.current = null)
                        }
                    }
                    switch (14 & k) {
                        case 2:
                            Ui(ra), ra.effectTag &= -3;
                            break;
                        case 6:
                            Ui(ra), ra.effectTag &= -3, Hi(ra.alternate, ra);
                            break;
                        case 4:
                            Hi(ra.alternate, ra);
                            break;
                        case 8:
                            Fi(E = ra), E.return = null, E.child = null, E.alternate && (E.alternate.child = null, E.alternate.return = null)
                    }
                    ra = ra.nextEffect
                }
            } catch (e) {
                O = !0, w = e
            }
            O && (null === ra && f("178"), da(ra, w), null !== ra && (ra = ra.nextEffect))
        }
        if (S = Gr, T = c(), k = S.focusedElem, O = S.selectionRange, T !== k && l(document.documentElement, k)) {
            Wn(k) && (T = O.start, void 0 === (S = O.end) && (S = T), "selectionStart" in k ? (k.selectionStart = T, k.selectionEnd = Math.min(S, k.value.length)) : window.getSelection && (T = window.getSelection(), w = k[_e()].length, S = Math.min(O.start, w), O = void 0 === O.end ? S : Math.min(O.end, w), !T.extend && S > O && (w = O, O = S, S = w), w = Hn(k, S), E = Hn(k, O), w && E && (1 !== T.rangeCount || T.anchorNode !== w.node || T.anchorOffset !== w.offset || T.focusNode !== E.node || T.focusOffset !== E.offset) && ((C = document.createRange()).setStart(w.node, w.offset), T.removeAllRanges(), S > O ? (T.addRange(C), T.extend(E.node, E.offset)) : (C.setEnd(E.node, E.offset), T.addRange(C))))), T = [];
            for (S = k; S = S.parentNode;) 1 === S.nodeType && T.push({
                element: S,
                left: S.scrollLeft,
                top: S.scrollTop
            });
            for (k.focus(), k = 0; k < T.length; k++)(S = T[k]).element.scrollLeft = S.left, S.element.scrollTop = S.top
        }
        for (Gr = null, Pn(zr), zr = null, n.current = t, ra = o; null !== ra;) {
            o = !1, k = void 0;
            try {
                for (T = r; null !== ra;) {
                    var M = ra.effectTag;
                    if (36 & M) {
                        var P = ra.alternate;
                        switch (O = T, (S = ra).tag) {
                            case 2:
                                var x = S.stateNode;
                                if (4 & S.effectTag)
                                    if (null === P) x.props = S.memoizedProps, x.state = S.memoizedState, x.componentDidMount();
                                    else {
                                        var I = P.memoizedProps,
                                            D = P.memoizedState;
                                        x.props = S.memoizedProps, x.state = S.memoizedState, x.componentDidUpdate(I, D, x.__reactInternalSnapshotBeforeUpdate)
                                    }
                                var A = S.updateQueue;
                                null !== A && (x.props = S.memoizedProps, x.state = S.memoizedState, Ho(S, A, x));
                                break;
                            case 3:
                                var L = S.updateQueue;
                                if (null !== L) {
                                    if (w = null, null !== S.child) switch (S.child.tag) {
                                        case 5:
                                            w = S.child.stateNode;
                                            break;
                                        case 2:
                                            w = S.child.stateNode
                                    }
                                    Ho(S, L, w)
                                }
                                break;
                            case 5:
                                var R = S.stateNode;
                                null === P && 4 & S.effectTag && Vr(S.type, S.memoizedProps) && R.focus();
                                break;
                            case 6:
                            case 4:
                            case 15:
                            case 16:
                                break;
                            default:
                                f("163")
                        }
                    }
                    if (128 & M) {
                        S = void 0;
                        var B = ra.ref;
                        if (null !== B) {
                            var N = ra.stateNode;
                            switch (ra.tag) {
                                case 5:
                                    S = N;
                                    break;
                                default:
                                    S = N
                            }
                            "function" == typeof B ? B(S) : B.current = S
                        }
                    }
                    var U = ra.nextEffect;
                    ra.nextEffect = null, ra = U
                }
            } catch (e) {
                o = !0, k = e
            }
            o && (null === ra && f("178"), da(ra, k), null !== ra && (ra = ra.nextEffect))
        }
        Xi = oa = !1, So(t.stateNode), 0 === (t = n.current.expirationTime) && (aa = null), e.remainingExpirationTime = t
    }

    function Va() {
        return !(null === Ma || Ma.timeRemaining() > Ra) && (ka = !0)
    }

    function Ya(e) {
        null === Ea && f("246"), Ea.remainingExpirationTime = 0, Ta || (Ta = !0, Sa = e)
    }

    function Qa(e, t) {
        var n = Pa;
        Pa = !0;
        try {
            return e(t)
        } finally {
            (Pa = n) || wa || Ha()
        }
    }

    function $a(e, t) {
        if (Pa && !xa) {
            xa = !0;
            try {
                return e(t)
            } finally {
                xa = !1
            }
        }
        return e(t)
    }

    function Xa(e, t) {
        wa && f("187");
        var n = Pa;
        Pa = !0;
        try {
            return ha(e, t)
        } finally {
            Pa = n, Ha()
        }
    }

    function Ja(e) {
        var t = Pa;
        Pa = !0;
        try {
            ha(e)
        } finally {
            (Pa = t) || wa || Wa(1, !1, null)
        }
    }

    function Za(e, t, n, r, o) {
        var i = t.current;
        if (n) {
            var a;
            n = n._reactInternalFiber;
            e: {
                for (2 === an(n) && 2 === n.tag || f("170"), a = n; 3 !== a.tag;) {
                    if (lo(a)) {
                        a = a.stateNode.__reactInternalMemoizedMergedChildContext;
                        break e
                    }(a = a.return) || f("171")
                }
                a = a.stateNode.context
            }
            n = lo(n) ? mo(n, a) : a
        } else n = d;
        return null === t.context ? t.context = n : t.pendingContext = n, t = o, (o = Do(r)).payload = {
            element: e
        }, null !== (t = void 0 === t ? null : t) && (o.callback = t), Lo(i, o, r), _a(i, r), r
    }

    function es(e) {
        var t = e._reactInternalFiber;
        return void 0 === t && ("function" == typeof e.render ? f("188") : f("268", Object.keys(e))), null === (e = un(t)) ? null : e.stateNode
    }

    function ts(e, t, n, r) {
        var o = t.current;
        return Za(e, t, n, o = pa(ma(), o), r)
    }

    function ns(e) {
        if (!(e = e.current).child) return null;
        switch (e.child.tag) {
            case 5:
            default:
                return e.child.stateNode
        }
    }

    function rs(e) {
        var t = e.findFiberByHostInstance;
        return function(e) {
            if ("undefined" == typeof __REACT_DEVTOOLS_GLOBAL_HOOK__) return !1;
            var t = __REACT_DEVTOOLS_GLOBAL_HOOK__;
            if (t.isDisabled || !t.supportsFiber) return !0;
            try {
                var n = t.inject(e);
                jo = To(function(e) {
                    return t.onCommitFiberRoot(n, e)
                }), ko = To(function(e) {
                    return t.onCommitFiberUnmount(n, e)
                })
            } catch (e) {}
            return !0
        }(a({}, e, {
            findHostInstanceByFiber: function(e) {
                return null === (e = un(e)) ? null : e.stateNode
            },
            findFiberByHostInstance: function(e) {
                return t ? t(e) : null
            }
        }))
    }
    var os = Qa,
        is = function(e, t, n) {
            if (Ia) return e(t, n);
            Pa || wa || 0 === ja || (Wa(ja, !1, null), ja = 0);
            var r = Ia,
                o = Pa;
            Pa = Ia = !0;
            try {
                return e(t, n)
            } finally {
                Ia = r, (Pa = o) || wa || Ha()
            }
        },
        as = function() {
            wa || 0 === ja || (Wa(ja, !1, null), ja = 0)
        };

    function ss(e) {
        this._expirationTime = fa(), this._root = e, this._callbacks = this._next = null, this._hasChildren = this._didComplete = !1, this._children = null, this._defer = !0
    }

    function cs() {
        this._callbacks = null, this._didCommit = !1, this._onCommit = this._onCommit.bind(this)
    }

    function us(e, t, n) {
        this._internalRoot = Co(e, t, n)
    }

    function ls(e) {
        return !(!e || 1 !== e.nodeType && 9 !== e.nodeType && 11 !== e.nodeType && (8 !== e.nodeType || " react-mount-point-unstable " !== e.nodeValue))
    }

    function ds(e, t, n, r, o) {
        ls(n) || f("200");
        var i = n._reactRootContainer;
        if (i) {
            if ("function" == typeof o) {
                var a = o;
                o = function() {
                    var e = ns(i._internalRoot);
                    a.call(e)
                }
            }
            null != e ? i.legacy_renderSubtreeIntoContainer(e, t, o) : i.render(t, o)
        } else {
            if (i = n._reactRootContainer = function(e, t) {
                    if (t || (t = !(!(t = e ? 9 === e.nodeType ? e.documentElement : e.firstChild : null) || 1 !== t.nodeType || !t.hasAttribute("data-reactroot"))), !t)
                        for (var n; n = e.lastChild;) e.removeChild(n);
                    return new us(e, !1, t)
                }(n, r), "function" == typeof o) {
                var s = o;
                o = function() {
                    var e = ns(i._internalRoot);
                    s.call(e)
                }
            }
            $a(function() {
                null != e ? i.legacy_renderSubtreeIntoContainer(e, t, o) : i.render(t, o)
            })
        }
        return ns(i._internalRoot)
    }

    function fs(e, t) {
        var n = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null;
        return ls(t) || f("200"),
            function(e, t, n) {
                var r = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : null;
                return {
                    $$typeof: ct,
                    key: null == r ? null : "" + r,
                    children: e,
                    containerInfo: t,
                    implementation: n
                }
            }(e, t, null, n)
    }
    Ue.injectFiberControlledHostComponent(qr), ss.prototype.render = function(e) {
        this._defer || f("250"), this._hasChildren = !0, this._children = e;
        var t = this._root._internalRoot,
            n = this._expirationTime,
            r = new cs;
        return Za(e, t, null, n, r._onCommit), r
    }, ss.prototype.then = function(e) {
        if (this._didComplete) e();
        else {
            var t = this._callbacks;
            null === t && (t = this._callbacks = []), t.push(e)
        }
    }, ss.prototype.commit = function() {
        var e = this._root._internalRoot,
            t = e.firstBatch;
        if (this._defer && null !== t || f("251"), this._hasChildren) {
            var n = this._expirationTime;
            if (t !== this) {
                this._hasChildren && (n = this._expirationTime = t._expirationTime, this.render(this._children));
                for (var r = null, o = t; o !== this;) r = o, o = o._next;
                null === r && f("251"), r._next = o._next, this._next = t, e.firstBatch = this
            }
            this._defer = !1, Ka(e, n), t = this._next, this._next = null, null !== (t = e.firstBatch = t) && t._hasChildren && t.render(t._children)
        } else this._next = null, this._defer = !1
    }, ss.prototype._onComplete = function() {
        if (!this._didComplete) {
            this._didComplete = !0;
            var e = this._callbacks;
            if (null !== e)
                for (var t = 0; t < e.length; t++)(0, e[t])()
        }
    }, cs.prototype.then = function(e) {
        if (this._didCommit) e();
        else {
            var t = this._callbacks;
            null === t && (t = this._callbacks = []), t.push(e)
        }
    }, cs.prototype._onCommit = function() {
        if (!this._didCommit) {
            this._didCommit = !0;
            var e = this._callbacks;
            if (null !== e)
                for (var t = 0; t < e.length; t++) {
                    var n = e[t];
                    "function" != typeof n && f("191", n), n()
                }
        }
    }, us.prototype.render = function(e, t) {
        var n = this._internalRoot,
            r = new cs;
        return null !== (t = void 0 === t ? null : t) && r.then(t), ts(e, n, null, r._onCommit), r
    }, us.prototype.unmount = function(e) {
        var t = this._internalRoot,
            n = new cs;
        return null !== (e = void 0 === e ? null : e) && n.then(e), ts(null, t, null, n._onCommit), n
    }, us.prototype.legacy_renderSubtreeIntoContainer = function(e, t, n) {
        var r = this._internalRoot,
            o = new cs;
        return null !== (n = void 0 === n ? null : n) && o.then(n), ts(t, r, e, o._onCommit), o
    }, us.prototype.createBatch = function() {
        var e = new ss(this),
            t = e._expirationTime,
            n = this._internalRoot,
            r = n.firstBatch;
        if (null === r) n.firstBatch = e, e._next = null;
        else {
            for (n = null; null !== r && r._expirationTime <= t;) n = r, r = r._next;
            e._next = r, null !== n && (n._next = e)
        }
        return e
    }, Ve = os, Ye = is, Qe = as;
    var ps = {
        createPortal: fs,
        findDOMNode: function(e) {
            return null == e ? null : 1 === e.nodeType ? e : es(e)
        },
        hydrate: function(e, t, n) {
            return ds(null, e, t, !0, n)
        },
        render: function(e, t, n) {
            return ds(null, e, t, !1, n)
        },
        unstable_renderSubtreeIntoContainer: function(e, t, n, r) {
            return (null == e || void 0 === e._reactInternalFiber) && f("38"), ds(e, t, n, !1, r)
        },
        unmountComponentAtNode: function(e) {
            return ls(e) || f("40"), !!e._reactRootContainer && ($a(function() {
                ds(null, null, e, !1, function() {
                    e._reactRootContainer = null
                })
            }), !0)
        },
        unstable_createPortal: function() {
            return fs.apply(void 0, arguments)
        },
        unstable_batchedUpdates: Qa,
        unstable_deferredUpdates: ga,
        flushSync: Xa,
        unstable_flushControlled: Ja,
        __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED: {
            EventPluginHub: U,
            EventPluginRegistry: C,
            EventPropagators: ne,
            ReactControlledComponent: Ge,
            ReactDOMComponentTree: G,
            ReactDOMEventListener: Ln
        },
        unstable_createRoot: function(e, t) {
            return new us(e, !0, null != t && !0 === t.hydrate)
        }
    };
    rs({
        findFiberByHostInstance: K,
        bundleType: 0,
        version: "16.4.0",
        rendererPackageName: "react-dom"
    });
    var _s = {
            default: ps
        },
        ms = _s && ps || _s;
    e.exports = ms.default ? ms.default : ms
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return ke
    });
    var r = n(112),
        o = n(174),
        i = n(474),
        a = n(469),
        s = n(252),
        c = n(1),
        u = n(292),
        l = n(406),
        d = n(427),
        f = n(309),
        p = n(268),
        _ = n(442),
        m = n(187),
        g = n(256),
        h = n(420),
        b = n(445),
        v = n(464),
        y = n(425),
        O = n(124),
        w = n(66),
        E = n(468);
    var C = 4,
        j = 5,
        k = 6,
        T = 7,
        S = 9,
        M = 11,
        P = 12,
        x = 13,
        I = 14,
        D = 16,
        A = 19,
        L = 20,
        R = 23,
        B = 2e3,
        N = "_im_media_selector",
        U = "_im_media_fwd",
        F = "_im_replied_content",
        H = "_im_fwd_close",
        W = "_im_remove_replied",
        K = "_im_peer_mute_unmute",
        q = "_im_peer_return_to_chat",
        z = "_mr_button_accept",
        G = "_mr_button_reject",
        V = "_im_submit_btn",
        Y = "_im_media_preview",
        Q = "_im_chat_audio_input_parent";

    function $(e, t) {
        if (!e) return !1;
        window.tooltips && tooltips.hide(e, t)
    }

    function X(e, t, n, o, i, a) {
        var s = !(arguments.length > 6 && void 0 !== arguments[6]) || arguments[6];
        if (ye(t, o)) return Promise.resolve(!1);
        var u = oe(o);
        u.getBoundAttach(n.message) && (n.message = ""), n.share_url = u.getShareUrl(), n.cancelled_shares = u.getCancelledShares();
        var l, d = Object(_.random)(),
            f = {
                peerId: t,
                messageId: "rid" + d,
                flags: r.FLAG_OUTBOUND,
                date: intval(Date.now() / 1e3) - o.get().timeshift,
                subject: "",
                text: Object(c.replaceSpecialSymbols)(clean(n.message)).replace(/\n/gi, "<br>"),
                local: !0,
                kludges: {
                    emoji: !0,
                    from_admin: o.get().gid ? vk.id : null
                },
                type: r.ADD_MESSAGE,
                attaches: (l = n.attaches, l.map(function(e) {
                    return {
                        id: e[1],
                        type: e[0],
                        kind: e[2] || null
                    }
                }))
            };
        return n.rid = d, n.mess = f, e(t, n), o.get().longpoll.push([f]), s && a().clearText(t, o), i().newMessage(o), Promise.resolve(!0)
    }

    function J(e, t, n, r, o, i, a) {
        var s = arguments.length > 7 && void 0 !== arguments[7] && arguments[7];
        s || (s = e.get().peer);
        var c = oe(e),
            u = Z(c, a),
            l = u ? c.dData.attaches.map(function(e) {
                return [e.type, e.id]
            }) : [],
            d = {
                message: "",
                attaches: [].concat(l, i)
            };
        a && extend(d, a), ee(e, t, !1).then(function() {
            return X(n, s, d, e, t, r, !1).then(function(n) {
                return u && de(e, o, t), Promise.resolve(n)
            })
        }).catch(function(t) {
            debugLog(t), re(e, o)
        })
    }

    function Z(e, t) {
        var n = e.dData,
            r = t && t.sticker_referrer,
            o = r && 0 === r.indexOf("suggestion");
        return (!n.txt.trim() || o) && 0 === n.attaches.filter(function(e) {
            return "reply" !== e.type
        }).length
    }

    function ee(e, t, n) {
        return e.get().tabs[e.get().peer].skipped > 0 ? (t().loadingPeer(e), e.setState({
            no_moving_down: !0
        }), e.set(s.changePeer.bind(null, e.get().peer, !1, !1)).then(function() {
            return e.set(s.loadPeer.bind(null, e.get().peer, !0, -1, !1))
        }).then(function() {
            return t().changePeer(e, !1), e.setState({
                no_moving_down: !1
            }), n
        })) : Promise.resolve(n)
    }

    function te(e, t, n, r) {
        return !e.get().delayed_ts && setTimeout(function() {
            e.set(s.setDelayedMessage.bind(null, !1, !1)).then(function() {
                n.apply(void 0, function(e) {
                    if (Array.isArray(e)) {
                        for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                        return n
                    }
                    return Array.from(e)
                }(r))
            })
        }, t)
    }

    function ne() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : getLang("mail_send_error"),
            t = getLang("global_error");
        showFastBox({
            title: t
        }, e, getLang("mail_ok"), function() {
            nav.reload({
                force: !0
            })
        })
    }

    function re(e, t) {
        document.activeElement && document.activeElement.blur(), ne();
        var n = geByClass1("_im_send", t);
        return e.set(s.toggleSendingAbility.bind(null, !0)).then(function() {
            Object(c.lockButton)(n)
        })
    }

    function oe(e) {
        return e.get().tfdraft || new y.ImDraft
    }

    function ie(e, t, n, r, o, i) {
        var a = arguments,
            d = Object(l.getPeer)(e),
            f = Object(l.getCurrentKeyboard)(e) || {},
            p = f.one_time,
            _ = void 0 !== p && p,
            g = f.author_id,
            b = geByClass1("_im_send", r);
        return Promise.resolve().then(function() {
            if (Object(l.isSendingAvailable)(e)) {
                if (Object(s.isAnythingLoading)(e.get()) || !Object(c.isFullyLoadedTab)(e, e.get().peer)) {
                    var r = te(e, B, ie, Object(m.toArray)(a));
                    return e.set(s.setDelayedMessage.bind(null, !0, r)).then(function() {
                        Object(c.lockButton)(b)
                    })
                }
                return clearTimeout(e.get().delayed_ts), e.set(s.setDelayedMessage.bind(null, !1, !1)).then(function() {
                    return Object(c.unlockButton)(b)
                }).then(ee.bind(null, e, t)).then(function() {
                    var r = Object(h.decodeHTMLEntities)(i.action.label);
                    Object(c.isChatPeer)(d) && (r = "@" + Object(w.oCacheGet)(e, g).link.slice(1) + " " + r);
                    return Object(u.statlogsValueEvent)("message_send_from_keyboard", 0, e.get().id, d, g), X(n, d, {
                        message: r,
                        attaches: [],
                        payload: Object(h.decodeHTMLEntities)(i.action.payload)
                    }, e, t, o, !1)
                }).then(function() {
                    return _ ? e.set(s.deleteKeyboard.bind(null, d)) : Promise.resolve()
                }).then(function() {
                    return o().fixKeyboard()
                })
            }
        }).catch(function(t) {
            debugLog(t), re(e, r)
        })
    }

    function ae(e, t, n, o, i, a) {
        var u = arguments,
            d = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : [];
        return Promise.resolve().then(function() {
            var f = geByClass1("_im_send", o);
            if (!Object(l.isSendingAvailable)(e)) return !1;
            if (Object(s.isAnythingLoading)(e.get()) || !Object(c.isFullyLoadedTab)(e, e.get().peer)) {
                var p = te(e, B, ae, Object(m.toArray)(u));
                return e.set(s.setDelayedMessage.bind(null, !0, p)).then(function() {
                    Object(c.lockButton)(f)
                })
            }
            clearTimeout(e.get().delayed_ts), i().saveText(e);
            var _ = !1,
                g = oe(e),
                h = g.dData.attaches.map(function(e) {
                    if ("poll" == e.type) {
                        var t = a.pollData();
                        return t || (_ = !0), [e.type, e.id, t]
                    }
                    return [e.type, e.id]
                }).concat(d);
            if (_) return !1;
            var b = e.set(s.setDelayedMessage.bind(null, !1, !1)).then(function() {
                    Object(c.unlockButton)(f)
                }),
                y = Object(l.getPeer)(e);
            return b.then(ee.bind(null, e, t)).then(function() {
                var a = g.dData.txt,
                    u = t().getEditingMessage();
                if (u || a || h.length) {
                    if (u) return a || h.length && !g.hasOnlyReplies(u) ? Object(c.isMessageTooLong)(a) ? void showFastBox(getLang("global_error"), getLang("mail_err_edit_too_long")) : (t().cancelEditing(), void(Object(v.wasMessageReallyModified)(e, u, g) && (Object(v.replaceMsgAfterEdit)(e, u, a, h, g.getShareUrl(), g.getCancelledShares()), t().sendEditMessage(e, u), e.get().longpoll.push([Object(r.editMessageLocallyEvent)(u)])))) : void
                    function(e, t, n, r) {
                        var o = e.get(),
                            i = o.peer,
                            a = showFastBox({
                                title: getLang("mail_dialog_msg_delete_title"),
                                dark: 1
                            }, getLang("mail_dialog_msg_delete_for_all"), getLang("mail_delete"), function(e) {
                                Object(s.removeMessageSend)([r], i, null, "deleteforall", o), a.hide(), t().cancelEditing()
                            }, getLang("global_cancel"), function() {
                                a.hide(), ce(geByClass1("_im_text", n))
                            })
                    }(e, t, o, u.messageId);
                    var l = Object(c.splitMessageToParts)(a, h).map(function(r) {
                        return X(n, y, {
                            message: r.msgText || "",
                            attaches: r.attaches || []
                        }, e, t, i)
                    });
                    return Promise.all(l)
                }
            })
        }).catch(function(t) {
            debugLog(t), re(e, o)
        })
    }

    function se(e, t, n, r, o, i, a) {
        var u = void 0,
            d = debounce(function(e, t, n) {
                var r = e.get().peer,
                    o = Emoji.val(n);
                Object(c.isReservedPeer)(r) || oe(e).dData.txt == o || ye(r, e) || (t.checkMessageURLs(o, !0, B), oe(e).setText(o))
            }.bind(null, e, n), 500);
        var f = Emoji.init(geByClass1("_im_text", t), {
            ttDiff: 93,
            rPointer: !0,
            ref: "im",
            onSend: function() {
                return Ce(e, t).then(function(e) {
                    return e && r([])
                })
            },
            controlsCont: t,
            forceTxt: !e.get().editable,
            checkEditable: function(n, r) {
                var o = e.get().peer,
                    i = Emoji.val(r);
                Object(c.isReservedPeer)(o) || ye(o, e) || oe(e).dData.txt == i || !i || function(e) {
                    var t = e.get().peer;
                    Object(c.isFullyLoadedTab)(e, t) && !Object(l.isAnyMessageBeingEdited)(e) && Date.now() - (Object(l.getTab)(e, t).lastTyping || 0) > 1e3 * s.ACTIVITY_PERIOD && e.set(s.sendTyping.bind(null, t))
                }(e), je(e, t, i), d(r);
                var f = t.offsetHeight;
                if (u && u !== f) {
                    var p = a().updateScroll();
                    a().scrollFix(e, e.get().peer, p)
                }
                u = f
            },
            onStickerSend: function(e, t, n) {
                return o([
                    ["sticker", e, n]
                ], {
                    sticker_referrer: t
                })
            },
            uploadActions: i
        });
        return Emoji.emojiLoadMore(f), e.setState({
            emojiOptId: f
        }), f
    }

    function ce(e) {
        Emoji.focus(e, !0), setTimeout(Emoji.correctCaret.pbind(e), 10)
    }

    function ue(e, t, n, r) {
        var o = e.getFwdRaw(),
            i = t.querySelector("." + U),
            a = t.parentNode.querySelector("." + F);
        if (!(Object(l.getCurrentKeyboard)(r) || {}).hide && o && n.toggleKeyboard(!0), i.innerHTML = "", a.innerHTML = "", o) {
            var s = function(e, t) {
                    if (e.get().isEditing) {
                        var n = Object(c.getNowEditingMessage)(e);
                        return n && Object(d.hasReply)(n)
                    }
                    return "reply" === t.type
                }(r, o),
                u = s ? a : i,
                f = o.object;
            u.innerHTML = s ? le(f) : function(e, t, n, r) {
                if (n.object && n.object.authorName) {
                    var o = Object(c.renderShortText)(0, "", r.text, !0, Object(O.convertKludgesToAttaches)(r.kludges, 0));
                    return getTemplate("im_attach_mess", {
                        messages: o,
                        text: r.authorName,
                        date: getSmDate(r.date, e.get().timeshift),
                        modifier: "im-fwd_msg"
                    })
                }
                return getTemplate("im_attach_mess", {
                    messages: getLang("mail_title_X_msgs", t.getFwdCount()),
                    text: getLang("mail_im_fwd_msgs_title"),
                    date: "",
                    modifier: ""
                })
            }(r, e, o, f)
        }
    }

    function le(e) {
        var t = Object(c.renderShortText)(0, "", e.text, !0, Object(O.convertKludgesToAttaches)(e.kludges, 0));
        return getTemplate("im_replied_message", {
            authorName: e.authorName,
            text: t
        })
    }

    function de(e, t, n) {
        e.set(s.forwardMessages.bind(null, null, oe(e), !1)).then(function() {
            var r = t.querySelector("." + U),
                o = t.parentNode.querySelector("." + F),
                i = document.querySelector("." + Q + " ." + F);
            o && o.children.length && (o.innerHTML = "", fe(e, n)), i && i.children.length && (i.innerHTML = "", fe(e, n)), r && r.children.length && (r.innerHTML = "", fe(e, n)), je(e, t)
        })
    }

    function fe(e, t) {
        var n = t().updateScroll();
        t().scrollFix(e, e.get().peer, n)
    }
    var pe = "close",
        _e = "open",
        me = "hide";

    function he(e, t, n, r, o, i, a) {
        if (a !== pe && a !== _e && a !== me) throw new Error('Action "' + a + '" not found');
        var s = e.get(),
            u = Object(l.getCurrentKeyboard)(e);
        (Object(c.isCommunityInterface)(e) || !u || s.isEditing) && (a = me);
        var d = a === pe || a === me,
            f = Promise.resolve();
        return d || n.isMounted || (f = n.init()), f.then(function() {
            return toggleClass(t, "im-chat-input_open-keyboard", !d), toggleClass(t, "im-chat-input_close-keyboard", d && a !== me), toggleClass(r, "im_chat-input--keyboard-button_hidden", a === me), n.toggle(s.peer, d, i)
        }).then(function() {
            var t = o().updateScroll();
            return o().scrollFix(e, s.peer, t)
        })
    }

    function be(e, t, n, r, o, i, a, s, u, d, p, _, m) {
        return {
            restoreKeyboard: function() {
                this.toggleKeyboard(!!(ls.get("is_keyboards_hide") || {})[Object(l.getPeer)(e)])
            },
            toggleKeyboard: function() {
                var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : !Object(l.getCurrentKeyboard)(e).hide,
                    n = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                return he(e, r, _, p, i, n, t ? pe : _e)
            },
            initKeyboard: function() {
                if (!e.get().peer || !Object(l.getCurrentKeyboard)(e)) return Promise.resolve();
                var t = !!(ls.get("is_keyboards_hide") || {})[Object(l.getPeer)(e)];
                return he(e, r, _, p, i, !0, t ? pe : _e)
            },
            fixKeyboard: function() {
                var t = Object(l.getCurrentKeyboard)(e),
                    n = void 0;
                return n = t ? t.hide ? pe : _e : me, he(e, r, _, p, i, !0, n)
            },
            hideKeyboard: function() {
                return he(e, r, _, p, i, !1, me)
            },
            restoreDraft: function(e, o) {
                var a = this;
                t.chosenMedias.length > 0 && (e.setState({
                    removingMedias: !0
                }), t.unchooseMedia(), t.chosenMedias = [], e.setState({
                    removingMedias: !1
                }));
                var s = e.get().peer,
                    u = Object(c.isUserPeer)(s) && s != vk.id && !e.get().gid,
                    d = Object(c.isUserPeer)(s) && s != vk.id && !e.get().gid && !inArray(s, e.get().moneyTransferExcept) || Object(c.isCommunityPeer)(s) && e.get().moneyTransferCommAvail && Object(l.getCurrentTab)(e).moneyTransferAvail && !e.get().gid || e.get().gid && e.get().moneyRequestAvail || Object(c.isChatPeer)(s) && Object(l.getCurrentTab)(e).moneyRequestAvail;
                if (toggle(geByClass1("ms_item_gift", r), u && !Object(l.isAnyMessageBeingEdited)(e)), toggle(geByClass1("ms_item_money", r), d && !Object(l.isAnyMessageBeingEdited)(e)), toggle(geByClass1("ms_item_poll", r), Object(c.isChatPeer)(s)), Object(c.isReservedPeer)(s)) return Promise.resolve();
                var f = oe(e);
                return Emoji.val(n) !== f.dData.txt ? function(e, t) {
                    Emoji.val(e, clean(t)), ce(e)
                }(n, f.dData.txt) : ce(n), f.prepareObjects(e.get().gid, o && o.messageId).then(function() {
                    if (!Ee(e, s, n) && s == e.get().peer) {
                        for (var o = f.dData.attaches, c = 0; c < o.length; c++) t.chooseMedia(o[c].type, o[c].id, o[c].object || {});
                        ue(f, r, a, e);
                        var u = i().updateScroll();
                        i().scrollFix(e, s, u), je(e, r, f.dData.txt)
                    }
                })
            },
            sendMessage: function() {
                o([])
            },
            choose: function(e, n, r) {
                t.chooseMedia(e, n, r)
            },
            updateChosenMedia: function(e, n, r) {
                t.updateChosenMedia(e, n, r)
            },
            canAddMedia: function() {
                return !t.hasRestrictingAttach() && !ye(e.get().peer, e)
            },
            isEmpty: function(e) {
                return !trim(Emoji.val(n)) && !oe(e).hasAttaches()
            },
            unchoose: function(e) {
                t.unchooseMedia(e)
            },
            attachCount: function() {
                return t.attachCount()
            },
            progress: function(e, n, r) {
                show(Y), t.showMediaProgress(e, n, r)
            },
            updateState: function(e) {
                this.restoreKeyboard(), Ee(e, e.get().peer, n)
            },
            focusOn: function(e) {
                Emoji.editableFocus(n, !1, !0)
            },
            setDraft: function(e, t) {
                var n = Object(l.getTab)(e, e.get().peer);
                Object(f.doesChatTabHaveFlag)(n, 1024) && !e.get().gid || (m.update(), e.setState({
                    tfdraft: t
                }), t && this.restoreDraft(e, i().getEditingMessage()))
            },
            clearText: function(e, o) {
                oe(o).clear(), t.cancelCheckUrl(), t.unchooseMedia(), t.chosenMedias = [], Emoji.val(n, ""), de(o, r, i);
                var a = i().updateScroll();
                i().scrollFix(o, o.get().peer, a)
            },
            attachMessages: function(e, t) {
                if (e.get().peer === t) {
                    ue(oe(e), r, this, e);
                    var n = i().updateScroll();
                    i().scrollFix(e, t, n), je(e, r)
                }
            },
            cancelRecording: function() {
                d.cancelRecording()
            },
            reHeight: function(e) {
                var t = i().updateScroll();
                i().scrollFix(e, e.get().peer, t)
            },
            isBlocked: function() {
                return ye(e.get().peer, e)
            },
            toggleStickers: function(e, t) {
                Emoji.toggleStickers(e.get().emojiOptId, !t)
            },
            saveText: function(e) {
                oe(e).setText(Emoji.val(geByClass1("_im_text", r)))
            },
            unmount: function() {
                Object(g.destroyModule)(u), t.destroy(), s.unmount(), _.unmount(), m.unmount(), Emoji.destroy(e.get().emojiOptId), d.unmount()
            }
        }
    }

    function ve(e, t) {
        return !!Object(c.isChatPeer)(e) && t.get().tabs[e].data.kicked
    }

    function ye(e, t) {
        return ve(e, t) || Object(l.getTab)(t, e) && Object(l.getTab)(t, e).block_error > 0 || Object(c.isLocksAvailable)(t) && Object(c.isPeerBlocked)(e, t)
    }

    function Oe(e, t) {
        e.disabled = !0, e.contentEditable = "false", addClass(e, "im-chat-input--text_disabled"), addClass(t, "im-chat-input_error"), addClass(geByClass1("_im_page_history"), "is_tf_blocked")
    }

    function we(e, t) {
        e.disabled = !1, e.contentEditable = "true", removeClass(e, "im-chat-input--text_disabled"), removeClass(t, "im-chat-input_error"), removeClass(geByClass1("_im_page_history"), "is_tf_blocked")
    }

    function Ee(e, t, n) {
        var r = gpeByClass("_im_chat_input_parent", n),
            o = geByClass1("_im_chat_input_error", r),
            i = Object(l.getTab)(e, t);
        if (ye(t, e)) {
            Oe(n, r);
            var a = function(e, t, n) {
                switch (n.block_error) {
                    case T:
                    case j:
                        return getLang("mail_peer_deleted");
                    case I:
                        return getLang("mail_community_deleted");
                    case M:
                        return getLang("mail_group_banned_messages");
                    case C:
                    case k:
                    case S:
                    case A:
                    case L:
                    case x:
                        return Object(c.isCommunityPeer)(t) ? getLang("mail_send_privacy_community_error") : getLang("mail_send_privacy_error");
                    case R:
                        var r = Object(w.oCacheGet)(e, t);
                        return langSex(r.sex, getLang("mail_blacklist_user", "raw")).replace("{user}", r.kick_name);
                    case P:
                        return getLang("mail_cant_send_messages_to_community");
                    case D:
                        return getLang("mail_chat_youre_kicked");
                    case 0:
                        if (ve(t, e)) return getLang("mail_chat_youre_kicked");
                        var o = e.get().block_states[t].name;
                        return getLang("mail_community_answering").replace("{username}", o);
                    default:
                        return getLang("mail_send_privacy_error")
                }
            }(e, t, i);
            if (Object(l.isChannel)(e, Object(l.getTab)(e, t)) && addClass(geByClass1("_im_page_history"), "is_channel"), Object(c.isFvkcomgroup)(e, t) && !e.get().gid) {
                addClass(r, "is-f-vkcomgroup");
                var s = inArray(t, e.get().mutedPeers);
                a = i.data.closed || i.data.kicked ? getTemplate("sImPeerReturnToChat", {
                    text: getLang("mail_return_to_vkcomgroup")
                }) : getTemplate("sImPeerMuteUnmute", {
                    text: s ? getLang("mail_im_unmute") : getLang("mail_im_mute"),
                    cls: s ? "im-action_unmute" : "im-action_mute"
                })
            } else removeClass(r, "is-f-vkcomgroup");
            return val(o, a), !0
        }
        return i && i.is_message_request ? (Oe(n, r), addClass(r, "is-message_request"), val(o, getTemplate("sImPeerAcceptOrRejectMessageRequest", {
            cls_accept: z,
            cls_reject: G
        })), !0) : (r.classList.contains("is-message_request") && (we(n, r), removeClass(r, "is-message_request"), val(o, "")), n.disabled && (removeClass(r, "is-f-vkcomgroup"), removeClass(geByClass1("_im_page_history"), "is_channel"), we(n, r), removeClass(r, "is-message_request"), val(o, "")), !1)
    }

    function Ce(e, t, n) {
        return Object(c.isVoiceMessageAvailable)(e).then(function(r) {
            if (!r && !Object(l.isAnyMessageBeingEdited)(e)) return !0;
            var o = null != n ? n : Emoji.val(geByClass1("_im_text", t));
            if (trim(o)) return !Object(l.isAnyMessageBeingEdited)(e) || !Object(c.isMessageTooLong)(o);
            var i = oe(e),
                a = Object(c.getNowEditingMessage)(e);
            return i.hasAttaches() && !i.hasOnlyReplies(a)
        })
    }

    function je(e, t, n) {
        var r = geByClass1("_im_send", t.parentNode);
        $(r, {
            fasthide: !0
        }), Ce(e, t, n).then(function(t) {
            if (Object(l.isAnyMessageBeingEdited)(e)) toggleClass(r, "is_input_empty", !t), attr(r, "aria-label", getLang("mail_im_edit"));
            else {
                toggleClass(r, "im-send-btn_audio", !t), toggleClass(r, "im-send-btn_send", t), t && removeClass(r, "im-send-btn_saudio");
                var n = t ? getLang("mail_send2") : getLang("mail_added_audiomsg");
                attr(r, "aria-label", n)
            }
        })
    }

    function ke(e, t, n, u, d) {
        cur.share_timehash = t.get().share_timehash;
        var f = Object(g.createMutations)(be),
            _ = f.callMutations,
            h = f.bindMutations,
            y = Object(b.mount)(e, t, _),
            O = function(e, t, n) {
                return e.set(s.deliverMessage.bind(null, t, n, {}))
            }.bind(null, t);
        ls.remove("im_send_queue_2" + vk.id), ls.remove("im_send_queue_1" + vk.id);
        var w = Object(p.initQueue)(O, function(e, t, n, o) {
                e.get().longpoll.push([r.failedMessage(t, n.mess, o)])
            }.bind(null, t), {
                store: "ls",
                key: "im_send_queue_" + vk.id,
                waitCommit: !0
            }),
            C = w.pushMessage,
            j = w.inspectQueue,
            k = w.resend,
            T = w.setErrored,
            S = w.complete,
            M = J.bind(null, t, d, C, _, e),
            P = function(e) {
                var t = oe(e).getFwdRaw();
                t && window.showForwardBox({
                    act: "a_show_forward_box",
                    will_fwd: t.id,
                    gid: e.get().gid
                })
            }.bind(null, t);
        hide(geByClass1("ms_items_more_helper", e));
        var x = t.get().mediaTypes || [
            ["photo", getLang("mail_added_photo")],
            ["video", getLang("profile_wall_video")],
            ["audio", getLang("profile_wall_audio")],
            ["doc", getLang("profile_wall_doc")],
            ["map", getLang("profile_wall_map")],
            ["gift", getLang("profile_wall_gift")]
        ];
        (t.get().moneyTransferAvail || t.get().moneyRequestAvail) && x.push(["money", getLang("profile_wall_money")]);
        var I = new MediaSelector(geByClass1(N, e), Y, x, {
                from: "message",
                maxShown: 0,
                vectorIcon: !0,
                ignoreMobile: !0,
                onAddMediaChange: function(n, r, o, i) {
                    return n && _().toggleKeyboard(!0),
                        function(e, t, n, r, o, i, a, c, u) {
                            if (!t.get().removingMedias) {
                                if ("album" === o || "page" === o || "mail" === o || "reply" === o) return !1;
                                if ("share" === o && !a.title) return !1;
                                var l, d;
                                show(Y), i && "string" == typeof o ? (c && oe(t).addBindUrl(c, o, i), oe(t).addAttach(o, i, a)) : (oe(t).syncWithSelector(u), "number" == typeof i && u.chosenMedias[i] && (l = u.chosenMedias[i], d = oe(t), "string" == typeof l[0] && "string" == typeof l[1] && l[1] && d.dData.cancelled.push(l[0] + "," + l[1])));
                                var f = e().updateScroll();
                                if (e().scrollFix(t, t.get().peer, f), t.get().delayed_message && !Object(s.isAnythingLoading)(t.get())) return n([]), !1;
                                je(t, r)
                            }
                        }(d, t, D, e, n, r, o, i, I)
                },
                onMediaChange: function() {
                    return function(e, t, n, r, o) {
                        if (!t.get().removingMedias) {
                            var i = o.getMedias().find(function(e) {
                                return "poll" === e[0]
                            });
                            i && oe(t).addAttach(i[0], i[1], o.pollData(!0, !0)), je(t, r)
                        }
                    }(0, t, 0, e, I)
                },
                editable: 1,
                onChangedSize: function() {
                    var n, r, o = d().updateScroll();
                    d().scrollFix(t, t.get().peer, o), n = e, r = ge(Y).offsetHeight, toggleClass(n, "im-chat-input--overflowed", r > 400)
                },
                sortable: 1,
                teWidth: 150,
                mail: 1,
                teHeight: 100,
                forceToUp: !0,
                toId: t.get().gid ? -t.get().gid : void 0,
                blockPersonal: t.get().gid ? 1 : 0,
                docParams: t.get().gid ? {
                    imhash: t.get().upload_doc_opts.opts.imhash,
                    from: "from_gim"
                } : {}
            }),
            D = ae.bind(null, t, d, C, e, _, I),
            A = function(e, t, n) {
                var r = Emoji.val(geByClass1("_im_text", t));
                Object(l.isAnyMessageBeingEdited)(e) && "" !== r || Ce(e, t).then(function(t) {
                    var o = intval(domData(n.target, "tttype"));
                    (2 === o && !0 !== t || 1 === o && !0 === t || 3 !== o && "" === r) && window.tooltips && tooltips.destroy(n.target, {
                        fasthide: !0
                    });
                    var i = oe(e).dData.attaches.length > 0;
                    if (Object(l.isAnyMessageBeingEdited)(e) && "" === r && !i) return domData(n.target, "tttype", 3), showTooltip(n.target, {
                        text: getLang("mail_delete_for_all"),
                        black: !0,
                        force: 3 !== o,
                        appendParentCls: "_im_chat_input_parent",
                        shift: [-8, -10]
                    });
                    if (!0 !== t) return domData(n.target, "tttype", 1), showTooltip(n.target, {
                        text: getLang("mail_added_audiomsg"),
                        black: !0,
                        force: 1 !== o,
                        appendParentCls: "_im_chat_input_parent",
                        shift: [-8, -10]
                    });
                    domData(n.target, "tttype", 2);
                    var a = e.get().ctrl_submit ? 1 : 0;
                    return showTooltip(n.target, {
                        text: getTemplate("ctrl_submit_hint", {
                            enter_on: a ? "" : "on",
                            ctrl_on: a ? "on" : ""
                        }),
                        dir: "down",
                        shift: [-28, -5],
                        needLeft: !0,
                        className: "im-chat-input--tt",
                        hasover: !0,
                        force: 2 !== o,
                        showdt: 700,
                        zIndex: 200,
                        hidedt: 700,
                        appendParentCls: "_im_chat_input_parent",
                        onCreate: function() {
                            radioBtns.im_submit = {
                                els: Object(m.toArray)(geByClass(V)),
                                val: a
                            }
                        }
                    })
                })
            }.bind(null, t, e),
            L = geByClass1("_im_send", e),
            R = J.bind(null, t, d, C, _, e),
            B = Object(o.mount)(e, t, R, function() {
                addClass(L, "im-send-btn_audio"), removeClass(L, "im-send-btn_static")
            }, function() {
                _().restoreKeyboard()
            });
        toggle(geByClass1("ms_item_poll", e), Object(c.isChatPeer)(Object(l.getPeer)(t))),
            function(e, t) {
                var n = geByClass1("_im_text", e);
                Wall.initComposer(n, {
                    lang: {
                        introText: getLang("profile_mention_start_typing"),
                        noResult: getLang("profile_mention_not_found")
                    },
                    toup: !0,
                    getValue: function() {
                        return t.get().peer > 2e9 ? (window.Emoji && Emoji.editableVal || val)(n) : ""
                    },
                    onShow: function() {
                        addClass(e, "im_mention_shown");
                        var t = data(n, "composer");
                        if (t && t.wdd && t.wdd.shown) {
                            var r = 0,
                                o = !1,
                                i = function() {
                                    t.ignoredTerm = t.curTerm, t.curTerm = !1, val(t.wddInput, ""), Composer.toggleSelectList(t)
                                };
                            each(t.wdd.shown, function() {
                                this[0] && (r++, "@" + t.curTerm == this[2] && (o = !0))
                            }), !r || o && 1 == r ? i() : cancelStackPush("im_mention", i)
                        }
                    },
                    onHide: function() {
                        removeClass(e, "im_mention_shown"), cancelStackFilter("im_mention")
                    },
                    searchKeys: [1, 7],
                    wddOpts: {}
                })
            }(e, t), t.get().textMediaSelector = I, t.set(s.initTextStore.bind(null, j, k, T, S));
        var U = geByClass1("_im_text", e);
        setTimeout(function() {
            Object(l.getPeer)(t) && _().setDraft(t, Object(l.getTabDraft)(Object(l.getCurrentTab)(t))), se(t, e, I, D, M, y, d)
        }, 0);
        var X = de.bind(null, t, e, d),
            ee = function(e, t, n) {
                var r = Object(l.getPeer)(e);
                e.set(s.acceptMessageRequest.bind(null, r)).then(function() {
                    Ee(e, r, t), n()
                }).catch(function() {
                    return ne()
                })
            }.bind(null, t, U, function() {
                var e = d().updateScroll();
                d().scrollFix(t, Object(l.getPeer)(t), e)
            }),
            te = function(e, t, n) {
                var o = Object(l.getPeer)(e);
                e.set(s.rejectMessageRequest.bind(null, o)).then(function() {
                    var t = e.get().tabbedPeers.filter(function(e) {
                        return e.peer !== o
                    });
                    return e.set(s.updateTabbedPeers.bind(null, t, !0))
                }).then(function() {
                    Object(c.isCommunityInterface)(e) && t(e), n(e, o), o === e.get().peer && e.get().longpoll.push([Object(r.resetPeer)()])
                }).catch(function() {
                    return ne()
                })
            }.bind(null, t, n, u),
            re = function(e, t, n, r) {
                var o = e.get().peer,
                    i = inArray(o, e.get().mutedPeers);
                e.set(s.toggleMutePeer.bind(null, o, !i)).then(n().updateState.bind(null, o)), cancelEvent(r)
            }.bind(null, t, e, d),
            ce = function(e, t, n, r) {
                var o = e.get().peer;
                e.set(s.returnToChat.bind(null, o)).then(function(e) {
                    return e.set(s.getPinnedMessage.bind(null, o))
                }).then(n().updateChatTopic.bind(null, o)), cancelEvent(r)
            }.bind(null, t, e, d),
            ue = function(e, t, n) {
                var r = !!intval(domData(n, "val"));
                r !== cur.ctrl_submit && (cur.ctrl_submit = r, e.set(s.changeSubmitSettings.bind(null, r)))
            }.bind(null, t);
        Ee(t, t.get().peer, U);
        var fe = e.querySelector("._im_keyboard_button"),
            pe = Object(i.mount)(null, t, e, ie.bind(null, t, d, C, e, _), _),
            _e = Object(a.mount)(t, e.querySelector("._message_templates_container"), function(e) {
                return Object(E.setHTML)(U, e)
            }, function(t) {
                return toggleClass(e, "im-chat-input--textarea_show-templates", t)
            }),
            me = Object(g.createModule)({
                handlers: function(n, o) {
                    n(L, "click", function() {
                        Promise.resolve().then(function() {
                            return Ce(t, e)
                        }).then(function(e) {
                            if (e || Object(l.isAnyMessageBeingEdited)(t)) D([]);
                            else {
                                var n = oe(t);
                                Z(n) && function(e) {
                                    var t = document.querySelector("." + Q + " ." + F),
                                        n = e.getFwdRaw();
                                    if (n) {
                                        var r = n.object;
                                        t && (t.innerHTML = le(r))
                                    } else t.innerHTML = ""
                                }(n), $(L, {
                                    fasthide: !0
                                }), B.start(), setTimeout(function() {
                                    return removeClass(L, "im-send-btn_saudio")
                                }, 300)
                            }
                        })
                    }), n(L, "mouseover", A), n(U, "focus", function() {
                        t.get().longpoll.push([r.transitionEvent("message")]), cur.focused = t.get().peer
                    }), n(U, "blur", function() {
                        var e = 0 === t.get().peer ? "search" : "default";
                        t.get().longpoll.push([r.transitionEvent(e)]), cur.focused = !1
                    }), n(fe, "click", function() {
                        return _().toggleKeyboard(void 0)
                    }), n(fe, "mouseover", function() {
                        showTooltip(fe, {
                            text: function() {
                                var e = Object(l.getCurrentKeyboard)(t);
                                return !e || e.hide ? getLang("mail_show_keyboard") : getLang("mail_hide_keyboard")
                            },
                            black: !0,
                            shift: [4, 5]
                        })
                    }), o(e.parentNode, "click", K, re), o(e.parentNode, "click", q, ce), o(e.parentNode, "click", W, X), o(e.parentNode, "click", z, ee), o(e.parentNode, "click", G, te), o(e, "click", H, X), o(e, "click", "_im_will_fwd", P), o(e, "keydown", "_im_text", function(e) {
                        return function(e, t, n, r) {
                            if (38 === r.which && n().isEmpty(e) && !t().getEditingMessage() && !Emoji.shown && !hasAccessibilityMode() && !Object(s.isAnythingLoading)(e.get())) {
                                var o = Object(v.findLastMessageToEdit)(e, Object(l.getCurrentTab)(e));
                                o && t().startEditing(Object(l.getMessage)(e, e.get().peer, o))
                            }
                        }(t, d, _, e)
                    }), o(bodyNode, "click", V, ue)
                }
            }),
            he = h(t, I, U, e, D, d, j, y, me, B, fe, pe, _e);
        return he.initKeyboard(), he
    }
}, function(e, t, n) {
    "use strict";

    function r() {
        var e = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || window.MediaDevices && window.MediaDevices.getUserMedia;
        e && !navigator.mediaDevices && (navigator.mediaDevices = navigator.mediaDevices || {}), navigator.mediaDevices && (navigator.mediaDevices.getUserMedia || (navigator.mediaDevices.getUserMedia = function(t) {
            return new Promise(function(n, r) {
                e ? e.call(navigator, t, n, r) : r(new Error("NotSupported"))
            })
        }), navigator.mediaDevices.enumerateDevices || (navigator.mediaDevices.enumerateDevices = function() {
            return new Promise(function(e, t) {
                if (MediaStreamTrack && MediaStreamTrack.getSources) {
                    var n = {
                        audio: "audioinput",
                        video: "videoinput"
                    };
                    return MediaStreamTrack.getSources(function(t) {
                        e(t.map(function(e) {
                            return {
                                label: e.label,
                                kind: n[e.kind],
                                deviceId: e.id,
                                groupId: ""
                            }
                        }))
                    })
                }
                t(new Error("NotSupported"))
            })
        })), window.AudioContext = window.AudioContext || window.webkitAudioContext, window.AudioContext && (window.AudioContext.prototype.createScriptProcessor = window.AudioContext.prototype.createScriptProcessor || window.AudioContext.prototype.createJavaScriptNode)
    }
    n.r(t), n.d(t, "initFailBack", function() {
        return r
    })
}, , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(192),
        o = n(252),
        i = n(1),
        a = n(112),
        s = n(433),
        c = n(256);

    function u(e) {
        return e.which || e.keyCode
    }

    function l(e, t, n, o) {
        var s = u(o);
        if (!layers.visible) {
            if (s >= 49 && s <= 57 && (o.ctrlKey || o.metaKey && browser.mac) && Object(i.isClassicInterface)(t)) return function(e, t) {
                var n = e.get().tabbedPeers[t];
                n && e.get().longpoll.push([Object(a.changePeer)(n.peer, !1, !0, !0)])
            }(t, s - 49), cancelEvent(o);
            inArray(s, r.UP_DOWN_CONTROLS) && e.signal(s, o)
        }
    }

    function d(e, t) {
        var n = browser.mozilla ? "keydown" : "keypress",
            a = Object(s.default)({
                signalTimer: !1
            }),
            d = function(e, t, n) {
                !n || inArray(u(n), r.UNPRINTABLE_KEYS) || Object(o.isSearchingInplace)(e.get().peer, e.get()) || Object(i.isEditableFocused)() || n.ctrlKey || browser.mac && n.metaKey || n.key && 1 !== n.key.length || t.signal("printable", n)
            }.bind(null, e, t),
            f = l.bind(null, t, e, a),
            p = function(e, t, n) {
                u(n) === r.ENTER && e.signal(u(n), n)
            }.bind(null, t, a),
            _ = Object(c.createModule)({
                handlers: function(e, t) {
                    e(document, "keydown", f), e(document, "keyup", p), e(document, n, d)
                }
            });
        return {
            unmount: function() {
                Object(c.destroyModule)(_)
            }
        }
    }
}, , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "updateLocation", function() {
        return a
    }), n.d(t, "updateLazyLocation", function() {
        return s
    });
    var r = window,
        o = r.nav,
        i = r.extend;

    function a(e) {
        var t = i({}, o.objLoc, e);
        Object.keys(t).filter(function(e) {
            return "" === t[e]
        }).forEach(function(e) {
            delete t[e]
        });
        var n = o.toStr(t);
        o.setLoc(n)
    }

    function s() {
        var e = {};
        return {
            scheduleNav: function(t) {
                e = i(e, t)
            },
            commitNav: function() {
                a(e), e = {}
            },
            scheduleNavWithTimeOut: function(t) {
                var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 100;
                e = i(e, t), setTimeout(function() {
                    a(e), e = {}
                }, n)
            }
        }
    }
}, , function(__webpack_module__, __webpack_exports__, __webpack_require__) {
    "use strict";
    __webpack_require__.r(__webpack_exports__), __webpack_require__.d(__webpack_exports__, "topMsg", function() {
        return topMsg
    }), __webpack_require__.d(__webpack_exports__, "topError", function() {
        return topError
    }), __webpack_require__.d(__webpack_exports__, "showMsg", function() {
        return showMsg
    }), __webpack_require__.d(__webpack_exports__, "showGlobalPrg", function() {
        return showGlobalPrg
    });
    var _dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(347),
        _utils_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(269);

    function topMsg(e, t, n) {
        if (n || (n = "#D6E5F7"), e) {
            clearTimeout(window.topMsgTimer);
            var r = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("system_msg");
            r.style.backgroundColor = n, r.innerHTML = e, Object(_dom__WEBPACK_IMPORTED_MODULE_0__.show)(r), t && (window.topMsgTimer = setTimeout(topMsg.pbind(!1), 1e3 * t))
        } else Object(_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("system_msg")
    }

    function topError(text, opts) {
        if (opts || (opts = {}), text.message) {
            var error = text;
            text = "<b>JavaScript error:</b> " + error.message, opts.stack = error.stack, error.stack && __debugMode && (text += "<br/>" + error.stack.replace(/\n/g, "<br/>"));
            try {
                console.log(error.stack)
            } catch (e) {}
        }
        if (!opts.stack) try {
            eval("0 = 1")
        } catch (e) {
            opts.stack = e.stack
        } - 1 != opts.dt && topMsg(text, opts.dt, "#FFB4A3"), __dev || Object(_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("debuglogwrap") || (delete opts.dt, ajax.plainpost("/errors.php", Object(_utils_common__WEBPACK_IMPORTED_MODULE_1__.extend)(opts, {
            msg: opts.msg || text,
            module: (window.cur || {}).module,
            id: vk.id,
            host: locHost,
            lang: vk.lang,
            loc: (window.nav || {}).strLoc,
            realloc: location.toString()
        })))
    }

    function showMsg(e, t, n, r) {
        var o = "msg" + ("msg" !== n ? " " + n : "");
        r && (o += " msg_appear"), e = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.ge)(e);
        var i = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)(n, e),
            a = i || Object(_dom__WEBPACK_IMPORTED_MODULE_0__.domFC)(e),
            s = e.insertBefore(Object(_dom__WEBPACK_IMPORTED_MODULE_0__.ce)("div", {
                className: o,
                innerHTML: '<div class="msg_text">' + t + "</div>"
            }), a);
        i && Object(_dom__WEBPACK_IMPORTED_MODULE_0__.re)(i), setTimeout(_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass.pbind(s, "msg_appear"), 0)
    }

    function showGlobalPrg(e, t) {
        var n = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(e),
            r = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(e),
            o = t || {},
            i = o.w,
            a = void 0 === i ? 32 : i,
            s = o.h,
            c = void 0 === s ? 13 : s,
            u = Object(_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("global_prg");
        u.className = o.cls || "progress", Object(_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(u, {
            left: n[0] + Math.floor((r[0] - a) / 2) + Object(_utils_common__WEBPACK_IMPORTED_MODULE_1__.intval)(o.shift ? o.shift[0] : 0),
            top: n[1] + Math.floor((r[1] - c) / 2) + Object(_utils_common__WEBPACK_IMPORTED_MODULE_1__.intval)(o.shift ? o.shift[1] : 0),
            width: a,
            height: c,
            display: "block",
            "z-index": o.zIndex ? o.zIndex : null
        }), o.hide && (e.style.visibility = "hidden")
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63)),
        i = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.onChange = function(e) {
                r.isControlledOutside || r.setState({
                    value: e.target.value
                }), r.props.onChange && r.props.onChange(e)
            }, r.getRef = function(e) {
                r.element = e
            }, void 0 !== n.value || n.isControlledOutside ? r.isControlledOutside = !0 : r.state = {
                value: n.initialValue || ""
            }, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.alignment,
                n = e.value,
                a = (e.onChange, e.initialValue, e.className),
                s = (e.isControlledOutside, function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["alignment", "value", "onChange", "initialValue", "className", "isControlledOutside"])),
                c = {
                    "Input--left": "left" === t,
                    "Input--center": "center" === t,
                    "Input--right": "right" === t
                };
            return r.createElement("input", i({}, s, {
                className: Object(o.classNames)("Input", c, a),
                ref: this.getRef,
                value: this.isControlledOutside ? n : this.state.value,
                onChange: this.onChange
            }))
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        type: "text",
        initialValue: "",
        alignment: "left"
    }
}, , function(e, t, n) {
    var r = n(322),
        o = n(346),
        i = function(e, t) {
            if (o(e), !r(t) && null !== t) throw TypeError(t + ": can't set as prototype!")
        };
    e.exports = {
        set: Object.setPrototypeOf || ("__proto__" in {} ? function(e, t, r) {
            try {
                (r = n(160)(Function.call, n(413).f(Object.prototype, "__proto__").set, 2))(e, []), t = !(e instanceof Array)
            } catch (e) {
                t = !0
            }
            return function(e, n) {
                return i(e, n), t ? e.__proto__ = n : r(e, n), e
            }
        }({}, !1) : void 0),
        check: i
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return i
    });
    var r = n(451),
        o = (n(96), n(63));

    function i(e) {
        var t = Object(o.classNames)("Progress", {
            "Progress--inverted": e.inverted
        }, e.className);
        return r.createElement("div", {
            className: t
        }, r.createElement("div", {
            className: "Progress__item"
        }), r.createElement("div", {
            className: "Progress__item"
        }), r.createElement("div", {
            className: "Progress__item"
        }))
    }
    i.defaultProps = {
        inverted: !1
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(409),
        i = n(63),
        a = n(1),
        s = n(309),
        c = n(101),
        u = n(217),
        l = n(205),
        d = n(53),
        f = n(203),
        p = n(391);
    var _ = 50,
        m = {
            appendParentCls: "ChatSettingsWrapper"
        },
        g = window,
        h = g.langSex,
        b = g.langNumeric,
        v = g.getSmDate,
        y = o.default.getLang,
        O = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                w.call(r);
                var o = n.store.get(),
                    i = r.getMembers(o),
                    a = r.getAdmins(o);
                return r.state = {
                    showSearch: !1,
                    searchQuery: "",
                    current: "all",
                    all: i,
                    allShowMore: i.length > _,
                    admins: a,
                    adminsShowMore: a.length > _
                }, r.membersMap = i.reduce(function(e, t) {
                    return e[t] = !0, e
                }, {}), r.searchIndexPromise = r.getSearchIndex(i).then(function(e) {
                    r.searchIndex = e
                }), r.invitersCache = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                var t = this,
                    n = e.store.get(),
                    r = this.getMembers(n),
                    o = this.getAdmins(n),
                    i = {
                        removes: [],
                        additions: []
                    },
                    a = r.reduce(function(e, t) {
                        return e[t] = !0, e
                    }, {});
                r.forEach(function(e) {
                    t.membersMap[e] || i.additions.push(e)
                }), Object.keys(this.membersMap).forEach(function(e) {
                    a[e] || i.removes.push(e)
                }), (i.removes.length || i.additions.length) && (this.updateSearchIndex(n, i), this.membersMap = a), this.setState({
                    all: r,
                    allShowMore: this.state.allShowMore && r.length > _,
                    admins: o,
                    adminsShowMore: this.state.adminsShowMore && o.length > _
                })
            }, t.prototype.getMembers = function(e) {
                var t = e.peer,
                    n = e.tabs[t],
                    r = -1 !== (n.memberIds || []).indexOf(n.ownerId),
                    o = (n.adminIds || []).reduce(function(e, t) {
                        return e[t] = !0, e
                    }, {});
                return (r ? [n.ownerId] : []).concat((n.adminIds || []).filter(function(e) {
                    return e !== n.ownerId
                }), (n.memberIds || []).filter(function(e) {
                    return e !== n.ownerId && !o[e]
                }))
            }, t.prototype.getAdmins = function(e) {
                var t = e.peer,
                    n = e.tabs[t];
                return (-1 !== (n.memberIds || []).indexOf(n.ownerId) ? [n.ownerId] : []).concat((n.adminIds || []).filter(function(e) {
                    return e !== n.ownerId
                }))
            }, t.prototype.getCurrentList = function() {
                var e = this.props.store,
                    t = this.state,
                    n = t.current,
                    r = t.showSearch,
                    o = t.searchQuery;
                if (r && o && this.searchIndex) return this.searchIndex.search(o);
                var i = this.state[n],
                    s = Object(a.getChatMembersByIds)(e.get(), i);
                return this.state[n + "ShowMore"] ? s.slice(0, _) : s
            }, t.prototype.getSearchIndex = function(e) {
                var t = window.vkIndexer,
                    n = Object(a.getChatMembersByIds)(this.props.store.get(), e);
                return this.membersMap = n.reduce(function(e, t) {
                    return e[t.id] = !0, e
                }, {}), new Promise(function(e, r) {
                    var o = new t(n, function(e) {
                        return e.name
                    }, function() {
                        e(o)
                    })
                })
            }, t.prototype.updateSearchIndex = function(e, t) {
                var n = Object(a.getChatMembersByIds)(e, t.removes),
                    r = Object(a.getChatMembersByIds)(e, t.additions);
                (this.searchIndex ? Promise.resolve(this.searchIndex) : this.searchIndexPromise).then(function(e) {
                    n.forEach(function(t) {
                        e.remove(t)
                    }), r.forEach(function(t) {
                        e.add(t)
                    })
                })
            }, t.prototype.componentDidMount = function() {
                this.searchInput.addEventListener("keydown", this.onKeydown)
            }, t.prototype.componentWillUnmount = function() {
                this.searchInput.removeEventListener("keydown", this.onKeydown)
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.store,
                    o = t.membersCount,
                    s = t.membersAdded,
                    _ = t.onHideStatus,
                    g = this.state,
                    h = g.current,
                    v = g.showSearch,
                    O = g.searchQuery,
                    w = g.allShowMore,
                    E = g.adminsShowMore,
                    C = n.get(),
                    j = C.peer,
                    k = C.tabs[j],
                    T = this.getCurrentList(),
                    S = this.isAddMemberWidgetShown() ? ["add"].concat(T) : T,
                    M = "all" === h ? w : E,
                    P = k.membersLastSeen,
                    x = {
                        "ChatSettingsMembersWidget--search": !!v
                    },
                    I = k.adminIds.reduce(function(e, t) {
                        return e[t] = !0, e
                    }, {});
                return r.createElement("div", {
                    className: Object(i.classNames)("ChatSettingsMembersWidget", x)
                }, r.createElement("header", {
                    className: "ChatSettingsMembersWidget__header"
                }, r.createElement("input", {
                    placeholder: y("mail_members_search"),
                    className: "ChatSettingsMembersWidget__search",
                    onChange: this.onSearchChange,
                    onInput: this.onSearchChange,
                    onPaste: this.onSearchChange,
                    value: this.state.searchQuery,
                    ref: this.searchInputRef
                }), r.createElement("button", {
                    className: "ChatSettingsMembersWidget__searchIcon",
                    onClick: this.onToggleSearch
                }), r.createElement(c.default, {
                    className: "ChatSettingsMembersWidget__tabs",
                    onTabClick: this.onTabClick
                }, r.createElement("span", {
                    key: "all"
                }, y("mail_settings_everyone") + " ", r.createElement("span", {
                    className: "Tabs__desc"
                }, Object(a.getAliveMembersCount)(k))), k.adminIds.length > 0 && r.createElement("span", {
                    key: "admins"
                }, y("mail_settings_admins") + " ", r.createElement("span", {
                    className: "Tabs__desc"
                }, k.adminIds.length)))), r.createElement("div", {
                    className: "ChatSettingsMembersWidget__list"
                }, r.createElement(u.default, {
                    border: !1
                }, S.length > 0 && S.map(function(t) {
                    if ("add" === t) return r.createElement(l.default, {
                        selectable: !1,
                        border: !1,
                        key: "add",
                        onClick: e.props.showMembersSettings,
                        aside: r.createElement(p.default, {
                            className: "ChatSettingsMembersWidget__blink",
                            shown: s,
                            callback: _
                        }, b(o || 0, y("mail_settings_members_added", "raw")))
                    }, r.createElement("span", {
                        className: "ChatSettingsMembersWidget__add"
                    }, r.createElement("span", null, y("mail_settings_add_members"))));
                    var i = e.getInviter(t.id),
                        c = P && P[t.id] ? Object(a.getLastSeenText)(C, t.id, P[t.id], m) : "";
                    return r.createElement(l.default, {
                        selectable: !1,
                        border: !1,
                        aside: r.createElement(f.default, {
                            adminMap: I,
                            store: n,
                            storeData: C,
                            mid: t.id,
                            onLeave: e.props.onLeave
                        }),
                        key: t.id
                    }, r.createElement(d.default, {
                        photo: t.photo,
                        title: t.name,
                        description: r.createElement("span", {
                            title: i,
                            dangerouslySetInnerHTML: {
                                __html: c
                            }
                        }),
                        href: t.link
                    }))
                }), !S.length && v && O && r.createElement("div", {
                    className: "ChatSettingsMembersWidget__empty"
                }, y("mail_settings_not_found")), !(v && O) && M && r.createElement("div", {
                    className: "ChatSettingsMembersWidget__more",
                    onClick: this.onShowMore
                }, y("mail_settings_show_all_members")))))
            }, t
        }(r.Component),
        w = function() {
            var e = this;
            this.onToggleSearch = function() {
                e.state.showSearch ? e.setState({
                    showSearch: !1,
                    searchQuery: ""
                }) : (e.setState({
                    showSearch: !0
                }), requestAnimationFrame(function() {
                    e.searchInput.focus()
                }))
            }, this.onSearchChange = function(t) {
                t.target.value !== e.state.searchQuery && e.setState({
                    searchQuery: t.target.value
                })
            }, this.onShowMore = function() {
                var t = "all" === e.state.current ? "allShowMore" : "adminsShowMore";
                e.state[t] && e.setState(function(e, t, n) {
                    return t in e ? Object.defineProperty(e, t, {
                        value: n,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : e[t] = n, e
                }({}, t, !1))
            }, this.onTabClick = function(t, n) {
                t.preventDefault(), e.state.current !== n && e.setState({
                    current: n
                })
            }, this.handleDocumentClick = function(t) {
                !e.state.showSearch || e.state.searchQuery || t.target.closest(".ChatSettingsMembersWidget__search") || t.target.closest(".ChatSettingsMembersWidget__searchIcon") || e.setState({
                    showSearch: !1
                })
            }, this.onKeydown = function(t) {
                e.state.showSearch && 27 === t.keyCode && (e.searchInput.blur(), e.setState({
                    showSearch: !1,
                    searchQuery: ""
                }), t.preventDefault(), t.stopPropagation())
            }, this.getInviter = function(t) {
                if (e.invitersCache[t]) return e.invitersCache[t];
                var n = e.props.store.get(),
                    r = n.peer,
                    o = n.tabs[r],
                    i = o.inviters;
                if (!i[t]) return "";
                var c = Object(a.getChatMembersByIds)(n, [i[t][0]])[0],
                    u = v(i[t][2], n.timeshift, !0);
                if (Object(s.isUserOwnerInChat)(o, t)) return e.invitersCache[t] = y("mail_settings_owner"), y("mail_settings_owner");
                if (!c) return e.invitersCache[t] = u, u;
                var l = h(i[t][1], y("mail_chat_member_invited_by_X", "raw")).replace(/{inviter}/, replaceEntities(c.name)) + " " + u;
                return e.invitersCache[t] = l, l
            }, this.isAddMemberWidgetShown = function() {
                var t = window.vk.id,
                    n = e.props.store,
                    r = n.get().peer,
                    o = e.state,
                    i = o.current,
                    a = o.showSearch,
                    c = o.searchQuery;
                return "all" === i && !(a && "" !== c) && Object(s.canInviteUser)(n, r, t)
            }, this.searchInputRef = function(t) {
                e.searchInput = t
            }
        };
    t.default = O
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createWorker", function() {
        return f
    });
    var r = n(147),
        o = n(392),
        i = new r,
        a = !1;

    function s(e) {
        return e.queue || e.key
    }

    function c() {
        i.forEach(function(e, t) {
            var n, r = e.onData,
                o = e.onUpdateKey,
                i = e.ts;
            n = t, window.curNotifier && !curNotifier.addQueues[s(n)] && Notifier.addKey(extend(t, {
                ts: i
            }), d.bind(null, r, o, t))
        })
    }

    function u() {
        a || (a = setInterval(c, 3e3))
    }

    function l(e) {
        ! function(e) {
            if (!window.curNotifier) return !1;
            delete curNotifier.addQueues[s(e)]
        }(e), i.delete(e), 0 === i.size && (clearInterval(a), a = !1)
    }

    function d(e, t, n, r, a) {
        if (a.failed) return l(n), void
        function(e, t, n, r) {
            var a = void 0;
            switch (e) {
                case 1:
                case 2:
                case 3:
                case 5:
                    a = r(t, e);
                    break;
                case 4:
                    a = Object(o.pause)(1).then(function() {
                        return t
                    });
                    break;
                default:
                    throw new Error("Unkonwn error from queue: " + e)
            }
            Object(o.pause)(3).then(function() {
                return a
            }).then(function(e) {
                i.set(e, {
                    onUpdateKey: r,
                    onData: n,
                    ts: e.ts
                }), c(), u()
            })
        }(a.err, n, e, t);
        i.set(n, {
            onData: e,
            onUpdateKey: t,
            ts: intval(a.ts)
        }), a.events.map(function(e) {
            return e.split("<!>")
        }).forEach(e)
    }

    function f(e, t, n) {
        return Notifier.addKey(e, d.bind(null, t, n, e)), i.set(e, {
            onData: t,
            onUpdateKey: n,
            ts: e.ts
        }), u(), {
            stop: l.bind(null, e)
        }
    }
}, , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "getCookie", function() {
        return o
    }), n.d(t, "setCookie", function() {
        return i
    }), n.d(t, "hideCookiesPolicy", function() {
        return a
    }), n.d(t, "initCookies", function() {
        return s
    });
    var r = n(347);

    function o(e) {
        return function() {
            window._cookies = {};
            for (var e = document.cookie.split(";"), t = /^[\s]*([^\s]+?)$/i, n = 0, r = e.length; n < r; n++) {
                var o = e[n].split("=");
                2 === o.length && (_cookies[o[0].match(t)[1]] = unescape(o[1].match(t) ? o[1].match(t)[1] : ""))
            }
        }(), _cookies[e]
    }

    function i(e, t, n, r) {
        var o = "";
        if (n) {
            var i = new Date;
            i.setTime(i.getTime() + 24 * n * 60 * 60 * 1e3), o = "; expires=" + i.toGMTString()
        }
        var a = window.locDomain;
        document.cookie = e + "=" + escape(t) + o + "; path=/" + (a ? "; domain=." + a : "") + (r && "https:" === locProtocol ? "; secure" : "")
    }

    function a() {
        Object(r.re)("cookies_policy_wrap"), ajax.post("/settings", {
            act: "a_hide_cookies_policy"
        })
    }

    function s() {
        window._cookies = {}
    }
}, , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "initDebugTools", function() {
        return o
    }), n.d(t, "logEvalError", function() {
        return i
    }), n.d(t, "debugLog", function() {
        return a
    }), n.d(t, "debugEl", function() {
        return s
    });
    var r = n(324);

    function o() {
        window._logTimer = (new Date).getTime()
    }

    function i(e, t) {
        window.Raven && (t && t.length > 350 && (t = t.slice(0, 150) + "..." + t.slice(-150)), e.message += ": " + t, Raven.captureException(e))
    }

    function a(e) {
        try {
            window.debuglogClient && debuglogClient(e);
            var t = "[" + ((new Date).getTime() - window._logTimer) / 1e3 + "] ";
            if (window.console && console.log) {
                var n = Array.prototype.slice.call(arguments);
                n.unshift(t), r.browser.msie || r.browser.mobile ? console.log(n.join(" ")) : console.log.apply(console, n)
            }
        } catch (e) {}
    }

    function s(e) {
        if (!e) return !1;
        var t = e.tagName,
            n = e.id,
            r = e.className,
            o = (t || "").toLowerCase();
        return r && (o += "." + e.className.replace(/\s+/g, ".")), n && !/^__vk/.test(n) && (o += "#" + e.id), o || (e.toString() || "[NULL]")
    }
}, function(e, t, n) {
    e.exports = n(332)()
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "addDelegateEvent", function() {
        return a
    }), n.d(t, "removeDelegateEvent", function() {
        return s
    });
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        o = new window.Map;

    function i(e) {
        var t = o.get(e.currentTarget);
        if (t) {
            var n = t[e.type];
            if (n)
                for (var i = void 0, a = 0; a < n.length; a++) {
                    var s = r(n[a], 2),
                        c = s[0],
                        u = s[1],
                        l = void 0;
                    if (hasClass(e.target, c) ? l = u(e, e.target) : (i = gpeByClass(c, e.target, e.currentTarget)) && (l = u(e, i)), !1 === l) break
                }
        }
    }

    function a(e, t, n, r) {
        var a = o.get(e);
        a || (o.set(e, {}), a = o.get(e));
        for (var s = t.split(" "), c = 0; c < s.length; c++) {
            var u = s[c];
            a[u] || (a[u] = [], addEvent(e, u, i)), a[u].push([n, r])
        }
    }

    function s(e, t, n, r) {
        var a = o.get(e);
        a && (t.split(" ").forEach(function(t) {
            a[t] && (a[t] = a[t].filter(function(e) {
                return e[0] !== n || e[1] !== r
            }), 0 === a[t].length && removeEvent(e, t, i))
        }), 0 === Object.keys(a).map(function(e) {
            return a[e].length
        }).reduce(function(e, t) {
            return e + t
        }) && o.delete(e))
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return O
    });
    var r = n(256),
        o = n(451),
        i = n(412),
        a = n(190),
        s = n(107),
        c = n(252),
        u = window,
        l = u.MessageBox,
        d = u.show,
        f = u.hide,
        p = u.isVisible,
        _ = u.getLang,
        m = u.boxRefreshCoords,
        g = void 0;

    function h() {
        g && g.hide()
    }

    function b() {
        g && g.updateBoxCoords()
    }

    function v() {
        return document.querySelector("#MessageForward")
    }

    function y(e) {
        var t = document.querySelector("#box_layer_wrap"),
            n = document.querySelector("#box_loader"),
            o = p(t);
        return {
            unmount: function() {
                var t = v();
                t && i.unmountComponentAtNode(t), Object(r.destroyModule)(e)
            },
            showLoader: function() {
                m(n), d(n), o || d(t)
            },
            hideLoader: function() {
                f(n), o || f(t)
            }
        }
    }

    function O(e, t, n) {
        var u = (0, Object(r.createMutations)(y).bindMutations)(Object(r.createModule)({
                handlers: function(e, t) {}
            })),
            d = {
                hideButtons: !0,
                bodyStyle: "padding: 0; background: none;",
                width: 500,
                onShow: function() {
                    ! function(e) {
                        var t = v();
                        t && i.render(o.createElement(a.default, {
                            value: e
                        }, o.createElement(s.default, {
                            getLang: _,
                            closePopup: h,
                            updatePopup: b
                        })), t)
                    }(t), requestAnimationFrame(function() {
                        return g.updateBoxCoords()
                    })
                },
                onHideAttempt: function() {
                    return t.set(c.prepareForward.bind(null, null)), u.unmount(), !0
                }
            };
        return u.showLoader(), Promise.resolve().then(function(e) {
            u.hideLoader(), g = new l(d).content('<div id="MessageForward"></div>').show()
        }), u
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63));
    var i = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            r.getActiveTab = function() {
                var e = r.props.active,
                    t = [],
                    n = null;
                return r.props.children.forEach(function(r) {
                    r.key === e ? n = r : t.push(r)
                }), n || (Number.isInteger(e) && t.length > e ? t[e] : t[0])
            }, r.onClick = function(e, t) {
                if (t !== r.state.active) {
                    var n = r.refsStore[t],
                        o = r.getTransform(n);
                    r.setState({
                        active: t,
                        isAnimating: !0,
                        transform: o
                    }), r.props.onTabClick(e, t)
                }
            }, r.onTransitionEnd = function(e) {
                "transform" === e.propertyName && r.setState({
                    isAnimating: !1
                })
            }, r.getRef = function(e, t) {
                r.refsStore[e] = t
            };
            var o = r.getActiveTab();
            return r.refsStore = {}, r.state = {
                isAnimating: !1,
                active: o.key
            }, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.reactifyTabs = function(e) {
            return (Array.isArray(e) ? e : Object.values(e)).map(function(e) {
                return r.createElement("a", {
                    key: e[0],
                    href: e[2],
                    onClick: function() {}
                }, e[1] ? unclean(e[1]) : "")
            })
        }, t.prototype.componentDidUpdate = function(e, t, n) {
            this.props.active !== e.active && this.setState({
                active: this.props.active
            })
        }, t.prototype.getTransform = function(e) {
            var t = e.offsetWidth;
            return "translateX(" + (e.offsetLeft - 50 + .5 * t) + "px) scaleX(" + t / 100 + ")"
        }, t.prototype.componentDidMount = function() {
            var e = this.refsStore[this.state.active];
            this.setState({
                transform: this.getTransform(e)
            })
        }, t.prototype.render = function() {
            var e = this,
                t = {
                    "Tabs--animating": this.state.isAnimating
                };
            return r.createElement("nav", {
                className: Object(o.classNames)("Tabs", this.props.className, t),
                style: this.props.style
            }, r.createElement("ul", {
                className: "Tabs__list"
            }, this.props.children.map(function(t, n) {
                return r.createElement("li", {
                    className: Object(o.classNames)("Tabs__item", {
                        "Tabs__item--active": e.state.active === (t.key || n)
                    }),
                    onClick: function(r) {
                        return e.onClick(r, t.key || n)
                    },
                    ref: function(r) {
                        return e.getRef(t.key || n, r)
                    },
                    key: t.key || n
                }, t)
            })), r.createElement("div", {
                style: {
                    transform: this.state.transform
                },
                className: "Tabs__divider",
                onTransitionEnd: this.onTransitionEnd
            }))
        }, t
    }(r.Component);
    t.default = i, i.defaultProps = {
        onTabClick: function() {},
        active: 0
    }
}, , , , , , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(412),
        i = n(59),
        a = n(170),
        s = n(205),
        c = n(53),
        u = n(125),
        l = n(57),
        d = n(300),
        f = n(375),
        p = n(113),
        _ = n(252),
        m = n(392),
        g = n(1),
        h = n(406),
        b = n(309),
        v = n(112),
        y = n(409),
        O = n(440),
        w = n(63),
        E = n(425),
        C = n(190),
        j = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        },
        k = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var T = Object(m.debouncedPromise)(_.searchHints, 300),
        S = window,
        M = S.Emoji,
        P = S.langNumeric,
        x = y.default.getLang,
        I = 38,
        D = 27,
        A = 40,
        L = 13,
        R = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.toggleMode = function() {
                    var e = r.props.store;
                    if (Object(h.isCommunityInterface)(e)) {
                        var t = 0 === r.state.mode ? 1 : 0,
                            n = 0 === t ? _.searchImTopConv : _.searchTopConv;
                        r.setState({
                            value: "",
                            mode: t,
                            loading: !0,
                            selected: null,
                            found: []
                        }, function() {
                            return n("", e.get()).then(function(e) {
                                return r.setSearchResults(r.filterResults(e))
                            }).then(function() {
                                return r.searchInput.focus()
                            }).catch(function(e) {
                                return console.error(e)
                            })
                        })
                    }
                }, r.onChange = function(e) {
                    r.setState({
                        value: e.target.value,
                        loading: !0,
                        error: null
                    });
                    var t = e.target.value;
                    r.searchQuery !== t && (r.searchQuery = t, r.onSearch(t))
                }, r.filterResults = function(e) {
                    var t = Object(h.isCommunityInterface)(r.props.store) && 1 === r.state.mode;
                    return e.filter(function(e) {
                        var n = e.peerId;
                        return !(t && n < 0) && (!(t && n > 2e9 && !Object(b.doesChatTabHaveFlag)(e, 1024)) && !(!t && n > 2e9 && Object(b.doesChatTabHaveFlag)(e, 1024)))
                    })
                }, r.onSearch = function(e) {
                    var t = r.props.store,
                        n = t.get(),
                        o = Object(h.isCommunityInterface)(t) && 0 === r.state.mode,
                        i = o ? _.searchImTopConv : _.searchTopConv;
                    return 1 === r.state.mode && "" === e ? r.emptySearch().then(function(e) {
                        r.setSearchResults(r.filterResults(e))
                    }) : i(e, n).then(function(t) {
                        var i = t.map(function(e) {
                            return e.peerId
                        });
                        return t = r.filterResults(t), r.setSearchResults(t, !1, !t.length), e ? T(e, i, "all", {
                            hidegid: o
                        }, n) : Promise.resolve([])
                    }).then(function(t) {
                        e === r.state.value && r.setSearchResults(r.filterResults(t), !0)
                    }).catch(function() {})
                }, r.emptySearch = function() {
                    var e = r.props.store,
                        t = e.get(),
                        n = t.dialog_tabs.all,
                        o = {},
                        i = {};
                    return Object(_.searchTopConv)("", t).then(function(r) {
                        return r.forEach(function(e) {
                            i[e.peerId] = e
                        }), [t.peer].concat(n.filter(function(e) {
                            return e != t.peer
                        })).map(function(t) {
                            var n = Object(h.getTab)(e, t);
                            return o[t] = !0, {
                                name: i[t] && i[t].name || n.name,
                                photo: i[t] && i[t].photo || n.photo,
                                data: n.data,
                                peerId: t
                            }
                        }).concat(r.filter(function(e) {
                            return !o[e.peerId]
                        }))
                    })
                }, r.sendRecipient = function(e) {
                    var t = r.props.store,
                        n = t.get();
                    1 === r.state.mode ? (n.longpoll.push([Object(v.changePeer)(e, !1, !0, !0, "forward_messages_popup")]), Object(O.statlogsForwardEvent)(t), Object(h.isCommunityInterface)(t) && Object(O.statlogsForwardFromCommunityEvent)(t, !1)) : r.setState({
                        selected: e,
                        error: null
                    }, function() {
                        M.focus(r.input)
                    })
                }, r.cleanSelectedRecipient = function() {
                    r.setState({
                        activeElement: -1
                    })
                }, r.scrollToSelectedUser = function() {
                    var e = r.state,
                        t = e.found,
                        n = e.activeElement,
                        o = r.scrollContainer;
                    if (o) {
                        var i = o.querySelector('[data-id="' + t[n].peerId + '"]');
                        if (i)
                            if (i.offsetTop < o.scrollTop) o.scrollTop = i.offsetTop;
                            else {
                                var a = i.offsetTop + i.offsetHeight;
                                a > o.scrollTop + o.offsetHeight && (o.scrollTop = a - o.offsetHeight)
                            }
                        else o.scrollTop = (o.childNodes[1].offsetHeight || 0) * n
                    }
                }, r.selectRecipient = function(e) {
                    var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],
                        n = r.validateActiveElement(e);
                    r.state.activeElement !== n && r.setState({
                        activeElement: n
                    }, function() {
                        t && r.scrollToSelectedUser()
                    })
                }, r.onClick = function(e) {
                    return r.sendRecipient(Number(e.currentTarget.getAttribute("data-id")))
                }, r.loadMore = function() {}, r.setSearchResults = function(e, t) {
                    var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                    if (!r.unmounted)
                        if (t) {
                            var o = e.filter(function(e) {
                                return !r.found[e.peerId]
                            });
                            o.forEach(function(e) {
                                r.found[e.peerId] = !0
                            }), r.setState({
                                found: [].concat(r.state.found, o),
                                loading: n
                            })
                        } else r.found = e.reduce(function(e, t) {
                            return e[t.peerId] = !0, e
                        }, {}), r.setState({
                            found: e,
                            loading: n,
                            activeElement: 0
                        })
                }, r.getFormRef = function(e) {
                    r.form = e
                }, r.getInputRef = function(e) {
                    r.input = e
                }, r.getSearchRef = function(e) {
                    r.searchInput = e && e.element
                }, r.getScrollContainerRef = function(e) {
                    r.scrollContainer = o.findDOMNode(e)
                }, r.getEmojiButtonRef = function(e) {
                    r.emojiButton = e
                }, r.onEmojiButtonMouseOver = function(e) {
                    e.persist(), M.show(r.emojiButton, e)
                }, r.onEmojiButtonMouseOut = function(e) {
                    e.persist(), M.hide(r.emojiButton, e)
                }, r.send = function() {
                    var e = r.props.store,
                        t = r.state.selected,
                        n = M.val(r.input).trim(),
                        o = new E.ImDraft({}, 0),
                        i = e.get().pendingForward;
                    if (t && !Object(g.isMessageTooLong)(val)) {
                        r.setState({
                            sending: !0
                        });
                        var a = Object(h.isCommunityInterface)(e) && 0 === r.state.mode;
                        a || o.addAttach("mail", i.msgIds.join(";"), i.object || null);
                        var s = {
                                message: n,
                                attaches: o.dData.attaches.map(function(e) {
                                    return [e.type, e.id]
                                }) || []
                            },
                            c = {
                                hidegid: !0,
                                external: {
                                    original_gid: e.get().id,
                                    fwd_group_msg_ids: a ? i.msgIds.join(";") : void 0
                                }
                            };
                        new Promise(function(n) {
                            Object(_.loadHashes)([t], {
                                hidegid: !0
                            }, e.get()).then(function(e) {
                                var r = k(e, 1)[0];
                                return n(r[t])
                            })
                        }).then(function(n) {
                            return e.set(_.sendMessage.bind(null, t, s, j({
                                hash: n
                            }, c)))
                        }).then(function() {
                            Object(O.statlogsForwardFromCommunityEvent)(e, !0), e.setState({
                                pendingForward: null
                            }), r.props.closePopup(), showDoneBox(x("mail_send3"))
                        }).catch(function(e) {
                            r.unmounted || r.setState({
                                sending: !1
                            }, function() {
                                showFastBox(x("mail_error"), e)
                            })
                        })
                    }
                }, r.onSearchKeyDown = function(e) {
                    e.keyCode === D && r.state.value && (r.searchInput.blur(), r.searchQuery = "", r.setState({
                        value: "",
                        loading: !0,
                        error: null
                    }, r.onSearch.bind(r, "")), e.stopPropagation())
                }, r.onMessageInputKeyDown = function(e) {
                    e.keyCode === D && (r.state.sending || (M.val(r.input, ""), r.setState({
                        selected: null
                    }), r.searchInput.focus()), e.stopPropagation())
                }, r.onKeydown = function(e) {
                    var t = r.state.activeElement;
                    switch (e.which || e.keyCode) {
                        case I:
                            r.selectRecipient(t - 1), e.preventDefault();
                            break;
                        case A:
                            r.selectRecipient(t + 1), e.preventDefault();
                            break;
                        case L:
                            var n = r.state,
                                o = n.found,
                                i = n.activeElement;
                            o[i] && (r.sendRecipient(o[i].peerId), e.preventDefault())
                    }
                }, r.state = {
                    value: "",
                    found: [],
                    mode: 1,
                    loading: !0,
                    sending: !1,
                    selected: null,
                    activeElement: 0
                }, r.emptySearch().then(function(e) {
                    r.setSearchResults(r.filterResults(e))
                }).catch(function(e) {
                    return console.error(e)
                }), r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.getMembersCount = function(e) {
                if (!Object(g.isChatPeer)(e)) return "";
                var t = this.props.store,
                    n = Object(h.getTab)(t, e);
                return n && n.membersCount ? P(n.membersCount, x("mail_im_n_chat_members", "raw")) : ""
            }, t.prototype.validateActiveElement = function(e) {
                return e > this.state.found.length - 1 ? this.state.found.length - 1 : e < 0 ? 0 : e
            }, t.prototype.componentDidMount = function() {
                this.props.updatePopup(), M.init(this.input, {
                    noStickers: !0,
                    onSend: this.send
                }), this.input.addEventListener("keydown", this.onMessageInputKeyDown), this.searchInput.addEventListener("keydown", this.onKeydown), this.searchInput.addEventListener("keydown", this.onSearchKeyDown)
            }, t.prototype.componentWillUnmount = function() {
                this.input.removeEventListener("keydown", this.onMessageInputKeyDown), this.searchInput.removeEventListener("keydown", this.onKeydown), this.searchInput.removeEventListener("keydown", this.onSearchKeyDown), this.unmounted = !0
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.store,
                    o = t.closePopup,
                    _ = this.state,
                    m = _.mode,
                    g = _.loading,
                    b = _.selected,
                    v = _.found,
                    y = _.sending,
                    O = _.activeElement;
                return r.createElement("section", {
                    className: Object(w.classNames)("MessageForward", {
                        "MessageForward--form": 0 === m && !!b
                    })
                }, r.createElement(i.default, {
                    title: r.createElement(r.Fragment, null, r.createElement("span", {
                        className: "MessageForward__title"
                    }, x("mail_forward_messages")), Object(h.isCommunityInterface)(n) && r.createElement("span", {
                        className: "MessageForward__switch",
                        onClick: this.toggleMode
                    }, x(0 === m ? "mail_forward_to_community_messages" : "mail_forward_to_im"))),
                    onCloseClick: o
                }), r.createElement("div", {
                    className: "MessageForward__content",
                    onMouseLeave: this.cleanSelectedRecipient
                }, r.createElement(u.default, {
                    value: this.state.value,
                    onChange: this.onChange,
                    placeholder: x("mail_top_search"),
                    autoFocus: !0,
                    key: "search",
                    ref: this.getSearchRef
                }), g && r.createElement("div", {
                    className: "MessageForward__results",
                    key: "loading"
                }, r.createElement(f.default, {
                    className: "MessageForward__stub"
                }, r.createElement(p.default, null))), !g && 0 === v.length && r.createElement("div", {
                    className: "MessageForward__results",
                    key: "no-results"
                }, r.createElement(f.default, null, x("mail_im_search_empty_chats"))), !g && v.length > 0 && r.createElement(a.default, {
                    virtualized: !0,
                    className: "MessageForward__results",
                    loadMore: this.loadMore,
                    hasMore: !1,
                    ref: this.getScrollContainerRef,
                    key: "results"
                }, v.map(function(t, o) {
                    var i = t.peerId,
                        a = t.name,
                        u = t.photo,
                        f = t.online;
                    return r.createElement(s.default, {
                        key: i,
                        "data-id": i,
                        onClick: e.onClick,
                        chevron: 1 === m,
                        active: o === O,
                        canBeHovered: !1,
                        onMouseEnter: e.selectRecipient.bind(null, o, !1),
                        aside: 0 === m ? r.createElement("span", {
                            className: Object(w.classNames)("MessageForward__radio", {
                                "MessageForward__radio--selected": +b === i
                            })
                        }) : ""
                    }, r.createElement(c.default, {
                        size: "34",
                        title: a,
                        photo: Array.isArray(u) ? r.createElement(d.default, {
                            photos: u
                        }) : r.createElement(l.default, {
                            online: (Object(h.getTab)(n, i) || {}).online || f,
                            title: a,
                            photo: u
                        }),
                        description: e.getMembersCount(i)
                    }))
                })), r.createElement("footer", {
                    className: "MessageForward__footer",
                    ref: this.getFormRef,
                    key: "footer"
                }, r.createElement("div", {
                    className: "MessageForward__form _emoji_field_wrap"
                }, r.createElement("div", {
                    className: "MessageForward__input",
                    tabIndex: "0",
                    contentEditable: !0,
                    role: "textbox",
                    "aria-multiline": !0,
                    ref: this.getInputRef,
                    placeholder: x("mail_im_enter_msg")
                }), r.createElement("div", {
                    className: "MessageForward__emoji emoji_smile_wrap _emoji_wrap"
                }, r.createElement("div", {
                    ref: this.getEmojiButtonRef,
                    className: "emoji_smile _emoji_btn",
                    title: x("global_emoji_hint"),
                    onMouseOver: this.onEmojiButtonMouseOver,
                    onMouseOut: this.onEmojiButtonMouseOut,
                    onClick: this.onEmojiButtonClick
                }, r.createElement("div", {
                    className: "emoji_smile_icon_vector emoji_smile_icon"
                })))), y ? r.createElement("div", {
                    className: "MessageForward__send-spinner"
                }, r.createElement(p.default, null)) : r.createElement("button", {
                    className: "MessageForward__send",
                    onClick: this.send
                }))))
            }, t
        }(r.Component);
    t.default = Object(C.connect)(R)
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "hasAccessibilityMode", function() {
        return s
    }), n.d(t, "updateOnlineText", function() {
        return c
    }), n.d(t, "updateAriaCheckboxes", function() {
        return u
    }), n.d(t, "updateAriaRadioBtns", function() {
        return l
    }), n.d(t, "updateAriaElements", function() {
        return d
    });
    var r = n(366),
        o = n(269),
        i = n(347),
        a = n(220);

    function s() {
        return !(!window.vk || !vk.a11y)
    }

    function c() {
        clearTimeout(cur.updateOnlineTO), cur.updateOnlineTO = setTimeout(function() {
            Object(o.each)(Object(i.geByClass)("_online"), function() {
                var e = Object(i.geByClass1)("_online_reader", this) || this,
                    t = Object(i.hasClass)(this, "online"),
                    n = Object(i.hasClass)(this, "mobile"),
                    r = Object(i.geByTag)("img", e),
                    s = function(e) {
                        var t = Object(i.domClosest)("_post", e),
                            n = t && Object(i.domByClass)(t, "author");
                        return n ? n.innerText || n.textContent : ""
                    };
                if (t) {
                    var c = "";
                    Object(o.each)(r, function() {
                        var e = Object(i.attr)(this, "alt") || Object(i.attr)(this, "data-alt") || s(this);
                        e && (c = Object(o.trim)(c + " " + e), this.setAttribute("data-alt", e), this.removeAttribute("alt"))
                    }), c = Object(o.trim)(c + " " + (n ? Object(a.getLang)("global_user_is_online_mobile") : Object(a.getLang)("global_user_is_online"))), e.setAttribute("aria-label", c)
                } else Object(o.each)(r, function() {
                    var e = Object(i.attr)(this, "data-alt") || s(this);
                    e && (this.setAttribute("alt", e), this.removeAttribute("data-alt"))
                }), e.removeAttribute("aria-label")
            })
        }, 100)
    }

    function u() {
        clearTimeout(cur.updateChkBoxTO), cur.updateChkBoxTO = setTimeout(function() {
            var e = [];
            Object(o.each)(["checkbox", "checkbox_pic"], function() {
                e = e.concat(Object(i.geByClass)(this))
            }), Object(o.each)(e, function() {
                "DIV" !== this.tagName || this.getAttribute("role") || (this.setAttribute("role", "checkbox"), this.setAttribute("aria-checked", Object(r.isChecked)(this) ? "true" : "false"), this.setAttribute("tabindex", 0))
            })
        }, 100)
    }

    function l() {
        clearTimeout(cur.updateRadioBtnsTO), cur.updateRadioBtnsTO = setTimeout(function() {
            var e = [],
                t = Object(i.geByClass)("radiobtn");
            Object(o.each)(t, function() {
                if ("DIV" === this.tagName && !this.getAttribute("role")) {
                    var t = Object(r.isChecked)(this);
                    this.setAttribute("role", "radio"), this.setAttribute("aria-checked", t ? "true" : "false"), this.setAttribute("tabindex", t ? 0 : -1);
                    var n = function(e) {
                        var t = 0,
                            n = e;
                        for (; t < 5 && n !== document;) {
                            n = Object(i.domPN)(n);
                            var r = Object(i.geByClass)("radiobtn", n);
                            if (r.length > 1) break;
                            t++
                        }
                        return n
                    }(this);
                    ~e.indexOf(n) || e.push(n)
                }
            }), Object(o.each)(e, function() {
                if (!Object(i.geByClass)("on", this).length) {
                    var e = Object(i.geByClass)("radiobtn", this);
                    e.length && e[0].setAttribute("tabindex", 0)
                }
            })
        }, 100)
    }

    function d() {
        c(), u(), l()
    }
}, , function(e, t, n) {
    var r = n(399)("keys"),
        o = n(141);
    e.exports = function(e) {
        return r[e] || (r[e] = o(e))
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "DELETE", function() {
        return i
    }), n.d(t, "SET_FLAGS", function() {
        return a
    }), n.d(t, "REPLACE_FLAGS", function() {
        return s
    }), n.d(t, "RESET_FLAGS", function() {
        return c
    }), n.d(t, "ADD_MESSAGE", function() {
        return u
    }), n.d(t, "READ_INBOUND", function() {
        return l
    }), n.d(t, "READ_OUTBOUND", function() {
        return d
    }), n.d(t, "GOT_ONLINE", function() {
        return f
    }), n.d(t, "GOT_OFFLINE", function() {
        return p
    }), n.d(t, "CHAT_CHANGED", function() {
        return _
    }), n.d(t, "CONVERSATION_UPDATED", function() {
        return m
    }), n.d(t, "TYPING", function() {
        return g
    }), n.d(t, "RECORDING_AUDIO", function() {
        return h
    }), n.d(t, "VIDEO_CALL", function() {
        return b
    }), n.d(t, "UNREAD_COUNT", function() {
        return v
    }), n.d(t, "NOTIFY_SETTINGS_CHANGED", function() {
        return y
    }), n.d(t, "EMPTY", function() {
        return O
    }), n.d(t, "RESET_DIRECTORIES", function() {
        return w
    }), n.d(t, "REPLACE_DIRECTORIES", function() {
        return E
    }), n.d(t, "SET_DIRECTORIES", function() {
        return C
    }), n.d(t, "RESYNC", function() {
        return j
    }), n.d(t, "REFRESH_LP_KEY", function() {
        return k
    }), n.d(t, "TRANSITION", function() {
        return T
    }), n.d(t, "RESET_PEER", function() {
        return S
    }), n.d(t, "MUTEX", function() {
        return M
    }), n.d(t, "CHANGE_PEER", function() {
        return P
    }), n.d(t, "CHANGE_TAB", function() {
        return x
    }), n.d(t, "FAILED_MESSAGE", function() {
        return I
    }), n.d(t, "RESEND", function() {
        return D
    }), n.d(t, "DELETE_DIALOG", function() {
        return A
    }), n.d(t, "EDIT_MESSAGE", function() {
        return L
    }), n.d(t, "REPLACE_MESSAGE", function() {
        return R
    }), n.d(t, "AUDIO_START", function() {
        return B
    }), n.d(t, "FLAG_UNREAD", function() {
        return N
    }), n.d(t, "FLAG_OUTBOUND", function() {
        return U
    }), n.d(t, "FLAG_IMPORTANT", function() {
        return F
    }), n.d(t, "FLAG_CHAT", function() {
        return H
    }), n.d(t, "FLAG_FRIENDS", function() {
        return W
    }), n.d(t, "FLAG_SPAM", function() {
        return K
    }), n.d(t, "FLAG_DELETED", function() {
        return q
    }), n.d(t, "FLAG_MEDIA", function() {
        return z
    }), n.d(t, "FLAG_STEALTH", function() {
        return G
    }), n.d(t, "FLAG_HAS_REPLY", function() {
        return V
    }), n.d(t, "FOLDER_IMPORTANT", function() {
        return Y
    }), n.d(t, "FOLDER_UNRESPOND", function() {
        return Q
    }), n.d(t, "FOLDER_HAS_BANNER", function() {
        return $
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_TITLE_CHANGED", function() {
        return X
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_AVATAR_CHANGED", function() {
        return J
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED", function() {
        return Z
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_FLAGS_CHANGED", function() {
        return ee
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_PINNED", function() {
        return te
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_USER_JOINED", function() {
        return ne
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_USER_LEFT", function() {
        return re
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_USER_KICKED", function() {
        return oe
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_ADMIN_KICKED", function() {
        return ie
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_BANNER_CHANGED", function() {
        return ae
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_KEYBOARD_CHANGED", function() {
        return se
    }), n.d(t, "MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED", function() {
        return ce
    }), n.d(t, "deleteEvent", function() {
        return ue
    }), n.d(t, "replaceFlagsEvent", function() {
        return le
    }), n.d(t, "setFlagsEvent", function() {
        return de
    }), n.d(t, "resetFlagsEvent", function() {
        return fe
    }), n.d(t, "addMessageEvent", function() {
        return pe
    }), n.d(t, "editMessageEvent", function() {
        return _e
    }), n.d(t, "replaceMessageEvent", function() {
        return me
    }), n.d(t, "editMessageLocallyEvent", function() {
        return ge
    }), n.d(t, "readInboundEvent", function() {
        return he
    }), n.d(t, "readOutboundEvent", function() {
        return be
    }), n.d(t, "gotOnlineEvent", function() {
        return ve
    }), n.d(t, "gotOfflineEvent", function() {
        return ye
    }), n.d(t, "resetDirectoriesEvent", function() {
        return Oe
    }), n.d(t, "replaceDirectoriesEvent", function() {
        return we
    }), n.d(t, "setDirectoriesEvent", function() {
        return Ee
    }), n.d(t, "deleteDialogEvent", function() {
        return Ce
    }), n.d(t, "chatChangedEvent", function() {
        return je
    }), n.d(t, "chatUpdatedEvent", function() {
        return ke
    }), n.d(t, "typingEvent", function() {
        return Te
    }), n.d(t, "recordingAudioEvent", function() {
        return Se
    }), n.d(t, "videoCallEvent", function() {
        return Me
    }), n.d(t, "unreadCountEvent", function() {
        return Pe
    }), n.d(t, "notifySettingsChangedEvent", function() {
        return xe
    }), n.d(t, "refreshMessageEvent", function() {
        return Ie
    }), n.d(t, "audioStartEvent", function() {
        return De
    }), n.d(t, "emptyEvent", function() {
        return Ae
    }), n.d(t, "transitionEvent", function() {
        return Le
    }), n.d(t, "resyncEvent", function() {
        return Re
    }), n.d(t, "refreshLpKeyEvent", function() {
        return Be
    }), n.d(t, "resetPeer", function() {
        return Ne
    }), n.d(t, "changePeer", function() {
        return Ue
    }), n.d(t, "changeTab", function() {
        return Fe
    }), n.d(t, "failedMessage", function() {
        return He
    }), n.d(t, "mutexEvent", function() {
        return We
    }), n.d(t, "resendEvent", function() {
        return Ke
    });
    var r = n(124),
        o = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        i = "event_delete",
        a = "event_set_flags",
        s = "event_replace_flags",
        c = "event_reset_flags",
        u = "event_add_message",
        l = "event_read_inbound",
        d = "event_read_outbound",
        f = "event_got_online",
        p = "event_got_offline",
        _ = "event_chat_changed",
        m = "event_chat_updated",
        g = "event_typing",
        h = "event_recoding_audio",
        b = "event_video_call",
        v = "event_unread_count",
        y = "event_notify_settings_changed",
        O = "event_empty",
        w = "event_reset_directories",
        E = "event_replace_directories",
        C = "event_set_directories",
        j = "event_resync",
        k = "event_refresh_lp_key",
        T = "transition_event",
        S = "reset_peer",
        M = "mutex",
        P = "change_peer",
        x = "event_change_tab",
        I = "event_failed_message",
        D = "event_resend",
        A = "event_delete_dialog",
        L = "event_edit_message",
        R = "event_replace_message",
        B = "event_audio_start",
        N = 1,
        U = 2,
        F = 8,
        H = 16,
        W = 32,
        K = 64,
        q = 128,
        z = 512,
        G = 65536,
        V = 1 << 21,
        Y = 1,
        Q = 2,
        $ = 8,
        X = 1,
        J = 2,
        Z = 3,
        ee = 4,
        te = 5,
        ne = 6,
        re = 7,
        oe = 8,
        ie = 9,
        ae = 10,
        se = 11,
        ce = 12;

    function ue(e) {
        var t = o(e, 2)[1];
        return {
            type: i,
            localId: t
        }
    }

    function le(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: s,
            messageId: n,
            mask: r,
            peerId: i
        }
    }

    function de(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: a,
            messageId: n,
            flags: r,
            peerId: i
        }
    }

    function fe(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: c,
            messageId: n,
            flags: r,
            peerId: i
        }
    }

    function pe(e) {
        var t = o(e, 11),
            n = t[1],
            i = t[2],
            a = t[3],
            s = t[4],
            c = t[5],
            l = t[6],
            d = t[7],
            f = t[8],
            p = t[9],
            _ = t[10],
            m = extend(l, d || void 0);
        return {
            type: u,
            messageId: intval(n),
            flags: intval(i),
            peerId: intval(a),
            date: intval(s),
            attaches: Object(r.convertKludgesToAttaches)(m, n),
            subject: l.title || "",
            text: c,
            kludges: m,
            randomId: intval(f),
            userId: Object(r.isChatPeer)(a) ? intval(m.from) : intval(a),
            update_time: _,
            chat_local_id: p
        }
    }

    function _e(e) {
        var t = pe(e);
        return t.type = L, t
    }

    function me(e) {
        var t = pe(e);
        return t.type = R, t
    }

    function ge(e) {
        return extend({}, e, {
            type: L
        })
    }

    function he(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: l,
            peerId: n,
            upToId: r,
            unread: i
        }
    }

    function be(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: d,
            peerId: n,
            upToId: r,
            unread: i
        }
    }

    function ve(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: f,
            userId: -n,
            platform: r,
            lastSeenTs: i
        }
    }

    function ye(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: p,
            userId: -n,
            reason: r,
            lastSeenTs: i
        }
    }

    function Oe(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: w,
            peerId: n,
            mask: r,
            local: void 0 !== i && i
        }
    }

    function we(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: E,
            peerId: n,
            mask: r
        }
    }

    function Ee(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: C,
            peerId: n,
            mask: r,
            local: void 0 !== i && i
        }
    }

    function Ce(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: A,
            peerId: n,
            localId: r
        }
    }

    function je(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: _,
            chatId: n,
            self: r
        }
    }

    function ke(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: m,
            peerId: r,
            updateType: n,
            updateArg: i
        }
    }

    function Te(e) {
        var t = o(e, 5),
            n = t[1],
            r = t[2],
            i = t[3],
            a = t[4];
        return {
            type: g,
            peerId: n,
            userIds: r,
            totalCount: i,
            ts: a
        }
    }

    function Se(e) {
        var t = o(e, 5),
            n = t[1],
            r = t[2],
            i = t[3],
            a = t[4];
        return {
            type: h,
            peerId: n,
            userIds: r,
            totalCount: i,
            ts: a
        }
    }

    function Me(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: b,
            userId: n,
            callId: r
        }
    }

    function Pe(e) {
        var t = o(e, 4),
            n = t[1],
            r = t[2],
            i = t[3];
        return {
            type: v,
            count: n,
            countNotMuted: r,
            showOnlyNotMuted: i
        }
    }

    function xe(e) {
        var t = o(e, 2)[1],
            n = void 0 === t ? {} : t;
        return {
            type: y,
            peerId: n.peer_id,
            sound: n.sound,
            disabledUntil: n.disabled_until
        }
    }

    function Ie(e) {
        var t = o(e, 2)[1],
            n = void 0 === t ? {} : t,
            r = pe([!1, n.id, n.flags, n.peer_id, n.date, n.message, extend(n.kludges, {
                title: n.title || ""
            }), {}, n.random_id, n.chat_local_id, n.update_time]);
        return r.type = L, r
    }

    function De(e) {
        var t = o(e, 2)[1],
            n = void 0 === t ? {} : t;
        return {
            type: B,
            uuid: n.uuid,
            deviceName: n.device_name || ""
        }
    }

    function Ae(e) {
        return {
            type: O,
            params: e
        }
    }

    function Le(e) {
        return {
            type: T,
            state: e
        }
    }

    function Re() {
        return {
            type: j
        }
    }

    function Be(e) {
        var t = o(e, 3),
            n = t[1],
            r = t[2];
        return {
            type: k,
            key: n,
            url: r
        }
    }

    function Ne() {
        var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
            t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
        return {
            type: S,
            cancelSearch: e,
            removeActivePeer: t
        }
    }

    function Ue(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
            n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
            r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
            o = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : "";
        return {
            type: P,
            peerId: e,
            msgid: t,
            forward: n,
            cancelSearch: r,
            entryPoint: o
        }
    }

    function Fe(e) {
        return {
            type: x,
            tab: e
        }
    }

    function He(e, t, n) {
        return {
            type: I,
            message: t,
            peer: e,
            error: n
        }
    }

    function We(e) {
        var t = o(e, 6),
            n = (t[0], t[1]),
            r = t[2],
            i = t[3],
            a = t[4],
            s = t[5];
        return {
            type: M,
            free: !!intval(n) || intval(a) === vk.id,
            resource: r,
            peerId: intval(i),
            who: intval(a),
            name: s
        }
    }

    function Ke(e, t) {
        return {
            type: D,
            message: t,
            peerId: e
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451);
    n(96);
    var o = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.id = Math.round(1e6 * Math.random()).toString(16), r.setSpinnerParams(n), r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentWillReceiveProps = function(e) {
            this.setSpinnerParams(e)
        }, t.prototype.setSpinnerParams = function(e) {
            this.offset = Math.round(Math.PI * e.size), this.c = .5 * e.size, this.animation = function(e, t) {
                if (!e || !t) return "";
                var n = Object.keys(t).map(function(e) {
                    return e + " {" + Object.keys(t[e]).map(function(n) {
                        return n + ":" + t[e][n]
                    }).join(";") + "}"
                }).join("");
                return "@-webkit-keyframes " + e + " {" + n + "} @keyframes " + e + " {" + n + "}"
            }("dash" + this.id, {
                "0%": {
                    "stroke-dashoffset": this.offset
                },
                "50%": {
                    "stroke-dashoffset": Math.round(.25 * this.offset),
                    transform: "rotate(135deg)"
                },
                "100%": {
                    "stroke-dashoffset": this.offset,
                    transform: "rotate(360deg)"
                }
            })
        }, t.prototype.render = function() {
            var e = this.props,
                t = e.style,
                n = e.color,
                o = e.size,
                i = e.duration,
                a = e.strokeWidth,
                s = this.id,
                c = this.offset,
                u = this.animation;
            return r.createElement("div", {
                className: "Spinner",
                style: t
            }, r.createElement("svg", {
                className: "Spinner__svg",
                width: o,
                height: o,
                viewBox: "0 0 " + o + " " + o,
                xmlns: "http://www.w3.org/2000/svg"
            }, r.createElement("g", {
                style: {
                    width: o,
                    height: o,
                    transformOrigin: .5 * o + "px " + .5 * o + "px"
                }
            }, r.createElement("style", {
                dangerouslySetInnerHTML: {
                    __html: u
                }
            }), r.createElement("circle", {
                className: "Spinner__path",
                fill: "none",
                stroke: n,
                strokeDasharray: c,
                strokeDashoffset: c,
                strokeWidth: a,
                style: {
                    animationName: "dash" + s,
                    animationTimingFunction: "ease-in-out",
                    animationDuration: i + "s",
                    animationIterationCount: "infinite"
                },
                cx: .5 * o,
                cy: .5 * o,
                r: .5 * o - .5 * a
            }))))
        }, t
    }(r.Component);
    t.default = o, o.defaultProps = {
        color: "#5181b8",
        size: 19,
        strokeWidth: 2,
        duration: 1.4
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "VIDEO_UPLOAD_EXTS", function() {
        return r
    }), n.d(t, "VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB", function() {
        return o
    }), n.d(t, "VIDEO_UPLOAD_CHUNK_SIZE", function() {
        return i
    });
    var r = "avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf".split(" "),
        o = 5,
        i = 4194304
}, function(e, t, n) {
    var r = n(141)("meta"),
        o = n(322),
        i = n(305),
        a = n(184).f,
        s = 0,
        c = Object.isExtensible || function() {
            return !0
        },
        u = !n(286)(function() {
            return c(Object.preventExtensions({}))
        }),
        l = function(e) {
            a(e, r, {
                value: {
                    i: "O" + ++s,
                    w: {}
                }
            })
        },
        d = e.exports = {
            KEY: r,
            NEED: !1,
            fastKey: function(e, t) {
                if (!o(e)) return "symbol" == typeof e ? e : ("string" == typeof e ? "S" : "P") + e;
                if (!i(e, r)) {
                    if (!c(e)) return "F";
                    if (!t) return "E";
                    l(e)
                }
                return e[r].i
            },
            getWeak: function(e, t) {
                if (!i(e, r)) {
                    if (!c(e)) return !0;
                    if (!t) return !1;
                    l(e)
                }
                return e[r].w
            },
            onFreeze: function(e) {
                return u && d.NEED && c(e) && !i(e, r) && l(e), e
            }
        }
}, , , , , , function(e, t, n) {
    for (var r = n(454), o = n(196), i = n(316), a = n(426), s = n(67), c = n(151), u = c("iterator"), l = c("toStringTag"), d = s.Array, f = ["NodeList", "DOMTokenList", "MediaList", "StyleSheetList", "CSSRuleList"], p = 0; p < 5; p++) {
        var _, m = f[p],
            g = i[m],
            h = g && g.prototype;
        if (h)
            for (_ in h[u] || a(h, u, d), h[l] || a(h, l, m), s[m] = d, r) h[_] || o(h, _, r[_], !0)
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createLongpoll", function() {
        return s
    });
    var r = n(0),
        o = n(344),
        i = n(364),
        a = n(252);

    function s(e, t) {
        return Object(r.createLongpollConnect)(e, {
            onEvents: t,
            onData: d,
            onRequestError: f,
            onHistoryLost: p,
            onKeyExpired: _,
            onLpBroken: m
        })
    }
    var c = 3e4,
        u = {},
        l = Date.now();

    function d(e, t) {
        if (t && t.status && e.lpstat) {
            var n = Math.floor(t.status / 100);
            t.status >= 500 && t.status < 600 && statlogsValueEvent("fc_longpoll", 1, n + "0x", t.getResponseHeader("x-frontend")), u[n] = n in u ? u[n] + 1 : 1, Date.now() - l >= c && (Object.keys(u).forEach(function(e) {
                statlogsValueEvent("fc_longpoll", u[e], e + "0x", t.getResponseHeader("x-frontend"))
            }), u = {}, l = Date.now())
        }
    }

    function f(e) {
        Object(o.lpLogFc)("red", "LP error", e.message || "no message (probably browser reset)")
    }

    function p(e, t) {
        Object(o.lpLogFc)("red", "LP failed: old timestamp; resync, next ts", t.ts)
    }

    function _(e) {
        return Object(o.lpLogFc)("red", "LP failed: key is incorrect; refresh key"), Object(i.post)(a.CONTROLLER, {
            act: "a_get_key",
            uid: e.id,
            gid: e.id < 0 ? -e.id : 0
        })
    }

    function m() {
        throw window.nav.reload({
            force: !0
        }), new Error("ts is very wrong")
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "parseFwd", function() {
        return s
    }), n.d(t, "convertKludgesToAttaches", function() {
        return c
    }), n.d(t, "isReservedPeer", function() {
        return u
    }), n.d(t, "isUserPeer", function() {
        return l
    }), n.d(t, "isChatPeer", function() {
        return d
    });
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        o = window.intval;

    function i(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [],
            n = e.split("_"),
            o = r(n, 2);
        return [o[0], o[1], t]
    }
    var a = {};

    function s(e) {
        if (a[e]) return a[e];
        for (var t = e ? e.length : 0, n = [], o = [], s = "", c = 0; c < t; c++) {
            var u = e[c],
                l = u.charCodeAt(0);
            l >= 48 && l <= 57 || "_" === u || "-" === u ? s += u : "(" !== u && ")" !== u && ":" !== u && "," !== u || ("" !== s && (o.push(s), n.push("id"), s = ""), o.push(u), n.push(u))
        }
        s.length > 0 && (o.push(s), n.push("id"));
        var d = function e(t, n) {
                var o = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0,
                    a = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0;
                if (a > 50) return [
                    [], t.length
                ];
                for (var s = [], c = ""; o < t.length;) {
                    var u = t[o];
                    if ("id" === u) c = n[o];
                    else if ("," === u && c) s.push(i(c)), c = "";
                    else if ("(" === u) {
                        var l = e(t, n, o + 1, a + 1),
                            d = r(l, 2),
                            f = d[0];
                        o = d[1], s.push(i(c, f)), c = ""
                    } else if (")" === u) return "" !== c && s.push(i(c)), [s, o];
                    o++
                }
                return c && s.push(i(c)), [s, o]
            }(n, o),
            f = r(d, 1)[0];
        return Object.keys(a).length > 300 && (a = {}), a[e] = f, f
    }

    function c(e, t) {
        var n = [];
        e.fwd_count ? n.push({
            type: "mail",
            id: -t,
            object: {
                fwd_count: e.fwd_count
            }
        }) : e.fwd && n.push({
            type: "mail",
            id: -t,
            object: {
                fwd_count: s(e.fwd).length
            }
        });
        for (var r = 1; e["attach" + r + "_type"]; ++r) "call" === e["attach" + r + "_type"] ? n.push({
            type: e["attach" + r + "_type"],
            id: e["attach" + r],
            initiatorId: o(e["attach" + r + "_call_initiator_id"]),
            state: e["attach" + r + "_call_state"],
            duration: o(e["attach" + r + "_call_duration"]),
            receiverId: o(e["attach" + r + "_call_receiver_id"])
        }) : n.push({
            type: e["attach" + r + "_type"],
            id: e["attach" + r],
            kind: e["attach" + r + "_kind"],
            productId: e["attach" + r + "_product_id"]
        });
        return e.geo && n.push({
            type: "geo",
            id: e.geo
        }), n
    }

    function u(e) {
        return 0 == e
    }

    function l(e) {
        return e > 0 && e < 2e9
    }

    function d(e) {
        return e > 2e9
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(63),
        i = n(83),
        a = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function s(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var c = function(e) {
        function t() {
            var n, r;
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            for (var o = arguments.length, i = Array(o), a = 0; a < o; a++) i[a] = arguments[a];
            return n = r = s(this, e.call.apply(e, [this].concat(i))), r.getRef = function(e) {
                r.element = e && e.element
            }, s(r, n)
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.className,
                n = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["className"]);
            return r.createElement(i.default, a({}, n, {
                className: Object(o.classNames)(t, "BlockSearchInput"),
                ref: this.getRef
            }))
        }, t
    }(r.Component);
    t.default = c, c.defaultProps = i.default.defaultProps
}, , function(e, t) {
    t.f = {}.propertyIsEnumerable
}, function(e, t) {
    var n;
    n = function() {
        return this
    }();
    try {
        n = n || Function("return this")() || (0, eval)("this")
    } catch (e) {
        "object" == typeof window && (n = window)
    }
    e.exports = n
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "setCurrentDateBar", function() {
        return h
    }), n.d(t, "mount", function() {
        return w
    });
    var r = n(1),
        o = n(252),
        i = n(329),
        a = n(433),
        s = n(281),
        c = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var u = 68,
        l = 32,
        d = 300,
        f = 20,
        p = 68,
        _ = 10,
        m = 2e3,
        g = 100;

    function h(e, t) {
        domData(e, "ts") !== t.date && (e.innerHTML = t.text, domData(e, "ts", t.date), setStyle(e, {
            visibility: "visible"
        }))
    }

    function b(e, t, n, r) {
        var o = e instanceof Array ? e : geByClass("_im_bar_date", e),
            a = t.contHeight();
        i.default.onNewMessagesChunk();
        var s = o.reduce(function(e, t) {
                return e[domData(t, "date")] = [t.offsetTop + _, a, t], e
            }, {}),
            c = !n && r.barMap ? r.barMap : {};
        return r.barMap = extend(c, s), r.barMapKeys = Object.keys(r.barMap).sort(), Promise.resolve(r)
    }

    function v(e, t, n, o, i) {
        var a = e.get().barMap[t],
            s = Object(r.isClassicInterface)(i) ? p : f;
        return n - (a[0] + n - a[1]) + o - s
    }

    function y(e, t, n, r, o) {
        var i = e.get(),
            a = void 0,
            s = void 0,
            u = n - t;
        i.barMapKeys.forEach(function(t) {
            var i = v(e, t, n, r, o);
            if (i >= u) {
                var c = a ? v(e, a, n, r, o) : n;
                a = c > i ? t : a
            } else if (i < u) {
                var l = s ? v(e, s, n, r, o) : 0;
                s = i > l ? t : s
            }
        });
        var l = {};
        return [
            [s, "prev"],
            [a, "cur"]
        ].forEach(function(t) {
            var i = c(t, 2),
                a = i[0],
                s = i[1];
            a && (l[s + "Bar"] = function(e, t) {
                var n = e.get().barMap[t][2];
                return {
                    text: n.textContent,
                    date: domData(n, "date")
                }
            }(e, a), l[s + "Left"] = v(e, a, n, r, o) - u)
        }), l
    }

    function O(e, t, n, i, a) {
        var c = e.get(),
            d = Object(o.isEverythingLoaded)(c),
            f = t.get(),
            p = a.scrollTop(),
            _ = f.lastTop ? f.lastTop - p : 0;
        f.lastTop = p;
        var m, g, b, v = Object(s.isPinnedMessageVisibleInTab)(c, c.peer) ? Object(r.getPinnedMessageHeight)() : 0,
            O = Object(o.isSearchingInplace)(c.peer, c) && c.tabs[c.peer] && c.tabs[c.peer].top_banner ? 50 : 0,
            w = (Object(r.isClassicInterface)(e) ? u + v + O : 0) - l / 2,
            E = y(t, p, a.contHeight(), w, e),
            C = E.prevBar,
            j = E.curBar,
            k = E.prevLeft,
            T = "translateY(0px)",
            S = !1,
            M = !1,
            P = !1;
        j || d || (j = function(e) {
            var t = geByClass1("_im_mess", e),
                n = domData(t, "ts");
            return t && n ? {
                text: getShortDate(intval(n), !1, !0, getLang("months_of", "raw")),
                date: n
            } : null
        }(i)), j ? S = j : M = !0, C && j && k > -l && k < 0 && (P = !0, M = !1, S = j, T = "translateY(" + (-l - k) + "px)"), S && h(n, S), P ? t.set(function(e, t, n, r) {
            return r.barTransition = r.barMap[t][2], n > 0 ? (addClass(r.barMap[t][2], "im-page--date-bar-transition-inverse"), addClass(e, "im-page--date-bar-transition-inverse")) : n < 0 && (removeClass(r.barMap[t][2], "im-page--date-bar-transition-inverse"), removeClass(e, "im-page--date-bar-transition-inverse")), addClass(r.barMap[t][2], "im-page--date-bar-transition"), addClass(e, "im-page--date-bar-transition"), Promise.resolve(r)
        }.bind(null, n, C.date, _)) : t.set(function(e, t) {
            return t.barTransition && (removeClass(t.barTransition, "im-page--date-bar-transition"), t.barTransition = null), removeClass(e, "im-page--date-bar-transition"), Promise.resolve(t)
        }.bind(null, n)), T && setStyle(n, (m = {}, g = cssTransformProp, b = T, g in m ? Object.defineProperty(m, g, {
            value: b,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : m[g] = b, m)), toggleClass(n, "im-page--top-date-bar_no-b", M)
    }

    function w(e, t) {
        var n = geByClass1("_im_top_date_bar"),
            r = Object(a.default)({
                lastTop: !1,
                barMap: {},
                barMapKeys: []
            }),
            o = null,
            i = null,
            s = null,
            c = debounce(function(e) {
                r.set(b.bind(null, t, e, !1))
            }, 500);
        return {
            reset: function(o) {
                r.set(b.bind(null, t, o, !0)).then(function() {
                    O(e, r, n, t, o)
                })
            },
            disable: function() {
                r.reset()
            },
            heightIncreased: function(e, t) {
                return c(t), r.set(function(e, t) {
                    return t.barMapKeys.forEach(function(n) {
                        t.barMap[n][0] -= e
                    }), Promise.resolve(t)
                }.bind(null, e))
            },
            parseMore: function(o, i) {
                r.set(b.bind(null, o, i, !1)).then(function() {
                    O(e, r, n, t, i)
                })
            },
            toggle: function(e) {
                e ? setStyle(n, {
                    display: ""
                }) : hide(n)
            },
            show: function() {
                i = Date.now(), s || (addClass(geByClass1("_im_page_history"), "im-page--top-date-bar_visible"), s = setInterval(function() {
                    Date.now() - i > m && (removeClass(geByClass1("_im_page_history"), "im-page--top-date-bar_visible"), clearInterval(s), s = null)
                }, g))
            },
            update: function(i) {
                o && (clearTimeout(o), o = null), o = setTimeout(function() {
                    O(e, r, n, t, i)
                }, d), O(e, r, n, t, i)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(256),
        o = n(252),
        i = n(406),
        a = n(1),
        s = "_im_top_banner_button",
        c = "_im_top_banner_hide";

    function u(e, t) {
        var n = geByClass1("_im_dialog_actions", e);
        toggleClass(n, "im-page--chat-header_top-banner", t)
    }

    function l(e, t) {
        var n = geByClass1(c, e);
        n && window.tooltips && tooltips.hide(n), u(e, !1), t.innerHTML = ""
    }

    function d(e, t, n) {
        var d = geByClass1("_im_top_banner", e),
            f = Object(r.createModule)({
                handlers: function(r, i) {
                    var u = geByClass1("_im_dialog_actions", e);
                    i(e, "click", c, function(r) {
                        t.set(o.hideTopBannerAction.bind(null, t.get().peer)), l(e, d);
                        var i = !!Object(a.renderPinnedMessage)(t);
                        Object(a.compensateHistoryHeightChange)(t, i, !0, n)
                    }), i(e, "click", s, function(r) {
                        var i = function(e, t, n, r) {
                                var i = domData(e, "payload");
                                return !!i && (t.set(o.callbackTopBannerAction.bind(null, t.get().peer, i)), l(n, r), !0)
                            }(r.target, t, e, d),
                            s = !!Object(a.renderPinnedMessage)(t);
                        Object(a.compensateHistoryHeightChange)(t, s, !i, n)
                    }), i(u, "mouseover", c, function(e, t) {
                        showTooltip(t, {
                            text: getLang("mail_top_banner_hide"),
                            black: 1,
                            shift: [8, 4],
                            appendEl: bodyNode
                        })
                    })
                }
            });
        return {
            renderPeer: function(t) {
                var r, o, s, c = Object(i.getTab)(t, t.get().peer).top_banner,
                    f = d.children.length;
                c && !Object(i.isSearchShown)(t) ? (u(e, !0), d.innerHTML = (o = (r = c).icon ? getTemplate("im_top_banner_icon", {
                    icon: r.icon
                }) : "", s = (s = (r.buttons || []).map(function(e) {
                    var t = "";
                    switch (e.layout) {
                        case "secondary":
                            t = "secondary";
                            break;
                        default:
                            t = "blue_button"
                    }
                    return "link" === e.type ? getTemplate("im_top_banner_button_link", {
                        link: e.link,
                        text: e.text,
                        css_class: t
                    }) : getTemplate("im_top_banner_button", {
                        callback_data: e.callback_data,
                        text: e.text,
                        css_class: t
                    })
                })).concat([getTemplate("im_top_banner_hide_btn", {})]), getTemplate("im_top_banner", {
                    text: r.text,
                    icon: o,
                    buttons: s.join("")
                }))) : d.children.length && l(e, d);
                var p = d.children.length;
                Object(a.compensateHistoryHeightChange)(t, p, f, n)
            },
            unmount: function() {
                Object(r.destroyModule)(f)
            }
        }
    }
}, , function(e, t, n) {
    var r = n(346);
    e.exports = function(e, t, n, o) {
        try {
            return o ? t(r(n)[0], n[1]) : t(n)
        } catch (t) {
            var i = e.return;
            throw void 0 !== i && r(i.call(e)), t
        }
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63)),
        i = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t() {
            return function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t),
                function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.className,
                n = e.appearance,
                a = e.wide,
                s = e.overflow,
                c = e.size,
                u = (e.children, function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["className", "appearance", "wide", "overflow", "size", "children"])),
                l = o.classNames.apply(void 0, ["Button"].concat(function(e) {
                    if (Array.isArray(e)) {
                        for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                        return n
                    }
                    return Array.from(e)
                }(Array.isArray(n) ? n.map(function(e) {
                    return "Button--" + e
                }) : ["Button--" + n]), ["Button--size-" + c, {
                    "Button--wide": !!a,
                    "Button--overflow": !!s,
                    "Button--disabled": !!e.disabled
                }, t]));
            return r.createElement("button", i({}, u, {
                className: l
            }), e.children)
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        appearance: "primary",
        size: "m",
        wide: !1
    }
}, , , , , function(e, t, n) {
    "use strict";
    var r = n(184).f,
        o = n(201),
        i = (n(426), n(447)),
        a = n(160),
        s = n(408),
        c = n(51),
        u = n(297),
        l = n(350),
        d = n(234),
        f = n(173),
        p = n(263),
        _ = n(115).fastKey,
        m = p ? "_s" : "size",
        g = function(e, t) {
            var n, r = _(t);
            if ("F" !== r) return e._i[r];
            for (n = e._f; n; n = n.n)
                if (n.k == t) return n
        };
    e.exports = {
        getConstructor: function(e, t, n, l) {
            var d = e(function(e, r) {
                s(e, d, t, "_i"), e._i = o(null), e._f = void 0, e._l = void 0, e[m] = 0, void 0 != r && u(r, n, e[l], e)
            });
            return i(d.prototype, {
                clear: function() {
                    for (var e = this._i, t = this._f; t; t = t.n) t.r = !0, t.p && (t.p = t.p.n = void 0), delete e[t.i];
                    this._f = this._l = void 0, this[m] = 0
                },
                delete: function(e) {
                    var t = g(this, e);
                    if (t) {
                        var n = t.n,
                            r = t.p;
                        delete this._i[t.i], t.r = !0, r && (r.n = n), n && (n.p = r), this._f == t && (this._f = n), this._l == t && (this._l = r), this[m]--
                    }
                    return !!t
                },
                forEach: function(e) {
                    s(this, d, "forEach");
                    for (var t, n = a(e, arguments.length > 1 ? arguments[1] : void 0, 3); t = t ? t.n : this._f;)
                        for (n(t.v, t.k, this); t && t.r;) t = t.p
                },
                has: function(e) {
                    return !!g(this, e)
                }
            }), p && r(d.prototype, "size", {
                get: function() {
                    return c(this[m])
                }
            }), d
        },
        def: function(e, t, n) {
            var r, o, i = g(e, t);
            return i ? i.v = n : (e._l = i = {
                i: o = _(t, !0),
                k: t,
                v: n,
                p: r = e._l,
                n: void 0,
                r: !1
            }, e._f || (e._f = i), r && (r.n = i), e[m]++, "F" !== o && (e._i[o] = i)), e
        },
        getEntry: g,
        setStrong: function(e, t, n) {
            l(e, t, function(e, t) {
                this._t = e, this._k = t, this._l = void 0
            }, function() {
                for (var e = this._k, t = this._l; t && t.r;) t = t.p;
                return this._t && (this._l = t = t ? t.n : this._t._f) ? d(0, "keys" == e ? t.k : "values" == e ? t.v : [t.k, t.v]) : (this._t = void 0, d(1))
            }, n ? "entries" : "values", !n, !0), f(t)
        }
    }
}, function(e, t) {
    var n = 0,
        r = Math.random();
    e.exports = function(e) {
        return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++n + r).toString(36))
    }
}, , , , , , function(e, t, n) {
    n(444), n(183), n(121), n(295), e.exports = n(230).Map
}, , , , function(e, t, n) {
    var r = n(399)("wks"),
        o = n(141),
        i = n(316).Symbol,
        a = "function" == typeof i;
    e.exports = function(e) {
        return r[e] || (r[e] = a && i[e] || (a ? i : o)("Symbol." + e))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return l
    });
    var r = n(256),
        o = n(1),
        i = n(252),
        a = n(406),
        s = "_im_retry_media",
        c = "_im_replied_message";

    function u(e, t, n, r, u) {
        if (!Object(i.isSearchingInplace)(e.get().peer, e.get()) && !(hasClass(u, o.FAILED_CLASS) || hasClass(u, o.SENDING_CLASS) || hasClass(u, "_im_mess_srv") || Object(o.checkSelectClick)(r, u) || Object(a.isAnyMessageBeingEdited)(e) || "A" === r.target.tagName || domClosest(c, r.target) || r.target.classList.contains(s))) {
            var l = intval(domData(u, "msgid")),
                d = e.get().peer;
            if (!Object(o.isAlreadyDeleted)(e, d, l)) {
                var f = void 0,
                    p = void 0;
                f = r.shiftKey ? Object(a.getMessageRangeFromSelection)(e, d, l) : [l], e.set(i.addSelection.bind(null, f)).then(function() {
                    var r = Object(a.getSelectedMessages)(e),
                        o = !1;
                    f.forEach(function(e) {
                        var t = geByClass1("_im_mess_" + e, n);
                        if (t) {
                            var i = inArray(e, r);
                            o |= i, toggleClass(t, "im-mess_selected", i);
                            var a = i ? getLang("mail_deselect_message") : getLang("mail_select_message"),
                                s = geByClass1("_im_mess_blind_label_select", t);
                            attr(s, "aria-label", a)
                        }
                    }), o && (window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty()), t().changedMessageSelection(e)
                }).then(function() {
                    1 !== e.get().selectedMessages.length || p ? p && p.hide() : p = function(e) {
                        var t = e.get();
                        if (t.pinnedMessagesPromo && Object(o.isChatPeer)(t.peer)) {
                            var n = geByClass1("_mess-action-promo"),
                                r = new ElementTooltip(n, {
                                    autoShow: !1,
                                    appendTo: n,
                                    content: getTemplate("im_pinned_messages_promo", {
                                        content: getLang("mail_pinned_messages_promo_tooltip")
                                    }),
                                    forceSide: "bottom",
                                    cls: "feature_intro_tt",
                                    width: 260,
                                    onHide: function() {
                                        e.setState({
                                            pinnedMessagesPromo: !1
                                        }), Object(i.hidePromoTooltip)()
                                    }
                                });
                            return r.show(), r
                        }
                    }(e)
                })
            }
        }
    }

    function l(e, t, n) {
        var o = u.bind(null, t, n, e),
            i = Object(r.createModule)({
                handlers: function(t, n) {
                    n(e, "click", "_im_mess", o)
                }
            });
        return function(e, t) {
            return {
                cleanSelection: function(t) {
                    t && Array.isArray(t) && t.length && t.map(function(t) {
                        return geByClass1("_im_mess_" + t, e)
                    }).filter(function(e) {
                        return e
                    }).forEach(function(e) {
                        return removeClass(e, "im-mess_selected")
                    })
                },
                unmount: function() {
                    Object(r.destroyModule)(t)
                }
            }
        }(e, i)
    }
}, , , , function(e, t, n) {
    "use strict";
    e.exports = function(e) {
        if (void 0 === (e = e || ("undefined" != typeof document ? document : void 0))) return null;
        try {
            return e.activeElement || e.body
        } catch (t) {
            return e.body
        }
    }
}, function(e, t, n) {
    "use strict";
    var r = n(441);
    e.exports = function(e) {
        return r(e) && 3 == e.nodeType
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63)),
        i = n(170),
        a = n(205),
        s = n(402),
        c = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var u = 27,
        l = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onRemoveToken = function(e) {
                    var t = r.searchContainer.offsetHeight;
                    r.props.onRemoveToken(e.target.getAttribute("data-id")).then(function() {
                        r.updateScroll(t)
                    })
                }, r.onChange = function(e) {
                    var t = e.target.value;
                    t !== r.value && (r.value = t, r.props.onChange(e), r.scrollContainer.scrollTop = 0)
                }, r.onSelect = function(e) {
                    var t = r.searchContainer.offsetHeight;
                    r.props.onSelect(e.currentTarget.getAttribute("data-id")).then(function() {
                        r.updateScroll(t)
                    })
                }, r.onKeydown = function(e) {
                    e.keyCode === u && (r.input.value = "", r.input.blur(), r.props.onChange(e), e.stopPropagation())
                }, r.updateScroll = function(e) {
                    var t = r.searchContainer.offsetHeight;
                    r.input.focus(), r.searchContainer.scrollTop = r.searchContainer.scrollHeight, e !== t && (r.scrollContainer.scrollTop = r.scrollContainer.scrollTop + t - e)
                }, r.inputRef = function(e) {
                    r.input = e
                }, r.searchContainerRef = function(e) {
                    r.searchContainer = e
                }, r.scrollContainerRef = function(e) {
                    var t = e;
                    if (e && e.container)
                        for (t = e; t.container;) t = t.container;
                    r.scrollContainer = t
                }, r.value = n.value, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                this.input.addEventListener("keydown", this.onKeydown)
            }, t.prototype.componentWillUnmount = function() {
                this.input.removeEventListener("keydown", this.onKeydown)
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.className,
                    u = t.tokens,
                    l = (t.onSelect, t.onRemoveToken, t.removeTokenPlaceholder),
                    d = t.value,
                    f = t.placeholder,
                    p = t.useInfiniteScroll,
                    _ = t.loadMore,
                    m = t.hasMore,
                    g = t.virtualized,
                    h = t.notFoundText,
                    b = t.children,
                    v = t.emptyText,
                    y = t.isSearching,
                    O = function(e, t) {
                        var n = {};
                        for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                        return n
                    }(t, ["className", "tokens", "onSelect", "onRemoveToken", "removeTokenPlaceholder", "value", "placeholder", "useInfiniteScroll", "loadMore", "hasMore", "virtualized", "notFoundText", "children", "emptyText", "isSearching"]),
                    w = p ? i.default : "div",
                    E = p ? {
                        loadMore: _,
                        hasMore: m,
                        virtualized: g,
                        useCapture: !1
                    } : {},
                    C = [].concat(b);
                return r.createElement("div", {
                    className: Object(o.classNames)("MultiSelect", n)
                }, r.createElement("div", {
                    className: "MultiSelect__search",
                    ref: this.searchContainerRef
                }, u.map(function(t, n) {
                    return r.createElement("span", {
                        className: "MultiSelect__token",
                        key: t.id
                    }, r.createElement("span", {
                        className: "MultiSelect__tokenTitle"
                    }, t.text), l ? r.createElement(s.default, {
                        text: l
                    }, r.createElement("span", {
                        className: "MultiSelect__tokenRemove",
                        "data-id": t.id,
                        onClick: e.onRemoveToken
                    })) : r.createElement("span", {
                        className: "MultiSelect__tokenRemove",
                        "data-id": t.id,
                        onClick: e.onRemoveToken
                    }))
                }), r.createElement("div", {
                    className: "MultiSelect__caret"
                }, r.createElement("div", {
                    className: "MultiSelect__caretIn"
                }, r.createElement("input", c({}, O, {
                    type: "text",
                    className: "MultiSelect__input",
                    placeholder: 0 === u.length ? f : "",
                    onChange: this.onChange,
                    onInput: this.onChange,
                    onPaste: this.onChange,
                    value: d,
                    ref: this.inputRef
                }))))), 0 === C.length && (d || v) && !y && r.createElement("div", {
                    className: "MultiSelect__empty"
                }, r.createElement("div", {
                    className: "MultiSelect__emptyIn"
                }, d ? h : v)), r.createElement(w, c({
                    className: "MultiSelect__scroll",
                    ref: this.scrollContainerRef
                }, E), C.map(function(t) {
                    return r.createElement(a.default, {
                        className: "MultiSelect__suggestsItem",
                        "data-id": t.props["data-id"],
                        onClick: e.onSelect,
                        key: t.key
                    }, t)
                })))
            }, t
        }(r.PureComponent);
    t.default = l, l.defaultProps = {
        removeTokenPlaceholder: "",
        placeholder: "",
        value: "",
        useInfiniteScroll: !1,
        notFoundText: "Not found"
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "MAIN", function() {
        return m
    }), n.d(t, "EDIT", function() {
        return g
    });
    var r = n(451),
        o = (n(96), n(409)),
        i = n(59),
        a = n(190),
        s = n(135),
        c = n(457),
        u = n(389),
        l = n(468),
        d = n(452),
        f = n(252),
        p = n(420);
    var _ = o.default.getLang,
        m = "main",
        g = "edit",
        h = function(e) {
            function t() {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                for (var n = arguments.length, r = Array(n), o = 0; o < n; o++) r[o] = arguments[o];
                var i = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call.apply(e, [this].concat(r)));
                return i.setEditableMessage = function(e) {
                    var t = e.id,
                        n = e.name,
                        r = e.text;
                    return new Promise(function(e) {
                        return i.setState({
                            editableMessage: {
                                id: t,
                                name: n,
                                text: r
                            }
                        }, e)
                    })
                }, i.onChangeEditableMessage = function(e, t) {
                    return i.setEditableMessage(Object.assign({}, i.state.editableMessage, function(e, t, n) {
                        return t in e ? Object.defineProperty(e, t, {
                            value: n,
                            enumerable: !0,
                            configurable: !0,
                            writable: !0
                        }) : e[t] = n, e
                    }({}, e, Object(p.escape)(t))))
                }, i.deleteTemplate = function(e) {
                    return Promise.resolve().then(function() {
                        return i.state.section !== m ? i.go(m) : Promise.resolve()
                    }).then(function() {
                        return i.props.store.set(f.deleteTemplate.bind(null, e))
                    }).catch(function() {
                        showFastBox(_("mail_error"), _("mail_community_templates_delete_error"))
                    })
                }, i.saveTemplate = function(e) {
                    e.preventDefault();
                    var t = i.state.editableMessage,
                        n = t.name,
                        r = t.text;
                    n.length > 200 || n.length < 2 || n.length > 2e3 || r.length < 5 ? showFastBox(_("mail_error"), _("mail_form_is_filled_in_incorrectly")) : i.props.saveTemplate(t).catch(function() {
                        showFastBox(_("mail_error"), _("mail_community_templates_save_error"))
                    }).then(function() {
                        return i.go(m)
                    })
                }, i.addHint = function(e, t) {
                    t.preventDefault();
                    var n = i.state.editableMessage,
                        r = n.id,
                        o = void 0 === r ? null : r,
                        a = n.name,
                        s = n.text;
                    return Object(l.setHTML)(i.textarea, "{" + e.id + "}"), i.setEditableMessage({
                        id: o,
                        name: a,
                        text: s + "{" + e.id + "} "
                    })
                }, i.getTextAreaRef = function(e) {
                    i.textarea = (e || {}).container
                }, i.state = {
                    section: i.props.section,
                    editableMessage: {
                        id: null,
                        name: "",
                        text: ""
                    }
                }, i
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.go = function(e) {
                var t = this,
                    n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                    r = n.id,
                    o = void 0 === r ? null : r,
                    i = n.name,
                    a = void 0 === i ? "" : i,
                    s = n.text,
                    c = void 0 === s ? "" : s;
                return new Promise(function(n) {
                    t.state.section !== e ? t.setState({
                        section: e,
                        editableMessage: {
                            id: o,
                            name: a,
                            text: c
                        }
                    }, function() {
                        t.props.popup.updateBoxCoords(), n()
                    }) : n()
                })
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.getTemplates,
                    o = t.closePopup,
                    a = this.state,
                    f = a.section,
                    p = a.editableMessage,
                    h = n();
                return r.createElement("section", {
                    className: "TemplatesSettings"
                }, r.createElement(i.default, {
                    title: r.createElement("span", {
                        className: "TemplatesSettings__title"
                    }, f === m && _("mail_community_templates"), f === g && _("mail_add_community_template")),
                    onCloseClick: o
                }), r.createElement("main", {
                    className: "TemplatesSettings__content"
                }, f === m && (h.length ? r.createElement(c.default, {
                    className: "TemplatesSettings__scroll-wrapper"
                }, r.createElement("div", {
                    className: "TemplatesSettings__list"
                }, h.map(function(t) {
                    return r.createElement("section", {
                        key: t.id,
                        className: "TemplatesSettings__item"
                    }, r.createElement("h3", {
                        className: "TemplatesSettings__item-name",
                        dangerouslySetInnerHTML: {
                            __html: t.name
                        }
                    }), r.createElement("div", {
                        className: "TemplatesSettings__item-content",
                        dangerouslySetInnerHTML: {
                            __html: t.text
                        }
                    }), r.createElement("div", {
                        className: "TemplatesSettings__buttons-row"
                    }, r.createElement(u.default, {
                        onClick: function() {
                            return e.go(g, t)
                        },
                        className: "TemplatesSettings__item-button"
                    }, _("mail_settings_edit")), r.createElement("span", {
                        className: "TemplatesSettings__buttons-splitter",
                        "aria-hidden": "true"
                    }, " · "), r.createElement(u.default, {
                        onClick: e.deleteTemplate.bind(null, t.id),
                        className: "TemplatesSettings__item-button"
                    }, _("mail_delete"))))
                }))) : r.createElement("div", {
                    className: "TemplatesSettings__not-found-container"
                }, r.createElement("span", null, _("mail_community_templates_not_found")), r.createElement(u.default, {
                    onClick: function() {
                        return e.go(g)
                    }
                }, _("mail_add_community_template")))), f === g && r.createElement("form", {
                    className: "TemplatesSettings__form",
                    id: "create_template_form",
                    onSubmit: this.saveTemplate
                }, r.createElement("div", {
                    className: "TemplatesSettings__form-row"
                }, r.createElement("label", {
                    className: "TemplatesSettings__label",
                    htmlFor: "name"
                }, _("mail_name"), ":"), r.createElement("div", {
                    className: "TemplatesSettings__input-container"
                }, r.createElement(l.default, {
                    id: "name",
                    type: "text",
                    initialValue: p.name,
                    className: "TemplatesSettings__input",
                    onChange: this.onChangeEditableMessage.bind(null, "name")
                }), r.createElement("span", {
                    className: "TemplatesSettings__notice"
                }, _("mail_community_templates_input_size").replace("{min}", 2).replace("{max}", "200")))), r.createElement("div", {
                    className: "TemplatesSettings__form-row"
                }, r.createElement("label", {
                    className: "TemplatesSettings__label",
                    htmlFor: "text"
                }, _("mail_text"), ":"), r.createElement("div", {
                    className: "TemplatesSettings__input-container"
                }, r.createElement(l.default, {
                    id: "text",
                    name: "text",
                    isMultiLine: !0,
                    ref: this.getTextAreaRef,
                    initialValue: p.text,
                    className: "TemplatesSettings__textarea",
                    onChange: this.onChangeEditableMessage.bind(null, "text")
                }), r.createElement("span", {
                    className: "TemplatesSettings__notice"
                }, _("mail_community_templates_input_size").replace("{min}", 5).replace("{max}", "2 000")))), r.createElement("div", {
                    className: "TemplatesSettings__form-row"
                }, r.createElement("label", {
                    className: "TemplatesSettings__label"
                }, _("mail_hints"), ":"), r.createElement("div", {
                    className: "TemplatesSettings__input-container"
                }, Object(d.default)().map(function(t) {
                    return r.createElement(s.default, {
                        type: "button",
                        onMouseDown: e.addHint.bind(null, t),
                        appearance: "secondary",
                        className: "TemplatesSettings__hint",
                        key: t.id
                    }, t.label)
                }))))), r.createElement("footer", {
                    className: "TemplatesSettings__footer"
                }, f === m && r.createElement(r.Fragment, null, r.createElement(u.default, {
                    onClick: function() {
                        return e.go(g)
                    }
                }, _("mail_add_community_template")), r.createElement(s.default, {
                    onClick: o
                }, _("mail_close"))), f === g && r.createElement(r.Fragment, null, r.createElement("div", null, p.id && r.createElement(u.default, {
                    onClick: this.deleteTemplate.bind(null, p.id)
                }, _("mail_delete_community_template"))), r.createElement("div", null, r.createElement(s.default, {
                    appearance: "tertiary",
                    onClick: function() {
                        return e.go(m)
                    }
                }, _("mail_cancel")), r.createElement(s.default, {
                    onClick: this.saveTemplate,
                    form: "create_template_form",
                    type: "submit"
                }, _("mail_save"))))))
            }, t
        }(r.Component);
    h.defaultProps = {
        section: m
    }, t.default = Object(a.connect)(h)
}, function(e, t, n) {
    var r = n(429);
    e.exports = function(e, t, n) {
        if (r(e), void 0 === t) return e;
        switch (n) {
            case 1:
                return function(n) {
                    return e.call(t, n)
                };
            case 2:
                return function(n, r) {
                    return e.call(t, n, r)
                };
            case 3:
                return function(n, r, o) {
                    return e.call(t, n, r, o)
                }
        }
        return function() {
            return e.apply(t, arguments)
        }
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return T
    });
    var r = n(252),
        o = n(406),
        i = n(1),
        a = n(373),
        s = n(256),
        c = n(292),
        u = n(392),
        l = n(112),
        d = n(339),
        f = n(272),
        p = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        _ = debounce(c.statlogsProbValueEvent, 1e3),
        m = "_im_important_counter",
        g = "_im_gim_mute";

    function h(e) {
        return ge("im_dialogs_search", e)
    }

    function b(e, t, n, i, a, s) {
        var c = trim(s);
        if (Object(o.isSearchingValue)(e, c)) {
            var u = w.bind(null, e, n, a, t);
            c ? (e.setState({
                recentSearch: !1
            }), a.stop()) : a.replaceOrAdd(u), cancelStackPush("im_search", u), c && e.set(r.setCurrentSearch.bind(null, c, !1)).then(t), addClass(i, "im-page--dialogs-search_fill"), addClass(i, "_im_d_search")
        } else c || (a.stop(), e.set(r.setCurrentSearch.bind(null, "", !1)).then(t), removeClass(i, "im-page--dialogs-search_fill"), removeClass(i, "_im_d_search"))
    }

    function v(e, t, n) {
        return function() {
            Object(o.getSearchText)(t) === e && n.apply(void 0, arguments)
        }
    }

    function y(e, t, n) {
        var i = Object(o.getSearchText)(n);
        return _(.01, "im_search_stat", 1, "search_start"), Object(r.updateSearchQuery)(i), n.setState({
            recentSearch: !1
        }), e().toggleSettingsButton(n, !!i), i ? (n.get().dialog_search_going = !0, function(e, t, n) {
            var o = v(e, n, t().appendFastDialogs.bind(null, n));
            return Object(r.searchTopConv)(e, n.get()).then(function(e) {
                return o(e), e
            })
        }(i, e, n).then(function(r) {
            var o = r.map(function(e) {
                return e.peerId
            });
            return t(i, e, o, n)
        }).then(function(e) {
            n.get().dialog_search_going = !1
        }).catch(function() {})) : (e().restoreDialogs(n, !1, !0), Promise.resolve(!1))
    }

    function O(e, t, n, o) {
        var a = o.get(),
            s = v(e, o, t().appendDialogs.bind(null, o)),
            c = v(e, o, t().appendSearch);
        return Object(i.isPendingForward)(o) ? Object(r.searchHints)(e, n, "all", {}, a).then(s) : Promise.all([Object(r.searchHints)(e, n, "all", {}, a).then(s), Object(r.searchMessages)(e, a)]).then(function(e) {
            var t = p(e, 2),
                n = p(t[1], 2),
                r = n[0],
                i = n[1];
            c(o, r, i, !0)
        })
    }

    function w(e, t, n, r) {
        cancelStackFilter("im_search");
        var o = h(t);
        uiSearch.reset(o), e.setState({
            recentSearch: !1
        }), b(e, r, t, o, n, o.value)
    }

    function E(e, t) {
        return showTooltip(t, {
            appendEl: bodyNode,
            text: function() {
                return Object(o.isSearching)(e) ? getLang("mail_cancel") : getLang("mail_start_conversaion")
            },
            black: 1,
            shift: [3, -1],
            appendCls: "js-im-page"
        })
    }

    function C(e, t, n) {
        var o = n.target;
        e.set(r.toggleCommunityMute.bind(null, t)).then(function() {
            toggleClass(o, "im-page--gim-mute_muted", e.get().mute), t && j(e, {
                target: o
            })
        })
    }

    function j(e, t) {
        var n = t.target;
        return showTooltip(n, {
            text: function() {
                return e.get().mute ? getLang("mail_im_sound_off") : getLang("mail_im_sound_on")
            },
            black: 1,
            shift: [13, 9],
            appendCls: "js-im-page"
        })
    }

    function k(e, t, n, r, o, i) {
        return {
            focusInput: function(t) {
                uiSearch.focus(h(e).parentNode)
            },
            createCanceled: function(e, n) {
                removeClass(t, "im-dialog-select_rotated")
            },
            rotateCross: function(e) {
                addClass(t, "im-dialog-select_rotated")
            },
            setSearch: function(t, n) {
                var o = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                ! function(e, t, n, r, o) {
                    var i = h(t);
                    i.value = o, b(e, r, t, i, n, i.value)
                }(t, e, r, o ? i : function() {}, n)
            },
            clearSearch: function(t) {
                w(t, e, r, function() {})
            },
            updateImportantCnt: function(t) {
                var n = t.get().important_cnt,
                    r = geByClass1(m, e);
                toggleClass(r, "im-page--stars_hidden", 0 === n), r.innerHTML = "<i></i> " + n
            },
            unmount: function() {
                r.stop(), Object(s.destroyModule)(o), uiSearch.destroy(n), cancelStackFilter("im_search")
            }
        }
    }

    function T(e, t, n) {
        var c = geByClass1("_im_search_croll", e),
            p = h(e),
            _ = Object(a.default)("im_search", ["_im_search_croll", "_im_page_dcontent", "_im_d_search", "_im_dialog"]),
            v = Object(u.debouncedPromise)(O, 300),
            T = y.bind(null, n, v),
            S = b.bind(null, t, T, e, p, _),
            M = function(e, t, n, r, i, a) {
                Object(o.isSearching)(e) ? (w(e, t, i, n), setTimeout(function() {
                    return E(e, a)
                }, 10)) : (window.tooltips && tooltips.hide(a, {
                    showsp: 0
                }), function(e, t, n) {
                    n().showCreation(e)
                }(e, 0, r))
            }.bind(null, t, e, T, n, _, c),
            P = function(e, t, n, r, o) {
                return Object(i.showFavvedBox)(e, n, d.mount, r)
            }.bind(null, t, e, n),
            x = geByClass1("_im_dialogs_search_input", e);
        uiSearch.init(x, {
            onChange: S
        });
        var I = E.bind(null, t, c),
            D = geByClass1(g, e);
        p.value && S(p.value);
        var A = Object(s.createModule)({
            handlers: function(a, s) {
                if (a(geByClass1("_im_av_time", e), "mouseover", function(e) {
                        showTooltip(e.target, {
                            text: getLang("mail_admin_av_time"),
                            dir: geByClass1("_im_top_notice") || geByClass1("im-page--dialogs--group-status") ? "down" : "up",
                            shift: [0, 8]
                        })
                    }), a(c, "click", M), a(c, "mouseover", I), a(geByClass1(m, e), "click", P), Object(i.isClassicInterface)(t)) {
                    var u = C.bind(null, t, !0),
                        d = j.bind(null, t);
                    a(D, "click", u), a(D, "mouseover", d)
                }
                a(p, "focus", function() {
                    t.get().longpoll.push([Object(l.transitionEvent)("search")])
                }), a(p, "click", function() {
                    Object(o.isSearching)(t) && n().toggleSettingsButton(t, !0),
                        function(e, t, n, a, s) {
                            if (!Object(o.isSearching)(e)) {
                                var c = cur.imDb.select(f.RECENT_SEARCH_OP);
                                if (0 !== c.length || Object(o.doPopularSuggExist)(e)) {
                                    e.setState({
                                        recentSearch: !0
                                    }), b(e, function() {
                                        Object(o.isSearching)(e) || (a.stop(), s().toggleSettingsButton(e, !1), s().restoreDialogs(e, !1, !0))
                                    }, t, n, a, "");
                                    var u = c.filter(function(t) {
                                            return !Object(i.isTabLoadedWithMessage)(e.get(), t)
                                        }),
                                        l = c.filter(function(t) {
                                            return Object(i.isTabLoadedWithMessage)(e.get(), t)
                                        }).reduce(function(t, n) {
                                            return t[n] = Object(o.getTab)(e, n), t
                                        }, {});
                                    e.get().topConvTree.then(function(t) {
                                        var n = t.list.filter(function(e) {
                                                return inArray(e[0], u)
                                            }).reduce(function(e, t) {
                                                return e[t[0]] = Object(r.localIndexToDialog)(t), e
                                            }, {}),
                                            o = extend({}, n, l);
                                        return s().appendFastDialogs(e, c.map(function(e) {
                                            return o[e]
                                        })), Object(r.searchHints)(!1, Object.keys(n), !1, {}, e.get())
                                    }).then(function(t) {
                                        s().appendDialogs(e, t)
                                    })
                                }
                            }
                        }(t, e, p, _, n)
                }), a(p, "blur", function() {
                    var e = void 0;
                    e = 0 === t.get().peer ? "search" : Object(i.isPendingForward)(t) ? "search" : "default", Object(o.isSearching)(t) || n().toggleSettingsButton(t, !1), t.get().longpoll.push([Object(l.transitionEvent)(e)])
                })
            }
        });
        return Object(i.isClassicInterface)(t) && C(t, !1, {
            target: D
        }), k(e, c, x, _, A, T)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "animate", function() {
        return s
    }), n.d(t, "cubicBezier", function() {
        return c
    }), n.d(t, "fadeTo", function() {
        return u
    }), n.d(t, "FxBase", function() {
        return l
    }), n.d(t, "Fx", function() {
        return d
    }), n.d(t, "genFx", function() {
        return f
    }), n.d(t, "slideDown", function() {
        return p
    }), n.d(t, "slideUp", function() {
        return _
    }), n.d(t, "slideToggle", function() {
        return m
    }), n.d(t, "fadeIn", function() {
        return g
    }), n.d(t, "fadeOut", function() {
        return h
    }), n.d(t, "fadeToggle", function() {
        return b
    }), n.d(t, "getRGB", function() {
        return v
    }), n.d(t, "getColor", function() {
        return y
    }), n.d(t, "animateCount", function() {
        return O
    });
    var r = n(269),
        o = n(347),
        i = n(324),
        a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };

    function s(e, t, n, s) {
        if (e = Object(o.ge)(e)) {
            var c = Object(r.isFunction)(s) ? s : function() {},
                u = Object(r.extend)({}, "object" === (void 0 === n ? "undefined" : a(n)) ? n : {
                    duration: n,
                    onComplete: c
                }),
                d = {},
                f = {},
                p = Object(o.isVisible)(e),
                _ = void 0;
            u.orig = {}, (t = Object(r.clone)(t)).discrete && (u.discrete = 1, delete t.discrete), i.browser.iphone && (u.duration = 0);
            var m = Object(o.data)(e, "tween"),
                g = p ? "hide" : "show";
            for (var h in m && m.isTweening && (u.orig = Object(r.extend)(u.orig, m.options.orig), m.stop(!1), m.options.show ? g = "hide" : m.options.hide && (g = "show")), t)
                if (t.hasOwnProperty(h)) {
                    if (!m && ("show" === t[h] && p || "hide" === t[h] && !p)) return u.onComplete.call(this, e);
                    if ("height" !== h && "width" !== h || !e.style || (t.overflow || (void 0 === u.orig.overflow && (u.orig.overflow = Object(o.getStyle)(e, "overflow")), e.style.overflow = "hidden"), Object(o.hasClass)(e, "inl_bl") || "TD" === e.tagName || (e.style.display = "block")), /show|hide|toggle/.test(t[h]))
                        if ("toggle" === t[h] && (t[h] = g), "show" === t[h]) {
                            _ = 0, u.show = !0, void 0 === u.orig[h] && (u.orig[h] = Object(o.getStyle)(e, h, !1) || "", Object(o.setStyle)(e, h, 0));
                            var b = e.style[h];
                            e.style[h] = u.orig[h], t[h] = parseFloat(Object(o.getStyle)(e, h, !0)), e.style[h] = b, "height" === h && i.browser.msie && !t.overflow && (e.style.overflow = "hidden")
                        } else void 0 === u.orig[h] && (u.orig[h] = Object(o.getStyle)(e, h, !1) || ""), u.hide = !0, t[h] = 0
                }
            return u.show && !p && Object(o.show)(e), m = new l(e, u), Object(r.each)(t, function(t, n) {
                if (/backgroundColor|borderBottomColor|borderLeftColor|borderRightColor|borderTopColor|color|borderColor|outlineColor/.test(t)) {
                    if (_ = y(e, "borderColor" === t ? "borderTopColor" : t), n = v(n), void 0 === _) return
                } else {
                    var i = n.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/);
                    i && (n = parseFloat(i[2]), i[1] && (n = ("-=" == i[1] ? -1 : 1) * n + n)), 0 != (_ = m.cur(t, !0)) || "width" !== t && "height" !== t || (_ = 1), "opacity" === t && n > 0 && !p && (Object(o.setStyle)(e, "opacity", 0), _ = 0, Object(o.show)(e))
                }(_ != n || Object(r.isArray)(_) && _.join(",") === n.join(",")) && (d[t] = _, f[t] = n)
            }), m.start(d, f), Object(o.data)(e, "tween", m), m
        }
    }

    function c(e, t, n, r, o, i) {
        var a = function(t) {
                var r = 1 - t;
                return 3 * r * r * t * e + 3 * r * t * t * n + t * t * t
            },
            s = function(e) {
                var n = 1 - e;
                return 3 * n * n * e * t + 3 * n * e * e * r + e * e * e
            },
            c = function(t) {
                var r = 1 - t;
                return 3 * (2 * (t - 1) * t + r * r) * e + 3 * (-t * t * t + 2 * r * t) * n
            },
            u = o,
            l = void 0,
            d = void 0;
        for (l = u, d = 0; d < 8; d++) {
            var f = a(l) - u;
            if (Math.abs(f) < i) return s(l);
            var p = c(l);
            if (Math.abs(p) < 1e-6) break;
            l -= f / p
        }
        var _ = 0,
            m = 1;
        if ((l = u) < _) return s(_);
        if (l > m) return s(m);
        for (; _ < m;) {
            var g = a(l);
            if (Math.abs(g - u) < i) return s(l);
            u > g ? _ = l : m = l, l = .5 * (m - _) + _
        }
        return s(l)
    }

    function u(e, t, n, r) {
        return s(e, {
            opacity: n
        }, t, r)
    }
    var l = function() {
            function e(t, n, i) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, e), this.el = Object(o.ge)(t), this.name = i, this.options = Object(r.extend)({
                    onStep: function() {},
                    onComplete: function() {},
                    transition: n.transition || d.Transitions.sineInOut,
                    duration: 500
                }, n || {})
            }
            return e.prototype.start = function(e, t) {
                var n = this;
                this.from = e, this.to = t, this.time = Object(r.vkNow)(), this.isTweening = !0;
                var o = function(e) {
                    return n.step(e)
                };
                return o.el = this.el, o() && d.Timers.push(o) && !d.TimerId && (d.TimerId = setInterval(function() {
                    for (var e = d.Timers, t = e.length, n = 0; n < t; n++) e[n]() || (e.splice(n--, 1), t--);
                    t || (clearInterval(d.TimerId), d.TimerId = null)
                }, 13)), this
            }, e.prototype.stop = function(e) {
                for (var t = d.Timers, n = t.length - 1; n >= 0; n--) t[n].el === this.el && (e && t[n](!0), t.splice(n, 1));
                this.isTweening = !1
            }, e.prototype.step = function(e) {
                var t = Object(r.vkNow)();
                if (!e && t < this.time + this.options.duration) {
                    for (var n in this.cTime = t - this.time, this.now = {}, this.to)
                        if (Object(r.isArray)(this.to[n])) {
                            for (var i = [], a = 0; a < 3; a++) {
                                if (void 0 === this.from[n] || void 0 === this.to[n]) return !1;
                                i.push(Math.min(parseInt(this.compute(this.from[n][a], this.to[n][a])), 255))
                            }
                            this.now[n] = i
                        } else this.now[n] = this.compute(this.from[n], this.to[n]), this.options.discrete && (this.now[n] = Object(r.intval)(this.now[n]));
                    return this.update(), !0
                }
                return setTimeout(this.options.onComplete.bind(this, this.el), 10), this.now = Object(r.extend)(this.to, this.options.orig), this.update(), this.options.hide && Object(o.hide)(this.el), this.isTweening = !1, !1
            }, e.prototype.compute = function(e, t) {
                var n = t - e;
                return this.options.transition(this.cTime, e, n, this.options.duration)
            }, e.prototype.update = function() {
                for (var e in this.options.onStep(this.now), this.now) Object(r.isArray)(this.now[e]) ? Object(o.setStyle)(this.el, e, "rgb(" + this.now[e].join(",") + ")") : void 0 !== this.el[e] ? this.el[e] = this.now[e] : Object(o.setStyle)(this.el, e, this.now[e])
            }, e.prototype.cur = function(e, t) {
                return null == this.el[e] || this.el.style && null != this.el.style[e] ? parseFloat(Object(o.getStyle)(this.el, e, t)) || 0 : this.el[e]
            }, e
        }(),
        d = {
            Base: l,
            Transitions: {
                linear: function(e, t, n, r) {
                    return n * e / r + t
                },
                sineInOut: function(e, t, n, r) {
                    return -n / 2 * (Math.cos(Math.PI * e / r) - 1) + t
                },
                halfSine: function(e, t, n, r) {
                    return n * Math.sin(Math.PI * (e / r) / 2) + t
                },
                easeOutBack: function(e, t, n, r) {
                    var o = 1.70158;
                    return n * ((e = e / r - 1) * e * ((o + 1) * e + o) + 1) + t
                },
                easeInCirc: function(e, t, n, r) {
                    return -n * (Math.sqrt(1 - (e /= r) * e) - 1) + t
                },
                easeOutCirc: function(e, t, n, r) {
                    return n * Math.sqrt(1 - (e = e / r - 1) * e) + t
                },
                easeInQuint: function(e, t, n, r) {
                    return n * (e /= r) * e * e * e * e + t
                },
                easeOutQuint: function(e, t, n, r) {
                    return n * ((e = e / r - 1) * e * e * e * e + 1) + t
                },
                easeOutCubic: function(e, t, n, r) {
                    return n * ((e = e / r - 1) * e * e + 1) + t
                },
                swiftOut: function(e, t, n, r) {
                    return n * c(.4, 0, .22, 1, e / r, 4 / r) + t
                }
            },
            Attrs: [
                ["height", "marginTop", "marginBottom", "paddingTop", "paddingBottom"],
                ["width", "marginLeft", "marginRight", "paddingLeft", "paddingRight"],
                ["opacity", "left", "top"]
            ],
            Timers: [],
            TimerId: null
        };

    function f(e, t) {
        var n = {};
        return Object(r.each)(d.Attrs.concat.apply([], d.Attrs.slice(0, t)), function() {
            n[this] = e
        }), n
    }
    var p = function(e, t, n) {
            return s(e, f("show", 1), t, n)
        },
        _ = function(e, t, n) {
            return s(e, f("hide", 1), t, n)
        },
        m = function(e, t, n) {
            return s(e, f("toggle", 1), t, n)
        },
        g = function(e, t, n) {
            return s(e, {
                opacity: "show"
            }, t, n)
        },
        h = function(e, t, n) {
            return s(e, {
                opacity: "hide"
            }, t, n)
        },
        b = function(e, t, n) {
            return s(e, {
                opacity: "toggle"
            }, t, n)
        };

    function v(e) {
        var t = void 0;
        return e && Object(r.isArray)(e) && 3 == e.length ? e : (t = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e)) ? [parseInt(t[1]), parseInt(t[2]), parseInt(t[3])] : (t = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e)) ? [2.55 * parseFloat(t[1]), 2.55 * parseFloat(t[2]), 2.55 * parseFloat(t[3])] : (t = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e)) ? [parseInt(t[1], 16), parseInt(t[2], 16), parseInt(t[3], 16)] : (t = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e)) ? [parseInt(t[1] + t[1], 16), parseInt(t[2] + t[2], 16), parseInt(t[3] + t[3], 16)] : void 0
    }

    function y(e, t) {
        var n = void 0;
        do {
            if (0 === (n = Object(o.getStyle)(e, t)).indexOf("rgba") && (n = ""), "" != n && "transparent" !== n || "body" === e.nodeName.toLowerCase()) break;
            t = "backgroundColor", e = e.parentNode
        } while (e);
        return v(n)
    }

    function O(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};
        if (e = Object(o.ge)(e), t = n.str ? Object(r.trim)(t.toString()) || "" : Object(r.positive)(t), e)
            if (!i.browser.mobile || i.browser.safari_mobile || i.browser.android) {
                var a = Object(o.data)(e, "curCount"),
                    c = Object(o.data)(e, "nextCount");
                if ("number" == typeof c || n.str && "string" == typeof c) t != c && Object(o.data)(e, "nextCount", t);
                else if ("number" == typeof a || n.str && "string" == typeof a) t !== a && Object(o.data)(e, "nextCount", t);
                else if (a = n.str ? Object(r.trim)(Object(o.val)(e).toString()) || "" : Object(r.positive)(Object(o.val)(e)), "auto" === n.str && (n.str = !a.match(/^\d+$/) || !t.match(/^\d+$/), n.str || (a = Object(r.positive)(a), t = Object(r.positive)(t))), a !== t) {
                    Object(o.data)(e, "curCount", t);
                    var u, l = n.str ? a.length === t.length ? a < t : a.length < t.length : a < t,
                        f = (l ? t : a).toString(),
                        p = (l ? a : t).toString(),
                        _ = void 0,
                        m = [],
                        g = [];
                    for (n.str || (p = new Array(f.length - p.length + 1).join("0") + p), _ = 0, u = f.length; _ < u; _++) {
                        var h = f.charAt(_);
                        if (h !== p.charAt(_)) break;
                        m.push(h)
                    }
                    var b = f.substr(_),
                        v = p.substr(_);
                    if (n.str) {
                        for (_ = b.length; _ > 0; _--) {
                            var y = b.charAt(_);
                            if (y !== v.charAt(_)) break;
                            g.unshift(y)
                        }
                        g.length && (b = b.substr(0, _ + 1), v = v.substr(0, _ + 1))
                    }
                    m = m.join("").replace(/\s$/, "&nbsp;"), g = g.join("").replace(/^\s/, "&nbsp;"), Object(r.trim)(Object(o.val)(e)) || n.noSpaceIfEmpty || Object(o.val)(e, "&nbsp;");
                    var w = e.clientHeight || e.offsetHeight;
                    Object(o.val)(e, '<div class="counter_wrap inl_bl"></div>');
                    var E, C = e.firstChild,
                        j = void 0,
                        k = void 0,
                        T = void 0,
                        S = !0;
                    m.length && C.appendChild(j = Object(o.ce)("div", {
                        className: "counter_const inl_bl",
                        innerHTML: m
                    })), m.length || (v = v.replace(/^0+/, "")), v && ("0" !== v || m.length) || (v = n.noSpaceIfEmpty ? "" : "&nbsp;", S = !!m.length), C.appendChild(T = Object(o.ce)("div", {
                        className: "counter_anim_wrap inl_bl"
                    })), T.appendChild(E = Object(o.ce)("div", {
                        className: "counter_anim " + (l ? "counter_anim_inc" : "counter_anim_dec"),
                        innerHTML: '<div class="counter_anim_big"><span class="counter_anim_big_c">' + b + "</span></div>" + (S ? '<div class="counter_anim_small"><span class="counter_anim_small_c">' + v + "</span></div>" : "")
                    }, S ? {
                        marginTop: l ? -w : 0
                    } : {
                        right: 0
                    })), n.str && Object(o.setStyle)(E, {
                        textAlign: "right",
                        right: 0
                    });
                    var M = Object(o.getSize)(Object(o.geByClass1)("counter_anim_big_c", E, "span"))[0],
                        P = S ? "&nbsp;" === v ? M : Object(o.getSize)(Object(o.geByClass1)("counter_anim_small_c", E, "span"))[0] : 0;
                    !v && n.noSpaceIfEmpty && (P = 0), g.length && C.appendChild(k = Object(o.ce)("div", {
                        className: "counter_const inl_bl",
                        innerHTML: g
                    })), n.noWrapWidth || Object(o.setStyle)(C, {
                        width: (j && Object(o.getSize)(j)[0] || 0) + (k && Object(o.getSize)(k)[0] || 0) + M + 0
                    }), void 0 === i.browser.csstransitions && (i.browser.csstransitions = i.browser.chrome && i.browser.version >= 9 || i.browser.mozilla && i.browser.version >= 4 || i.browser.opera && i.browser.version >= 10.5 || i.browser.safari && i.browser.version >= 3.2 || i.browser.safari_mobile || i.browser.android);
                    var x = i.browser.csstransitions;
                    Object(o.setStyle)(T, {
                        width: l ? P : M
                    });
                    var I = function() {
                            Object(o.val)(e, t || (n.noSpaceIfEmpty ? "" : " "));
                            var r = Object(o.data)(e, "nextCount");
                            Object(o.data)(e, "curCount", !1), Object(o.data)(e, "nextCount", !1), ("number" == typeof r || n.str && "string" == typeof r) && setTimeout(O.pbind(e, r, n), 0), n.onDone && n.onDone()
                        },
                        D = S ? {
                            marginTop: l ? 0 : -w
                        } : {
                            marginRight: l ? -P : 0
                        };
                    x ? (Object(o.getStyle)(T, "width"), Object(o.addClass)(T, "counter_css_anim_wrap"), M !== P && Object(o.setStyle)(T, {
                        width: l ? M : P
                    }), S && Object(o.setStyle)(E, D), setTimeout(I, 300), n.fadeMode && (Object(o.setStyle)(Object(o.geByClass1)("counter_anim_big", e), "opacity", 1), Object(o.setStyle)(Object(o.geByClass1)("counter_anim_small", e), "opacity", 0))) : (M !== P && s(T, {
                        width: l ? M : P
                    }, {
                        duration: 100
                    }), S ? s(E, D, {
                        duration: 300,
                        transition: d.Transitions.easeOutCirc,
                        onComplete: I
                    }) : setTimeout(I, 300))
                }
            } else Object(o.val)(e, t || "")
    }
}, , , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createLongpollEventsQueue", function() {
        return i
    });
    var r = function() {
        return function(e, t) {
            if (Array.isArray(e)) return e;
            if (Symbol.iterator in Object(e)) return function(e, t) {
                var n = [],
                    r = !0,
                    o = !1,
                    i = void 0;
                try {
                    for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                } catch (e) {
                    o = !0, i = e
                } finally {
                    try {
                        !r && s.return && s.return()
                    } finally {
                        if (o) throw i
                    }
                }
                return n
            }(e, t);
            throw new TypeError("Invalid attempt to destructure non-iterable instance")
        }
    }();

    function o(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
            return n
        }
        return Array.from(e)
    }

    function i(e, t, n) {
        var i = 0,
            a = e,
            s = [],
            c = !1;

        function u() {
            !s.length || i > 0 || c || (t(s), s = [])
        }
        return {
            pause: function() {
                i++
            },
            resume: function() {
                i > 0 && (i--, u())
            },
            onLp: function(e, t, i) {
                var l;
                c || (a >= e ? (a = t, (l = s).push.apply(l, o(i)), u()) : n && (c = !0, n(a).then(function(e) {
                    var t, n = r(e, 3),
                        i = (n[0], n[1]),
                        l = n[2];
                    a = i, c = !1, (t = s).push.apply(t, o(l)), u()
                })))
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(381)),
        i = n(113),
        a = n(63),
        s = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var c = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.checkLoad = Object(o.default)(function(e) {
                var t = s(e, 3),
                    n = t[0],
                    o = t[1],
                    i = t[2];
                if (!r.loading) return r.props.virtualized || r.props.hasMore ? void(o - n - i <= r.props.threshold && (r.loading = !0, r.props.loadMore().then(function() {
                    r.loading = !1
                }))) : r.detachListeners()
            }, 34), r.onScroll = function(e) {
                var t = r.getScrollData();
                r.props.virtualized && r.processChildren(r.props.children, t), r.props.hasMore && r.checkLoad(t)
            }, r.getRef = function(e) {
                r.container = e, r.props.virtualized && r.setState(r.getChildrenData(r.props.children, r.getScrollData()))
            }, r.useWindowScroll = n.useWindowScroll, n.virtualized && (r.state = {
                before: 0,
                after: n.children.length,
                start: 0,
                end: 0
            }), r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.getScrollData = function() {
            var e = this.useWindowScroll ? document.documentElement : this.container;
            return [this.getScrollTop(), e ? e.scrollHeight : 0, e ? e.clientHeight : 0]
        }, t.prototype.getScrollTop = function() {
            var e = document.documentElement || document.body.parentNode || document.body;
            return this.useWindowScroll ? void 0 !== window.pageYOffset ? window.pageYOffset : e.scrollTop : this.container ? this.container.scrollTop : 0
        }, t.prototype.attachListeners = function() {
            var e = this.useWindowScroll ? window : this.container;
            this.container && (e.addEventListener("scroll", this.onScroll, this.props.useCapture), e.addEventListener("resize", this.onScroll, this.props.useCapture))
        }, t.prototype.detachListeners = function() {
            var e = this.useWindowScroll ? window : this.container;
            this.container && (e.removeEventListener("scroll", this.onScroll, this.props.useCapture), e.removeEventListener("resize", this.onScroll, this.props.useCapture))
        }, t.prototype.processChildren = function(e, t) {
            var n = this.state,
                r = this.getChildrenData(e, t || this.getScrollData()),
                o = r.start,
                i = r.end,
                a = r.before,
                s = r.after;
            o === n.start && i === n.end && a === n.before && s === n.after || this.setState(r)
        }, t.prototype.getChildrenData = function(e, t) {
            var n = s(t, 3),
                r = n[0],
                o = n[1],
                i = n[2],
                a = this.useWindowScroll ? window : this.container,
                c = a && a.offsetHeight;
            if (!a || 0 === o || 0 === i) return {
                start: 0,
                end: 0,
                before: 0,
                after: e.length
            };
            i = Math.max(i, c);
            var u = e.length,
                l = Math.max(Math.floor(r / this.props.itemHeight) - 1, 0),
                d = Math.min(Math.floor((r + 2 * i) / this.props.itemHeight + 1), u);
            return {
                start: l,
                end: d,
                before: l,
                after: u - d
            }
        }, t.prototype.componentWillReceiveProps = function(e) {
            this.props.virtualized && this.processChildren(e.children)
        }, t.prototype.componentDidMount = function() {
            this.attachListeners()
        }, t.prototype.componentWillUnmount = function() {
            this.detachListeners()
        }, t.prototype.render = function() {
            return r.createElement("div", {
                className: Object(a.classNames)("InfiniteScroll", this.props.className),
                ref: this.getRef,
                style: this.props.style
            }, this.props.virtualized && this.state.before > 0 && r.createElement("div", {
                style: {
                    height: this.state.before * this.props.itemHeight
                },
                key: "before"
            }), this.props.virtualized ? [].concat(this.props.children).slice(this.state.start, this.state.end) : this.props.children, this.props.virtualized && this.state.after > 0 && r.createElement("div", {
                style: {
                    height: this.state.after * this.props.itemHeight
                },
                key: "after"
            }), this.props.hasMore && (this.props.loader || r.createElement("div", {
                className: "InfiniteScroll__loader",
                key: "loader"
            }, r.createElement(i.default, null))))
        }, t
    }(r.Component);
    t.default = c, c.defaultProps = {
        useWindowScroll: !1,
        virtualized: !1,
        hasMore: !0,
        useCapture: !1,
        threshold: 100,
        itemHeight: 55
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(63),
        i = n(409),
        a = n(389),
        s = n(217),
        c = n(205),
        u = n(391),
        l = n(302),
        d = n(309),
        f = n(1);
    var p = i.default.getLang,
        _ = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onCopyInviteLink = function(e) {
                    r.input && (r.input.focus(), r.input.select(), document.execCommand("copy"), r.setState({
                        copied: !0
                    })), e.preventDefault(), e.stopPropagation()
                }, r.onBlinkTextHide = function() {
                    r.setState({
                        copied: !1
                    })
                }, r.getHiddenInput = function(e) {
                    r.input = e
                }, r.onShowInviteLink = function() {
                    Object(d.canChangeInviteLink)(r.props.store) && r.props.showInvitationLink()
                }, r.state = {
                    copied: !1
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.store,
                    n = e.flagsUpdated,
                    i = e.onHideStatus,
                    _ = t.get(),
                    m = _.tabs[_.peer],
                    g = Object(f.isFvkcomgroup)(_, _.peer),
                    h = m.inviteLink && Object(d.canSeeInviteLink)(t) || Object(d.canChangeInviteLink)(t),
                    b = Object(d.isUserOwnerInChat)(m, _.id) && !g,
                    v = Object(o.classNames)("ChatSettingsMenu", {
                        "ChatSettingsMenu--copied": this.state.copied
                    });
                return r.createElement("div", {
                    className: "ChatSettings__pane"
                }, r.createElement(s.default, {
                    className: v
                }, r.createElement(c.default, {
                    onClick: this.props.showAttachments,
                    chevron: !0
                }, r.createElement(l.default, {
                    type: "attach"
                }), p("mail_im_show_media_history"))), (h || b) && r.createElement(s.default, {
                    className: v
                }, h && r.createElement(c.default, {
                    onClick: this.onShowInviteLink,
                    chevron: Object(d.canChangeInviteLink)(t)
                }, r.createElement(l.default, {
                    type: "link"
                }), p(g ? "mail_vkcomgroup_invite_link" : "mail_chat_invite_link"), m.inviteLink && r.createElement("span", {
                    className: "ChatSettingsMenu__invite"
                }, r.createElement("span", {
                    className: "ChatSettingsMenu__hidden"
                }, r.createElement("input", {
                    type: "text",
                    readOnly: !0,
                    value: m.inviteLink,
                    ref: this.getHiddenInput
                })), r.createElement(u.default, {
                    className: "ChatSettingsMenu__copied",
                    shown: this.state.copied,
                    callback: this.onBlinkTextHide
                }, p("mail_invite_link_copied")), r.createElement(a.default, {
                    className: "ChatSettingsMenu__copy",
                    onClick: this.onCopyInviteLink
                }, p("mail_get_invite_link_copy")))), b && r.createElement(c.default, {
                    onClick: this.props.showSettings,
                    chevron: !0,
                    aside: r.createElement(u.default, {
                        shown: n,
                        callback: i
                    }, p("global_changes_saved"))
                }, r.createElement(l.default, {
                    type: "gear"
                }), p("mail_settings_options"))))
            }, t
        }(r.Component);
    t.default = _
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return Re
    });
    var r = n(252),
        o = n(440),
        i = n(1),
        a = n(406),
        s = n(187),
        c = n(427),
        u = n(450),
        l = n(256),
        d = n(259),
        f = n(70),
        p = n(376),
        _ = n(228),
        m = n(275),
        g = n(152),
        h = n(281),
        b = n(260),
        v = n(130),
        y = n(112),
        O = n(285),
        w = n(329),
        E = n(80),
        C = n(272),
        j = n(464),
        k = n(425),
        T = n(124),
        S = n(131),
        M = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        P = 1e3,
        x = -30,
        I = 30,
        D = 2e3,
        A = 700,
        L = 15,
        R = 47,
        B = "_im_to_end",
        N = "_im_failed_action",
        U = "_im_mess_link",
        F = "_im_admin_name",
        H = "_im_typer_c",
        W = "_im_error",
        K = "_im_join_cancel",
        q = "_im_retry_media",
        z = "im-audio-message_recorded",
        G = "im-audio-message_recording",
        V = "_im_mess_srv",
        Y = "im_srv_mess_link",
        Q = "_chat_invitation",
        $ = "_im_mess",
        X = "_im_replied_message",
        J = "_im_replied_author_link",
        Z = !1,
        ee = {};

    function te(e) {
        var t = Object(a.getTab)(e, e.get().peer);
        return !!Object(a.getPinnedMessage)(e) || !!t.top_banner
    }

    function ne(e, t) {
        var n = Object(s.unpackStore)(e),
            r = Object(a.getTab)(n, t);
        return Object(i.isChatPeer)(t) && Object(h.isPinnedMessageVisibleInTab)(n, t) || !!r.top_banner && !Object(a.isSearchShown)(t, n)
    }

    function re(e, t) {
        return Object(i.getPinnedMessageHeight)()
    }

    function oe(e, t) {
        var n = ge("page_header"),
            r = geByClass1("_im_chat_input_w", t),
            o = r.offsetHeight - r.clientHeight;
        return Math.min(window.clientHeight() - o, Math.max(Math.max(0, e), A + n.offsetHeight + t.offsetTop))
    }

    function ie(e, t) {
        return geByClass1("_im_mess_" + t, e)
    }

    function ae(e) {
        hide(e.target)
    }

    function se(e, t, n) {
        var o = Object(a.getTab)(t, n),
            i = Object(r.strHistory)(o.history);
        toggleClass(e, "im-page--history_empty-hist", !i)
    }

    function ue(e) {
        return geByClass1("_im_peer_history", e)
    }

    function le(e, t) {
        var n = t.contHeight(),
            r = e.scrollTop + (n - e.contHeight);
        t.scrollTop(r)
    }

    function de(e, t, n, o, a, s, c, u) {
        var l = !(arguments.length > 8 && void 0 !== arguments[8]) || arguments[8],
            d = arguments.length > 9 && void 0 !== arguments[9] && arguments[9],
            f = (t.get().tabs || {})[n];
        a().hideError(), s.renderPeer(t), u.renderPeer(t);
        var p = geByClass1("_im_peer_history", e);
        if (!t.get().tabHistoryNotChanged) {
            val(geByClass1("_im_page_peer_name", e), f.tab);
            var _ = Object(r.strHistory)(f.history);
            se(e, t, n), _ || (_ = getLang("mail_im_here_history")), val(p, _), getAudioPlayer().isPlaying() && getAudioPlayer().updateCurrentPlaying(), Object(i.isClassicInterface)(t) || Object(i.fixTableCellChildHeight)("_chat_body_wrap", e), je(t, o, e)
        }
        if (Object(r.isSearchingInplace)(n, t.get()) ? a().showSearch(t) : a().cancelSearch(t, !1), c.changePeer(n, t), t.get().msgid) be(o, e, t.get().msgid, t);
        else if (f.scrollBottom && l) {
            le(f, o);
            var m = Object(i.isMessagesVisible)(t, e, o),
                g = M(m, 1)[0];
            f.skipped || setTimeout(function() {
                f.unread && !g && Oe(t, e, !0), pe(t, o, e)
            }, 100)
        } else he(o, e, a, t, d) || o.scrollBottom(x);
        window.LazyLoad && window.LazyLoad.scan(!!o.scroll && o.scroll.scroller)
    }

    function fe(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2] || t.scrollTop(),
            o = t.scrollBottom(),
            i = t.contHeight(),
            a = e.get().peer;
        e.set(r.saveHistoryScroll.bind(null, a, n, o, i))
    }

    function pe(e, t, n) {
        var r = Object(a.isGoToEndVisible)(e),
            o = 4 * t.getScrollHeight();
        t.scrollBottom() > o && !r && Oe(e, n, !0, 2 * t.getScrollHeight())
    }

    function _e(e, t, n, o, s, c, l, d) {
        var f = !(arguments.length > 8 && void 0 !== arguments[8]) || arguments[8];
        if ((e.get().history_init || (e.get().history_init = !0, !(d.scrollTop() > 0))) && !u.screenfull.isFullscreen) {
            s.update(d), s.show();
            var p = e.get().peer;
            if (0 !== p && Object(i.isFullyLoadedTab)(e.get(), p) && (w.default.onHistoryScroll(d.scrollTop()), !layers.visible)) {
                var _ = Object(a.isGoToEndVisible)(e),
                    m = Object(a.getTab)(e, p);
                m && !m.skipped && l < 0 ? pe(e, d, c) : l > 0 && !m.skipped && !m.unread && Me(e, c), ye(e, d) && (_ && m && !m.skipped && Me(e, c), m.unread > 0 && me(e));
                var g = Object(i.wrapLoading)(n);
                if (!Object(r.isSearchingInplace)(p, e.get()) && f && o(d), !Z && (l < 0 || 0 === d.scrollBottom()) && d.scrollBottom() < P) {
                    if (Object(r.isSearchingInplace)(p, e.get())) return;
                    if (m.skipped > 0 && !e.get().no_moving_down) {
                        var h = gpeByClass("_im_page_history", h),
                            b = e.get();
                        Z = !0;
                        var v = e.set(r.loadLessHistory).then(t().loadHistory.bind(null, b.peer, {
                            reversed: !0
                        })).then(function() {
                            me(e), Z = !1, Oe(e, h), m.skipped || e.set(r.changePeer.bind(null, e.get().peer, !1, !1))
                        });
                        return Ee(h, !0), void v.then(Ee.bind(null, h, !1))
                    }
                }
                if (!Z && d.scrollTop() < P) {
                    if (Object(r.isSearchingInplace)(p, e.get())) {
                        Z = !0;
                        var y = t().getSearchResulstModule();
                        return y.isAll(e) ? void(Z = !1) : void g(y.loadMore(e).then(function(n) {
                            Z = !1, n && (t().loadHistory(e.get().peer, {}, e, n), o(d))
                        }), "up")
                    }
                    var O = e.get();
                    m.allShown || (Z = !0, g(e.set(r.loadMoreHistory.bind(null, 0, 0)).then(t().loadHistory.bind(null, O.peer, {})).then(function() {
                        Z = !1, o(d)
                    }), "up"))
                }
                l < 0 && De(e, p, d.scrollBottom(), c, t), Object(r.videoAutoPlayHandler)()
            }
        }
    }

    function me(e) {
        if (!(window.curNotifier && curNotifier.idle_manager && curNotifier.idle_manager.is_idle)) return e.set(r.readLastMessages.bind(null, e.get().peer))
    }

    function he(e, t, n, r, o) {
        var a = geByClass1("_im_unread_bar_row", t);
        if (a) {
            var s = r.get(),
                c = s.peer,
                u = a.getBoundingClientRect(),
                l = geByClass1("_im_chat_body_abs", t).getBoundingClientRect().top + 20;
            Object(i.isClassicInterface)(r) && (l += R + (ne(s, c) ? re() : 0));
            var d = e.scrollTop() - l + u.top;
            return e.scrollTop(d), fe(r, e, d), setTimeout(function() {
                c === r.get().peer && _e(r, n, ue(t), function() {}, o, t, 0, e)
            }, 80), me(r), !0
        }
        return !1
    }

    function be(e, t, n, r) {
        var o = ie(t, n);
        if (o) {
            var a = Object(i.isClassicInterface)(r),
                s = r.get().peer,
                c = a ? window.clientHeight() : geByClass1("_im_chat_body_abs", t).offsetHeight,
                u = o.offsetTop + domPN(o).offsetTop + domPN(domPN(o)).offsetTop + domPN(domPN(domPN(o))).offsetTop;
            a && ne(r, s) && (u -= re(r.get())), e.scrollTop(u - e.getScrollHeight() / 2 + c / 2), addClass(o, "im-mess_light"), setTimeout(function() {
                removeClass(o, "im-mess_light")
            }, D)
        }
    }

    function ve(e, t, n) {
        n.updateLastSeen(e)
    }

    function ye(e, t) {
        return Object(a.getUnreadScrollBottom)(e) >= intval(t.scrollBottom())
    }

    function Oe(e, t, n) {
        var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0,
            a = e.get().peer;
        if (!Object(i.isReservedPeer)(a)) {
            var s = e.get().tabs[a],
                c = geByClass1(B, t),
                u = geByClass1("_im_to_end_label", c);
            n && s.unread > 0 ? val(u, getLang("mail_im_new_messages", s.unread)) : val(u, getLang("mail_im_to_end_new"));
            var l = !1;
            (n || s.skipped > 0) && !Object(r.isSearchingInplace)(e.get().peer, e.get()) ? (l = !0, addClass(c, "im-to-end_shown")) : Se(c, !0), e.set(r.updateGoToEndVisibility.bind(null, [l, intval(o)]))
        }
    }

    function we(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
        return (0 !== e.scrollTop() || 0 !== e.scrollBottom()) && e.scrollBottom() < (t ? I + t : I)
    }

    function Ee(e, t) {
        var n = geByClass1(B, e);
        toggleClass(n, "im-to-end_loading", t)
    }

    function Ce(e, t, n, o) {
        if (!t.get().tabs[t.get().peer].skipped) return o.scrollBottom(x), Oe(t, n), me(t), void De(t, t.get().peer, 0, n, e);
        Ee(n, !0), t.set(r.changePeer.bind(null, t.get().peer, !1, !1)).then(function() {
            return t.set(r.loadPeer.bind(null, t.get().peer, !0, -1, !1))
        }).then(function() {
            Ee(n, !1), e().changePeer(t, !1, !1), me(t)
        })
    }

    function je(e, t, n) {
        var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
        if (Object(i.isClassicInterface)(e)) {
            var o = t.contHeight(),
                a = geByClass1("_im_chat_input_w", n),
                s = a.offsetHeight - a.clientHeight,
                c = geByClass1("_im_chat_resize", n),
                u = geByClass1("_im_chat_input_parent", n),
                l = geByClass1("_im_chat_audio_input_parent", n);
            if (!1 !== (r = !1 !== r ? r : Object(i.getClassicChatHeight)()) && r > 0) {
                var d = oe(r, n),
                    f = d - (hasClass(l, G) || hasClass(l, z) ? l : u).offsetHeight;
                c.style.height = window.clientHeight() - d - s + "px", setStyle(a, {
                    top: f + "px",
                    bottom: "auto"
                })
            } else c.style.height = "0px", setStyle(a, {
                top: "auto",
                bottom: "0px"
            });
            var p = geByClass1("_im_peer_history_w", n);
            return setStyle(p, {
                borderBottomWidth: a.offsetHeight - L - 1
            }), t.contHeight() - o
        }
        Object(i.fixTableCellChildHeight)("_chat_body_wrap", n);
        var _ = t.getScrollHeight();
        return t.update(!1, !0), _ - t.getScrollHeight()
    }

    function ke(e, t, n, r) {
        var o = t.offsetHeight;
        r(), e.heightIncreased(t.offsetHeight - o, n)
    }

    function Te(e, t) {
        var n = t.getBoundingClientRect().top;
        showTooltip(t, {
            className: "im-page--admin-tt",
            text: getLang("mail_only_admin_see"),
            appendParentCls: "_chat_body_wrap",
            shift: [20, 5],
            dir: "auto",
            showdt: 400,
            noZIndex: !0,
            toup: n > 200
        })
    }

    function Se(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
        hasClass(e, "im-to-end_shown") && (t && addClass(e, "im-to-end_fast"), removeClass(e, "im-to-end_shown"), t && (e.offsetHeight, removeClass(e, "im-to-end_fast")))
    }

    function Me(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
            o = geByClass1(B, t);
        e.set(r.updateGoToEndVisibility.bind(null, [!1, 0])), Se(o, n)
    }

    function Pe(e) {
        var t = Object(a.getCurrentTab)(e);
        Object(i.isChatPeer)(t.peerId) && (t.pinHideId = cur.imDb.select(C.PIN_HIDDEN_ID_OP, t.peerId))
    }

    function xe(e, t, n, r, o) {
        e.setState({
            isEditing: !1
        }), removeClass(r, "im-mess_is_editing"), removeClass(geByClass1("_im_page_history"), "is_msg_editing"), cancelStackFilter("cancel_edit"), n.setDraft(e, Object(a.getPeer)(e) ? Object(a.getTabDraft)(Object(a.getCurrentTab)(e)) : null), n.toggleStickers(e, !0), n.restoreKeyboard(), Ie(t)
    }

    function Ie(e) {
        Object(s.toArray)(geByClass("_im_history_tooltip", e)).forEach(hide)
    }

    function De(e, t, n, o, i) {
        var s = Object(a.getTab)(e, t);
        if (!(Date.now() - (s.lastReset || 0) < 1e3) && (s && s.msgs && s.history && !Z && s.offset > 300 && 0 == s.skipped && n < 50 && n >= 0 && 0 === (e.get().selectedMessages || []).length)) {
            var c = Object.keys(s.msgs).filter(function(e) {
                    return e > 0
                }).sort(function(e, t) {
                    return e - t
                }).slice(0, -50),
                u = c.slice(-1)[0];
            e.mutate(r.resetTabAll.bind(null, t)), e.set(r.removeMessages.bind(null, c, t)).then(function() {
                return i().removeStartingFromMessage(u, t, e)
            })
        }
    }

    function Ae(e) {
        checkEvent(e) || cancelEvent(e)
    }

    function Le(e, t, n, o, s, u, d, f, p, m, g, h, b, v, w, E) {
        var C = void 0,
            S = throttle(function() {
                n.smoothScroll.apply(n, arguments)
            }, 300);
        return {
            fixKeyboard: function() {
                s.fixKeyboard()
            },
            changePeer: function(e) {
                var c = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],
                    l = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2];
                if (0 === e.get().peer && w.disable(), revertLastInlineVideo(t), 0 === e.get().peer) return s.setDraft(e, null),
                    function(e) {
                        addClass(e, "im-page--history_empty"), ue(e).innerHTML = ""
                    }(t);
                if (Object(i.isFullyLoadedTab)(e.get(), e.get().peer)) {
                    removeClass(t, "im-page--history_search"), e.set(r.dropSelection), o.changeActions(e);
                    var d = e.get().peer,
                        p = e.get().prevPeer;
                    removeClass(t, "im-page--history_loading"), toggleClass(t, "im-page--history_vkcomgroup", Object(i.isFvkcomgroup)(e, d)), c ? s.setDraft(e, Object(a.getTabDraft)(Object(a.getCurrentTab)(e))) : s.updateState(e), Oe(e, t), u().updateTyping(d, e), w.toggle(!0), ve(e, 0, o), Object(i.isReservedPeer)(p) && !Object(i.isReservedPeer)(d) ? (! function(e, t, n, r, o, i, a, s, c, u) {
                        removeClass(e, "im-page--history_empty"), de(e, t, n, r, o, i, a, s, c, u)
                    }(t, e, d, n, u, o, f, E, l, w), w.reset(n)) : Object(i.isReservedPeer)(p) || Object(i.isReservedPeer)(d) || (de(t, e, d, n, u, o, f, E, l, w), w.reset(n)), Object(i.isReservedPeer)(d) || _e(e, u, ue(t), b, w, t, 0, n), Object(i.ensureDomHasActions)(t)
                }
            },
            preparePeer: function(e) {
                var n = Object(a.getPeer)(e);
                Pe(e), s.setDraft(e, Object(a.getTabDraft)(Object(a.getTab)(e, n))), u().updateTyping(n, e), u().hideError(), o.renderPeer(e), E.renderPeer(e), o.hideActions(e), f.changePeer(n, e), ve(e, 0, o), w.toggle(!1), Me(e, t, !0)
            },
            saveScroll: function(e) {
                return fe(e, n)
            },
            loadingPeer: function(e) {
                Object(r.isAnythingLoading)(e.get()) || (removeClass(t, "im-page--history_empty"), addClass(t, "im-page--history_loading"))
            },
            stopLoading: function(e) {
                removeClass(t, "im-page--history_loading")
            },
            deselectDialog: function(e) {
                d().removeSelection(e)
            },
            replaceMessageAttrs: function(e, n) {
                Object(i.replaceMessageAttrs)(n.get(), ue(t), e)
            },
            cleanSelection: function(e) {
                m.cleanSelection(e)
            },
            updateDialogFilters: function(e) {
                d().updateDialogFilters(e)
            },
            getSearchResulstModule: function() {
                return C
            },
            insertSearch: function(e, r) {
                C || (o.deselectAll(r), C = Object(_.mount)(t, r, u)), addClass(t, "im-page--history_search"), e ? (removeClass(t, "im-page--history_search-empty"), ue(t).innerHTML = e) : (addClass(t, "im-page--history_search-empty"), ue(t).innerHTML = Object(i.renderEmptySearch)()), je(r, n, t), n.scrollBottom(0), Oe(r, t), w.reset(n)
            },
            updateChatTopic: function(e, t) {
                d().updateDialog(e, t), e === t.get().peer && (o.renderPeer(t), o.renderActions(t), E.renderPeer(t))
            },
            updateActions: function(e) {
                o.changeActions(e)
            },
            updateChatPhoto: function(e, r, a) {
                if (Object(i.isPeerActive)(e.peerId, a.get())) {
                    o.renderPeer(a), E.renderPeer(a);
                    var s = we(n);
                    Object(i.addChatPhotoToUpdate)(e, r, a.get(), ue(t)), s && n.scrollBottom(x)
                }
            },
            markImportant: function(e, n, r) {
                ie(t, e) && (o.changedMessageSelection(r), p.markImportant(e, n, r))
            },
            isNewMessagesVisible: function(e) {
                return ye(e, n)
            },
            loadHistory: function(e, r, o) {
                var a = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                    s = o.get();
                if (Object(i.isPeerActive)(e, s)) {
                    var c = a || s.tabs[e].historyToAppend;
                    if (!c) return;
                    var u = geByClass1("_im_peer_history", t),
                        l = domFC(u),
                        d = n.scrollBottom(),
                        f = r.reversed ? function(e) {
                            return u.appendChild(e)
                        } : function(e) {
                            return u.insertBefore(e, l)
                        },
                        p = 0;
                    r.reversed && (p = u.offsetHeight);
                    var _ = sech(c),
                        m = document.createDocumentFragment();
                    _.forEach(function(e) {
                        return m.appendChild(e)
                    }), f(m), r.reversed && w.heightIncreased(u.offsetHeight - p, n), r.reversed || n.scrollBottomFixSave(d), n.update(!1, !0);
                    var g = _.filter(function(e) {
                        return hasClass(e, "_im_bar_date")
                    });
                    w.parseMore(g, n), Object(i.ensureDomHasActions)(t)
                }
            },
            sendMessage: function(e) {
                0 !== e.get().peer && s.sendMessage()
            },
            editMessage: function(e, r) {
                if (Object(i.isFullyLoadedTab)(e, r.peerId) && Object(i.isPeerActive)(r.peerId, e.get())) {
                    if (!ie(t, r.messageId)) return;
                    fe(e, n), Object(i.editAndReplaceMessage)(e.get(), r, t), le(Object(a.getTab)(e, r.peerId), n), o.reRenderPinned(e), w.reset(n)
                }
            },
            addMessage: function(e, o) {
                if (!Object(r.isSearchingInplace)(o.peerId, e.get()) && Object(i.isFullyLoadedTab)(e, o.peerId) && Object(i.isPeerActive)(o.peerId, e.get())) {
                    if (ie(t, o.messageId)) return;
                    var s = ue(t);
                    ke(w, s, n, function() {
                        var r = we(n),
                            l = geByClass1("_im_unread_bar_row", t),
                            d = Object(i.isMessagesVisible)(e, t, n),
                            f = M(d, 2),
                            p = f[0],
                            _ = f[1];
                        Object(i.appendToHistory)(e.get(), o, s, !0, !0, !p && !l), removeClass(t, "im-page--history_empty-hist");
                        var m = Object(a.getTab)(e, e.get().peer),
                            g = Object(c.isServiceMsg)(o) && o.userId === vk.id,
                            h = o.kludges && o.kludges.source_act,
                            b = g && h !== i.CHAT_PIN_MESSAGE && h !== i.CHAT_UNPIN_MESSAGE;
                        m.skipped || p || !Object(c.isUnread)(m, o) || Object(c.isOut)(o) || Oe(e, t, !0, _), (o.local || r || b) && n.scrollBottom(0), u().updateTyping(o.peerId, e), Ie(t)
                    });
                    var l = domPS(domLC(s));
                    if (hasClass(l, "_im_bar_date")) {
                        var d = ce("div");
                        d.innerHTML = l.outerHTML, w.parseMore(d, n)
                    }
                    u().hideError(), w.update(n), Object(r.updateMentions)(e.get()), De(e, o.peerId, n.scrollBottom(), 0, u)
                }
            },
            setMessageErrored: function(e, n, r, o) {
                r && u().showError(r), Object(i.setMessageError)(e, n, t)
            },
            markMessagesAsRead: function(e, n) {
                e.get().peer === n.peerId && Object(i.markMessagesAsRead)(e.get(), n.peerId, t)
            },
            compensateHistoryHeightChange: function(e) {
                n.scrollTop(n.scrollTop() + e * re(h.get(), h.get().peer))
            },
            updateTyping: function(e, n) {
                if (!Object(r.isSearchingInplace)(e, n.get())) {
                    var o = n.get();
                    if (o.peer === e && Object(i.isFullyLoadedTab)(o, e)) {
                        var s = Object(i.formatTyper)(Object(a.getTab)(n, e).activity, e, !1, o),
                            c = geByClass1(i.TYPING_CLASS, t);
                        if (c || s) {
                            if (!c) {
                                var l = geByClass1(H, t);
                                val(l, getTemplate("im_typing", {
                                    cls: Object(i.isClassicInterface)(n) ? "im-activity_classic" : ""
                                })), c = geByClass1(i.TYPING_CLASS, t)
                            }
                            val(geByClass1("_im_typing_name", c), s);
                            var d = Object(i.loadSummaryActivityType)(Object(a.getTab)(n, e).activity || {}) === r.ACTIVITY_TYPE_RECORDING_AUDIO;
                            c.setAttribute("data-activity-type", d ? "recording" : "typing"), s ? (addClass(c, "im-page--typing_vis"), u().hideError()) : removeClass(c, "im-page--typing_vis")
                        }
                    }
                }
            },
            scrollFix: function(e, t, r) {
                w.heightIncreased(r, n), w.update(n), Object(i.isPeerActive)(t, e.get()) && we(n, r) && n.scrollBottom(x)
            },
            goToEnd: function() {
                var e = this;
                Ce(function() {
                    return e
                }, h, t, n)
            },
            updateGoToEnd: function(e, r) {
                var o = Object(a.getTab)(e, e.get().peer);
                o && o.skipped ? Oe(e, t) : Me(e, t, r), g(0, n, !1);
                var i = e.get().peer;
                setTimeout(function() {
                    e.get().peer === i && fe(e, n)
                })
            },
            newMessage: function(e) {
                d().newMessage(e), Me(e, t, !0)
            },
            scroll: function(e, t) {
                var r = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                    o = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
                if (0 !== e.get().peer) {
                    var i = r ? n.getScrollHeight() : 40;
                    !0 === o && (i = n.contHeight()), i = "up" === t ? -i : i, r || o ? S(i, function() {
                        g(i, n)
                    }) : (n.scrollTop(n.scrollTop() + i), g(i, n))
                }
            },
            showCreation: function(e, t) {
                d().showCreation(e, t)
            },
            updateScroll: function() {
                return je(h, n, t)
            },
            toggleBarDate: function(e) {
                w.toggle(e)
            },
            changedMessageSelection: function(e) {
                o.changedMessageSelection(e)
            },
            updateOnline: function(e, t) {
                Object(i.isTabLoaded)(t.get(), e) && e === t.get().peer && o.renderPeer(t)
            },
            isEmpty: function(e) {
                return s.isEmpty(e)
            },
            replaceAttachmentPlaceholders: function(e, r) {
                if (Object(i.isPeerActive)(r.peerId, e.get())) ke(w, ue(t), n, function() {
                    var s = we(n);
                    Object(i.replaceAttaches)(t, r, e.get());
                    var c = Object(a.getTab)(e, r.peerId);
                    if (c.mediacontent[r.messageId].length >= 3 && c.mediacontent[r.messageId][2].pinned) {
                        var u = Object(a.parserMessage)(c.pinned);
                        u && u.messageId == r.messageId && (c.pinned = c.mediacontent[r.messageId][2].pinned, o.reRenderPinned(e))
                    }
                    s && n.scrollBottom(0)
                }), w.update(n);
                else if (Object(c.isMoneyRequest)(r)) {
                    var s = Object(a.getTab)(e, r.peerId);
                    if (s.mediacontent[r.messageId].length >= 3 && s.mediacontent[r.messageId][2].pinned) {
                        var u = Object(a.parserMessage)(s.pinned);
                        u && u.messageId == r.messageId && (s.pinned = s.mediacontent[r.messageId][2].pinned)
                    }
                }
            },
            removeMessages: function(e, r, a) {
                a.get().peer === r && (Object(i.removeMessages)(e, ue(t)), je(a, n, t), o.changedMessageSelection(a))
            },
            removeStartingFromMessage: function(e, r, a) {
                if (a.get().peer === r) {
                    var s = ue(t),
                        c = geByClass1("_im_mess_" + e, s);
                    Object(i.removeStartingFromMessage)(c, s), je(a, n, t), o.changedMessageSelection(a)
                }
            },
            hideGoToEnd: function(e) {
                Me(h, t, e)
            },
            removeMessagesRestore: function(e, n, r, o) {
                o.get().peer === n && Object(i.removeMessagesWithRestore)(e, n, r, ue(t))
            },
            updateState: function(e, t) {
                d().updateState(e, t)
            },
            updateBanner: function(e) {
                E.renderPeer(e)
            },
            updateChat: function(e, t) {
                e.get().peer === t && (o.changeActions(e), o.renderPeer(e), o.renderActions(e), E.renderPeer(e), s.updateState(e), Object(r.updateMentions)(e.get()))
            },
            focustTxt: function(e) {
                s.focusOn(e)
            },
            startSearch: function(e) {
                u().showSearch(e), f.changePeer(e.get().peer, e), f.search()
            },
            showSearch: function(e) {
                addClass(t, "im-page--hisory_search-open"), e.setState({
                    searchShown: !0
                }), te(e) && this.updateChatTopic(e.get().peer, e), this.cancelEditing(), setTimeout(function() {
                    return f.focus(e)
                }, 10)
            },
            cancelSearch: function(e) {
                var a = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                if (e.get().searchShown && (removeClass(t, "im-page--hisory_search-open"), removeClass(t, "im-page--history_search"), removeClass(t, "im-page--history_search-empty"), e.setState({
                        searchShown: !1
                    }), te(e) && this.updateChatTopic(e.get().peer, e), o.changedMessageSelection(e)), a && !Object(i.isReservedPeer)(e.get().peer) && C) {
                    var s = e.get().tabs[e.get().peer];
                    ue(t).innerHTML = Object(r.strHistory)(s.history), je(e, n, t), n.scrollBottom(0), e.get().msgid && (be(n, t, e.get().msgid, e), Oe(e, t)), b(n), w.reset(n)
                }
                C && (C.unmount(), C = !1, Object(i.ensureDomHasActions)(t))
            },
            updateHistory: function(e) {
                0 !== h.get().peer && e(t)
            },
            focusOnMessage: function() {
                be(n, t, h.get().msgid, h)
            },
            sendEditMessage: function(e, t) {
                e.set(r.deliverEditedMessage.bind(null, Object(a.getTab)(e, t.peerId), t)).catch(function(n) {
                    return e.get().longpoll.push([Object(y.failedMessage)(t.peerId, t, n)])
                })
            },
            unmount: function() {
                Object(l.destroyModule)(e), n.destroy(), clearInterval(v), s.unmount(), o.unmount(), p.unmount(), m.unmount(), f.unmount(), cancelStackFilter("forward"),
                    function(e, t) {
                        Object(O.removeDraggable)(geByClass1(e, t))
                    }("_im_chat_resize_track", t)
            },
            removePeer: function(e, t) {
                d().removePeer(e, t)
            },
            restoreScroll: function(e, t) {
                var r = e.get().tabs[t];
                r.scrollBottom ? le(r, n) : n.scrollBottom(x)
            },
            resendMessage: function(e, n) {
                e === h.get().peer && Object(i.startResendMessage)(e, n, t)
            },
            respond: function(e, t) {
                s.attachMessages(e, t), s.focusOn(e);
                var r = Object(a.getTab)(e, t);
                r && !r.skipped && (n.scrollBottom(x), b(n))
            },
            cancelRecording: function() {
                s.cancelRecording()
            },
            hideError: function() {
                hide(geByClass1(W, t))
            },
            showError: function(e) {
                geByClass1(W, t).innerHTML = e, show(geByClass1(W, t)), n.scrollBottom(x)
            },
            startEditing: function(e) {
                if (Object(r.isAnythingLoading)(h.get())) Object(i.showWaitUntilUploadedBox)();
                else {
                    e = Object(a.parserMessage)(e);
                    var n = Object(i.getNowEditingMessage)(h);
                    if (!(s.isBlocked() || n && n.messageId == e.messageId)) {
                        n && this.cancelEditing(), Ie(t), h.get().searchShown && this.cancelSearch(h);
                        var c = ie(t, e.messageId);
                        c && (this.cancelRecording(), function(e, t, n, r, o) {
                            e.setState({
                                isEditing: !0
                            }), n.saveText(e), addClass(r, "im-mess_is_editing"), addClass(geByClass1("_im_page_history"), "is_msg_editing"), cancelStackPush("cancel_edit", function() {
                                return xe(e, t, n, r)
                            });
                            var i = new k.ImDraft;
                            i.dData.txt = Object(j.convertEmojiHtmlToRegularText)(o.text), i.dData.attaches = Object(T.convertKludgesToAttaches)(o.kludges, o.messageId), n.toggleStickers(e, !1), n.setDraft(e, i), setTimeout(function() {
                                return n.focusOn(e)
                            }, 0)
                        }(h, t, s, c, e), s.hideKeyboard(), o.deselectAll(h))
                    }
                }
            },
            cancelEditing: function() {
                var e = Object(i.getNowEditingMessage)(h);
                e && xe(h, t, s, ie(t, e.messageId))
            },
            getEditingMessage: function() {
                return Object(i.getNowEditingMessage)(h)
            },
            focusEditingMessage: function() {
                var e = Object(i.getNowEditingMessage)(h);
                e && be(n, t, e.messageId, h), s.focusOn(h)
            }
        }
    }

    function Re(e, t, n, _, w) {
        var C = geByClass1("_im_peer_history_w", e);
        show(C), hasAccessibilityMode() && addClass(C, "history_a11y");
        var j, k, T, P = Object(l.createMutations)(Le),
            I = P.callMutations,
            D = P.bindMutations,
            A = (j = fe.bind(null, t), k = debounce(j, 100), T = throttle(j, 100), function(e) {
                k(e), T(e)
            }),
            L = Object(v.mount)(t, e),
            R = _e.bind(null, t, I, C, A, L, e),
            H = Object(b.createScroll)(geByClass1("_im_chat_body_abs", e), {
                onScroll: R,
                nativeScroll: Object(i.isClassicInterface)(t),
                shadows: !1
            });
        setTimeout(function() {
            t.get().peer && (Pe(t), (Object(a.getCurrentTab)(t).pinned || Object(a.getCurrentTab)(t).top_banner) && (I().updateChatTopic(t.get().peer, t), t.set(r.setActions), z.changeActions(t)), t.get().msgid ? be(H, e, t.get().msgid, t) : he(H, e, I, t, L) || H.scrollBottom(x), t.get().history_init = !1, L.reset(H), Oe(t, e), _e(t, I, C, A, L, e, 0, H), Object(i.ensureDomHasActions)(e), nav.objLoc.st && (t.mutate(r.setInplaceSearch.bind(null, nav.objLoc.st, t.get().peer)), I().startSearch(t)))
        }, 15);
        var z = Object(d.mount)(geByClass1("_im_dialog_actions", e), t, I),
            G = Object(f.mount)(geByClass1("_im_text_input", e), t, Object(i.isClassicInterface)(t) ? _.updateMenu : void 0, function(e, t) {
                n.removeDialog(e, t), n.restoreDialogs(e, !0)
            }, I),
            Z = Object(p.mount)(geByClass1("_im_dialog_actions", e), t, I),
            te = Object(m.mount)(e, t, I),
            ne = Object(g.mount)(e, t, function() {
                return {
                    changedMessageSelection: z.changedMessageSelection
                }
            });
        Object(h.mount)(e, t, I);
        var re = Object(S.mount)(e, t, function() {
            return {
                hidePinned: function() {
                    Object(h.pinnedMessageHide)(t, t.get().peer, I, !1)
                },
                compensateHistoryHeightChange: function(e) {
                    I().compensateHistoryHeightChange(e)
                },
                showPinned: function() {
                    Object(h.pinnedMessageUnHide)(t, t.get().peer, I, !1)
                }
            }
        });
        Object(i.isReservedPeer)(t.get().peer) || t.set(r.restoreHistoryQueue.bind(null, t.get().peer)).then(function() {
                Object(i.restoreQueue)(t.get().peer, t.get(), ue(e)), se(e, t, t.get().peer)
            }),
            function(e, t, n) {
                var r = geByClass1(e, t),
                    o = void 0,
                    a = void 0;
                Object(O.initDraggable)(r, {
                    onStartDrag: function(e, t) {
                        addClass(bodyNode, "cursor_ns_resize"), o = t, a = t
                    },
                    onDrop: function() {
                        removeClass(bodyNode, "cursor_ns_resize")
                    },
                    onDrag: function(e, r) {
                        var s = oe(a - o + r, t);
                        Object(i.setClassicChatHeight)(s), n().fixHeight()
                    }
                })
            }("_im_chat_resize_track", e, w);
        var ce = function(e, t, n, r, o) {
                var i = domData(o, "msgid"),
                    s = e.get().peer,
                    c = Object(a.getMessage)(e, s, i);
                c.type === y.EDIT_MESSAGE ? (n().sendEditMessage(e, c), n().resendMessage(s, i)) : e.get().imQueueResend(s, i).then(function(t) {
                    e.get().longpoll.push([Object(y.resendEvent)(s, t.mess)])
                })
            }.bind(null, t, e, I),
            le = function(e, t, n, o, a) {
                var s = intval(domData(a, "peer")),
                    c = intval(domData(gpeByClass("_im_mess", a), "msgid")),
                    u = e.get().tabs[s].hash;
                return Object(r.restoreMessageSend)(c, s, u, e.get().gid), e.set(r.restoreMessage.bind(null, c, s)).then(i.restoreMessage.bind(null, c, s, ue(t))).then(function() {
                    return je(e, n, t)
                }), !1
            }.bind(null, t, e, H),
            de = function(e, t) {
                e().showCreation(t)
            }.bind(null, w, t),
            pe = Ce.bind(null, I, t, e, H),
            me = function(e, t, n, r) {
                if (hasClass(n.target, "_im_mess_marker")) {
                    var o = n.target;
                    window.tooltips && Object(s.toArray)(geByClass(i.FAILED_CLASS, t)).map(function(e) {
                        return geByClass1("_im_mess_marker", e)
                    }).filter(function(e) {
                        return e !== o
                    }).forEach(function(e) {
                        return tooltips.hide(e, {
                            fasthide: !0
                        })
                    });
                    var a = domData(r, "msgid");
                    showTooltip(o, {
                        content: getTemplate("im_failed_menu", {
                            id: a
                        }),
                        className: "im-page--failed-tt" + (a > 0 ? " no_delete" : ""),
                        appendParentCls: "_chat_body_wrap",
                        dir: "down",
                        noZIndex: !0,
                        shift: [12, 8],
                        hasover: !0
                    })
                }
            }.bind(null, t, e),
            ge = i.showEditTimeTooltip.bind(null, t),
            ye = i.showMessageInfoTooltip.bind(null, t),
            we = function(e, t, n, a, s) {
                var c = domData(s, "action"),
                    u = domData(s, "msgid"),
                    l = geByClass1("_im_mess_marker", ie(n, u)),
                    d = Number(u) > 0 ? "edit" : "send";
                switch (c) {
                    case "resend":
                        Object(o.statlogsSendingRetry)("retry", d), t(a, s);
                        break;
                    case "delete":
                        Object(o.statlogsSendingRetry)("delete", d), e.set(r.removeFailed.bind(null, e.get().peer, u)).then(function() {
                            Object(i.removeMessages)([u], ue(n))
                        })
                }
                tooltips.hide(l, {
                    fasthide: !0
                })
            }.bind(null, t, ce, e),
            Ee = function(e, t, n, o, i) {
                if (checkEvent(o)) return !0;
                var a = q2ajx(i.getAttribute("href")),
                    s = intval(a.msgid);
                s && e.set(r.changePeer.bind(null, e.get().peer, s, !1)).then(function() {
                    return be(n, t, s, e)
                }), cancelEvent(o)
            }.bind(null, t, e, H),
            ke = function(e, t, n) {
                u.screenfull.isFullscreen || 0 === t.get().peer || Object(i.isClassicInterface)(t) || e().restoreScroll(t, t.get().peer)
            }.bind(null, I, t, H),
            Se = function(e, t) {
                var n = e.get(),
                    o = n.peer,
                    s = domClosest(V, t.target),
                    u = intval(domData(s, "msgid")),
                    l = Object(a.getMessage)(e, o, u),
                    d = l && Object(c.isServiceMsg)(l) && l.kludges.source_act;
                if (d === i.CHAT_PIN_MESSAGE || d === i.CHAT_UNPIN_MESSAGE) {
                    var f = s.querySelector("." + Y);
                    if (f && "A" !== f.tagName) {
                        var p = l.kludges.source_chat_local_id;
                        if (!p || ee[p]) return;
                        ee[p] = Object(r.getMessageLocalId)(o, p, n).then(function(e) {
                            var t = M(e, 1)[0];
                            if (t) {
                                var n = "/im?sel=" + Object(i.convertPeerToUrl)(o) + "&msgid=" + t,
                                    r = f.innerHTML;
                                domReplaceEl(f, Object(i.serviceLink)(n, r, !0, Y)), delete ee[p]
                            }
                        })
                    }
                }
            }.bind(null, t),
            Me = function(e, t, n) {
                var r = e.get(),
                    o = r.peer,
                    s = n.target.href && n.target.href.match(/msgid=([\d]+)/),
                    c = s && s[1];
                "A" !== n.target.tagName || !c || Object(i.isAlreadyDeleted)(e, o, c) || checkEvent(n) || (Object(a.getMessage)(e, o, c) ? (e.setState({
                    msgid: c
                }), Object(E.updateLocation)({
                    msgid: c
                }), t().focusOnMessage()) : r.longpoll.push([Object(y.changePeer)(o, c)])), cancelEvent(n)
            }.bind(null, t, I),
            xe = function(e, t, n, r) {
                var o = r.target,
                    a = domClosest(X, o),
                    s = Number(a.getAttribute("data-msgid")),
                    c = domClosest("im-mess", o),
                    u = Number(c.getAttribute("data-msgid")),
                    l = e.get().peer;
                s && !Object(i.isAlreadyDeleted)(e, l, s) ? (e.setState({
                    msgid: s
                }), Object(E.updateLocation)({
                    msgid: s
                }), Object(i.focusOnMessage)(e, t().focusOnMessage, l, s)) : u && Object(i.showRepliedBox)(e, u, r)
            }.bind(null, t, I, e),
            Ie = Object(l.createModule)({
                handlers: function(n, s) {
                    s(e, "click", i.RESTORE_CLASS, le), s(e, "mouseover click", i.FAILED_CLASS, me), s(e, "mouseover", "_im_edit_time", ge), s(e, "mouseover", "_im_page_info", ye), s(e, "click", "_im_mess_susp", function(e, t) {
                        var n = intval(domData(t.target, "msgid")),
                            r = gpeByClass("_im_mess_" + n, t.target),
                            o = geByClass1("_im_log_body", r),
                            i = geByClass1("_im_mess_susp_cont", r);
                        o.innerHTML = i.innerHTML
                    }.bind(null, e)), s(e, "click", N, we), s(e, "click", U, Ee), s(e, "mouseover", F, Te), s(e, "mouseover", V, Se), s(e, "click", Y, Me), s(e, "click", W, ae), s(e, "click", X, xe), s(e, "click", J, Ae), s(e, "click", Q, function(e, n) {
                        if (checkEvent(e)) return !0;
                        if (!gpeByClass("wall_postlink_preview_btn", e.target) && !hasClass(e.target, "wall_postlink_preview_btn")) return !0;
                        var o = geByClass1("flat_button", n),
                            a = {
                                invite_chat_id: domData(o, "inv-id"),
                                invite_hash: domData(o, "hash")
                            };
                        Object(i.showInvitationBox)(t, a, r.leaveInvitation), cancelEvent(e)
                    }), s(e, "click", K, function() {
                        return t.get().longpoll.push([Object(y.resetPeer)()])
                    }), s(e, "click", q, function(e) {
                        return function(e, t, n) {
                            var s = e.get(),
                                c = domClosest($, n.target),
                                u = domData(c, "msgid"),
                                l = Object(a.getMessage)(s, s.peer, u),
                                d = function(e) {
                                    return t().replaceAttachmentPlaceholders(e, l)
                                };
                            l && (Object(o.statlogsSendingRetry)("retry_attach"), e.set(r.addAttachmentsToStoreData.bind(null, l, [Object(i.renderMessageMedia)(e, l)])).then(d), e.set(r.loadMedia.bind(null, l)).then(d))
                        }(t, I, e)
                    }), n(geByClass1("_im_peer_history_w", e), "mousemove", L.show), n(geByClass1("_im_start_new", e), "click", de), n(geByClass1(B, e), "click", pe), n(geByClass1("_im_cancel_edit", e), "click", function() {
                        return I().cancelEditing(), !1
                    }), n(geByClass1("_im_edit_focus_cur", e), "click", function() {
                        return I().focusEditingMessage(), !1
                    }), u.screenfull.raw && n(document, u.screenfull.raw.fullscreenchange, ke), n(window, "im_goToMessage", function(e) {
                        var n = intval(e.msgid);
                        if (n) return window.statlogsValueEvent("im_links_to_attachments", 1, "to_message"), t.set(r.changePeer.bind(null, e.sel, n, !1)).then(function() {
                            return Object(i.focusOnMessage)(t, I().focusOnMessage, t.get().peer, n)
                        })
                    })
                }
            });
        curNotifier.recvClbks.pin_hide = [function(e) {
            e.hide ? Object(h.pinnedMessageHide)(t, e.peer, I, !1) : Object(h.pinnedMessageUnHide)(t, e.peer, I, !1)
        }], window.showForwardBox = function(e) {
            return function(e, t) {
                Object(i.boxHandleMessagesLabelsTooltips)(showBox("al_im.php", t, {
                    dark: 1
                }), e)
            }(t, e)
        };
        var De = setInterval(ve.bind(null, t, e, z), 1e4);
        return D(Ie, e, H, z, G, I, w, Z, te, ne, R, t, A, De, L, re)
    }
}, function(e, t, n) {
    "use strict";
    var r = n(316),
        o = n(184),
        i = n(263),
        a = n(151)("species");
    e.exports = function(e) {
        var t = r[e];
        i && t && !t[a] && o.f(t, a, {
            configurable: !0,
            get: function() {
                return this
            }
        })
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return H
    });
    var r = n(256),
        o = n(252),
        i = n(71),
        a = n(1),
        s = 600,
        c = browser.msie && intval(browser.version) < 10 ? window.XDomainRequest : window.XMLHttpRequest;

    function u(e) {
        var t = e % 60;
        return parseInt(e / 60) + ":" + (t < 10 ? "0" : "") + t
    }
    var l = void 0,
        d = void 0,
        f = void 0,
        p = void 0,
        _ = void 0,
        m = void 0,
        g = void 0,
        h = void 0,
        b = void 0,
        v = void 0,
        y = void 0,
        O = void 0,
        w = void 0,
        E = void 0,
        C = !1,
        j = !1,
        k = 100;

    function T(e) {
        if (!j) {
            j = !0, Object(a.lockButton)(m);
            var t = {
                peer: h.get().peer,
                from_place: cur.docsChooseFrom,
                imhash: cur.docsChooseImHash,
                blockPersonal: cur.docsChooseBlockPersonal,
                mail_add: cur.docsChooseMailAdd
            };
            (function(e) {
                return new Promise(function(t, n) {
                    for (var r = new FormData, o = [], i = 0; i < e.wave.length; i++) o.push(parseInt(31 * e.wave[i]));
                    r.append("waveform", JSON.stringify(o)), r.append("file", e.buffer, "voice_message." + function(e) {
                        var t = e.match(/.*\/(\w*).*/);
                        switch (t[1]) {
                            case "mpeg":
                                return "mp3";
                            case "ogg":
                            case "webm":
                            case "wav":
                                return t[1]
                        }
                        return ""
                    }(e.mimeType));
                    var a = new c;
                    a.onload = a.onerror = function(e) {
                        var r = e.currentTarget.response;
                        200 == this.status && r.length > 0 && "{" == r[0] ? (r = JSON.parse(r), t(r)) : n()
                    }, a.open("POST", E.upload_url, !0), a.send(r)
                })
            })(e).then(function(e) {
                return e.file ? new Promise(function(n, r) {
                    ajax.post("/docs.php", extend({
                        act: "a_save_doc",
                        from: "choose",
                        from_place: t.from_place,
                        imhash: t.imhash,
                        blockPersonal: t.blockPersonal,
                        mail_add: t.mail_add
                    }, e), {
                        onDone: function(e, r) {
                            x(), y([
                                ["doc", e + "_" + r, "audiomsg"]
                            ], {}, t.peer), B(), n()
                        },
                        onFail: function(e) {
                            r(e)
                        },
                        progress: null
                    })
                }) : Promise.reject()
            }).then(function() {
                Object(a.unlockButton)(m), j = !1
            }).catch(function() {
                j = !1, Object(a.unlockButton)(m), showFastBox(getLang("global_error"), getLang("mail_audio_message_upload_error"))
            })
        }
    }

    function S() {
        w(), d.innerHTML = u(C.duration), C.duration >= s && R()
    }

    function M() {
        w(), stManager.add(["voice_message_player.js", "speech.js"], function() {
            C || (C = Speech.newRecorder(), addEvent(C, "progress", S)), AudioMessagePlayer.detachPlayer(), AudioMessagePlayer.pauseGlobalMedia(), C.record().then(function() {
                var e;
                e = h, E.isRecording = !0, cancelStackPush("audio_message_cancel", function(e) {
                    e.set(o.cancelRecording).then(A)
                }.bind(null, e)), hideProgress(geByClass1("im-audio-message-send-wrapper", l)), show(m), d.innerHTML = "0:00", addClass(l, "im-audio-message_recording"), removeClass(l, "im-audio-message_recorded"), show(l), hide(geByClass1("_im_chat_input_parent")), (v = Speech.createVisualization("wave", C.source, f)).start();
                var t = f.getBoundingClientRect();
                k = (t.right - t.left) / 3
            }).catch(function(e) {
                AudioMessagePlayer.resumeGlobalMedia();
                var t = e.name;
                switch (e.name) {
                    case "DevicesNotFoundError":
                    case "NotFoundError":
                        t = "mail_audio_message_device_error";
                        break;
                    case "PermissionDeniedError":
                    case "PermissionDismissedError":
                        t = "mail_audio_message_permission_error";
                        break;
                    case "Unsupported":
                        t = "mail_audio_message_unsupported_error"
                }
                showFastBox(getLang("global_error"), getLang(t)), console.error(e)
            })
        })
    }

    function P() {
        C && C.stop(), v && (v.destroy(), v = null)
    }

    function x() {
        E.isRecording = !1, cancelStackFilter("audio_message_cancel")
    }

    function I() {
        D(), T(C)
    }

    function D() {
        var e;
        AudioMessagePlayer.loaded && AudioMessagePlayer.resumeGlobalMedia(), removeEvent(C, "finish", D), removeEvent(C, "finish", I), e = URL.createObjectURL(C.buffer), domData(b, "duration", C.duration), domData(b, "ogg", e), domData(b, "mp3", e), geByClass1("audio-msg-track--duration", b).innerHTML = u(C.duration), geByClass1("audio-msg-track--wave-wrapper", b).innerHTML = AudioMessagePlayer.getWave(C.wave, k), removeClass(l, "im-audio-message_recording"), addClass(l, "im-audio-message_recorded")
    }

    function A() {
        var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
        x(), AudioMessagePlayer.loaded && (AudioMessagePlayer.resumeGlobalMedia(), AudioMessagePlayer.detachPlayer()), removeEvent(C, "finish", D), removeEvent(C, "finish", I), P(), B(), e && O()
    }

    function L() {
        C.isRecording ? (addEvent(C, "finish", I), removeEvent(C, "finish", D), P()) : T(C)
    }

    function R() {
        addEvent(C, "finish", D), removeEvent(C, "finish", I), P()
    }

    function B() {
        removeClass(l, "im-audio-message_recorded"), removeClass(l, "im-audio-message_recording"), hide(l), show(geByClass1("_im_chat_input_parent"))
    }

    function N() {
        ge("audiomsg_record"), b = ge("audiomsg_player"), l = geByClass1("im-audio-message-input"), d = geByClass1("audio-msg-track--duration", l), f = geByClass1("audio-msg-track--wave", l), _ = geByClass1("im-audio-message--cancel-btn", l), m = geByClass1("_im_audio_send", l), g = geByClass1("audio-msg-track--btn", l), geByClass1("im-chat-input--text", geByClass1("im-page--chat-input"));
        var e = geByClass1("im-chat-input--textarea", geByClass1("im-page--chat-input"));
        addClass(e, "_voice_field_wrap"), addEvent(p, "click", M), addEvent(_, "click", A), addEvent(m, "click", L), addEvent(g, "click", R)
    }

    function U() {
        ! function() {
            C && removeEvent(C, "progress", S);
            removeEvent(p, "click", M), removeEvent(_, "click", A), removeEvent(m, "click", L), removeEvent(g, "click", R)
        }(), b = l = d = f = p = _ = m = g = null
    }

    function F(e, t, n) {
        return {
            cancelRecording: A,
            start: function() {
                M()
            },
            unmount: function() {
                A(!1), U()
            }
        }
    }

    function H(e, t, n, s, c) {
        return h = t, E = t.get().audio_msg, w = function(e) {
            var t = e.get().peer;
            Object(a.isFullyLoadedTab)(e, t) && !Object(a.isAnyMessageBeingEdited)(e) && Date.now() - (Object(a.getTab)(e, t).lastTyping || 0) > 1e3 * o.ACTIVITY_PERIOD && e.set(o.sendRecordingAudio.bind(null, t))
        }.bind(null, t), y = n, O = c, Object(i.initFailBack)(), Object(a.getAvailableMicrophones)().then(function(e) {
            var n = e.length > 0;
            n ? (N(), s()) : setCookie("remixvoice", "0", 7), t.set(o.setVoiceMessageAvail.bind(null, n))
        }).catch(function(e) {
            throw setCookie("remixvoice", "0", 7), e
        }), (0, Object(r.createMutations)(F).bindMutations)(e, t, n)
    }
}, , , , , , , , function(e, t, n) {
    var r = n(439),
        o = Math.min;
    e.exports = function(e) {
        return e > 0 ? o(r(e), 9007199254740991) : 0
    }
}, function(e, t, n) {
    "use strict";
    var r = n(199)(!0);
    n(350)(String, "String", function(e) {
        this._t = String(e), this._i = 0
    }, function() {
        var e, t = this._t,
            n = this._i;
        return n >= t.length ? {
            value: void 0,
            done: !0
        } : (e = r(t, n), this._i += e.length, {
            value: e,
            done: !1
        })
    })
}, function(e, t, n) {
    var r = n(346),
        o = n(20),
        i = n(227),
        a = Object.defineProperty;
    t.f = n(263) ? Object.defineProperty : function(e, t, n) {
        if (r(e), t = i(t, !0), r(n), o) try {
            return a(e, t, n)
        } catch (e) {}
        if ("get" in n || "set" in n) throw TypeError("Accessors not supported!");
        return "value" in n && (e[t] = n.value), e
    }
}, , function(e, t, n) {
    var r = n(184),
        o = n(346),
        i = n(314);
    e.exports = n(263) ? Object.defineProperties : function(e, t) {
        o(e);
        for (var n, a = i(t), s = a.length, c = 0; s > c;) r.f(e, n = a[c++], t[n]);
        return e
    }
}, function(__webpack_module__, __webpack_exports__, __webpack_require__) {
    "use strict";
    __webpack_require__.r(__webpack_exports__), __webpack_require__.d(__webpack_exports__, "throttleAccumulate", function() {
        return throttleAccumulate
    }), __webpack_require__.d(__webpack_exports__, "executionStackPop", function() {
        return executionStackPop
    }), __webpack_require__.d(__webpack_exports__, "lplog", function() {
        return lplog
    }), __webpack_require__.d(__webpack_exports__, "toArray", function() {
        return toArray
    }), __webpack_require__.d(__webpack_exports__, "arrayUnique", function() {
        return arrayUnique
    }), __webpack_require__.d(__webpack_exports__, "unpackStore", function() {
        return unpackStore
    }), __webpack_require__.d(__webpack_exports__, "debounce", function() {
        return debounce
    }), __webpack_require__.d(__webpack_exports__, "throttle", function() {
        return throttle
    }), __webpack_require__.d(__webpack_exports__, "shuffle", function() {
        return shuffle
    }), __webpack_require__.d(__webpack_exports__, "parallel", function() {
        return parallel
    }), __webpack_require__.d(__webpack_exports__, "hashCode", function() {
        return hashCode
    }), __webpack_require__.d(__webpack_exports__, "parseJSON", function() {
        return parseJSON
    }), __webpack_require__.d(__webpack_exports__, "checkTextLength", function() {
        return checkTextLength
    }), __webpack_require__.d(__webpack_exports__, "getSelectionText", function() {
        return getSelectionText
    }), __webpack_require__.d(__webpack_exports__, "goAway", function() {
        return goAway
    }), __webpack_require__.d(__webpack_exports__, "isFullScreen", function() {
        return isFullScreen
    }), __webpack_require__.d(__webpack_exports__, "updateMoney", function() {
        return updateMoney
    }), __webpack_require__.d(__webpack_exports__, "toggleOnline", function() {
        return toggleOnline
    }), __webpack_require__.d(__webpack_exports__, "onlinePlatformClass", function() {
        return onlinePlatformClass
    }), __webpack_require__.d(__webpack_exports__, "handleScroll", function() {
        return handleScroll
    });
    var _utils_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(269),
        _ui_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(82),
        _debug_tools__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(95),
        _cookies__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(92),
        _ajax__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(193),
        _message_box__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(258),
        _dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(347),
        _lang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(220),
        _browser__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(324),
        _accessibility__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(108),
        _dom_events__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(45),
        _scroll__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(358);

    function throttleAccumulate(e, t) {
        var n = [],
            r = 0;
        return function(o) {
            n.push(o), r || (r = setTimeout(function() {
                r = !1, e(n), n = []
            }, t))
        }
    }

    function executionStackPop(e) {
        return e.length > 0 && e.pop().func(), e
    }

    function lplog(e, t) {
        var n = void 0,
            r = void 0;
        if (window.__debugMode) {
            switch (t) {
                case "error":
                    n = "color: red", r = "background: red; color: white";
                    break;
                case "success":
                    n = "color: green", r = "background: green; color: white";
                    break;
                default:
                    n = "color: blue;", r = "background: #000; color: #fff;"
            }
            try {
                var o = new Date;
                console.debug("%cLP:[" + o.getHours() + ":" + o.getMinutes() + ":" + o.getSeconds() + ":" + o.getMilliseconds() + "]%c " + e, r, n)
            } catch (e) {}
        }
    }

    function toArray(e) {
        var t = [];
        if (void 0 === e.length) return Object.keys(e).map(function(t) {
            return e[t]
        });
        for (var n = 0; n < e.length; n++) t.push(e[n]);
        return t
    }

    function arrayUnique(e) {
        for (var t = {}, n = [], r = 0; r < e.length; r++) t[e[r]] || (n.push(e[r]), t[n[r]] = 1);
        return n
    }

    function unpackStore(e) {
        return e.get ? e.get() : e
    }

    function debounce(e, t, n) {
        var r = void 0;
        return function() {
            var o = this,
                i = arguments,
                a = n && !r;
            clearTimeout(r), r = setTimeout(function() {
                r = null, n || e.apply(o, i)
            }, t), a && e.apply(this, i)
        }
    }

    function throttle(e, t) {
        var n = void 0;
        return function() {
            n || (e.apply(this, arguments), n = setTimeout(function() {
                n = !1
            }, t))
        }
    }

    function shuffle(e) {
        for (var t = e.length; t > 0;) {
            var n = Math.floor(Math.random() * t),
                r = e[--t];
            e[t] = e[n], e[n] = r
        }
        return e
    }

    function parallel() {
        var e = [].slice.call(arguments),
            t = e.pop(),
            n = new CallHub(t, e.length);
        Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(e, function(e, t) {
            return t(function() {
                return n.done()
            })
        })
    }

    function hashCode(e) {
        var t = 0;
        if (0 === e.length) return t;
        for (var n = 0, r = e.length; n < r; n++) {
            t = (t << 5) - t + e.charCodeAt(n), t |= 0
        }
        return t
    }

    function parseJSON(obj) {
        if (window.JSON && JSON.parse) try {
            return JSON.parse(obj)
        } catch (e) {
            Object(_ui_util__WEBPACK_IMPORTED_MODULE_1__.topError)("<b>parseJSON:</b> " + e.message, {
                dt: -1,
                type: 5,
                answer: obj
            });
            var evalString = "(" + obj + ")";
            try {
                return eval(evalString)
            } catch (e) {
                if (__debugMode) throw e;
                Object(_debug_tools__WEBPACK_IMPORTED_MODULE_2__.logEvalError)(e, evalString)
            }
        } else {
            var _evalString = "(" + obj + ")";
            try {
                return eval(_evalString)
            } catch (e) {
                if (__debugMode) throw e;
                Object(_debug_tools__WEBPACK_IMPORTED_MODULE_2__.logEvalError)(e, _evalString)
            }
        }
    }

    function checkTextLength(e, t, n, r, o, i, a) {
        var s = t.getValue ? t.getValue() : t.value,
            c = t.lastLen || 0;
        if (t.lastLen !== s.length || i) {
            t.lastLen = s.length;
            var u = {
                    "&": 5,
                    "<": 4,
                    ">": 4,
                    '"': 6,
                    "\n": r ? 1 : 4,
                    "\r": 0,
                    "!": 5,
                    "'": 5,
                    $: 6,
                    "\\": 6
                },
                l = {
                    1168: 1,
                    1169: 1,
                    8211: 1,
                    8212: 1,
                    8216: 1,
                    8217: 1,
                    8218: 1,
                    8230: 1,
                    8240: 1,
                    8249: 1,
                    8250: 1,
                    8364: 1,
                    8470: 1,
                    8482: 1,
                    65533: 1
                },
                d = {
                    1037: 1,
                    1104: 1,
                    1117: 1
                };
            o && (u[","] = 5);
            var f = function(e) {
                for (var t = 0, n = 0, r = e.length; n < r; n++) {
                    var o = u[e.charAt(n)],
                        i = e.charCodeAt(n);
                    t += void 0 !== o ? o : !a && i >= 128 && (i < 1025 || d[i] || i > 1119) && !l[i] && (i < 8220 || i > 8222) && (i < 8224 || i > 8226) ? ("&#" + i + ";").length : 1
                }
                return t
            }(s);
            if (n = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.ge)(n), f > Math.max(e - 100, .75 * e))
                if (Object(_dom__WEBPACK_IMPORTED_MODULE_6__.show)(n), f > e)
                    if (o) {
                        var p = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.val)(t, function(e, t) {
                            for (var n = 0, r = "", o = 0, i = e.length; o < i; o++) {
                                var s = e.charAt(o),
                                    c = u[s],
                                    f = e.charCodeAt(o);
                                if ((n += void 0 !== c ? c : !a && f >= 128 && (f < 1025 || d[f] || f > 1119) && !l[f] && (f < 8220 || f > 8222) && (f < 8224 || f > 8226) ? ("&#" + f + ";").length : 1) > t) break;
                                r += s
                            }
                            return r
                        }(s, Math.min(e, c)));
                        t.lastLen = p.length, n.innerHTML = Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("text_N_symbols_remain", 0)
                    } else n.innerHTML = Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("text_exceeds_symbol_limit", f - e);
            else n.innerHTML = Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("text_N_symbols_remain", e - f);
            else Object(_dom__WEBPACK_IMPORTED_MODULE_6__.hide)(n)
        }
    }

    function getSelectionText() {
        var e = "";
        return window.getSelection ? e = window.getSelection().toString() : document.selection && "Control" !== document.selection.type && (e = document.selection.createRange().text), e
    }

    function goAway(e, t, n) {
        if (-1 !== (t || {}).h || Object(_dom_events__WEBPACK_IMPORTED_MODULE_10__.checkEvent)(n)) return !0;
        if (-1 !== (t || {}).h) {
            var r = e.match(/https?:\/\/([a-zA-Z0-9\-_\.]+\.)?(vk\.com|vkontakte\.ru)(\/|$)/i);
            if (r && "api." !== r[1].toLowerCase()) return location.href = e, !1;
            var o = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(Object(_cookies__WEBPACK_IMPORTED_MODULE_3__.getCookie)("remixsettings_bits"));
            if (/https?:\/\/([a-zA-Z0-9\-_]+\.)(vk\.com|vkontakte\.ru)(\/|$)/i.test(_ajax__WEBPACK_IMPORTED_MODULE_4__.locBase) || 1 & o) return window.open("/away.php?to=" + encodeURIComponent(e) + (t && void 0 !== t.h ? "&h=" + t.h : ""), "_blank"), !1
        }
        var i = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)({
            act: "a_go",
            to: e
        }, t || {});
        return !Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showBox)("away.php", i, {}, n)
    }

    function isFullScreen() {
        return !!(document.fullscreenElement || document.fullScreenElement || document.msFullscreenElement || document.mozFullScreen || document.webkitIsFullScreen || cur.pvPartScreen)
    }

    function updateMoney(e, t) {
        if (void 0 !== e && !1 !== e) {
            var n = "";
            !0 === t ? (vk.balanceEx = e, n = "_ex") : vk.balance = e;
            var r = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.geByClass)("votes_balance_nom" + n);
            Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(r, function(t, n) {
                return n.innerHTML = e + " " + Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("votes_flex", e)
            });
            var o = e * (vk.vcost || 7),
                i = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.geByClass)("money_balance_nom" + n);
            Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(i, function(e, t) {
                return t.innerHTML = Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_money_amount_rub", o, !0)
            }), void 0 !== t && !1 !== t && !0 !== t && updateMoney(t, !0)
        }
    }

    function toggleOnline(e, t) {
        var n = onlinePlatformClass(t).split(" "),
            r = [];
        ["online", "mobile", "_online"].forEach(function(t) {
            Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.inArray)(t, n) && !Object(_dom__WEBPACK_IMPORTED_MODULE_6__.hasClass)(e, t) ? r.push(t) : !Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.inArray)(t, n) && Object(_dom__WEBPACK_IMPORTED_MODULE_6__.hasClass)(e, t) && Object(_dom__WEBPACK_IMPORTED_MODULE_6__.removeClass)(e, t)
        }), r.length > 0 && Object(_dom__WEBPACK_IMPORTED_MODULE_6__.addClass)(e, r.join(" "))
    }

    function onlinePlatformClass(e) {
        var t = " _online";
        return e && (t += " online"), _browser__WEBPACK_IMPORTED_MODULE_8__.mobPlatforms[e] && (t += " mobile"), Object(_accessibility__WEBPACK_IMPORTED_MODULE_9__.updateOnlineText)(), t
    }

    function handleScroll(e) {
        e = e.split(",");
        var t = cur.named || {},
            n = e[0] && (t[e[0]] || Object(_dom__WEBPACK_IMPORTED_MODULE_6__.ge)(e[0])) || !1,
            r = e[1] && (t[e[1]] || Object(_dom__WEBPACK_IMPORTED_MODULE_6__.ge)(e[1])) || !1;
        if (!n && !r) {
            if (!(n = document.getElementsByName(e[0])[0])) return;
            n = n.nextSibling
        }
        var o = Object(_dom__WEBPACK_IMPORTED_MODULE_6__.ge)("page_header_wrap") || Object(_dom__WEBPACK_IMPORTED_MODULE_6__.ge)("dev_top_nav_wrap");
        setTimeout(function() {
            n && Object(_scroll__WEBPACK_IMPORTED_MODULE_11__.scrollToY)(Object(_dom__WEBPACK_IMPORTED_MODULE_6__.getXY)(n)[1] - (o ? Object(_dom__WEBPACK_IMPORTED_MODULE_6__.getSize)(o)[1] : 0), 0), r && Object(_dom__WEBPACK_IMPORTED_MODULE_6__.elfocus)(r)
        }, 300)
    }
}, function(e, t, n) {
    var r = n(439),
        o = Math.max,
        i = Math.min;
    e.exports = function(e, t) {
        return (e = r(e)) < 0 ? o(e + t, 0) : i(e, t)
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "connect", function() {
        return u
    });
    var r = n(451),
        o = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function i(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var a = r.createContext(),
        s = a.Provider,
        c = a.Consumer;

    function u(e) {
        return function(t) {
            function n() {
                var e, r;
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, n);
                for (var o = arguments.length, a = Array(o), s = 0; s < o; s++) a[s] = arguments[s];
                return e = r = i(this, t.call.apply(t, [this].concat(a))), r.onUpdate = function() {
                    r.setState({})
                }, i(r, e)
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(n, t), n.prototype.componentDidMount = function() {
                this.store.subscribe(this.onUpdate)
            }, n.prototype.componentWillUnmount = function() {
                this.store.unsubscribe(this.onUpdate)
            }, n.prototype.render = function() {
                var t = this;
                return r.createElement(c, null, function(n) {
                    return t.store || (t.store = n), r.createElement(e, o({}, t.props, {
                        store: n
                    }))
                })
            }, n
        }(r.Component)
    }
    t.default = s
}, , function(e, t, n) {
    "use strict";
    var r;

    function o(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    n.r(t), n.d(t, "OUR_DOMAINS", function() {
        return i
    }), n.d(t, "ENTITIES", function() {
        return a
    }), n.d(t, "VK_DOMAIN", function() {
        return s
    }), n.d(t, "MENTION", function() {
        return c
    }), n.d(t, "MENTION_RAW", function() {
        return u
    }), n.d(t, "ARROW_UP", function() {
        return l
    }), n.d(t, "ARROW_DOWN", function() {
        return d
    }), n.d(t, "PAGE_UP", function() {
        return f
    }), n.d(t, "PAGE_DOWN", function() {
        return p
    }), n.d(t, "END_KEY", function() {
        return _
    }), n.d(t, "HOME", function() {
        return m
    }), n.d(t, "ENTER", function() {
        return g
    }), n.d(t, "ESC", function() {
        return h
    }), n.d(t, "UNPRINTABLE_KEYS", function() {
        return b
    }), n.d(t, "UP_DOWN_CONTROLS", function() {
        return v
    }), n.d(t, "PRINTABLE", function() {
        return y
    }), n.d(t, "FOLDER_UNREAD", function() {
        return O
    }), n.d(t, "FOLDER_ALL", function() {
        return w
    }), n.d(t, "FOLDER_UNRESPOND", function() {
        return E
    }), n.d(t, "FOLDER_IMPORTANT", function() {
        return C
    }), n.d(t, "FOLDER_MESSAGE_REQUEST", function() {
        return j
    }), n.d(t, "FOLDER_MESSAGE_REQUEST_REJECTED", function() {
        return k
    }), n.d(t, "FOLDERS", function() {
        return T
    }), n.d(t, "FOLDER_MASKS", function() {
        return S
    }), n.d(t, "TOP_DOMAINS", function() {
        return M
    }), n.d(t, "MAX_DOMAIN_LENGTH", function() {
        return P
    }), n.d(t, "EMAIL", function() {
        return x
    }), n.d(t, "MESSAGE_REGEXP", function() {
        return I
    }), n.d(t, "RE_HASHTAG_EXTRACTION_PATTERN", function() {
        return D
    });
    var i = /^([a-zA-Z0-9\.\_\-]+\.)?(vkontakte\.ru|vk\.com|vkadre\.ru|vshtate\.ru|userapi\.com|vk\.me)$/,
        a = /([^a-zA-Z0-9#%;_\-.\/?&=\[\]])/g,
        s = /^(?:https?:\/\/)?(?:vk\.com|vkontakte\.ru)?\/([a-zA-Z0-9\._]+)\??$/,
        c = /\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,
        u = /(^|[\s.,:\'\";>\)\(])(\*|@)([A-Za-z0-9_\.]{2,32})\s*\((.+?)\)/g,
        l = 38,
        d = 40,
        f = 33,
        p = 34,
        _ = 35,
        m = 36,
        g = 13,
        h = 27,
        b = [l, d, f, p, g, h, _, m],
        v = [f, p, d, l, m, _],
        y = "printable",
        O = "unread",
        w = "all",
        E = "unrespond",
        C = "important",
        j = "mr",
        k = "mr_rejected",
        T = [w, O, E, C, j],
        S = (o(r = {}, E, 2), o(r, C, 1), o(r, j, 256), o(r, k, 512), r),
        M = [].concat("aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","), "бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","), "qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map(function(e) {
            return "xn--" + e
        })),
        P = M.reduce(function(e, t) {
            return Math.max(e, t.length)
        }, 0),
        x = new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})))", "ig"),
        I = new RegExp("(https?:\\/\\/)?(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})(?:\\:(\\d{2,5}))?)(([\\/?#])(?:\\&amp;|\\&#\\d{2,6};|,[_%]|!|,*[\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$.~=;:'ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ　-〿＀-￯*]+|(?:\\(|\\[)[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\d&#%;,]+(?:\\)|\\])){0,200})?", "ig"),
        D = "(^|[s.,:'\";>)(]?)((#(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)){0,100}(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?))(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)){0,100}))(@((?:[a-z0-9_]*[a-z0-9])?(?:(?:.[a-z](?:[a-z0-9_]+[a-z0-9])?)*.[a-z][a-z0-9_]{2,40}[a-z0-9])?))?(?=$|[s.,:'\"&;?<)(]?)"
}, function(__webpack_module__, __webpack_exports__, __webpack_require__) {
    "use strict";
    __webpack_require__.r(__webpack_exports__), __webpack_require__.d(__webpack_exports__, "locBase", function() {
        return locBase
    }), __webpack_require__.d(__webpack_exports__, "ajx2q", function() {
        return ajx2q
    }), __webpack_require__.d(__webpack_exports__, "q2ajx", function() {
        return q2ajx
    }), __webpack_require__.d(__webpack_exports__, "requestBox", function() {
        return requestBox
    }), __webpack_require__.d(__webpack_exports__, "activateMobileBox", function() {
        return activateMobileBox
    }), __webpack_require__.d(__webpack_exports__, "validateMobileBox", function() {
        return validateMobileBox
    }), __webpack_require__.d(__webpack_exports__, "validatePassBox", function() {
        return validatePassBox
    }), __webpack_require__.d(__webpack_exports__, "photoCaptchaBox", function() {
        return photoCaptchaBox
    }), __webpack_require__.d(__webpack_exports__, "initAjax", function() {
        return initAjax
    });
    var _utils_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(269),
        _debug_tools__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(95),
        _browser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(324),
        _dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(347),
        _dom_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(45),
        _message_box__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(258),
        _utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(187),
        _ui_util__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(82),
        _box_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(471),
        _lang__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(220),
        locBase = location.toString().replace(/#.+$/, ""),
        decodeErors = {},
        iframeTransport = void 0,
        iframeTO = 0;

    function ajx2q(e, t) {
        var n = [],
            r = function(e) {
                if (decodeErors[e]) return e;
                try {
                    return encodeURIComponent(e)
                } catch (e) {
                    return ""
                }
            };
        for (var o in e)
            if (null != e[o] && !Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.isFunction)(e[o]))
                if (Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.isArray)(e[o]))
                    for (var i = 0, a = 0, s = e[o].length; i < s; ++i) null == e[o][i] || Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.isFunction)(e[o][i]) || (n.push(r(o) + "[" + a + "]=" + r(e[o][i])), ++a);
                else n.push(r(o) + "=" + r(e[o]));
        return t || n.sort(), n.join("&")
    }

    function q2ajx(e) {
        if (!e) return {};
        var t = {},
            n = function(e) {
                try {
                    return decodeURIComponent(e)
                } catch (t) {
                    return decodeErors[e] = 1, e
                }
            };
        return e = e.split("&"), Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(e, function(e, r) {
            var o = r.split("=");
            if (o[0]) {
                var i = n(o[1] + "");
                if ("[]" === o[0].substr(o.length - 2)) {
                    var a = n(o[0].substr(0, o.length - 2));
                    t[a] || (t[a] = []), t[a].push(i)
                } else t[n(o[0])] = i
            }
        }), t
    }

    function requestBox(e, t, n) {
        return e.setOptions({
            onDestroy: n
        }), e.onDone = function() {
            t && t.apply(null, arguments)
        }, e
    }

    function activateMobileBox(e) {
        return requestBox(Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showBox)("activation.php", {
            act: "activate_mobile_box",
            hash: e.hash
        }), function() {
            vk.nophone = 0, e.onDone()
        }, e.onFail)
    }

    function validateMobileBox(e) {
        return requestBox(Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showBox)("activation.php", {
            act: "validate_box",
            captcha: e.acceptCaptcha ? 1 : "",
            skip_push: e.skip_push ? e.skip_push : "",
            from: e.from || "",
            hash: e.hash,
            ahash: e.ahash
        }, {
            stat: ["uncommon.css"]
        }), e.onDone, e.onFail)
    }

    function validatePassBox(e) {
        return requestBox(Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showBox)("activation.php", {
            act: "pass_validate_box",
            hash: e.hash
        }, {
            stat: ["uncommon.css"]
        }), e.onDone, e.onFail)
    }

    function photoCaptchaBox(e) {
        return requestBox(Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showBox)("pcaptcha.php", {
            act: "box"
        }, {
            stat: ["pcaptcha.css", "pcaptcha.js"]
        }), e.onDone, e.onFail)
    }
    var ajax = {
        _init: function() {
            try {
                if (new XMLHttpRequest) return void(ajax._req = function() {
                    return new XMLHttpRequest
                })
            } catch (e) {}
            ajax._req || _browser__WEBPACK_IMPORTED_MODULE_2__.browser.search_bot || location.replace("/badbrowser.php")
        },
        _getreq: function() {
            return ajax._req || ajax._init(), ajax._req()
        },
        _frameover: function(e, t) {
            if (iframeTransport) {
                var n = iframeTransport.parentNode;
                n.innerHTML = "", utilsNode.removeChild(n), iframeTransport = !1, (e || t) && ajax.framegot(!1, !1, e, t), ajax.framegot(!1), cur.onFrameBlocksDone && cur.onFrameBlocksDone(), ajax.tOver = (new Date).getTime()
            }
        },
        _receive: function _receive(cont, html, js, bench, params) {
            var container = cont && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.ge)(cont);
            if (container && html && (container.firstChild ? container.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_3__.cf)(html)) : Object(_dom__WEBPACK_IMPORTED_MODULE_3__.val)(container, html)), js) {
                var scr = "(function(){" + js + ";})()";
                if (__debugMode) eval(scr);
                else try {
                    eval(scr)
                } catch (e) {
                    Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.topError)(e, {
                        dt: 15,
                        type: 8,
                        url: ajax._frameurl,
                        js: js,
                        answer: Array.prototype.slice.call(arguments).join("<!>")
                    }), Object(_debug_tools__WEBPACK_IMPORTED_MODULE_1__.logEvalError)(e, scr)
                }
                bench && (ajax.tModule = cur.module)
            }
            params && "leftads" in params && window.__adsSet && __adsSet(params.leftads, params.ads_section || "", params.ads_can_show, params.ads_showed), ajax._framenext()
        },
        framedata: !1,
        _framenext: function() {
            if ((ajax.framedata || {}).length) {
                var e = ajax.framedata.shift();
                !0 === e ? ajax._framenext() : !1 === e ? (ajax.framedata = !1, cur.onFrameBlocksDone && cur.onFrameBlocksDone()) : iframeTO = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.lTimeout)(ajax._receive.pbind(e[0], e[1], e[2], !0, e[3]), 0)
            }
        },
        framegot: function(e, t, n, r) {
            ajax.framedata && (ajax.framedata.push(void 0 === t && void 0 === n && void 0 === r ? e : [e, t, n, r]), 1 == ajax.framedata.length && ajax._framenext())
        },
        framepost: function(e, t, n, r) {
            clearTimeout(iframeTO), iframeTransport && ajax._frameover(), iframeTransport = utilsNode.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("div", {
                innerHTML: "<iframe></iframe>"
            })).firstChild, ajax._framedone = n, ajax.framedata = [!0], e += "?" + ("string" != typeof t ? ajx2q(t, r && r.noSort) : t), e += ("?" != e.charAt(e.length - 1) ? "&" : "") + "_rndVer=" + Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.irand)(0, 99999), ajax._frameurl = iframeTransport.src = e
        },
        plainpost: function(e, t, n, r, o, i, a, s) {
            var c = ajax._getreq(),
                u = "string" != typeof t ? ajx2q(t, a && a.noSort) : t;
            c.onreadystatechange = function() {
                4 === c.readyState && (c.status >= 200 && c.status < 300 ? n && n(c.responseText, c) : r && r(c.responseText, c))
            };
            try {
                c.open("POST", e, !0)
            } catch (e) {
                return !1
            }
            return i && Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(i, function(e, t) {
                c[e] = t
            }), o || (c.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), s || c.setRequestHeader("X-Requested-With", "XMLHttpRequest")), c.send(u), c
        },
        post: function(e, t, n) {
            "/" !== e.substr(0, 1) && "http" !== e.substr(0, 4) && (e = "/" + e);
            var r = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)({
                    _captcha: !1,
                    _box: !1
                }, n || {}),
                o = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)({
                    al: r.frame ? -1 : 1
                }, t),
                i = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.vkNow)(),
                a = vk.spentLastSendTS ? Math.round((i - vk.spentLastSendTS) / 1e3) : 0;
            if (vk.sampleUser >= 0 && window.cur && cur.module && a >= 1 && (window.curNotifier && curNotifier.idle_manager && !curNotifier.idle_manager.is_idle && (o._smt = cur.module + ":" + a), vk.spentLastSendTS = i), r.progress && (r.showProgress || (r.showProgress = function() {
                    var e = Object(_dom__WEBPACK_IMPORTED_MODULE_3__.ge)(r.progress);
                    Object(_dom__WEBPACK_IMPORTED_MODULE_3__.hasClass)(e, "pr") && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.setStyle)(e, "opacity", 1), Object(_dom__WEBPACK_IMPORTED_MODULE_3__.show)(e)
                }), r.hideProgress || (r.hideProgress = function() {
                    var e = Object(_dom__WEBPACK_IMPORTED_MODULE_3__.ge)(r.progress);
                    Object(_dom__WEBPACK_IMPORTED_MODULE_3__.hasClass)(e, "pr") && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.setStyle)(e, "opacity", 0), Object(_dom__WEBPACK_IMPORTED_MODULE_3__.hide)(e)
                })), r.loader) {
                var s = Object(_dom__WEBPACK_IMPORTED_MODULE_3__.isVisible)(boxLayerWrap);
                r.showProgress = function() {
                    boxRefreshCoords(boxLoader), Object(_dom__WEBPACK_IMPORTED_MODULE_3__.show)(boxLoader), s || Object(_dom__WEBPACK_IMPORTED_MODULE_3__.show)(boxLayerWrap)
                }, r.hideProgress = function() {
                    Object(_dom__WEBPACK_IMPORTED_MODULE_3__.hide)(boxLoader), s || Object(_dom__WEBPACK_IMPORTED_MODULE_3__.hide)(boxLayerWrap)
                }
            }
            return ajax._post(e, o, r)
        },
        preload: function(e, t, n) {
            "/" !== e.substr(0, 1) && (e = "/" + e), ajaxCache[e + "#" + ajx2q(t)] = n
        },
        invalidate: function(e, t) {
            void 0 === e ? ajaxCache = {} : delete ajaxCache[ajax._getCacheKey(e, t)]
        },
        _getCacheKey: function(e, t, n) {
            var r = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.clone)(t);
            return delete r.al, delete r.al_ad, delete r.ads_section, delete r.ads_showed, delete r.captcha_sid, delete r.captcha_key, delete r._smt, delete r._preload, e + "#" + ajx2q(r, n && n.noSort)
        },
        _debugLog: function(e, t) {
            window.debuglogGot && window.debuglogGot(t, e)
        },
        _parseRes: function(e, t) {
            for (var n = e.length - 1; n >= 0; --n) {
                var r = e[n];
                if ("<!" === r.substr(0, 2)) {
                    var o = r.indexOf(">"),
                        i = r.substr(2, o - 2);
                    switch (r = r.substr(o + 1), i) {
                        case "json":
                            e[n] = Object(_utils__WEBPACK_IMPORTED_MODULE_6__.parseJSON)(r);
                            break;
                        case "int":
                            e[n] = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(r);
                            break;
                        case "float":
                            e[n] = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.floatval)(r);
                            break;
                        case "bool":
                            e[n] = !!Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(r);
                            break;
                        case "null":
                            e[n] = null;
                            break;
                        case "pageview_candidate":
                            e.pop();
                            break;
                        case "debug":
                            ajax._debugLog(r, t), e.pop()
                    }
                }
            }
        },
        _post: function _post(url, query, options) {
            !query.captcha_sid && options.showProgress && options.showProgress();
            var cacheKey = !1,
                statAct = void 0;
            window.__adsGetAjaxParams && Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(query, __adsGetAjaxParams(query, options)), options.cache && (cacheKey = ajax._getCacheKey(url, query, options));
            var hideBoxes = function() {
                    for (var e = 0, t = arguments.length; e < t; ++e) {
                        var n = arguments[e];
                        n && n.isVisible() && (n.setOptions({
                            onHide: !1,
                            onDestroy: !1
                        }), n.hide())
                    }
                    return !1
                },
                fail = function(e, t) {
                    if (options.hideProgress && options.hideProgress(), options._suggest && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.cleanElems)(options._suggest), options._box = hideBoxes(options._captcha, options._box), options._captcha = options._box, options._suggest = options._captcha, -1 !== e.indexOf("The page is temporarily unavailable") && __dev && Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.inArray)(vk.id, [100])) return ajax._post(url, query, options), !1;
                    options.onFail && !0 === options.onFail(e) || Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.topError)(e, {
                        dt: 5,
                        type: 3,
                        status: t.status,
                        url: url,
                        query: query && ajx2q(query, options.noSort)
                    })
                };
            options.local && (fail = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.vkLocal)(fail)), options.stat && (statAct = !1, stManager.add(options.stat, function() {
                statAct && statAct(), options.stat = !1
            }));
            var _processResponse = function processResponse(code, answer) {
                if (options.cache) {
                    var answ = ajaxCache[cacheKey];
                    answ && answ._loading && (setTimeout(function() {
                        for (var e in answ._callbacks) answ._callbacks.hasOwnProperty(e) && answ._callbacks[e](code, answer)
                    }, 0), delete ajaxCache[cacheKey])
                }
                if (options.stat) return options.stat = !1, statAct = _processResponse.pbind(code, answer), !1;
                switch (options.cache && !options.forceGlobalCache && (code || (ajaxCache[cacheKey] = answer)), options.hideProgress && options.hideProgress(), 2 !== code && (options._captcha && (options._suggest && Object(_dom__WEBPACK_IMPORTED_MODULE_3__.cleanElems)(options._suggest), options._captcha = hideBoxes(options._captcha), options._suggest = options._captcha), options._box = hideBoxes(options._box)), code) {
                    case 1:
                        Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showFastBox)({
                            width: 520,
                            title: answer[0],
                            onDestroy: options.onFail
                        }, answer[1]);
                        break;
                    case 2:
                        var addText = "";
                        if (2 === Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(answer[1])) {
                            var resend = function(e) {
                                var t = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(query, {
                                        recaptcha: e
                                    }),
                                    n = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(options, {
                                        cache: -1
                                    }) : options;
                                ajax._post(url, t, n)
                            };
                            options._captcha = Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showReCaptchaBox)(answer[0], answer[2], options._captcha, {
                                onSubmit: resend,
                                addText: addText,
                                onDestroy: function() {
                                    options.onFail && options.onFail()
                                }
                            })
                        } else {
                            var _resend = function(e, t) {
                                var n = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(query, {
                                        captcha_sid: e,
                                        captcha_key: t
                                    }),
                                    r = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(options, {
                                        cache: -1
                                    }) : options;
                                ajax._post(url, n, r)
                            };
                            options._captcha = Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showCaptchaBox)(answer[0], Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(answer[1]), options._captcha, {
                                onSubmit: _resend,
                                addText: addText,
                                onDestroy: function() {
                                    options.onFail && options.onFail()
                                }
                            })
                        }
                        options._suggest = Object(_dom__WEBPACK_IMPORTED_MODULE_3__.geByClass1)("phone_validation_link", options._captcha.bodyNode), options._suggest && Object(_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(options._suggest, "click", function() {
                            options._box = validateMobileBox({
                                onDone: options._captcha.submit
                            })
                        });
                        break;
                    case 11:
                    case 12:
                        var newOptions = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(options, {
                            cache: -1
                        }) : options;
                        options._box = validateMobileBox({
                            acceptCaptcha: 11 === code,
                            onDone: function(e, t) {
                                vk.nophone = 0, e && (options._captcha = Object(_box_utils__WEBPACK_IMPORTED_MODULE_8__.curBox)());
                                var n = e ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(query, {
                                    captcha_sid: e,
                                    captcha_key: t
                                }) : query;
                                ajax._post(url, n, newOptions)
                            },
                            onFail: options.onFail,
                            hash: answer[0],
                            ahash: answer[1]
                        });
                        break;
                    case 14:
                        var _newOptions = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(options, {
                            cache: -1
                        }) : options;
                        options._box = photoCaptchaBox({
                            onDone: ajax._post.pbind(url, query, _newOptions),
                            onFail: options.onFail
                        });
                        break;
                    case 15:
                        var _newOptions2 = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(options, {
                            cache: -1
                        }) : options;
                        options._box = validatePassBox({
                            onDone: ajax._post.pbind(url, query, _newOptions2),
                            onFail: options.onFail,
                            hash: answer[0]
                        });
                        break;
                    case 3:
                        var _newOptions3 = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(options, {
                            cache: -1
                        }) : options;
                        window.onReLoginDone = ajax._post.pbind(url, query, _newOptions3), window.onReLoginFailed = function(e, t) {
                            t ? nav.go(t) : -1 === e ? location.href = location.href.replace(/^http:/, "https:") : e ? nav.go("/") : window.onReLoginDone()
                        }, utilsNode.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("iframe", {
                            src: vk.loginscheme + "://login.vk.com/?" + ajx2q({
                                role: "al_frame",
                                _origin: locProtocol + "//" + locHost,
                                ip_h: answer[0] || vk.ip_h,
                                to: answer[1] || ""
                            })
                        }));
                        break;
                    case 4:
                        Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(answer[1]) ? nav.go(answer[0], !1, {
                            nocur: "2" === answer[1],
                            noback: !0 === answer[1],
                            showProgress: options.showProgress,
                            hideProgress: options.hideProgress
                        }) : (hab.stop(), location.href = answer[0]);
                        break;
                    case 5:
                        nav.reload({
                            force: Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(answer[0]),
                            from: 1,
                            url: url,
                            query: query && ajx2q(query)
                        });
                        break;
                    case 6:
                        var _newOptions4 = options.cache ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(options, {
                            cache: -1
                        }) : options;
                        options._box = activateMobileBox({
                            onDone: ajax._post.pbind(url, query, _newOptions4),
                            onFail: options.onFail,
                            hash: answer[0]
                        });
                        break;
                    case 7:
                        options.onFail && options.onFail(), Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.topMsg)(answer[0], 10);
                        break;
                    case 8:
                        if (options.onFail && options.onFail(answer[0])) return;
                        Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.topError)(answer[0] + (answer[2] ? " #" + answer[2] : ""), {
                            dt: answer[1] ? 0 : 10,
                            type: 4,
                            url: url,
                            query: query && ajx2q(query)
                        });
                        break;
                    case 9:
                        if ((options.fromBox || options.forceDone) && (options.onDone && options.onDone.apply(window, answer), options.fromBox)) break;
                        options._box = Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showFastBox)({
                            title: Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.trim)(answer[0])
                        }, answer[1]);
                        var _newOptions5 = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.clone)(options), {
                            showProgress: options._box.showProgress,
                            hideProgress: options._box.hideProgress
                        });
                        options.cache && (_newOptions5.cache = -1), options._box = requestBox(options._box, function(e) {
                            Object(_dom__WEBPACK_IMPORTED_MODULE_3__.isVisible)(options._box.progress) || (e || (e = {
                                _votes_ok: 1
                            }), ajax._post(url, Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(query, e), _newOptions5))
                        }, options.onFail), options._box.evalBox(answer[2]);
                        break;
                    case 10:
                        options._box = Object(_message_box__WEBPACK_IMPORTED_MODULE_5__.showFastBox)({
                            title: answer[0] || Object(_lang__WEBPACK_IMPORTED_MODULE_9__.getLang)("global_charged_zone_title"),
                            onHide: options.onFail
                        }, answer[1], Object(_lang__WEBPACK_IMPORTED_MODULE_9__.getLang)("global_charged_zone_continue"), function() {
                            var e = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(query, {
                                charged_confirm: answer[3]
                            });
                            ajax._post(url, e, options)
                        }, Object(_lang__WEBPACK_IMPORTED_MODULE_9__.getLang)("global_cancel"));
                        break;
                    case 13:
                        var evalString = "(function(){" + answer[0] + ";})()";
                        if (__debugMode) eval(evalString);
                        else try {
                            eval(evalString)
                        } catch (e) {
                            Object(_debug_tools__WEBPACK_IMPORTED_MODULE_1__.logEvalError)(e, evalString)
                        }
                        break;
                    default:
                        if (-1 === code || -2 === code || -3 === code) {
                            var adsShowed = answer.pop(),
                                adsCanShow = answer.pop(),
                                adsHtml = answer.pop(),
                                adsProps = void 0; - 3 === code && (adsProps = answer.pop()), window.__adsSet && __adsSet(adsHtml, null, adsCanShow, adsShowed, null, adsProps)
                        }
                        options.onDone && options.onDone.apply(window, answer)
                }
                window.LazyLoad && LazyLoad.scanDelayed()
            };
            options.local && (_processResponse = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.vkLocal)(_processResponse));
            var done = function(e, t) {
                options.bench && (ajax.tDone = (new Date).getTime()), e = e.replace(/^<!--/, "").replace(/-<>-(!?)>/g, "--$1>"), Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.trim)(e).length || (t = [8, Object(_lang__WEBPACK_IMPORTED_MODULE_9__.getLang)("global_unknown_error")], e = stVersions.nav + "<!><!>" + vk.lang + "<!>" + stVersions.lang + "<!>8<!>" + t[1]);
                var n = e.split("<!>"),
                    r = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.clone)(n);
                Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(r, function(e, t) {
                    return r[e] = t.substr(0, 100)
                }), ajax.lastResp = r.join("<!>");
                var o = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(n.shift());
                if (!o) return fail("<pre>" + e + "</pre>", {
                    status: -1
                });
                if (vk.version && vk.version !== o) o && n.length > 4 ? nav.reload({
                    force: !0,
                    from: 2,
                    url: url,
                    query: query && ajx2q(query)
                }) : nav.strLoc ? location.replace(locBase) : Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.topError)("Server error.", {
                    type: 100
                });
                else {
                    vk.version = !1;
                    var i = n.shift(),
                        a = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(n.shift()),
                        s = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(n.shift());
                    options.frame && (n = t);
                    var c = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(n.shift());
                    if (vk.lang !== a && options.canReload) nav.reload({
                        force: !0,
                        from: 3,
                        url: url,
                        query: query && ajx2q(query)
                    });
                    else {
                        var u = function() {
                            var e = ["common.css"];
                            if (i)
                                for (var t = 0, r = (i = i.split(",")).length; t < r; ++t) e.push(i[t]);
                            if (stVersions.lang < s)
                                for (var o in stVersions.lang = s, StaticFiles) /^lang\d/i.test(o) && e.push(o);
                            if (!options.frame) try {
                                ajax._parseRes(n, options._reqid)
                            } catch (e) {
                                Object(_ui_util__WEBPACK_IMPORTED_MODULE_7__.topError)("<b>JSON Error:</b> " + e.message, {
                                    type: 5,
                                    answer: n.join("<!>"),
                                    url: url,
                                    query: query && ajx2q(query)
                                })
                            }
                            stManager.add(e, _processResponse.pbind(c, n))
                        };
                        if (window.stVersions) {
                            if (o === stVersions.nav) return u();
                            headNode.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("script", {
                                type: "text/javascript",
                                src: "/js/loader_nav" + o + "_" + vk.lang + ".js"
                            })), setTimeout(function e() {
                                if (o === stVersions.nav) return u();
                                setTimeout(e, 100)
                            }, 0)
                        }
                    }
                }
            };
            if (options.local && (done = Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.vkLocal)(done)), options.cache > 0 || options.forceGlobalCache) {
                var answer = ajaxCache[cacheKey];
                if (answer && answer._loading) return void answer._callbacks.push(_processResponse);
                if (answer && !options.forceGlobalCache) return _processResponse(0, answer), void(3 === options.cache && delete ajaxCache[cacheKey]);
                if (answer = window.globalAjaxCache[cacheKey]) return -1 == answer || Object(_utils_common__WEBPACK_IMPORTED_MODULE_0__.isFunction)(answer) ? window.globalAjaxCache[cacheKey] = options.onDone : options.onDone.apply(window, answer), void(options.hideProgress && options.hideProgress())
            }
            ajaxCache[cacheKey] = {
                _loading: 1,
                _callbacks: []
            }, window.debuglogSent ? (options._reqid = debuglogSent(url + (query ? ": " + ajx2q(query, options.noSort).replace(/&/g, "&amp;") : "")), options.frame && (window._lfrid = options._reqid)) : options._reqid = 0;
            var xhrOptions = {};
            return options.timeout && (xhrOptions.timeout = options.timeout), options.frame ? ajax.framepost(url, query, done, options) : ajax.plainpost(url, query, done, fail, !1, xhrOptions, options)
        },
        tGetParam: function() {
            if (ajax.tStart && ajax.tModule) {
                var e = [ajax.tDone - ajax.tStart, ajax.tProcess - ajax.tDone, ajax.tRender - ajax.tProcess, ajax.tOver - ajax.tStart, ajax.tModule];
                for (var t in e)
                    if (e.hasOwnProperty(t)) {
                        if (e[t] < 0) return !1;
                        if (!e[t] && 0 !== e[t]) return !1
                    }
                return ajax.tStart = !1, e.join(",")
            }
        }
    };

    function initAjax() {
        window.ajaxCache = {}, window.globalAjaxCache = {}, window.ajax = ajax
    }
}, function(e, t, n) {
    "use strict";
    var r = n(453),
        o = n(38),
        i = n(198),
        a = n(247),
        s = "function" == typeof Symbol && Symbol.for,
        c = s ? Symbol.for("react.element") : 60103,
        u = s ? Symbol.for("react.portal") : 60106,
        l = s ? Symbol.for("react.fragment") : 60107,
        d = s ? Symbol.for("react.strict_mode") : 60108,
        f = s ? Symbol.for("react.profiler") : 60114,
        p = s ? Symbol.for("react.provider") : 60109,
        _ = s ? Symbol.for("react.context") : 60110,
        m = s ? Symbol.for("react.async_mode") : 60111,
        g = s ? Symbol.for("react.forward_ref") : 60112;
    s && Symbol.for("react.timeout");
    var h = "function" == typeof Symbol && Symbol.iterator;

    function b(e) {
        for (var t = arguments.length - 1, n = "https://reactjs.org/docs/error-decoder.html?invariant=" + e, r = 0; r < t; r++) n += "&args[]=" + encodeURIComponent(arguments[r + 1]);
        o(!1, "Minified React error #" + e + "; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ", n)
    }
    var v = {
        isMounted: function() {
            return !1
        },
        enqueueForceUpdate: function() {},
        enqueueReplaceState: function() {},
        enqueueSetState: function() {}
    };

    function y(e, t, n) {
        this.props = e, this.context = t, this.refs = i, this.updater = n || v
    }

    function O() {}

    function w(e, t, n) {
        this.props = e, this.context = t, this.refs = i, this.updater = n || v
    }
    y.prototype.isReactComponent = {}, y.prototype.setState = function(e, t) {
        "object" != typeof e && "function" != typeof e && null != e && b("85"), this.updater.enqueueSetState(this, e, t, "setState")
    }, y.prototype.forceUpdate = function(e) {
        this.updater.enqueueForceUpdate(this, e, "forceUpdate")
    }, O.prototype = y.prototype;
    var E = w.prototype = new O;
    E.constructor = w, r(E, y.prototype), E.isPureReactComponent = !0;
    var C = {
            current: null
        },
        j = Object.prototype.hasOwnProperty,
        k = {
            key: !0,
            ref: !0,
            __self: !0,
            __source: !0
        };

    function T(e, t, n) {
        var r = void 0,
            o = {},
            i = null,
            a = null;
        if (null != t)
            for (r in void 0 !== t.ref && (a = t.ref), void 0 !== t.key && (i = "" + t.key), t) j.call(t, r) && !k.hasOwnProperty(r) && (o[r] = t[r]);
        var s = arguments.length - 2;
        if (1 === s) o.children = n;
        else if (1 < s) {
            for (var u = Array(s), l = 0; l < s; l++) u[l] = arguments[l + 2];
            o.children = u
        }
        if (e && e.defaultProps)
            for (r in s = e.defaultProps) void 0 === o[r] && (o[r] = s[r]);
        return {
            $$typeof: c,
            type: e,
            key: i,
            ref: a,
            props: o,
            _owner: C.current
        }
    }

    function S(e) {
        return "object" == typeof e && null !== e && e.$$typeof === c
    }
    var M = /\/+/g,
        P = [];

    function x(e, t, n, r) {
        if (P.length) {
            var o = P.pop();
            return o.result = e, o.keyPrefix = t, o.func = n, o.context = r, o.count = 0, o
        }
        return {
            result: e,
            keyPrefix: t,
            func: n,
            context: r,
            count: 0
        }
    }

    function I(e) {
        e.result = null, e.keyPrefix = null, e.func = null, e.context = null, e.count = 0, 10 > P.length && P.push(e)
    }

    function D(e, t, n, r) {
        var o = typeof e;
        "undefined" !== o && "boolean" !== o || (e = null);
        var i = !1;
        if (null === e) i = !0;
        else switch (o) {
            case "string":
            case "number":
                i = !0;
                break;
            case "object":
                switch (e.$$typeof) {
                    case c:
                    case u:
                        i = !0
                }
        }
        if (i) return n(r, e, "" === t ? "." + A(e, 0) : t), 1;
        if (i = 0, t = "" === t ? "." : t + ":", Array.isArray(e))
            for (var a = 0; a < e.length; a++) {
                var s = t + A(o = e[a], a);
                i += D(o, s, n, r)
            } else if (null === e || void 0 === e ? s = null : s = "function" == typeof(s = h && e[h] || e["@@iterator"]) ? s : null, "function" == typeof s)
                for (e = s.call(e), a = 0; !(o = e.next()).done;) i += D(o = o.value, s = t + A(o, a++), n, r);
            else "object" === o && b("31", "[object Object]" === (n = "" + e) ? "object with keys {" + Object.keys(e).join(", ") + "}" : n, "");
        return i
    }

    function A(e, t) {
        return "object" == typeof e && null !== e && null != e.key ? function(e) {
            var t = {
                "=": "=0",
                ":": "=2"
            };
            return "$" + ("" + e).replace(/[=:]/g, function(e) {
                return t[e]
            })
        }(e.key) : t.toString(36)
    }

    function L(e, t) {
        e.func.call(e.context, t, e.count++)
    }

    function R(e, t, n) {
        var r = e.result,
            o = e.keyPrefix;
        e = e.func.call(e.context, t, e.count++), Array.isArray(e) ? B(e, r, n, a.thatReturnsArgument) : null != e && (S(e) && (t = o + (!e.key || t && t.key === e.key ? "" : ("" + e.key).replace(M, "$&/") + "/") + n, e = {
            $$typeof: c,
            type: e.type,
            key: t,
            ref: e.ref,
            props: e.props,
            _owner: e._owner
        }), r.push(e))
    }

    function B(e, t, n, r, o) {
        var i = "";
        null != n && (i = ("" + n).replace(M, "$&/") + "/"), t = x(t, i, r, o), null == e || D(e, "", R, t), I(t)
    }
    var N = {
            Children: {
                map: function(e, t, n) {
                    if (null == e) return e;
                    var r = [];
                    return B(e, r, null, t, n), r
                },
                forEach: function(e, t, n) {
                    if (null == e) return e;
                    t = x(null, null, t, n), null == e || D(e, "", L, t), I(t)
                },
                count: function(e) {
                    return null == e ? 0 : D(e, "", a.thatReturnsNull, null)
                },
                toArray: function(e) {
                    var t = [];
                    return B(e, t, null, a.thatReturnsArgument), t
                },
                only: function(e) {
                    return S(e) || b("143"), e
                }
            },
            createRef: function() {
                return {
                    current: null
                }
            },
            Component: y,
            PureComponent: w,
            createContext: function(e, t) {
                return void 0 === t && (t = null), (e = {
                    $$typeof: _,
                    _calculateChangedBits: t,
                    _defaultValue: e,
                    _currentValue: e,
                    _currentValue2: e,
                    _changedBits: 0,
                    _changedBits2: 0,
                    Provider: null,
                    Consumer: null
                }).Provider = {
                    $$typeof: p,
                    _context: e
                }, e.Consumer = e
            },
            forwardRef: function(e) {
                return {
                    $$typeof: g,
                    render: e
                }
            },
            Fragment: l,
            StrictMode: d,
            unstable_AsyncMode: m,
            unstable_Profiler: f,
            createElement: T,
            cloneElement: function(e, t, n) {
                (null === e || void 0 === e) && b("267", e);
                var o = void 0,
                    i = r({}, e.props),
                    a = e.key,
                    s = e.ref,
                    u = e._owner;
                if (null != t) {
                    void 0 !== t.ref && (s = t.ref, u = C.current), void 0 !== t.key && (a = "" + t.key);
                    var l = void 0;
                    for (o in e.type && e.type.defaultProps && (l = e.type.defaultProps), t) j.call(t, o) && !k.hasOwnProperty(o) && (i[o] = void 0 === t[o] && void 0 !== l ? l[o] : t[o])
                }
                if (1 === (o = arguments.length - 2)) i.children = n;
                else if (1 < o) {
                    l = Array(o);
                    for (var d = 0; d < o; d++) l[d] = arguments[d + 2];
                    i.children = l
                }
                return {
                    $$typeof: c,
                    type: e.type,
                    key: a,
                    ref: s,
                    props: i,
                    _owner: u
                }
            },
            createFactory: function(e) {
                var t = T.bind(null, e);
                return t.type = e, t
            },
            isValidElement: S,
            version: "16.4.0",
            __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED: {
                ReactCurrentOwner: C,
                assign: r
            }
        },
        U = {
            default: N
        },
        F = U && N || U;
    e.exports = F.default ? F.default : F
}, , function(e, t, n) {
    var r = n(316),
        o = n(426),
        i = n(305),
        a = n(141)("src"),
        s = Function.toString,
        c = ("" + s).split("toString");
    n(230).inspectSource = function(e) {
        return s.call(e)
    }, (e.exports = function(e, t, n, s) {
        var u = "function" == typeof n;
        u && (i(n, "name") || o(n, "name", t)), e[t] !== n && (u && (i(n, a) || o(n, a, e[t] ? "" + e[t] : c.join(String(t)))), e === r ? e[t] = n : s ? e[t] ? e[t] = n : o(e, t, n) : (delete e[t], o(e, t, n)))
    })(Function.prototype, "toString", function() {
        return "function" == typeof this && this[a] || s.call(this)
    })
}, , function(e, t, n) {
    "use strict";
    e.exports = {}
}, function(e, t, n) {
    var r = n(439),
        o = n(51);
    e.exports = function(e) {
        return function(t, n) {
            var i, a, s = String(o(t)),
                c = r(n),
                u = s.length;
            return c < 0 || c >= u ? e ? "" : void 0 : (i = s.charCodeAt(c)) < 55296 || i > 56319 || c + 1 === u || (a = s.charCodeAt(c + 1)) < 56320 || a > 57343 ? e ? s.charAt(c) : i : e ? s.slice(c, c + 2) : a - 56320 + (i - 55296 << 10) + 65536
        }
    }
}, , function(e, t, n) {
    var r = n(346),
        o = n(186),
        i = n(232),
        a = n(110)("IE_PROTO"),
        s = function() {},
        c = function() {
            var e, t = n(382)("iframe"),
                r = i.length;
            for (t.style.display = "none", n(25).appendChild(t), t.src = "javascript:", (e = t.contentWindow.document).open(), e.write("<script>document.F=Object<\/script>"), e.close(), c = e.F; r--;) delete c.prototype[i[r]];
            return c()
        };
    e.exports = Object.create || function(e, t) {
        var n;
        return null !== e ? (s.prototype = r(e), n = new s, s.prototype = null, n[a] = e) : n = c(), void 0 === t ? n : o(n, t)
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(409),
        i = n(449),
        a = n(402),
        s = n(309),
        c = n(219),
        u = n(252),
        l = n(406);

    function d(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var f = o.default.getLang,
        p = function(e) {
            function t() {
                var n, r;
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                for (var o = arguments.length, i = Array(o), a = 0; a < o; a++) i[a] = arguments[a];
                return n = r = d(this, e.call.apply(e, [this].concat(i))), r.toggleAdmin = function() {
                    var e = r.props,
                        t = e.store,
                        n = e.mid,
                        o = e.adminMap,
                        i = t.get().peer,
                        a = !o[n];
                    t.set(u.toggleAdminOptimisticly.bind(null, i, n, a)), t.set(u.toggleAdmin.bind(null, i, n, a))
                }, r.kick = function() {
                    var e = r.props.store,
                        t = e.get().peer,
                        n = r.props.mid;
                    e.set(u.kickUserOptimisticly.bind(null, t, n)), e.set(u.kickUser.bind(null, t, n)).catch(function(e) {
                        Object(c.imWeirdCatch)("ChatSettingsMemberEdit.kick", e)
                    })
                }, r.changeAccess = function(e) {
                    var t = r.props.store,
                        n = t.get().peer,
                        o = r.props.mid;
                    t.set(u.changeCommunityAccess.bind(null, n, o, !e)).catch(function(e) {
                        Object(c.imWeirdCatch)("ChatSettingsMemberEdit.changeAccess", e)
                    })
                }, d(r, n)
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.getMemberRole = function(e, t) {
                var n = this.props.storeData,
                    r = n.peer;
                return t === n.tabs[r].ownerId ? f("mail_settings_owner") : e[t] ? f("mail_settings_admin") : null
            }, t.prototype.getActions = function(e) {
                var t = window.vk.id,
                    n = this.props,
                    r = n.store,
                    o = n.mid,
                    i = [];
                if (t === o) return [{
                    text: f("mail_leave_chat"),
                    onClick: this.props.onLeave
                }];
                if (Object(s.canAddAdmin)(r, o) && i.push({
                        text: e[o] ? f("mail_chat_remove_admin") : f("mail_settings_appoint_admin"),
                        onClick: this.toggleAdmin
                    }), Object(s.canKickUser)(r, o) && i.push({
                        text: f("mail_settings_kick"),
                        onClick: this.kick
                    }), Object(l.isCommunityPeer)(o) && !e[o]) {
                    var a = Object(s.canSeeAllMessages)(r, r.get().peer, o),
                        c = a ? "mail_settings_community_mentions_only" : "mail_settings_community_full_access";
                    i.push({
                        text: f(c),
                        onClick: this.changeAccess.bind(this, a)
                    })
                }
                return i
            }, t.prototype.render = function() {
                var e = window.vk.id,
                    t = this.props,
                    n = t.adminMap,
                    o = t.storeData,
                    c = t.mid,
                    u = !!n[e],
                    l = this.getMemberRole(n, c),
                    d = e === c,
                    p = u && this.getActions(n);
                return r.createElement(r.Fragment, null, l && r.createElement("span", {
                    className: "ChatSettingsMembersEdit__role"
                }, l), p && p.length > 0 && r.createElement(i.default, {
                    position: "b",
                    align: "right",
                    trigger: "hover",
                    marginTop: -8,
                    marginLeft: 1,
                    data: this.getActions(n)
                }, r.createElement("span", {
                    className: "ChatSettingsMembersEdit__actions"
                })), !u && !d && Object(s.canKickUser)(o, c) && r.createElement(a.default, {
                    text: f("mail_settings_kick"),
                    position: "t",
                    align: "right"
                }, r.createElement("span", {
                    onClick: this.kick,
                    className: "ChatSettingsMembersEdit__kick"
                })), !u && d && r.createElement(a.default, {
                    text: f("mail_leave_chat"),
                    position: "t",
                    align: "right"
                }, r.createElement("span", {
                    onClick: this.props.onLeave,
                    className: "ChatSettingsMembersEdit__kick"
                })))
            }, t
        }(r.Component);
    t.default = p
}, function(e, t, n) {
    "use strict";

    function r(e) {
        var t = e.getBoundingClientRect(),
            n = document.body,
            r = document.documentElement,
            o = window.pageYOffset || r.scrollTop || n.scrollTop,
            i = window.pageXOffset || r.scrollLeft || n.scrollLeft,
            a = r.clientTop || n.clientTop || 0,
            s = r.clientLeft || n.clientLeft || 0;
        return {
            top: Math.round(t.top + o - a),
            left: Math.round(t.left + i - s),
            width: e.offsetWidth,
            height: e.offsetHeight
        }
    }
    n.r(t), n.d(t, "default", function() {
        return r
    })
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return a
    });
    var r = n(451),
        o = n(63),
        i = (n(96), Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        });

    function a(e) {
        var t = e.icon,
            n = e.aside,
            a = e.chevron,
            s = e.selectable,
            c = e.border,
            u = e.className,
            l = e.children,
            d = e.active,
            f = e.canBeHovered,
            p = void 0 === f || f,
            _ = function(e, t) {
                var n = {};
                for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                return n
            }(e, ["icon", "aside", "chevron", "selectable", "border", "className", "children", "active", "canBeHovered"]),
            m = {
                "ListItem--chevron": !!a,
                "ListItem--selectable": !!s,
                "ListItem--border": !!c,
                "ListItem--active": !!d,
                "ListItem--can-be-hovered": p
            };
        return r.createElement("li", i({}, _, {
            className: Object(o.classNames)("ListItem", m, u)
        }), t && r.createElement("div", {
            className: "ListItem__icon"
        }, t), r.createElement("div", {
            className: "ListItem__main"
        }, l), r.createElement("div", {
            className: "ListItem__aside"
        }, n))
    }
    a.defaultProps = {
        onClick: function() {},
        icon: null,
        aside: null,
        chevron: !1,
        selectable: !0,
        border: !0
    }
}, , , , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(1),
        i = n(252),
        a = n(112),
        s = n(409),
        c = n(59),
        u = n(135),
        l = n(282),
        d = n(319),
        f = n(55),
        p = n(171),
        _ = n(87),
        m = n(360),
        g = n(303),
        h = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var b = 0,
        v = 2,
        y = 300,
        O = s.default.getLang,
        w = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.showInvitationLink = function() {
                    var e = r.props.store.get(),
                        t = e.peer;
                    return r.setState({
                        invitationLoading: !0
                    }), Object(i.getInviteLink)(t - 2e9, e).then(function(e) {
                        var t = h(e, 1)[0];
                        r.setState({
                            section: v,
                            invitationLoading: !1,
                            invitationLink: t
                        })
                    })
                }, r.onUpdateFlags = function(e) {
                    var t = r.props.store.get(),
                        n = t.peer;
                    return Object(i.updateFlags)(n, e, t)
                }, r.afterUpdateFlags = function() {
                    r.go(b, function() {
                        return r.setBlinkStatus({
                            flagsUpdated: !0
                        })
                    })
                }, r.afterMembersAdded = function(e) {
                    r.go(b, function() {
                        return r.setBlinkStatus({
                            membersAdded: !0,
                            membersCount: e
                        })
                    })
                }, r.setBlinkStatus = function(e) {
                    r.timers.push(setTimeout(function() {
                        return r.setState(e)
                    }, y))
                }, r.onHideStatus = function() {
                    r.setState({
                        membersAdded: !1,
                        flagsUpdated: !1
                    })
                }, r.onLeave = function() {
                    var e = r.props,
                        t = e.store,
                        n = e.closePopup,
                        s = t.get().peer,
                        c = Object(o.isFvkcomgroup)(t, s),
                        u = showFastBox({
                            title: O(c ? "mail_leave_channel" : "mail_chat_leave_title"),
                            dark: 1
                        }, O(c ? "mail_vkcomgroup_leave_confirm" : "mail_chat_leave_confirm"), O(c ? "mail_leave_channel" : "mail_leave_chat"), function() {
                            t.set(i.unpinMessageOptimistic.bind(null, s)), t.set(i.leaveChat.bind(null, s)), u.hide(), n(), t.get().longpoll.push([Object(a.resetPeer)()])
                        }, O("global_cancel"), function() {
                            u.hide()
                        })
                }, r.onResetLink = function() {
                    var e = r.props.store.get(),
                        t = e.peer;
                    return Object(i.resetInviteLink)(t, e).then(function(e) {
                        var t = h(e, 1)[0];
                        r.setState({
                            invitationLink: t,
                            invitationLinkReseted: !0
                        })
                    })
                }, r.onShowAttachments = function() {
                    var e = r.props.store.get().peer;
                    window.showWiki({
                        w: "history" + Object(o.convertPeerToUrl)(e) + "_photo"
                    }, null, {})
                }, r.state = {
                    section: b,
                    invitationLink: null,
                    invitationLinkReseted: !1,
                    membersAdded: !1,
                    flagsUpdated: !1
                }, r.timers = [], r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.go = function(e, t) {
                var n = this;
                this.setState({
                    section: e
                }, function() {
                    n.props.updatePopup(), t && t()
                })
            }, t.prototype.getPopupTitle = function() {
                switch (this.state.section) {
                    case 1:
                        return O("mail_settings_add_members");
                    case v:
                    case 3:
                        return O("mail_chat_invite_link");
                    case 6:
                        return O("mail_settings_options");
                    default:
                        return O("mail_settings_title")
                }
            }, t.prototype.componentWillReceiveProps = function(e) {
                var t = this,
                    n = e.store.get(),
                    r = n.peer,
                    o = n.tabs[r];
                o.photoLarge || o.photoGrid || this.resync || (this.resync = !0, e.store.set(i.getChatDetails.bind(null, r)).then(function() {
                    t.resync = !0
                }))
            }, t.prototype.componentDidMount = function() {
                this.props.updatePopup()
            }, t.prototype.componentWillUnmount = function() {
                this.timers.forEach(clearTimeout)
            }, t.prototype.render = function() {
                var e = this,
                    t = this.props,
                    n = t.store,
                    i = t.closePopup,
                    a = n.get(),
                    s = a.peer,
                    h = a.tabs[s],
                    y = Object(o.isFvkcomgroup)(n, s),
                    w = !y || !n.get().gid,
                    E = O(y ? "mail_im_n_vkcomgroup_members" : "mail_im_n_chat_members", Object(o.getAliveMembersCount)(h));
                return r.createElement("section", {
                    className: "ChatSettings"
                }, r.createElement(c.default, {
                    title: this.getPopupTitle(),
                    back: this.state.section !== b ? O("global_back") : void 0,
                    onCloseClick: i,
                    onBackClick: function() {
                        return e.go(b)
                    }
                }), this.state.section === b && r.createElement("div", {
                    className: "ChatSettings__content"
                }, r.createElement(l.default, {
                    store: n,
                    photo: h.photoLarge,
                    grid: h.photoGrid,
                    title: h.name,
                    flags: h.data.flags,
                    meta: E,
                    description: ""
                }), r.createElement(p.default, {
                    store: n,
                    showNotificationSettings: function() {},
                    showMembersSettings: function() {
                        return e.go(1)
                    },
                    showAttachments: this.onShowAttachments,
                    showInvitationLink: this.showInvitationLink,
                    showSettings: function() {
                        return e.go(6)
                    },
                    membersAdded: this.state.membersAdded,
                    membersCount: this.state.membersCount,
                    flagsUpdated: this.state.flagsUpdated,
                    onHideStatus: this.onHideStatus
                }), y ? null : r.createElement("div", {
                    className: "ChatSettings__pane"
                }, r.createElement(_.default, {
                    store: n,
                    onLeave: this.onLeave,
                    showMembersSettings: function() {
                        return e.go(1)
                    },
                    membersAdded: this.state.membersAdded,
                    onHideStatus: this.onHideStatus,
                    membersCount: this.state.membersCount
                })), w && r.createElement("div", {
                    className: "ChatSettings__pane"
                }, r.createElement(u.default, {
                    appearance: ["link", "mobile"],
                    className: "ChatSettings__leave",
                    onClick: this.onLeave
                }, O(y ? "mail_leave_channel" : "mail_settings_leave")))), 1 === this.state.section && r.createElement(m.default, {
                    store: n,
                    afterSave: this.afterMembersAdded
                }), 6 === this.state.section && r.createElement(g.default, {
                    tab: h,
                    back: function() {
                        return e.go(b)
                    },
                    onSave: this.onUpdateFlags,
                    afterSave: this.afterUpdateFlags
                }), this.state.section === v && r.createElement(d.default, {
                    store: n,
                    onReset: function() {
                        return e.go(3)
                    },
                    reseted: this.state.invitationLinkReseted,
                    invitationLink: this.state.invitationLink
                }), 3 === this.state.section && r.createElement(f.default, {
                    onConfirm: this.onResetLink,
                    onCancel: function() {
                        return e.go(v)
                    }
                }))
            }, t
        }(r.Component);
    t.default = w
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return i
    });
    var r = n(451),
        o = n(63);

    function i(e) {
        var t = {
            "SubmitArea--left": !e.alignment || "left" === e.alignment,
            "SubmitArea--center": "center" === e.alignment,
            "SubmitArea--right": "right" === e.alignment
        };
        return r.createElement("div", {
            className: Object(o.classNames)("SubmitArea", t),
            style: e.style
        }, e.children)
    }
}, , , function(e, t, n) {
    var r = n(322),
        o = n(85).set;
    e.exports = function(e, t, n) {
        var i, a = t.constructor;
        return a !== n && "function" == typeof a && (i = a.prototype) !== n.prototype && r(i) && o && o(e, i), e
    }
}, , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return i
    });
    var r = n(451),
        o = (n(96), n(63));

    function i(e) {
        var t = {
            "List--border": !!e.border
        };
        return r.createElement("ul", {
            className: Object(o.classNames)("List", t, e.className),
            style: e.style
        }, e.children)
    }
    i.defaultProps = {
        border: !0
    }
}, function(e, t) {
    e.exports = function(e, t) {
        return {
            enumerable: !(1 & e),
            configurable: !(2 & e),
            writable: !(4 & e),
            value: t
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "isWeirdLogging", function() {
        return u
    }), n.d(t, "imWeirdLog", function() {
        return l
    }), n.d(t, "imWeirdCatch", function() {
        return d
    }), n.d(t, "startLoggingAllUnhandled", function() {
        return f
    }), n.d(t, "stopLoggingAllUnhandled", function() {
        return p
    });
    var r = n(364),
        o = n(392),
        i = void 0,
        a = 1;

    function s(e, t, n, r, o) {
        if ("Script error." !== e) {
            var a = o ? o.stack || o.message : null;
            l("unhandled_error", a ? {
                err: e,
                stack: a
            } : {
                err: e
            })
        }
        i && i.apply(this, arguments)
    }

    function c(e) {
        e.preventDefault()
    }

    function u() {
        return !!window.imwl
    }

    function l(e, t) {
        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2];
        u() && (n && window.console && (console.error(e, t), console.trace && console.trace()), Object(o.retryFn)(r.post, 3, function() {
            return 2
        })("al_im.php", {
            act: "a_weird_log",
            kind: e,
            data: JSON.stringify(extend({
                errIdx: a++,
                ua: navigator.userAgent
            }, t))
        }))
    }

    function d(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};
        return l(e, extend({
            err: t && t.message || t
        }, n)), Promise.reject(t)
    }

    function f() {
        i = window.onerror, window.onerror = s, window.addEventListener("unhandledrejection", c)
    }

    function p() {
        window.onerror = i, i = void 0, window.removeEventListener("unhandledrejection", c)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "parseLatin", function() {
        return a
    }), n.d(t, "parseCyr", function() {
        return s
    }), n.d(t, "parseLatKeys", function() {
        return c
    }), n.d(t, "langNumeric", function() {
        return u
    }), n.d(t, "langSex", function() {
        return l
    }), n.d(t, "langStr", function() {
        return d
    }), n.d(t, "addLangKeys", function() {
        return f
    }), n.d(t, "getLang", function() {
        return p
    }), n.d(t, "langDate", function() {
        return _
    }), n.d(t, "getShortDate", function() {
        return m
    }), n.d(t, "getShortDateOrTime", function() {
        return g
    }), n.d(t, "langWordNumeric", function() {
        return h
    }), n.d(t, "getDateText", function() {
        return b
    }), n.d(t, "getBigDateNew", function() {
        return v
    }), n.d(t, "getSmDate", function() {
        return y
    });
    var r = n(28),
        o = n(269),
        i = n(95);

    function a(e) {
        for (var t = ["yo", "zh", "kh", "ts", "ch", "sch", "shch", "sh", "eh", "yu", "ya", "YO", "ZH", "KH", "TS", "CH", "SCH", "SHCH", "SH", "EH", "YU", "YA", "'"], n = ["ё", "ж", "х", "ц", "ч", "щ", "щ", "ш", "э", "ю", "я", "Ё", "Ж", "Х", "Ц", "Ч", "Щ", "Щ", "Ш", "Э", "Ю", "Я", "ь"], r = e, o = 0, i = t.length; o < i; o++) r = r.split(t[o]).join(n[o]);
        for (var a = "abvgdezijklmnoprstufhcyABVGDEZIJKLMNOPRSTUFHCYёЁ", s = 0, c = a.length; s < c; s++) r = r.split(a.charAt(s)).join("абвгдезийклмнопрстуфхцыАБВГДЕЗИЙКЛМНОПРСТУФХЦЫеЕ".charAt(s));
        return r === e ? null : r
    }

    function s(e) {
        for (var t = ["yo", "zh", "kh", "ts", "ch", "sch", "shch", "sh", "eh", "yu", "ya", "YO", "ZH", "KH", "TS", "CH", "SCH", "SHCH", "SH", "EH", "YU", "YA", "'"], n = ["ё", "ж", "х", "ц", "ч", "щ", "щ", "ш", "э", "ю", "я", "Ё", "Ж", "Х", "Ц", "Ч", "Щ", "Щ", "Ш", "Э", "Ю", "Я", "ь"], r = "абвгдезийклмнопрстуфхцыАБВГДЕЗИЙКЛМНОПРСТУФХЦЫеЕ", o = e, i = 0; i < n.length; i++) o = o.split(n[i]).join(t[i]);
        for (var a = 0; a < r.length; a++) o = o.split(r.charAt(a)).join("abvgdezijklmnoprstufhcyABVGDEZIJKLMNOPRSTUFHCYёЁ".charAt(a));
        return o === e ? null : o
    }

    function c(e) {
        for (var t = "qwertyuiop[]asdfghjkl;'zxcvbnm,./`", n = e, r = 0; r < t.length; r++) n = n.split(t.charAt(r)).join("йцукенгшщзхъфывапролджэячсмитьбю.ё".charAt(r));
        return n == e ? null : n
    }

    function u(e, t, n) {
        if (!t || !window.langConfig) return e;
        var r = void 0;
        if (Object(o.isArray)(t) ? (r = t[1], e != Math.floor(e) ? r = t[langConfig.numRules.float] : Object(o.each)(langConfig.numRules.int, function(n, i) {
                if ("*" == i[0]) return r = t[i[2]], !1;
                var a = i[0] ? e % i[0] : e;
                return -1 != Object(o.indexOf)(i[1], a) ? (r = t[i[2]], !1) : void 0
            })) : r = t, n) {
            for (var i = e.toString().split("."), a = [], s = i[0].length - 3; s > -3; s -= 3) a.unshift(i[0].slice(s > 0 ? s : 0, s + 3));
            i[0] = a.join(langConfig.numDel), e = i.join(langConfig.numDec)
        }
        return r = (r || "%s").replace("%s", e)
    }

    function l(e, t) {
        if (!Object(o.isArray)(t)) return t;
        var n = t[1];
        return window.langConfig ? (Object(o.each)(langConfig.sexRules, function(r, o) {
            return "*" == o[0] ? (n = t[o[1]], !1) : e == o[0] && t[o[1]] ? (n = t[o[1]], !1) : void 0
        }), n) : n
    }

    function d(e) {
        for (var t = arguments, n = t.length, r = e + "", o = 1; o < n; o += 2) {
            var i = "%" === t[o][0] ? t[o] : "{" + t[o] + "}";
            r = r.replace(i, t[o + 1])
        }
        return r
    }

    function f(e, t) {
        var n = t ? window : window.cur;
        n.lang ? Object(o.extend)(n.lang, e) : n.lang = e
    }

    function p() {
        try {
            var e = Array.from(arguments),
                t = e.shift();
            if (!t) return "...";
            var n = window.cur.lang && window.cur.lang[t] || window.lang && window.lang[t] || window.langpack && window.langpack[t] || window[t];
            if (!n) {
                var r = t.split("_");
                return r.shift(), r.join(" ")
            }
            return Object(o.isFunction)(n) ? n.apply(null, e) : void 0 === e[0] && !Object(o.isArray)(n) || "raw" === e[0] ? n : u(e[0], n, e[1])
        } catch (e) {
            Object(i.debugLog)("lang error:" + e.message + "(" + Array.from(arguments).join(", ") + ")")
        }
    }

    function _(e, t, n, i, a, s) {
        var c = void 0;
        if (s || (s = ""), Object(o.isArray)(t) || (t = ["", t, t, t, t]), "number" == typeof e || "string" == typeof e ? (e > 2147483646e3 && (e = 0), e += n, c = new Date(e)) : c = e, a) t = t[1];
        else {
            var u = "";
            !(u = Object(r.isToday)(c) ? t[3] : Object(r.isYesterday)(c) ? t[2] : Object(r.isTomorrow)(c) ? t[4] : t[1]) && t[1] && (u = t[1]), t = u
        }
        var l = {
                hours: c.getHours(),
                minutes: c.getMinutes(),
                seconds: c.getSeconds(),
                day: c.getDate(),
                month: c.getMonth() + 1,
                year: c.getFullYear()
            },
            d = "";
        switch (3 === vk.lang && (d = c.getHours() > 11 ? "pm" : "am", l.hours = c.getHours() % 12 == 0 ? 12 : c.getHours() % 12), vk.lang) {
            case 1:
                switch (c.getHours()) {
                    case 11:
                        t = t.replace(" о ", " об ");
                        break;
                    case 0:
                        t = t.replace(" о ", " в ")
                }
                break;
            case 3:
                !Object(r.isToday)(c) || Object(r.isYesterday)(c) || Object(r.isTomorrow)(c) || (t = s + t);
                break;
            case 12:
            case 73:
                1 == c.getHours() && (t = t.replace(" &#224;s ", " &#224; "))
        }
        return 68 === vk.lang && (l.year = l.year + 543), t.replace("{hour}", l.hours).replace("{num_hour}", Object(r.leadingZero)(l.hours)).replace("{minute}", Object(r.leadingZero)(l.minutes)).replace("{day}", l.day).replace("{num_day}", Object(r.leadingZero)(l.day)).replace("{month}", i[l.month]).replace("{year}", l.year).replace("{short_year}", l.year % 100).replace("{second}", Object(r.leadingZero)(l.seconds)).replace("{am_pm}", d)
    }

    function m(e, t, n, r, o) {
        e *= 1e3, void 0 === n && (n = !0), void 0 === r && (r = p("months_of", "raw")), t *= 1e3;
        var i = Date.now(),
            a = new Date(i),
            s = new Date(e + t);
        return !o && e > i && e - i < 864e5 && a.getDate() === s.getDate() ? _(e, "{hour}:{minute} {am_pm}", t, [], !n) : s.getYear() !== a.getYear() || e < i - 157248e5 ? _(e, p("global_date", "raw"), t, r, !n) : _(e, p("global_short_date", "raw"), t, r, !n)
    }

    function g(e, t, n, o) {
        return Object(r.isToday)(new Date(1e3 * e + 1e3 * t)) ? _(1e3 * e, "{hour}:{minute} {am_pm}", 1e3 * t, [], !n) : m(e, t, n, o)
    }

    function h(e, t, n) {
        return Object(o.isArray)(t) && e < t.length ? t[e] : u(e, n)
    }

    function b(e, t) {
        e += t;
        var n = parseInt(Date.now() / 1e3) - e,
            r = "";
        if (n < 60) r = p("global_just_now");
        else if (n < 3600) {
            r = h(Object(o.intval)(n / 60), p("global_word_mins_ago", "raw"), p("global_mins_ago", "raw"))
        } else if (n < 14400) {
            r = h(Object(o.intval)(n / 3600), p("global_word_hours_ago", "raw"), p("global_hours_ago", "raw"))
        } else r = v(e, 0, !0, "_l");
        return r
    }

    function v(e, t, n, r) {
        void 0 === n && (n = !0), void 0 === t && (t = 0), void 0 === r && (r = ""), t *= 1e3;
        var o = new Date(1e3 * e),
            i = new Date;
        return o.getFullYear() !== i.getFullYear() && o.getTime() < i.getTime() - 1728e5 || Math.abs(o.getTime() - i.getTime()) > 157248e5 ? _(1e3 * e, p("global_date", "raw"), t, p("months_sm_of"), !n) : _(1e3 * e, p("global_short_date_time" + r, "raw"), t, p("months_sm_of"), !n)
    }

    function y(e, t, n) {
        void 0 === n && (n = !0), void 0 === t && (t = 0);
        var r = new Date,
            o = r.getFullYear(),
            i = r.getMonth(),
            a = new Date(1e3 * e),
            s = a.getFullYear(),
            c = a.getMonth();
        return _(1e3 * e, p(s < o && (i > 1 || c < 9 || o - s >= 2) ? "global_date" : "global_short_date_time", "raw"), t, p("months_sm_of", "raw"), !n)
    }
}, , , , , , , function(e, t, n) {
    var r = n(322);
    e.exports = function(e, t) {
        if (!r(e)) return e;
        var n, o;
        if (t && "function" == typeof(n = e.toString) && !r(o = n.call(e))) return o;
        if ("function" == typeof(n = e.valueOf) && !r(o = n.call(e))) return o;
        if (!t && "function" == typeof(n = e.toString) && !r(o = n.call(e))) return o;
        throw TypeError("Can't convert object to primitive value")
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "doesSearchResultContainConversations", function() {
        return c
    }), n.d(t, "mount", function() {
        return u
    });
    var r = n(256),
        o = n(252),
        i = n(1),
        a = n(112);

    function s(e, t) {
        return {
            isAll: function(e) {
                return Object(o.isSearchAllLoaded)(e.get().peer, e.get())
            },
            loadMore: function(e) {
                return function(e) {
                    return Object(o.isSearchAllLoaded)(e.get().peer, e.get()) ? Promise.resolve("") : Object(o.searchMessagesInplace)(e.get().peer, e.get())
                }(e)
            },
            unmount: function() {
                Object(r.destroyModule)(t)
            }
        }
    }

    function c(e) {
        return e.findIndex(function(e) {
            return "number" == typeof e.peerId && e.href
        }) > -1
    }

    function u(e, t) {
        var n = function(e, t, n) {
            var r = intval(domData(n, "msgid"));
            if (!getSelectionText() && !Object(i.checkSelectClick)(t)) {
                var s = intval(domData(n, "peer"));
                return e.set(o.cancelSearch.bind(null, s)), e.get().longpoll.push([Object(a.changePeer)(s, r)]), !1
            }
        }.bind(null, t);
        return s(0, Object(r.createModule)({
            handlers: function(t, r) {
                r(e, "click", "_im_mess", n)
            }
        }))
    }
}, , function(e, t) {
    var n = e.exports = {
        version: "2.2.1"
    };
    "number" == typeof __e && (__e = n)
}, , function(e, t) {
    e.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")
}, , function(e, t) {
    e.exports = function(e, t) {
        return {
            value: t,
            done: !!e
        }
    }
}, , function(e, t) {
    var n, r, o = e.exports = {};

    function i() {
        throw new Error("setTimeout has not been defined")
    }

    function a() {
        throw new Error("clearTimeout has not been defined")
    }

    function s(e) {
        if (n === setTimeout) return setTimeout(e, 0);
        if ((n === i || !n) && setTimeout) return n = setTimeout, setTimeout(e, 0);
        try {
            return n(e, 0)
        } catch (t) {
            try {
                return n.call(null, e, 0)
            } catch (t) {
                return n.call(this, e, 0)
            }
        }
    }! function() {
        try {
            n = "function" == typeof setTimeout ? setTimeout : i
        } catch (e) {
            n = i
        }
        try {
            r = "function" == typeof clearTimeout ? clearTimeout : a
        } catch (e) {
            r = a
        }
    }();
    var c, u = [],
        l = !1,
        d = -1;

    function f() {
        l && c && (l = !1, c.length ? u = c.concat(u) : d = -1, u.length && p())
    }

    function p() {
        if (!l) {
            var e = s(f);
            l = !0;
            for (var t = u.length; t;) {
                for (c = u, u = []; ++d < t;) c && c[d].run();
                d = -1, t = u.length
            }
            c = null, l = !1,
                function(e) {
                    if (r === clearTimeout) return clearTimeout(e);
                    if ((r === a || !r) && clearTimeout) return r = clearTimeout, clearTimeout(e);
                    try {
                        r(e)
                    } catch (t) {
                        try {
                            return r.call(null, e)
                        } catch (t) {
                            return r.call(this, e)
                        }
                    }
                }(e)
        }
    }

    function _(e, t) {
        this.fun = e, this.array = t
    }

    function m() {}
    o.nextTick = function(e) {
        var t = new Array(arguments.length - 1);
        if (arguments.length > 1)
            for (var n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
        u.push(new _(e, t)), 1 !== u.length || l || s(p)
    }, _.prototype.run = function() {
        this.fun.apply(null, this.array)
    }, o.title = "browser", o.browser = !0, o.env = {}, o.argv = [], o.version = "", o.versions = {}, o.on = m, o.addListener = m, o.once = m, o.off = m, o.removeListener = m, o.removeAllListeners = m, o.emit = m, o.prependListener = m, o.prependOnceListener = m, o.listeners = function(e) {
        return []
    }, o.binding = function(e) {
        throw new Error("process.binding is not supported")
    }, o.cwd = function() {
        return "/"
    }, o.chdir = function(e) {
        throw new Error("process.chdir is not supported")
    }, o.umask = function() {
        return 0
    }
}, function(e, t, n) {
    var r = n(151)("unscopables"),
        o = Array.prototype;
    void 0 == o[r] && n(426)(o, r, {}), e.exports = function(e) {
        o[r][e] = !0
    }
}, , , , , , , , , , function(e, t, n) {
    "use strict";

    function r(e) {
        return function() {
            return e
        }
    }
    var o = function() {};
    o.thatReturns = r, o.thatReturnsFalse = r(!1), o.thatReturnsTrue = r(!0), o.thatReturnsNull = r(null), o.thatReturnsThis = function() {
        return this
    }, o.thatReturnsArgument = function(e) {
        return e
    }, e.exports = o
}, , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "CONTROLLER", function() {
        return E
    }), n.d(t, "ACTIVITY_PERIOD", function() {
        return C
    }), n.d(t, "ACTIVITY_TYPE_TYPING", function() {
        return j
    }), n.d(t, "ACTIVITY_TYPE_RECORDING_AUDIO", function() {
        return k
    }), n.d(t, "ACTION_PRIORITIES", function() {
        return x
    }), n.d(t, "loadHashes", function() {
        return I
    }), n.d(t, "strHistory", function() {
        return R
    }), n.d(t, "updateBlockStates", function() {
        return B
    }), n.d(t, "loadPeer", function() {
        return N
    }), n.d(t, "restoreHistoryQueue", function() {
        return U
    }), n.d(t, "removeFailed", function() {
        return F
    }), n.d(t, "selectPeer", function() {
        return W
    }), n.d(t, "selectPeerOnMessage", function() {
        return q
    }), n.d(t, "changePeer", function() {
        return z
    }), n.d(t, "updateMentions", function() {
        return G
    }), n.d(t, "setActions", function() {
        return V
    }), n.d(t, "loadMoreHistory", function() {
        return Y
    }), n.d(t, "loadLessHistory", function() {
        return Q
    }), n.d(t, "readLastMessages", function() {
        return X
    }), n.d(t, "loadLongPollKey", function() {
        return J
    }), n.d(t, "loadLongPollTs", function() {
        return Z
    }), n.d(t, "setMessageErrored", function() {
        return ee
    }), n.d(t, "resendMessage", function() {
        return te
    }), n.d(t, "loadAdmins", function() {
        return re
    }), n.d(t, "updateVideoThumb", function() {
        return ae
    }), n.d(t, "editMessage", function() {
        return ce
    }), n.d(t, "addMessage", function() {
        return ue
    }), n.d(t, "markInboundMessagesAsRead", function() {
        return de
    }), n.d(t, "markOutboundMessagesAsRead", function() {
        return fe
    }), n.d(t, "initTextStore", function() {
        return pe
    }), n.d(t, "processFwd", function() {
        return _e
    }), n.d(t, "mergeTabs", function() {
        return me
    }), n.d(t, "updateOnline", function() {
        return ge
    }), n.d(t, "setActivity", function() {
        return he
    }), n.d(t, "waitActivity", function() {
        return be
    }), n.d(t, "sendMessage", function() {
        return Oe
    }), n.d(t, "deliverMessage", function() {
        return we
    }), n.d(t, "deliverEditedMessage", function() {
        return Ee
    }), n.d(t, "addSelection", function() {
        return Ce
    }), n.d(t, "cleanSelected", function() {
        return je
    }), n.d(t, "dropSelection", function() {
        return ke
    }), n.d(t, "replaceMessage", function() {
        return Te
    }), n.d(t, "saveMedia", function() {
        return Se
    }), n.d(t, "loadMedia", function() {
        return Me
    }), n.d(t, "addAttachmentsToStoreData", function() {
        return Pe
    }), n.d(t, "replaceMediaAttachesStore", function() {
        return xe
    }), n.d(t, "setCurrentSearchDate", function() {
        return Ie
    }), n.d(t, "setInplaceSearch", function() {
        return De
    }), n.d(t, "setCurrentSearch", function() {
        return Ae
    }), n.d(t, "searchHints", function() {
        return Le
    }), n.d(t, "searchHintsIndex", function() {
        return Re
    }), n.d(t, "localIndexToDialog", function() {
        return Be
    }), n.d(t, "searchTopConv", function() {
        return Ue
    }), n.d(t, "searchImTopConv", function() {
        return Fe
    }), n.d(t, "searchLocalHints", function() {
        return He
    }), n.d(t, "preloadSearchIndex", function() {
        return We
    }), n.d(t, "loadDialogs", function() {
        return Ke
    }), n.d(t, "searchMessages", function() {
        return qe
    }), n.d(t, "isSearchAllLoaded", function() {
        return ze
    }), n.d(t, "isSearchingInplace", function() {
        return Ge
    }), n.d(t, "cancelSearch", function() {
        return Ve
    }), n.d(t, "clearDate", function() {
        return Ye
    }), n.d(t, "searchInplaceStart", function() {
        return Qe
    }), n.d(t, "searchMessagesInplace", function() {
        return $e
    }), n.d(t, "loadImportant", function() {
        return Xe
    }), n.d(t, "loadActualLastMessage", function() {
        return Je
    }), n.d(t, "removeMessagesMarkDeleted", function() {
        return Ze
    }), n.d(t, "removeMessages", function() {
        return et
    }), n.d(t, "removeMessageSend", function() {
        return tt
    }), n.d(t, "removeMessagesWithRestore", function() {
        return nt
    }), n.d(t, "restoreMessage", function() {
        return rt
    }), n.d(t, "restoreMessageSend", function() {
        return ot
    }), n.d(t, "acceptMessageRequest", function() {
        return at
    }), n.d(t, "rejectMessageRequest", function() {
        return st
    }), n.d(t, "sendTyping", function() {
        return ct
    }), n.d(t, "sendRecordingAudio", function() {
        return ut
    }), n.d(t, "forwardMessages", function() {
        return lt
    }), n.d(t, "prepareForward", function() {
        return dt
    }), n.d(t, "deletedDialog", function() {
        return ft
    }), n.d(t, "flushHistory", function() {
        return pt
    }), n.d(t, "updateChatTopic", function() {
        return _t
    }), n.d(t, "loadChatInfo", function() {
        return mt
    }), n.d(t, "addNewMemberOptimisticly", function() {
        return gt
    }), n.d(t, "addNewMember", function() {
        return ht
    }), n.d(t, "loadChatMember", function() {
        return bt
    }), n.d(t, "checkNewPeople", function() {
        return vt
    }), n.d(t, "loadNewPeople", function() {
        return yt
    }), n.d(t, "updateChatPhoto", function() {
        return Ot
    }), n.d(t, "updateActions", function() {
        return wt
    }), n.d(t, "leaveChat", function() {
        return Et
    }), n.d(t, "returnToChat", function() {
        return Ct
    }), n.d(t, "toggleMutePeer", function() {
        return jt
    }), n.d(t, "setMutedPeer", function() {
        return kt
    }), n.d(t, "setExecStack", function() {
        return Tt
    }), n.d(t, "favMessage", function() {
        return St
    }), n.d(t, "updateFavMessage", function() {
        return Mt
    }), n.d(t, "updateImportant", function() {
        return Pt
    }), n.d(t, "loadSpam", function() {
        return xt
    }), n.d(t, "flushSpam", function() {
        return It
    }), n.d(t, "setCreationType", function() {
        return Dt
    }), n.d(t, "getOwnerPhoto", function() {
        return At
    }), n.d(t, "presetAvatar", function() {
        return Lt
    }), n.d(t, "setChatPhoto", function() {
        return Rt
    }), n.d(t, "createChat", function() {
        return Bt
    }), n.d(t, "resync", function() {
        return Nt
    }), n.d(t, "toggleSendingAbility", function() {
        return Ut
    }), n.d(t, "setDelayedMessage", function() {
        return Ft
    }), n.d(t, "isAnythingLoading", function() {
        return Ht
    }), n.d(t, "updateUnreadCount", function() {
        return Wt
    }), n.d(t, "changeSubmitSettings", function() {
        return Kt
    }), n.d(t, "updateFavAndTitle", function() {
        return qt
    }), n.d(t, "saveHistoryScroll", function() {
        return zt
    }), n.d(t, "filterFromTab", function() {
        return Gt
    }), n.d(t, "changeDialogsTab", function() {
        return Vt
    }), n.d(t, "updateFolderState", function() {
        return Qt
    }), n.d(t, "toggleDialogImportant", function() {
        return $t
    }), n.d(t, "markDialogAnswered", function() {
        return Xt
    }), n.d(t, "getMutexQueue", function() {
        return Jt
    }), n.d(t, "releaseBlock", function() {
        return Zt
    }), n.d(t, "toggleCommunityMute", function() {
        return en
    }), n.d(t, "deleteDialog", function() {
        return tn
    }), n.d(t, "restoreDialog", function() {
        return nn
    }), n.d(t, "spamDialog", function() {
        return rn
    }), n.d(t, "updateTabbedPeers", function() {
        return on
    }), n.d(t, "isEverythingLoaded", function() {
        return an
    }), n.d(t, "cleanTab", function() {
        return sn
    }), n.d(t, "stringifyTab", function() {
        return cn
    }), n.d(t, "updateGoToEndVisibility", function() {
        return un
    }), n.d(t, "toggleCommunityMessages", function() {
        return ln
    }), n.d(t, "updateHistory", function() {
        return dn
    }), n.d(t, "startRecording", function() {
        return fn
    }), n.d(t, "cancelRecording", function() {
        return pn
    }), n.d(t, "setVoiceMessageAvail", function() {
        return _n
    }), n.d(t, "toggleConversation", function() {
        return mn
    }), n.d(t, "updateSearchQuery", function() {
        return gn
    }), n.d(t, "initializeChatResize", function() {
        return hn
    }), n.d(t, "joinChat", function() {
        return bn
    }), n.d(t, "getInviteLink", function() {
        return vn
    }), n.d(t, "resetInviteLink", function() {
        return yn
    }), n.d(t, "leaveInvitation", function() {
        return On
    }), n.d(t, "saveRecentSearchPeer", function() {
        return wn
    }), n.d(t, "resetRecentSearch", function() {
        return En
    }), n.d(t, "removeFromRecentSearch", function() {
        return Cn
    }), n.d(t, "pinMessageOptimistic", function() {
        return jn
    }), n.d(t, "unpinMessageOptimistic", function() {
        return kn
    }), n.d(t, "pinMessage", function() {
        return Tn
    }), n.d(t, "unpinMessage", function() {
        return Sn
    }), n.d(t, "getPinnedMessage", function() {
        return Mn
    }), n.d(t, "getMessageLocalId", function() {
        return Pn
    }), n.d(t, "getChatMembers", function() {
        return xn
    }), n.d(t, "getChatDetails", function() {
        return In
    }), n.d(t, "updateFlags", function() {
        return Dn
    }), n.d(t, "removeChatPhoto", function() {
        return An
    }), n.d(t, "kickUserOptimisticly", function() {
        return Ln
    }), n.d(t, "kickUser", function() {
        return Rn
    }), n.d(t, "toggleAdminOptimisticly", function() {
        return Bn
    }), n.d(t, "toggleAdmin", function() {
        return Nn
    }), n.d(t, "checkChatMember", function() {
        return Un
    }), n.d(t, "hidePromoTooltip", function() {
        return Fn
    }), n.d(t, "videoAutoPlayHandler", function() {
        return Hn
    }), n.d(t, "hideTopBannerAction", function() {
        return Wn
    }), n.d(t, "callbackTopBannerAction", function() {
        return Kn
    }), n.d(t, "loadBanner", function() {
        return qn
    }), n.d(t, "setKeyboard", function() {
        return zn
    }), n.d(t, "deleteKeyboard", function() {
        return Gn
    }), n.d(t, "toggleKeyboard", function() {
        return Vn
    }), n.d(t, "loadKeyboard", function() {
        return Yn
    }), n.d(t, "changeCommunityAccess", function() {
        return Qn
    }), n.d(t, "deleteTemplate", function() {
        return $n
    }), n.d(t, "createTemplate", function() {
        return Xn
    }), n.d(t, "updateTemplate", function() {
        return Jn
    }), n.d(t, "resetTabAll", function() {
        return Zn
    });
    var r = n(364),
        o = n(80),
        i = n(112),
        a = n(392),
        s = n(187),
        c = n(272),
        u = n(1),
        l = n(192),
        d = n(406),
        f = n(427),
        p = n(66),
        _ = n(219),
        m = n(281),
        g = n(309),
        h = n(440),
        b = n(347),
        v = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        },
        y = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function O(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }

    function w(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
            return n
        }
        return Array.from(e)
    }
    var E = "al_im.php",
        C = 5,
        j = "typing",
        k = "audiomessage",
        T = Object(o.updateLazyLocation)(),
        S = T.scheduleNav,
        M = T.commitNav,
        P = T.scheduleNavWithTimeOut;
    var x = {
        settings: 0,
        block: 1,
        fav: 1,
        chat: 2,
        invite: 2,
        invite_link: 3,
        topic: 3,
        avatar: 4,
        photos: 5,
        search: 6,
        pin_hide: 7,
        pin_unhide: 7,
        unpin: 8,
        mute: 10,
        unmute: 10,
        clear: 11,
        leave: 12,
        return: 12,
        block_community: 12,
        allow_community: 12
    };

    function I(e, t, n) {
        return Object(r.post)(E, {
            act: "a_renew_hash",
            peers: e.join(","),
            gid: t.hidegid ? void 0 : n.gid
        })
    }

    function D(e, t, n) {
        return function(e) {
            return e.resync_in_process ? e.resync_in_process : Promise.resolve(!1)
        }(e).then(function(r) {
            return r ? t.apply(void 0, w(n)) : function(e) {
                if (!e.renew_hashes) {
                    var t = e.last_hashes_update || 0;
                    if (Date.now() - t < 1e4) return Promise.resolve();
                    var n = Object.keys(e.tabs).filter(function(t) {
                        return Object(u.isFullyLoadedTab)(e, t)
                    });
                    e.renew_hashes = I(n, {}, e).then(function(t) {
                        var r = y(t, 2),
                            o = r[0],
                            i = r[1];
                        return n.forEach(function(t) {
                            e.tabs[t].hash = o[t]
                        }), e.writeHash = i, delete e.renew_hashes, e.last_hashes_update = Date.now(), e
                    })
                }
                return e.renew_hashes
            }(e).then(function(e) {
                return t.apply(void 0, w(n))
            })
        })
    }

    function A(e) {
        return function() {
            var t = arguments,
                n = t[t.length - 1];
            return e.apply(void 0, w(t)).catch(function(r) {
                if (r && r.match && r.match(/1001;/)) return D(n, e, t);
                throw r
            })
        }
    }

    function L(e) {
        return "string" == typeof e ? se("<div>" + e + "</div>") : e
    }

    function R(e) {
        return "string" == typeof e ? e : e.innerHTML
    }

    function B(e, t) {
        return t.block_states = extend(t.block_states, e), Promise.resolve(t)
    }

    function N(e, t, n, o, i) {
        return i.tabHistoryNotChanged = !1, Object(a.retryFn)(r.post, 3, function(e) {
            return e - 1
        })(E, {
            act: "a_start",
            peer: e,
            msgid: n,
            history: t,
            prevpeer: i.prevPeer,
            gid: i.gid,
            block: o
        }).then(function(t) {
            var r = y(t, 5),
                o = r[0],
                a = r[1],
                s = r[2],
                c = r[3],
                l = r[4];
            if (a.forEach(function(e) {
                    return Object(p.oCacheAdd)(i, e)
                }), i.tabs || (i.tabs = {}), i.dialog_tab_cts = l, i.tabs[e] || (i.tabs[e] = Object(u.normalizeTab)(i, o)), B(c, i), n) {
                if (i.tabs[e]) {
                    var d = i.tabs[e].lastmsg,
                        f = i.tabs[e].lastmsg_meta;
                    extend(i.tabs[e], o), i.tabs[e].lastmsg = d, i.tabs[e].lastmsg_meta = f
                }
            } else extend(i.tabs[e], o);
            return i.admins = extend(i.admins, s), i.imQueue(e, !1), Hn(), U(e, i)
        }).catch(function(e) {
            return Object(_.imWeirdCatch)("loadPeer", e)
        })
    }

    function U(e, t) {
        var n = t.imQueue(e, !1),
            r = t.tabs[e],
            o = n.filter(function(n) {
                return !Object(d.isRidExist)(t, e, n.rid)
            });
        return r.msgs = o.reduce(function(e, t) {
            return e["rid" + t.rid] = t.mess, e
        }, r.msgs), t.imQueueSet(e, o), t.tabs[e].history = Object(u.restoreQueue)(o, t, L(t.tabs[e].history)), Promise.resolve(t)
    }

    function F(e, t, n) {
        var r = n.imQueue(e, !1).filter(function(e) {
            return e.failed && e.mess.messageId !== t
        });
        return n.imQueueSet(e, r), n.tabs[e].history = Object(u.removeMessages)([t], L(n.tabs[e].history)), Promise.resolve(n)
    }

    function H(e, t) {
        return !1 === (t.block_states[e] || {}).free ? Promise.resolve(t) : Object(r.post)(E, {
            act: "a_block",
            peer: e,
            prevPeer: t.prevPeer,
            gid: t.gid
        }).then(function(e) {
            return B(y(e, 1)[0], t)
        })
    }

    function W(e, t) {
        var n = t.peer;
        return Promise.resolve(t).then(function(t) {
            return t.tabHistoryNotChanged = !1, Object(u.isFullyLoadedTab)(t, n) && !t.tabs[n].msgid ? (t.gid && H(n, t), Promise.resolve(t).then(V)) : (Object(u.isFullyLoadedTab)(t, n) && (t.tabs[n].msgid = !1), N(n, e, !1, !0, t))
        }).then(V).then(K.bind(null, n))
    }

    function K(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
        return Object(u.isTabLoaded)(t, e) && (t.tabs[e].last_touched = Date.now()), Object(u.isTabLoaded)(t, e) && n && (t.tabs[e].last_visited = Date.now()), t
    }

    function q(e, t, n) {
        var r = n.msgid,
            o = n.peer;
        return !e && Object(u.isFullyLoadedTab)(n, o) && n.tabs[o].msgs[r] ? (t === n.peer ? n.tabHistoryNotChanged = !0 : n.tabHistoryNotChanged = !1, n.gid && H(o, n), Promise.resolve(n).then(V).then(K.bind(null, o))) : N(o, !0, r, !0, n).then(V).then(function() {
            return Object(d.getTab)(n, o).msgid = r, n
        }).then(K.bind(null, o))
    }

    function z(e, t, n, r) {
        if (Ht(r)) throw Object(u.showWaitUntilUploadedBox)(), new Error("Cant change peer while loading something");
        var o = r.gid ? "gim" + r.gid : "im";
        if (r.prevPeer = r.peer, r.peer = e, r.msgid = t || "", r.currentEntryPoint = n, cur.peer = e, S({
                sel: e ? Object(u.convertPeerToUrl)(e) : null,
                msgid: r.msgid,
                email: "",
                0: o
            }), 0 != r.prevPeer && K(r.prevPeer, r, !0), 0 !== e) {
            Object(u.isTabLoaded)(r, e) && K(e, r, !0), on(r.tabbedPeers.map(function(e) {
                return e.peer
            }).indexOf(e) < 0 ? [{
                peer: e,
                type: "perm"
            }].concat(r.tabbedPeers) : r.tabbedPeers.map(function(t) {
                return t.peer == e && "perm" !== t.type && (t.type = "perm"), t
            }), !1, r)
        } else on(r.tabbedPeers, !1, r);
        return M(), Ve(r.prevPeer, r)
    }

    function G(e) {
        cur.wallMentions = function() {
            return new Promise(function(t, n) {
                if (cur.wallMentions = [], !Object(u.isChatPeer)(e.peer) || !Object(u.isFullyLoadedTab)(e, e.peer) || Object(u.isFvkcomgroup)(e, e.peer)) return n();
                var r = e.tabs[e.peer];

                function o() {
                    var n = [];
                    Object.keys(r.msgs || {}).reverse().forEach(function(e) {
                        var t = Object(d.parserMessage)(r.msgs[e]),
                            o = t && t.userId;
                        o && o != vk.id && -1 === n.indexOf(o) && Object(u.isUserAliveInChat)(r, o) && n.push(o)
                    }), (r.memberIds || []).forEach(function(e) {
                        -1 === n.indexOf(e) && n.push(e)
                    });
                    var o = [];
                    n.forEach(function(t) {
                        if (Object(p.oCacheExists)(e, t)) {
                            var n = Object(p.oCacheGet)(e, t),
                                r = n.link.substring(1);
                            o.push([n.id, n.name, "@" + r, n.photo, void 0, void 0, void 0, r, n.first_name])
                        }
                    }), t(o)
                }
                r.membersLoaded ? o() : xn(e.peer, e).then(o)
            })
        }
    }

    function V(e) {
        var t = e.peer;
        if (0 === t) return Promise.resolve(e);
        var n = e.tabs[t],
            r = [],
            o = Object(u.isChatPeer)(t) && (n.data.closed || n.data.kicked),
            i = Object(u.isFvkcomgroup)(e, t);
        n.offset && r.push("photos"), n.offset && r.push("search"), (t < -2e9 || n.offset) && !i && r.push("clear"), Object(u.isCommunityInterface)(e) && !i && r.push("block"), i && !o && r.push("settings"), Object(u.isCommunityPeer)(t) && (n.blocked_community ? r.push("allow_community") : r.push("block_community")), (Object(u.isChatPeer)(t) || Object(u.isUserPeer)(t) || Object(u.isCommunityPeer)(t)) && !Object(u.isCommunityInterface)(e) && (Object(u.isChatPeer)(t) && (n.data.kicked || n.data.closed) || (inArray(t, e.mutedPeers) ? r.push("unmute") : r.push("mute"))), Object(u.isUserPeer)(t) && !e.gid && !n.blacklisted && n.is_friend && r.push("invite"), Object(u.isChatPeer)(t) && !o && (Object(g.canInviteUser)(e) && r.push("invite"), e.gid || r.push("leave")), Object(u.isChatPeer)(t) && n.data.closed && !n.data.kicked && r.push("return"), Object(u.isChatPeer)(t) && n.pinned && (r.push(Object(m.isPinnedMessageVisibleInTab)(e, t) ? "pin_hide" : "pin_unhide"), Object(g.canPinOrUnpin)(e) && r.push("unpin"));
        var a = Object(u.chatActions)(e, i);
        return e.curActions = r.sort(function(e, t) {
            return x[e] - x[t]
        }).reduce(function(e, t) {
            return e[t] = a[t], e
        }, {}), Promise.resolve(e)
    }

    function Y(e, t, n) {
        var o = n.tabs[n.peer];
        return Object(r.post)(E, {
            peer: n.peer,
            whole: e,
            act: "a_history",
            offset: o.offset + (o.skipped || 0),
            toend: t,
            gid: n.gid
        }).then(function(e) {
            var t = y(e, 4),
                r = t[0],
                i = t[1],
                a = t[2],
                s = t[3];
            return o.allShown = a, n.admins = extend(n.admins, s), o.history = r + R(o.history), o.historyToAppend = r, o.offset += Object.keys(i).length, o.msgs = extend(o.msgs, i), n
        })
    }

    function Q(e) {
        var t = e.tabs[e.peer];
        return Object(r.post)(E, {
            peer: e.peer,
            act: "a_history",
            rev: 1,
            offset: t.skipped,
            gid: e.gid
        }).then(function(n) {
            var r = y(n, 5),
                o = r[0],
                i = r[1],
                a = r[2];
            r[3], r[4];
            t.allShown = t.allShown || a, t.history = R(t.history) + o, t.historyToAppend = o;
            var s = Object.keys(i).length;
            return t.skipped -= s, t.offset += s, t.msgs = extend(t.msgs, i), e
        })
    }

    function $(e, t, n, r) {
        var o = e.tabs[t];
        return r === i.FLAG_OUTBOUND && o.out_up_to > n ? e : (r === i.FLAG_OUTBOUND ? o.out_up_to = n : o.in_up_to = n, e)
    }
    var X = A(function(e, t) {
        if (Object(u.tabIsMessageRequest)(t.tabs[e])) return Promise.resolve(t);
        var n = t.tabs[e],
            o = n.msgs || {},
            a = Object.keys(o).map(function(n) {
                return Object(d.getMessage)(t, e, n)
            }).filter(function(e) {
                return !Object(f.isOut)(e)
            }).map(function(e) {
                return e.messageId
            }).sort(function(e, t) {
                return t - e
            });
        return n.skipped > 0 && (a = a.filter(function(e) {
            return intval(e) <= n.lastmsg - n.skipped
        })), (a = intval(a.shift())) <= n.in_up_to ? Promise.resolve(t) : (t.longpoll.push([i.readInboundEvent([6, e, a])]), Object(r.post)(E, {
            peer: e,
            ids: [a],
            hash: n.hash,
            act: "a_mark_read",
            gid: t.gid
        }).then(function() {
            return $(t, e, a, i.FLAG_OUTBOUND)
        }))
    });

    function J(e) {
        return Object(r.post)(E, {
            act: "a_get_key",
            uid: e.id,
            gid: e.gid
        }).then(function(t) {
            var n = y(t, 3),
                r = n[0],
                o = n[1],
                i = n[2];
            return extend({}, e, {
                imKey: r,
                imUrl: o,
                imPart: i
            })
        })
    }

    function Z(e) {
        return Object(r.post)(E, {
            act: "a_get_ts",
            gid: e.gid
        }).then(function(t) {
            var n = y(t, 1)[0];
            return extend({}, e, {
                imTs: n
            })
        })
    }

    function ee(e, t, n) {
        var r = n.tabs[e];
        return r.msgs[t.messageId] && (r.msgs[t.messageId].errored = 1, r.history = Object(u.setMessageError)(e, t, L(r.history))), Promise.resolve(n)
    }

    function te(e, t, n, r) {
        var o = r.tabs[e];
        return o.msgs[t] && (o.msgs[t].errored = 0, o.lastmsg_meta = n, o.lastmsg = t, o.history = Object(u.startResendMessage)(e, t, L(o.history))), Promise.resolve(r)
    }

    function ne(e, t, n, r) {
        var o = arguments.length > 4 && void 0 !== arguments[4] && arguments[4];
        t.deletedDialog || (e.dialog_tabs = Object.keys(e.dialog_tabs).reduce(function(e, i) {
            return !n && !Gt(i)(t) || o && !o(i, e[i], t) || (e[i] = Object(s.arrayUnique)(r(e[i], i))), e
        }, e.dialog_tabs))
    }

    function re(e, t) {
        return 0 === e.length ? Promise.resolve(t) : Object(r.post)(E, {
            act: "a_get_admin",
            admins: e.join(","),
            gid: t.gid
        }).then(function(e) {
            var n = y(e, 1)[0];
            return t.admins = extend(t.admins, n), t
        })
    }

    function oe(e, t) {
        if (!inArray(e, t.tabbedPeers.map(function(e) {
                return e.peer
            })) && (0 !== t.peer || t.searchText) && !inArray(e, t.mutedPeers)) {
            var n = {
                peer: e,
                type: "temp"
            };
            on(t.tabbedPeers.concat([n]), !1, t)
        }
    }

    function ie(e, t, n) {
        return Object(u.isReversedDialogs)(n) ? t.concat([e]) : [e].concat(t)
    }

    function ae(e, t) {
        var n = e.get().peer,
            r = Object(d.getTab)(e, n);
        if (Object(u.isFullyLoadedTab)(e, n)) {
            var o = L(r.history);
            r.history = Object(u.updateMessageInCache)(e, o, t)
        }
    }

    function ce(e, t) {
        var n = Object(d.getTab)(t, e.peerId);
        if (Object(u.isFullyLoadedTab)(t, e.peerId)) {
            var r = L(n.history);
            n.msgs[e.messageId] = extend(!0, {}, e), n.history = Object(u.editAndReplaceMessage)(t, e, r)
        }
        n && n.lastmsg == e.messageId && (n.lastmsg_meta = e);
        var o = n && n.pinned && Object(d.parserMessage)(n.pinned);
        return o && o.messageId == e.messageId && (n.pinned = e), Promise.resolve(t)
    }

    function ue(e, t) {
        var n = e.flags & i.FLAG_OUTBOUND,
            r = e.peerId;
        if (Object(u.isTabLoaded)(t, r)) {
            var o = t.tabs[r];
            if (o.deletedDialog = !1, !t.msg_local_ids_sort && e.local ? t.msg_local_ids_sort = O({}, e.messageId, 0) : e.local && (t.msg_local_ids_sort[e.messageId] = Object.keys(t.msg_local_ids_sort).length), n ? o.unread = 0 : (o.lastmsg == e.messageId && o.unread ? le(t, 1, e.peerId) : (!o.unread && le(t, 1, e.peerId), o.unread++), oe(e.peerId, t)), Object(u.isFullyLoadedTab)(t, r)) {
                var a = L(o.history);
                o.skipped > 0 && o.skipped++, o.offset++, o.msgs[e.messageId] = extend(!0, {}, e), o.history = Object(u.appendToHistory)(t, e, a, !0, !0, !0), Object(f.isOut)(e) && (o.blocked_community = 0, V(t))
            }
            if (o.typing) {
                var s = o.typing.userIds.indexOf(e.userId);
                s >= 0 && o.typing.userIds.splice(s, 1)
            }
            return o.lastmsg = e.messageId, o.lastmsg_meta = e, K(e.peerId, t), ne(t, o, !1, ie.bind(null, r), Yt.bind(null, t)), Promise.resolve(t)
        }
        return N(r, 0, 0, 0, t).then(function(t) {
            return ne(t, t.tabs[r], !1, ie.bind(null, r), Yt.bind(null, t)), K(e.peerId, t), n || oe(e.peerId, t), t
        })
    }

    function le(e, t, n) {
        e.cur_unread_cnt || (e.cur_unread_cnt = {}), -1 === t && delete e.cur_unread_cnt[n], e.unread_cnt += t
    }

    function de(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e.peerId)) {
            var n = t.tabs[e.peerId],
                r = n.unread;
            if (t = $(t, e.peerId, e.upToId, 0), null != e.unread ? n.unread = e.unread : n.unread = e.upToId >= n.lastmsg ? 0 : Object(d.countUnread)(e.peerId, t) + (n.unread > 0 ? +n.skipped : 0), r > 0 && !n.unread && le(t, -1, e.peerId), !n.skipped) {
                var o = L(n.history);
                n.history = Object(u.removewNewUnreadBarAndMerge)(t, o, e.peerId)
            }
        } else Object(u.isTabLoaded)(t, e.peerId) && (t.tabs[e.peerId].unread > 0 && le(t, -1, e.peerId), t.tabs[e.peerId].unread = 0, t.tabs[e.peerId].in_up_to = e.upToId);
        return Object(u.isTabLoaded)(t, e.peerId) && (t.dialog_tabs[l.FOLDER_UNREAD] = t.dialog_tabs[l.FOLDER_UNREAD].filter(function(t) {
            return intval(t) !== e.peerId
        })), 0 !== t.unread_cnt || t.active_tab !== l.FOLDER_UNREAD || t.gid ? Promise.resolve(t) : Vt(l.FOLDER_ALL, t)
    }

    function fe(e, t) {
        var n = t.tabs[e.peerId];
        if (Object(u.isTabLoaded)(t, e.peerId) && $(t, e.peerId, e.upToId, i.FLAG_OUTBOUND), Object(u.isFullyLoadedTab)(t, e.peerId)) {
            var r = L(n.history);
            n.history = Object(u.markMessagesAsRead)(t, e.peerId, r)
        }
        return Promise.resolve(t)
    }

    function pe(e, t, n, r, o) {
        return o.text = {}, o.imQueue = e, o.imQueueResend = t, o.imQueueSet = n, o.imQueueComplete = r, Promise.resolve(o)
    }

    function _e(e, t, n) {
        function r(e, t) {
            return {
                id: e.messageId,
                text: e.text,
                date: e.date,
                kludges: e.kludges,
                authorName: t
            }
        }
        if (1 === e.length) {
            var o = e[0],
                i = Object(d.getMessage)(n, t, o),
                a = Object(d.getAuthorFullName)(n, t, o);
            return !1 === a ? n.set(bt.bind(null, O({}, t, [i.userId]))).then(function(n) {
                var a = Object(d.getAuthorFullName)(n, t, o);
                return {
                    msgIds: e,
                    object: r(i, a)
                }
            }) : Promise.resolve({
                msgIds: e,
                object: r(i, a)
            })
        }
        return Promise.resolve({
            msgIds: e
        })
    }

    function me(e, t) {
        Object(u.normalizeTabsGotFromServer)(t, e);
        var n = t.tabs[t.peer];
        return t.tabs = Object.keys(e).reduce(function(n, r) {
            var o = t.tabs[r] ? t.tabs[r].msgs : {},
                i = extend({}, o || {}, e[r].msgs || {});
            return n[r] = extend(t.tabs[r] || {}, e[r]), i && (n[r].msgs = i), e[r].lastmsg || (n[r].lastmsg = !1), n
        }, t.tabs), n && (t.tabs[t.peer] = n), Promise.resolve(t)
    }

    function ge(e, t, n, r) {
        var o = Object(d.getTab)(r, e);
        if (o) {
            var i = !1 !== t ? mobPlatforms[t] ? 1 : 0 : o.last_seen[2];
            o.online = t, o.last_seen = [t, n || o.last_seen[1], i]
        }
        return Promise.resolve(r)
    }

    function he(e, t, n) {
        var r = Object(d.getTab)(n, e.peerId);
        return r && (e.ts = Date.now() / 1e3, r.activity || (r.activity = {}), r.activity[t] = e, r.typing === j && (r.typing = e)), Promise.resolve(n)
    }

    function be(e, t, n) {
        var r = e.peerId;
        return Object(a.pause)(C + 2).then(function() {
            if (Object(u.isTabLoaded)(n, r)) {
                var e = n.tabs[r];
                if ((e.activity || {})[t]) Date.now() - 1e3 * e.activity[t].ts >= 1e3 * C && (delete e.activity[t], 0 === Object.keys(e.activity) && delete e.activity);
                if (e.typing) Date.now() - 1e3 * e.typing.ts >= 1e3 * C && (e.typing = void 0)
            }
            return n
        })
    }

    function ve(e) {
        var t = {},
            n = e.find(function(e) {
                return "poll" === e[0]
            });
        if (n) {
            var r = y(n, 3)[2];
            Object.assign(t, r)
        }
        return t
    }

    function ye(e) {
        return e.map(function(e) {
            var t = "audiomsg" === e[2] ? "audio_message" : e[2];
            return e[0] + ":" + e[1] + ":" + t
        }).join(",")
    }
    var Oe = function(e, t, n, o) {
            var i = Date.now() + rand(0, 100).toFixed(0),
                a = o.ref_id,
                s = o.ref_source;
            o.ref_source = void 0, o.ref_id = void 0, (s || a) && (S({
                ref_source: null,
                ref: null
            }), M()), Object(h.statlogsSendingQueueLength)(o);
            var c = t.attaches.length > 0,
                u = Object(h.statlogsSendingTime)(o, "send", "server", c),
                l = Object.assign({
                    act: "a_send",
                    to: e,
                    hash: n.hash,
                    ref_source: s,
                    ref: a,
                    msg: t.message,
                    payload: t.payload,
                    media: ye(t.attaches),
                    guid: i,
                    share_url: t.share_url,
                    cancelled_shares: t.cancelled_shares,
                    random_id: t.rid,
                    gid: n.hidegid ? void 0 : o.gid,
                    entrypoint: o.currentEntryPoint || "",
                    sticker_referrer: t.sticker_referrer
                }, n.external, ve(t.attaches));
            return Object(r.post)(E, l, 2e4).then(function(e) {
                var t = y(e, 1)[0];
                return u(), o.version !== t.version && nav.reload({
                    force: !0
                }), o.currentEntryPoint = "", o
            }).catch(function(e) {
                throw Object(h.statlogsSendingError)(o, e, "send", "server_send"), e
            })
        },
        we = A(function(e, t) {
            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                r = arguments[3],
                o = r.tabs[e];
            return Oe(e, t, v({
                hash: o.hash
            }, n), r)
        }),
        Ee = A(function(e, t, n) {
            var o = t.attaches.length > 0,
                i = Object(h.statlogsSendingTime)(n, "edit", "server", o);
            return Object(r.post)(E, Object.assign({
                act: "a_edit_message",
                hash: e.hash,
                id: t.messageId,
                peerId: e.peerId,
                gid: n.gid,
                msg: t.origText,
                media: ye(t.attaches),
                share_url: t.share_url,
                cancelled_shares: t.cancelled_shares
            }, ve(t.attaches)), 2e4).then(function(e) {
                y(e, 1)[0];
                return i(), n
            }).catch(function(e) {
                throw Object(h.statlogsSendingError)(n, e, "edit", "server_send"), e
            })
        });

    function Ce(e, t) {
        if (t.selectedMessages || (t.selectedMessages = []), 1 === e.length && inArray(e[0], t.selectedMessages)) t.selectedMessages = t.selectedMessages.filter(function(t) {
            return t !== e[0]
        });
        else {
            var n = t.selectedMessages.concat(e);
            t.selectedMessages = Object(s.arrayUnique)(n).sort(function(e, t) {
                return e - t
            })
        }
        return Promise.resolve(t)
    }

    function je(e) {
        return e.selectedMessages = [], Promise.resolve(e)
    }

    function ke(e) {
        return e.selectedMessages = [], Promise.resolve(e)
    }

    function Te(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e.peerId)) {
            var n = t.tabs[e.peerId],
                r = t.imQueue(e.peerId).filter(function(t) {
                    return t.failed && t.rid !== e.randomId
                });
            t.imQueueSet(e.peerId, r), t.imQueueComplete(e.peerId, e.randomId), n.lastmsg_meta = e, n.lastmsg = e.messageId, n.msgs["rid" + e.randomId] && (n.msgs[e.messageId] = e, delete n.msgs["rid" + e.randomId]), n.history = Object(u.replaceMessageAttrs)(t, L(n.history), e)
        }
        return Promise.resolve(t)
    }

    function Se(e, t) {
        return Promise.resolve()
    }

    function Me(e, t) {
        var n = Object(h.statlogsSendingTime)(t, "unknown", "attach"),
            o = {
                act: "a_get_media",
                id: e.messageId,
                gid: t.gid
            };
        return Object(a.retryFn)(r.post, 3, function(e) {
            return e * e
        })(E, o).then(function(r) {
            return n(), Pe(e, r, t)
        }).catch(function(n) {
            return Object(h.statlogsSendingError)(t, n, "unknown", "server_load_attach"), Pe(e, null, t)
        })
    }

    function Pe(e, t, n) {
        var r = n.tabs[e.peerId];
        return r.mediacontent || (r.mediacontent = {}), r.mediacontent[e.messageId] = t || [getTemplate("im_retry_link")], xe(e, n)
    }

    function xe(e, t) {
        var n = t.tabs[e.peerId];
        return n.history = Object(u.replaceAttaches)(L(n.history), e, t), Promise.resolve(t)
    }

    function Ie(e, t, n) {
        var r = Object(u.dayFromVal)(t),
            o = n.tabs[e];
        return o.searchDay = r, o.searchOffset = 0, o.searchAllLoaded = !1, Promise.resolve(n)
    }

    function De(e, t, n) {
        return n.tabs[t].searchText = e, Qe(t, n), n
    }

    function Ae(e, t, n) {
        if (t) {
            var r = n.tabs[t];
            r.searchText = e, r.searchOffset = 0, r.searchAllLoaded = !1
        } else n.searchText = e, n.searchOffset = 0, n.searchAllLoaded = !1;
        return Promise.resolve(n)
    }

    function Le(e, t, n, o, i) {
        return Object(r.post)(E, {
            act: "a_hints",
            str: e,
            gid: o.hidegid ? 0 : i.gid,
            query: n,
            peerIds: t.join(",")
        }).then(function(e) {
            var t = y(e, 3),
                n = t[0],
                r = t[1];
            return B(t[2], i), r.forEach(function(e) {
                return Object(p.oCacheAdd)(i, e)
            }), me(n, i), Object.keys(n).sort(function(e, t) {
                return n[e].order - n[t].order
            }).map(function(e) {
                return n[e]
            })
        })
    }

    function Re(e, t, n, r) {
        return Le(e, t, n, {}, r).then(function(e) {
            return e.map(function(e) {
                return {
                    peerId: e.peerId,
                    name: e.tab,
                    photo: e.photo,
                    online: e.online,
                    is_friend: "friends" === n
                }
            })
        })
    }

    function Be(e) {
        var t = {
            peerId: e[0],
            name: e[1],
            tab: e[1],
            photo: e[2],
            href: e[3],
            online: e[4],
            is_friend: e[5],
            local_index: !0
        };
        return e[6] && (t.data = {
            flags: e[6]
        }), t
    }

    function Ne(e) {
        return function(t, n) {
            return e(n).then(function(e) {
                var r = (t ? e.search(t) : e.list).map(Be);
                return n.mapped_index || (n.mapped_index = {}), r.forEach(function(e) {
                    n.mapped_index[e.peerId] = e
                }), r
            })
        }
    }
    var Ue = Ne(function(e) {
            return e.topConvTree
        }),
        Fe = Ne(function(e) {
            return e.imTopConvTree
        }),
        He = Ne(function(e) {
            return e.hintsTree
        });

    function We(e, t) {
        var n = void 0,
            o = void 0,
            i = void 0;
        t.topConvTree = new Promise(function(e) {
            n = e
        }), t.hintsTree = new Promise(function(e) {
            o = e
        }), t.imTopConvTree = new Promise(function(e) {
            i = e
        });
        var s = e.select(c.RECENT_SEARCH_OP);
        return Object(a.retryFn)(r.post, 1, function() {
            return 4
        })(E, {
            act: "a_dialogs_preload",
            rs: s.join(","),
            gid: t.gid
        }).catch(function(e) {
            return [
                [],
                [],
                []
            ]
        }).then(function(e) {
            var r = y(e, 4),
                a = r[0],
                s = r[1],
                c = r[2],
                u = r[3];
            return t.popular_sugg = c, new vkIndexer(a, function(e) {
                return e[1]
            }, n), new vkIndexer(s, function(e) {
                return e[1]
            }, o), u && u.length > 0 ? new vkIndexer(u, function(e) {
                return e[1]
            }, i) : i(), t
        })
    }

    function Ke(e) {
        var t = e.active_tab,
            n = void 0;
        return n = e.dialog_tabs[t].length > 0 ? Math.min.apply(null, e.dialog_tabs[t].map(function(t) {
            return e.tabs[t].lastmsg
        })) : 0, Object(r.post)(E, {
            act: "a_get_dialogs",
            start_message_id: n,
            tab: t,
            gid: e.gid
        }).then(function(n) {
            var r = y(n, 4),
                o = r[0],
                i = r[1],
                a = r[2],
                s = r[3];
            return a.forEach(function(t) {
                return Object(p.oCacheAdd)(e, t)
            }), B(s, e), me(i, e), e.dialog_tabs[t] = e.dialog_tabs[t].concat(Object.keys(i).map(intval)), e.dialog_tabs_all[t] = !o.has_more, Promise.resolve(e)
        })
    }
    var qe = A(function(e, t) {
        return Object(r.post)(E, {
            act: "a_search",
            q: e,
            from: "all",
            gid: t.gid,
            hash: t.writeHash,
            offset: t.searchOffset || 0
        }).then(function(n) {
            var r = y(n, 5),
                o = r[0],
                i = r[1],
                a = r[2],
                s = r[3],
                c = r[4];
            return i.forEach(function(e) {
                return Object(p.oCacheAdd)(t, e)
            }), Object(u.normalizeTabsGotFromServer)(t, o), e === t.searchText && (t.searchOffset = s, t.searchAllLoaded = c), Object.keys(o).filter(function(e) {
                return !t.tabs[e]
            }).forEach(function(e) {
                t.tabs[e] = o[e]
            }), [o, a]
        })
    });

    function ze(e, t) {
        return t.tabs[e].searchAllLoaded
    }

    function Ge(e, t) {
        return !(t.peer !== e || !Object(u.isFullyLoadedTab)(t, e)) && t.tabs[e].inplaceSearch
    }

    function Ve(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e)) {
            var n = t.tabs[e];
            delete n.inplaceSearch, delete n.searchOffset, delete n.searchAllLoaded, delete n.searchText, delete n.searchDay, S({
                st: ""
            }), M()
        }
        return Promise.resolve(t)
    }

    function Ye(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e)) {
            var n = t.tabs[e];
            delete n.searchDay, n.searchOffset = 0, n.searchAllLoaded = !1
        }
        return Promise.resolve(t)
    }

    function Qe(e, t) {
        return t.tabs[e].inplaceSearch = !0, Promise.resolve(t)
    }
    var $e = A(function(e, t) {
        var n = t.tabs[e],
            o = "";
        if (Qe(e, t), n.searchDay && (o = "day:" + n.searchDay), !o && !n.searchText) return Promise.reject();
        var i = "in:" + e + " " + o + " " + (n.searchText || "");
        return S({
            st: n.searchText
        }), M(), Object(r.post)(E, {
            act: "a_search",
            q: i,
            from: "in",
            gid: t.gid,
            hash: t.writeHash,
            offset: n.searchOffset || 0
        }).then(function(e) {
            var t = y(e, 3),
                r = t[0],
                o = t[1],
                i = t[2];
            return n.searchOffset = o, n.searchAllLoaded = i, r
        })
    });

    function Xe(e) {
        return Object(r.post)(E, {
            act: "a_important",
            offset: e,
            part: e > 0
        })
    }

    function Je(e, t) {
        var n = Object(d.getTab)(e, t);
        return Object(r.post)(E, {
            act: "a_load_lastmsg",
            peerId: t,
            gid: e.get().gid
        }).then(function(r) {
            var o = y(r, 2),
                i = o[0],
                a = o[1];
            n.lastmsg = i[0] || !1, n.lastmsg_meta = i;
            var s = y(a, 3);
            n.unread = s[0], n.in_up_to = s[1], n.out_up_to = s[2], n.unread || (e.get().dialog_tabs[l.FOLDER_UNREAD] = e.get().dialog_tabs[l.FOLDER_UNREAD].filter(function(e) {
                return e != t
            })), ne(e.get(), n, !1, ie.bind(null, t), Yt.bind(null, e.get()))
        })
    }

    function Ze(e, t, n) {
        if (Object(u.isFullyLoadedTab)(n, t)) {
            var r = n.tabs[t];
            r.deleted = r.deleted ? r.deleted.concat(e) : e
        }
        return Promise.resolve(n)
    }

    function et(e, t, n) {
        if (Object(u.isFullyLoadedTab)(n, t)) {
            var r = n.tabs[t];
            r.history = Object(u.removeMessages)(e, L(r.history)), r.offset -= e.filter(function(e) {
                return r.msgs[e]
            }).length, e.forEach(function(e) {
                return delete r.msgs[e]
            }), e.forEach(function(e) {
                var t = (n.selectedMessages || []).indexOf(e); - 1 != t && n.selectedMessages.splice(t, 1)
            })
        }
        return Promise.resolve(n)
    }
    var tt = A(function(e, t, n, o, i) {
        return Object(r.post)(E, {
            act: "a_mark",
            peer: t,
            hash: n || i.tabs[t].hash,
            gid: i.gid,
            msgs_ids: e.join(","),
            mark: o
        })
    });

    function nt(e, t, n, r) {
        if (Object(u.isFullyLoadedTab)(r, t)) {
            var o = r.tabs[t];
            o.deleted = o.deleted ? o.deleted.concat(e) : e, o.history = Object(u.removeMessagesWithRestore)(e, t, n, L(o.history)), o.offset -= e.filter(function(e) {
                return o.msgs[e]
            }).length
        }
        return Promise.resolve(r)
    }

    function rt(e, t, n) {
        if (Object(u.isFullyLoadedTab)(n, t)) {
            var r = n.tabs[t];
            r.deleted && (r.deleted = r.deleted.filter(function(t) {
                return t !== e
            })), r.history = Object(u.restoreMessage)(e, t, L(r.history)), r.offset++
        }
        return Promise.resolve(n)
    }

    function ot(e, t, n, o) {
        return Object(r.post)(E, {
            act: "a_restore",
            id: e,
            peer: t,
            hash: n,
            gid: o
        })
    }
    var it = A(function(e, t, n) {
            return Object(u.tabIsMessageRequest)(n.tabs[e]) ? Promise.resolve(n) : (n.tabs[e].lastTyping = Date.now(), Object(r.post)(E, {
                act: "a_activity",
                type: t,
                peer: e,
                gid: n.gid,
                hash: n.tabs[e].hash
            }).then(function() {
                return n
            }, function() {
                return n
            }))
        }),
        at = A(function(e, t) {
            return Object(r.post)(E, {
                act: "a_accept_message_request",
                user_id: e,
                hash: t.tabs[e].hash
            }).then(function() {
                t.tabs[e].is_message_request = !1
            }).then(function() {
                return t
            })
        }),
        st = A(function(e, t) {
            return Object(r.post)(E, {
                act: "a_reject_message_request",
                user_id: e,
                hash: t.tabs[e].hash
            }).then(function() {
                return ne(t, t.tabs[e], !0, function(t) {
                    return t.filter(function(t) {
                        return t !== e
                    })
                }), on(t.tabbedPeers.filter(function(t) {
                    return t.peer !== e
                }), !0, t), t.tabs[e].unread = 0, t.tabs[e].lastmsg = !1, t.tabs[e].lastmsg_meta = null, t
            })
        }),
        ct = A(function(e, t) {
            return it(e, j, t)
        }),
        ut = A(function(e, t) {
            return it(e, k, t)
        });

    function lt(e, t, n, r) {
        return t && (r.pendingForward = null, e || (e = {
            msgIds: []
        }), t.addAttach(n ? "reply" : "mail", e.msgIds.join(";"), e.object || null)), Promise.resolve(r)
    }

    function dt(e, t) {
        return t.pendingForward = e, Promise.resolve(t)
    }

    function ft(e, t, n) {
        if (Object(u.isTabLoaded)(n, e)) {
            n.blockedFlagUpdates || (n.blockedFlagUpdates = {}), n.blockedFlagUpdates[e] = !0, ne(n, n.tabs[e], !0, function(t) {
                return t.filter(function(t) {
                    return t !== e
                })
            }), n.tabs[e].unread > 0 && le(n, -1, e);
            var r = n.tabs[e];
            return r.deletedDialog = !0, on(n.tabbedPeers.filter(function(t) {
                return t.peer !== e
            }), !0, n), t.then(function(t) {
                var o = y(t, 2);
                o[0], o[1];
                return delete n.blockedFlagUpdates[e], r.msgs = null, r.history = null, r.unread = 0, r.lastmsg = !1, r.lastmsg_meta = null, n
            })
        }
    }
    var pt = A(function(e, t) {
            return ft(e, Object(r.post)("al_im.php", {
                act: "a_flush_history",
                id: e,
                from: "im",
                gid: t.gid,
                hash: t.tabs[e].hash
            }), t)
        }),
        _t = A(function(e, t, n) {
            return Object(r.post)(E, {
                act: "a_set_chat_title",
                peer: e,
                new_title: t,
                gid: n.gid,
                hash: n.tabs[e].hash
            }).then(function() {
                return n
            })
        }),
        mt = A(function(e, t) {
            return Object(r.post)(E, {
                act: "a_load_chat_info",
                peer: e,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(function(n) {
                var r = y(n, 1)[0];
                return t.tabs[e] = extend(t.tabs[e], r), t
            })
        });

    function gt(e, t, n) {
        var r = n.tabs[e];
        return r.memberIds = [].concat(r.memberIds, t).filter(function(e, t, n) {
            return n.indexOf(e) === t
        }), r.membersCount = r.memberIds.length, Promise.resolve(n)
    }
    var ht = A(function(e, t, n) {
        return Object(r.post)(E, {
            act: "a_add_chat_members",
            peer: e,
            new_peer: t.join(","),
            gid: n.gid,
            hash: n.tabs[e].hash
        }).then(function(e) {
            return n
        })
    });

    function bt(e, t) {
        if (isEmpty(e)) return Promise.resolve(t);
        var n = Object.keys(e).map(function(t) {
            return t + ":" + e[t].join(",")
        }).join(";");
        return Object(r.post)(E, {
            act: "a_load_member",
            need: n
        }).then(function(e) {
            return y(e, 1)[0].forEach(function(e) {
                return Object(p.oCacheAdd)(t, e)
            }), t
        })
    }

    function vt(e, t, n) {
        var r = {},
            o = n.get();

        function a(e, t) {
            Object(u.isChatPeer)(e) && t && !Object(p.oCacheExists)(o, t) && (r[e] ? -1 === r[e].indexOf(t) && r[e].push(t) : r[e] = [t])
        }
        var s = t.filter(function(e) {
            return !Object(u.isTabLoaded)(o, e.peerId)
        }).map(function(e) {
            return e.peerId
        });
        t.forEach(function(e) {
            a(e.peerId, e.userId)
        }), e.forEach(function(e) {
            a(e.peerId, +e.kludges.source_mid)
        });
        var c = t.filter(function(e) {
            return e.flags & i.FLAG_OUTBOUND && !e.local
        }).map(function(e) {
            return e.kludges.from_admin
        }).filter(function(e) {
            return e && !o.admins[e]
        });
        return 0 === Object.keys(r).length && 0 === c.length && 0 === s.length ? Promise.resolve(o) : {
            shouldLoad: Object.keys(r).length > 0 || c.length > 0 || s.length > 0,
            needMembers: r,
            needAdminIds: c,
            needPeers: s
        }
    }

    function yt(e, t, n) {
        var r = e.needMembers,
            o = e.needAdminIds,
            i = e.needPeers;
        return t.pause(), Promise.all([bt(r, n), re(o, n), Promise.all(i.map(function(e) {
            return N(e, 0, 0, 0, n)
        }))]).catch(function() {
            return n
        }).then(function() {
            return t.resume()
        }).then(function() {
            return n
        })
    }
    var Ot = A(function(e, t) {
        return e.kludges.source_act === u.CHAT_PHOTO_REMOVE ? (delete t.tabs[e.peerId].photo, delete t.tabs[e.peerId].photoLarge, Promise.resolve(t)) : Object(r.post)(E, {
            act: "a_get_chat_photo",
            msg_id: e.messageId
        }).then(function(n) {
            var r = y(n, 2),
                o = r[0],
                i = r[1];
            t.chat_photo_msg = i;
            var a = t.tabs[e.peerId];
            if (t.tabs[e.peerId].photo = o[0], t.tabs[e.peerId].photoLarge = o[1], Object(u.isFullyLoadedTab)(t, e.peerId)) {
                var s = e.kludges.source_act;
                a.history = Object(u.addChatPhotoToUpdate)(e, s, t, L(a.history))
            }
            return t
        })
    });

    function wt(e, t, n, r) {
        return t !== vk.id ? Promise.resolve(r) : (Object(u.isTabLoaded)(r, n) && r.peer == n && (r = V(r)), Promise.resolve(r))
    }
    var Et = A(function(e, t) {
            return Object(r.post)(E, {
                act: "a_leave_chat",
                chat: e - 2e9,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(wt.bind(null, u.CHAT_KICK_USER, vk.id, e, t))
        }),
        Ct = A(function(e, t) {
            return Object(r.post)(E, {
                act: "a_return_to_chat",
                chat: e - 2e9,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(wt.bind(null, u.CHAT_INVITE_USER, vk.id, e, t))
        }),
        jt = A(function(e, t, n) {
            return Object(r.post)(E, {
                act: "a_mute",
                peer: e,
                hash: n.tabs[e].hash,
                gid: n.gid,
                value: t ? 1 : 0
            }).then(function() {
                var r = t ? "mute" : "unmute";
                return window.Notifier && Notifier.lcSend("im", {
                    act: r,
                    peer: e
                }), n
            }).then(kt.bind(null, e, t))
        });

    function kt(e, t, n) {
        var r = n.mutedPeers.filter(function(t) {
            return t !== e
        });
        return t && r.push(e), n.mutedPeers = r, cur.mutedPeers = n.mutedPeers, V(n)
    }

    function Tt(e, t) {
        return t.stack = e, Promise.resolve(t)
    }
    var St = A(function(e, t, n, o) {
        return Mt(e, n, t, o), Object(r.post)(E, {
            act: "a_mark_important",
            ids: e,
            val: t ? 1 : 0,
            from: "im",
            gid: o.gid,
            peer: n,
            hash: o.tabs[n].hash
        }).then(function() {
            return o
        })
    });

    function Mt(e, t, n, r) {
        if (Object(u.isFullyLoadedTab)(r, t)) {
            var o = r.tabs[t];
            e.filter(function(e) {
                return o.msgs[e]
            }).forEach(function(e) {
                var a = Object(d.getMessage)(r, t, e),
                    s = n ? a.flags | i.FLAG_IMPORTANT : a.flags & ~i.FLAG_IMPORTANT;
                a.flags = s, o.msgs[e] = a, o.history = Object(u.updateStar)(e, n, L(o.history))
            })
        }
        return Promise.resolve(r)
    }

    function Pt(e, t, n) {
        return n.importants || (n.importants = {}), (n.importants[t] || 0) !== e && (n.important_cnt += e, n.importants[t] = e), Promise.resolve(n)
    }

    function xt(e, t) {
        return Object(r.post)(E, {
            act: "a_spam",
            offset: e,
            gid: t,
            part: e > 0
        })
    }

    function It(e, t) {
        return Object(r.post)(E, {
            act: "a_flush_spam",
            gid: t,
            hash: e
        })
    }

    function Dt(e, t, n) {
        return n.creationType = e, n.creationFilter = t, Promise.resolve(n)
    }

    function At(e, t) {
        return Object(r.post)(E, {
            act: "a_owner_photo",
            photo: JSON.parse(e).data[0],
            peer: t
        })
    }

    function Lt(e, t) {
        return t.next_chat_avatar = e, Promise.resolve(t)
    }

    function Rt(e, t, n) {
        return Object(r.post)("al_page.php", {
            act: "owner_photo_save",
            peer: e,
            _query: t
        }).then(function(e) {
            return n
        })
    }
    var Bt = A(function(e, t, n, o) {
        return o.creating = !0, o.longpoll.pause(), Object(r.post)(E, {
            act: "a_multi_start",
            hash: o.writeHash,
            peers: t.join(","),
            title: n
        }).then(function(e) {
            var t = y(e, 1)[0];
            return o.next_peer = t.peerId, o.tabs[t.peerId] = t, ne(o, t, !1, function(e) {
                return [t.peerId].concat(e)
            }), o.longpoll.resume(), o
        }).then(function(t) {
            return e ? Rt(t.next_peer, e, t) : t
        }).then(function(e) {
            return e.creating = !1, e
        }).catch(function(e) {
            throw o.creating = !1, o.longpoll.resume(), e
        })
    });

    function Nt(e) {
        var t = void 0;
        e.resync_in_process = new Promise(function(e) {
            t = e
        });
        var n = Object.keys(e.tabs).length,
            o = e.active_tab;
        return Object(r.post)(E, {
            act: "a_resync",
            sel: e.peer,
            gid: e.gid,
            loaded: n,
            tab: o,
            add_peers: e.tabbedPeers.map(function(e) {
                return e.peer
            }).join(",")
        }).then(function(n) {
            var r = y(n, 5),
                i = r[0],
                a = r[1],
                c = r[2],
                d = r[3],
                f = r[4];
            a.forEach(function(t) {
                return Object(p.oCacheAdd)(e, t)
            }), Object(u.normalizeTabsGotFromServer)(e, i), c.user_unread && handlePageCount("msg", c.user_unread), Object(s.lplog)("Resync success", "success");
            var _ = e.peer,
                m = void 0;
            if (Object(u.isReservedPeer)(_)) m = Promise.resolve(!1);
            else {
                var g = {
                    tabs: O({}, _, e.tabs[_]),
                    oCache: {}
                };
                m = me(O({}, _, i[_]), g)
            }
            return m.then(function(n) {
                e.tabs = i, e.admins = extend(e.admins, d), n && (e.tabs[_] = n.tabs[_], e.tabs[_].history = Object(u.restoreQueue)(_, e, L(e.tabs[_].history))), e.loadingDialogs = !1, e.mutedPeers = c.mutedPeers, e.lastDialogsOptions = {
                    has_more: c.has_more
                }, e.dialog_tab_cts = c.folder_cts, e.dialog_tabs[o] = f.map(intval);
                var r = e.dialog_tabs[o].map(function(t) {
                    return e.tabs[t]
                });
                return Object.keys(e.dialog_tabs).filter(function(e) {
                    return e != o
                }).forEach(function(t) {
                    o == l.FOLDER_ALL ? e.dialog_tabs[t] = r.filter(Gt(t)).map(function(e) {
                        return e.peerId
                    }) : e.dialog_tabs[t] = []
                }), delete e.resync_in_process, setTimeout(t.bind(null, !0), 0), Wt(intval(c.unread), e)
            })
        }).catch(function(t) {
            return Object(s.lplog)("Resync error: " + t.message + " " + t.stack, "error"), Object(a.pause)(2).then(Nt.bind(null, e))
        })
    }

    function Ut(e, t) {
        return t.lockedSending = e, Promise.resolve(t)
    }

    function Ft(e, t, n) {
        return e && !n.delayed_message ? (n.delayed_message = e, n.delayed_ts = t) : e || (n.delayed_message = e, n.delayed_ts = t), Promise.resolve(n)
    }

    function Ht(e) {
        return !!e.textMediaSelector.urlAttachmentLoading || !!(window.Upload && Upload.options && Upload.isSomethingUploading) && Object.keys(Upload.options).filter(function(e) {
            return Upload.isSomethingUploading(e)
        }).length > 0
    }

    function Wt(e, t) {
        return t.unread_cnt = e, t.dialog_tab_cts[l.FOLDER_UNREAD] = e, Promise.resolve(t)
    }

    function Kt(e, t) {
        return t.ctrl_submit = !!e, Object(r.post)(E, {
            act: "a_save_ctrl_submit",
            to: t.peer,
            hash: t.tabs[t.peer].hash,
            value: e ? 1 : 0
        }).then(function(e) {
            return t
        })
    }

    function qt(e, t, n) {
        n.cur_unread_cnt || (n.cur_unread_cnt = {}), t && !inArray(e, n.mutedPeers) && (n.cur_unread_cnt[e] = !0);
        var r = document.title,
            o = window.devicePixelRatio >= 2 ? "_2x" : "";
        if (t && !n.update_title_to) {
            var i = function(e, t, n) {
                return function() {
                    n.update_old_title = e;
                    var r = Object.keys(n.cur_unread_cnt).length;
                    if (0 === r) return Object(b.setDocumentTitle)(e || document.title), setFavIcon("/images/icons/favicons/fav_im" + t + ".ico"), clearInterval(n.update_title_to), void(n.update_title_to = !1);
                    e ? (Object(b.setDocumentTitle)(e), setFavIcon("/images/icons/favicons/fav_im" + t + ".ico"), e = !1) : (e = document.title, setFavIcon("/images/icons/favicons/fav_im" + (r > 9 ? 10 : r) + t + ".ico"), Object(b.setDocumentTitle)(winToUtf(getLang("mail_im_new_messages", r))))
                }
            }(r, o, n);
            n.update_title_to = setInterval(i, 1e3), i()
        } else !t && n.update_old_title && (Object(b.setDocumentTitle)(n.update_old_title), n.cur_unread_cnt = {}, r = !1, n.update_old_title = !1, setFavIcon("/images/icons/favicons/fav_im" + o + ".ico"), clearInterval(n.update_title_to), n.update_title_to = !1);
        return Promise.resolve(n)
    }

    function zt(e, t, n, r, o) {
        return Object(u.isFullyLoadedTab)(o, e) && (o.tabs[e].scrollTop = intval(t), o.tabs[e].scrollBottom = intval(n), o.tabs[e].contHeight = intval(r)), Promise.resolve(o)
    }

    function Gt(e) {
        return e === l.FOLDER_ALL ? function(e) {
            return !Object(u.tabIsMessageRequest)(e)
        } : e === l.FOLDER_UNREAD ? function(e) {
            return e.unread > 0
        } : function(t) {
            return t.folders & l.FOLDER_MASKS[e]
        }
    }

    function Vt(e, t) {
        t.active_tab = e, Object(o.updateLocation)({
            tab: e === l.FOLDER_ALL ? null : e
        });
        var n = [];
        if (e !== l.FOLDER_ALL && !Object(u.isReversedDialogs)(t)) {
            var r = t.dialog_tabs[e];
            n = t.dialog_tabs[l.FOLDER_ALL].map(function(e) {
                return t.tabs[e]
            }).filter(Gt(e)).map(function(e) {
                return e.peerId
            }), t.dialog_tabs[e] = r.length >= n.length ? r : n
        }
        return Promise.resolve(t)
    }

    function Yt(e, t, n, r) {
        var o = e.dialog_tabs_all;
        return !(!o[l.FOLDER_ALL] && !o[t]) || (n.filter(function(e) {
            return e === r.peerId
        }).length > 0 || ("r" === r.lastmsg[0] || n.map(function(t) {
            return e.tabs[t.toString()]
        }).filter(function(t) {
            return Object(u.isReversedDialogs)(e) ? t.lastmsg > r.lastmsg : t.lastmsg < r.lastmsg
        }).length > 0))
    }

    function Qt(e, t, n, r, o) {
        if (Object(u.isTabLoaded)(o, e)) {
            var a = o.tabs[e];
            return n === i.REPLACE_DIRECTORIES && (t ^= a.folders),
                function(e, t, n) {
                    return !(e === i.SET_DIRECTORIES && n.folders & t || !(e !== i.RESET_DIRECTORIES || n.folders & t))
                }(n, t, a) && Object.keys(l.FOLDER_MASKS).filter(function(e) {
                    return l.FOLDER_MASKS[e] & t
                }).forEach(function(e) {
                    o.dialog_tab_cts[e] += function(e, t, n) {
                        return t !== i.RESET_DIRECTORIES || e.folders & l.FOLDER_MASKS[n] ? t === i.REPLACE_DIRECTORIES ? e.folders & l.FOLDER_MASKS[n] ? -1 : 1 : t === i.SET_DIRECTORIES ? 1 : -1 : 0
                    }(a, n, e)
                }), n === i.SET_DIRECTORIES ? o.tabs[e].folders |= t : n === i.RESET_DIRECTORIES ? o.tabs[e].folders &= ~t : o.tabs[e].folders = t ^= a.folders, ne(o, o.tabs[e], !0, function(t, n) {
                    return t.concat([e]).map(function(e) {
                        return o.tabs[e]
                    }).filter(Gt(n)).map(function(e) {
                        return e.peerId
                    })
                }, Yt.bind(null, o)), Promise.resolve(o)
        }
        return N(e, 0, 0, 0, o).then(Qt.bind(null, e, t, n, o))
    }
    var $t = A(function(e, t) {
            var n = l.FOLDER_MASKS[l.FOLDER_IMPORTANT],
                o = t.tabs[e].folders & n,
                a = o ? i.resetDirectoriesEvent : i.setDirectoriesEvent;
            return t.longpoll.push([a([0, e, n, !0])]), Object(r.post)(E, {
                act: "a_dialog_star",
                val: o ? 0 : 1,
                peer: e,
                hash: t.tabs[e].hash,
                gid: t.gid
            }).then(function() {
                return t
            })
        }),
        Xt = A(function(e, t, n) {
            var o = l.FOLDER_MASKS[l.FOLDER_UNRESPOND];
            return n.longpoll.push([i.resetDirectoriesEvent([0, e, o, !0]), i.readInboundEvent([6, e, t])]), Object(r.post)(E, {
                act: "a_mark_answered",
                peer: e,
                lastmsg: t,
                hash: n.tabs[e].hash,
                gid: n.gid
            }).then(function() {
                return n
            })
        });

    function Jt(e) {
        return Object(r.post)(E, {
            act: "a_get_mutex_key",
            gid: e
        })
    }

    function Zt(e, t) {
        return B(O({}, e, {
            free: !0
        }), t), Object(r.post)(E, {
            act: "a_block_release",
            peer: e,
            gid: t.gid
        }).then(function() {
            return t
        })
    }

    function en(e, t) {
        var n = ls.get("comm_mute_" + t.gid) ? 1 : 0;
        return e && (n ^= 1), ls.set("comm_mute_" + t.gid, n), t.mute = n, Promise.resolve(t)
    }
    var tn = A(function(e, t) {
        return ne(t, t.tabs[e], !0, function(t) {
            return t.filter(function(t) {
                return t !== e
            })
        }), t.tabs[e].deletedDialog = !0, Object(r.post)(E, {
            act: "a_delete_dialog",
            peer: e,
            gid: t.gid,
            hash: t.tabs[e].hash
        }).then(function(n) {
            return n[0] ? (on(t.tabbedPeers.filter(function(t) {
                return t.peer !== e
            }), !0, t), t.tabs[e].unread = 0, t.tabs[e].lastmsg = !1, t.tabs[e].lastmsg_meta = null) : (t.tabs[e].deletedDialog = !1, ne(t, t.tabs[e], !1, ie.bind(null, e), Yt.bind(null, t))), n
        })
    });

    function nn(e, t, n, o) {
        return Object(r.post)(E, {
            act: "a_restore_dialog",
            hash: t,
            gid: o.gid,
            spam: n ? 1 : 0,
            peer: e
        }).then(function(t) {
            return o.tabs[e].deletedDialog = !1, ne(o, o.tabs[e], !1, function(t) {
                return [e].concat(t)
            }), o.tabs[e].unread = t, o
        })
    }

    function rn(e, t, n) {
        return Object(r.post)(E, {
            act: "a_spam_dialog",
            peer: e,
            gid: n.gid,
            hash: t
        })
    }

    function on(e, t, n) {
        return n.tabbedPeers = e, Object(u.isClassicInterface)(n) && (S({
            peers: n.tabbedPeers.filter(function(e) {
                var t = e.peer,
                    r = e.type;
                return t !== n.peer && "perm" === r
            }).map(function(e) {
                return Object(u.getBareTab)(e.peer, n)
            }).filter(function(e) {
                return !e.deletedDialog
            }).map(function(e) {
                return e.peerId
            }).map(u.convertPeerToUrl).join("_")
        }), t && M()), Promise.resolve(n)
    }

    function an(e) {
        return !e.peer || (Ge(e.peer, e) ? ze(e.peer, e) : !!Object(u.isFullyLoadedTab)(e, e.peer) && e.tabs[e.peer].allShown)
    }

    function sn(e, t) {
        var n = t.tabs[e];
        return Object(u.isFullyLoadedTab)(t, e) && (n.skipped = null, n.msgs = null, n.offset = null, n.allShown = null, n.history = null), Promise.resolve(t)
    }

    function cn(e, t) {
        var n = t.tabs[e];
        return Object(u.isFullyLoadedTab)(t, e) && (n.history = R(n.history)), Promise.resolve(t)
    }

    function un(e, t) {
        return t.go_to_end_visible = e, Promise.resolve(t)
    }

    function ln(e, t, n) {
        if (!Object(u.isCommunityPeer)(t)) return Promise.resolve(n);
        var o = Object(d.getTab)(n, t);
        return o.blocked_community = !e, Object(r.post)(E, {
            act: "a_toggle_community",
            peer_id: t,
            hash: o.hash,
            state: e ? 1 : 0
        }).then(function() {
            return V(n)
        })
    }

    function dn(e, t) {
        if (0 !== t.peer && Object(u.isFullyLoadedTab)(t, t.peer)) {
            var n = Object(d.getTab)(t, t.peer);
            n.history = L(n.history), e(n.history)
        }
        return Promise.resolve(t)
    }

    function fn(e) {
        return e.audio_msg.isRecording ? Promise.reject() : (e.audio_msg.isRecording = !0, Promise.resolve(e))
    }

    function pn(e) {
        return e.audio_msg.isRecording = !1, Promise.resolve(e)
    }

    function _n(e, t) {
        return t.voice_message_available = e, Promise.resolve(t)
    }

    function mn(e) {
        S({
            act: e ? "create" : null
        }), M()
    }

    function gn() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null;
        S({
            q: e
        }), M()
    }

    function hn(e) {
        return void 0 === e.chatResizeInitialized && (e.chatResizeInitialized = !0, Object(u.getClassicChatHeight)() > window.clientHeight() && Object(u.setClassicChatHeight)(0)), Promise.resolve(e)
    }
    var bn = A(function(e, t, n) {
        return Object(r.post)(E, {
            act: "a_join_chat",
            chat_id: e,
            hash: t,
            write_hash: n.writeHash
        }).then(function(e) {
            var t = y(e, 4),
                r = t[0],
                o = t[1],
                i = t[2],
                a = t[3];
            return i.forEach(function(e) {
                return Object(p.oCacheAdd)(n, e)
            }), n.tabs[r] = o, ne(n, o, !1, ie.bind(null, r), Yt.bind(null, n)), n.admins = extend(n.admins, a), [r]
        })
    });

    function vn(e, t) {
        return Object(r.post)(E, {
            act: "a_get_link",
            gid: t.gid,
            chat_id: e
        })
    }
    var yn = A(function(e, t) {
        var n = t.tabs[e];
        return Object(r.post)(E, {
            act: "a_reset_link",
            chat_id: e - 2e9,
            write_hash: t.writeHash
        }).then(function(e) {
            return n.inviteLink = e[0], e
        })
    });

    function On(e) {
        return P({
            invite_chat_id: null,
            invite_hash: null
        }), e.invitation = void 0, Promise.resolve(e)
    }

    function wn(e, t) {
        var n = Object(s.arrayUnique)([e].concat(t.select(c.RECENT_SEARCH_OP))).slice(0, 500);
        t.update(c.RECENT_SEARCH_OP, n)
    }

    function En(e) {
        e.update(c.RECENT_SEARCH_OP, [])
    }

    function Cn(e, t) {
        var n = t.select(c.RECENT_SEARCH_OP).filter(function(t) {
            return t !== e
        });
        return t.update(c.RECENT_SEARCH_OP, n), n
    }

    function jn(e, t, n) {
        var r = n.tabs[t],
            o = Object(d.getMessage)(n, t, e);
        return r.data.kicked || r.data.closed || o.kludges.source_act || (r.pinned = o), Promise.resolve(n)
    }

    function kn(e, t) {
        return t.tabs[e].pinned = null, Promise.resolve(t)
    }
    var Tn = A(function(e, t, n) {
            var o = n.tabs[t];
            return o.data.kicked || o.data.closed ? Promise.resolve(n) : Object(r.post)(E, {
                act: "a_pin_message",
                msgid: e,
                chat: t,
                gid: n.gid,
                hash: n.tabs[t].hash
            }).then(function(e) {
                var r = y(e, 1)[0];
                return n.tabs[t] = Object.assign({}, o, r), n
            })
        }),
        Sn = A(function(e, t) {
            var n = t.tabs[e];
            return n.data.kicked || n.data.closed ? Promise.resolve(t) : Object(r.post)(E, {
                act: "a_unpin_message",
                chat: e,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(function(r) {
                var o = y(r, 1)[0];
                return t.tabs[e] = Object.assign({}, n, o), t
            })
        }),
        Mn = A(function(e, t) {
            var n = t.tabs[e];
            return Object(r.post)(E, {
                act: "a_get_pinned_message",
                chat: e,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(function(e) {
                var r = y(e, 1)[0];
                return n.pinned = r || null, t
            })
        }),
        Pn = A(function(e, t, n) {
            var o = n.tabs[e];
            return Object(r.post)(E, {
                act: "a_get_message_local_id",
                chat: e,
                chat_local_id: t,
                hash: o.hash
            })
        }),
        xn = A(function(e, t) {
            var n = t.tabs[e];
            return n.membersLoaded ? Promise.resolve(t) : Object(r.post)(E, {
                act: "a_get_chat_members",
                chat: e,
                gid: t.gid,
                hash: n.hash
            }).then(function(e) {
                var r = y(e, 1),
                    o = y(r[0], 3),
                    i = o[0],
                    a = o[1],
                    s = o[2];
                return n.memberIds = i, n.adminIds = a, s.forEach(function(e) {
                    return Object(p.oCacheAdd)(t, e)
                }), n.membersLoaded = !0, t
            })
        }),
        In = A(function(e, t) {
            return Promise.all([xn(e, t), function(e, t) {
                var n = t.tabs[e];
                return Object(r.post)(E, {
                    act: "a_get_chat_details",
                    chat: e,
                    gid: t.gid,
                    hash: n.hash
                }).then(function(e) {
                    var r = y(e, 1)[0];
                    return n.photoGrid = r.grid, n.photoLarge = r.photo, n.membersLastSeen = r.lastSeen || null, n.inviters = r.inviters, n.caccess = r.caccess, n.invitedByMe = r.invitedByMe || [], n.inviteLink = r.link || null, n.serverSettings = r.serverSettings || null, t
                })
            }(e, t)]).then(function() {
                return t
            })
        }),
        Dn = A(function(e, t, n) {
            var o = n.tabs[e];
            return Object(r.post)(E, {
                act: "a_update_flags",
                chat: e,
                hash: o.hash,
                flags: t
            })
        }),
        An = A(function(e, t) {
            var n = t.tabs[e];
            return Object(r.post)("al_page.php", {
                act: "owner_photo_remove",
                oid: e,
                gid: t.gid,
                hash: n.photoHash
            }).then(function() {
                return n.photo = null, n.photoLarge = null, t
            })
        });

    function Ln(e, t, n) {
        var r = n.tabs[e];
        return r.memberIds = r.memberIds.filter(function(e) {
            return e !== t
        }), r.adminIds = r.adminIds.filter(function(e) {
            return e !== t
        }), r.membersCount = r.memberIds.length, Promise.resolve(n)
    }
    var Rn = A(function(e, t, n) {
        var o = n.tabs[e];
        return Object(r.post)(E, {
            act: "a_kick_user",
            chat: e,
            hash: o.hash,
            mid: t
        }).then(function() {
            return o.memberIds = o.memberIds.filter(function(e) {
                return e !== t
            }), o.adminIds = o.adminIds.filter(function(e) {
                return e !== t
            }), o.membersCount = o.memberIds.length, n
        })
    });

    function Bn(e, t, n, r) {
        var o = r.tabs[e];
        return o.adminIds = n ? [].concat(o.adminIds, t).filter(function(e, t, n) {
            return n.indexOf(e) === t
        }) : o.adminIds.filter(function(e) {
            return e !== t
        }), Promise.resolve(r)
    }
    var Nn = A(function(e, t, n, o) {
        var i = o.tabs[e];
        return Object(r.post)(E, {
            act: "a_toggle_admin",
            chat: e,
            hash: i.hash,
            mid: t,
            is_admin: +n
        }).then(function() {
            return Bn(e, t, n, o)
        })
    });

    function Un(e, t, n, r) {
        var o = Object(d.getMessage)(e, n, t).userId;
        return Object(p.oCacheGet)(r, o) ? Promise.resolve(r) : bt(O({}, n, [o]), r)
    }

    function Fn() {
        ajax.post("al_im.php", {
            act: "a_hide_promo_tooltip"
        })
    }

    function Hn() {
        cur.videoAutoplayScrollHandler && cur.videoAutoplayScrollHandler()
    }
    var Wn = A(function(e, t) {
            return t.tabs[e].top_banner = void 0, Object(r.post)(E, {
                act: "a_hide_banner",
                peer_id: e,
                gid: t.gid,
                hash: t.tabs[e].hash
            }).then(function() {
                return t
            })
        }),
        Kn = A(function(e, t, n) {
            n.tabs[e].top_banner = void 0;
            var o = n.tabs[e];
            return Object(r.post)(E, {
                act: "a_callback_banner",
                peer_id: e,
                callback_data: t,
                hash: o.hash
            }).then(function() {
                return n
            })
        });

    function qn(e, t) {
        return Object(r.post)(E, {
            act: "a_load_banner",
            peer_id: e,
            gid: t.gid
        }).then(function(n) {
            var r = y(n, 1)[0];
            return t.tabs[e].top_banner = r, t
        })
    }

    function zn(e, t, n) {
        return n.tabs[e].keyboard = t && t.buttons ? t : null, Vn(e, !1, !0, n)
    }

    function Gn(e, t) {
        return zn(e, null, t)
    }

    function Vn(e, t, n, r) {
        return ((r.tabs || {})[e] || {}).keyboard && (r.tabs[e].keyboard.hide = t, n && ls.set("is_keyboards_hide", Object.assign(ls.get("is_keyboards_hide") || {}, O({}, e, t)))), Promise.resolve(r)
    }
    var Yn = A(function(e, t) {
        var n = t.tabs[e];
        return Object(r.post)(E, {
            act: "a_get_keyboard",
            peer_id: e,
            hash: n.hash
        }).then(function(n) {
            var r = y(n, 1)[0];
            return zn(e, r, t)
        })
    });

    function Qn(e, t, n, o) {
        var i = o.tabs[e];
        return i.caccess[t] = n, Object(r.post)(E, {
            act: "a_change_caccess",
            peer_id: e,
            member_id: t,
            hash: i.hash,
            access: n ? 1 : 0
        }).then(function() {
            return o
        }).catch(function(e) {
            throw i.caccess[t] = !n, e
        })
    }
    var $n = A(function(e, t) {
        var n = t.tabs[t.peer];
        return Object(r.post)(E, {
            act: "a_delete_template",
            template_id: e,
            hash: n.hash,
            gid: t.gid,
            peer_id: t.peer
        }).then(function() {
            var n = t.templates.find(function(t) {
                return t.id === e
            });
            return n && (n.deleted = !0), t
        })
    });

    function Xn(e, t, n) {
        var o = n.tabs[n.peer];
        return Object(r.post)(E, {
            act: "a_create_template",
            hash: o.hash,
            gid: n.gid,
            peer_id: n.peer,
            name: e,
            text: t
        }).then(function(e) {
            return n.templates.unshift(e[0]), n
        })
    }

    function Jn(e, t, n, o) {
        var i = o.tabs[o.peer];
        return Object(r.post)(E, {
            act: "a_update_template",
            template_id: e,
            hash: i.hash,
            gid: o.gid,
            peer_id: o.peer,
            group_id: o.gid,
            name: t,
            text: n
        }).then(function(t) {
            var n = o.templates.find(function(t) {
                return t.id === e
            });
            return n && Object.assign(n, t[0]), o
        })
    }

    function Zn(e, t) {
        if (Object(u.isFullyLoadedTab)(t, e)) {
            var n = Object(d.getTab)(t, e);
            n.allShown = !1, n.lastReset = Date.now()
        }
        return t
    }
}, function(e, t, n) {
    var r = n(151)("iterator"),
        o = !1;
    try {
        var i = [7][r]();
        i.return = function() {
            o = !0
        }, Array.from(i, function() {
            throw 2
        })
    } catch (e) {}
    e.exports = function(e, t) {
        if (!t && !o) return !1;
        var n = !1;
        try {
            var i = [7],
                a = i[r]();
            a.next = function() {
                n = !0
            }, i[r] = function() {
                return a
            }, e(i)
        } catch (e) {}
        return n
    }
}, function(e, t, n) {
    var r = n(316),
        o = n(230),
        i = n(426),
        a = n(196),
        s = n(160),
        c = function(e, t, n) {
            var u, l, d, f, p = e & c.F,
                _ = e & c.G,
                m = e & c.S,
                g = e & c.P,
                h = e & c.B,
                b = _ ? r : m ? r[t] || (r[t] = {}) : (r[t] || {}).prototype,
                v = _ ? o : o[t] || (o[t] = {}),
                y = v.prototype || (v.prototype = {});
            for (u in _ && (n = t), n) d = ((l = !p && b && void 0 !== b[u]) ? b : n)[u], f = h && l ? s(d, r) : g && "function" == typeof d ? s(Function.call, d) : d, b && a(b, u, d, e & c.U), v[u] != d && i(v, u, f), g && y[u] != d && (y[u] = d)
        };
    r.core = o, c.F = 1, c.G = 2, c.S = 4, c.P = 8, c.B = 16, c.W = 32, c.U = 64, c.R = 128, e.exports = c
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "createMutations", function() {
        return c
    }), n.d(t, "createModule", function() {
        return u
    }), n.d(t, "destroyModule", function() {
        return l
    });
    var r = n(97);

    function o(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
            return n
        }
        return Array.from(e)
    }
    var i = window,
        a = i.addEvent,
        s = i.removeEvent;

    function c(e) {
        return {
            callMutations: function() {
                if ("function" == typeof e) throw console.trace(), new Error("Mutations are not initialized");
                return e
            },
            bindMutations: function() {
                if ("function" != typeof e) throw console.trace(), new Error("Mutations are already initialized");
                return e = e.apply(void 0, arguments)
            }
        }
    }

    function u(e) {
        var t = {
            _registeredHandlers: []
        };
        return e.handlers(function(e, t, n, r) {
            a(t, n, r), e._registeredHandlers.push(["bind", t, n, r])
        }.bind(null, t), function(e, t, n, o, i) {
            Object(r.addDelegateEvent)(t, n, o, i), e._registeredHandlers.push(["delegate", t, n, o, i])
        }.bind(null, t)), t
    }

    function l(e) {
        e._registeredHandlers.forEach(function(e) {
            var t = e.slice(1);
            "delegate" === e[0] ? r.removeDelegateEvent.apply(void 0, o(t)) : s.apply(void 0, o(t))
        }), e._registeredHandlers = []
    }
}, , function(__webpack_module__, __webpack_exports__, __webpack_require__) {
    "use strict";
    __webpack_require__.r(__webpack_exports__), __webpack_require__.d(__webpack_exports__, "MessageBox", function() {
        return MessageBox
    }), __webpack_require__.d(__webpack_exports__, "showBox", function() {
        return showBox
    }), __webpack_require__.d(__webpack_exports__, "showTabbedBox", function() {
        return showTabbedBox
    }), __webpack_require__.d(__webpack_exports__, "showFastBox", function() {
        return showFastBox
    }), __webpack_require__.d(__webpack_exports__, "showCaptchaBox", function() {
        return showCaptchaBox
    }), __webpack_require__.d(__webpack_exports__, "showReCaptchaBox", function() {
        return showReCaptchaBox
    });
    var _ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(366),
        _debug_tools__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(95),
        _dom_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(45),
        _ui_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(82),
        _dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(347),
        _fx__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(163),
        _utils_common__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(269),
        _lang__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(220),
        _ajax__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(193),
        _box_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(471),
        _accessibility__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(108);

    function MessageBox(_options) {
        var defaults = {
                title: !1,
                titleControls: "",
                width: 450,
                height: "auto",
                animSpeed: 0,
                bodyStyle: "",
                grey: !1,
                white: !1,
                selfDestruct: !0,
                progress: !1,
                hideOnBGClick: !1,
                hideButtons: !1,
                onShow: !1,
                onHideAttempt: !1,
                onBeforeHide: !1,
                onHide: !1,
                onClean: !1,
                onDestroy: !1
            },
            options = Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.extend)(defaults, _options),
            guid = window._message_box_guid++,
            visible = !1,
            btns = {
                ok: [],
                cancel: []
            },
            boxTitleBck = void 0;
        options.progress || (options.progress = "box_progress" + guid);
        var controlsStyle = options.hideButtons ? ' style="display: none"' : "",
            boxContainer = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.ce)("div", {
                className: "popup_box_container" + (options.containerClass ? " " + options.containerClass : ""),
                innerHTML: '\n<div class="box_layout" onclick="boxQueue.skip=true;">\n<div class="box_title_wrap">\n  <div class="box_x_button" aria-label="' + Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_close") + '" tabindex="0" role="button"></div>\n  <div class="box_title_controls"></div>\n  <div class="box_title"></div>\n</div>\n<div class="box_body" style="' + options.bodyStyle + '"></div>\n<div class="box_controls_wrap" ' + controlsStyle + '><div class="box_controls">\n<table cellspacing="0" cellpadding="0" class="fl_r"><tr></tr></table>\n<div class="progress" id="' + options.progress + '"></div>\n<div class="box_controls_text _box_controls_text">' + (options.textControls || "") + "</div>\n</div></div>\n</div>"
            }, {
                display: "none"
            });
        Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(boxContainer);
        var boxLayout = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domFC)(boxContainer),
            boxTitleWrap = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domFC)(boxLayout),
            boxCloseButton = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domFC)(boxTitleWrap),
            boxTitle = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domLC)(boxTitleWrap),
            boxTitleControls = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domNS)(boxCloseButton);
        options.noCloseButton && Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(boxCloseButton);
        var boxBody = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domNS)(boxTitleWrap),
            boxControlsWrap = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domNS)(boxBody),
            boxControls = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domFC)(boxControlsWrap),
            boxButtons = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domFC)(boxControls),
            boxProgress = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domNS)(boxButtons),
            boxControlsText = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.domNS)(boxProgress);
        boxLayer.appendChild(boxContainer), boxContainer.setAttribute("tabindex", 0), boxContainer.focus(), refreshBox(), Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.boxRefreshCoords)(boxContainer);
        var emitter = new EventEmitter;

        function refreshBox() {
            boxTitleBck || (options.title ? (boxTitle.innerHTML = options.title, Object(_dom__WEBPACK_IMPORTED_MODULE_4__.removeClass)(boxBody, "box_no_title"), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(boxTitleWrap)) : (Object(_dom__WEBPACK_IMPORTED_MODULE_4__.addClass)(boxBody, "box_no_title"), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(boxTitleWrap))), options.titleControls && (boxTitleControls.innerHTML = options.titleControls), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.toggleClass)(boxBody, "box_no_buttons", options.hideButtons), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.toggleClass)(boxTitleWrap, "box_grey", options.grey), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.toggleClass)(boxTitleWrap, "box_white", options.white), boxContainer.style.width = "string" == typeof options.width ? options.width : options.width + "px", boxContainer.style.height = "string" == typeof options.height ? options.height : options.height + "px"
        }

        function _addButton(e, t, n, r) {
            var o = "flat_button";
            "no" === n || "gray" === n ? (o += " secondary", n = "cancel") : n = "ok";
            var i = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.ce)("button", {
                className: o,
                innerHTML: e,
                id: r
            });
            return boxButtons.rows[0].insertCell(0).appendChild(i), Object(_ui__WEBPACK_IMPORTED_MODULE_0__.createButton)(i, function() {
                emitter.emit(n, retBox), t.apply(null, arguments)
            }), btns[n].push(i), i
        }

        function setControlsText(e) {
            boxControlsText.innerHTML = e
        }

        function _removeButtons() {
            for (var e = boxButtons.rows[0]; e.cells.length;) Object(_dom__WEBPACK_IMPORTED_MODULE_4__.cleanElems)(e.cells[0]), e.deleteCell(0);
            btns.ok.length = btns.cancel.length = 0
        }
        var destroyMe = function() {
                Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.isFunction)(options.onClean) && options.onClean(), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.isFunction)(options.onDestroy) && options.onDestroy(), _removeButtons(), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.cleanElems)(boxContainer, boxCloseButton, boxTitleWrap, boxControlsWrap), boxLayer.removeChild(boxContainer), delete window._message_boxes[guid]
            },
            hideMe = function(e, t, n) {
                if (visible) {
                    visible = !1;
                    var r = !0 === e ? 0 : options.animSpeed;
                    options.hideOnBGClick && Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.removeEvent)(document, "click", boxQueue.hideBGClick), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.isFunction)(options.onBeforeHide) && options.onBeforeHide();
                    var o = function() {
                        boxQueue.currHiding === _message_boxes[guid] && (boxQueue.currHiding = !1), _message_boxes[guid].shOther || e || layers.boxhide(), !t && options.selfDestruct ? destroyMe() : Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(boxContainer), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.isFunction)(options.onHide) && options.onHide(n)
                    };
                    r > 0 ? (boxQueue.currHiding = _message_boxes[guid], Object(_fx__WEBPACK_IMPORTED_MODULE_5__.fadeOut)(boxContainer, r, o)) : o()
                }
            };

        function showMe(e, t, n) {
            if (!visible && window._message_boxes[guid]) {
                visible = !0;
                var r = !0 === e || t ? 0 : options.animSpeed;
                if (options.hideOnBGClick && Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.addEvent)(document, "click", boxQueue.hideBGClick), t || layers.boxshow(), boxQueue.currHiding) {
                    boxQueue.currHiding.shOther = !0;
                    var o = boxQueue.currHiding.bodyNode.parentNode.parentNode;
                    Object(_dom__WEBPACK_IMPORTED_MODULE_4__.data)(o, "tween").stop(!0)
                }
                r > 0 ? Object(_fx__WEBPACK_IMPORTED_MODULE_5__.fadeIn)(boxContainer, r) : Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(boxContainer), Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.boxRefreshCoords)(boxContainer), options.onShow && options.onShow(n)
            }
        }
        Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.addEvent)(boxCloseButton, "click", boxQueue.hideLast);
        var retBox = window._message_boxes[guid] = {
            guid: guid,
            _show: showMe,
            _hide: hideMe,
            bodyNode: boxBody,
            controlsTextNode: boxControlsText,
            titleWrap: boxTitleWrap,
            btns: btns,
            show: function() {
                return boxQueue._show(guid), this
            },
            progress: boxProgress,
            showCloseProgress: _dom__WEBPACK_IMPORTED_MODULE_4__.addClass.pbind(boxTitleWrap, "box_loading"),
            hideCloseProgress: _dom__WEBPACK_IMPORTED_MODULE_4__.removeClass.pbind(boxTitleWrap, "box_loading"),
            showProgress: function() {
                Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(boxControlsText), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(boxProgress)
            },
            hideProgress: function() {
                Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(boxProgress), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(boxControlsText)
            },
            hide: function(e) {
                return !(Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.isFunction)(options.onHideAttempt) && !options.onHideAttempt(e)) && (boxQueue._hide(guid), !0)
            },
            isVisible: function() {
                return visible
            },
            bodyHeight: function() {
                return Object(_dom__WEBPACK_IMPORTED_MODULE_4__.getStyle)(boxBody, "height")
            },
            content: function(e) {
                return options.onClean && options.onClean(), boxBody.innerHTML = e, Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.boxRefreshCoords)(boxContainer), boxContainer.focus(), refreshBox(), Object(_accessibility__WEBPACK_IMPORTED_MODULE_10__.updateAriaElements)(), this
            },
            emit: function(e, t) {
                emitter.emit(e, t)
            },
            addButton: function(e, t, n, r, o) {
                var i = _addButton(e, t || this.hide, n, o);
                return r ? i : this
            },
            setButtons: function(e, t, n, r) {
                var o = this.removeButtons();
                return e ? (o.addButton(e, t), n && o.addButton(n, r, "no"), o) : o.addButton(Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("box_close"))
            },
            setControlsText: setControlsText,
            removeButtons: function() {
                return _removeButtons(), this
            },
            setBackTitle: function(e) {
                e ? (boxTitle.innerHTML = '<div class="back">' + Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_box_title_back") + "</div>", Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByClass1)("back", boxTitle).onclick = e, boxTitleBck = options.title, options.title = boxTitle.innerHTML) : boxTitleBck && (boxTitle.innerHTML = options.title = boxTitleBck, boxTitleBck = !1)
            },
            destroy: destroyMe,
            getOptions: function() {
                return options
            },
            on: function(e, t) {
                emitter.on(e, t)
            },
            once: function(e, t) {
                emitter.once(e, t)
            },
            updateBoxCoords: function() {
                Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.boxRefreshCoords)(boxContainer)
            },
            setOptions: function(e) {
                if (options.hideOnBGClick && Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.removeEvent)(document, "click", boxQueue.hideBGClick), options = Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.extend)(options, e), "bodyStyle" in e)
                    for (var t = options.bodyStyle.split(";"), n = 0, r = t.length; n < r; n++) {
                        var o = t[n].split(":");
                        o.length > 1 && o[0].length && (boxBody.style[Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.trim)(o[0])] = Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.trim)(o[1]), boxBody.style.setProperty && boxBody.style.setProperty(Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.trim)(o[0]), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.trim)(o[1]), ""))
                    }
                return options.hideOnBGClick && Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.addEvent)(document, "click", boxQueue.hideBGClick), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.toggle)(boxControlsWrap, !options.hideButtons), refreshBox(), options.noRefreshCoords || Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.boxRefreshCoords)(boxContainer), this
            },
            evalBox: function evalBox(js, url, params) {
                var scr = "((function() { return function() { var box = this; " + (js || "") + ";}; })())";
                if (__debugMode) {
                    var fn = eval(scr);
                    fn.apply(this, [url, params])
                } else try {
                    var _fn = eval(scr);
                    _fn.apply(this, [url, params])
                } catch (e) {
                    Object(_ui_util__WEBPACK_IMPORTED_MODULE_3__.topError)(e, {
                        dt: 15,
                        type: 7,
                        url: url,
                        query: params ? Object(_ajax__WEBPACK_IMPORTED_MODULE_8__.ajx2q)(params) : void 0,
                        js: js
                    }), Object(_debug_tools__WEBPACK_IMPORTED_MODULE_1__.logEvalError)(e, scr)
                }
            }
        };
        return retBox
    }

    function showBox(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
            r = arguments[3];
        if (Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.checkEvent)(r)) return !1;
        var o = n.params || {};
        n.containerClass && (o.containerClass = n.containerClass);
        var i = new MessageBox(o),
            a = {
                onDone: function(r, a, s, c) {
                    if (n.preOnDone && n.onDone && n.onDone(i), i.isVisible())
                        if (__debugMode) u();
                        else try {
                            u()
                        } catch (n) {
                            Object(_ui_util__WEBPACK_IMPORTED_MODULE_3__.topError)(n, {
                                dt: 15,
                                type: 103,
                                url: e,
                                query: Object(_ajax__WEBPACK_IMPORTED_MODULE_8__.ajx2q)(t),
                                answer: Array.prototype.slice.call(arguments).join("<!>")
                            }), i.isVisible() && i.hide()
                        } else n.onDone && n.onDone(i, c);

                    function u() {
                        Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(boxLayerBG), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.addClass)(bodyNode, "layers_shown"), i.setOptions({
                            title: r,
                            hideButtons: o.hideButtons || !1
                        }), n.showProgress ? i.show() : Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(i.bodyNode), i.content(a), i.evalBox(s, e, t), n.onDone && n.onDone(i, c)
                    }
                },
                onFail: function(e) {
                    if (i.failed = !0, setTimeout(i.hide, 0), Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.isFunction)(n.onFail)) return n.onFail(e)
                },
                cache: n.cache,
                stat: n.stat,
                fromBox: !0
            };
        return n.prgEl && (n.showProgress = _ui_util__WEBPACK_IMPORTED_MODULE_3__.showGlobalPrg.pbind(n.prgEl, {
            cls: n.prgClass,
            w: n.prgW,
            h: n.prgH,
            hide: !0
        }), n.hideProgress = _dom__WEBPACK_IMPORTED_MODULE_4__.hide.pbind("global_prg")), n.showProgress ? Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.extend)(a, {
            showProgress: n.showProgress,
            hideProgress: n.hideProgress
        }) : (i.setOptions({
            title: !1,
            hideButtons: !0
        }).show(), boxQueue.count() < 2 && (Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(boxLayerBG), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.removeClass)(bodyNode, "layers_shown")), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(i.bodyNode), a.showProgress = function() {
            Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(boxLoader), Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.boxRefreshCoords)(boxLoader)
        }, a.hideProgress = _dom__WEBPACK_IMPORTED_MODULE_4__.hide.pbind(boxLoader)), i.removeButtons().addButton(Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_close")), ajax.post(e, t, a), i
    }

    function showTabbedBox(e, t, n, r) {
        return (n = n || {}).stat = n.stat || [], n.stat.push("box.js", "boxes.css"), showBox(e, t, n, r)
    }

    function showFastBox(e, t, n, r, o, i) {
        return new MessageBox("string" == typeof e ? {
            title: e
        } : e).content(t).setButtons(n, r, o, i).show()
    }

    function showCaptchaBox(e, t, n, r) {
        var o = function(t) {
                if (!t || void 0 === t.keyCode || 10 === t.keyCode || 13 === t.keyCode) {
                    var o = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByTag1)("input", n.bodyNode);
                    if (Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.trim)(o.value) || !0 === t) {
                        var i = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByTag1)("img", n.bodyNode)[0];
                        Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.removeEvent)(o), Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.removeEvent)(i), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByClass1)("progress", n.bodyNode)), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(o), r.onSubmit(e, o.value)
                    } else Object(_dom__WEBPACK_IMPORTED_MODULE_4__.elfocus)(o)
                }
            },
            i = !!n,
            a = Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.intval)(t) ? "" : "&s=1",
            s = r.imgSrc || "/captcha.php?sid=" + e + a;
        if (!i) {
            var c = '\n<div class="captcha">\n  <div><img src="' + s + '"/></div>\n  <div>\n    <input type="text" class="big_text" maxlength="7" placeholder="' + Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_captcha_input_here") + '" />\n    <div class="progress" /></div>\n  </div>\n</div>' + (r.addText || "");
            n = showFastBox({
                title: Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("captcha_enter_code"),
                width: 305,
                onHide: r.onHide,
                onDestroy: r.onDestroy || !1
            }, c, Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("captcha_send"), function() {
                n.submit()
            }, Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("captcha_cancel"), function() {
                var e = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByTag1)("input", n.bodyNode),
                    t = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByTag1)("img", n.bodyNode);
                Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.removeEvent)(e), Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.removeEvent)(t), n.hide()
            })
        }
        n.submit = o.pbind(!0), n.changed = !0;
        var u = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByTag1)("input", n.bodyNode),
            l = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByTag1)("img", n.bodyNode);
        return i && (u.value = "", l.src = "/captcha.php?sid=" + e + a, Object(_dom__WEBPACK_IMPORTED_MODULE_4__.hide)(Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByClass1)("progress", n.bodyNode))), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.show)(u), Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.addEvent)(u, "keypress", o), Object(_dom_events__WEBPACK_IMPORTED_MODULE_2__.addEvent)(l, "click", function() {
            this.src = "/captcha.php?sid=" + e + a + "&v=" + Object(_utils_common__WEBPACK_IMPORTED_MODULE_6__.irand)(1e6, 2e6)
        }), Object(_dom__WEBPACK_IMPORTED_MODULE_4__.elfocus)(u), n
    }

    function showReCaptchaBox(e, t, n, r) {
        window.recaptchaResponse = function(e) {
            r.onSubmit(e)
        };
        var o = !!n,
            i = !!window.grecaptcha;
        if (!o) {
            i || (window.recaptchaCallback = function() {
                var t = Object(_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)();
                if (t) {
                    var n = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByClass1)("recaptcha", t.bodyNode);
                    n && (Object(_dom__WEBPACK_IMPORTED_MODULE_4__.val)(n, ""), window.grecaptcha.render(n, {
                        sitekey: e,
                        callback: window.recaptchaResponse
                    }))
                }
            }, headNode.appendChild(Object(_dom__WEBPACK_IMPORTED_MODULE_4__.ce)("script", {
                type: "text/javascript",
                src: "https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit&hl=" + t
            })));
            var a = '<div class="recaptcha"></div>' + (r.addText || "");
            n = showFastBox({
                title: Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_recaptcha_title"),
                width: 354,
                onHide: r.onHide,
                onDestroy: r.onDestroy || !1
            }, a, Object(_lang__WEBPACK_IMPORTED_MODULE_7__.getLang)("captcha_cancel"));
            var s = Object(_dom__WEBPACK_IMPORTED_MODULE_4__.geByClass1)("recaptcha", n.bodyNode);
            s.id = "recaptcha" + (n.guid ? n.guid : "0"), Object(_ui__WEBPACK_IMPORTED_MODULE_0__.showProgress)(s)
        }
        return o && i ? window.grecaptcha.reset() : i && window.recaptchaCallback(), n.changed = !0, n
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return W
    });
    var r = n(256),
        o = n(252),
        i = n(1),
        a = n(112),
        s = n(406),
        c = n(427),
        u = n(66),
        l = n(281),
        d = n(68),
        f = n(99),
        p = n(309),
        _ = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();
    var m = "_im_action",
        g = "_im_page_peer_name",
        h = "_ui_menu",
        b = "_im_dialog_action_wrapper",
        v = "_im_mess_actions",
        y = "_im_page_action",
        O = "_im_chat_topic_change_input",
        w = "_im_chat_verified",
        E = "im-page--chat-header_chat",
        C = "im-page--chat-header_vkcomgroup",
        j = "_im_page_peer_name",
        k = "_im_chat_members",
        T = "_im_chat_invite_link",
        S = '<a tabindex="0" role="link" class="ui_actions_menu_item ' + m + ' im-action im-action_%icon%" data-action="%action%">%name%</a>';

    function M(e, t, n) {
        return !e.map(function(e) {
            var r = Object(s.getMessage)(t, n, e);
            return Object(c.isImportant)(r)
        }).reduce(function(e, t) {
            return e && t
        }, !0)
    }

    function P(e, t) {
        var n = t.get(),
            r = n.peer,
            o = n.tabs[r].pinned;
        return 1 === e.length && o && e[0] === Object(s.parserMessage)(o).messageId
    }

    function x(e, t, n) {
        var r = getLang("mail_selected_shorted", t.length);
        A({
            actions: !0
        }, "im-page--chat-header"), val(geByClass1("im-page--selected-messages"), getTemplate("im_selected_messages", {
            label: r.replace("{count}", t.length),
            tip: getLang("mail_deselect_all")
        }));
        var o = Object(s.getTab)(n, n.get().peer),
            a = e.querySelector("." + v),
            c = M(t, n, n.get().peer),
            u = P(t, n),
            l = Object(i.isChatPeer)(o.peerId) && Object(p.canPinOrUnpin)(n, o.peerId),
            d = Object(i.isFvkcomgroup)(n, o.peerId),
            f = e.querySelector("." + y + '[data-action="respond"]'),
            _ = Boolean(Object(s.tabIsOutgoingMessageRequest)(o)),
            m = Boolean(Object(s.tabIsMessageRequest)(o));
        toggleClass(a, "im-page--mess-actions_important", !c), toggleClass(a, "im-page--mess-actions_pinned", u), toggleClass(a, "im-page--mess-actions_vkcomgroup", d && !n.get().gid), toggleClass(a, "im-page--mess-actions_multiple-selection", t.length > 1), toggleClass(a, "im-page--mess-actions_no-pin-btn", !l), toggleClass(a, "im-page--mess-actions_out-mr", _), toggleClass(a, "im-page--mess-actions_in-mr", m), t.length > 1 ? f.innerHTML = getLang("mail_forward_here") : f.innerHTML = getLang("mail_im_mark_reply");
        var g = c ? getLang("mail_im_toggle_important") : getLang("mail_im_toggle_important_off"),
            h = u ? getLang("mail_unpin") : getLang("mail_pin");
        attr(geByClass1("im-page-action_star", e), "aria-label", g), attr(geByClass1("im-page-action_pin", e), "aria-label", h)
    }

    function I(e, t, n) {
        var r = t.get(),
            a = r.peer,
            c = r.tabs[a],
            d = clean(stripHTML(unclean(c.tab))),
            f = geByClass1(w, e),
            p = geByClass1(i.PINNED_CONTAINER_CLASS),
            _ = Object(i.isChatPeer)(a),
            m = _ && Object(i.isFvkcomgroup)(t, a);
        f.tt = !1;
        var h = Object(i.renderPhotosFromTab)(t, c, !0),
            y = getTemplate("im_simple_link", {
                href: m ? "/club" + -c.ownerId : c.href,
                content: getTemplate("im_peer_photo", {
                    online_class: "",
                    owner_photo: h,
                    modifier_class: "nim-peer_smaller"
                })
            });
        val(geByClass1("im-page--aside-photo", e), y);
        var O, E, C, j = _ ? !c.data.closed && !c.data.kicked : 0,
            k = {
                muted: inArray(a, r.mutedPeers),
                verified: !!c.verified,
                chat: _,
                vkcomgroup: m,
                actions: !1,
                derelict: _ && !j && !m,
                pinned: !1
            };
        if (_) {
            var T = Object(s.getPinnedMessage)(t),
                S = function(e) {
                    var t = Object(s.getPinnedMessage)(e);
                    if (!t || Object(u.oCacheGet)(e, t.userId)) return !1;
                    return t.userId
                }(t);
            T && Object(l.isPinnedMessageVisibleInTab)(t, a) && (S ? t.set(o.loadChatMember.bind(null, (O = {}, E = a, C = [S], E in O ? Object.defineProperty(O, E, {
                value: C,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : O[E] = C, O))).then(I.bind(null, e, t, n)) : k.pinned = !0)
        }
        var M = "";
        _ ? M = m ? getTemplate("im_vkcomgroup_members", {
            name: getLang("mail_im_n_vkcomgroup_members", Object(i.getAliveMembersCount)(c))
        }) : j ? getTemplate("im_chat_members", {
            name: getLang("mail_im_n_chat_members", Object(i.getAliveMembersCount)(c))
        }) : "" : Object(i.isUserPeer)(a) && (M = Object(i.getLastSeenTextInHeader)(t, a));
        var P = getTemplate("im_simple_name", {
            name: c.tab,
            href: m ? "/club" + -c.ownerId : c.href,
            name_attr: d,
            ads_union: c.ad_union_ids_attr,
            online: M,
            more_cls: "" === M ? "im-page--title--1line" : ""
        });
        val(geByClass1("im-page--title-wrapper", e), P);
        var x = val(p) && !c.top_banner,
            L = D(t) && !c.top_banner,
            R = geByClass1(g, e);
        if (removeClass(R, i.DESELECT_ALL_CLASS), show(geByClass1(b, e)), removeClass(geByClass1(v, e), "im-page--mess-actions_visible"), removeClass(geByClass1(v, e), "im-page--mess-actions_all-sel"), function(e, t, n) {
                geByClass("_im_header_icon", e).forEach(function(e) {
                    if (n.length > 0) hide(e);
                    else if ("star" === domData(e, "type") && Object(i.isFoldersAvailable)(t) && (toggleClass(e, "im-page--header-icon_star-active", Object(i.isImportant)(t)), setStyle(e, {
                            display: "inline-block"
                        })), "answer" === domData(e, "type") && Object(i.isFoldersAvailable)(t) && (toggleClass(e, "im-page--header-icon_answer-shown", Object(i.isUnrespond)(t)), Object(i.isUnrespond)(t) ? setStyle(e, {
                            display: "inline-block"
                        }) : hide(e)), "search" === domData(e, "type") && !Object(i.isCommunityInterface)(t)) {
                        var r = Object(i.isFullyLoadedTab)(t, t.get().peer) && t.get().tabs[t.get().peer].offset;
                        setStyle(e, {
                            display: "inline-block"
                        }), toggleClass(e, "im-page-header-icon_search-shown", r)
                    }
                })
            }(e, t, []), Object(i.isClassicInterface)(t)) {
            var B = geByClass1("_im_page_back", e);
            attr(B, "href", Object(i.getBaseLink)(t) + "?tab=" + r.active_tab)
        }
        A(k, "im-page--chat-header"), Object(i.compensateHistoryHeightChange)(t, L, x, n)
    }

    function D(e) {
        var t = Object(s.getPinnedMessage)(e),
            n = geByClass1(i.PINNED_CONTAINER_CLASS);
        if (removeClass(n, "im-page--pinned_with-bar"), t && Object(c.isMoneyRequest)(t)) {
            if (void 0 === t.kludges.attach1_tr_amount) return;
            t.kludges.attach1_total_amount && addClass(n, "im-page--pinned_with-bar")
        }
        var r = Object(i.renderPinnedMessage)(e);
        return val(n, r), !!r
    }

    function A(e, t) {
        var n = geByClass1(t);
        Object.keys(e).forEach(function(r) {
            toggleClass(n, t + "_" + r, !!e[r])
        })
    }

    function L(e, t, n, r, i) {
        e.set(o.removeMessagesWithRestore.bind(null, n, i, r)).then(t().removeMessagesRestore.bind(null, n, i, r)), Object(o.removeMessageSend)(n, i, null, r, e.get())
    }

    function R(e, t, n) {
        if (Object(i.isChatPeer)(t)) {
            var r = e.get().tabs[t].name,
                a = function(e, t, n, r, i, a) {
                    if ("keydown" !== a.type || 13 === a.which) {
                        var s = trim(val(i));
                        return s ? (s !== n && e.set(o.updateChatTopic.bind(null, t, s)), !0) : (notaBene(i), !1)
                    }
                }.bind(null, e, t, r, n),
                s = showFastBox({
                    title: getLang("mail_chat_topic_change_title"),
                    dark: 1
                }, getTemplate("im_chat_change_topic", {
                    value: r
                }), getLang("global_save"), function(e, t) {
                    a(c, t) && s.hide()
                }, getLang("global_cancel"), function() {
                    s.hide()
                }),
                c = geByClass1(O, s.bodyNode);
            elfocus(c), addEvent(c, "keydown", function(e) {
                a(c, e) && s.hide()
            })
        }
    }

    function B(e, t, n, r, c, u) {
        var d = domData(u, "action"),
            f = geByClass1(h, r).parentNode,
            p = e.get().peer;
        switch (d) {
            case "clear":
                var m = Object(s.getTab)(e, p),
                    g = Object(i.showFlushChat)(m, p, function() {
                        Object(i.cleanHistory)(e, g, t, o.flushHistory, e.get().peer)
                    });
                break;
            case "photos":
            case "media":
                showWiki({
                    w: "history" + Object(i.convertPeerToUrl)(p) + "_photo"
                }, null, {});
                break;
            case "topic":
                R(e, p, t);
                break;
            case "avatar":
                cur.recieveCropResult = void 0, Page.ownerPhoto(p, {
                    gid: e.get().gid
                });
                break;
            case "search":
                t().showSearch(e);
                break;
            case "block_community":
                e.set(o.toggleCommunityMessages.bind(null, !1, p)).then(function() {
                    e.get().longpoll.push([Object(a.resetPeer)()]), showDoneBox(getLang("mail_community_was_blocked"))
                });
                break;
            case "allow_community":
                e.set(o.toggleCommunityMessages.bind(null, !0, p)).then(function() {
                    n().changeActions(e)
                });
                break;
            case "block":
                Object(i.showBlacklistBox)(p, e).once("success", function(t) {
                    t.delta && (showDoneBox(t.msg), e.get().longpoll.push([Object(a.resetPeer)()]))
                });
                break;
            case "leave":
                var b = Object(i.showLeaveDialog)(e, p, function(n) {
                    n && Object(i.cleanHistory)(e, b, t, o.flushHistory, p), e.set(o.leaveChat.bind(null, p)), e.set(o.unpinMessageOptimistic.bind(null, p)), b.hide(), e.get().longpoll.push([Object(a.resetPeer)()])
                });
                break;
            case "invite_link":
                var v = function(e, t, n) {
                        var r = showFastBox({
                            title: getLang("mail_chat_invite_link"),
                            dark: 1
                        }, getLang("mail_chat_reset_link_warning"), getLang("mail_chat_reset_link_confirm"), function(i) {
                            var a = gpeByClass("_im_invite_box", n.target),
                                s = geByClass1(T, a),
                                c = geByClass1("_im_invite_new", a);
                            lockButton(r.btns.ok[0]), Object(o.resetInviteLink)(t, e.get()).then(function(e) {
                                var t = _(e, 1)[0];
                                unlockButton(r.btns.ok[0]), s.value = t, unlockButton(c), addClass(a, "im-invite-box_reseted"), elfocus(s, 0, t.length), r.hide()
                            })
                        }, getLang("global_cancel"), function() {
                            r.hide()
                        })
                    }.bind(null, e, p),
                    y = !1,
                    O = !1,
                    w = !1,
                    E = function() {
                        elfocus(y, 0, y.value.length), document.execCommand("copy"), setStyle(O, {
                            opacity: 1
                        }), w && (w = clearTimeout(w)), w = setTimeout(function() {
                            return setStyle(O, {
                                opacity: 0
                            })
                        }, 2e3)
                    },
                    C = !1,
                    j = !1;
                showBox("al_im.php", {
                    act: "a_get_link",
                    gid: e.get().gid,
                    chat_id: p - 2e9,
                    markup: 1
                }, {
                    onDone: function(e) {
                        y = geByClass1(T, e.bodyNode), C = geByClass1("_im_reset_link", e.bodyNode), j = geByClass1("_im_invite_copy", e.bodyNode), O = geByClass1("_im_invite_copied", e.bodyNode), elfocus(y, 0, y.value.length), addEvent(C, "click", v), addEvent(j, "click", E)
                    },
                    params: {
                        hideButtons: !0,
                        onHide: function() {
                            removeEvent(C, "click", v), removeEvent(j, "click", E)
                        },
                        onShow: function() {
                            addEvent(C, "click", v), addEvent(j, "click", E)
                        }
                    }
                }, {});
                break;
            case "return":
                e.set(o.returnToChat.bind(null, p)).then(function(e) {
                    return e.set(o.getPinnedMessage.bind(null, p))
                }).then(t().updateChatTopic.bind(null, p)).catch(function(e) {
                    showFastBox(getLang("global_error"), e)
                });
                break;
            case "unmute":
            case "mute":
                e.set(o.toggleMutePeer.bind(null, p, "mute" === d)).then(t().updateState.bind(null, p));
                break;
            case "chat":
            case "invite":
                if (Object(i.isChatPeer)(p)) Object(i.inviteUser)(e, p, t, o.setCreationType);
                else if (Object(i.isUserPeer)(p)) {
                    var k = e.get().tabs[p],
                        S = [
                            [p, k.tab]
                        ];
                    e.set(o.setCreationType.bind(null, "chat", [])).then(function() {
                        return t().showCreation(e, S)
                    })
                }
                break;
            case "pin_hide":
                Object(l.pinnedMessageHide)(e, Object(s.getPeer)(e), t);
                break;
            case "pin_unhide":
                Object(l.pinnedMessageUnHide)(e, Object(s.getPeer)(e), t);
                break;
            case "unpin":
                Object(l.pinnedMessageUnpin)(e, Object(s.getPeer)(e), t);
                break;
            case "settings":
                n().showSettings(e)
        }
        uiActionsMenu.toggle(f, !1), t().cancelEditing()
    }

    function N(e, t, n) {
        var r = e.get().selectedMessages;
        e.set(o.cleanSelected).then(n().changedMessageSelection).then(t().cleanSelection.bind(null, r))
    }

    function U(e, t, n, r) {
        var o = Object(i.isClassicInterface)(e),
            a = void 0,
            s = void 0;
        switch (domData(r, "type")) {
            case "star":
                s = [4, 6], a = function() {
                    return Object(i.isImportant)(e) ? getLang("mail_im_toggle_important_off") : getLang("mail_im_toggle_important")
                };
                break;
            case "answer":
                s = [4, 6], a = getLang("mail_end_conversation");
                break;
            case "search":
                s = o ? [5, 6] : [4, -9], a = getLang("mail_search_in_peer")
        }
        showTooltip(r, {
            text: a || "",
            black: 1,
            shift: s,
            forcetoup: !0,
            appendParentCls: o ? "_im_dialog_actions" : "_im_mess_actions"
        })
    }

    function F(e, t, n) {
        var r = Object(i.isClassicInterface)(e),
            o = domData(n.target, "action");
        "respond" !== o && "forward" !== o && showTooltip(n.target, {
            text: function(e, t) {
                var n = e.get(),
                    r = n.selectedMessages,
                    o = n.peer;
                switch (t) {
                    case "pin":
                        return P(r, e) ? getLang("mail_unpin") : getLang("mail_pin");
                    case "star":
                        return M(r, e, o) ? getLang("mail_im_toggle_important") : getLang("mail_im_toggle_important_off");
                    case "delete":
                        return getLang("mail_delete");
                    case "spam":
                        return getLang("mail_im_mark_spam")
                }
            }.bind(null, e, o) || "",
            black: 1,
            shift: [2, r ? -4 : 11],
            forcetodown: !0,
            appendParentCls: "_im_dialog_actions"
        })
    }

    function H(e, t, n, a) {
        return {
            changeActions: function(t) {
                var n = geByClass1(h, e),
                    r = geByClass1(b, e),
                    i = t.get().curActions,
                    a = Object.keys(i).map(function(e, t) {
                        var n = "";
                        return 7 !== o.ACTION_PRIORITIES[e] && 10 !== o.ACTION_PRIORITIES[e] || 0 === t || (n = '<div class="ui_actions_menu_sep"></div>'), n + rs(S, {
                            name: i[e].name,
                            icon: i[e].icon,
                            action: e
                        })
                    }).join("");
                0 === Object.keys(i).length ? addClass(r, "im-page--header-more_loading") : (val(n, a), removeClass(r, "im-page--header-more_loading"))
            },
            showSettings: function(t) {
                var n = t.get(),
                    r = Object(s.getTab)(t, n.peer);
                r.data.closed || r.data.kicked || Object(d.mount)(e, t, a)
            },
            showForward: function(t) {
                Object(f.mount)(e, t, a)
            },
            renderPeer: function(n) {
                I(e, n, t)
            },
            reRenderPinned: function(e) {
                var t = Object(s.getCurrentTab)(e);
                t && t.pinned && D(e)
            },
            renderActions: function(t) {
                var n = t.get().selectedMessages || [];
                n.length > 0 && x(e, n, t)
            },
            hideActions: function(t) {
                if (!Object(i.isFullyLoadedTab)(t, t.get().peer)) {
                    var n = geByClass1(b, e);
                    addClass(n, "im-page--header-more_loading")
                }
            },
            changedMessageSelection: function(n) {
                if (0 !== n.get().peer) {
                    var r = n.get().selectedMessages || [];
                    r.length > 0 ? x(e, r, n) : I(e, n, t)
                }
            },
            updateLastSeen: function(t) {
                ! function(e, t) {
                    var n = e.get().peer,
                        r = geByClass1("_im_page_peer_online", t);
                    r && Object(i.isUserPeer)(n) && Object(s.getTab)(e, n) && Object(i.applyInnerHtml)(r, Object(i.getLastSeenTextInHeader)(e, n))
                }(t, e)
            },
            deselectAll: function(e) {
                N(e, t, a)
            },
            unmount: function() {
                Object(r.destroyModule)(n), cancelStackFilter("fowrward")
            }
        }
    }

    function W(e, t, n) {
        var c = Object(r.createMutations)(H),
            u = c.callMutations,
            l = c.bindMutations,
            d = function(e, t, n, r, c) {
                var u = e.get().selectedMessages,
                    l = domData(c, "action"),
                    d = e.get().peer,
                    f = !0,
                    p = Object(s.getTab)(e, d);
                if ("star" !== l && Object(s.tabIsOutgoingMessageRequest)(p)) return N(e, t, n);
                switch (l) {
                    case "delete":
                        var _ = !(vk.id == d && !e.get().gid) && u.every(function(t) {
                            return Object(i.canMessageBeDeletedForAll)(e, Object(s.getMessage)(e, d, t))
                        });
                        if (_ || u.length > 1) {
                            f = !1;
                            var m = Object(i.showMsgDeleteDialog)(d, u.length, _, function(r) {
                                N(e, t, n), m.hide(), cur.imDb.updateByKey("del_forall_checked", r), r ? Object(o.removeMessageSend)(u, d, null, "deleteforall", e.get()) : L(e, t, u, l, d)
                            })
                        } else L(e, t, u, l, d);
                        break;
                    case "spam":
                        L(e, t, u, l, d);
                        break;
                    case "forward":
                        Object(o.processFwd)(u, e.get().peer, e).then(function(t) {
                            return e.set(o.prepareForward.bind(null, t))
                        }).then(function() {
                            return n().showForward(e)
                        }).catch(function(e) {
                            return console.error(e)
                        });
                        break;
                    case "star":
                        var g = M(u, e, d);
                        e.set(o.favMessage.bind(null, u, g, d)), e.get().longpoll.push(u.map(function(e) {
                            return {
                                type: g ? a.SET_FLAGS : a.RESET_FLAGS,
                                messageId: e,
                                peerId: d,
                                flags: a.FLAG_IMPORTANT
                            }
                        }));
                        break;
                    case "respond":
                        var h = e.get(),
                            b = 1 === u.length;
                        Object(o.processFwd)(u, h.peer, e).then(function(t) {
                            return e.set(o.forwardMessages.bind(null, t, h.tfdraft, b))
                        }).then(function() {
                            t().respond(e, d)
                        });
                        break;
                    case "pin":
                        var v = Object(s.getLocalId)(e, u[0]),
                            y = P(u, e),
                            O = y ? o.unpinMessageOptimistic.bind(null, d) : o.pinMessageOptimistic.bind(null, v, d),
                            w = y ? o.unpinMessage.bind(null, d) : o.pinMessage.bind(null, v, d),
                            E = function(e, t, n) {
                                return e().updateChatTopic(t, n), n
                            }.bind(null, t, d);
                        e.set(o.checkChatMember.bind(null, e, v, d)).then(function(e) {
                            return e.set(O)
                        }).then(E).then(function(e) {
                            return e.set(w)
                        }).then(E)
                }
                f && N(e, t, n)
            }.bind(null, t, n, u),
            f = B.bind(null, t, n, u, e),
            p = N.bind(null, t, n, u),
            _ = function(e, n) {
                return Object(i.showVerifiedTooltip)(n, t.get().peer)
            },
            g = U.bind(null, t, e),
            h = F.bind(null, t, e),
            b = function(e, t, n, r, i) {
                switch (domData(i, "type")) {
                    case "star":
                        e.set(o.toggleDialogImportant.bind(null, e.get().peer)).then(function() {
                            setTimeout(function() {
                                return U(e, 0, 0, i)
                            }, 40)
                        });
                        break;
                    case "search":
                        n().showSearch(e), window.tooltips && tooltips.hide(i, {
                            fasthide: !0
                        });
                        break;
                    case "answer":
                        var c = Object(s.getTab)(e, e.get().peer);
                        c && (e.set(o.markDialogAnswered.bind(null, e.get().peer, c.lastmsg)), showDoneBox(getLang("mail_marked_as_answered"), {
                            out: 1e3
                        }), e.get().longpoll.push([Object(a.resetPeer)()]))
                }
            }.bind(null, t, e, n),
            v = function() {
                return u().showSettings(t)
            },
            O = function(t) {
                !gpeByClass(E, t.target, e) || gpeByClass(C, t.target, e) || checkEvent(t) || (v(), cancelEvent(t))
            },
            T = Object(r.createModule)({
                handlers: function(n, r) {
                    r(e, "click", y, d), r(e, "click", m, f), r(e, "click", i.DESELECT_ALL_CLASS, p), r(e, "mouseover", w, _), r(e, "mouseover", "_im_header_icon", g), r(e, "mouseover", y, h), r(e, "click", "_im_header_icon", b), r(e, "click", "_im_header_link", O), r(e, "click", j, O), r(e, "click", k, v), r(e, "click", "_im_page_back", function(e) {
                        checkEvent(e) || (t.get().longpoll.push([Object(a.resetPeer)()]), cancelEvent(e))
                    })
                }
            });
        return Object(i.isReservedPeer)(t.get().peer) || setTimeout(function() {
            t.set(o.setActions).then(u().changeActions)
        }), l(e, n, T, u)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "getNativeOption", function() {
        return i
    }), n.d(t, "setNativeOption", function() {
        return a
    }), n.d(t, "createScroll", function() {
        return l
    });
    var r = n(256);

    function o(e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
    }

    function i(e, t) {
        return bodyNode[e] || document.documentElement[e]
    }

    function a(e, t, n) {
        "scrollTop" === e && window.scrollTo(0, t)
    }
    var s = function() {
            function e(t, n) {
                var i = this;
                o(this, e), this.el = t, this.opts = n, this.module = Object(r.createModule)({
                    handlers: function(e, t) {
                        e(window, "scroll", i.onScroll.bind(i)), e(window, "resize", i.resize.bind(i))
                    }
                }), this.innerHeight = window.innerHeight, this.prevScroll = this.scrollTop()
            }
            return e.prototype.update = function() {}, e.prototype.resize = function() {
                this.innerHeight = window.innerHeight
            }, e.prototype.scrollTop = function(e) {
                if (void 0 === e) return i("scrollTop", this.el);
                a("scrollTop", e, this.el)
            }, e.prototype.contHeight = function() {
                return i("scrollHeight")
            }, e.prototype.smoothScroll = function(e) {
                scrollToY(e + this.scrollTop(), 300)
            }, e.prototype.getContainer = function() {
                return this.el
            }, e.prototype.scrollBottom = function(e) {
                if (void 0 === e) return this.contHeight() - this.scrollTop() - this.getScrollHeight();
                var t = this.contHeight() - e - this.getScrollHeight();
                this.scrollTop(t)
            }, e.prototype.scrollBottomFixSave = function(e) {
                var t = this,
                    n = Date.now();
                window.addEventListener("scroll", function r() {
                    Date.now() - n < 500 && t.scrollBottom(e), window.removeEventListener("scroll", r)
                }), this.scrollBottom(e)
            }, e.prototype.onScroll = function(e) {
                var t = this.scrollTop(),
                    n = t - this.prevScroll,
                    r = this.contHeight();
                this.opts.onScroll && this.opts.onScroll(-n, this), this.opts.scrollChange && this.opts.scrollChange(t), this.opts.more && r - t < 2 * this.innerHeight && this.opts.more(this), this.prevScroll = t
            }, e.prototype.getScrollHeight = function() {
                return this.innerHeight
            }, e.prototype.destroy = function() {
                Object(r.destroyModule)(this.module)
            }, e
        }(),
        c = function() {
            function e(t, n) {
                var r = this;
                o(this, e), this.prevTop = 0, this.scroll = new uiScroll(t, {
                    hidden: void 0 === n.hidden || n.hidden,
                    shadows: n.shadows,
                    stopScrollPropagation: !1,
                    theme: n.scrollTheme,
                    onmore: function() {
                        return n.more && n.more(r)
                    },
                    onscroll: function(e) {
                        var t = r.scrollTop(),
                            o = r.prevTop - t;
                        r.prevTop = t, n.scrollChange && n.scrollChange(t), n.onScroll && n.onScroll(o, r)
                    }
                })
            }
            return e.prototype.update = function() {
                this.scroll.update("sync")
            }, e.prototype.scrollTop = function(e) {
                return void 0 !== e ? this.scroll.scrollTop(e) : this.scroll.data.scrollTop
            }, e.prototype.getContainer = function() {
                return this.scroll.content
            }, e.prototype.contHeight = function() {
                return this.scroll.data.scrollHeight
            }, e.prototype.smoothScroll = function(e) {
                this.scroll.scrollTop(this.scrollTop() + e, 300)
            }, e.prototype.scrollBottom = function(e) {
                return void 0 !== e ? this.scroll.scrollBottom(e) : this.scroll.data.scrollBottom
            }, e.prototype.scrollBottomFixSave = function(e) {
                var t = this,
                    n = Date.now();
                this.scroll.emitter.addOnceListener("resize", function() {
                    Date.now() - n < 500 && t.scroll && t.scrollBottom(e)
                }), this.scrollBottom(e)
            }, e.prototype.getScrollHeight = function() {
                return this.scroll.data.viewportHeight
            }, e.prototype.destroy = function() {
                this.scroll.destroy()
            }, e
        }(),
        u = function() {
            function e(t, n) {
                o(this, e), this.el = t
            }
            return e.prototype.update = function() {}, e.prototype.getContainer = function() {
                return this.el
            }, e.prototype.scrollTop = function(e) {
                return 0
            }, e.prototype.contHeight = function() {
                return 0
            }, e.prototype.smoothScroll = function(e) {}, e.prototype.scrollBottom = function(e) {
                return 0
            }, e.prototype.scrollBottomFixSave = function(e) {}, e.prototype.getScrollHeight = function() {
                return 0
            }, e.prototype.destroy = function() {}, e
        }();

    function l(e, t) {
        return t.noScroll ? new u(e) : t.nativeScroll ? new s(e, t) : new c(e, t)
    }
}, , , function(e, t, n) {
    e.exports = !n(286)(function() {
        return 7 != Object.defineProperty({}, "a", {
            get: function() {
                return 7
            }
        }).a
    })
}, , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "initQueue", function() {
        return f
    });
    var r = n(433),
        o = n(392);

    function i(e, t) {
        return t.queues[e].currEv = !1, Promise.resolve(t)
    }

    function a(e, t) {
        var n = t.queues[e].currEv;
        return n ? (t.queues[e].errored.push(n), i(e, t)) : Promise.resolve(t)
    }

    function s(e, t, n) {
        return n.queues[e] ? (n.queues[e].errored = t ? [] : n.queues[e].errored.concat(n.queues[e].evs), n.queues[e].evs = [], i(e, n)) : Promise.resolve(n)
    }

    function c(e, t, n, r) {
        var o = r.get().queues[e];
        if (o && !o.currEv && o.evs.length > 0 && !o.pause) {
            var s = c.bind(null, e, t, n, r),
                l = o.evs.shift();
            o.currEv = l, t(e, l).then(function() {
                r.get().opts.waitCommit || r.set(i.bind(null, e))
            }).then(s).catch(function(t) {
                return r.set(a.bind(null, e)).then(function() {
                    n(e, function(e, t) {
                        var n = u(e, t.get()).errored;
                        return n.length > 0 && n[n.length - 1]
                    }(e, r), t)
                }).then(s)
            })
        }
    }

    function u(e, t) {
        return t.queues[e] || (t.queues[e] = {
            evs: [],
            pause: !1,
            errored: [],
            currEv: !1
        }), t.queues[e]
    }

    function l(e, t, n) {
        return u(e, n).pause = t, Promise.resolve(n)
    }

    function d(e) {
        Object.keys(e.get().queues).forEach(function(t) {
            e.set(a.bind(null, t)), e.set(s.bind(null, t, !1))
        })
    }

    function f(e, t, n) {
        var a = Object(r.default)({
            queues: {},
            debug: n && n.debug,
            opts: extend({}, n)
        }, n);
        return n && n.store ? (a.setState(function(e) {
            for (var t = {}, n = Object.keys(e.queues), r = n.length, o = 0; o < r; o++) {
                var i = n[o],
                    a = e.queues[i];
                (a.currEv || a.evs.length || a.errored.length) && (t[i] = a)
            }
            return {
                queues: t,
                opts: e.opts
            }
        }(a.get())), d(a)) : d(a), {
            pushMessage: function(n, r) {
                return a.set(function(e, t, n) {
                    return t.ts = Date.now(), u(e, n).evs.push(t), Promise.resolve(n)
                }.bind(null, n, r)).then(function(r) {
                    c(n, e, t, r)
                })
            },
            resend: function(n, r) {
                return a.set(function(e, t, n) {
                    var r = n.queues[e];
                    return r.errored.filter(function(e) {
                        return e.mess.messageId === t
                    }).forEach(function(e) {
                        e.failed = !1, r.evs.push(e)
                    }), r.errored = r.errored.filter(function(e) {
                        return e.mess.messageId !== t
                    }), Promise.resolve(n)
                }.bind(null, n, r)).then(function(o) {
                    var i = a.get().queues[n].evs.filter(function(e) {
                        return e.mess.messageId === r
                    })[0];
                    return c(n, e, t, a), i
                })
            },
            reset: function(n) {
                return a.set(s.bind(null, n, !0)).then(function(r) {
                    c(n, e, t, r)
                })
            },
            setErrored: function(e, t) {
                return a.set(function(n) {
                    return u(e, n).errored = t, Promise.resolve(n)
                })
            },
            pause: function(e) {
                a.set(l.bind(null, e, !0))
            },
            isPaused: function(e) {
                return !!u(e, a.get()).pause
            },
            complete: function(n, r) {
                var o = a.get();
                o.queues[n].currEv && o.queues[n].currEv.rid === r && a.set(i.bind(null, n)).then(function() {
                    c(n, e, t, a)
                })
            },
            resume: function(n) {
                a.set(l.bind(null, n, !1)).then(Object(o.pause)(.1)).then(function() {
                    c(n, e, t, a)
                })
            },
            inspectQueue: function(e) {
                var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
                if (!a.get().queues[e]) return [];
                var n = a.get().queues[e];
                return (t && n.currEv ? [n.currEv] : []).concat(n.evs.slice()).concat(n.errored.slice().map(function(e) {
                    return extend({}, e, {
                        failed: !0
                    })
                })).sort(function(e, t) {
                    return e.ts - t.ts
                })
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "vkLocal", function() {
        return c
    }), n.d(t, "lTimeout", function() {
        return u
    }), n.d(t, "rand", function() {
        return l
    }), n.d(t, "irand", function() {
        return d
    }), n.d(t, "isUndefined", function() {
        return f
    }), n.d(t, "isFunction", function() {
        return p
    }), n.d(t, "isArray", function() {
        return _
    }), n.d(t, "isString", function() {
        return m
    }), n.d(t, "isObject", function() {
        return g
    }), n.d(t, "isEmpty", function() {
        return h
    }), n.d(t, "vkNow", function() {
        return b
    }), n.d(t, "vkImage", function() {
        return v
    }), n.d(t, "trim", function() {
        return y
    }), n.d(t, "stripHTML", function() {
        return O
    }), n.d(t, "escapeRE", function() {
        return w
    }), n.d(t, "intval", function() {
        return E
    }), n.d(t, "floatval", function() {
        return C
    }), n.d(t, "positive", function() {
        return j
    }), n.d(t, "isNumeric", function() {
        return k
    }), n.d(t, "winToUtf", function() {
        return T
    }), n.d(t, "replaceEntities", function() {
        return S
    }), n.d(t, "clean", function() {
        return M
    }), n.d(t, "unclean", function() {
        return P
    }), n.d(t, "each", function() {
        return x
    }), n.d(t, "indexOf", function() {
        return I
    }), n.d(t, "inArray", function() {
        return D
    }), n.d(t, "clone", function() {
        return A
    }), n.d(t, "arrayKeyDiff", function() {
        return L
    }), n.d(t, "extend", function() {
        return R
    }), n.d(t, "addTemplates", function() {
        return B
    }), n.d(t, "getTemplate", function() {
        return N
    }), n.d(t, "serializeForm", function() {
        return U
    }), n.d(t, "extractUrls", function() {
        return F
    }), n.d(t, "isRetina", function() {
        return H
    }), n.d(t, "getCaretCharacterOffsetWithin", function() {
        return W
    }), n.d(t, "formatCount", function() {
        return K
    }), n.d(t, "encodeHtml", function() {
        return G
    }), n.d(t, "decodeHtml", function() {
        return V
    }), n.d(t, "initUtilsCommon", function() {
        return Y
    });
    var r = n(347),
        o = n(220),
        i = n(324),
        a = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        s = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };

    function c(e) {
        var t = PageID;
        return function() {
            t === PageID && e.apply(this, arguments)
        }
    }

    function u(e, t) {
        return setTimeout(c(e), t)
    }
    var l = function(e, t) {
            return Math.random() * (t - e + 1) + e
        },
        d = function(e, t) {
            return Math.floor(l(e, t))
        },
        f = function(e) {
            return void 0 === e
        },
        p = function(e) {
            return e && "[object Function]" === Object.prototype.toString.call(e)
        },
        _ = function(e) {
            return "[object Array]" === Object.prototype.toString.call(e)
        },
        m = function(e) {
            return "string" == typeof e
        },
        g = function(e) {
            return "[object Object]" === Object.prototype.toString.call(e)
        };

    function h(e) {
        if ("[object Object]" !== Object.prototype.toString.call(e)) return !1;
        for (var t in e)
            if (e.hasOwnProperty(t)) return !1;
        return !0
    }
    var b = function() {
            return +new Date
        },
        v = function() {
            return window.Image ? new Image : Object(r.ce)("img")
        },
        y = function(e) {
            return (e || "").replace(/^\s+|\s+$/g, "")
        },
        O = function(e) {
            return e ? e.replace(/<(?:.|\s)*?>/g, "") : ""
        },
        w = function(e) {
            return e ? e.replace(/([.*+?^${}()|[\]\/\\])/g, "\\$1") : ""
        };

    function E(e) {
        return !0 === e ? 1 : parseInt(e) || 0
    }

    function C(e) {
        return !0 === e ? 1 : parseFloat(e) || 0
    }

    function j(e) {
        return (e = E(e)) < 0 ? 0 : e
    }

    function k(e) {
        return !isNaN(e)
    }

    function T(e) {
        return e.replace(/&#(\d\d+);/g, function(e, t) {
            return (t = E(t)) >= 32 ? String.fromCharCode(t) : e
        }).replace(/&quot;/gi, '"').replace(/&lt;/gi, "<").replace(/&gt;/gi, ">").replace(/&amp;/gi, "&")
    }

    function S() {
        var e = (arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");
        return Object(r.se)("<textarea>" + e + "</textarea>").value
    }

    function M(e) {
        return e ? e.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") : ""
    }

    function P(e) {
        return S(e.replace(/\t/g, "\n"))
    }

    function x(e, t) {
        if (g(e) || void 0 === e.length) {
            for (var n in e)
                if (Object.prototype.hasOwnProperty.call(e, n) && !1 === t.call(e[n], n, e[n])) break
        } else
            for (var r = 0, o = e.length; r < o; r++) {
                var i = e[r];
                if (!1 === t.call(i, r, i)) break
            }
        return e
    }

    function I(e, t, n) {
        for (var r = n || 0, o = (e || []).length; r < o; r++)
            if (e[r] == t) return r;
        return -1
    }

    function D(e, t) {
        return -1 !== I(t, e)
    }

    function A(e, t) {
        var n = g(e) || void 0 === e.length ? {} : [];
        for (var r in e)(!/webkit/i.test(_ua) || "layerX" != r && "layerY" != r && "webkitMovementX" != r && "webkitMovementY" != r) && (t && "object" === s(e[r]) && "prototype" !== r && null !== e[r] ? n[r] = A(e[r]) : n[r] = e[r]);
        return n
    }

    function L(e) {
        var t = {},
            n = arguments.length,
            r = arguments;
        for (var o in e)
            if (e.hasOwnProperty(o)) {
                for (var i = !1, a = 1; a < n; a++) r[a][o] && r[a][o] === e[o] && (i = !0);
                i || (t[o] = e[o])
            }
        return t
    }

    function R() {
        var e = arguments,
            t = e.length,
            n = e[0] || {},
            r = 1,
            o = !1;
        for ("boolean" == typeof n && (o = n, n = e[1] || {}, r = 2), "object" === (void 0 === n ? "undefined" : s(n)) || p(n) || (n = {}); r < t; r++) {
            var i = e[r];
            if (null != i)
                for (var a in i)
                    if (i.hasOwnProperty(a)) {
                        var c = n[a],
                            u = i[a];
                        n !== u && (o && u && "object" === (void 0 === u ? "undefined" : s(u)) && !u.nodeType ? n[a] = R(o, c || (null != u.length ? [] : {}), u) : void 0 !== u && (n[a] = u))
                    }
        }
        return n
    }

    function B(e) {
        window.templates = window.templates || {}, R(window.templates, e)
    }

    function N(e, t) {
        var n = (window.templates = window.templates || {})[e];
        return "function" == typeof n && (n = n()), n && t ? Object(r.rs)(n, t) : n || ""
    }

    function U(e) {
        if ("object" !== (void 0 === e ? "undefined" : s(e))) return !1;
        var t = {},
            n = function(t) {
                return Object(r.geByTag)(t, e)
            },
            o = function(n, o) {
                if (o.name)
                    if ("text" !== o.type && o.type)
                        if (o.getAttribute("bool")) {
                            var a = Object(r.val)(o);
                            if (!a || "0" === a) return;
                            t[o.name] = 1
                        } else t[o.name] = i.browser.msie && !o.value && e[o.name] ? e[o.name].value : o.value;
                else t[o.name] = Object(r.val)(o)
            };
        return x(n("input"), function(e, t) {
            if ("radio" !== t.type && "checkbox" !== t.type || t.checked) return o(0, t)
        }), x(n("select"), o), x(n("textarea"), o), t
    }

    function F(e, t) {
        for (var n = t ? /(?:([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9_\-]+\.)+(?:[a-z]{2,9}|xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)&]*(&nbsp;|[ \t\r\n \u00A0]|$))|([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9а-яєґї_\-]+\.)+(?:рф|укр|онлайн|сайт|срб))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)&]*(&nbsp;|[ \t\r\n \u00A0]|$)))/i : /(?:([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9_\-]+\.)+(?:[a-z]{2,9}|xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)]*(&nbsp;|[ \t\r\n \u00A0]))|([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9а-яєґї_\-]+\.)+(?:рф|укр|онлайн|сайт|срб))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)]*(&nbsp;|[ \t\r\n \u00A0])))/i, r = void 0, o = []; e && (r = e.match(n));) {
            e = e.substr(r.index + r[0].length);
            var i = 0;
            r[4] || (i = 7), o.push({
                url: r[2 + i],
                query: r[5 + i] || "",
                domain: r[4 + i]
            })
        }
        return o
    }
    var H = function() {
        return window.devicePixelRatio >= 2
    };

    function W(e) {
        var t = 0,
            n = 0,
            r = e.ownerDocument || e.document,
            o = r.defaultView || r.parentWindow;
        if (o.getSelection().rangeCount > 0) {
            var i = o.getSelection().getRangeAt(0),
                a = i.cloneRange();
            a.selectNodeContents(e), a.setEnd(i.startContainer, i.startOffset), t = a.toString().length, a.setEnd(i.endContainer, i.endOffset), n = a.toString().length
        }
        return [t, n]
    }

    function K(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
            n = t.kLimit || 1e3;
        return e >= (t.mLimit || 1e6) && !t.noCheck ? K(e = (e = E(e / 1e5)) > 1e3 ? E(e / 10) : e / 10, R(t, {
            noCheck: !0
        }), !0) + "M" : e >= n && !t.noCheck ? K(e = (e = E(e / 100)) > 100 ? E(e / 10) : e / 10, R(t, {
            noCheck: !0
        }), !0) + "K" : Object(o.langNumeric)(e, "%s", !0).replace(/,/g, ".")
    }
    var q, z = a((q = null, [function(e) {
            return q || (q = Object(r.se)("<span> </span>")), q.innerText = e, q.innerHTML
        }, function(e) {
            return q || (q = Object(r.se)("<span> </span>")), q.innerHTML = e.replace(/<br\s*\/?>/gim, "\n"), q.innerText
        }]), 2),
        G = z[0],
        V = z[1];

    function Y() {
        window.PageID = window.PageID || 1
    }
}, function(e, t, n) {
    "use strict";
    e.exports = "SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "RECENT_SEARCH_OP", function() {
        return o
    }), n.d(t, "PIN_HIDDEN_ID_OP", function() {
        return i
    }), n.d(t, "deleteOldStoredFormat", function() {
        return u
    }), n.d(t, "mount", function() {
        return l
    });
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        o = "recent_search",
        i = "pin_hide";

    function a(e) {
        return "im_store_" + e
    }

    function s(e) {
        return ls.get(a(e)) || {}
    }

    function c(e, t, n) {
        if (ls.checkVersion()) {
            var r = JSON.stringify(t);
            rand(0, 1e5) <= 1 && statlogsValueEvent("im_local_store_size", r.length), n(a(e), r)
        }
    }

    function u(e, t) {
        for (var n = ["fwd", "draft", "bind_attach"], r = s(e), o = !1, i = n.length; i--;) n[i] in r && (delete r[n[i]], o = !0);
        o && c(e, r, t)
    }

    function l(e) {
        var t = debounce(function(e, t) {
            localStorage.setItem(e, t)
        }, 300);
        ls.checkVersion() && u(e, t);
        var n = {
                db: s(e),
                checkTime: Date.now()
            },
            l = function(e, t, n) {
                n.key === a(e) && (t.db = JSON.parse(n.newValue), t.checkTime = Date.now())
            }.bind(null, e, n);
        return window.addEventListener("storage", l, !1), {
            select: function(t, r) {
                return Date.now() - n.checkTime > 1e3 && (n.db = s(e)),
                    function(e, t, n) {
                        return t === o ? e[t] || [] : t === i ? e[t] && e[t][n] : e[t] ? extend(!0, {}, e[t][n]) : null
                    }(n.db, t, r)
            },
            selectByKey: function(t) {
                return Date.now() - n.checkTime > 1e3 && (n.db = s(e)), n.db[t]
            },
            update: function(a, s) {
                var u = function(e, t, n) {
                    switch (e[t] || (e[t] = {}), t) {
                        case o:
                            var a = n;
                            a && a.length > 0 ? e[t] = a : delete e[t];
                            break;
                        case i:
                            var s = r(n, 2),
                                c = s[0],
                                u = s[1];
                            u ? e[t][c] = +u : delete e[t][c]
                    }
                    return e
                }(n.db, a, s);
                return n.db = u, n.checkTime = Date.now(), c(e, u, t)
            },
            updateByKey: function(r, o) {
                return n.db[r] = o, n.checkTime = Date.now(), c(e, n.db, t)
            },
            unmount: function() {
                window.removeEventListener("storage", l, !1)
            }
        }
    }
}, , function(e, t) {
    e.exports = {
        im_img_prebody: '<div class="im-prebody"> <img alt="" src="%photo%" /> </div>',
        im_admin_link: ' (<a href="%href%" class="_im_admin_name" target="_blank">%name%</a>)',
        im_right_menu_tpl: '<a id="ui_rmenu_peer_%peer%" href="%href%" class="_im_peer_tab ui_rmenu_item %cls%"%attrs%>\n  <span>%label%</span>\n</a>',
        im_right_menu_sep: '<div class="ui_rmenu_sep"></div>',
        im_right_menu_ct: '<span class="ui_rmenu_count im-right-menu--count _im_r_ct">%count%</span> <button type="button" class="im-right-menu--close _im_r_cl"></button><span class="im-right-menu--text _im_r_tx">%name%</span>',
        im_dialogs_link_img: '<a href="%href%" class="_im_peer_target _online_reader" target="_blank"><div class="im_grid">%photo%</div></a>',
        im_dialogs_link: '<a href="%href%" class="_im_peer_target _online_reader" target="_blank">%photo%</a>',
        im_peer_photo: '<div class="nim-peer %online_class% %modifier_class%"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo"> %owner_photo% </div> </div> </div>',
        im_owner_item: '<a href="%link%" class="olist_item_wrap%cls%" id="olist_item_wrap%owner_id%" >\n  <div class="olist_item clear_fix">\n    <div class="olist_item_photo_wrap %img_cls%">\n      <img class="olist_item_photo" src="%photo%"/>\n    </div>\n    <div class="olist_item_name">%name%</div>\n    <div class="olist_checkbox"></div>\n  </div>\n</a>',
        im_simple_name: '<div class="im-page--title %more_cls%"> <span class="im-page--title-main" title="%name_attr%" %ads_union%><span class="im-page--title-main-in"><a href="%href%" target="_blank" class="im-page--title-main-inner _im_page_peer_name">%name%</a><span class="im-page--title-main-verified _im_chat_verified"></span></span></span> <span class="im-page--title-meta _im_page_peer_online">%online%</span> </div>',
        im_simple_link: '<a href="%href%" class="_im_header_link" target="_blank">%content%</a>',
        im_selected_messages: '<span class="im-page--selected-messages-count">%label%</span> <button aria-label="%tip%" type="button" class="im-page--selected-messages-remove"></button>',
        im_topic: "<div class='im-topic %cls%'>%topic%</div>",
        im_stack_date: ' <a href="%link%" class="_im_mess_link" >%date%</a>',
        im_dialogs_none: '<li data-list-id="002300" class="im-page--dialogs-empty"> %msg%</li>',
        im_dialogs_message_requests_button: '<li class="im-page--dialogs-message-requests-button _im_toggle_mr_tab" data-list-id="%list_id%"> %msg%</li>',
        im_dialogs_message_requests_notice: '<li class="im-page--dialogs-message-requests-notice-w" data-list-id="message_request_notice"> <div class="im-page--dialogs-message-requests-notice"> %msg% </div> </li>',
        im_filter: '<a class="im-page--dialogs-filter %cls%">%filter%</a>',
        im_drow_prebody: '<span class="nim-dialog--who">%prebody%</span> <span class="nim-dialog--inner-text">%body%</span>',
        im_attach_mess: ' <div class="im-fwd %modifier%"> <span class="im-fwd--title"> <span class="im-fwd--title-name">%text%</span> <span class="im-fwd--date">%date%</span></span> <span class="im-fwd--close _im_fwd_close"></span> <div rel="button" tab-index="0" type="button" class="im-fwd--messages _im_will_fwd">%messages%</div> </div>',
        im_preloader: '<div class="im-preloader %cls%"> %preloader%</div>',
        im_service_row: '<ul class="ui_clean_list"> <li class="im-mess im-mess_srv _im_mess _im_mess_srv _im_mess_%message_id%" data-msgid="%message_id%" data-from="%from_id%" data-ts="%date%"> <div class="im-mess--text">%text%</div> </li> </ul>',
        im_chat_members: '<button type="button" class="_im_chat_members im-page--members">%name%</button>',
        im_vkcomgroup_members: '<span class="im-page--members im-page--members--nohover">%name%</span>',
        im_mess_stack: '<div class="im-mess-stack _im_mess_stack %cls%" data-peer="%peerId%" data-admin="%admin%"> <div class="im-mess-stack--photo"> <div class="nim-peer nim-peer_small fl_l"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo"> <a target="_blank" class="im_grid" href="%href%"><img alt="%name%" src="%photo%" /></a> </div> </div> </div> </div> <div class="im-mess-stack--content"> <div class="im-mess-stack--info"> <div class="im-mess-stack--pname"> %stack_name% <span class="im-mess-stack--tools">%date%</span> </div> </div> <ul class="ui_clean_list im-mess-stack--mess _im_stack_messages"> %messages% </ul> </div> </div>',
        im_mess_stack_name: '<a href="%link%" class="im-mess-stack--lnk%class%" title="" target="_blank">%name%</a>',
        im_message_media: '<div class="_im_msg_%type%%messageId%" class="wall_module">%attaches%</div>%text%',
        im_dialog_media: '<span class="nim-dialog--preview nim-dialog--preview-attach">%name%</span>',
        im_typing: '<div class="im-page--typing _im_typing"> <div class="im-activity %cls%"><div class="pr im-activity--icon"><div class="pr_bt"></div><div class="pr_bt"></div><div class="pr_bt"></div></div><span class="_im_typing_name">&nbsp;</span></div> </div>',
        ctrl_submit_hint: function() {
            return '<div class="reply_submit_hint_wrap" >\n  <div class="reply_submit_hint_title">' + getLang("wall_reply_submit_settings") + '</div>\n  <div class="reply_submit_hint_opts" id="">\n    <div class="radiobtn %enter_on% _im_submit_btn" data-val="0" onclick="radiobtn(this, 0, \'im_submit\'); "><div class="radiobtn_label">' + getLang("wall_reply_submit_settings_1") + '</div></div>\n    <div class="radiobtn %ctrl_on% _im_submit_btn" data-val="1" onclick="radiobtn(this, 1, \'im_submit\'); "><div class="radiobtn_label">' + getLang("wall_reply_submit_settings_2") + "</div></div>\n  </div>\n</div>"
        },
        im_day_bar: '<h5 class="im-page--history-new-bar im-page--history-new-bar_days _im_bar_date %day_class%" data-date="%date%"><span>%day%</span></h5>',
        im_mess_bar: function() {
            return '<h4 class="im-page--history-new-bar _im_unread_bar_row"><span>' + getLang("mail_new_unread_msgs") + "</span></h4>"
        },
        im_replied_message: '<div class="im-replied"> <div class="im-replied--photo-wrapper"></div> <div class="im-replied--content"> <div class="im-replied--author"> <span class="im-replied--author-link">%authorName%</span> </div> <div class="im-replied--text">%text%</div> </div> </div>',
        im_drow: function() {
            return '<li data-list-id="%peer%" class="nim-dialog _im_dialog _im_dialog_%peer% %is_unread% %is_unread_out% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer %is_online% _im_peer_online"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo _im_dialog_photo"> %photo% </div> </div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="' + getLang("mail_im_to_multidialog") + ': %tab_name%"></span> <div class="nim-dialog--date _im_dialog_date">%date%</div> <button type="button" class="nim-dialog--close _im_dialog_close" data-peer="%peer%"></button> <button type="button" class="nim-dialog--markre _im_dialog_markre"></button> <div class="nim-dialog--name"> <span class="nim-dialog--name-w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--verfifed _im_dialog_verified"></span> <span class="nim-dialog--mute"></span> <button type="button" class="nim-dialog--star _im_dialog_star"></button> </div> <div class="nim-dialog--text-preview"> <span class="nim-dialog--preview _dialog_body" tabindex="0">%body%</span> <span class="nim-dialog--typing _im_dialog_typing"></span><span class="nim-dialog--typer-el"></span> </div> <label class="blind_label _im_unread_blind_label">%unread_message_string%</label> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </li>'
        },
        im_conversation_search_row: function() {
            return '<li data-list-id="%peer%" class="nim-dialog nim-conversation-search-row _im_dialog _im_dialog_%peer% %is_unread% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer nim-peer_search %is_online% _im_peer_online"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo _im_dialog_photo"> %photo% </div> </div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="' + getLang("mail_im_to_multidialog") + ': %tab_name%"></span> <button type="button" class="nim-dialog--close _im_dialog_close" data-peer="%peer%"></button> <div class="nim-dialog--name"> <span class="nim-dialog--name-w" aria-hidden="true"> %user_link% </span> </div> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </li>'
        },
        im_delete_actions: function() {
            return '<span class="nim-dialog--who">%text%</span> <button class="nim-dialog--daction ui_bullet _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="restore" type="button">' + getLang("mail_restore") + '</button> <button class="nim-dialog--daction ui_bullet _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="spam" type="button">' + getLang("mail_im_mark_spam") + '</button> <button class="nim-dialog--daction nim-dialog--daction_last _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="block" type="button">' + getLang("mail_user_black_list") + "</button>"
        },
        im_chat_change_topic: function() {
            return '<div class="im_change_topic_wrap clear_fix"> <div class="im_change_topic_label fl_l ta_r">' + getLang("mail_chat_topic_change_label") + '</div> <div class="im_change_topic_labeled fl_l"> <input class="text _im_chat_topic_change_input" value="%value%"/> </div> </div>'
        },
        im_msg_row: function() {
            return '<li class="im-mess %cls% _im_mess_noa _im_mess_%msg_id%" aria-hidden="%aria_hidden%" data-ts="%ts%" data-msgid="%msg_id%" data-peer="%from_id%"> <div class="im-mess--text wall_module _im_log_body">%text%</div> <span tabindex="0" role="link" aria-label="' + getLang("mail_select_message") + '" class="blind_label im-mess--blind-select _im_mess_blind_label_select"></span> <span class="blind_label im-mess--blind-read _im_mess_blind_unread_marker" %unread_params%></span> <span class="im-mess--marker _im_mess_marker" %marker_params%></span> </li>'
        },
        sImHistoryRowActions: function() {
            return '<div class="im-mess--actions"> <span role="link" aria-label="' + getLang("mail_im_mark_forward") + '" class="im-mess--forward _im_mess_forward"></span> <span role="link" aria-label="' + getLang("mail_im_reply") + '" class="im-mess--reply _im_mess_reply"></span> <span role="link" aria-label="' + getLang("mail_im_edit") + '" class="im-mess--edit _im_mess_edit"></span> <span role="link" aria-label="' + getLang("mail_important_message") + '" class="im-mess--fav _im_mess_fav"></span> </div> <div class="im-mess--check fl_l"></div>'
        },
        im_wrap_mobile: '<b class="mob_onl %class%" %attrs% onmouseover="mobileOnlineTip(this, {%params%})"></b>',
        im_pinned_message: '<div class="im-page-pinned _im_pinned_message"> <button class="im-page-pinned--hide _im_pin_hide"></button> <div class="im-page-pinned--meta"> <a href="%link%" target="_blank" class="im-page-pinned--name">%name%</a> <span class="im-page-pinned--date">%date%</span> </div> <div class="im-page-pinned--content">%content%</div> </div>',
        im_pinned_message_media: '<span class="im-page-pinned--media">%text%</span>',
        im_pinned_message_media_bar: '<div class="im-page-pinned--media-bar">\n  <div class="im-page-pinned--media-bar_progress" style="width: %percent%%;"></div>\n</div>',
        im_pinned_messages_promo: '<div class="im-page--mess-actions-promo-content">%content%</div>',
        im_retry_link: function() {
            return '<button class="im-page--retry _im_retry_media">' + getLang("mail_retry") + "</button>"
        },
        sImLblWasEdited: function() {
            return " <span class='im-mess--lbl-was-edited _im_edit_time' data-time='%update_time%'>" + getLang("mail_was_edited_short") + "</span>"
        },
        sImLblWasSourceInfo: function() {
            return " <span class='im-mess--lbl-was-edited _im_page_info' data-info='%source%'>" + getLang("mail_was_source_short") + "</span>"
        },
        im_top_banner: '<div class="im-top-banner">\n  %icon%\n  <div class="im-top-banner--text"><div>%text%</div></div>\n  <div class="im-top-banner--buttons">%buttons%</div>\n</div>',
        im_top_banner_icon: '<div class="im-top-banner--icon">\n  <img src="%icon%" alt=""/>\n</div>',
        im_top_banner_button_link: '<a href="%link%" target="_blank" class="_im_top_banner_button im-top-banner--button %css_class% flat_button">%text%</a>',
        im_top_banner_button: '<button class="_im_top_banner_button im-top-banner--button %css_class% flat_button" data-payload="%callback_data%">%text%</button>',
        im_top_banner_hide_btn: '<button class="im-top-banner--button im-top-banner--button_hide _im_top_banner_hide"></button>',
        im_calls_link: '<a href="/calls" class="im_srv_lnk_light" onclick="return showWiki({ w: \'calls\'});">%text%</a>',
        sImPeerMuteUnmute: '<a href="#" class="_im_peer_mute_unmute ui_actions_menu_item im-action nohover %cls%">%text%</a>',
        sImPeerAcceptOrRejectMessageRequest: function() {
            return "<p>" + getLang("mail_message_request_user_notice") + '</p> <p> <button type="button" class="flat_button %cls_accept%">' + getLang("mail_message_request_accept") + '</button> <button type="button" class="flat_button secondary %cls_reject%">' + getLang("mail_message_request_reject") + "</button> </p>"
        },
        sImPeerReturnToChat: '<a href="#" class="_im_peer_return_to_chat">%text%</a>'
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return b
    });
    var r = n(252),
        o = n(1),
        i = n(427),
        a = n(406),
        s = n(256),
        c = n(440),
        u = n(112),
        l = n(281),
        d = n(99),
        f = "_im_mess_fav",
        p = "_im_mess_reply",
        _ = "_im_mess_forward",
        m = "_im_mess_edit";

    function g(e, t, n, r, i) {
        var s = Object(a.getPeer)(e),
            c = Object(a.getTab)(e, s),
            u = 105 + (Object(l.isPinnedMessageVisibleInTab)(e, Object(a.getPeer)(e)) || c && c.top_banner ? Object(o.getPinnedMessageHeight)() : 0);
        showTooltip(t, {
            shift: [n, 10],
            black: 1,
            className: "_im_history_tooltip " + r,
            appendParentCls: "_im_mess_stack",
            toup: t.getBoundingClientRect().top > u + 37,
            text: i
        })
    }

    function h(e, t, n, r) {
        var o = getLang("mail_im_toggle_important").length > 14;
        g(e, r, o ? 84 : 34, o ? "im-star-tt_long" : "im-star-tt", function() {
            var t = domData(gpeByClass("_im_mess", r), "msgid"),
                n = Object(a.getMessage)(e, e.get().peer, t);
            return n ? Object(i.isImportant)(n) ? getLang("mail_im_unmark_important") : getLang("mail_im_toggle_important") : ""
        })
    }

    function b(e, t, n) {
        var l = h.bind(null, t, 0),
            b = function(e, t, n) {
                var o = gpeByClass("_im_mess", n),
                    s = intval(domData(o, "msgid")),
                    c = e.get().peer,
                    l = Object(a.getMessage)(e, c, s),
                    d = !Object(i.isImportant)(l);
                return e.get().longpoll.push([{
                    peerId: c,
                    messageId: s,
                    type: d ? u.SET_FLAGS : u.RESET_FLAGS,
                    flags: u.FLAG_IMPORTANT
                }]), e.set(r.favMessage.bind(null, [s], d, c)), h(e, 0, 0, n), !1
            }.bind(null, t),
            v = function(e, t, n, r) {
                g(e, r, 18, "im-reply-tt", getLang("mail_im_mark_forward"))
            }.bind(null, t, 0),
            y = function(e, t, n, o) {
                var i = e.get().peer,
                    a = +domData(domClosest("im-mess", o.target), "msgid");
                return Object(c.statlogsForwardFromChannel)(), Object(r.processFwd)([a], i, e).then(function(t) {
                    return e.set(r.prepareForward.bind(null, t))
                }).then(function() {
                    Object(d.mount)(n, e)
                }), !1
            }.bind(null, t, e.querySelector("_im_dialog_actions"), n),
            O = function(e, t, n, r) {
                g(e, r, 18, "im-reply-tt", getLang("mail_im_reply"))
            }.bind(null, t, 0),
            w = function(e, t, n) {
                var o = e.get().peer,
                    i = +domData(domClosest("im-mess", n.target), "msgid");
                return Object(r.processFwd)([i], o, e).then(function(t) {
                    return e.set(r.forwardMessages.bind(null, t, e.get().tfdraft, !0))
                }).then(function() {
                    return t().respond(e, o)
                }), !1
            }.bind(null, t, n),
            E = function(e, t, n) {
                g(e, n, 18, "im-edit-tt", getLang("mail_im_edit"))
            }.bind(null, t),
            C = function(e, t, n, r) {
                var o = intval(domData(gpeByClass("_im_mess", r), "msgid")),
                    i = Object(a.getMessage)(e, e.get().peer, o);
                return i && t().startEditing(i), !1
            }.bind(null, t, n),
            j = Object(s.createModule)({
                handlers: function(t, n) {
                    n(e, "click", f, b), n(e, "mouseover", f, l), n(e, "click", _, y), n(e, "mouseover", _, v), n(e, "click", p, w), n(e, "mouseover", p, O), n(e, "click", m, C), n(e, "mouseover", m, E)
                }
            });
        return function(e, t) {
            return {
                markImportant: function(t, n, r) {
                    Object(o.updateStar)(t, n, e)
                },
                unmount: function() {
                    Object(s.destroyModule)(t)
                }
            }
        }(e, j)
    }
}, , , , , function(e, t, n) {
    var r = n(12),
        o = n(51);
    e.exports = function(e) {
        return r(o(e))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "isPinnedMessageVisibleInTab", function() {
        return f
    }), n.d(t, "pinnedMessageHide", function() {
        return p
    }), n.d(t, "pinnedMessageUnHide", function() {
        return _
    }), n.d(t, "pinnedMessageUnpin", function() {
        return m
    }), n.d(t, "mount", function() {
        return b
    });
    var r = n(256),
        o = n(252),
        i = n(357),
        a = n(1),
        s = n(406),
        c = n(187),
        u = n(272),
        l = "_im_pin_hide",
        d = "_im_pinned_message";

    function f(e, t) {
        if (Object(c.unpackStore)(e).searchShown) return !1;
        var n = Object(s.getTab)(e, t),
            r = n && Object(s.parserMessage)(n.pinned);
        return !!r && n.pinHideId != r.chat_local_id
    }

    function p(e, t, n) {
        var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
            o = Object(s.getTab)(e, t),
            i = o && Object(s.parserMessage)(o.pinned);
        o && i && (o.pinHideId = i.chat_local_id, cur.imDb.update(u.PIN_HIDDEN_ID_OP, [o.peerId, o.pinHideId]), g(n, t, e), re(geByClass1("_im_pinned_tt")), r && window.Notifier && Notifier.lcSend("pin_hide", {
            hide: 1,
            peer: t
        }), statlogsValueEvent("im_pinned_messages", "hide"))
    }

    function _(e, t, n) {
        var r = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
            o = Object(s.getTab)(e, t);
        o && o.pinHideId && (delete o.pinHideId, cur.imDb.update(u.PIN_HIDDEN_ID_OP, [o.peerId, void 0]), g(n, t, e), r && window.Notifier && Notifier.lcSend("pin_hide", {
            hide: 0,
            peer: t
        }), statlogsValueEvent("im_pinned_messages", "show"))
    }

    function m(e, t, n) {
        var r = g.bind(null, n, t),
            i = Object(a.showUnpinDialog)(function() {
                i.hideProgress(), i.hide(), e.set(o.unpinMessageOptimistic.bind(null, t)).then(r).then(function(e) {
                    return e.set(o.unpinMessage.bind(null, t))
                }).then(r)
            })
    }

    function g(e, t, n) {
        return e().updateChatTopic(t, n), Object(o.setActions)(n.get()), e().updateActions(n), n
    }

    function h(e) {
        return {
            unmount: function() {
                Object(r.destroyModule)(e)
            }
        }
    }

    function b(e, t, n) {
        var o = Object(r.createMutations)(h).bindMutations,
            c = function(e, t, n) {
                var r = e.get().peer,
                    o = Object(s.parserMessage)(Object(s.getTab)(e, r).pinned);
                if (n.target.classList.contains(l)) o && p(e, r, t);
                else if ("A" !== n.target.tagName) {
                    var c = o && o.messageId;
                    c && !Object(a.isAlreadyDeleted)(e, r, c) ? Object(a.focusOnMessage)(e, t().focusOnMessage, r, c) : Object(a.showPinnedBox)(e, t, r, i.mount, n), statlogsValueEvent("im_pinned_messages", "open")
                }
            }.bind(null, t, n),
            u = function(e) {
                showTooltip(e.target, {
                    text: getLang("mail_hide_unpin_hover"),
                    black: 1,
                    needLeft: 1,
                    shift: [8, 4],
                    forcetoup: !0,
                    className: "_im_pinned_tt",
                    appendEl: bodyNode
                })
            }.bind(null);
        return o(Object(r.createModule)({
            handlers: function(t, n) {
                n(e, "click", d, c), n(e, "mouseover", l, u)
            }
        }))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(63),
        i = n(409),
        a = n(402),
        s = n(14),
        c = n(309),
        u = n(252),
        l = n(219);
    var d = window.unclean,
        f = i.default.getLang,
        p = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onSaveTitle = function(e) {
                    var t = r.props.store,
                        n = t.get(),
                        o = e.value.trim().replace("\n", "");
                    o && o !== d(r.props.title) && (r.setState({
                        titleChanged: !1
                    }), t.set(u.updateChatTopic.bind(null, n.peer, o)))
                }, r.onChangeTitle = function(e) {
                    if (r.state.title !== e.target.value) {
                        var t = e.target.value.replace("\n", "");
                        r.setState({
                            title: t,
                            titleChanged: d(r.props.title) !== t
                        })
                    }
                }, r.onValidateTitle = function(e) {
                    return !!e.trim().replace("\n", "")
                }, r.onCancelTitle = function() {
                    r.setState({
                        title: d(r.props.title),
                        titleChanged: !1
                    })
                }, r.onSaveDescription = function(e) {}, r.onPhotoUpload = function() {
                    var e = r.props.store,
                        t = e.get().peer;
                    Object(c.canChangeTitle)(e) && (cur.recieveCropResult = void 0, Page.ownerPhoto(t, {
                        gid: e.get().gid
                    }))
                }, r.onPhotoRemove = function() {
                    var e = r.props.store,
                        t = e.get().peer;
                    Object(c.canChangeTitle)(e) && e.set(u.removeChatPhoto.bind(null, t)).then(function() {
                        return e.set(u.getChatDetails.bind(null, t))
                    }).catch(function(e) {
                        return Object(l.imWeirdCatch)("onPhotoRemove", e)
                    })
                }, r.state = {
                    title: d(n.title),
                    titleChanged: !1
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this.props,
                    t = e.store,
                    n = e.photo,
                    i = e.title,
                    u = e.description,
                    l = e.grid,
                    p = e.meta,
                    _ = d(i),
                    m = Object(c.canChangeTitle)(t),
                    g = Object(o.classNames)("ChatSettingsInfo", {
                        "ChatSettingsInfo--editable": m
                    }),
                    h = Object(o.classNames)("ChatSettingsInfo__title", {
                        "ChatSettingsInfo__title-service": 64 & this.props.flags
                    });
                return r.createElement("div", {
                    className: g
                }, r.createElement("header", {
                    className: "ChatSettingsInfo__header"
                }, r.createElement("div", {
                    className: "ChatSettingsInfo__photo"
                }, r.createElement("div", {
                    className: "ChatSettingsInfo__attach nim-peer nim-peer_larger",
                    "data-tip": f("mail_settings_photo"),
                    onClick: this.onPhotoUpload
                }, n ? r.createElement("img", {
                    src: n,
                    width: "80",
                    height: "80",
                    alt: _,
                    className: "ChatSettingsInfo__photoSelf"
                }) : r.createElement("div", {
                    className: "nim-peer--photo-w"
                }, r.createElement("div", {
                    className: "ChatSettingsInfo__photoGrid nim-peer--photo",
                    dangerouslySetInnerHTML: {
                        __html: l
                    }
                }))), n && m && r.createElement(a.default, {
                    text: f("mail_settings_remove_photo"),
                    position: "t",
                    align: "left"
                }, r.createElement("button", {
                    onClick: this.onPhotoRemove,
                    className: "ChatSettingsInfo__photoRemove"
                }))), r.createElement("h3", {
                    className: h
                }, m ? r.createElement(s.default, {
                    value: this.state.title,
                    changed: this.state.titleChanged,
                    useEnter: !0,
                    onSave: this.onSaveTitle,
                    onChange: this.onChangeTitle,
                    onCancel: this.onCancelTitle,
                    validate: this.onValidateTitle
                }) : _), r.createElement("div", {
                    className: "ChatSettingsInfo__meta"
                }, p)), u && r.createElement("div", {
                    className: "ChatSettingsInfo__description"
                }, m ? r.createElement(s.default, {
                    value: u,
                    onSave: this.onSaveDescription
                }) : u))
            }, t
        }(r.PureComponent);
    t.default = p
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "getUploadModule", function() {
        return a
    }), n.d(t, "getUploadVideoExtMasks", function() {
        return o
    }), n.d(t, "onVideoUploaded", function() {
        return s
    });
    var r = n(114);

    function o(e) {
        var t = r.VIDEO_UPLOAD_EXTS.slice(0, r.VIDEO_UPLOAD_EXTS.length);
        if ("types" === e) {
            for (var n = t.length, o = 0; o < n; ++o) t.push(t[o].toUpperCase());
            return "*." + t.join(";*.")
        }
        return "accept" === e ? "." + r.VIDEO_UPLOAD_EXTS.join(",.") : ""
    }

    function i(e) {
        if (!cur.leaving) {
            var t = getLang("video_upload_changed"),
                n = !1;
            if (each(window.cur.videoUploaders, function(e, t) {
                    Upload.isSomethingUploading(t) && (n = !0)
                }), 1 === e) {
                if (!n) return !0;
                var r = showFastBox({
                    title: getLang("global_warning"),
                    dark: !0
                }, t, getLang("global_continue"), function() {
                    cur.leaving = !0, r.hide(), cur.onContinueCb && cur.onContinueCb()
                }, getLang("global_cancel"), function() {
                    r.hide(), nav.objLoc.section = "upload", nav.setLoc(nav.objLoc)
                });
                return !1
            }
            return n ? winToUtf(t.replace(/<\/?b>/g, "").replace(/<br\s*\/?>/g, "\n")) : void 0
        }
    }

    function a(e, t, n, a, c) {
        if (n) {
            a = a || cur, (c = c || {}).onUploadStart || (c.onUploadStart = function(e) {
                boxQueue.hideLast(), cur.nav.push(function(e, t, n) {
                    if (!1 === i(1)) return cur.onContinueCb = nav.go.pbind(n), !1
                }), cur.prevBefUnload = window.onbeforeunload, window.onbeforeunload = i, c.onUploadProgress(e, 0, 0), Wall.showEditPost && Wall.showEditPost(), c.onUploadStartDone && c.onUploadStartDone()
            }), c.onUploadComplete || (c.onUploadComplete = function(e, t) {
                var n = window.parseJSON(t);
                n.video_id ? s(e, n, a) : "string" == typeof t && t.indexOf("TERMINATED") > -1 || Upload.onUploadError(e);
                c.onUploadCompleteDone && c.onUploadCompleteDone(), setTimeout(function() {
                    c.onUploadAllCompleteDone && !window.Upload.isSomethingUploading(e.ind) && c.onUploadAllCompleteDone()
                })
            }), c.onUploadProgress || (c.onUploadProgress = function(e, t, n) {
                var r = void 0 !== e.ind ? e.ind : e;
                show("_im_media_preview"), a.showMediaProgress && a.showMediaProgress("video", r, function(e, t, n) {
                    return {
                        loaded: t,
                        total: n,
                        fileName: e.fileName ? e.fileName.replace(/[&<>"']/g, "") : void 0
                    }
                }(e, t, n))
            }), c.onUploadError || (c.onUploadError = function(e, t) {
                statlogsValueEvent("upload_video_fails", 1, n.options.server, t),
                    function(e) {
                        var t = void 0 !== e.ind ? e.ind : e,
                            n = e.fileName ? t + "_" + e.fileName : e;
                        if (re("upload" + n + "_progress_wrap"), !geByClass1("popup_box_container")) {
                            var r = getLang("video_upload_error");
                            setTimeout(showFastBox({
                                title: getLang("global_error")
                            }, r).hide, 2e3)
                        }
                        topError("Upload failed", {
                            dt: -1,
                            type: 102,
                            url: (ge("file_uploader_form" + t) || {}).action
                        }), Upload.embed(t)
                    }(e)
            }), cur.maxFiles = (cur.chooseParams || {}).maxFiles || 10;
            var u = cur.maxFiles - (cur.savedVideos || []).length,
                l = browser.safari ? "" : "video/*," + o("accept");
            n.lang && (cur.lang = extend(cur.lang || {}, n.lang));
            var d = {
                    accept: l,
                    file_input: null,
                    file_name: "video_file",
                    file_size_limit: 1024 * (n.options.file_size_limit_in_GB || r.VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB) * 1024 * 1024,
                    file_types_description: "Video files",
                    file_types: o("types"),
                    chooseBox: 1,
                    chunked: 1,
                    chunkSize: r.VIDEO_UPLOAD_CHUNK_SIZE,
                    clear: 1,
                    dragEl: t === boxLayerWrap ? boxLayerWrap : bodyNode,
                    dropbox: t,
                    from: n.vars.from,
                    lang: n.lang,
                    max_attempts: 3,
                    max_files: u,
                    multiple: 1,
                    multi_progress: 1,
                    requestOptionsForFile: !0,
                    type: "video",
                    visibleDropbox: !n.options.hasOwnProperty("visible_dropbox") || n.options.visible_dropbox
                },
                f = Upload.init(e, "", {}, Object.assign(d, c));
            return window.cur.videoUploaders || (window.cur.videoUploaders = []), window.cur.videoUploaders.push(f), f
        }
    }

    function s(e, t, n, r) {
        n = n || cur;
        var o = void 0 !== e.ind ? e.ind : e,
            i = (e.fileName || e.filename || "").replace(/[&<>"']/g, ""),
            a = i ? o + "_" + i : e,
            s = t.owner_id + "_" + t.video_id,
            c = ge("upload" + a + "_progress_wrap");
        c && hide(geByClass1("progress_x", c)), ajax.post("al_video.php?act=a_videos_attach_info", {
            videos: s
        }, {
            onDone: function(e) {
                n.chooseMedia("video", s, extend(e[s], {
                    upload_ind: a,
                    upload_new: !0
                }));
                var o = t.owner_id,
                    i = t.video_id,
                    c = t.video_hash,
                    u = 0;
                ! function t() {
                    ajax.post("al_video.php", {
                        act: "encode_progress",
                        oid: o,
                        vid: i,
                        hash: c,
                        need_thumb: 1
                    }, {
                        onDone: function(c) {
                            var u, l = !0;
                            if (c) {
                                if (c.error) return u = getLang("video_upload_encode_error"), void setTimeout(showFastBox({
                                    title: getLang("global_error")
                                }, u).hide, 2e3);
                                c.thumb && (l = !1, ajax.post("al_video.php", {
                                    act: "a_video_photo_sizes",
                                    oid: o,
                                    vid: i
                                }, {
                                    onDone: function(t) {
                                        n.hasChosenMedia("video", s) ? n.updateChosenMedia("video", s, extend(t, {
                                            upload_ind: a,
                                            upload_new: !0
                                        })) : r && r(e, s)
                                    }
                                }))
                            }
                            l && n.hasChosenMedia("video", s) && setTimeout(t, 1e3)
                        },
                        onFail: function() {
                            ++u < 3 && setTimeout(t, 2e3 * u)
                        }
                    })
                }()
            }
        })
    }
    t.default = {
        getUploadModule: function(e, t, n, r, o) {
            return a(e, t, n, r, o)
        },
        initModalVideoUploader: function() {
            var e = cur.videoUploadParams,
                t = ge("choose_video_upload");
            return !!t && (this.initDragEvents(), a(t, boxLayerWrap, e))
        },
        initDragEvents: function() {
            var e = function(e) {
                    cur.dragTimeout && (clearTimeout(cur.dragTimeout), delete cur.dragTimeout);
                    var t = ge("video_choose_upload_area_wrap");
                    if (!hasClass(t, "video_choose_upload_area_enter")) {
                        addClass(t, "video_choose_upload_area_enter");
                        var n = ge("video_choose_wrap"),
                            r = getXY(n)[1],
                            o = getSize(t)[1];
                        return hide("video_choose_wrap"), setStyle(t, "height", scrollGetY() + window.clientHeight() - r + o), cancelEvent(e)
                    }
                },
                t = function(e) {
                    return cancelEvent(e)
                },
                n = function(e) {
                    if (t(), e.dataTransfer.files.length && Upload.checkFilesSizes(window.videoInlineUploader, e.dataTransfer.files)) return window.Upload && Upload.checked && Upload.checked[window.videoInlineUploader] && Upload.onFileApiSend(window.videoInlineUploader, e.dataTransfer.files), cancelEvent(e)
                },
                r = function() {
                    addEvent(boxLayerWrap, "dragenter dragover", e), addEvent(boxLayerWrap, "dragleave", t), addEvent(boxLayerWrap, "drop", n)
                };
            r(), setTimeout(curBox().setOptions.pbind({
                onHide: function() {
                    removeEvent(boxLayerWrap, "dragenter dragover", e), removeEvent(boxLayerWrap, "dragleave", t), removeEvent(boxLayerWrap, "drop", n)
                },
                onShow: function() {
                    r()
                }
            }), 0)
        }
    }
}, , function(e, t, n) {
    "use strict";

    function r(e, t) {
        var n = void 0,
            r = void 0,
            o = function(o) {
                n = void 0 !== o.clientX ? o.clientX : o.touches[0].clientX, r = void 0 !== o.clientY ? o.clientY : o.touches[0].clientY, t.onDrag && t.onDrag.call(e, n, r)
            },
            i = function i(a) {
                t.onDrop && t.onDrop.call(e, n, r), removeEvent(document, "mouseup touchend mouseleave", i), removeEvent(document, "mousemove touchmove", o)
            },
            a = function(a) {
                (1 === a.which || a.touches && a.touches[0]) && (addEvent(document, "mouseup touchend mouseleave", i), addEvent(document, "mousemove touchmove", o), n = void 0 !== a.clientX ? a.clientX : a.touches[0].clientX, r = void 0 !== a.clientY ? a.clientY : a.touches[0].clientY, t.onStartDrag && t.onStartDrag.call(e, n, r), t.onDrag && t.onDrag.call(e, n, r), cancelEvent(a))
            };
        e.beginDragHandler = a, addEvent(e, "mousedown touchstart", a)
    }

    function o(e) {
        removeEvent(e, "mousedown touchstart", e.beginDragHandler)
    }
    n.r(t), n.d(t, "initDraggable", function() {
        return r
    }), n.d(t, "removeDraggable", function() {
        return o
    })
}, function(e, t) {
    e.exports = function(e) {
        try {
            return !!e()
        } catch (e) {
            return !0
        }
    }
}, , , function(e, t, n) {
    "use strict";
    var r = n(157);
    e.exports = function e(t, n) {
        return !(!t || !n) && (t === n || !r(t) && (r(n) ? e(t, n.parentNode) : "contains" in t ? t.contains(n) : !!t.compareDocumentPosition && !!(16 & t.compareDocumentPosition(n))))
    }
}, , , function(e, t, n) {
    "use strict";

    function r(e, t, n, r, o) {
        return window.statlogsValueEvent(e, t, n, r, o)
    }

    function o(e) {
        return Math.random() < e
    }

    function i(e, t, n, i, a, s) {
        o(e) && r(t, n, i, a, s)
    }
    n.r(t), n.d(t, "statlogsValueEvent", function() {
        return r
    }), n.d(t, "randEnabled", function() {
        return o
    }), n.d(t, "statlogsProbValueEvent", function() {
        return i
    })
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "startLongPollForGroup", function() {
        return T
    }), n.d(t, "startLongPoll", function() {
        return S
    });
    var r = n(252),
        o = n(433),
        i = n(364),
        a = n(112),
        s = n(392),
        c = n(268),
        u = n(187),
        l = n(123),
        d = n(169),
        f = n(219),
        p = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        _ = 202,
        m = 4,
        g = 5,
        h = 3e4,
        b = {},
        v = Date.now();

    function y(e, t) {
        var n = Math.floor(t.status / 100);
        t.status && e.stat && (t.status >= 500 && t.status < 600 && statlogsValueEvent("im_longpoll", 1, n + "0x", t.getResponseHeader("x-frontend")), b[n] = b[n] ? b[n] + 1 : 1, Date.now() - v >= h && (Object.keys(b).forEach(function(e) {
            statlogsValueEvent("im_longpoll", b[e], e + "0x", t.getResponseHeader("x-frontend"))
        }), b = {}, v = Date.now()))
    }

    function O(e) {
        return e.updates.map(function(e) {
            switch (e[0]) {
                case 0:
                    return a.deleteEvent(e);
                case 1:
                    return a.replaceFlagsEvent(e);
                case 2:
                    return a.setFlagsEvent(e);
                case 3:
                    return a.resetFlagsEvent(e);
                case 4:
                    return a.addMessageEvent(e);
                case 5:
                    return a.editMessageEvent(e);
                case 6:
                    return a.readInboundEvent(e);
                case 7:
                    return a.readOutboundEvent(e);
                case 8:
                    return a.gotOnlineEvent(e);
                case 9:
                    return a.gotOfflineEvent(e);
                case 10:
                    return a.resetDirectoriesEvent(e);
                case 11:
                    return a.replaceDirectoriesEvent(e);
                case 12:
                    return a.setDirectoriesEvent(e);
                case 13:
                    return a.deleteDialogEvent(e);
                case 18:
                    return a.replaceMessageEvent(e);
                case 51:
                    return a.chatChangedEvent(e);
                case 52:
                    return a.chatUpdatedEvent(e);
                case 63:
                    return a.typingEvent(e);
                case 64:
                    return a.recordingAudioEvent(e);
                case 70:
                    return a.videoCallEvent(e);
                case 80:
                    return a.unreadCountEvent(e);
                case 114:
                    return a.notifySettingsChangedEvent(e);
                case 116:
                    return a.refreshMessageEvent(e);
                case -1:
                    return a.resyncEvent();
                default:
                    return a.emptyEvent(e)
            }
        })
    }

    function w(e, t) {
        return Promise.resolve(extend({}, t, {
            timeout: e < 64 ? 2 * e : e
        }))
    }

    function E(e, t) {
        return t.pauses || (t.pauses = []), t.pauses.push(e), Promise.resolve(t)
    }

    function C(e) {
        return e.pauses || (e.pauses = []), Object(u.lplog)("Aborting all pauses", "error"), e.pauses.forEach(function(e) {
            return e()
        }), e.pauses = [], Promise.resolve(e)
    }

    function j(e, t, n, o) {
        var i = o.failed ? Object(s.abortablePause)(m, e) : {},
            c = i.abort,
            l = i.pause;
        switch (o.failed) {
            case 1:
                return Object(u.lplog)("Old timestamp, init resync", "error"), e.set(E.bind(null, c)), n([a.resyncEvent()]), e.set(r.loadLongPollTs).then(l).then(k.bind(null, e, t, n));
            case 2:
                return Object(u.lplog)("Key is incorrect", "error"), e.set(E.bind(null, c)), e.set(r.loadLongPollKey).then(l).then(k.bind(null, e, t, n));
            case 3:
                throw Object(f.imWeirdLog)("im_longpoll_force_reload", o, !1), nav.reload({
                    force: !0
                }), new Error("ts is very wrong");
            default:
                return e.set(function(e, t) {
                    return Promise.resolve(extend({}, t, {
                        imTs: e
                    }))
                }.bind(null, o.ts)).then(function() {
                    return o
                })
        }
    }

    function k(e, t, n) {
        if (e.get().stopped) return Promise.resolve({
            updates: []
        });
        if (t()) return Promise.reject(new Error("pause"));
        var r = e.get(),
            o = r.imUrl + "/" + r.imPart,
            a = Object(i.plaingetCancelable)(o, {
                act: "a_check",
                key: r.imKey,
                version: g,
                ts: r.imTs,
                wait: 25,
                mode: r.mode
            }),
            s = a.request,
            c = a.cancel;
        return e.set(function(e, t) {
            return t.cancelToken = e, Promise.resolve(t)
        }.bind(null, c)).then(function() {
            return s
        }).then(function(t) {
            var n = p(t, 2),
                o = n[0],
                i = n[1];
            return i && y(r, i), e.set(w.bind(null, 1)), JSON.parse(o)
        }).catch(function(e) {
            var t = p(e, 2),
                n = (t[0], t[1]);
            throw n && y(r, n), ""
        }).then(j.bind(null, e, t, n))
    }

    function T(e) {
        Object(f.imWeirdLog)("im_start_longpoll_group", {}, !1);
        var t = Object(d.createLongpollEventsQueue)(e.ts, function(e) {
                r.trigger("data", e)
            }),
            n = Object(l.createLongpoll)(e, t.onLp),
            r = new window.EventEmitter;
        return {
            onData: function(e) {
                return r.on("data", e)
            },
            offData: function(e) {
                return r.off("data", e)
            },
            push: function(e) {
                return r.trigger("data", e)
            },
            pause: t.pause.bind(t),
            resume: t.resume.bind(t),
            abortWaiting: n.abortWaiting.bind(n),
            onLp: t.onLp.bind(t),
            stop: n.stopConnection.bind(n),
            isEnabled: function() {
                return !(!n || n.isStopped())
            }
        }
    }

    function S(e) {
        var t = e.id,
            n = e.gid,
            r = e.key,
            i = e.ts,
            a = e.url,
            l = e.lhost,
            d = e.lpstat,
            f = new EventEmitter,
            p = window.vk.lpConfig && window.vk.lpConfig.enabled && window.longpollTesting_onImEvents,
            g = Object(c.initQueue)(function(e, t) {
                return p && window.longpollTesting_onImEvents(t), f.trigger("data", t), Promise.resolve({})
            }),
            h = g.pause,
            b = g.resume,
            v = g.pushMessage,
            y = g.isPaused,
            j = g.reset,
            T = Object(o.default)({
                id: t,
                gid: n,
                mode: _,
                timeout: 1,
                imKey: r,
                imTs: i,
                imPart: a,
                imUrl: l,
                pause: !1,
                stat: d
            });
        return function e(t, n, r) {
            t.get().stopped || (Object(u.lplog)("New request"), k(t, r, n).then(O).then(function(e) {
                return Object(u.lplog)("Request success", "success"), e
            }).then(n).catch(function(e) {
                if (!t.get().stopped) return Object(u.lplog)("Error, waiting: " + (e.message || "no message (probably browser reset)"), "error"), t.set(w.bind(null, r() ? m / 2 : t.get().timeout)).then(function() {
                    var e = Object(s.abortablePause)(t.get().timeout, t),
                        n = e.abort,
                        r = e.pause;
                    return t.set(E.bind(null, n)).then(r)
                });
                Object(u.lplog)("Stopped longpoll")
            }).then(e.bind(null, t, n, r)))
        }(T, v.bind(null, "main"), y.bind(null, "main")), {
            onData: function(e) {
                return f.on("data", e)
            },
            offData: function(e) {
                return f.off("data", e)
            },
            abortWaiting: function() {
                return T.set(C)
            },
            stop: function(e) {
                e.set(function(e) {
                    return Promise.resolve(extend({}, e, {
                        stopped: !0
                    }))
                }).then(function() {
                    e.get().cancelToken()
                })
            }.bind(null, T),
            pause: h.bind(null, "main"),
            resume: b.bind(null, "main"),
            reset: j.bind(null, "main"),
            push: function(e) {
                return f.trigger("data", e)
            },
            isEnabled: function() {
                return !T.get().pause && !T.get().stopped
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    var r = n(140);
    e.exports = n(307)("Map", function(e) {
        return function() {
            return e(this, arguments.length > 0 ? arguments[0] : void 0)
        }
    }, {
        get: function(e) {
            var t = r.getEntry(this, e);
            return t && t.v
        },
        set: function(e, t) {
            return r.def(this, 0 === e ? 0 : e, t)
        }
    }, r, !0)
}, , function(e, t, n) {
    var r = n(160),
        o = n(133),
        i = n(434),
        a = n(346),
        s = n(182),
        c = n(61);
    e.exports = function(e, t, n, u, l) {
        var d, f, p, _ = l ? function() {
                return e
            } : c(e),
            m = r(n, u, t ? 2 : 1),
            g = 0;
        if ("function" != typeof _) throw TypeError(e + " is not iterable!");
        if (i(_))
            for (d = s(e.length); d > g; g++) t ? m(a(f = e[g])[0], f[1]) : m(e[g]);
        else
            for (p = _.call(e); !(f = p.next()).done;) o(p, m, f.value, t)
    }
}, , , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63));
    var i = function(e) {
        function t() {
            return function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t),
                function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.photos,
                n = e.links,
                i = e.className,
                a = Object(o.classNames)("MembersGrid", "MembersGrid--" + Math.min(t.length, 4), i);
            return r.createElement("div", {
                className: a
            }, t.map(function(e, t) {
                var o = n && n[t] ? n[t] : void 0,
                    i = o ? "a" : "span";
                return r.createElement(i, {
                    key: t,
                    href: o,
                    className: "MembersGrid__i",
                    style: {
                        backgroundImage: "url(" + e + ")"
                    }
                })
            }))
        }, t
    }(r.Component);
    t.default = i, i.defaultProps = {
        links: [],
        className: ""
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return i
    });
    var r = n(451),
        o = n(63);

    function i(e) {
        return r.createElement("div", {
            className: Object(o.classNames)("ChatSettingsRoundedIcon", "ChatSettingsRoundedIcon--" + e.type)
        })
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(409),
        i = n(217),
        a = n(205),
        s = n(318),
        c = n(135),
        u = n(362),
        l = n(210),
        d = n(302),
        f = n(309);
    var p = Math.log2 || function(e) {
            return Math.log(e) / Math.LN2
        },
        _ = o.default.getLang,
        m = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onChange = function(e) {
                    var t = e.name,
                        n = e.selected.value,
                        o = r.state.flags;
                    r.setState({
                        flags: n ? o | 1 << t : o & ~(1 << t)
                    })
                }, r.onCancel = function() {
                    r.setState({
                        flags: r.props.tab.data.flags
                    }), r.props.back()
                }, r.onSave = function() {
                    r.state.loading || (r.setState({
                        loading: !0
                    }), r.props.onSave(r.state.flags).then(function() {
                        r.setState({
                            loading: !1
                        }, r.props.afterSave)
                    }).catch(function(e) {
                        r.setState({
                            loading: !1,
                            flags: r.props.tab.data.flags
                        })
                    }))
                }, r.state = {
                    flags: n.tab.data.flags,
                    loading: !1
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.render = function() {
                var e = this,
                    t = this.props.tab,
                    n = this.state.flags,
                    o = [{
                        value: !0,
                        label: _("mail_settings_only_admins")
                    }, {
                        value: !1,
                        label: _("mail_settings_all_members")
                    }],
                    m = t.serverSettings;
                return r.createElement("div", {
                    className: "ChatSettingsOptions"
                }, r.createElement(i.default, null, r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__select",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE),
                        options: o,
                        value: !!(n & f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE)
                    })
                }, r.createElement(d.default, {
                    type: "plus"
                }), _("mail_settings_can_invite")), r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__select",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE),
                        options: o,
                        value: !!(n & f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE)
                    })
                }, r.createElement(d.default, {
                    type: "pencil"
                }), _("mail_settings_can_edit_info")), r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__select",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN),
                        options: o,
                        value: !!(n & f.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN)
                    })
                }, r.createElement(d.default, {
                    type: "pin"
                }), _("mail_settings_can_pin")), r.createElement(a.default, {
                    selectable: !1,
                    aside: r.createElement(s.default, {
                        className: "ChatSettingsOptions__longselect",
                        onChange: this.onChange,
                        name: p(f.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS),
                        options: [{
                            value: !1,
                            label: _("mail_settings_only_owner")
                        }, {
                            value: !0,
                            label: _("mail_settings_owner_and_admins")
                        }],
                        value: !!(n & f.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS)
                    })
                }, r.createElement(d.default, {
                    type: "user"
                }), _("mail_settings_admins_can_add_admins")), m.map(function(t) {
                    return r.createElement(a.default, {
                        selectable: !1,
                        key: t.name,
                        aside: r.createElement(s.default, {
                            className: "ChatSettingsOptions__select",
                            onChange: e.onChange,
                            name: p(t.bit),
                            options: t.options,
                            value: !!(n & t.bit)
                        })
                    }, r.createElement(d.default, {
                        type: t.icon
                    }), t.name)
                })), r.createElement(l.default, {
                    alignment: "right"
                }, r.createElement(c.default, {
                    appearance: "tertiary",
                    onClick: this.onCancel
                }, _("global_cancel")), r.createElement(u.default, {
                    onClick: this.onSave,
                    loading: this.state.loading
                }, _("global_save"))))
            }, t
        }(r.Component);
    t.default = m
}, , function(e, t) {
    var n = {}.hasOwnProperty;
    e.exports = function(e, t) {
        return n.call(e, t)
    }
}, , function(e, t, n) {
    "use strict";
    var r = n(316),
        o = n(254),
        i = n(196),
        a = n(447),
        s = n(115),
        c = n(297),
        u = n(408),
        l = n(322),
        d = n(286),
        f = n(253),
        p = n(328),
        _ = n(213);
    e.exports = function(e, t, n, m, g, h) {
        var b = r[e],
            v = b,
            y = g ? "set" : "add",
            O = v && v.prototype,
            w = {},
            E = function(e) {
                var t = O[e];
                i(O, e, "delete" == e ? function(e) {
                    return !(h && !l(e)) && t.call(this, 0 === e ? 0 : e)
                } : "has" == e ? function(e) {
                    return !(h && !l(e)) && t.call(this, 0 === e ? 0 : e)
                } : "get" == e ? function(e) {
                    return h && !l(e) ? void 0 : t.call(this, 0 === e ? 0 : e)
                } : "add" == e ? function(e) {
                    return t.call(this, 0 === e ? 0 : e), this
                } : function(e, n) {
                    return t.call(this, 0 === e ? 0 : e, n), this
                })
            };
        if ("function" == typeof v && (h || O.forEach && !d(function() {
                (new v).entries().next()
            }))) {
            var C = new v,
                j = C[y](h ? {} : -0, 1) != C,
                k = d(function() {
                    C.has(1)
                }),
                T = f(function(e) {
                    new v(e)
                }),
                S = !h && d(function() {
                    for (var e = new v, t = 5; t--;) e[y](t, t);
                    return !e.has(-0)
                });
            T || ((v = t(function(t, n) {
                u(t, v, e);
                var r = _(new b, t, v);
                return void 0 != n && c(n, g, r[y], r), r
            })).prototype = O, O.constructor = v), (k || S) && (E("delete"), E("has"), g && E("get")), (S || j) && E(y), h && O.clear && delete O.clear
        } else v = m.getConstructor(t, e, g, y), a(v.prototype, n), s.NEED = !0;
        return p(v, e), w[e] = v, o(o.G + o.W + o.F * (v != b), w), h || m.setStrong(v, e, g), v
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE", function() {
        return c
    }), n.d(t, "MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN", function() {
        return u
    }), n.d(t, "MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE", function() {
        return l
    }), n.d(t, "MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS", function() {
        return d
    }), n.d(t, "MAIL_CHAT_FLAG_ADMINS_CAN_INVITE_LINK", function() {
        return f
    }), n.d(t, "MAIL_CHATS_ACTION_SEE_INVITE_LINK", function() {
        return p
    }), n.d(t, "MAIL_CHATS_ACTION_CHANGE_INVITE_LINK", function() {
        return _
    }), n.d(t, "MAIL_CHATS_ACTION_INVITE_USER", function() {
        return m
    }), n.d(t, "MAIL_CHATS_ACTION_PIN_OR_UNPIN", function() {
        return g
    }), n.d(t, "MAIL_CHATS_ACTION_CHANGE_TITLE", function() {
        return h
    }), n.d(t, "MAIL_CHATS_ACTION_ADD_ADMIN", function() {
        return b
    }), n.d(t, "canSeeInviteLink", function() {
        return O
    }), n.d(t, "canChangeInviteLink", function() {
        return w
    }), n.d(t, "canAddAdmin", function() {
        return E
    }), n.d(t, "canInviteUser", function() {
        return C
    }), n.d(t, "canKickUser", function() {
        return j
    }), n.d(t, "canPinOrUnpin", function() {
        return k
    }), n.d(t, "canChangeTitle", function() {
        return T
    }), n.d(t, "canChangeAvatar", function() {
        return S
    }), n.d(t, "canSeeAllMessages", function() {
        return M
    }), n.d(t, "checkChatRights", function() {
        return P
    }), n.d(t, "doesChatTabHaveFlag", function() {
        return x
    }), n.d(t, "isUserAdminInChat", function() {
        return I
    }), n.d(t, "isUserOwnerInChat", function() {
        return D
    }), n.d(t, "isUserInvitedByMe", function() {
        return A
    });
    var r, o = n(406),
        i = n(187),
        a = n(1);

    function s(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    var c = 1,
        u = 4,
        l = 8,
        d = 16,
        f = 32,
        p = "see_invite_link",
        _ = "change_invite_link",
        m = "invite_user",
        g = "pin_unpin",
        h = "change_title",
        b = "add_admin",
        v = (s(r = {}, p, f), s(r, _, f), s(r, b, d), s(r, m, c), s(r, g, u), s(r, h, l), r),
        y = 1;

    function O(e, t, n) {
        return P(e, p, t, n)
    }

    function w(e, t, n) {
        return P(e, _, t, n)
    }

    function E(e, t, n, r) {
        var a = Object(i.unpackStore)(e);
        return !D(Object(o.getTab)(a, n || a.peer), t) && P(e, b, n, r)
    }

    function C(e, t, n) {
        return P(e, m, t, n)
    }

    function j(e, t, n, r) {
        var s = Object(i.unpackStore)(e);
        if (function(e, t) {
                var n = Object(i.unpackStore)(e);
                return void 0 !== n.service && (n.service & t) > 0
            }(e, y)) return !0;
        var c = Object(o.getTab)(s, n || s.peer);
        return !(c.data.kicked && !c.data.closed) && (!Object(a.isFvkcomgroup)(e, n) && (!D(c, t) && (!!D(c, r = void 0 === r ? window.vk.id : r) || (I(c, r) ? !I(c, t) : A(c, t) && !I(c, t)))))
    }

    function k(e, t, n) {
        return P(e, g, t, n)
    }

    function T(e, t, n) {
        return P(e, h, t, n)
    }

    function S(e, t, n) {
        return T(e, t, n) && !Object(a.isFvkcomgroup)(e, t)
    }

    function M(e, t, n) {
        return !Object(o.isCommunityPeer)(n) || !!Object(o.getTab)(e, t).caccess[n]
    }

    function P(e, t, n, r) {
        var s = Object(i.unpackStore)(e);
        r = void 0 === r ? window.vk.id : r, n = void 0 === n ? s.peer : n;
        var c = Object(o.getTab)(s, n),
            u = !c.data.kicked && !c.data.closed,
            l = v[t];
        if (Object(a.isFvkcomgroup)(e, n)) switch (t) {
            case b:
            case m:
                return !1;
            case p:
                return u;
            default:
                return s.gid > 0
        }
        switch (t) {
            case p:
            case _:
            case b:
                return x(c, l) ? I(c, r) && u : D(c, r);
            case m:
            case g:
            case h:
                return x(c, l) ? I(c, r) && u : u
        }
        return !1
    }

    function x(e, t) {
        return ((e && e.data && e.data.flags || 0) & t) > 0
    }

    function I(e, t) {
        return (e && e.adminIds || []).indexOf(+t) > -1
    }

    function D(e, t) {
        return e.ownerId === t
    }

    function A(e, t) {
        return -1 !== e.invitedByMe.indexOf(t)
    }
}, function(e, t, n) {
    var r = n(280),
        o = n(182),
        i = n(188);
    e.exports = function(e) {
        return function(t, n, a) {
            var s, c = r(t),
                u = o(c.length),
                l = i(a, u);
            if (e && n != n) {
                for (; u > l;)
                    if ((s = c[l++]) != s) return !0
            } else
                for (; u > l; l++)
                    if ((e || l in c) && c[l] === n) return e || l;
            return !e && -1
        }
    }
}, , , , function(e, t, n) {
    var r = n(367),
        o = n(232);
    e.exports = Object.keys || function(e) {
        return r(e, o)
    }
}, , function(e, t) {
    var n = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")();
    "number" == typeof __g && (__g = n)
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(412)),
        i = n(63),
        a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
            return typeof e
        } : function(e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        };
    var s = "Select...",
        c = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.handleMouseDown = function(e) {
                    r.props.onFocus && "function" == typeof r.props.onFocus && r.props.onFocus(r.state.opened), "mousedown" === e.type && 0 !== e.button || (e.stopPropagation(), e.preventDefault(), r.props.disabled || r.setState({
                        opened: !r.state.opened
                    }))
                }, r.setValue = function(e, t) {
                    var n = {
                        selected: {
                            value: e,
                            label: t
                        },
                        opened: !1
                    };
                    r.fireChangeEvent(n), r.setState(n)
                }, r.fireChangeEvent = function(e) {
                    e.selected !== r.state.selected && r.props.onChange && r.props.onChange({
                        name: r.props.name,
                        selected: e.selected
                    })
                }, r.handleDocumentClick = function(e) {
                    r.mounted && r.state.opened && !r.el.contains(e.target) && r.setState({
                        opened: !1
                    })
                }, r.state = {
                    selected: void 0 !== n.value ? r.getOptionByValue(n.options, n.value) : {
                        label: n.placeholder || s,
                        value: ""
                    },
                    opened: !1
                }, r.mounted = !0, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentWillReceiveProps = function(e) {
                void 0 !== e.value && e.value !== this.state.selected ? this.setState({
                    selected: this.getOptionByValue(e.options, e.value)
                }) : void 0 === e.value && this.setState({
                    selected: {
                        label: e.placeholder || s,
                        value: ""
                    }
                })
            }, t.prototype.componentDidMount = function() {
                this.el = o.findDOMNode(this), document.addEventListener("click", this.handleDocumentClick, !1), document.addEventListener("touchend", this.handleDocumentClick, !1)
            }, t.prototype.componentWillUnmount = function() {
                this.mounted = !1, document.removeEventListener("click", this.handleDocumentClick, !1), document.removeEventListener("touchend", this.handleDocumentClick, !1)
            }, t.prototype.getOptionByValue = function(e, t) {
                return e.find(function(e) {
                    return "object" !== (void 0 === e ? "undefined" : a(e)) ? e === t : e.value === t
                })
            }, t.prototype.renderOption = function(e) {
                var t = this,
                    n = Object(i.classNames)("Select__option", {
                        "Select__option--selected": e === this.state.selected
                    }),
                    o = void 0 !== e.value ? e.value : e.label || e,
                    a = void 0 !== e.label ? e.label : e;
                return r.createElement("div", {
                    key: o,
                    className: n,
                    onMouseDown: function() {
                        return t.setValue(o, a)
                    },
                    onClick: function() {
                        return t.setValue(o, a)
                    }
                }, a)
            }, t.prototype.buildMenu = function() {
                var e = this,
                    t = this.props.options.map(function(t) {
                        return "group" === t.type ? r.createElement("div", {
                            className: "Select__group",
                            key: t.name
                        }, t.name && r.createElement("div", {
                            className: "Select__title"
                        }, t.name), t.items.map(function(t) {
                            return e.renderOption(t)
                        })) : e.renderOption(t)
                    });
                return t.length ? t : r.createElement("div", {
                    className: "Select__noresults"
                }, "No options found")
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.className,
                    n = e.style,
                    o = Object(i.classNames)("Select", t, {
                        "Select--opened": this.state.opened,
                        "Select--disabled": this.props.disabled
                    });
                return r.createElement("div", {
                    className: o,
                    style: n
                }, r.createElement("div", {
                    className: "Select__control",
                    onClick: this.handleMouseDown
                }, r.createElement("div", {
                    className: "Select__placeholder"
                }, "string" == typeof this.state.selected ? this.state.selected : this.state.selected.label), r.createElement("span", {
                    className: "Select__arrow"
                })), this.state.opened && r.createElement("div", {
                    className: "Select__menu"
                }, this.buildMenu()))
            }, t
        }(r.Component);
    t.default = c
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(409),
        i = n(83),
        a = n(135),
        s = n(391),
        c = n(389),
        u = n(1);
    var l = window.elfocus,
        d = o.default.getLang,
        f = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onCopy = function() {
                    r.input && (l(r.input, 0, r.input.value.length), document.execCommand("copy"), r.setState({
                        copied: !0
                    }))
                }, r.onBlinkTextHide = function() {
                    r.setState({
                        copied: !1
                    })
                }, r.getInputRef = function(e) {
                    e && e.element && (r.input = e.element)
                }, r.state = {
                    copied: !1
                }, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                this.input && l(this.input, 0, this.input.value.length)
            }, t.prototype.render = function() {
                var e = this.props,
                    t = e.onReset,
                    n = e.invitationLink,
                    o = e.store,
                    l = d("mail_invite_link_reset_explainer").split("{reset_link}"),
                    f = !Object(u.isFvkcomgroup)(o, o.get().peer);
                return r.createElement("div", {
                    className: "ChatSettingsInvitationLink"
                }, this.props.reseted && r.createElement("div", {
                    className: "ChatSettingsInvitationLink__reseted"
                }, d("mail_invite_link_reseted_explainer")), r.createElement("p", null, d("mail_invite_link_explainer")), r.createElement("div", {
                    className: "ChatSettingsInvitationLink__main"
                }, r.createElement(i.default, {
                    ref: this.getInputRef,
                    readOnly: "readonly",
                    className: "ChatSettingsInvitationLink__input",
                    value: n
                }), r.createElement(a.default, {
                    onClick: this.onCopy
                }, d("mail_get_invite_link_copy")), r.createElement(s.default, {
                    className: "ChatSettingsInvitationLink__copied",
                    shown: this.state.copied,
                    callback: this.onBlinkTextHide
                }, d("mail_invite_link_copied"))), f && r.createElement("p", null, l[0], r.createElement(c.default, {
                    className: "ChatSettingsInvitationLink__reset",
                    onClick: t
                }, d("mail_invite_reset_link")), l[1]))
            }, t
        }(r.Component);
    t.default = f
}, , , function(e, t) {
    e.exports = function(e) {
        return "object" == typeof e ? null !== e : "function" == typeof e
    }
}, function(e, t, n) {
    (function(r, o) {
        var i;
        (function() {
            "use strict";

            function a(e) {
                return "function" == typeof e
            }
            var s, c, u = Array.isArray ? Array.isArray : function(e) {
                    return "[object Array]" === Object.prototype.toString.call(e)
                },
                l = 0,
                d = function(e, t) {
                    E[l] = e, E[l + 1] = t, 2 === (l += 2) && (c ? c(C) : b())
                };
            var f = "undefined" != typeof window ? window : void 0,
                p = f || {},
                _ = p.MutationObserver || p.WebKitMutationObserver,
                m = void 0 !== r && "[object process]" === {}.toString.call(r),
                g = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel;

            function h() {
                return function() {
                    setTimeout(C, 1)
                }
            }
            var b, v, y, O, w, E = new Array(1e3);

            function C() {
                for (var e = 0; e < l; e += 2) {
                    (0, E[e])(E[e + 1]), E[e] = void 0, E[e + 1] = void 0
                }
                l = 0
            }
            m ? b = function() {
                r.nextTick(C)
            } : _ ? (y = 0, O = new _(C), w = document.createTextNode(""), O.observe(w, {
                characterData: !0
            }), b = function() {
                w.data = y = ++y % 2
            }) : g ? ((v = new MessageChannel).port1.onmessage = C, b = function() {
                v.port2.postMessage(0)
            }) : b = void 0 === f ? function() {
                try {
                    var e = n(334);
                    return s = e.runOnLoop || e.runOnContext,
                        function() {
                            s(C)
                        }
                } catch (e) {
                    return h()
                }
            }() : h();
            var j = function(e, t) {
                var n = this._state;
                if (n === M && !e || n === P && !t) return this;
                var r = new this.constructor(T),
                    o = this._result;
                if (n) {
                    var i = arguments[n - 1];
                    d(function() {
                        W(n, r, i, o)
                    })
                } else N(this, r, e, t);
                return r
            };
            var k = function(e) {
                if (e && "object" == typeof e && e.constructor === this) return e;
                var t = new this(T);
                return A(t, e), t
            };

            function T() {}
            var S = void 0,
                M = 1,
                P = 2,
                x = new F;

            function I(e) {
                try {
                    return e.then
                } catch (e) {
                    return x.error = e, x
                }
            }

            function D(e, t, n) {
                t.constructor === e.constructor && n === j && constructor.resolve === k ? function(e, t) {
                    t._state === M ? R(e, t._result) : t._state === P ? B(e, t._result) : N(t, void 0, function(t) {
                        A(e, t)
                    }, function(t) {
                        B(e, t)
                    })
                }(e, t) : n === x ? B(e, x.error) : void 0 === n ? R(e, t) : a(n) ? function(e, t, n) {
                    d(function(e) {
                        var r = !1,
                            o = function(e, t, n, r) {
                                try {
                                    e.call(t, n, r)
                                } catch (e) {
                                    return e
                                }
                            }(n, t, function(n) {
                                r || (r = !0, t !== n ? A(e, n) : R(e, n))
                            }, function(t) {
                                r || (r = !0, B(e, t))
                            }, e._label);
                        !r && o && (r = !0, B(e, o))
                    }, e)
                }(e, t, n) : R(e, t)
            }

            function A(e, t) {
                var n;
                e === t ? B(e, new TypeError("You cannot resolve a promise with itself")) : "function" == typeof(n = t) || "object" == typeof n && null !== n ? D(e, t, I(t)) : R(e, t)
            }

            function L(e) {
                e._onerror && e._onerror(e._result), U(e)
            }

            function R(e, t) {
                e._state === S && (e._result = t, e._state = M, 0 !== e._subscribers.length && d(U, e))
            }

            function B(e, t) {
                e._state === S && (e._state = P, e._result = t, d(L, e))
            }

            function N(e, t, n, r) {
                var o = e._subscribers,
                    i = o.length;
                e._onerror = null, o[i] = t, o[i + M] = n, o[i + P] = r, 0 === i && e._state && d(U, e)
            }

            function U(e) {
                var t = e._subscribers,
                    n = e._state;
                if (0 !== t.length) {
                    for (var r, o, i = e._result, a = 0; a < t.length; a += 3) r = t[a], o = t[a + n], r ? W(n, r, o, i) : o(i);
                    e._subscribers.length = 0
                }
            }

            function F() {
                this.error = null
            }
            var H = new F;

            function W(e, t, n, r) {
                var o, i, s, c, u = a(n);
                if (u) {
                    if ((o = function(e, t) {
                            try {
                                return e(t)
                            } catch (e) {
                                return H.error = e, H
                            }
                        }(n, r)) === H ? (c = !0, i = o.error, o = null) : s = !0, t === o) return void B(t, new TypeError("A promises callback cannot return that same promise."))
                } else o = r, s = !0;
                t._state !== S || (u && s ? A(t, o) : c ? B(t, i) : e === M ? R(t, o) : e === P && B(t, o))
            }
            var K = function(e) {
                return new Q(this, e).promise
            };
            var q = function(e) {
                var t = new this(T);
                if (!u(e)) return B(t, new TypeError("You must pass an array to race.")), t;
                var n = e.length;

                function r(e) {
                    A(t, e)
                }

                function o(e) {
                    B(t, e)
                }
                for (var i = 0; t._state === S && i < n; i++) N(this.resolve(e[i]), void 0, r, o);
                return t
            };
            var z = function(e) {
                    var t = new this(T);
                    return B(t, e), t
                },
                G = 0;
            var V = Y;

            function Y(e) {
                this._id = G++, this._state = void 0, this._result = void 0, this._subscribers = [], T !== e && ("function" != typeof e && function() {
                    throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")
                }(), this instanceof Y ? function(e, t) {
                    try {
                        t(function(t) {
                            A(e, t)
                        }, function(t) {
                            B(e, t)
                        })
                    } catch (t) {
                        B(e, t)
                    }
                }(this, e) : function() {
                    throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")
                }())
            }
            Y.all = K, Y.race = q, Y.resolve = k, Y.reject = z, Y._setScheduler = function(e) {
                c = e
            }, Y._setAsap = function(e) {
                d = e
            }, Y._asap = d, Y.prototype = {
                constructor: Y,
                then: j,
                catch: function(e) {
                    return this.then(null, e)
                }
            };
            var Q = $;

            function $(e, t) {
                this._instanceConstructor = e, this.promise = new e(T), Array.isArray(t) ? (this._input = t, this.length = t.length, this._remaining = t.length, this._result = new Array(this.length), 0 === this.length ? R(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(), 0 === this._remaining && R(this.promise, this._result))) : B(this.promise, this._validationError())
            }
            $.prototype._validationError = function() {
                return new Error("Array Methods must be provided an Array")
            }, $.prototype._enumerate = function() {
                for (var e = this.length, t = this._input, n = 0; this._state === S && n < e; n++) this._eachEntry(t[n], n)
            }, $.prototype._eachEntry = function(e, t) {
                var n = this._instanceConstructor,
                    r = n.resolve;
                if (r === k) {
                    var o = I(e);
                    if (o === j && e._state !== S) this._settledAt(e._state, t, e._result);
                    else if ("function" != typeof o) this._remaining--, this._result[t] = e;
                    else if (n === V) {
                        var i = new n(T);
                        D(i, e, o), this._willSettleAt(i, t)
                    } else this._willSettleAt(new n(function(t) {
                        t(e)
                    }), t)
                } else this._willSettleAt(r(e), t)
            }, $.prototype._settledAt = function(e, t, n) {
                var r = this.promise;
                r._state === S && (this._remaining--, e === P ? B(r, n) : this._result[t] = n), 0 === this._remaining && R(r, this._result)
            }, $.prototype._willSettleAt = function(e, t) {
                var n = this;
                N(e, void 0, function(e) {
                    n._settledAt(M, t, e)
                }, function(e) {
                    n._settledAt(P, t, e)
                })
            };
            var X = function() {
                    var e;
                    if (void 0 !== o) e = o;
                    else if ("undefined" != typeof self) e = self;
                    else try {
                        e = Function("return this")()
                    } catch (e) {
                        throw new Error("polyfill failed because global object is unavailable in this environment")
                    }
                    var t = e.Promise;
                    t && "[object Promise]" === Object.prototype.toString.call(t.resolve()) && !t.cast || (e.Promise = V)
                },
                J = {
                    Promise: V,
                    polyfill: X
                };
            void 0 === (i = function() {
                return J
            }.call(t, n, t, e)) || (e.exports = i), X()
        }).call(this)
    }).call(this, n(236), n(128))
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "browser", function() {
        return i
    }), n.d(t, "mobPlatforms", function() {
        return a
    }), n.d(t, "browserFeatures", function() {
        return s
    }), n.d(t, "initBrowserUtils", function() {
        return c
    });
    var r = n(347),
        o = navigator.userAgent.toLowerCase(),
        i = {
            version: (o.match(/.+(?:me|ox|on|rv|it|era|opr|ie|edge)[\/: ]([\d.]+)/) || [0, "0"])[1],
            opera: /opera/i.test(o) || /opr/i.test(o),
            vivaldi: /vivaldi/i.test(o),
            amigo: /amigo.*mrchrome soc/i.test(o),
            msie: /msie/i.test(o) && !/opera/i.test(o) || /trident\//i.test(o) || /edge/i.test(o),
            msie6: /msie 6/i.test(o) && !/opera/i.test(o),
            msie7: /msie 7/i.test(o) && !/opera/i.test(o),
            msie8: /msie 8/i.test(o) && !/opera/i.test(o),
            msie9: /msie 9/i.test(o) && !/opera/i.test(o),
            msie_edge: /edge/i.test(o) && !/opera/i.test(o),
            mozilla: /firefox/i.test(o),
            chrome: /chrome/i.test(o) && !/edge/i.test(o),
            safari: !/chrome/i.test(o) && /webkit|safari|khtml/i.test(o),
            iphone: /iphone/i.test(o),
            ipod: /ipod/i.test(o),
            iphone4: /iphone.*OS 4/i.test(o),
            ipod4: /ipod.*OS 4/i.test(o),
            ipad: /ipad/i.test(o),
            android: /android/i.test(o),
            bada: /bada/i.test(o),
            mobile: /iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(o),
            msie_mobile: /iemobile/i.test(o),
            safari_mobile: /iphone|ipod|ipad/i.test(o),
            opera_mobile: /opera mini|opera mobi/i.test(o),
            opera_mini: /opera mini/i.test(o),
            mac: /mac/i.test(o),
            windows7: /windows nt 6.1/i.test(o),
            windowsVista: /windows nt 6.0/i.test(o),
            windowsXp: /windows nt (5.2|5.1)/i.test(o),
            search_bot: /(yandex|google|stackrambler|aport|slurp|msnbot|bingbot|twitterbot|ia_archiver|facebookexternalhit)/i.test(o),
            smart_tv: /smart-tv|smarttv/i.test(o)
        },
        a = {
            1: 1,
            2: 1,
            3: 1,
            4: 1,
            5: 1,
            8: 1
        },
        s = {
            wheelEvent: "onwheel" in Object(r.ce)("div") ? "wheel" : void 0 !== document.onmousewheel ? "mousewheel" : i.mozilla ? "MozMousePixelScroll" : "DOMMouseScroll",
            hasBoundingClientRect: "getBoundingClientRect" in Object(r.ce)("div"),
            cmaEnabled: navigator.credentials && navigator.credentials.preventSilentAccess && window.vk && vk.cma
        };

    function c() {
        window._ua || (window._ua = navigator.userAgent.toLowerCase()), window.locDomain || (window.locDomain = location.host.toString().match(/[a-zA-Z]+\.[a-zA-Z]+\.?$/)[0]), window.locHost = location.host, window.locProtocol = location.protocol, window.locHash = location.hash.replace("#/", "").replace("#!", "")
    }
}, , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return c
    });
    var r = n(252),
        o = n(256),
        i = n(112),
        a = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        s = "_im_join_chat";

    function c(e, t) {
        var n = Object(o.createModule)({
            handlers: function(n, o) {
                o(e, "click", s, function(e) {
                    return function(e, t) {
                        var n = domData(t, "chat-id"),
                            o = domData(t, "hash");
                        return lockButton(t), Object(r.joinChat)(n, o, e.get()).then(function(n) {
                            var r = a(n, 1)[0];
                            unlockButton(t), e.get().longpoll.push([Object(i.changePeer)(r)])
                        }).catch(function(e) {
                            showFastBox(getLang("mail_join_invite_error_title"), e), unlockButton(t)
                        })
                    }(t, e.target)
                })
            }
        });
        return {
            unmount: function() {
                Object(o.destroyModule)(n)
            }
        }
    }
}, function(e, t, n) {
    var r = n(184).f,
        o = n(305),
        i = n(151)("toStringTag");
    e.exports = function(e, t, n) {
        e && !o(e = n ? e : e.prototype, i) && r(e, i, {
            configurable: !0,
            value: t
        })
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), t.default = {
        onNewMessagesChunk: function(e) {
            var t = geByClass("post");
            LongView.clearElemsCache && LongView.clearElemsCache(), t.forEach(function(e) {
                return LongView.register(e, "im")
            })
        },
        onHistoryScroll: function(e) {
            LongView.onScroll(e, window.innerHeight)
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return p
    });
    var r = n(46),
        o = n(433),
        i = n(1),
        a = n(252),
        s = n(112),
        c = n(256),
        u = n(192);

    function l(e) {
        var t = e.get().tabbedPeers.map(function(t) {
            return e.get().tabs[t.peer] || e.get().mapped_index && e.get().mapped_index[t.peer]
        }).filter(function(e) {
            return e
        }).filter(function(e) {
            return !e.deletedDialog
        }).map(function(e) {
            return {
                type: "peer",
                peer: e.peerId
            }
        });
        return t.length > 0 && (t = [{
            type: "sep"
        }].concat(t)), t
    }

    function d(e, t) {
        return e.pipeReplace(Promise.resolve(l(t)))
    }

    function f(e, t, n, r) {
        return {
            updateMenu: function(t) {
                ! function(e, t) {
                    geByClass("_im_peer_tab", e).forEach(function(e) {
                        var n = q2ajx(attr(e, "href").split("?")[1]);
                        n.tab !== t.get().active_tab && attr(e, "href", Object(i.getBaseLink)(t) + "?sel=" + n.sel + "&tab=" + t.get().active_tab)
                    })
                }(e, t);
                var r = gpeByClass("_im_right_menu", e);
                d(n, t).then(function() {
                    var e = void 0;
                    (e = t.get().peer ? ge("ui_rmenu_peer_" + t.get().peer) : ge("ui_rmenu_" + t.get().active_tab)) && uiRightMenu.switchMenu(e, !0), uiRightMenu.hideProgress(r)
                })
            },
            updateName: function(e, t) {
                var n = ge("ui_rmenu_peer_" + e);
                if (n) {
                    var r = geByClass1("_im_r_tx", n),
                        o = t.get().tabs[e].tab;
                    val(r, o)
                }
            },
            updateCounter: function(e, t) {
                var n = ge("ui_rmenu_peer_" + t);
                if (n) {
                    var r = geByClass1("_im_r_ct", n),
                        o = e.get().tabs[t].unread;
                    val(r, o > 0 ? o : ""), toggleClass(n, "im-right-menu--unread", o > 0)
                }
            },
            unmount: function() {
                Object(c.destroyModule)(r), n.unmount()
            }
        }
    }

    function p(e, t, n) {
        var p = Object(r.mount)(e, Object(o.default)({
                limit: 50,
                offset: 0,
                noScroll: !0,
                elements: l(t)
            }), function() {
                return {
                    idFn: function(e) {
                        return e.peer || "000"
                    },
                    renderFn: function(e, t) {
                        if ("sep" === t.type) return getTemplate("im_right_menu_sep", {});
                        var n = Object(i.getBaseLink)(e) + "?sel=" + t.peer + "&tab=" + e.get().active_tab,
                            r = Object(i.getBareTab)(t.peer, e),
                            o = r.tab;
                        return o = getTemplate("im_right_menu_ct", {
                            name: o,
                            count: r.unread > 0 ? r.unread : ""
                        }), getTemplate("im_right_menu_tpl", {
                            href: n,
                            label: o,
                            peer: t.peer,
                            attrs: 'title="' + stripHTML(r.tab) + '"',
                            cls: r.unread > 0 ? "im-right-menu--unread" : ""
                        })
                    }.bind(null, t)
                }
            }),
            _ = function(e, t, n, r) {
                var o = gpeByClass("_im_peer_tab", r),
                    i = intval(domData(o, "list-id")),
                    c = e.get().tabbedPeers.filter(function(e) {
                        return e.peer !== i
                    });
                return e.set(a.updateTabbedPeers.bind(null, c, !0)).then(function() {
                    if (d(t, e), i === e.get().peer) e.get().longpoll.push([Object(s.resetPeer)()]);
                    else if (0 !== e.get().peer) {
                        var n = gpeByClass("_im_right_menu", r);
                        uiRightMenu.hideSliding(n)
                    }
                }), cancelEvent(n), !1
            }.bind(null, t, p),
            m = Object(c.createModule)({
                handlers: function(n, r) {
                    r(e, "click", "_im_r_cl", _), r(e, "click", "_im_peer_tab", function(e, n) {
                        if (!checkEvent(e)) {
                            var r = intval(domData(n, "list-id"));
                            t.get().longpoll.push([Object(s.changePeer)(r, !1, !0, !0)]), cancelEvent(e)
                        }
                    }), u.FOLDERS.forEach(function(r) {
                        n(geByClass1("_ui_item_" + r, e.parentNode), "mousedown", function(e, t, n) {
                            1 === n.which && (e.get().peer && e.get().longpoll.push([Object(s.resetPeer)()]), e.get().longpoll.push([Object(s.changeTab)(t)]), cancelEvent(n))
                        }.bind(null, t, r))
                    })
                }
            });
        return f(e, 0, p, m)
    }
}, , function(e, t, n) {
    "use strict";
    var r = n(247),
        o = n(38),
        i = n(270);
    e.exports = function() {
        function e(e, t, n, r, a, s) {
            s !== i && o(!1, "Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")
        }

        function t() {
            return e
        }
        e.isRequired = e;
        var n = {
            array: e,
            bool: e,
            func: e,
            number: e,
            object: e,
            string: e,
            symbol: e,
            any: e,
            arrayOf: t,
            element: e,
            instanceOf: t,
            node: e,
            objectOf: t,
            oneOf: t,
            oneOfType: t,
            shape: t,
            exact: t
        };
        return n.checkPropTypes = r, n.PropTypes = n, n
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(470),
        o = n(16),
        i = n(433),
        a = n(323),
        s = n(112),
        c = n(252),
        u = n(66),
        l = n(1),
        d = n(219),
        f = n(274),
        p = a.Promise;
    window.IM = {
        init: function(e) {
            if (window.imwl = e.imwl, Object(d.startLoggingAllUnhandled)(), addTemplates(f), window.Promise || (window.Promise = p), window.cur.lang.dont_attach = getLang("mail_dont_add_media"), e.failed) return Object(o.mount)(geByClass1("im-sick", ge("page_body")), null);
            localStorage.removeItem("im_sick_timer"), e.tabbedPeers = (e.tabbedPeers || []).map(function(e) {
                return {
                    peer: e,
                    type: "perm"
                }
            }), cur.ctrl_submit = e.ctrl_submit, cur.module = "im", cur.mutedPeers = e.mutedPeers, cur.gid = e.gid, cur.peer = e.peer, e.blockedFlagUpdates = {}, e.msgid = intval(nav.objLoc.msgid), cur.options = {
                blacklist_hash: e.thash
            };
            var t = -10800 - 60 * (new Date).getTimezoneOffset(),
                n = e.timeshift;
            e.timeshift = n - t, e.oCache = {}, e.ref_id = nav.objLoc.ref, e.ref_source = nav.objLoc.ref_source;
            var a = e.owners;
            e.owners = void 0;
            var _ = Object(i.default)(e);
            a.forEach(function(e) {
                return Object(u.oCacheAdd)(_, e)
            }), a = void 0, Object(l.normalizeTabsGotFromServer)(_, _.get().tabs), cur.imClassicInterface = Object(l.isClassicInterface)(_);
            var m = Object(r.mount)(geByClass1("js-im-page", ge("page_body")), _);
            Object(c.updateMentions)(_.get()), window.IMBRIDGE = {
                chatPhotoSaved: function(e) {
                    curBox() && curBox().hide();
                    var t = (e || {})[1];
                    return t ? (cur.pvShown && layers.fullhide(!0, !0), "im" != cur.module || _.get().peer != t ? nav.go("/im?sel=c" + (t - 2e9)) : void 0) : nav.reload()
                },
                updateHistory: function(e) {
                    _.set(c.updateHistory.bind(null, e)).then(function() {
                        m.updateHistory(e)
                    })
                },
                activateTab: function(e) {
                    _.get().gid || _.get().longpoll.push([Object(s.changePeer)(intval(e), !1, !1, !0)])
                }
            };
            var g = !1;
            cur.nav.push(function() {
                if (g) return !0;
                _.get().audio_msg && _.get().audio_msg.isRecording && m.cancelRecording(), AudioMessagePlayer.detachPlayer();
                var t = m.route.apply(null, arguments);
                return !1 !== t && (m.unmount(), window.IMBRIDGE = void 0, _.unmount(), window.store = void 0, g = !0, e = !1, _ = !1, m = !1, Object(d.stopLoggingAllUnhandled)()), t
            })
        }
    };
    try {
        stManager.done("imn.js")
    } catch (e) {}
}, function(e, t) {}, , , , function(e, t, n) {
    var r = n(305),
        o = n(8),
        i = n(110)("IE_PROTO"),
        a = Object.prototype;
    e.exports = Object.getPrototypeOf || function(e) {
        return e = o(e), r(e, i) ? e[i] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? a : null
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(252),
        o = n(228),
        i = n(275),
        a = n(1),
        s = n(433),
        c = n(256),
        u = n(112),
        l = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function d(e, t, n, d) {
        var f = ge("box_layer_wrap"),
            p = t.get().longpoll,
            _ = Object(s.default)({
                peer: 0,
                longpoll: p,
                oCache: {},
                tabs: Object(a.tabFromIds)(d.msgs, d.hash)
            }),
            m = Object(i.mount)(e.bodyNode, _, function() {
                return {}
            }),
            g = Object(o.mount)(e.bodyNode, t);
        Object(a.ensureDomHasActions)(e.bodyNode);
        var h = function(e, t, n) {
            for (var o = arguments.length, i = Array(o > 3 ? o - 3 : 0), a = 3; a < o; a++) i[a - 3] = arguments[a];
            i.filter(function(e) {
                return inArray(e.type, [u.SET_FLAGS, u.RESET_FLAGS, u.CHANGE_PEER])
            }).forEach(function(o) {
                if (o.type !== u.CHANGE_PEER) {
                    if (o.flags === u.FLAG_IMPORTANT) {
                        var i = o.type === u.SET_FLAGS;
                        e.set(r.updateFavMessage.bind(null, [o.messageId], 0, i)).then(function(n) {
                            t.markImportant(o.messageId, i, e)
                        })
                    }
                } else n.hide()
            })
        }.bind(null, t, m, e);
        p.onData(h);
        var b = function(e, t, n, o) {
                if (!e.loading && !e.all && n.scrollTop + window.innerHeight - n.scrollHeight > -300) {
                    var i = geByClass1("_im_peer_history", t.bodyNode);
                    e.loading = !0, Object(a.wrapLoading)(i)(Object(r.loadImportant)(e.offset).then(function(t) {
                        var n = l(t, 4),
                            s = (n[0], n[1]),
                            c = (n[2], n[3]);
                        e.all = c.all, e.offset = c.offset, e.all ? addClass(i, "im-important_all") : e.loading = !1, o.set(r.mergeTabs.bind(null, Object(a.tabFromIds)(c.msgs, c.hash)));
                        var u = ce("div");
                        u.innerHTML = s, i.appendChild(u), Object(a.ensureDomHasActions)(i)
                    }), "bottom")
                }
            }.bind(null, {
                all: !1,
                loading: d.all,
                offset: d.offset
            }, e, f, _),
            v = Object(c.createModule)({
                handlers: function(e, t) {
                    e(f, "scroll", b)
                }
            });
        return {
            unmount: function() {
                Object(c.destroyModule)(v), g.unmount(), m.unmount(), p.offData(h)
            }
        }
    }
}, , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "create", function() {
        return s
    });
    var r = n(433),
        o = n(1),
        i = n(192);

    function a(e, t, n, r, a) {
        switch (t) {
            case i.ARROW_UP:
                Object(o.isEditableFocused)() || (r.scroll(a, "up"), cancelEvent(n));
                break;
            case i.ARROW_DOWN:
                Object(o.isEditableFocused)() || (r.scroll(a, "down"), cancelEvent(n));
                break;
            case i.PAGE_UP:
                n.ctrlKey || Object(o.isClassicInterface)(a) || (r.scroll(a, "up", !0), cancelEvent(n));
                break;
            case i.PAGE_DOWN:
                n.ctrlKey || Object(o.isClassicInterface)(a) || (r.scroll(a, "down", !0), cancelEvent(n));
                break;
            case i.HOME:
                Object(o.isEditableFocused)() || (r.scroll(a, "up", !1, !0), cancelEvent(n));
                break;
            case i.END_KEY:
                Object(o.isEditableFocused)() || (r.scroll(a, "down", !1, !0), cancelEvent(n));
                break;
            case i.PRINTABLE:
                r.focustTxt(e)
        }
    }

    function s(e, t, n, s, c, u) {
        var l = Object(r.default)({
            state: t || "default"
        });
        return {
            signal: function(t, r) {
                if (!(cur.storyLayer || cur.articleEditorLayer || window.isArticleLayerOpen())) switch (l.get().state) {
                    case "default":
                        return a(l, t, r, s, e);
                    case "fwd":
                    case "search":
                        return function(e, t, n, r, a, s) {
                            switch (t) {
                                case i.ARROW_DOWN:
                                    r.hoverNextDialog(s), cancelEvent(n);
                                    break;
                                case i.ARROW_UP:
                                    r.hoverPrevDialog(s), cancelEvent(n);
                                    break;
                                case i.ENTER:
                                    Object(o.isEditableFocused)() && !gpeByClass("_im_dialogs_search_input", document.activeElement) || r.selectHoveredDialog(s);
                                    break;
                                case i.PRINTABLE:
                                    a.focusInput(s)
                            }
                        }(0, t, r, n, c, e);
                    case "create":
                        return function(e, t, n, r, a) {
                            switch (t) {
                                case i.PAGE_UP:
                                    !n.ctrlKey && Object(o.isClassicInterface)(a) && (r.scroll("up"), cancelEvent(n));
                                    break;
                                case i.PAGE_DOWN:
                                    !n.ctrlKey && Object(o.isClassicInterface)(a) && (r.scroll("down"), cancelEvent(n));
                                    break;
                                case i.ARROW_DOWN:
                                    r.hoverNextElement(a);
                                    break;
                                case i.ARROW_UP:
                                    r.hoverPrevElement(a);
                                    break;
                                case i.ENTER:
                                    gpeByClass("_im_dialogs_creation_name", document.activeElement) ? r.confirmCreate(a) : gpeByClass("im-create--search", document.activeElement) && r.selectElement(a);
                                    break;
                                case i.PRINTABLE:
                                    r.focusSearch(a)
                            }
                        }(0, t, r, u, e);
                    case "message":
                        return function(e, t, n, r, o) {
                            switch (t) {
                                case i.HOME:
                                case i.END_KEY:
                                    r.isEmpty(o) && a(e, t, n, r, o);
                                    break;
                                case i.PAGE_UP:
                                case i.PAGE_DOWN:
                                    a(e, t, n, r, o)
                            }
                        }(l, t, r, s, e);
                    default:
                        throw new Error("Unknown state: " + l.get().state)
                }
            },
            transition: function(e) {
                return l.set(function(e, t) {
                    return t.state = e, Promise.resolve(t)
                }.bind(null, e))
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "lpLogFc", function() {
        return i
    }), n.d(t, "longpollTesting_onFcEvents", function() {
        return f
    }), n.d(t, "longpollTesting_onImEvents", function() {
        return p
    });
    var r = n(219);

    function o(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
            return n
        }
        return Array.from(e)
    }

    function i(e, t) {
        var n;
        if (window.vk.lpConfig.debug) {
            for (var r = "background: " + e + "; color: white", o = new Date, i = function(e) {
                    return e < 10 ? "0" + e : e
                }, a = arguments.length, s = Array(a > 2 ? a - 2 : 0), c = 2; c < a; c++) s[c - 2] = arguments[c];
            (n = console).log.apply(n, ["%c " + o.getHours() + ":" + i(o.getMinutes()) + ":" + i(o.getSeconds()) + ":" + o.getMilliseconds() + " " + t + " ", r].concat(s))
        }
    }

    function a() {
        return window.lpBufferFc || (window.lpBufferFc = []), window.lpBufferFc
    }

    function s() {
        return window.lpBufferIm || (window.lpBufferIm = []), window.lpBufferIm
    }

    function c(e, t) {
        window.lpWeird || (window.lpWeird = []), window.lpWeird.push({
            msg: e,
            ev: t,
            is_master: window.curNotifier.is_server
        }), setTimeout(u, 1e4)
    }

    function u() {
        window.lpWeird.length && (Object(r.imWeirdLog)("fc_im_differ", {
            diff: window.lpWeird
        }, !1), window.lpWeird = [])
    }

    function l() {
        return "im" === window.cur.module && window.store && window.store.get().longpoll && !window.store.get().stopped
    }

    function d() {
        var e;
        l() && (s().forEach(function(e) {
            !a().find(function(t) {
                return e.ev === t.ev
            }) && e.time < Date.now() - 1e3 && !e.warned && (e.warned = !0, i("red", "im not fc", e.ev), Object(r.isWeirdLogging)() && c("im not fc", e.ev))
        }), a().forEach(function(e) {
            var t = s().find(function(t) {
                return t.ev === e.ev
            });
            t && t.warned && !e.warned && (e.warned = !0, i("red", "now fc like im", e.ev), Object(r.isWeirdLogging)() && c("now fc like im", e.ev))
        })), e = Date.now() - 3e4, window.lpBufferFc = a().filter(function(t) {
            return t.time > e
        }), window.lpBufferIm = s().filter(function(t) {
            return t.time > e
        })
    }

    function f(e) {
        var t;
        l() && ((t = a()).push.apply(t, o(e.map(function(e) {
            return {
                time: Date.now(),
                ev: JSON.stringify(e),
                warned: !1
            }
        }))), setTimeout(d, 0));
        i.apply(void 0, ["green", "fc"].concat(o(e)))
    }

    function p(e) {
        var t;
        l() && ((t = s()).push.apply(t, o(e.map(function(e) {
            return {
                time: Date.now(),
                ev: JSON.stringify(e),
                warned: !1
            }
        }))), setTimeout(d, 1100));
        i.apply(void 0, ["blue", "im"].concat(o(e)))
    }
    window.longpollTesting_onImEvents = p
}, function(e, t, n) {
    "use strict";
    var r = !("undefined" == typeof window || !window.document || !window.document.createElement),
        o = {
            canUseDOM: r,
            canUseWorkers: "undefined" != typeof Worker,
            canUseEventListeners: r && !(!window.addEventListener && !window.attachEvent),
            canUseViewport: r && !!window.screen,
            isInWorker: !r
        };
    e.exports = o
}, function(e, t, n) {
    var r = n(322);
    e.exports = function(e) {
        if (!r(e)) throw TypeError(e + " is not an object!");
        return e
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "ge", function() {
        return s
    }), n.d(t, "geByTag", function() {
        return c
    }), n.d(t, "geByTag1", function() {
        return u
    }), n.d(t, "geByClass", function() {
        return l
    }), n.d(t, "geByClass1", function() {
        return d
    }), n.d(t, "gpeByClass", function() {
        return f
    }), n.d(t, "domQuery", function() {
        return p
    }), n.d(t, "domQuery1", function() {
        return _
    }), n.d(t, "domClosest", function() {
        return m
    }), n.d(t, "domClosestByTag", function() {
        return g
    }), n.d(t, "gpeByTag", function() {
        return h
    }), n.d(t, "ce", function() {
        return b
    }), n.d(t, "cf", function() {
        return E
    }), n.d(t, "re", function() {
        return C
    }), n.d(t, "se", function() {
        return j
    }), n.d(t, "sech", function() {
        return k
    }), n.d(t, "rs", function() {
        return T
    }), n.d(t, "psr", function() {
        return S
    }), n.d(t, "domReplaceEl", function() {
        return M
    }), n.d(t, "domEL", function() {
        return P
    }), n.d(t, "domNS", function() {
        return x
    }), n.d(t, "domPS", function() {
        return I
    }), n.d(t, "domFC", function() {
        return D
    }), n.d(t, "domLC", function() {
        return A
    }), n.d(t, "domPN", function() {
        return L
    }), n.d(t, "domChildren", function() {
        return R
    }), n.d(t, "domInsertBefore", function() {
        return B
    }), n.d(t, "domInsertAfter", function() {
        return N
    }), n.d(t, "domByClass", function() {
        return U
    }), n.d(t, "domData", function() {
        return F
    }), n.d(t, "domChildIndex", function() {
        return H
    }), n.d(t, "domCA", function() {
        return W
    }), n.d(t, "domClosestSibling", function() {
        return K
    }), n.d(t, "matchesSelector", function() {
        return q
    }), n.d(t, "isHover", function() {
        return z
    }), n.d(t, "isAncestor", function() {
        return G
    }), n.d(t, "getScroll", function() {
        return V
    }), n.d(t, "domClosestPositioned", function() {
        return Y
    }), n.d(t, "domClosestOverflowHidden", function() {
        return Q
    }), n.d(t, "show", function() {
        return $
    }), n.d(t, "hide", function() {
        return X
    }), n.d(t, "isVisible", function() {
        return J
    }), n.d(t, "clientHeight", function() {
        return Z
    }), n.d(t, "getClientRectOffsetY", function() {
        return ee
    }), n.d(t, "toggle", function() {
        return te
    }), n.d(t, "boundingRectEnabled", function() {
        return ne
    }), n.d(t, "getXYRect", function() {
        return re
    }), n.d(t, "getXY", function() {
        return oe
    }), n.d(t, "isWindow", function() {
        return ie
    }), n.d(t, "getSize", function() {
        return ae
    }), n.d(t, "getW", function() {
        return se
    }), n.d(t, "getH", function() {
        return ce
    }), n.d(t, "hasClass", function() {
        return ue
    }), n.d(t, "addClass", function() {
        return le
    }), n.d(t, "addClassDelayed", function() {
        return de
    }), n.d(t, "removeClass", function() {
        return fe
    }), n.d(t, "removeClassDelayed", function() {
        return pe
    }), n.d(t, "toggleClass", function() {
        return _e
    }), n.d(t, "toggleClassDelayed", function() {
        return me
    }), n.d(t, "replaceClass", function() {
        return ge
    }), n.d(t, "getStyle", function() {
        return he
    }), n.d(t, "setStyle", function() {
        return be
    }), n.d(t, "setStyleDelayed", function() {
        return ve
    }), n.d(t, "setPseudoStyle", function() {
        return ye
    }), n.d(t, "data", function() {
        return Oe
    }), n.d(t, "attr", function() {
        return we
    }), n.d(t, "removeAttr", function() {
        return Ee
    }), n.d(t, "removeData", function() {
        return Ce
    }), n.d(t, "cleanElems", function() {
        return je
    }), n.d(t, "setTitle", function() {
        return ke
    }), n.d(t, "getZoom", function() {
        return Te
    }), n.d(t, "val", function() {
        return Se
    }), n.d(t, "elfocus", function() {
        return Me
    }), n.d(t, "traverseParent", function() {
        return Pe
    }), n.d(t, "setDocumentTitle", function() {
        return Ie
    }), n.d(t, "lockDocumentTitle", function() {
        return De
    }), n.d(t, "initDomScripts", function() {
        return Ae
    });
    var r = n(269),
        o = n(45),
        i = n(324),
        a = n(95),
        s = function(e) {
            return "string" == typeof e || "number" == typeof e ? document.getElementById(e) : e
        };

    function c(e, t) {
        return (t = s(t) || document).getElementsByTagName(e)
    }

    function u(e, t) {
        return (t = s(t) || document).querySelector && t.querySelector(e) || c(e, t)[0]
    }

    function l(e, t, n) {
        return t = s(t) || document, n = n || "*", e = ("." + e).replace(/\s+/gm, "."), Array.prototype.slice.call(t.querySelectorAll(n + e))
    }

    function d(e, t, n) {
        return t = s(t) || document, n = n || "*", t.querySelector && t.querySelector(n + ("." + e).replace(/\s+/gm, ".")) || l(e, t, n)[0]
    }

    function f(e, t, n) {
        if (!(t = s(t))) return null;
        for (; n !== t && (t = t.parentNode);)
            if (ue(t, e)) return t;
        return null
    }

    function p(e, t) {
        return (t || document).querySelectorAll(e)
    }

    function _(e, t) {
        return (t || document).querySelector(e)
    }

    function m(e, t) {
        return ue(t, e) ? t : f(e, t)
    }

    function g(e, t) {
        return e = e.toUpperCase(), t.nodeType === Node.ELEMENT_NODE && t.tagName.toUpperCase() === e ? t : h(e, t)
    }

    function h(e, t) {
        if (!(t = s(t))) return null;
        for (e = e.toUpperCase(); t = t.parentNode;)
            if (t.tagName && t.tagName.toUpperCase() === e) return t;
        return null
    }

    function b(e, t, n) {
        var o = document.createElement(e);
        return t && Object(r.extend)(o, t), n && be(o, n), o
    }
    var v, y, O, w, E = (v = document, y = v.createDocumentFragment(), O = v.createElement("div"), w = v.createRange && v.createRange(), y.appendChild(O), w && w.selectNodeContents(O), w && w.createContextualFragment ? function(e) {
        return e ? w.createContextualFragment(e) : v.createDocumentFragment()
    } : function(e) {
        if (!e) return v.createDocumentFragment();
        O.innerHTML = e;
        for (var t = v.createDocumentFragment(); O.firstChild;) t.appendChild(O.firstChild);
        return t
    });

    function C(e) {
        return (e = s(e)) && e.parentNode && e.parentNode.removeChild(e), e
    }
    var j = function(e) {
            return D(b("div", {
                innerHTML: e
            }))
        },
        k = function(e) {
            return R(b("div", {
                innerHTML: e
            }))
        };

    function T(e, t) {
        return Object(r.each)(t, function(t, n) {
            e = e.replace(new RegExp("%" + t + "%", "g"), (void 0 === n ? "" : n).toString().replace(/\$/g, "&#036;"))
        }), e
    }

    function S(e) {
        return "https:" !== locProtocol ? e : e = (e = (e = (e = (e = e.replace(/http:\/\/(cs(\d+)\.vk\.me\/c(\d+)\/)/gi, "https://$1")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\/c(\d+)\/(v\d+\/|[a-z0-9\/_:\-]+\.jpg)/gi, "https://pp.vk.me/c$3/$4")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\/([a-z0-9\/_:\-]+\.jpg)/gi, "https://pp.vk.me/c$1/$3")).replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\//gi, "https://ps.vk.me/c$1/")).replace(/http:\/\/video(\d+)\.vkadre\.ru\//gi, "https://ps.vk.me/v$1/")
    }

    function M(e, t) {
        return Object(r.isString)(t) && (t = j(t)), L(e).replaceChild(t, e), t
    }

    function P(e, t) {
        for (t = t ? "previousSibling" : "nextSibling"; e && !e.tagName;) e = e[t];
        return e
    }
    var x = function(e) {
            return P((e || {}).nextSibling)
        },
        I = function(e) {
            return P((e || {}).previousSibling, 1)
        },
        D = function(e) {
            return P((e || {}).firstChild)
        },
        A = function(e) {
            return P((e || {}).lastChild, 1)
        },
        L = function(e) {
            return (e || {}).parentNode
        };

    function R(e) {
        for (var t = [], n = e.childNodes, r = 0; r < n.length; r++) n[r].tagName && t.push(n[r]);
        return t
    }

    function B(e, t) {
        var n = L(t);
        return n && n.insertBefore(e, t)
    }

    function N(e, t) {
        var n = L(t);
        return n && n.insertBefore(e, x(t))
    }

    function U(e, t) {
        return e ? d(t, e) : e
    }

    function F(e, t, n) {
        return e ? void 0 !== n ? (null === n ? e.removeAttribute("data-" + t) : e.setAttribute("data-" + t, n), n) : e.getAttribute("data-" + t) : null
    }

    function H(e) {
        for (var t = 0; null != (e = I(e));) t++;
        return t
    }

    function W(e, t) {
        do {
            e = L(e)
        } while (e && !q(e, t));
        return e
    }

    function K(e, t, n) {
        for (var r = null; null === r && e;)(e = -1 === n ? I(e) : x(e)) && q(e, t) && (r = e);
        return r
    }

    function q(e, t) {
        return !(!(e = s(e)) || e === document) && (e.matches || e.matchesSelector || e.mozMatchesSelector || e.msMatchesSelector || e.oMatchesSelector || e.webkitMatchesSelector || function(e) {
            for (var t = (this.document || this.ownerDocument).querySelectorAll(e), n = t.length; --n >= 0 && t.item(n) !== this;);
            return n > -1
        }).call(e, t)
    }

    function z(e) {
        return q(e, ":hover")
    }

    function G(e, t) {
        var n = s(e);
        if (t = s(t), !e || !t) return !1;
        for (; n = n.parentNode;)
            if (n === t) return !0;
        return !1
    }

    function V() {
        var e = i.browser.msie6 ? s("PageContainer") : document.body,
            t = document.documentElement;
        return [e.scrollLeft || t.scrollLeft || window.pageXOffset || 0, e.scrollTop || t.scrollTop || window.pageYOffset || 0, t.clientWidth || e.clientWidth || 0, t.clientHeight || e.clientHeight || 0]
    }

    function Y(e, t) {
        for (var n = (t = t || {}).fromEl || L(e), o = t.positions || ["relative", "absolute", "fixed"]; n && n !== bodyNode;) {
            var i = he(n, "position");
            if (Object(r.inArray)(i, o) && (!t.noOverflow || "hidden" !== he(n, "overflow"))) break;
            n = L(n)
        }
        return n
    }

    function Q(e, t) {
        for (var n = e = s(e), r = void 0, o = void 0, a = void 0, c = !1; n && n.tagName && n !== bodyNode;) {
            if (r = he(n, "position"), o = he(n, "overflow"), a = he(n, "transform"), t && i.browser.mozilla) {
                if ("page_wrap" != n.id && n !== e && "visible" !== o && ("static" === r ? !c || "relative" === c : "fixed" !== c)) break
            } else if (n !== e && "visible" !== o && ("static" === r ? !c || "relative" === c : "fixed" !== c)) break;
            "none" !== a ? c = void 0 : "static" !== r && "fixed" !== c && (c = r), n = L(n)
        }
        return n
    }

    function $(e) {
        var t = arguments.length;
        if (t > 1)
            for (var n = 0; n < t; n++) $(arguments[n]);
        else if ((e = s(e)) && e.style) {
            var r = e.olddisplay,
                o = e.tagName.toLowerCase(),
                a = "block";
            e.style.display = r || "", "none" === he(e, "display") && (a = ue(e, "inline") || ue(e, "_inline") ? "inline" : ue(e, "_inline_block") ? "inline-block" : "tr" !== o || i.browser.msie ? "table" !== o || i.browser.msie ? "block" : "table" : "table-row", e.style.display = e.olddisplay = a)
        }
    }

    function X(e) {
        var t = arguments.length;
        if (t > 1)
            for (var n = 0; n < t; n++) X(arguments[n]);
        else if ((e = s(e)) && e.style) {
            var r = he(e, "display");
            e.olddisplay = "none" !== r ? r : "", e.style.display = "none"
        }
    }

    function J(e) {
        return !(!(e = s(e)) || !e.style) && "none" !== he(e, "display")
    }

    function Z() {
        return window.innerHeight || document.documentElement.clientHeight || bodyNode.clientHeight
    }

    function ee(e, t, n) {
        e = s(e), n = n || 0;
        var o = oe(e)[1],
            i = ae(e)[1],
            a = window,
            c = document.documentElement,
            u = Math.max(Object(r.intval)(a.innerHeight), Object(r.intval)(c.clientHeight)),
            l = s("page_header_cont"),
            d = c.scrollTop || bodyNode.scrollTop || window.scrollY || 0,
            f = vk.staticheader ? Math.max(0, ae(l)[1] - d) : ae(l)[1];
        if (t) {
            if (o + i < d + f + n) return o + i - d - f - n;
            if (o > d + u - n) return o - d - u + n
        } else {
            if (o < d + f + n) return o - d - f - n;
            if (o + i > d + u - n) return o + i - d - u + n
        }
        return 0
    }

    function te(e, t) {
        return void 0 === t && (t = !J(e)), t ? $(e) : X(e), t
    }

    function ne(e) {
        return void 0 !== e.getBoundingClientRect
    }

    function re(e, t) {
        var n = void 0;
        if (t && "inline" === he(e, "display")) {
            var r = e.getClientRects();
            n = r && r[0] || e.getBoundingClientRect()
        } else n = e.getBoundingClientRect();
        return n
    }

    function oe(e, t) {
        if (!(e = s(e))) return [0, 0];
        var n = e.ownerDocument,
            r = {
                top: 0,
                left: 0
            };
        if (!n) return [0, 0];
        var o = n.documentElement;
        ne(e) && (r = re(e, !0));
        var i = n === n.window ? n : 9 === n.nodeType && (n.defaultView || n.parentWindow);
        return [r.left + (t ? 0 : i.pageXOffset || o.scrollLeft) - (o.clientLeft || 0), r.top + (t ? 0 : i.pageYOffset || o.scrollTop) - (o.clientTop || 0)]
    }

    function ie(e) {
        return null != e && e === e.window
    }

    function ae(e, t, n) {
        e = s(e);
        var o = document.documentElement,
            i = [0, 0],
            a = void 0;
        if (t && "border-box" === he(e, "boxSizing") && (t = !1), e === document) i = [Math.max(o.clientWidth, bodyNode.scrollWidth, o.scrollWidth, bodyNode.offsetWidth, o.offsetWidth), Math.max(o.clientHeight, bodyNode.scrollHeight, o.scrollHeight, bodyNode.offsetHeight, o.offsetHeight)];
        else if (e) {
            var c = function() {
                i = ne(e) && (a = re(e, n)) && void 0 !== a.width ? [a.width, a.height] : [e.offsetWidth, e.offsetHeight], t && Object(r.each)(i, function(t, n) {
                    var o = t ? ["Top", "Bottom"] : ["Left", "Right"];
                    Object(r.each)(o, function() {
                        i[t] -= parseFloat(he(e, "padding" + this)) || 0, i[t] -= parseFloat(he(e, "border" + this + "Width")) || 0
                    })
                })
            };
            if (J(e)) c();
            else {
                var u = {
                        position: "absolute",
                        visibility: "hidden",
                        display: "block"
                    },
                    l = {},
                    d = !1;
                e.style.cssText.indexOf("!important") > -1 && (d = e.style.cssText), Object(r.each)(u, function(t, n) {
                    l[t] = e.style[t], e.style[t] = n
                }), c(), Object(r.each)(u, function(t, n) {
                    e.style[t] = l[t]
                }), d && (e.style.cssText = d)
            }
        }
        return i
    }

    function se(e) {
        return ae(e)[0]
    }

    function ce(e) {
        return ae(e)[1]
    }

    function ue(e, t) {
        var n = s(e);
        return n && 1 === n.nodeType && (" " + n.className + " ").replace(window.whitespaceRegex, " ").indexOf(" " + t + " ") >= 0
    }

    function le(e, t) {
        var n = s(e);
        n && !ue(n, t) && (n.className = (n.className ? n.className + " " : "") + t)
    }
    window.whitespaceRegex = /[\t\r\n\f]/g;
    var de = function(e, t, n) {
        n = Object(r.positive)(n), setTimeout(le.pbind(e, t), n)
    };

    function fe(e, t) {
        var n = s(e);
        n && (n.className = Object(r.trim)((n.className || "").replace(new RegExp("(\\s|^)" + t + "(\\s|$)"), " ")))
    }
    var pe = function(e, t, n) {
        n = Object(r.positive)(n), setTimeout(fe.pbind(e, t), n)
    };

    function _e(e, t, n) {
        return void 0 === n && (n = !ue(e, t)), (n ? le : fe)(e, t), n
    }

    function me(e, t, n, o) {
        return o = Object(r.positive)(o), void 0 === n && (n = !ue(e, t)), (n ? de : pe)(e, t, o), n
    }

    function ge(e, t, n) {
        fe(e, t), le(e, n)
    }

    function he(e, t, n) {
        if (e = s(e), Object(r.isArray)(t)) {
            var o = {};
            return Object(r.each)(t, function(t, n) {
                return o[n] = he(e, n)
            }), o
        }
        if (!e) return "";
        if (void 0 === n && (n = !0), !n && "opacity" === t && i.browser.msie) {
            var a = e.style.filter;
            return a ? a.indexOf("opacity=") >= 0 ? parseFloat(a.match(/opacity=([^)]*)/)[1]) / 100 + "" : "1" : ""
        }
        if (!n && e.style && (e.style[t] || "height" === t)) return e.style[t];
        var c = void 0,
            u = document.defaultView || window;
        if (u.getComputedStyle) {
            t = t.replace(/([A-Z])/g, "-$1").toLowerCase();
            var l = u.getComputedStyle(e, null);
            l && (c = l.getPropertyValue(t))
        } else if (e.currentStyle) {
            if ("opacity" === t && i.browser.msie) {
                var d = e.currentStyle.filter;
                return d && d.indexOf("opacity=") >= 0 ? parseFloat(d.match(/opacity=([^)]*)/)[1]) / 100 + "" : "1"
            }
            var f = t.replace(/\-(\w)/g, function(e, t) {
                return t.toUpperCase()
            });
            "auto" === (c = e.currentStyle[t] || e.currentStyle[f]) && (c = 0), c = (c + "").split(" "), Object(r.each)(c, function(t, n) {
                if (!/^\d+(px)?$/i.test(n) && /^\d/.test(n)) {
                    var r = e.style,
                        o = r.left,
                        i = e.runtimeStyle.left;
                    e.runtimeStyle.left = e.currentStyle.left, r.left = n || 0, c[t] = r.pixelLeft + "px", r.left = o, e.runtimeStyle.left = i
                }
            }), c = c.join(" ")
        }
        if (n && ("width" === t || "height" === t)) {
            var p = ae(e, !0)[{
                width: 0,
                height: 1
            }[t]];
            c = (Object(r.intval)(c) ? Math.max(Object(r.floatval)(c), p) : p) + "px"
        }
        return c
    }

    function be(e, t, n) {
        if (e = s(e))
            if (Object(r.isObject)(t)) Object(r.each)(t, function(t, n) {
                return be(e, t, n)
            });
            else if ("opacity" === t) i.browser.msie && ((n + "").length ? e.style.filter = 1 !== n ? "alpha(opacity=" + 100 * n + ")" : "" : e.style.cssText = e.style.cssText.replace(/filter\s*:[^;]*/gi, ""), e.style.zoom = 1), e.style.opacity !== n && (e.style.opacity = n);
        else try {
            var o = "number" == typeof n;
            o && /height|width/i.test(t) && (n = Math.abs(n)), n = o && !/z-?index|font-?weight|opacity|zoom|line-?height/i.test(t) ? n + "px" : n, e.style[t] !== n && (e.style[t] = n)
        } catch (e) {
            Object(a.debugLog)("setStyle error: ", [t, n], e)
        }
    }
    window.cssTransformProp = function() {
        var e = document.createElement("div");
        if (null == e.style.transform) {
            var t = ["Webkit", "Moz", "ms"];
            for (var n in t)
                if (void 0 !== e.style[t[n] + "Transform"]) return t[n] + "Transform"
        }
        return "transform"
    }();
    var ve = function(e, t, n) {
        return setTimeout(be.pbind(e, t, n), 0)
    };

    function ye(e, t, n) {
        var o = Oe(e, "pseudo-id");
        o || (Oe(e, "pseudo-id", o = Object(r.irand)(1e8, 999999999)), le(e, "_pseudo_" + o));
        var i = t + "-style-" + o,
            a = s(i),
            c = "._pseudo_" + o + ":" + t + "{";
        a || (a = headNode.appendChild(b("style", {
            id: i,
            type: "text/css"
        }))), Object(r.each)(n, function(e, t) {
            c += e + ": " + t + " !important;"
        }), c += "}", a.sheet ? (a.sheet.cssRules.length && a.sheet.deleteRule(0), a.sheet.insertRule(c, 0)) : a.styleSheet && (a.styleSheet.cssText = c)
    }

    function Oe(e, t, n) {
        if (!e) return !1;
        var r = e[vkExpand];
        return r || (r = e[vkExpand] = ++vkUUID), void 0 !== n && (vkCache[r] || (vkCache[r] = {}, window.__debugMode && (vkCache[r].__elem = e)), vkCache[r][t] = n), t ? vkCache[r] && vkCache[r][t] : r
    }

    function we(e, t, n) {
        return e = s(e), void 0 === n ? e.getAttribute(t) : (e.setAttribute(t, n), n)
    }

    function Ee(e) {
        for (var t = 0, n = arguments.length; t < n; ++t) {
            var r = arguments[t];
            if (void 0 !== e[r]) try {
                delete e[r]
            } catch (t) {
                try {
                    e.removeAttribute(r)
                } catch (e) {}
            }
        }
    }

    function Ce(e, t) {
        var n = !!e && e[vkExpand];
        if (n)
            if (t) {
                if (vkCache[n]) {
                    delete vkCache[n][t], t = "";
                    var r = 0;
                    for (var i in vkCache[n])
                        if ("__elem" !== i) {
                            r++;
                            break
                        }
                    r || Ce(e)
                }
            } else Object(o.removeEvent)(e), Ee(e, vkExpand), delete vkCache[n]
    }

    function je() {
        for (var e = arguments, t = 0; t < e.length; ++t) {
            var n = s(e[t]);
            n && (Ce(n), Ee(n, "btnevents"))
        }
    }

    function ke(e, t, n) {
        if ((e = s(e)) && !e.titleSet) {
            if (t || (t = e), t.scrollWidth > t.clientWidth || t.scrollHeight > t.clientHeight) e.setAttribute("title", n || e.innerText || e.textContent);
            else {
                var r = u("b", e);
                r && (r.scrollWidth > r.clientWidth || r.scrollHeight > r.clientHeight) ? e.setAttribute("title", n || e.innerText || e.textContent) : e.removeAttribute("title")
            }
            e.titleSet = 1
        }
    }

    function Te() {
        var e = s("zoom_test_1") || document.body.appendChild(b("div", {
            id: "zoom_test_1"
        }, {
            left: "10%",
            position: "absolute",
            visibility: "hidden"
        }));
        return (s("zoom_test_2") || document.body.appendChild(b("div", {
            id: "zoom_test_2"
        }, {
            left: e.offsetLeft + "px",
            position: "absolute",
            visibility: "hidden"
        }))).offsetLeft / e.offsetLeft
    }

    function Se(e, t, n) {
        if (e = s(e)) return void 0 !== t && (e.setValue ? (e.setValue(t), !n && e.phonblur && e.phonblur()) : "INPUT" === e.tagName || "TEXTAREA" === e.tagName ? e.value = t : void 0 !== e.emojiId && window.Emoji ? Emoji.val(e, t) : e.innerHTML = t, !n && Object(o.triggerEvent)(e, "valueChanged")), e.getValue ? e.getValue() : ("INPUT" === e.tagName || "TEXTAREA" === e.tagName ? e.value : e.innerHTML) || ""
    }

    function Me(e, t, n) {
        e = s(e);
        try {
            if (e.focus(), void 0 !== t && !1 !== t || (t = e.value.length), void 0 !== n && !1 !== n || (n = t), e.setSelectionRange) e.setSelectionRange(t, n);
            else if (window.getSelection && document.createRange) {
                var r = document.createRange();
                r.selectNodeContents(e), r.collapse(!1);
                var o = window.getSelection();
                o.removeAllRanges(), o.addRange(r)
            }
        } catch (e) {}
    }

    function Pe(e, t, n) {
        for (e = s(e), n = n || 999; e && !t(e);) {
            if (0 === --n) return !1;
            try {
                if ((e = L(e)) === document) return !1
            } catch (t) {
                e = !1
            }
        }
        return e
    }
    var xe = !1;

    function Ie(e) {
        if (!xe) return window.document.title = Object(r.replaceEntities)(e)
    }

    function De(e) {
        xe = e, e && window.cur && window.cur.destroy.push(function() {
            De(!1)
        })
    }

    function Ae() {
        window.vkExpand = window.vkExpand || "VK" + Object(r.vkNow)(), window.vkUUID = window.vkUUID || 0, window.vkCache = window.vkCache || {}
    }
}, , , function(e, t, n) {
    "use strict";
    var r = n(4),
        o = n(254),
        i = n(196),
        a = n(426),
        s = n(305),
        c = n(67),
        u = n(401),
        l = n(328),
        d = n(338),
        f = n(151)("iterator"),
        p = !([].keys && "next" in [].keys()),
        _ = function() {
            return this
        };
    e.exports = function(e, t, n, m, g, h, b) {
        u(n, t, m);
        var v, y, O, w = function(e) {
                if (!p && e in k) return k[e];
                switch (e) {
                    case "keys":
                    case "values":
                        return function() {
                            return new n(this, e)
                        }
                }
                return function() {
                    return new n(this, e)
                }
            },
            E = t + " Iterator",
            C = "values" == g,
            j = !1,
            k = e.prototype,
            T = k[f] || k["@@iterator"] || g && k[g],
            S = T || w(g),
            M = g ? C ? w("entries") : S : void 0,
            P = "Array" == t && k.entries || T;
        if (P && (O = d(P.call(new e))) !== Object.prototype && (l(O, E, !0), r || s(O, f) || a(O, f, _)), C && T && "values" !== T.name && (j = !0, S = function() {
                return T.call(this)
            }), r && !b || !p && !j && k[f] || a(k, f, S), c[t] = S, c[E] = _, g)
            if (v = {
                    values: C ? S : w("values"),
                    keys: h ? S : w("keys"),
                    entries: M
                }, b)
                for (y in v) y in k || i(k, y, v[y]);
            else o(o.P + o.F * (p || j), t, v);
        return v
    }
}, , , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return m
    });
    var r = n(252),
        o = n(1),
        i = n(256),
        a = n(152),
        s = n(433),
        c = n(112),
        u = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        l = "_im_spam_not_spam",
        d = "_im_spam_spam";

    function f(e, t) {
        var n = t.get().selectedMessages,
            r = geByClass1("_im_spam_box", e.bodyNode),
            i = geByClass1("ui_tab_sel", e.bodyNode);
        if (n.length > 0) {
            var a = getLang("mail_selected", n.length);
            a = a.replace("{count}", n.length), val(i, a + '<button aria-label="' + getLang("mail_deselect_all") + '" type="button" class="im-deselect ' + o.DESELECT_ALL_CLASS + '"></button>')
        } else val(i, getLang("mail_spam"));
        0 === n.length ? removeClass(r, "im-important-box_with-sel") : (addClass(r, "im-important-box_with-sel"), val(geByClass1(l), getLang("mail_im_mark_notspam", n.length)), val(geByClass1(d), getLang("mail_im_mark_delspam", n.length)))
    }

    function p(e, t, n) {
        var o = e.get().selectedMessages;
        e.set(r.cleanSelected).then(n.cleanSelection.bind(null, o)).then(function(n) {
            return f(t, e)
        })
    }

    function _(e, t) {
        return {
            unmount: function() {
                t.unmount(), Object(i.destroyModule)(e)
            }
        }
    }

    function m(e, t, n) {
        var m = ge("box_layer_wrap"),
            g = Object(i.createMutations)(_),
            h = g.callMutations,
            b = g.bindMutations,
            v = Object(s.default)({
                peer: 0,
                oCache: {},
                tabs: Object(o.tabFromIds)(n.msgs, n.hash),
                gid: t.get().gid
            }),
            y = function(e, t, n, i) {
                if (!e.loading && !e.all && n.scrollTop + window.innerHeight - n.scrollHeight > -300) {
                    var a = geByClass1("_im_peer_history", t.bodyNode);
                    e.loading = !0, Object(o.wrapLoading)(a)(Object(r.loadSpam)(e.offset, i.get().gid).then(function(t) {
                        var n = u(t, 4),
                            s = (n[0], n[1]),
                            c = (n[2], n[3]);
                        e.all = c.all, e.offset = c.offset, e.all ? addClass(a, "im-important_all") : e.loading = !1, i.set(r.mergeTabs.bind(null, Object(o.tabFromIds)(c.msgs, c.hash)));
                        var l = ce("div");
                        l.innerHTML = s, a.appendChild(l), Object(o.ensureDomHasActions)(a)
                    }), "bottom")
                }
            }.bind(null, {
                all: n.all,
                loading: !1,
                offset: n.offset
            }, e, m, v),
            O = function(e, t, n, i) {
                var a = gpeByClass("_im_mess", i, t);
                if (a) {
                    var s = intval(domData(a, "msgid"));
                    a && (Object(r.removeMessageSend)([s], 0, e.get().tabs[0].hash, "undel", e.get()), Object(o.restoreMessage)(s, 0, t))
                }
            }.bind(null, v, e.bodyNode),
            w = function(e, t, n, r, o) {
                var i = gpeByClass("_im_mess", o, t.bodyNode),
                    a = intval(domData(i, "peer")),
                    s = intval(domData(i, "msgid"));
                return t.hide(), n().unmount(), e.get().longpoll.push([Object(c.changePeer)(a, s)]), stopEvent(r), cancelEvent(r), !1
            }.bind(null, t, e, h),
            E = function(e, t, n, o) {
                var i = showFastBox({
                    title: getLang("mail_deleteall1"),
                    dark: 1,
                    bodyStyle: "padding: 20px; line-height: 160%;"
                }, getLang("mail_delete_all_spam"), getLang("mail_delete"), function() {
                    Object(r.flushSpam)(e, o).then(function(e) {
                        var t = u(e, 2),
                            n = (t[0], t[1]);
                        showDoneBox(n)
                    }), i.hide(), t.hide(), n().unmount()
                }, getLang("mail_close"), function() {
                    return i.hide()
                })
            }.bind(null, n.hash, e, h, t.get().gid),
            C = Object(a.mount)(e.bodyNode, v, function(t) {
                return {
                    changedMessageSelection: f.bind(null, e)
                }
            }),
            j = function(e, t, n) {
                var i = e.get().selectedMessages;
                Object(r.removeMessageSend)(i, 0, e.get().tabs[0].hash, "delete", e.get()), Object(o.removeMessagesWithRestore)(i, 0, "delete", t), p(e, t, n)
            }.bind(null, v, e.bodyNode, C),
            k = function(e, t, n) {
                var i = e.get().selectedMessages;
                Object(r.removeMessageSend)(i, 0, e.get().tabs[0].hash, "nospam", e.get()), i.map(function(e) {
                    return geByClass1("_im_mess_" + e)
                }).filter(function(e) {
                    return e
                }).forEach(function(e) {
                    var t = intval(domData(e, "peer")),
                        n = intval(domData(e, "msgid"));
                    val(e, Object(o.renderGoTo)(t, n)), addClass(e, "im-mess_light")
                }), p(e, t, n)
            }.bind(null, v, e.bodyNode, C),
            T = p.bind(null, v, e, C);
        return Object(o.ensureDomHasActions)(e.bodyNode), b(Object(i.createModule)({
            handlers: function(t, n) {
                t(m, "scroll", y), t(geByClass1(d, e.bodyNode), "click", j), t(geByClass1(l, e.bodyNode), "click", k), t(geByClass1("_im_spam_flush", e.bodyNode), "click", E), n(e.bodyNode, "click", "_im_mess_restore", O), n(e.bodyNode, "click", "_im_go_to", w), n(e.bodyNode, "click", o.DESELECT_ALL_CLASS, T)
            }
        }), C)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return i
    });
    var r = n(256);

    function o(e) {
        return {
            unmount: function() {
                Object(r.destroyModule)(e)
            }
        }
    }

    function i(e, t, n) {
        return (0, Object(r.createMutations)(o).bindMutations)(Object(r.createModule)({
            handlers: function(e, t) {}
        }))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "scrollToY", function() {
        return a
    }), n.d(t, "scrollToTop", function() {
        return s
    }), n.d(t, "scrollGetX", function() {
        return c
    }), n.d(t, "scrollGetY", function() {
        return u
    }), n.d(t, "disableBodyScroll", function() {
        return l
    }), n.d(t, "enableBodyScroll", function() {
        return d
    }), n.d(t, "isBodyScrollEnabled", function() {
        return f
    });
    var r = n(366),
        o = n(163),
        i = n(347);

    function a(e, t, n, s) {
        if (void 0 == t && (t = 400), "ontouchstart" in document.documentElement && (t = 0), s || (e = Math.max(0, e - (vk.staticheader ? 0 : Object(i.getSize)("page_header_cont")[1]))), Object(i.data)(bodyNode, "tween") && Object(i.data)(bodyNode, "tween").stop(!1), Object(i.data)(htmlNode, "tween") && Object(i.data)(htmlNode, "tween").stop(!1), window.scrollAnimation = !1, t) {
            var l = function() {
                window.scrollAnimation = !1, 2 === n && ("profile" != cur.module && "public" != cur.module && "group" != cur.module && "groups" != cur.module && "event" != cur.module || !window.Wall || Wall.scrollCheck(!1, void 0, !0), Object(r.updSideTopLink)())
            };
            window.scrollAnimation = !0, Object(o.animate)(htmlNode, {
                scrollTop: e
            }, {
                duration: t,
                transition: o.Fx.Transitions.sineInOut,
                onComplete: l
            }), Object(o.animate)(bodyNode, {
                scrollTop: e
            }, {
                duration: t,
                transition: o.Fx.Transitions.sineInOut,
                onComplete: l
            })
        } else {
            if (n && 2 !== n) {
                "profile" != cur.module && "public" != cur.module && "group" != cur.module && "event" != cur.module || !window.Wall || Wall.scrollCheck(!1, e, !0);
                var d = u() - e;
                return Math.abs(d) > 6 && a(e + (d > 0 ? 6 : -6), 0, 2, !0), Object(r.updSideTopLink)(), clearTimeout(window.scrlToTO), void(window.scrlToTO = setTimeout(a.pbind(e, 100, 2, !0), 0))
            }
            window.scroll(c(), e), n || Object(r.updSideTopLink)()
        }
    }

    function s(e) {
        return a(0, e)
    }

    function c() {
        return window.pageXOffset || scrollNode.scrollLeft || document.documentElement.scrollLeft
    }

    function u() {
        return window.pageYOffset || scrollNode.scrollTop || document.documentElement.scrollTop
    }

    function l() {
        bodyNode.style.overflow = "hidden"
    }

    function d() {
        bodyNode.style.overflow = "auto"
    }

    function f() {
        return "hidden" !== bodyNode.style.overflow
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(409),
        i = n(63),
        a = n(406),
        s = n(252),
        c = n(53),
        u = n(158),
        l = n(362),
        d = n(210),
        f = n(392);

    function p(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    var _ = o.default.getLang,
        m = window,
        g = m.showFastBox,
        h = m.unclean,
        b = function() {},
        v = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onChange = function(e) {
                    var t = r.props.store.get(),
                        n = e.target.value;
                    Object(s.searchLocalHints)(n, t).then(function(e) {
                        return r.setSearchResults({}, !1, n, e), n ? (r.isSearching = !0, r.serverSearch(n, e.map(function(e) {
                            return e.peerId
                        }))) : Promise.resolve([])
                    }).then(r.appendSearchResults).catch(function() {})
                }, r.serverSearch = Object(f.debouncedPromise)(function(e, t) {
                    var n = r.props.store;
                    return Object(s.searchHints)(e, t, "friends", n.get())
                }, 300), r.onRemoveToken = function(e) {
                    return new Promise(function(t) {
                        var n = r.state.selected.filter(function(t) {
                            return t !== e
                        });
                        r.selected = n.reduce(function(e, t) {
                            return e[t] = !0, e
                        }, {}), r.setState({
                            selected: n
                        }, t)
                    })
                }, r.onSelect = function(e) {
                    return new Promise(function(t) {
                        var n = r.selected[e] ? r.state.selected.filter(function(t) {
                            return t !== e
                        }) : [].concat(r.state.selected, e).filter(function(e, t, n) {
                            return n.indexOf(e) === t
                        });
                        r.selected = n.reduce(function(e, t) {
                            return e[t] = !0, e
                        }, {}), r.resetSearch({
                            selected: n,
                            value: ""
                        }, t)
                    })
                }, r.onAddPeople = function() {
                    var e = r.props.store,
                        t = e.get().peer,
                        n = r.state.selected.map(function(e) {
                            return parseInt(e)
                        });
                    r.setState({
                        loading: !0
                    }), e.set(s.addNewMember.bind(null, t, n)).then(function() {
                        return e.set(s.getChatDetails.bind(null, t)).then(function() {
                            r.selected = {}, r.resetSearch({
                                selected: [],
                                loading: !1
                            }, function() {
                                r.props.afterSave(n.length)
                            })
                        })
                    }).catch(function(e) {
                        r.selected = {}, r.resetSearch({
                            selected: [],
                            loading: !1
                        }), g(_("global_error"), e)
                    })
                }, r.setSearchResults = function(e, t, n, o) {
                    var i = r.props.store.get(),
                        s = Object(a.getTab)(i, i.peer),
                        c = [];
                    o.forEach(function(e) {
                        r.data[e.peerId] || (r.data[e.peerId] = e), -1 === s.memberIds.indexOf(e.peerId) && c.push(e.peerId)
                    }), r.setState(Object.assign({}, e, {
                        found: c,
                        value: n
                    }), t || b)
                }, r.appendSearchResults = function(e) {
                    var t = r.props.store.get(),
                        n = Object(a.getTab)(t, t.peer),
                        o = r.state.found;
                    e.forEach(function(e) {
                        r.data[e.peerId] || (r.data[e.peerId] = e), -1 === n.memberIds.indexOf(e.peerId) && -1 === o.indexOf(e.peerId) && o.push(e.peerId)
                    }), r.isSearching = !1, r.setState({
                        found: o
                    })
                }, r.state = {
                    selected: [],
                    value: "",
                    loading: !1,
                    found: []
                }, r.data = {}, r.selected = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.resetSearch = function(e, t) {
                return Object(s.searchLocalHints)("", this.props.store.get()).then(this.setSearchResults.bind(this, e, t, ""))
            }, t.prototype.componentDidMount = function() {
                this.resetSearch()
            }, t.prototype.render = function() {
                var e, t = this,
                    n = Object.keys(this.state.selected).length;
                return r.createElement("div", {
                    className: "ChatSettingsMembers"
                }, r.createElement(u.default, (p(e = {
                    className: "ChatSettingsMembers__multiSelect",
                    tokens: this.state.selected.map(function(e) {
                        return {
                            text: h(t.data[e].name),
                            id: e
                        }
                    }),
                    removeTokenPlaceholder: _("mail_create_chat_remove_user"),
                    onRemoveToken: this.onRemoveToken,
                    placeholder: _("mail_search_creation"),
                    value: this.state.value,
                    useInfiniteScroll: !1,
                    onChange: this.onChange,
                    onSelect: this.onSelect
                }, "useInfiniteScroll", !0), p(e, "hasMore", !1), p(e, "virtualized", !0), p(e, "loadMore", function() {}), p(e, "notFoundText", _("mail_not_found")), p(e, "autoFocus", !0), p(e, "isSearching", this.isSearching), e), this.state.found.map(function(e) {
                    return r.createElement("div", {
                        className: Object(i.classNames)("ChatSettingsMembers__entity", p({}, "ChatSettingsMembers__entity--selected", t.selected[e])),
                        key: e,
                        "data-id": e
                    }, r.createElement(c.default, {
                        size: "34",
                        title: t.data[e].name,
                        photo: t.data[e].photo
                    }))
                })), r.createElement(d.default, {
                    alignment: "right"
                }, r.createElement(l.default, {
                    disabled: 0 === n,
                    onClick: this.onAddPeople,
                    loading: this.state.loading
                }, _(n < 2 ? "mail_append_chat" : "mail_im_create_chat_with"))))
            }, t
        }(r.Component);
    t.default = v
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63)),
        i = n(86),
        a = n(135),
        s = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var c = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.needRecalcSize = !1, r.state = {}, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.className,
                n = e.loading,
                c = e.children,
                u = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["className", "loading", "children"]),
                l = Object(o.classNames)("ButtonWithProgress", {
                    "ButtonWithProgress--loading": n
                }, t);
            return r.createElement(a.default, s({}, u, {
                className: l
            }), r.createElement("span", {
                className: "ButtonWithProgress__content"
            }, c), n && r.createElement(i.default, {
                inverted: "primary" === e.appearance,
                className: "ButtonWithProgress__progress"
            }))
        }, t
    }(r.Component);
    t.default = c, c.defaultProps = {
        appearance: "primary",
        size: "m",
        wide: !1,
        loading: !1
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(252),
        o = n(256),
        i = "_ui_multiselect_cancel";

    function a(e) {
        return e.selection = [], Promise.resolve(e)
    }

    function s(e, t) {
        return t.selection = t.selection.filter(function(t) {
            return t.id !== e
        }), Promise.resolve(t)
    }

    function c(e, t, n, r) {
        e.set(a).then(u.bind(null, t, n, e, r))
    }

    function u(e, t, n, r) {
        var o = n.get().selection,
            a = uiSearch.getFieldEl(e);
        uiSearch.focus(e), o.length > 0 ? attr(a, "placeholder", "") : attr(a, "placeholder", unclean(getLang("mail_search_creation"))), t.innerHTML = o.map(function(e) {
            return '<div class="token">\n      <div class="token_title">' + e.name + '</div>\n      <div data-peer="' + e.id + '" class="token_del ' + i + '"></div>\n    </div>'
        }).join(""), toggleClass(e, "ui_multiselect_has_selection", o.length > 0), domFC(e).scrollTop += 50, r()
    }

    function l(e, t) {
        return showTooltip(t, {
            text: getLang("mail_create_chat_remove_user"),
            black: 1,
            shift: [15, 8],
            appendParentCls: "_wrap"
        })
    }

    function d(e, t, n) {
        uiSearch.init(e, {
            onChange: function(e, t, n, o) {
                e.set(r.setCurrentSearch.bind(null, n, !1)).then(t().onChange)
            }.bind(null, t, n)
        });
        var d = uiSearch.getFieldEl(e),
            f = ce("div", {
                className: "_ui_multiselection ui_multiselect_cnt"
            });
        d && d.parentNode.insertBefore(f, d);
        var p, _, m = (p = d, _ = 0, function() {
            var e = p.offsetWidth;
            setStyle(p, {
                width: 1
            });
            var t = p.offsetLeft;
            _ !== t ? (_ = t, e = p.parentNode.offsetWidth, setStyle(p, {
                width: Math.max(30, e - t - 20)
            })) : setStyle(p, {
                width: e
            })
        });
        t.set(a);
        var g = function(e, t, n, r, o, i, a) {
                var c = intval(domData(a, "peer"));
                tooltips.hide(a), t.set(s.bind(null, c)).then(function(i) {
                    u(e, r, t, o), n().selectionDeleted(t, c)
                })
            }.bind(null, e, t, n, f, m),
            h = function(t) {
                document.activeElement !== d && uiSearch.focus(e)
            },
            b = Object(o.createModule)({
                handlers: function(t, n) {
                    n(e, "click", i, g), n(e, "mouseover", i, l), t(e, "click", h)
                }
            });
        return {
            addSelection: function(n, r) {
                return t.set(function(e, t) {
                    return t.selection || (t.selection = []), t.selection.push(e), Promise.resolve(t)
                }.bind(null, {
                    id: n,
                    name: r
                })).then(u.bind(null, e, f, t, m))
            },
            removeSelection: function(n) {
                return t.set(s.bind(null, n)).then(u.bind(null, e, f, t, m))
            },
            resetSelection: function() {
                c(t, e, f, m)
            },
            focus: function() {
                uiSearch.focus(e)
            },
            save: function() {
                t.stash(), u(e, f, t, m)
            },
            restore: function() {
                t.pop(), u(e, f, t, m)
            },
            unmount: function() {
                uiSearch.destroy(e), Object(o.destroyModule)(b)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "post", function() {
        return i
    }), n.d(t, "plainget", function() {
        return a
    }), n.d(t, "plaingetCancelable", function() {
        return s
    });
    var r = window.ajax,
        o = 2;

    function i(e, t, n) {
        return t && (t.im_v = o), new Promise(function(o, i) {
            r.post(e, t, {
                timeout: n,
                onDone: function() {
                    o.apply(null, [
                        [].concat(Array.prototype.slice.call(arguments))
                    ])
                },
                onFail: function() {
                    return i.apply(null, arguments), !0
                }
            })
        })
    }

    function a(e, t) {
        return s(e, t, arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}).request
    }

    function s(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
            o = void 0;
        return o = window.XDomainRequest ? new XDomainRequest : r._getreq(), {
            request: new Promise(function(r, i) {
                var a = void 0,
                    s = Date.now(),
                    c = n.timeout || 60,
                    u = ajx2q(t);
                if (window.XDomainRequest) o.open("get", e + "?" + u), o.ontimeout = function(e) {
                    i([e, {}])
                }, o.onerror = function(e) {
                    i([e, {}])
                }, o.onload = function() {
                    r([o.responseText, {}])
                }, setTimeout(function() {
                    o.send()
                }, 0);
                else {
                    o.onreadystatechange = function() {
                        4 == o.readyState && (clearInterval(a), o.status >= 200 && o.status < 300 ? r([o.responseText, o]) : i([o.responseText, o]))
                    };
                    try {
                        o.open("GET", e + "?" + u, !0)
                    } catch (e) {
                        return i([e, o])
                    }
                    o.send()
                }
                a = setInterval(function() {
                    Date.now() - s > 1e3 * c && (i(["", {}]), clearInterval(a))
                }, 1e3)
            }),
            cancel: function() {
                o.abort()
            }
        }
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "notaBene", function() {
        return l
    }), n.d(t, "updSideTopLink", function() {
        return d
    }), n.d(t, "createButton", function() {
        return f
    }), n.d(t, "actionsMenuItemLocked", function() {
        return p
    }), n.d(t, "lockActionsMenuItem", function() {
        return _
    }), n.d(t, "unlockActionsMenuItem", function() {
        return m
    }), n.d(t, "linkLocked", function() {
        return g
    }), n.d(t, "lockLink", function() {
        return h
    }), n.d(t, "unlockLink", function() {
        return b
    }), n.d(t, "lockButton", function() {
        return v
    }), n.d(t, "unlockButton", function() {
        return y
    }), n.d(t, "buttonLocked", function() {
        return O
    }), n.d(t, "isButtonLocked", function() {
        return w
    }), n.d(t, "disableButton", function() {
        return E
    }), n.d(t, "sbWidth", function() {
        return C
    }), n.d(t, "isChecked", function() {
        return j
    }), n.d(t, "checkbox", function() {
        return k
    }), n.d(t, "disable", function() {
        return T
    }), n.d(t, "radioval", function() {
        return S
    }), n.d(t, "radiobtn", function() {
        return M
    }), n.d(t, "showProgress", function() {
        return P
    }), n.d(t, "hideProgress", function() {
        return x
    }), n.d(t, "disableEl", function() {
        return I
    }), n.d(t, "enableEl", function() {
        return D
    }), n.d(t, "initUiHelpers", function() {
        return A
    });
    var r = n(347),
        o = n(45),
        i = n(269),
        a = n(358),
        s = n(163),
        c = n(324),
        u = n(220);

    function l(e, t, n) {
        if (e = Object(r.ge)(e)) {
            n || Object(r.elfocus)(e), void 0 === Object(r.data)(e, "backstyle") && Object(r.data)(e, "backstyle", e.style.backgroundColor || "");
            var o = Object(r.data)(e, "back") || Object(r.data)(e, "back", Object(r.getStyle)(e, "backgroundColor")),
                i = {
                    notice: "#FFFFE0",
                    warning: "#FAEAEA"
                };
            Object(r.setStyle)(e, "backgroundColor", i[t] || t || i.warning), setTimeout(s.animate.pbind(e, {
                backgroundColor: o
            }, 300, function() {
                e.style.backgroundColor = Object(r.data)(e, "backstyle")
            }), 400)
        }
    }

    function d(e) {
        if (window.scrollNode && !c.browser.mobile && window._tbLink) {
            var t = Object(r.ge)("page_body"),
                n = Object(r.getXY)(t),
                o = Object(a.scrollGetY)(),
                i = bodyNode.scrollLeft,
                l = Object(r.ge)("side_bar"),
                d = Object(r.isVisible)(l);
            if (window._stlSideTop = Math.max((d ? Object(r.getSize)(l)[1] : 0) - o - (c.browser.mozilla ? Object(r.getXY)(pageNode)[1] : 0), n[1]), e || i != __scrLeft) {
                var f = Object(r.ge)("page_layout"),
                    p = vk.rtl ? f.offsetLeft + f.offsetWidth : 0,
                    _ = vk.rtl ? (window.lastWindowWidth || 0) - p : f.offsetLeft;
                Object(r.setStyle)(_stlLeft, {
                    width: Math.max(_ - 1, 0)
                });
                var m = vk.rtl ? n[0] + t.offsetWidth + 5 : _,
                    g = vk.rtl ? p - m : n[0] - 5 - m;
                Object(r.setStyle)(_stlSide, {
                    left: m - i,
                    width: Math.max(g, 0)
                }), __scrLeft = i
            }
            Object(r.setStyle)(_stlSide, {
                top: _stlSideTop,
                height: Math.max((window.lastWindowHeight || 0) - _stlSideTop, 0)
            }), __adsUpdate();
            var h = _tbLink.loc || _stlWas || o > 200,
                b = o > 250 && cur._regBar,
                v = 0,
                y = !1;
            if (h) {
                1 !== _stlShown && (Object(r.show)(_stlLeft, _stlSide), Object(r.addClass)(_stlLeft, "stl_active"), Object(r.addClass)(_stlSide, "stl_active"), _stlShown = 1), _tbLink.loc && cur._noUpLink && (o = 0), _stlWas && o > 500 && (_stlWas = 0), o > 200 ? (v = (o - 200) / 200, (_stlWasSet || _stlBack) && (_stlWasSet = _stlBack = 0, y = 1, Object(r.val)(_stlText, Object(u.getLang)("global_to_top")), Object(r.removeClass)(_stlText, "down"), Object(r.removeClass)(_stlText, "back"))) : (v = (200 - o) / 200, _stlWas ? _stlWasSet || (_stlWasSet = 1, y = 0, Object(r.val)(_stlText, ""), Object(r.addClass)(_stlText, "down"), _stlBack && (_stlBack = 0, Object(r.removeClass)(_stlText, "back"))) : _tbLink.loc && (_stlBack || (_stlBack = 1, y = _tbLink.fast ? 1 : 0, Object(r.val)(_stlText, Object(u.getLang)("global_back")), Object(r.addClass)(_stlText, "back"), _stlWasSet && (_stlWasSet = 0, Object(r.removeClass)(_stlText, "down"))))), !1 !== y && Object(r.toggleClass)(_stlLeft, "over_fast", Object(r.hasClass)(_stlLeft, "over") && y);
                var O = {
                    opacity: Math.min(Math.max(v, 0), 1)
                };
                vk.staticheader && (O.top = -Math.min(Object(r.getSize)("page_header_cont")[1], o)), Object(r.setStyle)(_stlLeft, O)
            } else 0 !== _stlShown && (Object(r.hide)(_stlLeft, _stlSide), _stlShown = 0);
            vk.id || (!_regBar && b ? (_regBar = 1, Object(r.val)(Object(r.ge)("reg_bar_content"), cur._regBar), Object(s.animate)(Object(r.ge)("reg_bar"), {
                top: 0,
                transition: s.Fx.Transitions.sineInOut
            }, 400), Object(s.animate)(Object(r.ge)("stl_bg"), {
                paddingTop: 60,
                transition: s.Fx.Transitions.sineInOut
            }, 400)) : _regBar && !b && (_regBar = 0, Object(s.animate)(Object(r.ge)("reg_bar"), {
                top: -56,
                transition: s.Fx.Transitions.sineInOut
            }, 400), Object(s.animate)(Object(r.ge)("stl_bg"), {
                paddingTop: 13,
                transition: s.Fx.Transitions.sineInOut
            }, 400)))
        }
    }

    function f(e, t) {
        if ((e = Object(r.ge)(e)) && !e.btnevents)
            if (Object(r.hasClass)(e, "flat_button")) Object(i.isFunction)(t) && (e.onclick = t.pbind(e));
            else {
                var n = e.parentNode;
                if (Object(r.hasClass)(n, "button_blue") || Object(r.hasClass)(n, "button_gray")) Object(i.isFunction)(t) && (e.onclick = t.pbind(e));
                else {
                    var a = !1;
                    Object(o.addEvent)(e, "click mousedown mouseover mouseout", function(i) {
                        if (!Object(r.hasClass)(n, "locked")) switch (i.type) {
                            case "click":
                                if (!a) return;
                                return e.className = "button_hover", t(e), Object(o.cancelEvent)(i);
                            case "mousedown":
                                e.className = "button_down";
                                break;
                            case "mouseover":
                                a = !0, e.className = "button_hover";
                                break;
                            case "mouseout":
                                e.className = "button", a = !1
                        }
                    }), e.btnevents = !0
                }
            }
    }

    function p(e) {
        var t = Object(r.ge)(e);
        if (t) return Object(r.hasClass)(t, "ui_actions_menu_item_lock")
    }

    function _(e) {
        if ((e = Object(r.ge)(e)) && Object(r.hasClass)(e, "ui_actions_menu_item") && !Object(r.hasClass)(e, "ui_actions_menu_item_lock")) {
            Object(r.data)(e, "inner", e.innerHTML), Object(r.addClass)(e, "ui_actions_menu_item_lock");
            var t = Object(r.ce)("div", {
                className: "ui_actions_menu_item_lock_text"
            });
            Object(r.val)(t, e.innerHTML), e.appendChild(t), P(e)
        }
    }

    function m(e) {
        (e = Object(r.ge)(e)) && Object(r.hasClass)(e, "ui_actions_menu_item") && Object(r.hasClass)(e, "ui_actions_menu_item_lock") && (Object(r.removeClass)(e, "ui_actions_menu_item_lock"), e.innerHTML = Object(r.data)(e, "inner"))
    }

    function g(e) {
        var t = Object(r.ge)(e);
        if (t) return Object(r.hasClass)(t, "link_lock")
    }

    function h(e, t) {
        var n = Object(r.ge)(e);
        n && "a" === n.tagName.toLowerCase() && !g(n) && (Object(r.addClass)(n, "link_lock"), t && Object(i.each)(t, function(e, t) {
            return Object(r.addClass)(n, t)
        }))
    }

    function b(e, t) {
        var n = Object(r.ge)(e);
        n && g(n) && (Object(r.removeClass)(n, "link_lock"), t && Object(i.each)(t, function(e, t) {
            return Object(r.removeClass)(n, t)
        }))
    }

    function v(e) {
        var t = Object(r.ge)(e);
        if (t && ("button" === t.tagName.toLowerCase() || Object(r.hasClass)(t, "flat_button") || Object(r.hasClass)(t, "wr_header")) && !w(t)) {
            var n = Object(r.getSize)(t);
            Object(r.addClass)(t, "flat_btn_lock"), Object(r.data)(t, "inner", t.innerHTML), Object(r.setStyle)(t, {
                width: n[0],
                height: n[1]
            }), t.innerHTML = "", P(t, "btn_lock")
        }
    }

    function y(e) {
        var t = Object(r.ge)(e);
        t && w(t) && (x(t), t.innerHTML = Object(r.data)(t, "inner"), Object(r.removeClass)(t, "flat_btn_lock"), Object(r.setStyle)(t, {
            width: null,
            height: null
        }))
    }

    function O(e) {
        return w(e)
    }

    function w(e) {
        var t = Object(r.ge)(e);
        if (t) return Object(r.hasClass)(t, "flat_btn_lock")
    }

    function E(e, t) {
        var n = Object(r.ge)(e);
        if (n && "button" === n.tagName.toLowerCase())
            if (t) {
                if (!Object(r.isVisible)(n)) return;
                n.parentNode.insertBefore(Object(r.ce)("button", {
                    innerHTML: n.innerHTML,
                    className: n.className + " button_disabled"
                }), n), Object(r.hide)(n)
            } else {
                var o = Object(r.domPS)(n);
                o && Object(r.hasClass)(o, "button_disabled") && Object(r.re)(o), Object(r.show)(n)
            }
    }

    function C(e) {
        if (void 0 === window._sbWidth || e) {
            var t = Object(r.ce)("div", {
                innerHTML: '<div style="height: 75px;">1<br>1</div>'
            }, {
                overflowY: "scroll",
                position: "absolute",
                width: "50px",
                height: "50px"
            });
            bodyNode.appendChild(t), window._sbWidth = Math.max(0, t.offsetWidth - t.firstChild.offsetWidth - 1), bodyNode.removeChild(t)
        }
        return window._sbWidth
    }

    function j(e) {
        return e = Object(r.ge)(e), Object(r.hasClass)(e, "on") ? 1 : ""
    }

    function k(e, t) {
        var n = Object(r.ge)(e);
        if (n && !Object(r.hasClass)(n, "disabled")) return void 0 === t && (t = !j(n)), Object(r.toggleClass)(n, "on", t), n.setAttribute("aria-checked", t ? "true" : "false"), !1
    }

    function T(e, t) {
        return e = Object(r.ge)(e), void 0 === t && (t = !Object(r.hasClass)(e, "disabled")), Object(r.toggleClass)(e, "disabled", t), "INPUT" === e.tagName && (t ? e.setAttribute("readonly", "readonly") : e.removeAttribute("readonly")), !1
    }

    function S(e) {
        return !!radioBtns[e] && radioBtns[e].val
    }

    function M(e, t, n) {
        if (radioBtns[n] && !Object(r.hasClass)(e, "disabled")) return Object(i.each)(radioBtns[n].els, function() {
            this == e ? (Object(r.addClass)(this, "on"), this.setAttribute("aria-checked", "true"), this.setAttribute("tabindex", "0")) : (Object(r.removeClass)(this, "on"), this.setAttribute && (this.setAttribute("aria-checked", "false"), this.setAttribute("tabindex", "-1")))
        }), radioBtns[n].val = t
    }

    function P(e, t, n, o) {
        if (e = Object(r.ge)(e)) {
            var i = void 0;
            return Object(r.hasClass)(e, "pr") ? i = e : (i = Object(r.se)(Object(r.rs)(vk.pr_tpl, {
                id: t || "",
                cls: n || ""
            })), o ? Object(r.domInsertBefore)(i, e) : e.appendChild(i)), setTimeout(function() {
                Object(r.setStyle)(i, {
                    opacity: 1
                })
            }), i
        }
    }

    function x(e) {
        e && (Object(r.hasClass)(e, "pr") ? Object(r.setStyle)(e, {
            opacity: 0
        }) : Object(r.re)(Object(r.geByClass1)("pr", e)))
    }

    function I(e) {
        Object(r.setStyle)(e, "pointer-events", "none")
    }

    function D(e) {
        Object(r.setStyle)(e, "pointer-events", "")
    }

    function A() {
        window.__scrLeft = 0, window.radioBtns = {}
    }
}, function(e, t, n) {
    var r = n(305),
        o = n(280),
        i = n(310)(!1),
        a = n(110)("IE_PROTO");
    e.exports = function(e, t) {
        var n, s = o(e),
            c = 0,
            u = [];
        for (n in s) n != a && r(s, n) && u.push(n);
        for (; t.length > c;) r(s, n = t[c++]) && (~i(u, n) || u.push(n));
        return u
    }
}, , , , , , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        o = [],
        i = 0,
        a = !1;

    function s(e) {
        o = o.reduce(function(t, n) {
            var o = r(n, 2),
                i = o[0],
                a = o[1];
            return a(e) ? t : t.concat([
                [i, a]
            ])
        }, [])
    }
    t.default = function(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
        return i++, {
            stop: function() {
                i--,
                function(e) {
                    o = o.filter(function(t) {
                        return r(t, 1)[0] !== e
                    }), 0 === i && (document.body.removeEventListener("click", s, !0), a = !1)
                }(e)
            },
            replaceOrAdd: function(n) {
                var i = o.filter(function(t) {
                        var n = r(t, 1)[0];
                        return e === n
                    }),
                    c = function(e, t) {
                        return 0 === t.length ? function(t) {
                            return e(t), !0
                        } : function(n) {
                            var r = t.reduce(function(e, t) {
                                return e && !domClosest(t, n.target)
                            }, !0);
                            return r && e(n), r
                        }
                    }(n, t);
                i.length > 0 ? function(e, t) {
                    o = o.map(function(n) {
                        var o = r(n, 2),
                            i = o[0],
                            a = o[1];
                        return i === e ? [e, t] : [i, a]
                    })
                }(e, c) : function(e, t) {
                    !1 === a && (a = !0, document.body.addEventListener("click", s, !0)), o = o.concat([
                        [e, t]
                    ])
                }(e, c)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    var r = Object.prototype.hasOwnProperty;

    function o(e, t) {
        return e === t ? 0 !== e || 0 !== t || 1 / e == 1 / t : e != e && t != t
    }
    e.exports = function(e, t) {
        if (o(e, t)) return !0;
        if ("object" != typeof e || null === e || "object" != typeof t || null === t) return !1;
        var n = Object.keys(e),
            i = Object.keys(t);
        if (n.length !== i.length) return !1;
        for (var a = 0; a < n.length; a++)
            if (!r.call(t, n[a]) || !o(e[n[a]], t[n[a]])) return !1;
        return !0
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "default", function() {
        return a
    });
    var r = n(451),
        o = n(63),
        i = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function a(e) {
        var t = e.children,
            n = e.className,
            a = function(e, t) {
                var n = {};
                for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                return n
            }(e, ["children", "className"]);
        return r.createElement("div", i({}, a, {
            className: Object(o.classNames)("Stub", n)
        }), t || "No results.")
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return m
    });
    var r = n(252),
        o = n(256),
        i = "im_hist_search",
        a = "_im_search_date",
        s = "_im_search_date_input",
        c = "_im_search_history_input",
        u = "_im_start_inplace_search",
        l = "_im_cancel_inplace_search",
        d = "_im_clear_date";

    function f(e, t, n, r, a, s) {
        return {
            focus: function(e) {
                uiSearch.focus(t),
                    function(e, t, n, r) {
                        cancelStackPush(i, _.bind(null, e, t, n, r))
                    }(e, t, n, r)
            },
            changePeer: function(e, n) {
                uiSearch.getFieldEl(t).value = n.get().tabs[e].searchText || ""
            },
            search: function() {
                s({})
            },
            unmount: function() {
                Object(o.destroyModule)(a), cancelStackFilter(i), r.then(function(e) {
                    return e.destroy()
                })
            }
        }
    }

    function p(e, t, n) {
        var o = e.get().peer;
        uiSearch.showProgress(n), Object(r.searchMessagesInplace)(o, e.get()).then(function(r) {
            uiSearch.hideProgress(n), t().insertSearch(r, e)
        }).catch(function() {
            uiSearch.focus(n), uiSearch.hideProgress(n)
        })
    }

    function _(e, t, n, o) {
        cancelStackFilter(i), o.then(function(e) {
            e.hide()
        }), e.set(r.cancelSearch.bind(null, e.get().peer)).then(function() {
            uiSearch.getFieldEl(t).value = "", n().cancelSearch(e)
        })
    }

    function m(e, t, n) {
        var i = geByClass1(s, e),
            m = geByClass1(c, e),
            g = function(e, t, n, r) {
                var o = '<td class="im_cal_clear" colspan="7"><button type="button" class="im_cal_clear_lnk _im_clear_date">' + getLang("wall_clear_date_filter") + "</button></td>";
                return new Promise(function(e) {
                    stManager.add(["ui_controls.js", "datepicker.js", "datepicker.css"], function() {
                        var t = new Datepicker(n, {
                            width: 140,
                            resfmt: "plain",
                            addRows: '<tr id="im_day_clear">' + o + "</tr>",
                            addRowsM: '<tr id="im_month_clear">' + o + "</tr>",
                            onUpdate: r
                        });
                        e(t)
                    })
                })
            }(0, 0, i, function(e, t, n, o) {
                e.set(r.setCurrentSearchDate.bind(null, e.get().peer, o.d + "." + o.m + "." + o.y)).then(p.bind(null, e, t, n))
            }.bind(null, t, n, m)),
            h = function(e, t) {
                e.then(function(e) {
                    triggerEvent(geByClass1("datepicker_control", t), "mousedown", !1, !0)
                })
            }.bind(null, g, e),
            b = function(e, t, n, o, i, a) {
                if ("keyup" !== a.type || 13 == a.which) {
                    var s = clean(uiSearch.getFieldEl(t).value);
                    e.set(r.setCurrentSearch.bind(null, s, e.get().peer)).then(i.bind(null, e, o, t))
                }
            }.bind(null, t, m, i, n, debounce(p, 300)),
            v = _.bind(null, t, m, n, g),
            y = function(e, t, n, o) {
                n.then(function(e) {
                    e.hide()
                }), e.set(r.clearDate.bind(null, e.get().peer)).then(p.bind(null, e, t, o))
            }.bind(null, t, n, g, m),
            O = Object(o.createModule)({
                handlers: function(t, n) {
                    t(geByClass1(a, e), "click", h), t(uiSearch.getFieldEl(m), "keyup", b), t(geByClass1(u, e), "click", b), t(geByClass1(l, e), "click", v), n(e, "click", d, y)
                }
            });
        return f(0, m, n, g, O, b)
    }
}, , , , , function(e, t, n) {
    "use strict";

    function r(e, t) {
        var n = !1,
            r = void 0,
            o = void 0;
        return function i() {
            if (n) return r = arguments, void(o = this);
            e.apply(this, arguments), n = !0, setTimeout(function() {
                n = !1, r && (i.apply(o, r), r = o = null)
            }, t)
        }
    }
    n.r(t), n.d(t, "default", function() {
        return r
    })
}, function(e, t, n) {
    var r = n(322),
        o = n(316).document,
        i = r(o) && r(o.createElement);
    e.exports = function(e) {
        return i ? o.createElement(e) : {}
    }
}, , , , , , , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63)),
        i = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t() {
            return function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t),
                function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.render = function() {
            var e = this.props,
                t = e.hovered,
                n = e.className,
                a = e.children,
                s = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["hovered", "className", "children"]),
                c = Object(o.classNames)("Link", {
                    "Link--hovered": !!t
                }, n);
            return this.props.href ? r.createElement("a", i({}, s, {
                className: c
            }), a) : r.createElement("span", i({}, s, {
                className: c
            }), a)
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        href: void 0,
        hovered: !1
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63)),
        i = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.onTransitionEnd = function(e) {
                r.state.shown && "opacity" === e.propertyName && (r.timeout = setTimeout(function() {
                    r.setState({
                        shown: !1
                    }), r.props.callback()
                }, r.props.duration))
            }, r.state = {
                shown: n.shown
            }, r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentWillReceiveProps = function(e) {
            !this.props.shown && e.shown && this.setState({
                shown: !0
            })
        }, t.prototype.componentWillUnmount = function() {
            this.timeout && clearTimeout(this.timeout)
        }, t.prototype.render = function() {
            var e = this.props,
                t = (e.shown, e.callback, e.duration, e.className),
                n = e.children,
                a = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["shown", "callback", "duration", "className", "children"]),
                s = Object(o.classNames)("BlinkText", {
                    "BlinkText--shown": this.state.shown
                }, t);
            return r.createElement("span", i({}, a, {
                className: s,
                onTransitionEnd: this.onTransitionEnd,
                "aria-hidden": !0
            }), n)
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        duration: 2e3
    }
}, function(e, t, n) {
    "use strict";

    function r(e, t) {
        return new Promise(function(n) {
            setTimeout(n.bind(null, t), 1e3 * e)
        })
    }

    function o(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null,
            o = 0;
        return function i() {
            for (var a = arguments.length, s = Array(a), c = 0; c < a; c++) s[c] = arguments[c];
            return Promise.resolve().then(function() {
                return e.apply(void 0, s)
            }).catch(function(e) {
                if (++o <= t) {
                    var a = "function" == typeof n ? n(o) : 0;
                    return 0 === a ? i.apply(void 0, s) : r(a).then(function() {
                        return i.apply(void 0, s)
                    })
                }
                throw e
            })
        }
    }

    function i(e, t, n) {
        var r = void 0,
            o = void 0;
        return function() {
            for (var i = arguments.length, a = Array(i), s = 0; s < i; s++) a[s] = arguments[s];
            return new Promise(function(e, i) {
                var s = n && !r;
                clearTimeout(r), o && o.reject("debounce"), r = setTimeout(function() {
                    r = null, o = null, n || e(a)
                }, t), s ? e(a) : n && i("debounce"), o = {
                    resolve: e,
                    reject: i
                }
            }).then(function(t) {
                return e.apply(void 0, function(e) {
                    if (Array.isArray(e)) {
                        for (var t = 0, n = Array(e.length); t < e.length; t++) n[t] = e[t];
                        return n
                    }
                    return Array.from(e)
                }(t))
            })
        }
    }

    function a(e, t) {
        var n = void 0,
            r = new Promise(function(r) {
                n = r, setTimeout(r.bind(null, t), 1e3 * e)
            });
        return {
            pause: function() {
                return r
            },
            abort: function() {
                n(t)
            }
        }
    }
    n.r(t), n.d(t, "pause", function() {
        return r
    }), n.d(t, "retryFn", function() {
        return o
    }), n.d(t, "debouncedPromise", function() {
        return i
    }), n.d(t, "abortablePause", function() {
        return a
    })
}, , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return U
    });
    var r = n(252),
        o = n(406),
        i = n(46),
        a = n(1),
        s = n(363),
        c = n(256),
        u = n(433),
        l = n(112),
        d = "_im_create_cancel",
        f = "_im_create_list",
        p = "_im_dialog",
        _ = "_im_create_tab",
        m = "_im_dialogs_creation_name",
        g = "_im_create_select",
        h = "_im_create_avatar",
        b = "_im_create_remove_avatar",
        v = "_im_confirm_creation",
        y = "_im_cancel_creation",
        O = "_im_avatar_img",
        w = ["im-creation--item_hovered"],
        E = "olist_item_wrap_on",
        C = "ui_search_reset",
        j = 100;

    function k(e, t, n, o, i, a) {
        Object(r.toggleConversation)(!1), removeClass(t, "im-create_shown"), removeClass(t, "im-create_photo-attached"), setTimeout(S.bind(null, t, !1), 100), I(a).map(function(e) {
            return geByClass1("_im_dialog" + e)
        }).forEach(function(e) {
            removeClass(e, E)
        }), n().createCanceled(e, o), i.resetSelection(), "add_member" === e.get().creationType && e.set(r.setCreationType.bind(null, "chat", [])), e.set(r.presetAvatar.bind(null, !1));
        var s = geByClass1(O, t);
        M(e, a, t), uiSearch.reset(geByClass1(m, t)), uiSearch.reset(geByClass1(g, t)), s && s.parentNode.removeChild(s), M(e, a, t), cancelStackFilter("im_search");
        var c = 0 === e.get().peer ? "search" : "default";
        e.get().longpoll.push([Object(l.transitionEvent)(c)]), attr(t, "aria-hidden", "true")
    }

    function T(e, t, n) {
        return t && (n.current_create_peer_ids = {}, n.current_create_peers = []), n.current_create_peer_ids || (n.current_create_peer_ids = {}), n.current_create_peers || (n.current_create_peers = []), e.forEach(function(e) {
            e.then(function(e) {
                e = e.filter(function(e) {
                    return !n.current_create_peer_ids[e.peerId]
                }), n.current_create_peer_ids = e.reduce(function(e, t) {
                    return e[t.peerId] = !0, e
                }, n.current_create_peer_ids), n.current_create_peers = n.current_create_peers.concat(e)
            })
        }), Promise.resolve(n)
    }

    function S(e, t) {
        toggleClass(e, "im-create_material", t)
    }

    function M(e, t, n) {
        var r = geByClass1(v, n),
            o = t.get().selection.length,
            i = "add_member" === e.get().creationType,
            a = o > 0,
            s = uiSearch.getFieldEl(geByClass1(m, n)).value.length > 0,
            c = !a && (i || !s),
            u = i ? 1 === o ? getLang("mail_append_chat") : getLang("mail_im_create_chat_with") : s || o > 1 ? getLang("mail_im_create_chat") : getLang("mail_im_go_to_dialog");
        val(r, u), toggleClass(r, "button_disabled", c)
    }

    function P(e, t, n, r, o, i, a) {
        if (a) {
            var s = intval(domData(a, "list-id")),
                c = I(i),
                u = trim(a.textContent),
                l = geByClass1(g, t),
                d = getSize(l)[1],
                f = void 0;
            inArray(s, c) ? (f = r.removeSelection(s, u), removeClass(a, E)) : (f = r.addSelection(s, u), addClass(a, E)), f.then(function() {
                var e = d - getSize(l)[1],
                    t = o.scrollTop();
                o.scrollTop(t - e)
            }), M(e, i, t);
            var p = geByClass1(g, t);
            uiSearch.reset(p)
        }
    }

    function x(e) {
        return Object(o.getSearchText)(e) || !1
    }

    function I(e) {
        return e.get().selection.map(function(e) {
            return e.id
        })
    }

    function D(e, t, n, r) {
        toggleClass(e, "im-create_chat", "chat" === r.get().creationType), toggleClass(e, "im-create_invite", "add_member" === r.get().creationType);
        var o = "chat" === r.get().creationType ? getLang("mail_im_group_dialog") : getLang("mail_im_friends_tab"),
            i = geByClass1("_im_create_title", e);
        val(i, o), val(geByClass1(v, e), "add_member" === r.get().creationType ? getLang("mail_im_create_chat_with") : getLang("mail_im_create_chat")), L(e, r, t, !1, n.get().selection.map(function(e) {
            return e.id
        })), Object(a.fixTableCellChildHeight)("_im_create_wrap_safe", e)
    }

    function A(e, t, n) {
        return e.then(function(e) {
            return e.filter(function(e) {
                return e.is_friend && !inArray(e.peerId, n.get().creationFilter)
            })
        })
    }

    function L(e, t, n, o, i) {
        var a = geByClass1(g, e),
            s = void 0,
            c = void 0,
            u = Object(r.searchLocalHints)(o, t.get()),
            l = n.hoverFirstElement.bind(n, w, N(t));
        t.get().creation_shown_all = !1, n.reset(), n.pipe(A(u, 0, t), o), n.toTop(), o ? (c = Object(r.searchTopConv)(o, t.get()), s = Object(r.searchHintsIndex)(o, [], "friends", t.get()), n.pipe(A(s, 0, t), o).then(l), n.pipe(A(c, 0, t), o).then(l)) : (s = Promise.resolve([]), c = Promise.resolve([])), t.set(T.bind(null, [u, c, s], !0)), uiSearch.showProgress(a), Promise.all([u, s, c]).then(function() {
            return uiSearch.hideProgress(a)
        })
    }

    function R(e, t, n, r, o, i) {
        I(t).map(function(e) {
            return geByClass1("_im_dialog" + e)
        }).forEach(function(e) {
            return removeClass(e, E)
        }), t.reset(), L(n, e, r, !1, I(t)), o.resetSelection(), k(e, n, i, !1, o, t)
    }

    function B(e, t, n, i, a, s, c) {
        var u = I(t),
            d = e.get(),
            f = geByClass1(v, n),
            p = uiSearch.getFieldEl(geByClass1(m, n)).value,
            _ = "add_member" === e.get().creationType,
            g = !_ && (p.length || u.length > 1);
        if (_) return e.set(r.addNewMember.bind(null, d.peer, u)).catch(function(e) {
            return showFastBox(getLang("global_error"), e)
        }), k(e, n, s, "", a, t);
        if (lockButton(f), !g) return h(u[0]);

        function h(r) {
            R(e, t, n, i, a, s),
                function(e, t, n, r, o, i) {
                    k(e, t, n, !1, o, i), e.get().longpoll.push([Object(l.changePeer)(r, !1, !1, !1, "create_conversation")])
                }(e, n, s, r, a, t), unlockButton(f), Object(o.isSearching)(e) ? s().cancelSearch(e) : s().restoreDialogs(e)
        }
        e.set(r.createChat.bind(null, d.next_chat_avatar, u, p)).then(function() {
            return h(d.next_peer)
        }).catch(function(e) {
            unlockButton(f), topMsg(getLang("global_unknown_error"), 2, "#FFB4A3")
        })
    }

    function N(e, t) {
        var n = t && t.get().selection.length;
        return {
            top: -1,
            bottom: Object(a.isClassicInterface)(e) ? n > 0 ? 69 : 0 : -1
        }
    }

    function U(e, t, n) {
        var o = Object(u.default)({
                selection: []
            }),
            U = geByClass1(f, e),
            F = Object(i.mount)(U, Object(u.default)({
                offset: 0,
                limit: j,
                elements: [],
                elCls: p
            }), function() {
                return {
                    idFn: function(e) {
                        return intval(e.peerId)
                    },
                    hoverableFn: function(e) {
                        return hasClass(e, "_im_dialog")
                    },
                    renderFn: function(e, t) {
                        var n = I(e),
                            r = ["_im_dialog", "_im_dialog" + t.peerId, "im-creation--item"],
                            o = [];
                        return t.online && o.push("online"), mobPlatforms[t.online] && o.push("mobile"), inArray(t.peerId, n) && r.push(E), getTemplate("im_owner_item", {
                            owner_id: t.peerId,
                            cls: " " + r.join(" "),
                            photo: t.photo,
                            name: t.name,
                            link: t.href,
                            img_cls: o.join(" ")
                        })
                    }.bind(null, o),
                    more: function(e, n) {
                        var i = void 0;
                        return t.get().shown ? (t.get().creation_shown_all || !1 !== x(o) ? i = Promise.resolve([]) : (t.get().creation_shown_all = !0, i = Object(r.searchTopConv)(x(o), t.get())), t.set(T.bind(null, [i], !1)), A(i, x(o), t)) : Promise.resolve(!1)
                    },
                    onClick: function(n, r) {
                        checkEvent(n) || (P(t, e, 0, W, F, o, r), cancelEvent(n))
                    }
                }
            });
        t.get().creationQuery = !1, t.get().creationType = "chat";
        var H = geByClass1(g, e),
            W = Object(s.mount)(H, o, function() {
                return {
                    selectionDeleted: function(n, r) {
                        M(t, n, e), removeClass(geByClass1("_im_dialog" + r), E)
                    },
                    onChange: function(e, t, n, r) {
                        var o = r.get(),
                            i = x(o);
                        o.selection.map(function(e) {
                            return e.id
                        }), n.unhoverElements(w), e.get().creationQuery = i, L(t, e, n, i)
                    }.bind(null, t, e, F)
                }
            }),
            K = k.bind(null, t, e, n, "cross", W, o),
            q = function(e, t, n, o, i, a, s, c) {
                uiTabs.switchTab(c.firstElementChild);
                var u = domData(c, "type");
                switch (u) {
                    case "chat":
                        a.restore()
                }
                e.set(r.setCreationType.bind(null, u, [])).then(D.bind(null, t, o, i))
            }.bind(null, t, e, n, F, o, W),
            z = function(e, t, n, o) {
                var i = 2e9 + Math.round(rand(1e6, 2e6));
                cur.recieveCropResult = function(n) {
                    cur.recieveCropResult = !1, curBox() && curBox().hide(), e.set(r.presetAvatar.bind(null, n)), Object(r.getOwnerPhoto)(n, i).then(function(e) {
                        geByClass1(h, t).appendChild(ce("img", {
                            className: "im-chat-placeholder--img " + O,
                            src: e
                        }))
                    }), addClass(t, "im-create_photo-attached")
                }, Page.ownerPhoto(i)
            }.bind(null, t, e),
            G = function(e, t) {
                geByClass1(h, t).innerHTML = "", e.set(r.presetAvatar.bind(null, !1)), removeClass(t, "im-create_photo-attached")
            }.bind(null, t, e),
            V = R.bind(null, t, o, e, F, W, n),
            Y = B.bind(null, t, o, e, F, W, n),
            Q = function(e, t, n) {
                M(e, t, n)
            }.bind(null, t, o, e),
            $ = geByClass1(d, e),
            X = geByClass1(m, e),
            J = X.querySelector("." + C),
            Z = Object(c.createModule)({
                handlers: function(t, n) {
                    t($, "click", K), t($, "mouseover", function(e, t) {
                        return showTooltip(e, {
                            text: getLang("mail_cancel"),
                            black: 1,
                            zIndex: 1e3,
                            shift: [3, -2],
                            appendCls: "js-im-page"
                        })
                    }.bind(null, $)), t(geByClass1(h, e), "click", z), t(geByClass1(b, e), "click", G), t(geByClass1(y, e), "click", V), t(X, "change", Q), t(X, "input", Q), t(X, "paste", Q), t(J, "click", Q), t(geByClass1(v, e), "click", Y), t(e, "mouseover", throttle(F.unhoverElements.bind(F, w), 100)), n(e, "click", _, q)
                }
            });
        return function(e, t, n, r, o, i, s, u) {
            return {
                show: function(t) {
                    var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
                    t.setState({
                        shown: !0
                    }), S(e, !0), cancelStackPush("im_create", s), addClass(e, "im-create_shown");
                    var a = r.get().selection.reduce(function(e, t) {
                        return e[t.id] = !0, e
                    }, {});
                    i && i.forEach(function(t) {
                        if (!a[t[0]]) {
                            var n = e.querySelector("._im_dialog" + t[0]);
                            o.addSelection(t[0], t[1]), n && !n.classList.contains(E) && n.classList.add(E)
                        }
                    }), D(e, n, r, t), setTimeout(function() {
                        t.get().longpoll.push([Object(l.transitionEvent)("create")]), attr(e, "aria-hidden", "false"), o.focus()
                    }, 1)
                },
                focusSearch: function(e) {
                    o.focus()
                },
                confirmCreate: function(e) {
                    u()
                },
                hide: function(n) {
                    n.get().shown = !1, k(n, e, t, !1, o, r)
                },
                scroll: function(e) {
                    n.scrollPage(e, !0)
                },
                updateScroll: function() {
                    Object(a.fixTableCellChildHeight)("_im_create_wrap_safe", e), n.updateScroll()
                },
                selectElement: function(t) {
                    P(t, e, 0, o, n, r, n.getHoveredElement())
                },
                hoverPrevElement: function(e) {
                    n.hoverPrevElement(w, null, N(e, r))
                },
                hoverNextElement: function(e) {
                    n.hoverNextElement(w, null, N(e, r))
                },
                unmount: function() {
                    Object(c.destroyModule)(i), n.unmount(), o.unmount(), cancelStackFilter("im_create"), cur.recieveCropResult = void 0
                }
            }
        }(e, n, F, o, W, Z, K, Y)
    }
}, , function(e, t, n) {
    var r = n(316),
        o = r["__core-js_shared__"] || (r["__core-js_shared__"] = {});
    e.exports = function(e) {
        return o[e] || (o[e] = {})
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(63)),
        i = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };
    var a = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return r.getRef = function(e) {
                r.element = e
            }, r.resize = function() {
                var e = r.element;
                if (e) {
                    var t = e.offsetHeight,
                        n = e.scrollHeight,
                        o = 0;
                    n + o <= t && (o = 0), e.value && r.setState({
                        height: n - o
                    }), r.setState({
                        height: 0
                    }, function() {
                        var t = e.scrollHeight - o;
                        r.setState({
                            height: t
                        }), r.props.onResize(e)
                    })
                }
            }, r.onChange = function(e) {
                r.props.grow && r.resize(), r.isControlledOutside || r.setState({
                    value: e.target.value
                }), r.props.onChange && r.props.onChange(e)
            }, r.state = {
                value: void 0 === n.value ? n.initialValue || "" : void 0
            }, void 0 !== n.value && (r.isControlledOutside = !0), r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentDidMount = function() {
            this.props.grow && this.resize()
        }, t.prototype.render = function() {
            var e = this.props,
                t = e.className,
                n = (e.initialValue, e.grow, e.style),
                a = (e.onResize, e.value),
                s = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["className", "initialValue", "grow", "style", "onResize", "value"]),
                c = this.isControlledOutside ? a : this.state.value,
                u = this.state.height || n.height || 66;
            return r.createElement("textarea", i({}, s, {
                value: c,
                onChange: this.onChange,
                onInput: this.onChange,
                onPaste: this.onChange,
                ref: this.getRef,
                style: Object.assign({
                    height: u
                }, n),
                className: Object(o.classNames)("Textarea", t)
            }))
        }, t
    }(r.Component);
    t.default = a, a.defaultProps = {
        initialValue: "",
        grow: !0,
        onResize: function() {},
        style: {}
    }
}, function(e, t, n) {
    "use strict";
    var r = n(201),
        o = n(218),
        i = n(328),
        a = {};
    n(426)(a, n(151)("iterator"), function() {
        return this
    }), e.exports = function(e, t, n) {
        e.prototype = r(a, {
            next: o(1, n)
        }), i(e, t + " Iterator")
    }
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(412),
        i = (n(96), n(63)),
        a = n(204);
    var s = function(e) {
        function t(n) {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var o = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call(this, n));
            return o.onMouseEnter = function(e) {
                if (o.el) {
                    var t = o.props,
                        n = t.text,
                        r = t.position,
                        i = t.align,
                        s = t.marginTop,
                        c = t.marginLeft,
                        u = Object(a.default)(o.el);
                    o.update({
                        text: n,
                        position: r,
                        align: i,
                        rect: u,
                        marginTop: s,
                        marginLeft: c
                    })
                }
            }, o.onMouseLeave = function(e) {
                return o.update()
            }, o.onTransitionEnd = function(e) {
                "visibility" === e.propertyName && o.state.tooltip && o.setState({
                    tooltip: void 0
                })
            }, o.renderTooltip = function() {
                if (!o.state.tooltip) return null;
                var e, t, n, a = o.state.tooltip,
                    s = a.x,
                    c = a.y,
                    u = a.position,
                    l = a.align,
                    d = a.text,
                    f = a.removed,
                    p = Object(i.classNames)("Tooltip", "Tooltip--" + u, (e = {
                        "Tooltip--removed": !!f
                    }, t = "Tooltip--align-" + l, n = "t" === u || "b" === u, t in e ? Object.defineProperty(e, t, {
                        value: n,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : e[t] = n, e));
                return r.createElement("div", {
                    className: p,
                    style: {
                        top: c,
                        left: s
                    },
                    onTransitionEnd: o.onTransitionEnd
                }, r.createElement("div", {
                    className: "Tooltip__in",
                    dangerouslySetInnerHTML: {
                        __html: d
                    }
                }))
            }, o.state = {}, o
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentDidMount = function() {
            this.el = o.findDOMNode(this), this.el.addEventListener("mouseenter", this.onMouseEnter), this.el.addEventListener("mouseleave", this.onMouseLeave)
        }, t.prototype.componentWillUnmount = function() {
            this.el.removeEventListener("mouseenter", this.onMouseEnter), this.el.removeEventListener("mouseleave", this.onMouseLeave)
        }, t.prototype.update = function(e) {
            if (!e) return this.setState({
                tooltip: Object.assign({}, this.state.tooltip, {
                    removed: !0
                })
            });
            var t = e.position,
                n = e.align,
                r = e.text,
                o = e.rect,
                i = e.marginTop,
                a = e.marginLeft,
                s = o.left,
                c = o.top;
            switch (t) {
                case "t":
                    s += .5 * o.width;
                    break;
                case "r":
                    s += o.width, c += .5 * o.height;
                    break;
                case "b":
                    s += .5 * o.width, c += o.height;
                    break;
                case "l":
                    c += .5 * o.height
            }
            s = Math.round(s + a), c = Math.round(c + i), this.setState({
                tooltip: {
                    position: t,
                    align: n,
                    text: r,
                    x: s,
                    y: c
                }
            })
        }, t.prototype.render = function() {
            var e = this.renderTooltip();
            return e ? (this.defaultNode || "undefined" == typeof window || (this.defaultNode = document.createElement("div"), document.body.appendChild(this.defaultNode)), r.createElement(r.Fragment, null, this.props.children, o.createPortal(e, this.defaultNode))) : this.props.children
        }, t
    }(r.Component);
    t.default = s, s.defaultProps = {
        position: "b",
        align: "center",
        marginTop: 0,
        marginLeft: 0
    }
}, , , function(e, t) {
    var n = {}.toString;
    e.exports = function(e) {
        return n.call(e).slice(8, -1)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "getFirstUnread", function() {
        return l
    }), n.d(t, "isSearchShown", function() {
        return d
    }), n.d(t, "getPeer", function() {
        return f
    }), n.d(t, "getCurrentKeyboard", function() {
        return p
    }), n.d(t, "getKeyboard", function() {
        return _
    }), n.d(t, "getTab", function() {
        return m
    }), n.d(t, "getCurrentTab", function() {
        return g
    }), n.d(t, "getSelectedMessages", function() {
        return h
    }), n.d(t, "getMessageRangeFromSelection", function() {
        return b
    }), n.d(t, "countUnread", function() {
        return v
    }), n.d(t, "getMessageByRid", function() {
        return y
    }), n.d(t, "isRidExist", function() {
        return O
    }), n.d(t, "getLocalId", function() {
        return w
    }), n.d(t, "getLastMessage", function() {
        return E
    }), n.d(t, "parserMessage", function() {
        return C
    }), n.d(t, "getAuthorFullName", function() {
        return j
    }), n.d(t, "getMessage", function() {
        return k
    }), n.d(t, "getPreviousMessage", function() {
        return T
    }), n.d(t, "isClassicInterface", function() {
        return S
    }), n.d(t, "isLocksAvailable", function() {
        return M
    }), n.d(t, "isFoldersAvailable", function() {
        return P
    }), n.d(t, "isCommunityInterface", function() {
        return x
    }), n.d(t, "isChannel", function() {
        return I
    }), n.d(t, "getBareTab", function() {
        return D
    }), n.d(t, "isReversedDialogs", function() {
        return A
    }), n.d(t, "isFullyLoadedTab", function() {
        return L
    }), n.d(t, "makeTabNotFullyLoaded", function() {
        return R
    }), n.d(t, "isGoToEndVisible", function() {
        return B
    }), n.d(t, "getUnreadScrollBottom", function() {
        return N
    }), n.d(t, "isSendingAvailable", function() {
        return U
    }), n.d(t, "isCommunityPeer", function() {
        return F
    }), n.d(t, "isCommunityBlocked", function() {
        return H
    }), n.d(t, "checkVoiceMessageAvailable", function() {
        return W
    }), n.d(t, "isSearching", function() {
        return K
    }), n.d(t, "getSearchText", function() {
        return q
    }), n.d(t, "isSearchingValue", function() {
        return z
    }), n.d(t, "isRecentSearchesActive", function() {
        return G
    }), n.d(t, "getPinnedMessage", function() {
        return V
    }), n.d(t, "doPopularSuggExist", function() {
        return Y
    }), n.d(t, "isAnyMessageBeingEdited", function() {
        return Q
    }), n.d(t, "getGroupId", function() {
        return $
    }), n.d(t, "getTabDraft", function() {
        return X
    }), n.d(t, "getTemplates", function() {
        return J
    }), n.d(t, "tabIsMessageRequest", function() {
        return Z
    }), n.d(t, "tabIsOutgoingMessageRequest", function() {
        return ee
    });
    var r = n(427),
        o = n(112),
        i = n(192),
        a = n(66),
        s = n(425),
        c = n(187),
        u = n(309);

    function l(e, t) {
        var n = Object(c.unpackStore)(e),
            o = n.tabs[n.peer];
        return Object.keys(o.msgs).filter(function(n) {
            var i = k(e, t, n);
            return !Object(r.isOut)(i) && intval(n) > o.in_up_to
        })[0]
    }

    function d(e) {
        return Object(c.unpackStore)(e).searchShown
    }

    function f(e) {
        return Object(c.unpackStore)(e).peer
    }

    function p(e) {
        return _(e, f(e))
    }

    function _(e, t) {
        return (m(e, t) || {}).keyboard
    }

    function m(e, t) {
        var n = Object(c.unpackStore)(e);
        return n.tabs && n.tabs[t]
    }

    function g(e) {
        var t = Object(c.unpackStore)(e);
        return t.peer ? t.tabs[t.peer] : null
    }

    function h(e) {
        return Object(c.unpackStore)(e).selectedMessages
    }

    function b(e, t, n) {
        var o = m(e, t),
            i = h(e)[0];
        if (void 0 === i) return [n];
        var a = Math.min(n, i),
            s = Math.max(n, i);
        return Object.keys(o.msgs).filter(function(e) {
            return e >= a && e <= s
        }).filter(function(t) {
            var n = k(e, e.get().peer, t);
            return !Object(r.isServiceMsg)(n) && !Object(r.isCallMessage)(n)
        }).map(intval)
    }

    function v(e, t) {
        var n = m(Object(c.unpackStore)(t), e),
            o = 0;
        for (var i in n.msgs)
            if (n.msgs.hasOwnProperty(i)) {
                var a = k(t, e, i);
                Object(r.isOut)(a) || (o += Object(r.isUnread)(n, a) ? 1 : 0)
            }
        return o
    }

    function y(e, t, n) {
        var r = m(e, t);
        return Object.keys(r.msgs).filter(function(r) {
            return intval(k(e, t, r).randomId) === n
        }).length > 0
    }

    function O(e, t, n) {
        return !!y(e, t, n)
    }

    function w(e, t) {
        var n = Object(c.unpackStore)(e),
            r = n.msg_local_ids_sort && n.msg_local_ids_sort[t];
        return void 0 !== r ? 2e9 + r : t
    }

    function E(e, t, n) {
        var r = m(e, t),
            i = k(e, t, n),
            a = Object.keys(r.msgs).filter(function(n) {
                var r = k(e, t, n),
                    a = r.local && r.type !== o.EDIT_MESSAGE;
                return !(!i.local && a) && (!(!i.local || a) || w(e, i.messageId) > w(e, r.messageId))
            }).pop();
        return a ? k(e, t, a) : null
    }

    function C(e) {
        return e && e.length > 0 ? o.addMessageEvent([0].concat(e)) : e
    }

    function j(e, t, n) {
        var o = m(e, t),
            i = k(e, t, n),
            s = Object(c.unpackStore)(e);
        return Object(r.isOut)(i) ? Object(a.oCacheGet)(e, s.id).name : i.userId !== i.peerId ? !!Object(a.oCacheExists)(e, i.userId) && Object(a.oCacheGet)(e, i.userId).name : o.tab
    }

    function k(e, t, n) {
        var r = m(e, t),
            o = r && r.msgs && r.msgs[n];
        return o ? C(o) : null
    }

    function T(e, t, n) {
        var r = m(e, t),
            o = r && r.msgs && Object.keys(r.msgs).sort(function(e, t) {
                return +e - t
            });
        if (!o) return null;
        var i = o && o.indexOf("" + n),
            a = i > -1 ? o[i - 1] : null;
        return r.msgs[a]
    }

    function S(e) {
        var t = Object(c.unpackStore)(e);
        return t.gid || t.isClassic
    }

    function M(e) {
        return Object(c.unpackStore)(e).gid
    }

    function P(e) {
        return Object(c.unpackStore)(e).gid
    }

    function x(e) {
        return !!Object(c.unpackStore)(e).gid
    }

    function I(e, t) {
        return !!(t.peerId > 2e9 && Object(u.doesChatTabHaveFlag)(t, 1024))
    }

    function D(e, t) {
        var n = Object(c.unpackStore)(t);
        return n.tabs[e] || n.mapped_index[e]
    }

    function A(e) {
        var t = Object(c.unpackStore)(e);
        return !!x(e) && ((19542789 === t.gid || 103416369 == t.gid) && (t.active_tab === i.FOLDER_UNRESPOND || t.active_tab === i.FOLDER_UNREAD))
    }

    function L(e, t) {
        var n = (e = Object(c.unpackStore)(e)).tabs;
        return !(!n || !n[t] || void 0 === n[t].history || !n[t].msgs)
    }

    function R(e, t) {
        var n = m(e, t);
        n && (n.msgs = void 0, n.msgid = void 0, n.scrollTop = void 0, n.scrollBottom = void 0, n.contHeight = void 0, n.offset = void 0, n.skipped = void 0)
    }

    function B(e) {
        var t = e.get().go_to_end_visible;
        return !!t && t[0]
    }

    function N(e) {
        var t = e.get().go_to_end_visible;
        return t ? t[1] : 0
    }

    function U(e) {
        return !Object(c.unpackStore)(e).lockedSending
    }

    function F(e) {
        return e > -2e9 && e < 0
    }

    function H(e, t) {
        return !!F(t) && !!m(e, t).blocked_community
    }

    function W(e) {
        return Object(c.unpackStore)(e).voice_message_available
    }

    function K(e) {
        var t = Object(c.unpackStore)(e);
        return !(!q(t) && !t.recentSearch)
    }

    function q(e) {
        return Object(c.unpackStore)(e).searchText
    }

    function z(e, t) {
        var n = Object(c.unpackStore)(e);
        return !!(t && t !== q(e) || n.recentSearch)
    }

    function G(e) {
        return Object(c.unpackStore)(e).recentSearch
    }

    function V(e) {
        var t = g(e);
        return t && t.pinned && C(t.pinned)
    }

    function Y(e) {
        var t = e.get().popular_sugg;
        return t && t.length > 0
    }

    function Q(e) {
        return 1 == Object(c.unpackStore)(e).isEditing
    }

    function $(e) {
        return Object(c.unpackStore)(e).gid
    }

    function X(e) {
        return e.draft || (e.draft = Object(s.loadDraftForPeer)(cur.imDb, e.peerId)), e.draft
    }

    function J(e) {
        return (Object(c.unpackStore)(e).templates || []).filter(function(e) {
            return !e.deleted
        })
    }

    function Z(e) {
        return e.is_message_request || e.folders & i.FOLDER_MASKS[i.FOLDER_MESSAGE_REQUEST] || e.folders & i.FOLDER_MASKS[i.FOLDER_MESSAGE_REQUEST_REJECTED]
    }

    function ee(e) {
        return e.peerId > 19e8 && e.peerId < 2e9
    }
}, , function(e, t) {
    e.exports = function(e, t, n, r) {
        if (!(e instanceof t) || void 0 !== r && r in e) throw TypeError(n + ": incorrect invocation!");
        return e
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "getLang", function() {
        return s
    });
    var r = n(420),
        o = {},
        i = window.getLang,
        a = window.langNumeric;

    function s(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
            n = arguments[2],
            s = "number" == typeof t,
            c = e + (t || s ? ".raw" : "");
        if (void 0 === o[c]) {
            var u = t || s ? i(e, "raw") : i(e);
            "string" == typeof u ? o[c] = Object(r.decodeHTMLEntities)(u) : Array.isArray(u) && (o[c] = u.map(r.decodeHTMLEntities))
        }
        return s ? a(t, o[c], n) : o[c] || ""
    }
    t.default = {
        getLang: s
    }
}, , , function(e, t, n) {
    "use strict";
    ! function e() {
        if ("undefined" != typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ && "function" == typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE) try {
            __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)
        } catch (e) {
            console.error(e)
        }
    }(), e.exports = n(69)
}, function(e, t, n) {
    var r = n(127),
        o = n(218),
        i = n(280),
        a = n(227),
        s = n(305),
        c = n(20),
        u = Object.getOwnPropertyDescriptor;
    t.f = n(263) ? u : function(e, t) {
        if (e = i(e), t = a(t, !0), c) try {
            return u(e, t)
        } catch (e) {}
        if (s(e, t)) return o(!r.f.call(e, t), e[t])
    }
}, , , , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "escape", function() {
        return a
    }), n.d(t, "decodeHTMLEntities", function() {
        return s
    }), n.d(t, "encodeHTMLEntities", function() {
        return c
    }), n.d(t, "prepareToWriting", function() {
        return u
    });
    var r = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }(),
        o = window.Emoji,
        i = [
            ["&amp;", "&"],
            ["&lt;", "<"],
            ["&gt;", ">"],
            ["&quot;", '"']
        ];

    function a(e) {
        return i.reduce(function(e, t) {
            var n = r(t, 2),
                o = n[0],
                i = n[1];
            return e.replace(new RegExp(i, "ig"), o)
        }, e)
    }

    function s(e) {
        return i.reduce(function(e, t) {
            var n = r(t, 2),
                o = n[0],
                i = n[1];
            return e.replace(new RegExp(o, "ig"), i)
        }, e).replace(/&#(\d+);/g, function(e, t) {
            return String.fromCodePoint(t)
        })
    }

    function c(e) {
        return a(e).replace(/[\u00A0-\u9999<>\&]/gim, function(e) {
            return "&#" + e.charCodeAt(0) + ";"
        })
    }

    function u(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
            n = t.lineBreak,
            r = void 0 !== n && n,
            i = t.convertEmoji,
            c = void 0 === i || i,
            u = s(e);
        return u = u.replace(/\n\r/gi, "\n"), "oneline" === r ? u = u.replace(/<br>/gi, " ").replace(/\n/gi, " ") : "html" === r && (u = u.replace(/\n/gi, "<br>")), u = a(u), c && (u = o.emojiToHTML(u, !0)), u
    }
}, , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "ImDraft", function() {
        return s
    }), n.d(t, "loadDraftForPeer", function() {
        return u
    });
    var r = n(364),
        o = n(112),
        i = n(252),
        a = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function s(e, t) {
        this._db = e, this._key = t, this.dData = {
            txt: "",
            attaches: [],
            urlBinds: [],
            cancelled: []
        }, this.load()
    }

    function c(e) {
        switch (e.type) {
            case "mail":
            case "reply":
                return e.id < 0 && 1 == e.object.fwd_count;
            default:
                return !e.object
        }
    }

    function u(e, t) {
        return new s(e, "draft_" + t)
    }
    s.prototype.dump = function() {
        var e;
        this._key && this._db.updateByKey(this._key, {
            txt: (e = this.dData).txt,
            attaches: e.attaches.length ? e.attaches : void 0,
            urlBinds: e.urlBinds.length ? e.urlBinds : void 0,
            cancelled: e.cancelled.length ? e.cancelled : void 0
        })
    }, s.prototype.load = function() {
        if (this._key) {
            var e = this._db.selectByKey(this._key);
            e && (this.dData = function(e) {
                return {
                    txt: e.txt,
                    attaches: e.attaches || [],
                    urlBinds: e.urlBinds || [],
                    cancelled: e.cancelled || []
                }
            }(e))
        }
    }, s.prototype.clear = function() {
        this.dData = {
            txt: "",
            attaches: [],
            urlBinds: [],
            cancelled: []
        }, this.dump()
    }, s.prototype.setText = function(e) {
        this.dData.txt = trim(e), this.dump()
    }, s.prototype.addAttach = function(e, t, n) {
        if ("share" === e && this.removeAttachByType(e), "mail" !== e && "reply" !== e || (this.removeAttachByType("mail"), this.removeAttachByType("reply")), !e || !t && "poll" !== e) return !1;
        var r = this.dData.attaches.findIndex(function(n) {
            return n.type === e && n.id === t
        }); - 1 === r ? (this.dData.attaches.push({
            type: e,
            id: t,
            object: n
        }), this.dump()) : "video" !== e && "poll" !== e || (this.dData.attaches[r] = {
            type: e,
            id: t,
            object: n
        }, this.dump())
    }, s.prototype.syncWithSelector = function(e) {
        var t = this,
            n = this.getFwdRaw();
        this.dData.attaches = (n ? [n] : []).concat(e.getMedias().map(function(e) {
            var n = a(e, 2),
                r = n[0],
                o = n[1];
            return t.dData.attaches.find(function(e) {
                return e.type == r && e.id == o
            }) || {
                type: r,
                id: o
            }
        })), this.dump()
    }, s.prototype.removeAttachByType = function(e) {
        for (var t = this.dData.attaches.length; t--;) this.dData.attaches[t].type === e && this.dData.attaches.splice(t, 1);
        this.dump()
    }, s.prototype.removeAllAttaches = function() {
        this.dData.attaches = [], this.dData.cancelled = [], this.dump()
    }, s.prototype.addBindUrl = function(e, t, n) {
        this.getBoundAttach(e) || (this.dData.urlBinds.push({
            url: e,
            type: t,
            id: n
        }), this.dump())
    }, s.prototype.getBoundAttach = function(e) {
        var t = this.dData.urlBinds.find(function(t) {
            return t.url === e
        });
        return t && this.dData.attaches.find(function(e) {
            return e.type === t.type && e.id === t.id
        }) || null
    }, s.prototype.getShareUrl = function() {
        var e = this.dData.attaches.find(function(e) {
            return "share" === e.type
        });
        if (e && e.object) return e.object.url
    }, s.prototype.hasOnlyReplies = function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null;
        return e ? e.flags & o.FLAG_HAS_REPLY && !this.dData.attaches.find(function(e) {
            return "mail" !== e.type
        }) : this.hasAttaches() && !this.dData.attaches.find(function(e) {
            return "reply" !== e.type
        })
    }, s.prototype.getCancelledShares = function() {
        return this.dData.cancelled.length ? this.dData.cancelled : void 0
    }, s.prototype.hasAttaches = function() {
        return this.dData.attaches.length > 0
    }, s.prototype.destroy = function() {
        this.dData = {}, this._key = this._db = null
    }, s.prototype.prepareObjects = function(e, t) {
        var n = this;
        return this.dData.attaches.find(c) ? Object(r.post)(i.CONTROLLER, {
            act: "draft_medias",
            gid: e,
            messageId: t || 0,
            media: t ? void 0 : this.dData.attaches.map(function(e) {
                return [e.type, e.id]
            }).join("*")
        }).then(function(e) {
            var t = a(e, 1)[0];
            n.dData.attaches = t.map(function(e) {
                return {
                    type: e[0],
                    id: e[1],
                    object: e[2]
                }
            })
        }) : Promise.resolve()
    }, s.prototype.getFwdRaw = function() {
        return this.dData.attaches.find(function(e) {
            return "mail" === e.type || "reply" === e.type
        })
    }, s.prototype.getFwdCount = function() {
        var e = this.getFwdRaw();
        return e ? e.id < 0 ? e.object.fwd_count : e.id.split(";").length : 0
    }
}, function(e, t, n) {
    var r = n(184),
        o = n(218);
    e.exports = n(263) ? function(e, t, n) {
        return r.f(e, t, o(1, n))
    } : function(e, t, n) {
        return e[t] = n, e
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "isUnread", function() {
        return i
    }), n.d(t, "isServiceMsg", function() {
        return a
    }), n.d(t, "isCallMessage", function() {
        return s
    }), n.d(t, "isOut", function() {
        return c
    }), n.d(t, "hasReply", function() {
        return u
    }), n.d(t, "isGraffiti", function() {
        return d
    }), n.d(t, "isAudioMsg", function() {
        return f
    }), n.d(t, "isSticker", function() {
        return p
    }), n.d(t, "isGift", function() {
        return _
    }), n.d(t, "isMoney", function() {
        return m
    }), n.d(t, "isMoneyRequest", function() {
        return g
    }), n.d(t, "isVKPay", function() {
        return h
    }), n.d(t, "isImportant", function() {
        return b
    }), n.d(t, "getUserId", function() {
        return v
    }), n.d(t, "getAuthorId", function() {
        return y
    }), n.d(t, "wasEdited", function() {
        return O
    }), n.d(t, "isMessageSelected", function() {
        return w
    });
    var r = n(112),
        o = n(187);

    function i(e, t) {
        return "number" != typeof t.messageId || (c(t) ? t.messageId > e.out_up_to : t.messageId > e.in_up_to)
    }

    function a(e) {
        return e.kludges && void 0 !== e.kludges.source_act
    }

    function s(e) {
        return "call" == e.kludges.attach1_type
    }

    function c(e) {
        return e.flags & r.FLAG_OUTBOUND
    }

    function u(e) {
        var t = e.attaches.filter(function(e) {
            return "mail" === e.type
        }).length > 0;
        return e.attaches.filter(function(e) {
            return "reply" === e.type
        }).length > 0 || e.flags & r.FLAG_HAS_REPLY && t
    }

    function l(e, t) {
        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null,
            r = e.attaches[0];
        return r && (r.type === t || r.type === n)
    }

    function d(e) {
        return l(e, "doc") && "graffiti" === e.attaches[0].kind
    }

    function f(e) {
        return Boolean(e.attaches.find(function(e) {
            return "doc" === e.type && "audiomsg" === e.kind
        }))
    }

    function p(e) {
        return Boolean(e.attaches.find(function(e) {
            return "sticker" === e.type
        }))
    }

    function _(e) {
        return l(e, "gift")
    }

    function m(e) {
        return l(e, "money_transfer", "money_request")
    }

    function g(e) {
        return l(e, "money_request")
    }

    function h(e) {
        return l(e, "link", "vkpay") && 6217559 == e.kludges.attach1_app_id
    }

    function b(e) {
        return e.flags & r.FLAG_IMPORTANT
    }

    function v(e) {
        return c(e) ? vk.id : e.userId
    }

    function y(e, t) {
        var n = Object(o.unpackStore)(e);
        return c(t) ? n.id : t.userId
    }

    function O(e) {
        return e.update_time > 0
    }

    function w(e, t) {
        return (e.get().selectedMessages || []).indexOf(t) >= 0
    }
}, , function(e, t) {
    e.exports = function(e) {
        if ("function" != typeof e) throw TypeError(e + " is not a function!");
        return e
    }
}, , , , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(219);

    function o(e, t) {
        if (!t) return ls.get(e);
        ls.set(e, t)
    }
    t.default = function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
            t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
            n = debounce(o, 300),
            i = extend({}, e),
            a = [],
            s = [];
        return t.store && (i = ls.get(t.key) || i), {
            get: function() {
                return i
            },
            set: function(e) {
                var o = this,
                    a = Object(r.isWeirdLogging)() ? function(e) {
                        try {
                            var t = {};
                            return Error.captureStackTrace(t, e), t.stack
                        } catch (e) {
                            return ""
                        }
                    }(this.set) : null;
                return e(i).then(function(e) {
                    return i = e, t.store && n(t.key, e), o.emit(), o
                }).catch(function(e) {
                    return Object(r.imWeirdCatch)("store_set_catch", e, {
                        stack: a
                    })
                })
            },
            setState: function(e) {
                var t = this;
                return this.set(function(n) {
                    return n = extend(n, e), t.emit(), Promise.resolve(n)
                })
            },
            stash: function() {
                a.push(i), i = extend({}, e), this.emit()
            },
            reset: function() {
                i = extend({}, e), this.emit()
            },
            unmount: function() {
                i = {}, e = !1, s = []
            },
            pop: function() {
                a.length > 0 && (i = a.pop(), this.emit())
            },
            emit: function() {
                var e = this;
                s.length > 0 && s.forEach(function(t) {
                    return t(e)
                })
            },
            subscribe: function(e) {
                -1 === s.indexOf(e) && s.push(e)
            },
            unsubscribe: function(e) {
                s = s.filter(function(t) {
                    return t !== e
                })
            },
            mutate: function(e) {
                e(i), t.store && n(t.key, i), this.emit()
            }
        }
    }
}, function(e, t, n) {
    var r = n(67),
        o = n(151)("iterator"),
        i = Array.prototype;
    e.exports = function(e) {
        return void 0 !== e && (r.Array === e || i[o] === e)
    }
}, , , , , function(e, t) {
    var n = Math.ceil,
        r = Math.floor;
    e.exports = function(e) {
        return isNaN(e = +e) ? 0 : (e > 0 ? r : n)(e)
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "statlogsForwardEvent", function() {
        return a
    }), n.d(t, "statlogsForwardFromCommunityEvent", function() {
        return s
    }), n.d(t, "statlogsCommunityTemplatesClickEvent", function() {
        return c
    }), n.d(t, "statlogsForwardFromChannel", function() {
        return u
    }), n.d(t, "statlogsSendingTime", function() {
        return d
    }), n.d(t, "statlogsSendingTimeStart", function() {
        return f
    }), n.d(t, "statlogsSendingTimeEnd", function() {
        return p
    }), n.d(t, "statlogsSendingError", function() {
        return _
    }), n.d(t, "statlogsSendingQueueLength", function() {
        return g
    }), n.d(t, "statlogsSendingRetry", function() {
        return h
    });
    var r = n(292),
        o = n(187),
        i = {};

    function a(e) {
        Object(r.statlogsProbValueEvent)(.1, "im_forward_stat", l(e), !!e.get().gid)
    }

    function s(e, t) {
        Object(r.statlogsProbValueEvent)(.1, "im_forward_from_community_stat", l(e), !!e.get().gid, +t)
    }

    function c() {
        Object(r.statlogsProbValueEvent)(1, "im_apply_community_template_stat", 1)
    }

    function u() {
        Object(r.statlogsProbValueEvent)(1, "messages_channel_forward_click", 1)
    }

    function l(e) {
        var t = e.get().pendingForward;
        return +(t && t.msgIds && t.msgIds.length)
    }

    function d(e, t, n) {
        var o = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
        if (!Object(r.randEnabled)(1)) return function() {};
        var i = +new Date,
            a = m(e);
        return function() {
            var e = +new Date - i;
            statlogsValueEvent("messages_send_time_web", e, t, n, a, o)
        }
    }

    function f(e, t, n, r) {
        if (t.messageId && -1 !== String(t.messageId).indexOf("rid")) {
            var o = [t.messageId.replace("rid", ""), n, r].join("_"),
                a = t.attaches.length > 0;
            i[o] = d(e, n, r, a)
        }
    }

    function p(e, t, n, r) {
        var o = [t.randomId, n, r].join("_"),
            a = i[o];
        a && (a(), delete i[o])
    }

    function _(e, t, n, o) {
        var i = m(e),
            a = "" === t ? "network" : "unknown";
        Object(r.randEnabled)(1) && statlogsValueEvent("messages_send_errors_web", a, n, o, i)
    }

    function m(e) {
        var t = Object(o.unpackStore)(e);
        return Boolean(t.longpoll && t.longpoll.isEnabled && t.longpoll.isEnabled())
    }

    function g(e) {
        var t = Object(o.unpackStore)(e),
            n = t.imQueue(t.peer).length;
        Object(r.randEnabled)(1) && statlogsValueEvent("messages_send_queue_size", n)
    }

    function h(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "unknown";
        Object(r.randEnabled)(1) && statlogsValueEvent("messages_send_retry", 1, t, e)
    }
}, function(e, t, n) {
    "use strict";
    e.exports = function(e) {
        var t = (e ? e.ownerDocument || e : document).defaultView || window;
        return !(!e || !("function" == typeof t.Node ? e instanceof t.Node : "object" == typeof e && "number" == typeof e.nodeType && "string" == typeof e.nodeName))
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "MAX_SAFE_INTEGER", function() {
        return r
    }), n.d(t, "MAX_INTERGER", function() {
        return o
    }), n.d(t, "random", function() {
        return i
    });
    var r = 9007199254740991,
        o = 2147483647;

    function i() {
        try {
            if (window.crypto) {
                var e = new Int32Array(1);
                return crypto.getRandomValues(e), Math.abs(e.reduce(function(e, t) {
                    return e + t
                }))
            }
        } catch (e) {}
        return intval(rand(0, o).toFixed(0))
    }
}, , function(e, t, n) {
    "use strict";
    var r = n(64),
        o = {};
    o[n(151)("toStringTag")] = "z", o + "" != "[object z]" && n(196)(Object.prototype, "toString", function() {
        return "[object " + r(this) + "]"
    }, !0)
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return v
    });
    var r = n(256),
        o = n(283),
        i = n(252),
        a = "_im_upload_dropbox",
        s = "jpg jpeg png gif heic heif".split(" "),
        c = ["application/vnd.rn-realmedia-vbr", "application/vnd.rn-realmedia"];

    function u(e) {
        var t = s.slice(0, s.length);
        if ("types" === e) {
            for (var n = t.length, r = 0; r < n; ++r) t.push(t[r].toUpperCase());
            return "*." + t.join(";*.")
        }
        return "accept" === e ? "." + s.join(",.") : "mask" === e ? s.join("|") : ""
    }

    function l(e, t, n) {
        var r = void 0 !== t.ind ? t.ind : t,
            o = t.fileName ? r + "_" + t.fileName : t;
        if (re("upload" + o + "_progress_wrap"), e().unchoose(o), !geByClass1("popup_box_container")) {
            var i = getLang("mail_add_doc_error");
            "photo" === Upload.options[r].file_name ? i = getLang("mail_add_photo_error") : "video_file" === Upload.options[r].file_name && (i = getLang("video_upload_error")), setTimeout(showFastBox({
                title: getLang("global_error")
            }, i).hide, 2e3)
        }
        topError("Upload failed", {
            dt: -1,
            type: 102,
            url: (ge("file_uploader_form" + r) || {}).action
        }), Upload.embed(r)
    }

    function d(e) {
        var t = void 0 !== e.ind ? e.ind : e,
            n = (e.fileName || e.filename || "").replace(/[&<>"']/g, ""),
            r = n ? t + "_" + n : e,
            o = ge("upload" + r + "_progress_wrap");
        return o && hide(geByClass1("progress_x", o)), r
    }

    function f(e, t) {
        if (!e().canAddMedia()) return "none";
        if (!t.items || !t.items.length) return "media";
        var n = "^(" + u("mask") + ")";
        return [].slice.call(t.items).every(function(e) {
            var t = e.type.split("/");
            return new RegExp(n, "i").test(t[1])
        }) ? "photo" : [].slice.call(t.items).every(function(e) {
            return "video" === e.type.split("/")[0] || ~c.indexOf(e.type)
        }) ? "video" : "doc"
    }

    function p(e) {
        var t = geByClass1(a),
            n = geByClass1("im-page--chat-header").getBoundingClientRect(),
            r = geByClass1("im-chat-input").getBoundingClientRect();
        (n.width < 10 || r.bottom - n.bottom < 10) && (e = "none"), t.style.top = n.bottom + "px", t.style.left = n.left + 1 + "px", t.style.width = n.width - 2 + "px", t.style.height = r.bottom - n.bottom + "px", t.setAttribute("data-mode", e), "none" !== e && show(t)
    }

    function _() {
        var e = geByClass1(a);
        hide(e)
    }

    function m(e, t, n) {
        return {
            loaded: t,
            total: n,
            fileName: e.fileName ? e.fileName.replace(/[&<>"']/g, "") : void 0
        }
    }

    function g(e, t, n, r) {
        "string" == typeof t && t.indexOf("TERMINATED") > -1 || Upload.onUploadError(e), r().reHeight(n)
    }

    function h(e, t, n, r) {
        var o = t.get().upload_opts,
            i = geByClass1("_im_upload_photo"),
            a = geByClass1("_im_drop_photo");
        return Upload.init(i, o.url, o.params, {
            accept: u("accept"),
            file_name: "photo",
            file_size_limit: 26214400,
            file_types: u("types"),
            file_match: o.opts.ext_re,
            lang: o.opts.lang,
            multiple: 1,
            multi_progress: 1,
            max_files: 10,
            chooseBox: 1,
            clear: 1,
            type: "photo",
            max_attempts: 3,
            server: o.opts.server,
            error: o.opts.default_error,
            error_hash: o.opts.error_hash,
            dropbox: a,
            dragEl: bodyNode,
            onNoFilteredCallback: function(e) {
                Upload.onFileApiSend(r, e)
            },
            onUploadStart: function(e, t) {
                delete cur.notStarted, this.onUploadProgress(e, 0, 0)
            },
            onUploadComplete: function(e, r) {
                var o = window.parseJSON(r);
                o.photos ? function(e, t, n, r) {
                    var o = d(e);
                    ajax.post("al_photos.php", extend({
                        act: "choose_uploaded"
                    }, t), {
                        onDone: function(e, t) {
                            r().choose("photo", e, extend(t, {
                                upload_ind: o
                            }))
                        },
                        onFail: l.bind(null, r, e)
                    })
                }(e, o, 0, n) : g(e, r, t, n)
            },
            onUploadProgress: function(e, t, r) {
                var o = void 0 !== e.ind ? e.ind : e;
                n().progress("photo", o, m(e, t, r))
            },
            onUploadError: function(e, t) {
                statlogsValueEvent("upload_photo_fails", 1, o.opts.server, t), l(n, e)
            },
            onDragEnter: function(e) {
                var t = geByClass1("im-audio-message_recording");
                e.dataTransfer && !t && p(f(n, e.dataTransfer))
            },
            onDragOut: function() {
                _()
            },
            onDrop: function() {
                _()
            }
        })
    }

    function b(e, t, n) {
        var r = t.get().upload_doc_opts,
            o = geByClass1("_im_upload_doc"),
            i = geByClass1("_im_drop_doc");
        return Upload.init(o, r.url, r.params, {
            file_name: "file",
            file_size_limit: 209715200,
            file_types: "*.*;",
            lang: r.opts.lang,
            multiple: 1,
            multi_progress: 1,
            max_files: 10,
            chooseBox: 1,
            clear: 1,
            type: "doc",
            max_attempts: 3,
            server: r.opts.server,
            error: r.opts.default_error,
            error_hash: r.opts.error_hash,
            dropbox: i,
            dragEl: bodyNode,
            onUploadStart: function(e, t) {
                delete cur.notStarted, this.onUploadProgress(e, 0, 0)
            },
            onUploadComplete: function(e, o) {
                var i = window.parseJSON(o);
                i.file ? function(e, t, n, r) {
                    var o = d(e),
                        i = {
                            act: "a_save_doc",
                            from: "choose",
                            mail_add: 1
                        };
                    n.opts.imhash && (i = extend(i, {
                        from_place: "from_gim",
                        imhash: n.opts.imhash
                    })), ajax.post("docs.php", extend(i, t), {
                        onDone: function(e, t, n) {
                            r().choose("doc", e + "_" + t, extend(n, {
                                upload_ind: o
                            }))
                        },
                        onFail: l.bind(null, r, e)
                    })
                }(e, i, r, n) : g(e, o, t, n)
            },
            onUploadProgress: function(e, t, r) {
                var o = void 0 !== e.ind ? e.ind : e;
                n().progress("doc", o, m(e, t, r))
            },
            onUploadError: function(e, t) {
                statlogsValueEvent("upload_doc_fails", 1, r.opts.server, t), l(n, e)
            }
        })
    }

    function v(e, t, n) {
        removeEvent(bodyNode, "dragover dragenter");
        var a = b(0, t, n),
            s = function(e, t, n, r) {
                var a = t.get().upload_video_params;
                if (a) {
                    var s = geByClass1("_im_upload_video"),
                        c = geByClass1("_im_drop_video");
                    return a.options.visible_dropbox = !1, Object(o.getUploadModule)(s, c, a, null, {
                        onUploadStart: function(e, t) {
                            delete cur.notStarted, this.onUploadProgress(e, 0, 0)
                        },
                        onUploadComplete: function(e, r) {
                            var a = window.parseJSON(r);
                            a.video_id ? Object(o.onVideoUploaded)(e, a, t.get().textMediaSelector, function(e, n) {
                                var r = document.querySelector('[data-video="' + n + '"]'),
                                    o = e.editable.sizes.x[0] || e.thumb;
                                if (r && o) {
                                    r.style.backgroundImage = "url(" + o + ")";
                                    var a = gpeByClass("_im_mess", r);
                                    "im" === cur.module && a && Object(i.updateVideoThumb)(t, a)
                                }
                            }) : g(e, r, t, n)
                        },
                        onUploadProgress: function(e, t, r) {
                            var o = void 0 !== e.ind ? e.ind : e;
                            n().progress("video", o, m(e, t, r))
                        },
                        onUploadError: function(e, t) {
                            statlogsValueEvent("upload_video_fails", 1, a.options.server, t), l(n, e)
                        },
                        onNoFilteredCallback: function(e) {
                            Upload.onFileApiSend(r, e)
                        },
                        onDragEnter: function(e) {
                            var t = geByClass1("im-audio-message_recording");
                            e.dataTransfer && !t && p(f(n, e.dataTransfer))
                        },
                        onDragOut: function() {
                            _()
                        },
                        onDrop: function() {
                            _()
                        }
                    })
                }
            }(0, t, n, a),
            c = h(0, t, n, s);
        cur.lang.attachments_limit = t.get().upload_opts.opts.lang.max_files_warning;
        var d = Object(r.createModule)({
            handlers: function(e) {
                var t = ge("im_full_upload");
                e(t, "change", function i(a) {
                    if (window.Upload && a.target.files) {
                        if (n().canAddMedia()) {
                            var l = Array.from(a.target.files),
                                f = l.filter(function(e) {
                                    return Upload.checkFileType(e.name, u("types"))
                                }),
                                p = l.filter(function(e) {
                                    return Upload.checkFileType(e.name, Object(o.getUploadVideoExtMasks)("types"))
                                });
                            Upload.onFileApiSend(c, f), Upload.onFileApiSend(s, p)
                        } else showFastBox(getLang("global_error"), getLang("global_error"));
                        Object(r.destroyModule)(d);
                        var _ = t.cloneNode();
                        t.parentNode.replaceChild(_, t), e(t = _, "change", i)
                    }
                })
            }
        });
        return {
            paste: function(e) {
                Upload.onFileApiSend(c, e)
            },
            unmount: function() {
                Object(r.destroyModule)(d), Upload.deinit(c), Upload.deinit(s), Upload.deinit(a)
            }
        }
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "replaceHyperLinks", function() {
        return u
    }), n.d(t, "replaceEmailLinks", function() {
        return l
    }), n.d(t, "replaceMentions", function() {
        return d
    }), n.d(t, "replaceHashtags", function() {
        return _
    }), n.d(t, "confirmDelivery", function() {
        return m
    }), n.d(t, "linksReplacer", function() {
        return g
    });
    var r = n(192),
        o = void 0,
        i = window,
        a = i.clean,
        s = i.replaceEntities,
        c = i.statlogsValueEvent;

    function u(e, t) {
        for (var n = void 0, o = 0, i = e; null !== (n = r.MESSAGE_REGEXP.exec(e));) {
            var a = (n = f(n))[0].length,
                s = n.index + a,
                c = e[n.index - 1],
                u = e[s - 1],
                l = void 0 !== c && /([\w\$А-Яа-яёЁєЄҐґЇїІіЈј\—\-\_@;.])/i.test(c),
                d = void 0 !== u && /([:;$])/i.test(u);
            if (!l && !d) {
                var _ = p(n),
                    m = _.domain.toLowerCase();
                if (m.length <= r.MAX_DOMAIN_LENGTH && -1 !== r.TOP_DOMAINS.indexOf(m)) {
                    var g = t(_);
                    i = i.slice(0, n.index + o) + g + i.slice(s + o), o += g.length - a
                }
            }
        }
        return i
    }

    function l(e, t) {
        return e.replace(r.EMAIL, t || function(e) {
            return '<a href="mailto:' + e + '">' + e + "</a>"
        })
    }

    function d(e, t) {
        return e.replace(r.MENTION, t || function(e, t, n, r, o) {
            return '<a href="/' + (t + n) + '" class="mem_link" mention="' + a(r || "") + '" mention_id="' + a(t + n) + '" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)">' + o + "</a>"
        })
    }

    function f(e) {
        if (!e[0] || !e[6]) return e;
        var t = e[0].length - 1,
            n = e[6].length - 1;
        return "." === e[0][t] && "." === e[6][n] && (e[0] = e[0].slice(0, t), e[6] = e[6].slice(0, n)), e
    }

    function p(e) {
        return {
            full: e[0],
            protocol: e[1] || "http://",
            url: e[2],
            domain: e[4],
            query: e[6] || ""
        }
    }

    function _(e, t) {
        return e.replace((o || (o = new RegExp(r.RE_HASHTAG_EXTRACTION_PATTERN, "ig")), o), function(e, n, r, o, i, a) {
            return (n || "") + t(r + (i || ""))
        })
    }

    function m(e) {
        c("ttl_message_confirm_delivery", e)
    }

    function g(e, t) {
        var n = t.protocol,
            o = t.url,
            i = t.query,
            c = t.domain,
            u = t.full;
        try {
            u = decodeURIComponent(u)
        } catch (e) {}
        if (u.length > 55 && (u = u.substr(0, 53) + ".."), u = a(u).replace(/&amp;/g, "&"), !e && c.match(r.OUR_DOMAINS)) {
            var l, d = o = s(o).replace(r.ENTITIES, encodeURIComponent),
                f = o.indexOf("#/"),
                p = "";
            return f >= 0 ? d = o.substr(f + 1) : (f = o.indexOf("#!")) >= 0 && (d = "/" + o.substr(f + 2).replace(/^\//, "")), (l = d.match(r.VK_DOMAIN)) && l[1].length < 32 && (p = ' mention_id="' + l[1] + '" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"'), '<a href="' + function(e) {
                return e.replace(/"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;")
            }(n + o + i) + '" target="_blank"' + p + ">" + u + "</a>"
        }
        return '<a href="' + ("away.php?utf=1&to=" + encodeURIComponent(n + s(o + i))) + '" target="_blank" onclick="' + ("return goAway('" + a((n + o + i).replace(/'/g, "\\'")) + "', {}, event);") + '">' + u + "</a>"
    }
}, function(e, t, n) {
    var r = n(196);
    e.exports = function(e, t, n) {
        for (var o in t) r(e, o, t[o], n);
        return e
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = n(412),
        i = (n(96), n(63)),
        a = n(204);
    var s = 80,
        c = 250,
        u = function(e) {
            function t(n) {
                ! function(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }(this, t);
                var r = function(e, t) {
                    if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return !t || "object" != typeof t && "function" != typeof t ? e : t
                }(this, e.call(this, n));
                return r.onClick = function() {
                    if (!r.state.dropdown || r.state.dropdown.removed) {
                        var e = r.props,
                            t = e.text,
                            n = e.position,
                            o = e.align,
                            i = e.marginTop,
                            s = e.marginLeft,
                            c = Object(a.default)(r.el);
                        r.update({
                            text: t,
                            position: n,
                            align: o,
                            rect: c,
                            marginTop: i,
                            marginLeft: s
                        })
                    } else r.update()
                }, r.onMouseEnter = function(e) {
                    r.callerHovered = !0, r.timeouts.appear = setTimeout(function() {
                        if (r.el && r.callerHovered) {
                            var e = r.props,
                                t = e.position,
                                n = e.align,
                                o = e.marginTop,
                                i = e.marginLeft,
                                s = Object(a.default)(r.el);
                            r.update({
                                position: t,
                                align: n,
                                rect: s,
                                marginTop: o,
                                marginLeft: i
                            })
                        }
                    }, s)
                }, r.onMouseLeave = function(e) {
                    r.callerHovered = !1, r.timeouts.callerDisappear = setTimeout(function() {
                        r.callerHovered || r.hovered || r.update()
                    }, c)
                }, r.onDropdownMouseEnter = function() {
                    "hover" === r.props.trigger && (r.hovered = !0)
                }, r.onDropdownMouseLeave = function(e) {
                    "hover" === r.props.trigger && (r.hovered = !1, r.timeouts.disappear = setTimeout(function() {
                        r.callerHovered || r.hovered || r.update()
                    }, c))
                }, r.onDocumentClick = function(e) {
                    !r.state.dropdown || r.state.dropdown.removed || r.el.contains(e.target) || r.update()
                }, r.onResize = function(e) {
                    if (r.state.dropdown && !r.state.dropdown.removed) {
                        var t = r.props,
                            n = t.text,
                            o = t.position,
                            i = t.align,
                            s = t.marginTop,
                            c = t.marginLeft,
                            u = Object(a.default)(r.el);
                        r.update({
                            text: n,
                            position: o,
                            align: i,
                            rect: u,
                            marginTop: s,
                            marginLeft: c
                        })
                    }
                }, r.onTransitionEnd = function(e) {
                    "visibility" === e.propertyName && r.state.dropdown && r.state.dropdown.removed && r.setState({
                        dropdown: void 0
                    })
                }, r.onItemClick = function(e, t) {
                    t.separator || (r.update(), t.onClick(e))
                }, r.state = {}, r.timeouts = {}, r
            }
            return function(e, t) {
                if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                e.prototype = Object.create(t && t.prototype, {
                    constructor: {
                        value: e,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0
                    }
                }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
            }(t, e), t.prototype.componentDidMount = function() {
                this.el = o.findDOMNode(this), "click" === this.props.trigger ? (this.el.addEventListener("click", this.onClick), document.addEventListener("mousedown", this.onDocumentClick), window.addEventListener("resize", this.onResize)) : (this.el.addEventListener("mouseenter", this.onMouseEnter), this.el.addEventListener("mouseleave", this.onMouseLeave))
            }, t.prototype.componentWillUnmount = function() {
                var e = this;
                Object.keys(this.timeouts).forEach(function(t) {
                    clearTimeout(e.timeouts[t])
                }), "click" === this.props.trigger ? (this.el.removeEventListener("click", this.onClick), document.removeEventListener("mousedown", this.onDocumentClick), window.removeEventListener("resize", this.onResize)) : (this.el.removeEventListener("mouseenter", this.onMouseEnter), this.el.removeEventListener("mouseleave", this.onMouseLeave)), this.defaultNode && (this.defaultNode.parentNode.removeChild(this.defaultNode), delete this.defaultNode)
            }, t.prototype.update = function(e) {
                if (!e) return this.setState({
                    dropdown: Object.assign({}, this.state.dropdown, {
                        removed: !0
                    })
                });
                var t = e.position,
                    n = e.align,
                    r = e.rect,
                    o = e.marginTop,
                    i = e.marginLeft,
                    a = r.left,
                    s = r.top;
                switch (t) {
                    case "t":
                        a += .5 * r.width;
                        break;
                    case "r":
                        a += r.width, s += .5 * r.height;
                        break;
                    case "b":
                        a += .5 * r.width, s += r.height;
                        break;
                    case "l":
                        s += .5 * r.height
                }
                a = Math.round(a + i), s = Math.round(s + o), this.setState({
                    dropdown: {
                        position: t,
                        align: n,
                        x: a,
                        y: s
                    }
                })
            }, t.prototype.renderDropdown = function() {
                var e = this;
                if (!this.state.dropdown) return null;
                var t, n, o, a = this.state.dropdown,
                    s = a.x,
                    c = a.y,
                    u = a.position,
                    l = a.align,
                    d = a.removed,
                    f = Object(i.classNames)("Dropdown", "Dropdown--" + u, (t = {
                        "Dropdown--removed": !!d
                    }, n = "Dropdown--align-" + l, o = "t" === u || "b" === u, n in t ? Object.defineProperty(t, n, {
                        value: o,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : t[n] = o, t));
                return r.createElement("div", {
                    className: f,
                    style: {
                        top: c,
                        left: s
                    },
                    onTransitionEnd: function(t) {
                        return e.onTransitionEnd(t)
                    },
                    onMouseEnter: this.onDropdownMouseEnter,
                    onMouseLeave: this.onDropdownMouseLeave
                }, r.createElement("ul", {
                    className: "Dropdown__in"
                }, this.props.data.map(function(t, n) {
                    return r.createElement("li", {
                        className: Object(i.classNames)("Dropdown__item", {
                            Dropdown__item_separator: t.separator
                        }),
                        onClick: function(n) {
                            return e.onItemClick(n, t)
                        },
                        key: t.id || n
                    }, t.text)
                })))
            }, t.prototype.render = function() {
                var e = this.renderDropdown();
                return e ? (this.defaultNode || "undefined" == typeof window || (this.defaultNode = document.createElement("div"), document.body.appendChild(this.defaultNode)), r.createElement(r.Fragment, null, this.props.children, o.createPortal(e, this.defaultNode))) : this.props.children
            }, t
        }(r.Component);
    t.default = u, u.defaultProps = {
        position: "b",
        align: "center",
        marginTop: 0,
        marginLeft: 0,
        trigger: "click"
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "screenfull", function() {
        return r
    });
    var r = function() {
        var e = function() {
                for (var e = void 0, t = void 0, n = [
                        ["requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror"],
                        ["webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror"],
                        ["mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror"],
                        ["msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError"]
                    ], r = 0, o = n.length, i = {}; r < o; r++)
                    if ((e = n[r]) && e[1] in document) {
                        for (r = 0, t = e.length; r < t; r++) i[n[0][r]] = e[r];
                        return i
                    }
                return !1
            }(),
            t = {
                request: function(t) {
                    var n = e.requestFullscreen;
                    (t = t || document.documentElement)[n]()
                },
                exit: function() {
                    document[e.exitFullscreen]()
                },
                toggle: function(e) {
                    this.isFullscreen ? this.exit() : this.request(e)
                },
                raw: e
            };
        return !!e && (Object.defineProperties(t, {
            isFullscreen: {
                get: function() {
                    return Boolean(document[e.fullscreenElement])
                }
            },
            element: {
                enumerable: !0,
                get: function() {
                    return document[e.fullscreenElement]
                }
            },
            enabled: {
                enumerable: !0,
                get: function() {
                    return Boolean(document[e.fullscreenEnabled])
                }
            }
        }), t)
    }()
}, function(e, t, n) {
    "use strict";
    e.exports = n(194)
}, function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(66),
        o = n(406),
        i = n(409).default.getLang;
    t.default = function() {
        return [{
            id: "user name",
            label: i("mail_community_templates_hint_name"),
            process: function(e) {
                return Object(r.oCacheGet)(e, Object(o.getPeer)(e)).first_name
            }
        }, {
            id: "user surname",
            label: i("mail_community_templates_hint_last_name"),
            process: function(e) {
                var t = Object(r.oCacheGet)(e, Object(o.getPeer)(e));
                return t.name.replace(t.first_name, "").trim()
            }
        }, {
            id: "admin name",
            label: i("mail_community_templates_hint_your_name"),
            process: function(e) {
                return Object(r.oCacheGet)(e, vk.id).first_name
            }
        }, {
            id: "admin surname",
            label: i("mail_community_templates_hint_your_last_name"),
            process: function(e) {
                var t = Object(r.oCacheGet)(e, vk.id);
                return t.name.replace(t.first_name, "").trim()
            }
        }, {
            id: "community",
            label: i("mail_community_templates_hint_community"),
            process: function(e) {
                return Object(r.oCacheGet)(e, e.get().id).name
            }
        }, {
            id: "greeting",
            label: i("mail_community_templates_hint_greeting"),
            process: function(e) {
                var t = (new Date).getHours();
                return i(t >= 3 && t < 12 ? "mail_greeting_good_morning" : t >= 12 && t < 17 ? "mail_greeting_good_afternoon" : t >= 17 && t <= 23 ? "mail_greeting_good_evening" : "mail_greeting_good_night")
            }
        }]
    }
}, function(e, t, n) {
    "use strict";
    var r = Object.getOwnPropertySymbols,
        o = Object.prototype.hasOwnProperty,
        i = Object.prototype.propertyIsEnumerable;
    e.exports = function() {
        try {
            if (!Object.assign) return !1;
            var e = new String("abc");
            if (e[5] = "de", "5" === Object.getOwnPropertyNames(e)[0]) return !1;
            for (var t = {}, n = 0; n < 10; n++) t["_" + String.fromCharCode(n)] = n;
            if ("0123456789" !== Object.getOwnPropertyNames(t).map(function(e) {
                    return t[e]
                }).join("")) return !1;
            var r = {};
            return "abcdefghijklmnopqrst".split("").forEach(function(e) {
                r[e] = e
            }), "abcdefghijklmnopqrst" === Object.keys(Object.assign({}, r)).join("")
        } catch (e) {
            return !1
        }
    }() ? Object.assign : function(e, t) {
        for (var n, a, s = function(e) {
                if (null === e || void 0 === e) throw new TypeError("Object.assign cannot be called with null or undefined");
                return Object(e)
            }(e), c = 1; c < arguments.length; c++) {
            for (var u in n = Object(arguments[c])) o.call(n, u) && (s[u] = n[u]);
            if (r) {
                a = r(n);
                for (var l = 0; l < a.length; l++) i.call(n, a[l]) && (s[a[l]] = n[a[l]])
            }
        }
        return s
    }
}, function(e, t, n) {
    "use strict";
    var r = n(237),
        o = n(234),
        i = n(67),
        a = n(280);
    e.exports = n(350)(Array, "Array", function(e, t) {
        this._t = a(e), this._i = 0, this._k = t
    }, function() {
        var e = this._t,
            t = this._k,
            n = this._i++;
        return !e || n >= e.length ? (this._t = void 0, o(1)) : o(0, "keys" == t ? n : "values" == t ? e[n] : [n, e[n]])
    }, "values"), i.Arguments = i.Array, r("keys"), r("values"), r("entries")
}, , , function(e, t, n) {
    "use strict";
    n.r(t);
    var r = n(451),
        o = (n(96), n(260)),
        i = n(63),
        a = Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        };

    function s(e, t) {
        if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var c = function(e) {
        function t() {
            var n, r;
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            for (var o = arguments.length, i = Array(o), a = 0; a < o; a++) i[a] = arguments[a];
            return n = r = s(this, e.call.apply(e, [this].concat(i))), r.getWrapperRef = function(e) {
                r.wrapper = e
            }, s(r, n)
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentDidMount = function() {
            var e = this.props,
                t = e.isNative,
                n = e.isShadows,
                r = e.neverHide;
            this.scroller || (this.scroller = Object(o.createScroll)(this.wrapper, {
                shadows: n,
                nativeScroll: t,
                hidden: !r
            }))
        }, t.prototype.componentDidUpdate = function() {
            this.scroller.update()
        }, t.prototype.componentWillUnmount = function() {
            this.scroller.destroy(), this.scroller = null
        }, t.prototype.render = function() {
            var e = this.props,
                t = e.children,
                n = (e.isNative, e.isShadows, e.neverHide, e.className),
                o = void 0 === n ? "" : n,
                s = function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["children", "isNative", "isShadows", "neverHide", "className"]);
            return r.createElement("div", a({}, s, {
                className: Object(i.classNames)("Scroll", o),
                ref: this.getWrapperRef
            }), t)
        }, t
    }(r.Component);
    t.default = c, c.defaultProps = {
        isNative: !1,
        isShadows: !1,
        neverHide: !1
    }
}, , , , , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "canMessageBeEdited", function() {
        return c
    }), n.d(t, "convertEmojiHtmlToRegularText", function() {
        return u
    }), n.d(t, "findLastMessageToEdit", function() {
        return l
    }), n.d(t, "wasMessageReallyModified", function() {
        return d
    }), n.d(t, "replaceMsgAfterEdit", function() {
        return f
    });
    var r = n(406),
        o = n(427),
        i = n(1),
        a = n(124),
        s = n(187);

    function c(e, t) {
        t = Object(r.parserMessage)(t);
        var n = vk.id == t.peerId && !Object(s.unpackStore)(e).gid;
        return 333 != t.peerId && (!(!n && !Object(o.isOut)(t)) && (!Object(o.isServiceMsg)(t) && (!(Date.now() / 1e3 - t.date > 86400) && (!(Object(o.isGift)(t) || Object(o.isSticker)(t) || Object(o.isAudioMsg)(t) || Object(o.isGraffiti)(t) || Object(o.isMoney)(t) || Object(o.isVKPay)(t)) && !Object(i.isAlreadyDeleted)(e, t.peerId, t.messageId)))))
    }

    function u(e) {
        var t = document.createElement("div");
        return e = e.replace(/\[((id|club)\d+)\|(.+?)]/g, function() {
            var e = arguments.length <= 1 ? void 0 : arguments[1],
                t = arguments.length <= 3 ? void 0 : arguments[3];
            return /^\@/.test(t) ? t : "@" + e + " (" + t + ")"
        }), t.innerHTML = e, Emoji.val(t)
    }

    function l(e, t) {
        return +(t && t.msgs ? Object.keys(t.msgs) : []).filter(function(e) {
            return e > 0
        }).sort(function(e, t) {
            return t - e
        }).find(function(n) {
            return c(e, t.msgs[n])
        }) || null
    }

    function d(e, t, n) {
        var r = Object(a.convertKludgesToAttaches)(t.kludges, t.messageId),
            o = n.dData.attaches;
        if (u(t.text) !== n.dData.txt || r.length !== o.length) return !0;
        for (var i = r.length; i--;) {
            var s = r[i],
                c = o[i];
            if (s.id != c.id || s.type != c.type || "poll" == s.type && c.object && c.object.poll_is_edited) return !0
        }
        return !1
    }

    function f(e, t, n, r, o, a) {
        t.origText = n, t.text = Object(i.replaceSpecialSymbols)(clean(n)).replace(/\n/gi, "<br>"), t.attaches = r, t.kludges.emoji = 1, t.local = 1, t.share_url = o, t.cancelled_shares = a, t.update_time = Math.floor(Date.now() / 1e3), e.get().tabs[t.peerId].msgs[t.messageId] = t
    }
}, , , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "setHTML", function() {
        return i
    });
    var r = n(451),
        o = (n(96), Object.assign || function(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
            }
            return e
        });

    function i(e, t) {
        var n = !!window.getSelection && window.getSelection(),
            r = !1;
        if (n && n.rangeCount) {
            var o = n.getRangeAt(0);
            r = o.commonAncestorContainer ? o.commonAncestorContainer : o.parentElement ? o.parentElement() : o.item(0)
        }
        for (var i = r; i && i != e;) i = i.parentNode;
        i || Emoji.editableFocus(e, !1, !0), Emoji.insertHTML(t)
    }
    var a = function(e) {
        function t() {
            ! function(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }(this, t);
            for (var n = arguments.length, o = Array(n), i = 0; i < n; i++) o[i] = arguments[i];
            var a = function(e, t) {
                if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, e.call.apply(e, [this].concat(o)));
            return a.onChange = function() {
                a.props.onChange && a.props.onChange(Emoji.val(a.container))
            }, a.containerRef = r.createRef(), a.state = {
                value: a.props.initialValue
            }, a
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e), t.prototype.componentDidMount = function() {
            if (this.container = this.containerRef.current, this.container && !this.isMount) {
                this.isMount = !0;
                var e = this.props.initialValue;
                Emoji.val(this.container, Emoji.emojiToHTML(e)), Emoji.init(this.container, {
                    noStickers: !0,
                    onSend: function() {},
                    ctrlSend: function() {
                        return !0
                    },
                    onChange: this.onChange,
                    noLineBreaks: !this.props.isMultiLine
                })
            }
        }, t.prototype.componentWillUnmount = function() {
            this.container && this.isMount && (this.isMount = !1)
        }, t.prototype.render = function() {
            var e = this.props,
                t = e.tabIndex,
                n = e.isMultiLine,
                i = (e.initialValue, function(e, t) {
                    var n = {};
                    for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
                    return n
                }(e, ["tabIndex", "isMultiLine", "initialValue"]));
            return r.createElement("div", o({
                role: "textbox",
                ref: this.containerRef,
                tabIndex: t,
                contentEditable: !0,
                "aria-multiline": n
            }, i))
        }, t
    }(r.Component);
    a.defaultProps = {
        isMultiLine: !1,
        tabIndex: 0,
        initialValue: ""
    }, t.default = a
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return b
    });
    var r = n(451),
        o = n(412),
        i = n(190),
        a = n(256),
        s = n(309),
        c = n(252),
        u = n(406),
        l = n(440),
        d = n(43),
        f = n(159),
        p = n(452),
        _ = n(420),
        m = window.MessageBox;

    function g(e, t) {
        return Object(p.default)().reduce(function(t, n) {
            return t.replace(new RegExp("({" + n.id + "})", "gi"), n.process(e))
        }, t).replace(/&lt;br&gt;/gi, "<br>")
    }

    function h(e, t, n, a, d) {
        var p = void 0;
        return {
            closeSettingsPopup: function() {
                p && p.hide()
            },
            showSettingsPopup: function(e) {
                var n = this;
                (p = new m({
                    hideButtons: !0,
                    bodyStyle: "padding: 0; background: none;",
                    width: 500,
                    onShow: function() {
                        var a = document.getElementById("TemplatesSettings");
                        a && o.render(r.createElement(i.default, {
                            value: t
                        }, r.createElement(f.default, {
                            popup: p,
                            section: e,
                            getTemplates: function() {
                                return Object(u.getTemplates)(t)
                            },
                            saveTemplate: n.saveTemplate.bind(n),
                            deleteTemplate: n.deleteTemplate.bind(n),
                            closePopup: n.closeSettingsPopup.bind(n)
                        })), a), requestAnimationFrame(function() {
                            return p.updateBoxCoords()
                        })
                    }
                }).content('<div id="TemplatesSettings"></div>')).show()
            },
            applyTemplate: function(e) {
                var n = Object(u.getTemplates)(t).find(function(t) {
                    return t.id === e
                });
                Object(l.statlogsCommunityTemplatesClickEvent)(t, n.id), a(g(t, Object(_.prepareToWriting)(n.text)))
            },
            getPreparedTemplates: function() {
                return Object(u.getTemplates)(t).map(function(e) {
                    return Object.assign({}, e, {
                        name: e.name,
                        text: g(t, e.text)
                    })
                })
            },
            saveTemplate: function(e) {
                var n = Object(_.decodeHTMLEntities)(e.name),
                    r = Object(_.decodeHTMLEntities)(e.text);
                return t.set(e.id ? c.updateTemplate.bind(null, e.id, n, r) : c.createTemplate.bind(null, n, r))
            },
            deleteTemplate: function(e) {
                return t.set(c.deleteTemplate.bind(null, e))
            },
            isNeedRenderTemplates: function() {
                return !!Object(u.getPeer)(t) && (!!Object(u.isCommunityInterface)(t) && !(Object(u.getPeer)(t) > 2e9 && Object(s.doesChatTabHaveFlag)(Object(u.getCurrentTab)(t), 1024)))
            },
            toggleImText: function() {
                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : this.isNeedRenderTemplates();
                d(e)
            },
            update: function() {
                this.toggleImText()
            },
            unmount: function() {
                this.toggleImText(!1)
            }
        }
    }

    function b(e, t, n, s) {
        var c = (0, Object(a.createMutations)(h).bindMutations)(Object(a.createModule)({
            handlers: function(e, t) {}
        }), e, t, n, s);
        c.toggleImText();
        var u = r.createElement(i.default, {
            value: e
        }, r.createElement(d.default, {
            getTemplates: c.getPreparedTemplates,
            applyTemplate: c.applyTemplate.bind(c),
            isNeededRendering: c.isNeedRenderTemplates,
            showSettingsPopup: c.showSettingsPopup.bind(c, f.MAIN),
            showCreatingTemplatePopup: c.showSettingsPopup.bind(c, f.EDIT)
        }));
        return o.render(u, t), c
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return ie
    });
    var r = n(13),
        o = n(172),
        i = n(162),
        a = n(36),
        s = n(397),
        c = n(80),
        u = n(260),
        l = n(446),
        d = n(256),
        f = n(343),
        p = n(294),
        _ = n(112),
        m = n(88),
        g = n(356),
        h = n(330),
        b = n(476),
        v = n(272),
        y = n(187),
        O = n(406),
        w = n(427),
        E = n(252),
        C = n(440),
        j = n(1),
        k = n(192),
        T = n(339),
        S = n(76),
        M = n(66),
        P = n(219),
        x = n(35),
        I = function() {
            return function(e, t) {
                if (Array.isArray(e)) return e;
                if (Symbol.iterator in Object(e)) return function(e, t) {
                    var n = [],
                        r = !0,
                        o = !1,
                        i = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(r = (a = s.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0);
                    } catch (e) {
                        o = !0, i = e
                    } finally {
                        try {
                            !r && s.return && s.return()
                        } finally {
                            if (o) throw i
                        }
                    }
                    return n
                }(e, t);
                throw new TypeError("Invalid attempt to destructure non-iterable instance")
            }
        }();

    function D(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: !0,
            configurable: !0,
            writable: !0
        }) : e[t] = n, e
    }
    var A = 30,
        L = 400,
        R = 250,
        B = 32,
        N = 5 * B + 24 + 52,
        U = 3 * B + 24,
        F = 10,
        H = "._im_aside_notice";

    function W(e, t) {
        "spam" === t ? Object(j.showSpamLayer)(e, g.mount, {}) : "fav" === t && Object(j.showFavvedBox)(e, {}, T.mount, {})
    }

    function K(e, t) {
        if (e.get().gid) {
            var n = t.parentNode,
                r = geByClass("_im_right_menu_counter", n),
                o = e.get().dialog_tab_cts;
            r.forEach(function(e) {
                var t = domData(e, "tab");
                val(e, o[t] || "")
            })
        }
    }

    function q(e, t, n, r, o) {
        e.forEach(function(e) {
            switch (e.kludges.source_act) {
                case j.CHAT_PHOTO_REMOVE:
                case j.CHAT_PHOTO_UPDATE:
                    ! function(e, t, n, r) {
                        t.set(E.updateChatPhoto.bind(null, e)).then(function() {
                            var o = e.kludges.source_act;
                            n.updateDialog(e.peerId, t), r.updateChatPhoto(e, o, t)
                        })
                    }(e, t, n, r)
            }
        })
    }

    function z(e, t) {
        var n = e.get().longpoll.push.bind(null, [_.resetPeer()]);
        cancelStackPush("im_peer", function r() {
            var o = e.get().selectedMessages;
            o && o.length ? (e.setState({
                selectedMessages: []
            }).then(function() {
                t.changedMessageSelection(e), t.cleanSelection(o)
            }), setTimeout(function() {
                return cancelStackPush("im_peer", r)
            }, 0)) : n()
        })
    }

    function G(e) {
        var t = e.attaches.filter(function(e) {
            return "sticker" !== e.type
        });
        return Object(w.isServiceMsg)(e) || 0 === t.length
    }

    function V(e, t, n) {
        addClass(n, "im-page_history-show"), t.loadingPeer(e)
    }

    function Y(e, t) {
        var n = function(e, t) {
            var n = document.querySelector(H),
                r = Object(j.isCommunityInterface)(e) ? N : U,
                o = n ? n.offsetHeight : 0;
            return r += F, r += o, Math.floor((t.offsetHeight - r) / B)
        }(e, t);
        if (e.get().tabbedPeers.length > n) {
            var r = e.get().tabbedPeers.filter(function(t) {
                    var n = t.peer;
                    return intval(n) !== e.get().peer
                }).map(function(t) {
                    var n = t.peer;
                    return e.get().tabs[n]
                }).sort(function(e, t) {
                    return t.last_touched - e.last_touched
                }),
                o = [];
            0 !== e.get().peer && o.push(e.get().tabs[e.get().peer]);
            var i = o.concat(r).slice(n).map(function(e) {
                    return e.peerId
                }),
                a = e.get().tabbedPeers.filter(function(e) {
                    return !inArray(e.peer, i)
                });
            return e.set(E.updateTabbedPeers.bind(null, a, !0))
        }
        return Promise.resolve(e)
    }

    function Q() {
        for (var e = curBox(); e;) e.hide(), e = curBox()
    }

    function $(e, t, n, r, o, i, a, s, c) {
        e.get().audio_msg.isRecording && e.set(E.cancelRecording).then(function() {
            r.cancelRecording()
        }), AudioMessagePlayer.detachPlayer(), Object(O.isAnyMessageBeingEdited)(e) && r.cancelEditing(), Object(O.isSearching)(e) && t.cancelSearch && (o.clearSearch(e), n.restoreDialogs(e), c().toggleSettingsButton(e, !1)), X(e, s, c), V(e, r, i);
        var u = e.get().peer;
        Object(E.updateMentions)(e.get()), Object(E.videoAutoPlayHandler)(), Object(j.isFullyLoadedTab)(e, t.peerId) && (t.msgid && !Object(O.getMessage)(e, t.peerId, t.msgid) || !t.msgid && !Object(O.getMessage)(e, t.peerId, Object(O.getTab)(e, t.peerId).lastmsg) || Object(O.getTab)(e, t.peerId).skipped) && e.mutate(function(e) {
            return Object(O.makeTabNotFullyLoaded)(e, t.peerId)
        });
        var l = e.set(E.changePeer.bind(null, t.peerId, t.msgid, t.entryPoint)).then(function(e) {
            var n = e.get(),
                r = E.loadPeer.bind(null, t.peerId, !1, t.msgid, !1, n);
            return n.tabs[t.peerId] ? Promise.resolve(n) : e.set(r)
        }).then(function() {
            n.selectPeer(t.msgid, e),
                function(e, t) {
                    Object(j.isPendingForward)(e) && (cancelStackFilter("forward"), e.set(E.forwardMessages.bind(null, e.get().pendingForward, Object(O.getTabDraft)(Object(O.getTab)(e, t)), !1)))
                }(e, e.get().peer), window.tooltips && tooltips.hideAll(), Q(), r.preparePeer(e), z(e, r), Object(j.isClassicInterface)(e) && (n.deactivate(), Y(e, i).then(function() {
                    return a.updateMenu(e)
                }))
        });
        return (l = t.msgid ? l.then(function() {
            return e.set(E.selectPeerOnMessage.bind(null, t.peerId === u, u))
        }) : l.then(function() {
            return e.set(E.selectPeer.bind(null, !0))
        })).then(function() {
            if (e.get().peer === t.peerId) {
                if (t.forward) {
                    var n = e.get().tabs[e.get().peer];
                    !n.scrollBottom && n.unread && e.set(E.readLastMessages.bind(null, e.get().peer))
                }
                Object(j.isClassicInterface)(e) && a.updateMenu(e), r.changePeer(e, !1), r.updateTyping(t.peerId, e), Object(E.updateMentions)(e.get())
            }
        }).catch(function(e) {
            return Object(P.imWeirdCatch)("applyNewPeer", e)
        })
    }

    function X(e, t, n) {
        t && e.get().shown && (t.hide(e), n().createCanceled(e))
    }

    function J(e, t, n) {
        Object(O.isSearching)(e) && (t.clearSearch(e), n.restoreDialogs(e))
    }

    function Z(e, t, n, r, o, i, a) {
        Object(j.isClassicInterface)(e) && (o.saveScroll(e), i.saveScroll(e)), r.rotateCross(e), addClass(a, "im-page_creating"), e.setState({
            isCreating: !0
        }), n && n.show(e, t), Object(j.isClassicInterface)(e) && (setStyle(a, {
            height: ne(a, e).page
        }), setTimeout(function() {
            addClass(a, "im-page_cropped")
        }, 200)), Object(E.toggleConversation)(!0)
    }

    function ee(e, t, n, r, o) {
        r.activityType || (r.activityType = o);
        var i = function(e) {
            return function(e, t, n, r) {
                Object(j.isTabLoaded)(e.get(), r) && (t.updateTyping(r, e), n.updateTyping(r, e))
            }(e, t, n, r.peerId)
        };
        Object(j.isSelfMessage)(r.peerId, e.get().gid) || (e.set(E.setActivity.bind(null, r, o)).then(i), e.set(E.waitActivity.bind(null, r, o)).then(i))
    }

    function te(e, t, n, r, o, i, a, s, c, u, f, p, m, g, h, b, v, y, T, S, P) {
        return {
            changePeer: function(e, n) {
                t.selectPeer(e, n)
            },
            cancelSearch: function(e) {
                J(e, r, t)
            },
            loadingPeer: function(e) {
                V(e, n, o)
            },
            restoreDialogs: function(e, n, r) {
                t.restoreDialogs(e, n, r)
            },
            toggleSettingsButton: function(e, t) {
                f.toggleButton(e, t)
            },
            focusSearch: function(e) {
                r.focusInput(e)
            },
            appendSearch: function(e, n, r, o) {
                t.appendSearch(e, n, r, o)
            },
            appendDialogs: function(e, n) {
                t.appendDialogs(e, n)
            },
            showCreation: function(e, i) {
                Z(e, i, u, r, t, n, o)
            },
            updateState: function(e, r) {
                t.updateDialog(e, r), r.get().peer === e && n.updateChat(r, e)
            },
            appendFastDialogs: function(e, n) {
                t.appendFastDialogs(e, n, !0)
            },
            createCanceled: function(e, i) {
                r.createCanceled(e, i), Object(j.isClassicInterface)(e) ? (setStyle(o, {
                    height: "auto"
                }), removeClass(o, "im-page_cropped"), setTimeout(function() {
                    return r.focusInput(e)
                }, 0), 0 === e.get().peer ? t.restoreScroll(e) : n.restoreScroll(e, e.get().peer)) : setTimeout(function() {
                    0 === e.get().peer ? r.focusInput(e) : n.focustTxt(e)
                }, 0), removeClass(o, "im-page_creating"), e.setState({
                    isCreating: !1
                })
            },
            updateMenu: function(e) {
                b && b.updateMenu(e)
            },
            goToHistoryEnd: function() {
                n.goToEnd()
            },
            updateDialog: function(e, n) {
                t.updateDialog(e, n)
            },
            focusTxt: function(e) {
                n.focustTxt(e)
            },
            resync: function(e) {
                Object(O.isSearching)(e) && r.clearSearch(e), t.restoreDialogs(e, !0, !0), t.focusOnSelected(e), u && u.hide(e), Object(j.isCommunityInterface)(e) && K(e, o), Object(j.isClassicInterface)(e) && e.get().tabbedPeers.forEach(function(t) {
                    var n = t.peer;
                    b.updateCounter(e, n), b.updateName(n, e)
                }), n.cleanSelection(e.get().selectedMessages || []), n.cancelSearch(e, !0), Object(j.isReservedPeer)(e.get().peer) || n.changePeer(e, !1);
                var i = e.get().gid ? "l_mgid" + e.get().gid : "msg";
                handlePageCount(i, e.get().unread_cnt)
            },
            toggleSettingsLoader: function(e, t) {
                f.toggleLoader(e, t)
            },
            onUserActions: function(e, t) {
                if (!Object(E.isSearchingInplace)(e.get().peer, e.get())) {
                    var r = e.get(),
                        o = r.peer;
                    if (Object(j.isFullyLoadedTab)(r, o))
                        if (!i.is_idle)
                            if (Object(O.countUnread)(e.get().peer, e.get()) > 0) !r.tabs[o].skipped && n.isNewMessagesVisible(e) && (n.hideGoToEnd(!0), e.set(E.readLastMessages.bind(null, o)))
                }
            },
            removeSelection: function(e) {
                t.removeSelection(e), r.focusInput(e)
            },
            route: function(e, i, a, s) {
                if (void 0 !== e[0]) return !0;
                e.box && (e = {
                    box: e.box
                });
                var l = !1;
                return !(!e.invite_chat_id || !a.invite_hash) || (s && s.params && "left_nav" === s.params._ref && void 0 === e.sel && t.scrollUp(!0, !0), Object.keys(e).sort().forEach(function(e) {
                    switch (e) {
                        case "sel":
                            a.q || (l = !0);
                            var d = a.sel ? Object(j.unUrlPeer)(a.sel) : 0,
                                f = s.back;
                            0 === d ? p.get().longpoll.push([_.resetPeer(!1, f)]) : d !== p.get().peer && p.get().longpoll.push([_.changePeer(d, a.msgid || !1)]);
                            break;
                        case "invite_chat_id":
                        case "invite_hash":
                            ! function(e) {
                                e.set(E.leaveInvitation)
                            }(p);
                            break;
                        case "tab":
                            X(p, u, c), l = !0;
                            var m = a.tab || k.FOLDER_ALL;
                            p.get().longpoll.push([_.changeTab(m)]);
                            break;
                        case "act":
                            a.act && "create" === a.act ? Z(p, [], u, r, t, n, o) : function(e, t, n, r) {
                                n && n.hide(e, t)
                            }(p, [], u);
                            break;
                        case "st":
                            a.st && a.sel ? (curBox() && curBox().hide(), p.mutate(E.setInplaceSearch.bind(null, unescape(a.st), a.sel)), n.startSearch(p)) : (p.mutate(E.cancelSearch.bind(null, i.sel)), n.cancelSearch(p, !0));
                            break;
                        case "q":
                            a.q ? (curBox() && curBox().hide(), r.setSearch(p, a.q, !0)) : r.clearSearch(p);
                            break;
                        case "box":
                            W(p, a.box)
                    }
                }), Object(j.isClassicInterface)(p) && void 0 === e.sel && b.updateMenu(p), l && J(p, r, t), !1)
            },
            updateDialogFilters: function(e) {
                Object(O.isSearching)(e) || t.restoreDialogs(e), f.updateFilter(e)
            },
            removePeer: function(e, n) {
                t.removeDialog(e, n), t.saveScroll(e), e.get().peer === n && e.get().longpoll.push([_.resetPeer()]), Object(j.isClassicInterface)(e) && b.updateMenu(e)
            },
            newMessage: function(e) {
                Object(j.isClassicInterface)(e) || t.scrollUp(!0)
            },
            onEvents: function(e, i) {
                var d = function(e) {
                        for (var t = !1, n = e.length - 1; n >= 0; n--) e[n].type !== _.UNREAD_COUNT || t ? e[n].type === _.UNREAD_COUNT && e.splice(n, 1) : t = !0;
                        return e
                    }(i.filter(function(e) {
                        return e.type !== _.ADD_MESSAGE || !(e.flags & _.FLAG_STEALTH)
                    })),
                    p = i.filter(w.isServiceMsg),
                    g = i.filter(function(e) {
                        return e.type === _.ADD_MESSAGE
                    });
                q(p, e, t, n);
                var h = Object(E.checkNewPeople)(p, g, e),
                    v = Promise.resolve();
                h.shouldLoad && (v = e.set(E.loadNewPeople.bind(null, h, a))), v.then(function() {
                    d.forEach(function(i) {
                        switch (i.type) {
                            case _.ADD_MESSAGE:
                                var a = Object(O.getTab)(e, i.peerId),
                                    d = !a || !a.msgs || 0 == a.msgs.length,
                                    p = Object(j.isDuplicate)(i, e.get()),
                                    g = Object(O.isCommunityBlocked)(e, i.peerId);
                                if (!e.get().isIncomingMessageRequestsAllowed && Object(O.tabIsMessageRequest)(a)) break;
                                var h = null;
                                if (i.kludges.keyboard) {
                                    var v = Object.assign(i.kludges.keyboard, {
                                        author_id: i.userId
                                    });
                                    h = e.set(E.setKeyboard.bind(null, i.peerId, v))
                                } else {
                                    var y = Object(O.getKeyboard)(e, i.peerId);
                                    y && y.one_time && y.author_id !== Object(w.getAuthorId)(e, i) && (h = e.set(E.deleteKeyboard.bind(null, i.peerId)))
                                }
                                if (i.peerId === Object(O.getPeer)(e) && h && h.then(function() {
                                        return n.fixKeyboard()
                                    }), 0 === p) e.set(E.addMessage.bind(null, i)), Y(e, o),
                                    function(e, t) {
                                        var n = e.get().tabs[t.peerId],
                                            r = e.get().active_tab;
                                        return r === k.FOLDER_ALL || Object(E.filterFromTab)(r)(n)
                                    }(e, i) && (i.flags & _.FLAG_OUTBOUND || e.set(E.updateFavAndTitle.bind(null, i.peerId, !0)), function(e, t) {
                                        var n = t.flags & _.FLAG_OUTBOUND,
                                            r = inArray(t.peerId, e.get().mutedPeers),
                                            o = t.flags & _.FLAG_DELETED,
                                            i = e.get().gid;
                                        if (!n && !r && !o) {
                                            var a = function(e, t) {
                                                    return t < 2e9 && e && !e.match(/^\s*(Re(\(\d*\))?\:)?\s*\.\.\.\s*$/)
                                                }(t.subject, t.peerId) || "",
                                                s = (a ? a + " " : "") + t.text || "",
                                                c = t.userId,
                                                u = t.peerId,
                                                d = void 0,
                                                f = void 0,
                                                p = e.get().tabs[u];
                                            if (t.kludges && t.kludges.source_act && (s = stripHTML(Object(j.renderServiceMsg)(e, t, p, !1))), (!e.get().notify_msg && !Object(j.isChatPeer)(u) || i && !e.get().mute) && window.Notifier && Notifier.playSound({
                                                    author_id: u
                                                }), !Object(j.isChatPeer)(u)) return;
                                            s = trim(replaceEntities(stripHTML(s.replace(/<br>/g, "\n").replace(/<\*>.*$/, "")))), s = Object(l.replaceMentions)(s, function(e, t, n, r, o) {
                                                return o
                                            }), Object(j.isChatPeer)(u) ? (d = Object(M.oCacheGet)(e, c).name, p.tab && (d += " » " + p.tab), f = Object(M.oCacheGet)(e, c).photo) : (d = p.tab, f = p.photo);
                                            var m = t.attaches[0];
                                            if (m && "mail" === m.type) s += "\n[" + getLang("mail_added_msgs") + "]";
                                            else if (m) {
                                                var g = "doc" === m.type && "graffiti" === m.kind ? "graffiti" : m.type;
                                                s += "\n[" + getLang("mail_added_" + g) + "]"
                                            }
                                            d = trim(replaceEntities(stripHTML((d || "").replace("&nbsp;", " ")))), window.Notifier && Notifier.proxyIm({
                                                id: t.messageId,
                                                text: s,
                                                author_id: u,
                                                title: d,
                                                author_photo: f
                                            })
                                        }
                                    }(e, i), t.updateTyping(i.peerId, e), Object(O.isSearching)(e) ? t.updateDialog(i.peerId, e) : t.promoteDialog(e, i.peerId)), !1 === Object(O.isCommunityBlocked)(e, i.peerId) && !0 === g && n.updateActions(e), Object(j.isClassicInterface)(e) && (b.updateCounter(e, i.peerId), b.updateMenu(e)), n.updateTyping(i.peerId, e), n.addMessage(e, i), Object(j.isClassicInterface)(e) || f.updateFilter(e), G(i) || !Object(j.isFullyLoadedTab)(e, i.peerId) || i.local || e.set(E.loadMedia.bind(null, i)).then(function(e) {
                                        n.replaceAttachmentPlaceholders(e, i), Object(E.videoAutoPlayHandler)()
                                    }), Object(C.statlogsSendingTimeStart)(e, i, "send", "opt_to_lp");
                                else 2 === p ? (G(i) || e.set(E.loadMedia.bind(null, i)).then(function(e) {
                                    n.replaceAttachmentPlaceholders(e, i)
                                }), e.set(E.replaceMessage.bind(null, i)), n.replaceMessageAttrs(i, e), t.updateDialog(i.peerId, e), i.randomId && Object(C.statlogsSendingTimeEnd)(e, i, "send", "opt_to_lp")) : Object(O.isSearching)(e) || t.promoteDialog(e, i.peerId);
                                a && d && a.peerId === Object(O.getPeer)(e) && S();
                                break;
                            case _.EDIT_MESSAGE:
                            case _.REPLACE_MESSAGE:
                                e.set(E.editMessage.bind(null, i)).then(function(e) {
                                    t.updateDialog(i.peerId, e), n.updateTyping(i.peerId, e), n.editMessage(e, i), G(i) || !Object(j.isFullyLoadedTab)(e, i.peerId) || i.local || e.set(E.loadMedia.bind(null, i)).then(function(e) {
                                        n.replaceAttachmentPlaceholders(e, i)
                                    })
                                });
                                break;
                            case _.READ_INBOUND:
                                e.set(E.markInboundMessagesAsRead.bind(null, i)).then(function(e) {
                                    t.updateCounter(e, i.peerId), n.updateGoToEnd(e, !0), Object(j.isClassicInterface)(e) && b.updateCounter(e, i.peerId), Object(O.isSearching)(e) || t.restoreDialogs(e), f.updateFilter(e)
                                });
                                break;
                            case _.READ_OUTBOUND:
                                e.set(E.markOutboundMessagesAsRead.bind(null, i)).then(function(e) {
                                    t.updateCounter(e, i.peerId), n.markMessagesAsRead(e, i)
                                });
                                break;
                            case _.UNREAD_COUNT:
                                e.set(E.updateUnreadCount.bind(null, i.count)).then(function() {
                                    var t = e.get().gid ? "l_mgid" + e.get().gid : "msg";
                                    handlePageCount(t, i.count), f.updateFilter(e), Object(j.isClassicInterface)(e) && K(e, o)
                                });
                                break;
                            case _.GOT_ONLINE:
                            case _.GOT_OFFLINE:
                                var T = i.type === _.GOT_ONLINE;
                                e.set(E.updateOnline.bind(null, i.userId, !!T && i.platform, i.lastSeenTs)).then(function(e) {
                                    Object(j.isTabLoaded)(e.get(), i.userId) && (t.updateOnline(i.userId, e), n.updateOnline(i.userId, e))
                                });
                                break;
                            case _.SET_FLAGS:
                            case _.REPLACE_FLAGS:
                            case _.RESET_FLAGS:
                                if (!(i.flags & _.FLAG_DELETED || i.flags & _.FLAG_SPAM) || i.type !== _.SET_FLAGS || Object(j.isAlreadyDeleted)(e, i.peerId, i.messageId) || e.get().blockedFlagUpdates[i.peerId] || s(i), i.flags === _.FLAG_IMPORTANT) {
                                    var P = i.type === _.SET_FLAGS;
                                    e.set(E.updateImportant.bind(null, P ? 1 : -1, i.messageId)).then(function() {
                                        Object(j.isClassicInterface)(e) || r.updateImportantCnt(e)
                                    }), e.set(E.updateFavMessage.bind(null, [i.messageId], i.peerId, P)).then(function() {
                                        n.markImportant(i.messageId, P, e)
                                    })
                                }
                                break;
                            case _.RECORDING_AUDIO:
                                ee(e, n, t, i, E.ACTIVITY_TYPE_RECORDING_AUDIO);
                                break;
                            case _.TYPING:
                                ee(e, n, t, i, E.ACTIVITY_TYPE_TYPING);
                                break;
                            case _.NOTIFY_SETTINGS_CHANGED:
                                ! function(e, t, n, r) {
                                    e.set(E.setMutedPeer.bind(null, n, r)).then(t().updateState.bind(null, n))
                                }(e, c, i.peerId, 0 !== i.disabledUntil);
                                break;
                            case _.RESYNC:
                                e.get().longpoll.pause(), e.set(E.resync).then(c().resync).then(function() {
                                    return e.get().longpoll.resume()
                                });
                                break;
                            case _.TRANSITION:
                                m.transition(i.state);
                                break;
                            case _.RESET_PEER:
                                if (i.removeActivePeer) {
                                    var I = e.get().tabbedPeers.filter(function(t) {
                                        var n = t.peer,
                                            r = t.type;
                                        return n !== e.get().peer && "perm" === r
                                    });
                                    e.setState({
                                        tabbedPeers: I
                                    })
                                }! function(e, t, n, r) {
                                    e.set(E.cancelRecording).then(function() {
                                        n.cancelRecording()
                                    }), AudioMessagePlayer.detachPlayer(), t.removeSelection(e), removeClass(r, "im-page_history-show"), n.stopLoading(), Object(O.isAnyMessageBeingEdited)(e) && n.cancelEditing();
                                    var o = e.get().peer;
                                    e.set(E.changePeer.bind(null, 0, !1, !1)).then(function() {
                                        window.tooltips && window.tooltips.hideAll(), Q(), Object(j.isClassicInterface)(e) && t.activate(), n.changePeer(e), Object(j.isClassicInterface)(e) && t.restoreScroll(e), setTimeout(function() {
                                            e.get().longpoll.push([_.transitionEvent("search")])
                                        }, 13), Object(j.isLocksAvailable)(e) && Object(j.isPeerBlockedByMe)(o, e) && e.set(E.releaseBlock.bind(null, o))
                                    })
                                }(e, t, n, o), i.cancelSearch && J(e, r, t), Object(j.isClassicInterface)(e) && b.updateMenu(e), r.focusInput(e);
                                break;
                            case _.CHANGE_TAB:
                                Object(j.changeTab)(i.tab, e, c, E.changeDialogsTab).then(function(e) {
                                    f.updateFilter(e)
                                });
                                break;
                            case _.RESET_DIRECTORIES:
                            case _.SET_DIRECTORIES:
                            case _.REPLACE_DIRECTORIES:
                                if (i.mask === _.FOLDER_HAS_BANNER) break;
                                e.set(E.updateFolderState.bind(null, i.peerId, i.mask, i.type, i.local)).then(function(e) {
                                    Object(O.isSearching)(e) || i.type === _.RESET_DIRECTORIES && i.mask === _.FOLDER_IMPORTANT || i.type === _.REPLACE_DIRECTORIES || t.restoreDialogs(e), t.updateDialog(i.peerId, e), K(e, o), e.get().peer === i.peerId && n.changedMessageSelection(e)
                                });
                                break;
                            case _.DELETE_DIALOG:
                                e.set(E.deletedDialog.bind(null, i.peerId, Promise.resolve([]))).then(function() {
                                    c().removePeer(e, i.peerId), c().updateDialogFilters(e)
                                });
                                break;
                            case _.CHANGE_PEER:
                                $(e, i, t, n, r, o, b, u, c);
                                break;
                            case _.MUTEX:
                                var A = D({}, i.peerId, i),
                                    L = Object(j.isPeerBlocked)(i.peerId, e);
                                e.set(E.updateBlockStates.bind(null, A)).then(function() {
                                    t.updateDialog(i.peerId, e);
                                    var r = Object(j.isPeerBlocked)(i.peerId, e);
                                    Object(j.isFullyLoadedTab)(e.get(), i.peerId) && L !== r && n.updateChat(e, i.peerId)
                                });
                                break;
                            case _.FAILED_MESSAGE:
                                e.set(E.setMessageErrored.bind(null, i.peer, i.message)).then(function() {
                                    n.setMessageErrored(i.peer, i.message, i.error, e), t.setDialogFailed(i.peer, i.message.messageId, e)
                                });
                                break;
                            case _.RESEND:
                                var R = i.message.messageId;
                                e.set(E.resendMessage.bind(null, i.peerId, R, i.message)).then(function() {
                                    n.resendMessage(i.peerId, R), t.promoteDialog(e, i.peerId)
                                });
                                break;
                            case _.CONVERSATION_UPDATED:
                                if (Object(j.isTabLoaded)(e.get(), i.peerId)) Object(x.handleEventChatUpdated)(e, i.peerId, i.updateType, i.updateArg, n, t) || c().reloadChatInfo(i.peerId)
                        }
                    })
                })
            },
            updateHistory: function(e) {
                return n.updateHistory(e)
            },
            reloadChatInfo: function(e) {
                Object(j.isTabLoaded)(p.get(), e) && p.set(E.loadChatInfo.bind(null, e)).then(function() {
                    return function(e, t, n, r, o) {
                        r.updateChatTopic(t, e), Object(j.isClassicInterface)(e) && o.updateName(t, e), e.get().peer == t && (Object(E.setActions)(e.get()), r.updateActions(e))
                    }(p, e, 0, n, b)
                })
            },
            cancelRecording: function() {
                return p.set(E.cancelRecording).then(function() {
                    return n.cancelRecording()
                })
            },
            fixHeight: function() {
                S()
            },
            unmount: function() {
                Object(d.destroyModule)(e), clearInterval(p.get().update_title_to), i.stop(), P(), t.unmount();
                var o = window.devicePixelRatio >= 2 ? "_2x" : "";
                setFavIcon("/images/icons/favicons/fav_logo" + o + ".ico"), n.unmount(), r.unmount(), cancelStackFilter("im_peer"), f.unmount(), u && u.unmount(), b && b.unmount(), v && v(), g && g(), Object(j.isLocksAvailable)(p) && p.get().peer && p.set(E.releaseBlock.bind(null, p.get().peer)), y.unmount(), b && b.unmount(), T.unmount(), clearInterval(h), cur.imDb.unmount(), cur.imDb = !1
            }
        }
    }

    function ne(e, t) {
        var n = ge("page_header"),
            r = geByClass1("_im_page_history", e),
            o = window.clientHeight() - n.offsetHeight - A - 2,
            i = Object(j.isClassicInterface)(t) ? R : L,
            a = {
                page: Math.max(o, i)
            };
        if (Object(j.isClassicInterface)(t)) {
            var s = Object(j.getClassicChatHeight)();
            s = s > 0 ? Math.min(s - n.offsetHeight - A - 2, o) : o;
            var c = hasClass(r, "im-page--history_empty-hist") ? s : o;
            a.history = Math.max(s, i), a.chat = Math.max(c, i)
        }
        return a
    }

    function re(e, t, n, r, o) {
        var i = !(arguments.length > 5 && void 0 !== arguments[5]) || arguments[5],
            a = arguments.length > 6 && void 0 !== arguments[6] && arguments[6];
        if (!isFullScreen()) {
            var s = ne(e, t);
            if (setStyle(e, {
                    minHeight: s.page
                }), Object(j.isClassicInterface)(t) && (void 0 === t.get().chatResizeInitialized && t.set(E.initializeChatResize), setStyle(e, {
                    height: t.get().isCreating ? s.page : "auto"
                }), setStyle(geByClass1("_im_page_dialogs", e), {
                    minHeight: s.page,
                    position: "static",
                    top: 0
                }), setStyle(geByClass1("_im_page_history", e), {
                    minHeight: s.history,
                    position: "relative",
                    top: 0
                }), setStyle(geByClass1("_im_chat_body_abs", e), {
                    minHeight: s.chat,
                    height: s.chat,
                    position: "relative",
                    top: 0
                })), browser.safari && a && "function" == typeof a && a(), r && r.updateScroll(), o && o.updateScroll(), n) {
                var c = n.updateScroll();
                n.scrollFix(t, t.get().peer, c)
            }
            i && setTimeout(function() {
                return re(e, t, n, r, o, !1)
            }, 100)
        }
    }

    function oe() {
        ! function(e) {
            var t = "safari-repaint";
            e.forEach(function(e) {
                hasClass(e, t) && removeClass(e, t), addClass(e, t)
            }), setTimeout(function() {
                e.forEach(function(e) {
                    removeClass(e, t)
                })
            }, 100)
        }([geByClass1("_im_dialog_actions"), geByClass1("_im_chat_input_w"), ge("side_bar"), geByClass1("_im_right_menu"), geByClass1("_im_dialogs_settings"), geByClass1("_im_dialogs_search")])
    }

    function ie(e, t) {
        var n = t.get(),
            l = void 0,
            g = window.devicePixelRatio >= 2 ? "_2x" : "";
        setFavIcon("/images/icons/favicons/fav_im" + g + ".ico"), re(e, t, !1, !1, !1, !0), show(e);
        var w = Object(d.createMutations)(te),
            C = w.callMutations,
            k = w.bindMutations,
            T = n.useFcLongpoll && vk.lpConfig.enabled && Notifier.getLpInstance && Notifier.getLpInstance(),
            M = T ? Notifier.getLpInstance() : t.get().gid ? Object(p.startLongPollForGroup)(n.lpConfig) : Object(p.startLongPoll)(n);

        function x() {
            for (var e = arguments.length, n = Array(e), r = 0; r < e; r++) n[r] = arguments[r];
            C().onEvents(t, n)
        }
        M.onData(x), T && Object(P.imWeirdLog)("im_use_fc_longpoll", {}, !1);
        var A = geByClass1("_im_dialogs_search", e),
            L = geByClass1("_im_dialogs_settings", e),
            R = Object(r.mount)(geByClass1("_im_page_dcontent", e), t, C),
            B = Object(i.mount)(A, t, C),
            N = Object(a.mount)(L, t, C),
            U = Object(b.mount)(t);
        cur.imDb = Object(v.mount)(t.get().gid ? -t.get().gid : vk.id), t.set(E.preloadSearchIndex.bind(null, cur.imDb)), Object(j.isClassicInterface)(t) && N.updateSettings(t);
        var F = void 0,
            H = void 0;
        if (Object(j.isClassicInterface)(t)) {
            var K = geByClass1("_im_ui_peers_list", e.parentNode);
            F = Object(h.mount)(K, t, C), H = function(e, t, n, r) {
                if (browser.mobile) return !1;
                var o = [t, n, geByClass1("_im_chat_input_w", r), geByClass1("_im_dialog_actions", r)],
                    i = null,
                    a = hasClass(e, "im-page--header_static"),
                    s = ge("im-group-online-disabled-notice");

                function c() {
                    var t = Object(u.getNativeOption)("scrollLeft"),
                        n = hasClass(e, "im-page--header_static"),
                        r = [];
                    i !== t ? r = o.slice().concat([e]) : n !== a && (r = [e]), i = t, a = n, r.length > 0 && r.forEach(function(r) {
                        var o = e === r && n ? 0 : -t;
                        setStyle(r, D({}, cssTransformProp, 0 === o ? "unset" : "translateX(" + o + "px)"))
                    })
                }
                return s && o.push(s), o = o.concat(geByClass("_im_aside_notice"), geByClass("_im_aside_promo_block")), addEvent(window, "scroll", c), c(),
                    function() {
                        removeEvent(window, "scroll", c)
                    }
            }(A, L, geByClass1("_im_right_menu", e.parentNode), e)
        }
        Object(j.isClassicInterface)(t) && n.peer && R.deactivate(), n.gid || (l = Object(s.mount)(geByClass1("_im_dialogs_creation", e), t, C));
        var q = Object(o.mount)(geByClass1("_im_page_history", e), t, R, F, C),
            G = n.isCreating,
            V = G ? "create" : 0 === n.peer ? "search" : "default";
        G && l.show(t, []);
        var Y = Object(f.create)(t, V, R, q, B, l),
            Q = Object(S.mount)(t, Y);
        q.updateScroll();
        var $ = function(e, t, n, r) {
            var o = t.get();
            Object(j.isReservedPeer)(o.peer) || e().onUserActions(t, r), o.update_old_title && t.set(E.updateFavAndTitle.bind(null, !1, !1))
        }.bind(null, C, t, Y);
        Object(j.isReservedPeer)(n.peer) || setTimeout(function() {
            return z(t, q)
        }, 10);
        var X = new IdleManager({
                id: "im",
                element: document,
                focusElement: window,
                triggerEvents: "mouseover mousedown keypress"
            }),
            J = debounce(oe, 300),
            Z = re.bind(null, e, t, q, R, l, !1, J);
        t.setState({
            longpoll: M
        }), t.set(E.setExecStack.bind(null, [])), X.on("unidle", function() {
            M.abortWaiting(), $()
        }), X.start(), nav.objLoc.box && (W(t, nav.objLoc.box), Object(c.updateLocation)({
            box: null
        }));
        var ee = function(e) {
                var t = e.get();
                return Object(j.isLocksAvailable)(e) ? Object(m.createWorker)(t.mutex_key, function(e) {
                    t.longpoll.push([_.mutexEvent(e)])
                }, function(e, n) {
                    return Object(E.getMutexQueue)(t.gid).then(function(e) {
                        return I(e, 1)[0]
                    })
                }).stop : null
            }(t),
            ne = void 0;
        Object(j.isLocksAvailable)(t) && (ne = setInterval(j.blockLatencyCompensation.bind(null, t, n.longpoll), 2e3)), t.get().invitation && Object(j.showInvitationBox)(t, t.get().invitation, E.leaveInvitation);
        var ie = Object(y.throttleAccumulate)(function(e, t, n, r, o) {
                var i = o.reduce(function(e, t) {
                    return e[t.peerId] || (e[t.peerId] = []), e[t.peerId].push(t.messageId), e
                }, {});
                Object.keys(i).forEach(function(o) {
                    var a = i[o];
                    e.set(E.removeMessages.bind(null, a, o)).then(function() {
                        return e.set(E.removeMessagesMarkDeleted.bind(null, a, o))
                    }).then(function() {
                        return t.removeMessages(a, +o, e)
                    }).then(function() {
                        var i = Object(O.getTab)(e, o);
                        i && a.some(function(e) {
                            return e >= i.lastmsg
                        }) && Object(E.loadActualLastMessage)(e, +o).then(function() {
                            n.promoteDialog(e, o), r && r.updateCounter(e, o), t.updateGoToEnd(e, !0)
                        })
                    })
                })
            }.bind(null, t, q, R, F), 200),
            ae = j.hideTopNotice.bind(null, t),
            se = j.hideAsideNotice.bind(null, t);
        return k(Object(d.createModule)({
            handlers: function(t, n) {
                t(document, "mousemove mousedown keypress", $), t(window, "resize", Z), n(e, "click", j.HIDE_TOP_NOTICE_CLASS, ae), n(gpeByClass("_im-page-wrap", e), "click", j.HIDE_ASIDE_NOTICE_CLASS, se), n(gpeByClass("_im-page-wrap", e), "click", j.HIDE_ASIDE_PROMO_BLOCK_CLASS, j.hideAsidePromoBlock), n(gpeByClass("_im-page-wrap", e), "click", j.INSTALL_VKADMIN_LINK, j.installVKAdminApp), browser.safari && t(document, "visibilitychange", oe)
            }
        }), R, q, B, e, X, M, ie, C, l, N, t, Y, ee, ne, F, H, U, Q, Z, function() {
            T ? M.offData(x) : M.stop()
        })
    }
}, function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "curBox", function() {
        return u
    }), n.d(t, "initBoxQueue", function() {
        return l
    }), n.d(t, "boxRefreshCoords", function() {
        return d
    }), n.d(t, "showDoneBox", function() {
        return f
    }), n.d(t, "getBoxQueue", function() {
        return p
    });
    var r = n(45),
        o = n(269),
        i = n(347),
        a = n(163),
        s = n(324),
        c = {
            hideAll: function(e, t) {
                if (e)
                    for (; c.count();) c.hideLast();
                else {
                    if (c.count()) {
                        var n = _message_boxes[c._boxes.pop()];
                        n._in_queue = !1, n._hide(!1, !1, t)
                    }
                    for (; c.count();) {
                        _message_boxes[c._boxes.pop()]._in_queue = !1
                    }
                }
            },
            hideLast: function(e, t) {
                if (c.count()) {
                    var n = window._message_boxes[c._boxes[c.count() - 1]];
                    if (!0 === e && (n.changed || c.skip || t && t.target && t.target.tagName && "input" !== t.target.tagName.toLowerCase() && cur.__mdEvent && t.target !== cur.__mdEvent.target)) return void(c.skip = !1);
                    n.hide()
                }
                if (t && "click" === t.type) return Object(r.cancelEvent)(t)
            },
            hideBGClick: function(e) {
                e && e.target && /^box_layer/.test(e.target.id) && c.hideLast()
            },
            count: function() {
                return c._boxes.length
            },
            _show: function(e) {
                var t = _message_boxes[e];
                if (t && !t._in_queue) {
                    c.count() ? _message_boxes[c._boxes[c.count() - 1]]._hide(!0, !0) : window.tooltips && tooltips.hideAll(), t._in_queue = !0;
                    var n = !!c.count();
                    c.curBox = e, t._show(n || c.currHiding, n), c._boxes.push(e)
                }
            },
            _hide: function(e) {
                var t = _message_boxes[e];
                if (t && t._in_queue && c._boxes[c.count() - 1] === e && t.isVisible() && (t._in_queue = !1, c._boxes.pop(), t._hide(!!c.count()), c.count())) {
                    var n = c._boxes[c.count() - 1];
                    c.curBox = n, _message_boxes[n]._show(!0, !0, !0)
                }
            },
            _boxes: [],
            curBox: 0
        };

    function u() {
        var e = window._message_boxes[c.curBox];
        return e && e.isVisible() ? e : null
    }

    function l() {
        c.hideLastCheck = c.hideLast.pbind(!0), window._message_box_guid = 0, window._message_boxes = []
    }

    function d(e) {
        var t = window.innerHeight || document.documentElement.clientHeight || boxLayerBG.offsetHeight,
            n = s.browser.mobile ? Object(o.intval)(window.pageYOffset) : 0,
            r = Object(i.getSize)(e);
        e.style.marginTop = Math.max(10, n + (t - r[1]) / 3) + "px"
    }

    function f(e) {
        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
            n = (t.w || 380) + 20,
            c = t.w ? ' style="width: ' + t.w + 'px;"' : "",
            u = bodyNode.offsetWidth,
            l = Object(i.ce)("div", {
                className: "top_result_baloon_wrap fixed " + (t.className || ""),
                innerHTML: '<div class="top_result_baloon"' + c + ">" + e + "</div>"
            }, {
                left: (u - n) / 2
            });
        t.parentEl ? Object(i.geByClass1)(t.parentEl).appendChild(l) : bodyNode.insertBefore(l, pageNode);
        var d = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : boxLayerBG.offsetHeight,
            f = s.browser.mobile ? Object(o.intval)(window.pageYOffset) : 0,
            p = Object(i.getSize)(l);
        l.style.top = Math.max(10, f + (d - p[1]) / 3) + "px";
        var _ = t.out || 2e3,
            m = new Date,
            g = function e() {
                _ < 0 || (window.doneBoxTO = setTimeout(function() {
                    !t.permit || t.permit() ? Object(a.fadeOut)(l.firstChild, 500, function() {
                        Object(i.re)(l), t.callback && t.callback()
                    }) : e()
                }, _))
            };
        return Object(r.addEvent)(l, "mouseenter", function() {
            clearTimeout(window.doneBoxTO), _ -= new Date - m
        }), Object(r.addEvent)(l, "mouseleave", function() {
            m = new Date, g()
        }), g(), l
    }

    function p() {
        return c
    }
}, , , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return d
    });
    var r = n(451),
        o = n(412),
        i = n(24),
        a = n(190),
        s = n(256),
        c = n(252);

    function u() {
        return document.getElementById("_im_keyboard_container")
    }

    function l(e, t, n) {
        return {
            init: function() {
                var e = this;
                return new Promise(function(s) {
                    e.isMounted = !0,
                        function(e, t, n) {
                            var s = u();
                            if (s) {
                                var c = r.createElement(a.default, {
                                    value: e
                                }, r.createElement(i.default, {
                                    send: t
                                }));
                                o.render(c, s, n)
                            }
                        }(t, n, s)
                })
            },
            toggle: function(e, n, r) {
                return t.set(c.toggleKeyboard.bind(null, e, n, r))
            },
            unmount: function() {
                var t = u();
                t && this.isMounted && o.unmountComponentAtNode(t), this.isMounted = !1, Object(s.destroyModule)(e)
            }
        }
    }

    function d(e, t, n, r, o) {
        return (0, Object(s.createMutations)(l).bindMutations)(Object(s.createModule)({
            handlers: function(e, t) {}
        }), t, r)
    }
}, , function(e, t, n) {
    "use strict";
    n.r(t), n.d(t, "mount", function() {
        return c
    });
    var r = n(1),
        o = n(252),
        i = 5e3,
        a = 54e6,
        s = 72e5;

    function c(e) {
        var t = setInterval(function(e) {
            var t = e.get().tabs,
                n = e.get().peer,
                i = Object.keys(t).filter(function(t) {
                    return Object(r.isFullyLoadedTab)(e, t) && intval(t) !== n
                }).map(function(e) {
                    return t[e]
                });
            i.filter(function(e) {
                return Date.now() - e.last_visited > a
            }).forEach(function(t) {
                return e.set(o.cleanTab.bind(null, t.peerId))
            }), i.filter(function(t) {
                return Object(r.isFullyLoadedTab)(e, t.peerId) && "string" != typeof t.history && Date.now() - t.last_touched > s
            }).forEach(function(t) {
                return e.set(o.stringifyTab.bind(null, t.peerId))
            })
        }.bind(null, e), i);
        return {
            unmount: function() {
                clearInterval(t)
            }
        }
    }
}]);